{"created_by":"Tampermonkey","version":"1","scripts":[{"name":"Instagram Download Button","options":{"check_for_updates":true,"user_modified":null,"comment":null,"compatopts_for_requires":true,"compat_wrappedjsobject":false,"compat_metadata":false,"compat_foreach":false,"compat_powerful_this":null,"sandbox":null,"noframes":null,"unwrap":null,"run_at":null,"tab_types":null,"override":{"use_includes":[],"orig_includes":[],"merge_includes":true,"use_matches":[],"orig_matches":["https://www.instagram.com/*"],"merge_matches":true,"use_excludes":[],"orig_excludes":[],"merge_excludes":true,"use_connects":[],"orig_connects":[],"merge_connects":true,"use_blockers":[],"orig_run_at":"document-idle","orig_noframes":null,"orig_run_in":[]},"run_in":null,"tags":[]},"storage":{"ts":1716629345332,"data":{}},"enabled":true,"position":1,"file_url":"https://update.greasyfork.org/scripts/406535/Instagram%20Download%20Button.user.js","uuid":"87d353f2-1bc5-472a-8599-8798e9031012","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICAgICAgICAgSW5zdGFncmFtIERvd25sb2FkIEJ1dHRvbgovLyBAbmFtZTp6aC1UVyAgICAgICAgICBJbnN0YWdyYW0g5LiL6LyJ5ZmoCi8vIEBuYW1lOnpoLUNOICAgICAgICAgIEluc3RhZ3JhbSDkuIvovb3lmagKLy8gQG5hbWU6amEgICAgICAgICAgICAgSW5zdGFncmFtIOODgOOCpuODs+ODreODvOODgOODvAovLyBAbmFtZTprbyAgICAgICAgICAgICBJbnN0YWdyYW0g64uk7Jq066Gc642UCi8vIEBuYW1lOmVzICAgICAgICAgICAgIERlc2NhcmdhZG9yIGRlIEluc3RhZ3JhbQovLyBAbmFtZTpmciAgICAgICAgICAgICBUw6lsw6ljaGFyZ2V1ciBJbnN0YWdyYW0KLy8gQG5hbWU6aGkgICAgICAgICAgICAg4KSH4KSC4KS44KWN4KSf4KS+4KSX4KWN4KSw4KS+4KSuIOCkoeCkvuCkieCkqOCksuCli+CkoeCksAovLyBAbmFtZTpydSAgICAgICAgICAgICDQl9Cw0LPRgNGD0LfRh9C40LogSW5zdGFncmFtCi8vIEBuYW1lc3BhY2UgICAgICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS95MjUyMzI4L0luc3RhZ3JhbV9Eb3dubG9hZF9CdXR0b24KLy8gQHZlcnNpb24gICAgICAgICAgICAgMS4xNy4xOAovLyBAY29tcGF0aWJsZSAgICAgICAgICBjaHJvbWUKLy8gQGRlc2NyaXB0aW9uICAgICAgICAgQWRkIHRoZSBkb3dubG9hZCBidXR0b24gYW5kIHRoZSBvcGVuIGJ1dHRvbiB0byBkb3dubG9hZCBvciBvcGVuIHByb2ZpbGUgcGljdHVyZSBhbmQgbWVkaWEgaW4gdGhlIHBvc3RzLCBzdG9yaWVzLCBhbmQgaGlnaGxpZ2h0cyBpbiBJbnN0YWdyYW0KLy8gQGRlc2NyaXB0aW9uOnpoLVRXICAg5ZyoSW5zdGFncmFt6aCB6Z2i5Yqg5YWl5LiL6LyJ5oyJ6YiV6IiH6ZaL5ZWf5oyJ6YiV77yM6YCP6YGO6YCZ5Lqb5oyJ6YiV5Y+v5Lul5LiL6LyJ5oiW6ZaL5ZWf5aSn6aCt6LK86IiH6LK85paH44CB6ZmQ5pmC5YuV5oWL44CBSGlnaGxpZ2h05Lit55qE54Wn54mH5oiW5b2x54mHCi8vIEBkZXNjcmlwdGlvbjp6aC1DTiAgIOWcqEluc3RhZ3JhbemhtemdouWKoOWFpeS4i+i9veaMiemSruS4juW8gOWQr+aMiemSru+8jOmAj+i/h+i/meS6m+aMiemSruWPr+S7peS4i+i9veaIluW8gOWQr+Wkp+WktOi0tOS4jui0tOaWh+OAgemZkOaXtuWKqOaAgeOAgUhpZ2hsaWdodOS4reeahOeFp+eJh+aIluW9seeJhwovLyBAZGVzY3JpcHRpb246amEgICAgICDjg6Hjg4fjgqPjgqLjgpLjg4Djgqbjg7Pjg63jg7zjg4njgb7jgZ/jga/plovjgY/jgZ/jgoHjga7jg5zjgr/jg7PjgpLov73liqDjgZfjgb7jgZkKLy8gQGRlc2NyaXB0aW9uOmtvICAgICAg66+465SU7Ja066W8IOuLpOyatOuhnOuTnO2VmOqxsOuCmCDsl6zripQg67KE7Yq87J2EIOy2lOqwgO2VqeuLiOuLpAovLyBAZGVzY3JpcHRpb246ZXMgICAgICBBZ3JlZ3VlIGJvdG9uZXMgcGFyYSBkZXNjYXJnYXIgbyBhYnJpciBtZWRpb3MKLy8gQGRlc2NyaXB0aW9uOmZyICAgICAgQWpvdXRleiBkZXMgYm91dG9ucyBwb3VyIHTDqWzDqWNoYXJnZXIgb3Ugb3V2cmlyIGRlcyBtw6lkaWFzCi8vIEBkZXNjcmlwdGlvbjpoaSAgICAgIOCkruClgOCkoeCkv+Ckr+CkviDgpJXgpYsg4KSh4KS+4KSJ4KSo4KSy4KWL4KShIOCkr+CkviDgpJbgpYvgpLLgpKjgpYcg4KSV4KWHIOCksuCkv+CkjyDgpKzgpJ/gpKgg4KSc4KWL4KSh4KS84KWH4KSC4KWkCi8vIEBkZXNjcmlwdGlvbjpydSAgICAgINCU0L7QsdCw0LLRjNGC0LUg0LrQvdC+0L/QutC4INC00LvRjyDQt9Cw0LPRgNGD0LfQutC4INC40LvQuCDQvtGC0LrRgNGL0YLQuNGPINC80LXQtNC40LAKLy8gQGF1dGhvciAgICAgICAgICAgICAgWmhpWXUKLy8gQG1hdGNoICAgICAgICAgICAgICAgaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS8qCi8vIEBpY29uICAgICAgICAgICAgICAgIGh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vczIvZmF2aWNvbnM/c3o9NjQmZG9tYWluPWluc3RhZ3JhbS5jb20KLy8gQGdyYW50ICAgICAgICAgICAgICAgbm9uZQovLyBAbGljZW5zZSAgICAgICAgICAgICBNSVQKLy8gQGRvd25sb2FkVVJMIGh0dHBzOi8vdXBkYXRlLmdyZWFzeWZvcmsub3JnL3NjcmlwdHMvNDA2NTM1L0luc3RhZ3JhbSUyMERvd25sb2FkJTIwQnV0dG9uLnVzZXIuanMKLy8gQHVwZGF0ZVVSTCBodHRwczovL3VwZGF0ZS5ncmVhc3lmb3JrLm9yZy9zY3JpcHRzLzQwNjUzNS9JbnN0YWdyYW0lMjBEb3dubG9hZCUyMEJ1dHRvbi5tZXRhLmpzCi8vID09L1VzZXJTY3JpcHQ9PQoKLy8gVE8tRE86Ci8vICAgLSByZXBsYWNlIHRoZSBjaGVja2luZyB0aW1lciB3aXRoIHRoZSBvYnNlcnZlcgoKKGZ1bmN0aW9uICgpIHsKICAgICd1c2Ugc3RyaWN0JzsKCiAgICAvLyA9PT09PT09PT09PT09PT09PQogICAgLy8gPSAgICBPcHRpb25zICAgID0KICAgIC8vID09PT09PT09PT09PT09PT09CiAgICAvLyBPbGQgbWV0aG9kIGlzIGZhc3RlciB0aGFuIG5ldyBtZXRob2QsIGJ1dCBub3Qgd29yayBvciB1bmFibGUgZ2V0IGhpZ2hlc3QgcmVzb2x1dGlvbiBtZWRpYSBzb21ldGltZQogICAgY29uc3QgZGlzYWJsZU5ld1VybEZldGNoTWV0aG9kID0gZmFsc2U7CiAgICBjb25zdCBwcmVmZXRjaEFuZEF0dGFjaExpbmsgPSBmYWxzZTsgLy8gcHJlZmV0Y2ggYW5kIGFkZCBsaW5rIGludG8gdGhlIGJ1dHRvbiBlbGVtZW50cwogICAgY29uc3QgaG92ZXJUb0ZldGNoQW5kQXR0YWNoTGluayA9IHRydWU7ICAvLyBmZXRjaCBhbmQgYWRkIGxpbmsgd2hlbiBob3ZlciB0aGUgYnV0dG9uCiAgICBjb25zdCByZXBsYWNlSnBlZ1dpdGhKcGcgPSBmYWxzZTsKICAgIC8vID09PSBGaWxlIG5hbWUgcGxhY2Vob2xkZXJzID09PQogICAgLy8gJWlkJSA6IHRoZSBwb3N0ZXIgaWQKICAgIC8vICVkYXRldGltZSUgOiB0aGUgbWVkaWEgdXBsb2FkIHRpbWUKICAgIC8vICVtZWRpYW5hbWUlIDogdGhlIG9yaWdpbmFsIG1lZGlhIGZpbGUgbmFtZQogICAgLy8gJXBvc3RJZCUgOiB0aGUgcG9zdCBpZAogICAgLy8gJW1lZGlhSW5kZXglIDogdGhlIG1lZGlhIGluZGV4IGluIG11bHRpcGxlLW1lZGlhIHBvc3RzCiAgICBjb25zdCBwb3N0RmlsZW5hbWVUZW1wbGF0ZSA9ICclaWQlLSVkYXRldGltZSUtJW1lZGlhbmFtZSUnOwogICAgY29uc3Qgc3RvcnlGaWxlbmFtZVRlbXBsYXRlID0gcG9zdEZpbGVuYW1lVGVtcGxhdGU7CiAgICAvLyA9PT0gRGF0ZXRpbWUgcGxhY2Vob2xkZXJzID09PQogICAgLy8gJXklOiB5ZWFyICg0IGRpZ2l0cykKICAgIC8vICVtJTogbW9udGggKDAxLTEyKQogICAgLy8gJWQlOiBkYXkgKDAxLTMxKQogICAgLy8gJUglOiBob3VyICgwMC0yMykKICAgIC8vICVNJTogbWluICgwMC01OSkKICAgIC8vICVTJTogc2VjICgwMC01OSkKICAgIGNvbnN0IGRhdGV0aW1lVGVtcGxhdGUgPSAnJXklJW0lJWQlXyVIJSVNJSVTJSc7CiAgICAvLyA9PT09PT09PT09PT09PT09PT0KCiAgICBjb25zdCBwb3N0SWRQYXR0ZXJuID0gL15cL3BcLyhbXi9dKylcLy87CiAgICBjb25zdCBwb3N0VXJsUGF0dGVybiA9IC9pbnN0YWdyYW1cLmNvbVwvcFwvW1x3LV0rXC8vOwoKICAgIHZhciBzdmdEb3dubG9hZEJ0biA9IGA8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkNhcGFfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIGhlaWdodD0iMjQiIHdpZHRoPSIyNCIKICAgICB2aWV3Qm94PSIwIDAgNDc3Ljg2NyA0NzcuODY3IiBzdHlsZT0iZmlsbDolY29sb3I7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KICAgIDxnPgogICAgICAgIDxwYXRoIGQ9Ik00NDMuNzMzLDMwNy4yYy05LjQyNiwwLTE3LjA2Nyw3LjY0MS0xNy4wNjcsMTcuMDY3djEwMi40YzAsOS40MjYtNy42NDEsMTcuMDY3LTE3LjA2NywxNy4wNjdINjguMjY3CiAgICAgICAgICAgIGMtOS40MjYsMC0xNy4wNjctNy42NDEtMTcuMDY3LTE3LjA2N3YtMTAyLjRjMC05LjQyNi03LjY0MS0xNy4wNjctMTcuMDY3LTE3LjA2N3MtMTcuMDY3LDcuNjQxLTE3LjA2NywxNy4wNjd2MTAyLjQKICAgICAgICAgICAgYzAsMjguMjc3LDIyLjkyMyw1MS4yLDUxLjIsNTEuMkg0MDkuNmMyOC4yNzcsMCw1MS4yLTIyLjkyMyw1MS4yLTUxLjJ2LTEwMi40QzQ2MC44LDMxNC44NDEsNDUzLjE1OSwzMDcuMiw0NDMuNzMzLDMwNy4yeiIvPgogICAgPC9nPgogICAgPGc+CiAgICAgICAgPHBhdGggZD0iTTMzNS45NDcsMjk1LjEzNGMtNi42MTQtNi4zODctMTcuMDk5LTYuMzg3LTIzLjcxMiwwTDI1NiwzNTEuMzM0VjE3LjA2N0MyNTYsNy42NDEsMjQ4LjM1OSwwLDIzOC45MzMsMAogICAgICAgICAgICBzLTE3LjA2Nyw3LjY0MS0xNy4wNjcsMTcuMDY3djMzNC4yNjhsLTU2LjIwMS01Ni4yMDFjLTYuNzgtNi41NDgtMTcuNTg0LTYuMzYtMjQuMTMyLDAuNDE5Yy02LjM4OCw2LjYxNC02LjM4OCwxNy4wOTksMCwyMy43MTMKICAgICAgICAgICAgbDg1LjMzMyw4NS4zMzNjNi42NTcsNi42NzMsMTcuNDYzLDYuNjg3LDI0LjEzNiwwLjAzMWMwLjAxLTAuMDEsMC4wMi0wLjAyLDAuMDMxLTAuMDMxbDg1LjMzMy04NS4zMzMKICAgICAgICAgICAgQzM0Mi45MTUsMzEyLjQ4NiwzNDIuNzI3LDMwMS42ODIsMzM1Ljk0NywyOTUuMTM0eiIvPgogICAgPC9nPgo8L3N2Zz5gOwoKICAgIHZhciBzdmdOZXd0YWJCdG4gPSBgPHN2ZyBpZD0iQ2FwYV8xIiBzdHlsZT0iZmlsbDolY29sb3I7IiB2aWV3Qm94PSIwIDAgNDgyLjIzOSA0ODIuMjM5IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjQiIHdpZHRoPSIyNCI+CiAgICA8cGF0aCBkPSJtNDY1LjAxNiAwaC0zNDQuNDU2Yy05LjUyIDAtMTcuMjIzIDcuNzAzLTE3LjIyMyAxNy4yMjN2ODYuMTE0aC04Ni4xMTRjLTkuNTIgMC0xNy4yMjMgNy43MDMtMTcuMjIzIDE3LjIyM3YzNDQuNDU2YzAgOS41MiA3LjcwMyAxNy4yMjMgMTcuMjIzIDE3LjIyM2gzNDQuNDU2YzkuNTIgMCAxNy4yMjMtNy43MDMgMTcuMjIzLTE3LjIyM3YtODYuMTE0aDg2LjExNGM5LjUyIDAgMTcuMjIzLTcuNzAzIDE3LjIyMy0xNy4yMjN2LTM0NC40NTZjMC05LjUyLTcuNzAzLTE3LjIyMy0xNy4yMjMtMTcuMjIzem0tMTIwLjU2IDQ0Ny43OTNoLTMxMC4wMXYtMzEwLjAxaDMxMC4wMTF2MzEwLjAxem0xMDMuMzM3LTEwMy4zMzdoLTY4Ljg5MXYtMjIzLjg5NmMwLTkuNTItNy43MDMtMTcuMjIzLTE3LjIyMy0xNy4yMjNoLTIyMy44OTZ2LTY4Ljg5MWgzMTAuMDExdjMxMC4wMXoiLz4KPC9zdmc+YDsKCiAgICB2YXIgcHJlVXJsID0gIiI7CgogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGtleURvd25IYW5kbGVyKTsKCiAgICBmdW5jdGlvbiBrZXlEb3duSGFuZGxlcihldmVudCkgewogICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24uaHJlZiA9PT0gJ2h0dHBzOi8vd3d3Lmluc3RhZ3JhbS5jb20vJykgcmV0dXJuOwoKICAgICAgICBjb25zdCBtb2NrRXZlbnRUZW1wbGF0ZSA9IHsKICAgICAgICAgICAgc3RvcFByb3BhZ2F0aW9uOiBmdW5jdGlvbiAoKSB7IH0sCiAgICAgICAgICAgIHByZXZlbnREZWZhdWx0OiBmdW5jdGlvbiAoKSB7IH0KICAgICAgICB9OwoKICAgICAgICBpZiAoZXZlbnQuYWx0S2V5ICYmIChldmVudC5jb2RlID09PSAnS2V5SycgfHwgZXZlbnQua2V5ID09ICdrJykpIHsKICAgICAgICAgICAgbGV0IGJ1dHRvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdkb3dubG9hZC1idG4nKTsKICAgICAgICAgICAgaWYgKGJ1dHRvbnMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgbGV0IG1vY2tFdmVudCA9IHsgLi4ubW9ja0V2ZW50VGVtcGxhdGUgfTsKICAgICAgICAgICAgICAgIG1vY2tFdmVudC5jdXJyZW50VGFyZ2V0ID0gYnV0dG9uc1tidXR0b25zLmxlbmd0aCAtIDFdOwogICAgICAgICAgICAgICAgaWYgKHByZWZldGNoQW5kQXR0YWNoTGluayB8fCBob3ZlclRvRmV0Y2hBbmRBdHRhY2hMaW5rKSBvbk1vdXNlSW5IYW5kbGVyKG1vY2tFdmVudCk7CiAgICAgICAgICAgICAgICBvbkNsaWNrSGFuZGxlcihtb2NrRXZlbnQpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChldmVudC5hbHRLZXkgJiYgKGV2ZW50LmNvZGUgPT09ICdLZXlJJyB8fCBldmVudC5rZXkgPT0gJ2knKSkgewogICAgICAgICAgICBsZXQgYnV0dG9ucyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ25ld3RhYi1idG4nKTsKICAgICAgICAgICAgaWYgKGJ1dHRvbnMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgbGV0IG1vY2tFdmVudCA9IHsgLi4ubW9ja0V2ZW50VGVtcGxhdGUgfTsKICAgICAgICAgICAgICAgIG1vY2tFdmVudC5jdXJyZW50VGFyZ2V0ID0gYnV0dG9uc1tidXR0b25zLmxlbmd0aCAtIDFdOwogICAgICAgICAgICAgICAgaWYgKHByZWZldGNoQW5kQXR0YWNoTGluayB8fCBob3ZlclRvRmV0Y2hBbmRBdHRhY2hMaW5rKSBvbk1vdXNlSW5IYW5kbGVyKG1vY2tFdmVudCk7CiAgICAgICAgICAgICAgICBvbkNsaWNrSGFuZGxlcihtb2NrRXZlbnQpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoZXZlbnQuYWx0S2V5ICYmIChldmVudC5jb2RlID09PSAnS2V5TCcgfHwgZXZlbnQua2V5ID09ICdsJykpIHsKICAgICAgICAgICAgLy8gcmlnaHQgYXJyb3cKICAgICAgICAgICAgbGV0IGJ1dHRvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdfOXptMicpOwogICAgICAgICAgICBpZiAoYnV0dG9ucy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICBidXR0b25zWzBdLmNsaWNrKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChldmVudC5hbHRLZXkgJiYgKGV2ZW50LmNvZGUgPT09ICdLZXlKJyB8fCBldmVudC5rZXkgPT0gJ2onKSkgewogICAgICAgICAgICAvLyBsZWZ0IGFycm93CiAgICAgICAgICAgIGxldCBidXR0b25zID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnXzl6bTAnKTsKICAgICAgICAgICAgaWYgKGJ1dHRvbnMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgYnV0dG9uc1swXS5jbGljaygpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGlzUG9zdFBhZ2UoKSB7CiAgICAgICAgcmV0dXJuIEJvb2xlYW4od2luZG93LmxvY2F0aW9uLmhyZWYubWF0Y2gocG9zdFVybFBhdHRlcm4pKTsKICAgIH0KCiAgICBmdW5jdGlvbiBxdWVyeUhhcyhyb290LCBzZWxlY3RvciwgaGFzKSB7CiAgICAgICAgbGV0IG5vZGVzID0gcm9vdC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgKytpKSB7CiAgICAgICAgICAgIGxldCBjdXJyZW50Tm9kZSA9IG5vZGVzW2ldOwogICAgICAgICAgICBpZiAoY3VycmVudE5vZGUucXVlcnlTZWxlY3RvcihoYXMpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gY3VycmVudE5vZGU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgdmFyIGNoZWNrRXhpc3RUaW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgICBjb25zdCBjdXJVcmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjsKICAgICAgICBjb25zdCBzYXZlUG9zdFNlbGVjdG9yID0gJ2FydGljbGUgKjpub3QobGkpPio+Kj4qPmRpdjpub3QoW2NsYXNzXSk+ZGl2W3JvbGU9ImJ1dHRvbiJdOm5vdChbc3R5bGVdKTpub3QoW3RhYmluZGV4PSItMSJdKSc7CiAgICAgICAgY29uc3Qgc3RvcnlTZWxlY3RvciA9ICdzZWN0aW9uID4gKjpub3QobWFpbikgaGVhZGVyIGRpdj5zdmc6bm90KFthcmlhLWxhYmVsPSIiXSknOwogICAgICAgIGNvbnN0IHByb2ZpbGVTZWxlY3RvciA9ICdoZWFkZXIgc2VjdGlvbiBzdmcgY2lyY2xlJzsKICAgICAgICBjb25zdCBwbGF5U3ZnUGF0aFNlbGVjdG9yID0gJ3BhdGhbZD0iTTUuODg4IDIyLjVhMy40NiAzLjQ2IDAgMCAxLTEuNzIxLS40NmwtLjAwMy0uMDAyYTMuNDUxIDMuNDUxIDAgMCAxLTEuNzItMi45ODJWNC45NDNhMy40NDUgMy40NDUgMCAwIDEgNS4xNjMtMi45ODdsMTIuMjI2IDcuMDU5YTMuNDQ0IDMuNDQ0IDAgMCAxLS4wMDEgNS45NjdsLTEyLjIyIDcuMDU2YTMuNDYyIDMuNDYyIDAgMCAxLTEuNzI0LjQ2MloiXSc7CiAgICAgICAgY29uc3QgcGF1c2VTdmdQYXRoU2VsZWN0b3IgPSAncGF0aFtkPSJNMTUgMWMtMy4zIDAtNiAxLjMtNiAzdjQwYzAgMS43IDIuNyAzIDYgM3M2LTEuMyA2LTNWNGMwLTEuNy0yLjctMy02LTN6bTE4IDBjLTMuMyAwLTYgMS4zLTYgM3Y0MGMwIDEuNyAyLjcgMyA2IDNzNi0xLjMgNi0zVjRjMC0xLjctMi43LTMtNi0zeiJdJzsKCiAgICAgICAgbGV0IHJnYiA9IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuYmFja2dyb3VuZENvbG9yLm1hdGNoKC9bLj9cZF0rL2cpOwogICAgICAgIGxldCBpY29uQ29sb3IgPSAocmdiWzBdICogMC4yOTkgKyByZ2JbMV0gKiAwLjU4NyArIHJnYlsyXSAqIDAuMTE0KSA8PSAxNTAgPyAnd2hpdGUnIDogJ2JsYWNrJwoKICAgICAgICAvLyBjbGVhciBhbGwgY3VzdG9tIGJ1dHRvbnMgd2hlbiB1cmwgY2hhbmdpbmcKICAgICAgICBpZiAocHJlVXJsICE9PSBjdXJVcmwpIHsKICAgICAgICAgICAgd2hpbGUgKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2N1c3RvbS1idG4nKS5sZW5ndGggIT09IDApIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2N1c3RvbS1idG4nKVswXS5yZW1vdmUoKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gY2hlY2sgcG9zdAogICAgICAgIGxldCBhcnRpY2xlTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2FydGljbGUnKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFydGljbGVMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGxldCBidXR0b25BbmNob3IgPSAoQXJyYXkuZnJvbShhcnRpY2xlTGlzdFtpXS5xdWVyeVNlbGVjdG9yQWxsKHNhdmVQb3N0U2VsZWN0b3IpKSkucG9wKCk7CiAgICAgICAgICAgIGlmIChidXR0b25BbmNob3IgJiYgYXJ0aWNsZUxpc3RbaV0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY3VzdG9tLWJ0bicpLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgYWRkQ3VzdG9tQnRuKGJ1dHRvbkFuY2hvciwgaWNvbkNvbG9yLCBhcHBlbmQyUG9zdCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIGNoZWNrIGluZGVwZW5kZW50IHBvc3QgcGFnZQogICAgICAgIGlmIChpc1Bvc3RQYWdlKCkpIHsKICAgICAgICAgICAgbGV0IHNhdmVidG4gPSBxdWVyeUhhcyhkb2N1bWVudCwgJ2Rpdltyb2xlPSJidXR0b24iXSA+IGRpdltyb2xlPSJidXR0b24iXTpub3QoW3N0eWxlXSknLCAncG9seWdvbltwb2ludHM9IjIwIDIxIDEyIDEzLjQ0IDQgMjEgNCAzIDIwIDMgMjAgMjEiXScpIHx8IHF1ZXJ5SGFzKGRvY3VtZW50LCAnZGl2W3JvbGU9ImJ1dHRvbiJdID4gZGl2W3JvbGU9ImJ1dHRvbiJdOm5vdChbc3R5bGVdKScsICdwYXRoW2Q9Ik0yMCAyMmEuOTk5Ljk5OSAwIDAgMS0uNjg3LS4yNzNMMTIgMTQuODE1bC03LjMxMyA2LjkxMkExIDEgMCAwIDEgMyAyMVYzYTEgMSAwIDAgMSAxLTFoMTZhMSAxIDAgMCAxIDEgMXYxOGExIDEgMCAwIDEtMSAxWiJdJyk7CiAgICAgICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjdXN0b20tYnRuJykubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICBpZiAoc2F2ZWJ0bi5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJ3N2ZycpKSB7CiAgICAgICAgICAgICAgICAgICAgYWRkQ3VzdG9tQnRuKHNhdmVidG4ucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCdzdmcnKSwgaWNvbkNvbG9yLCBhcHBlbmQySW5kZXBlbmRlbnRQb3N0KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gY2hlY2sgcHJvZmlsZQogICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjdXN0b20tYnRuJykubGVuZ3RoID09PSAwICYmICFjdXJVcmwuaW5jbHVkZXMoInN0b3IiKSkgewogICAgICAgICAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlU2VsZWN0b3IpKSB7CiAgICAgICAgICAgICAgICBhZGRDdXN0b21CdG4oZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlU2VsZWN0b3IpLCBpY29uQ29sb3IsIGFwcGVuZDJIZWFkZXIpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBjaGVjayBzdG9yeQogICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjdXN0b20tYnRuJykubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIGxldCBwbGF5UGF1c2VTdmcgPSBxdWVyeUhhcyhkb2N1bWVudCwgJ3N2ZycsIHBsYXlTdmdQYXRoU2VsZWN0b3IpIHx8IHF1ZXJ5SGFzKGRvY3VtZW50LCAnc3ZnJywgcGF1c2VTdmdQYXRoU2VsZWN0b3IpOwogICAgICAgICAgICBpZiAocGxheVBhdXNlU3ZnKSB7CiAgICAgICAgICAgICAgICBsZXQgYnV0dG9uRGl2ID0gcGxheVBhdXNlU3ZnLnBhcmVudE5vZGU7CiAgICAgICAgICAgICAgICBhZGRDdXN0b21CdG4oYnV0dG9uRGl2LCAnd2hpdGUnLCBhcHBlbmQyU3RvcnkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBwcmVVcmwgPSBjdXJVcmw7CiAgICB9LCA1MDApOwoKICAgIGZ1bmN0aW9uIGFwcGVuZDJQb3N0KG5vZGUsIGJ0bikgewogICAgICAgIG5vZGUuYXBwZW5kKGJ0bik7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwZW5kMkluZGVwZW5kZW50UG9zdChub2RlLCBidG4pIHsKICAgICAgICBub2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5hcHBlbmQoYnRuKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHBlbmQySGVhZGVyKG5vZGUsIGJ0bikgewogICAgICAgIG5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQoYnRuLCBub2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZSk7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwZW5kMlN0b3J5KG5vZGUsIGJ0bikgewogICAgICAgIG5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuYXBwZW5kKGJ0bik7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkQ3VzdG9tQnRuKG5vZGUsIGljb25Db2xvciwgYXBwZW5kTm9kZSkgewogICAgICAgIC8vIGFkZCBkb3dubG9hZCBidXR0b24gYW5kIHNldCBldmVudCBoYW5kbGVycwogICAgICAgIC8vIGFkZCBuZXd0YWIgYnV0dG9uCiAgICAgICAgbGV0IG5ld3RhYkJ0biA9IGNyZWF0ZUN1c3RvbUJ0bihzdmdOZXd0YWJCdG4sIGljb25Db2xvciwgJ25ld3RhYi1idG4nLCAnMTZweCcpOwogICAgICAgIGFwcGVuZE5vZGUobm9kZSwgbmV3dGFiQnRuKTsKCiAgICAgICAgLy8gYWRkIGRvd25sb2FkIGJ1dHRvbgogICAgICAgIGxldCBkb3dubG9hZEJ0biA9IGNyZWF0ZUN1c3RvbUJ0bihzdmdEb3dubG9hZEJ0biwgaWNvbkNvbG9yLCAnZG93bmxvYWQtYnRuJywgJzE0cHgnKTsKICAgICAgICBhcHBlbmROb2RlKG5vZGUsIGRvd25sb2FkQnRuKTsKCiAgICAgICAgaWYgKHByZWZldGNoQW5kQXR0YWNoTGluaykgewogICAgICAgICAgICBvbk1vdXNlSW5IYW5kbGVyKHsgY3VycmVudFRhcmdldDogbmV3dGFiQnRuIH0pOwogICAgICAgICAgICBvbk1vdXNlSW5IYW5kbGVyKHsgY3VycmVudFRhcmdldDogZG93bmxvYWRCdG4gfSk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGNyZWF0ZUN1c3RvbUJ0bihzdmcsIGljb25Db2xvciwgY2xhc3NOYW1lLCBtYXJnaW5MZWZ0KSB7CiAgICAgICAgbGV0IG5ld0J0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgICBuZXdCdG4uaW5uZXJIVE1MID0gc3ZnLnJlcGxhY2UoJyVjb2xvcicsIGljb25Db2xvcik7CiAgICAgICAgbmV3QnRuLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnY3VzdG9tLWJ0biAnICsgY2xhc3NOYW1lKTsKICAgICAgICBuZXdCdG4uc2V0QXR0cmlidXRlKCd0YXJnZXQnLCAnX2JsYW5rJyk7CiAgICAgICAgbmV3QnRuLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnY3Vyc29yOiBwb2ludGVyO21hcmdpbi1sZWZ0OiAnICsgbWFyZ2luTGVmdCArICc7bWFyZ2luLXRvcDogOHB4O3otaW5kZXg6IDk5OTsnKTsKICAgICAgICBuZXdCdG4ub25jbGljayA9IG9uQ2xpY2tIYW5kbGVyOwogICAgICAgIGlmIChob3ZlclRvRmV0Y2hBbmRBdHRhY2hMaW5rKSBuZXdCdG4ub25tb3VzZWVudGVyID0gb25Nb3VzZUluSGFuZGxlcjsKICAgICAgICBpZiAoY2xhc3NOYW1lLmluY2x1ZGVzKCduZXd0YWInKSkgewogICAgICAgICAgICBuZXdCdG4uc2V0QXR0cmlidXRlKCd0aXRsZScsICdPcGVuIGluIG5ldyB0YWInKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdCdG4uc2V0QXR0cmlidXRlKCd0aXRsZScsICdEb3dubG9hZCcpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbmV3QnRuOwogICAgfQoKICAgIGZ1bmN0aW9uIG9uQ2xpY2tIYW5kbGVyKGUpIHsKICAgICAgICAvLyBoYW5kbGUgYnV0dG9uIGNsaWNrCiAgICAgICAgbGV0IHRhcmdldCA9IGUuY3VycmVudFRhcmdldDsKICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLmluY2x1ZGVzKCdzdG9yaWVzJykpIHsKICAgICAgICAgICAgc3RvcnlPbkNsaWNrZWQodGFyZ2V0KTsKICAgICAgICB9IGVsc2UgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2hlYWRlcicpICYmIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2hlYWRlcicpLmNvbnRhaW5zKHRhcmdldCkpIHsKICAgICAgICAgICAgcHJvZmlsZU9uQ2xpY2tlZCh0YXJnZXQpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHBvc3RPbkNsaWNrZWQodGFyZ2V0KTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gb25Nb3VzZUluSGFuZGxlcihlKSB7CiAgICAgICAgbGV0IHRhcmdldCA9IGUuY3VycmVudFRhcmdldDsKICAgICAgICBpZiAoIXByZWZldGNoQW5kQXR0YWNoTGluayAmJiAhaG92ZXJUb0ZldGNoQW5kQXR0YWNoTGluaykgcmV0dXJuOwogICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuaW5jbHVkZXMoJ3N0b3JpZXMnKSkgewogICAgICAgICAgICBzdG9yeU9uTW91c2VJbih0YXJnZXQpOwogICAgICAgIH0gZWxzZSBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaGVhZGVyJykgJiYgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaGVhZGVyJykuY29udGFpbnModGFyZ2V0KSkgewogICAgICAgICAgICBwcm9maWxlT25Nb3VzZUluKHRhcmdldCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcG9zdE9uTW91c2VJbih0YXJnZXQpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgLy8gPT09PSAgICAgICAgUHJvZmlsZSAgICAgICAgID09PT0KICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICBmdW5jdGlvbiBwcm9maWxlT25Nb3VzZUluKHRhcmdldCkgewogICAgICAgIGxldCB1cmwgPSBwcm9maWxlR2V0VXJsKHRhcmdldCk7CiAgICAgICAgdGFyZ2V0LnNldEF0dHJpYnV0ZSgnaHJlZicsIHVybCk7CiAgICB9CgogICAgZnVuY3Rpb24gcHJvZmlsZU9uQ2xpY2tlZCh0YXJnZXQpIHsKICAgICAgICAvLyBleHRyYWN0IHByb2ZpbGUgcGljdHVyZSB1cmwgYW5kIGRvd25sb2FkIG9yIG9wZW4gaXQKICAgICAgICBsZXQgdXJsID0gcHJvZmlsZUdldFVybCh0YXJnZXQpOwoKICAgICAgICBpZiAodXJsLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgLy8gY2hlY2sgdXJsCiAgICAgICAgICAgIGlmICh0YXJnZXQuZ2V0QXR0cmlidXRlKCdjbGFzcycpLmluY2x1ZGVzKCdkb3dubG9hZC1idG4nKSkgewogICAgICAgICAgICAgICAgLy8gZ2VuZXJhdGUgZmlsZW5hbWUKICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVuYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaGVhZGVyIGgyJykudGV4dENvbnRlbnQ7CiAgICAgICAgICAgICAgICBkb3dubG9hZFJlc291cmNlKHVybCwgZmlsZW5hbWUpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gb3BlbiB1cmwgaW4gbmV3IHRhYgogICAgICAgICAgICAgICAgb3BlblJlc291cmNlKHVybCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gcHJvZmlsZUdldFVybCh0YXJnZXQpIHsKICAgICAgICBsZXQgaW1nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaGVhZGVyIGltZycpOwogICAgICAgIGxldCB1cmwgPSBpbWcuZ2V0QXR0cmlidXRlKCdzcmMnKTsKICAgICAgICByZXR1cm4gdXJsOwogICAgfQoKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAvLyA9PT09ICAgICAgICAgUG9zdCAgICAgICAgICAgPT09PQogICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIGFzeW5jIGZ1bmN0aW9uIHBvc3RPbk1vdXNlSW4odGFyZ2V0KSB7CiAgICAgICAgbGV0IGFydGljbGVOb2RlID0gcG9zdEdldEFydGljbGVOb2RlKHRhcmdldCk7CiAgICAgICAgbGV0IHsgdXJsIH0gPSBhd2FpdCBwb3N0R2V0VXJsKHRhcmdldCwgYXJ0aWNsZU5vZGUpOwogICAgICAgIHRhcmdldC5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCB1cmwpOwogICAgfQoKICAgIGFzeW5jIGZ1bmN0aW9uIHBvc3RPbkNsaWNrZWQodGFyZ2V0KSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgLy8gZXh0cmFjdCB1cmwgZnJvbSB0YXJnZXQgcG9zdCBhbmQgZG93bmxvYWQgb3Igb3BlbiBpdAogICAgICAgICAgICBsZXQgYXJ0aWNsZU5vZGUgPSBwb3N0R2V0QXJ0aWNsZU5vZGUodGFyZ2V0KTsKICAgICAgICAgICAgbGV0IHsgdXJsLCBtZWRpYUluZGV4IH0gPSBhd2FpdCBwb3N0R2V0VXJsKHRhcmdldCwgYXJ0aWNsZU5vZGUpOwoKICAgICAgICAgICAgLy8gZG93bmxvYWQgb3Igb3BlbiBtZWRpYSB1cmwKICAgICAgICAgICAgaWYgKHVybC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAvLyBjaGVjayB1cmwKICAgICAgICAgICAgICAgIGlmICh0YXJnZXQuZ2V0QXR0cmlidXRlKCdjbGFzcycpLmluY2x1ZGVzKCdkb3dubG9hZC1idG4nKSkgewogICAgICAgICAgICAgICAgICAgIGxldCBtZWRpYU5hbWUgPSB1cmwKICAgICAgICAgICAgICAgICAgICAgICAgLnNwbGl0KCc/JylbMF0KICAgICAgICAgICAgICAgICAgICAgICAgLnNwbGl0KCdcXCcpCiAgICAgICAgICAgICAgICAgICAgICAgIC5wb3AoKQogICAgICAgICAgICAgICAgICAgICAgICAuc3BsaXQoJy8nKQogICAgICAgICAgICAgICAgICAgICAgICAucG9wKCk7CiAgICAgICAgICAgICAgICAgICAgbWVkaWFOYW1lID0gbWVkaWFOYW1lLnN1YnN0cmluZygwLCBtZWRpYU5hbWUubGFzdEluZGV4T2YoJy4nKSk7CiAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGV0aW1lID0gbmV3IERhdGUoYXJ0aWNsZU5vZGUucXVlcnlTZWxlY3RvcigndGltZScpLmdldEF0dHJpYnV0ZSgnZGF0ZXRpbWUnKSk7CiAgICAgICAgICAgICAgICAgICAgbGV0IHBvc3Rlck5hbWUgPSBhcnRpY2xlTm9kZS5xdWVyeVNlbGVjdG9yKCdoZWFkZXIgYScpIHx8IGZpbmRQb3N0TmFtZShhcnRpY2xlTm9kZSk7CiAgICAgICAgICAgICAgICAgICAgcG9zdGVyTmFtZSA9IHBvc3Rlck5hbWUuZ2V0QXR0cmlidXRlKCdocmVmJykucmVwbGFjZSgvXC8vZywgJycpOwogICAgICAgICAgICAgICAgICAgIGxldCBwb3N0SWQgPSBmaW5kUG9zdElkKGFydGljbGVOb2RlKTsKICAgICAgICAgICAgICAgICAgICBsZXQgZmlsZW5hbWUgPSBmaWxlbmFtZUZvcm1hdChwb3N0RmlsZW5hbWVUZW1wbGF0ZSwgcG9zdGVyTmFtZSwgZGF0ZXRpbWUsIG1lZGlhTmFtZSwgcG9zdElkLCBtZWRpYUluZGV4KTsKICAgICAgICAgICAgICAgICAgICBkb3dubG9hZFJlc291cmNlKHVybCwgZmlsZW5hbWUpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAvLyBvcGVuIHVybCBpbiBuZXcgdGFiCiAgICAgICAgICAgICAgICAgICAgb3BlblJlc291cmNlKHVybCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBVbmNhdGNoZWQgaW4gcG9zdE9uQ2xpY2tlZCgpOiAke2V9XG4ke2Uuc3RhY2t9YCk7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBwb3N0R2V0QXJ0aWNsZU5vZGUodGFyZ2V0KSB7CiAgICAgICAgbGV0IGFydGljbGVOb2RlID0gdGFyZ2V0OwogICAgICAgIHdoaWxlIChhcnRpY2xlTm9kZSAmJiBhcnRpY2xlTm9kZS50YWdOYW1lICE9PSAnQVJUSUNMRScgJiYgYXJ0aWNsZU5vZGUudGFnTmFtZSAhPT0gJ01BSU4nKSB7CiAgICAgICAgICAgIGFydGljbGVOb2RlID0gYXJ0aWNsZU5vZGUucGFyZW50Tm9kZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGFydGljbGVOb2RlOwogICAgfQoKICAgIGFzeW5jIGZ1bmN0aW9uIHBvc3RHZXRVcmwodGFyZ2V0LCBhcnRpY2xlTm9kZSkgewogICAgICAgIC8vIG1ldGFbcHJvcGVydHk9Im9nOnZpZGVvIl0KICAgICAgICBsZXQgbGlzdCA9IGFydGljbGVOb2RlLnF1ZXJ5U2VsZWN0b3JBbGwoJ2xpW3N0eWxlXVtjbGFzc10nKTsKICAgICAgICBsZXQgdXJsID0gbnVsbDsKICAgICAgICBsZXQgbWVkaWFJbmRleCA9IDA7CiAgICAgICAgaWYgKGxpc3QubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIC8vIHNpbmdsZSBpbWcgb3IgdmlkZW8KICAgICAgICAgICAgaWYgKCFkaXNhYmxlTmV3VXJsRmV0Y2hNZXRob2QpIHVybCA9IGF3YWl0IGdldFVybEZyb21JbmZvQXBpKGFydGljbGVOb2RlKTsKICAgICAgICAgICAgaWYgKHVybCA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgbGV0IHZpZGVvRWxlbSA9IGFydGljbGVOb2RlLnF1ZXJ5U2VsZWN0b3IoJ3ZpZGVvJyk7CiAgICAgICAgICAgICAgICBpZiAodmlkZW9FbGVtKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gbWVkaWEgdHlwZSBpcyB2aWRlbwogICAgICAgICAgICAgICAgICAgIHVybCA9IHZpZGVvRWxlbS5nZXRBdHRyaWJ1dGUoJ3NyYycpOwogICAgICAgICAgICAgICAgICAgIGlmICh2aWRlb0VsZW0uaGFzQXR0cmlidXRlKCd2aWRlb1VSTCcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IHZpZGVvRWxlbS5nZXRBdHRyaWJ1dGUoJ3ZpZGVvVVJMJyk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh1cmwgPT09IG51bGwgfHwgdXJsLmluY2x1ZGVzKCdibG9iJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gYXdhaXQgZmV0Y2hWaWRlb1VSTChhcnRpY2xlTm9kZSwgdmlkZW9FbGVtKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFydGljbGVOb2RlLnF1ZXJ5U2VsZWN0b3IoJ2FydGljbGUgIGRpdltyb2xlXSBkaXYgPiBpbWcnKSkgewogICAgICAgICAgICAgICAgICAgIC8vIG1lZGlhIHR5cGUgaXMgaW1hZ2UKICAgICAgICAgICAgICAgICAgICB1cmwgPSBhcnRpY2xlTm9kZS5xdWVyeVNlbGVjdG9yKCdhcnRpY2xlICBkaXZbcm9sZV0gZGl2ID4gaW1nJykuZ2V0QXR0cmlidXRlKCdzcmMnKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycjogbm90IGZpbmQgbWVkaWEgYXQgaGFuZGxlIHBvc3Qgc2luZ2xlJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBtdWx0aXBsZSBpbWdzIG9yIHZpZGVvcwogICAgICAgICAgICBjb25zdCBwb3N0VmlldyA9IGxvY2F0aW9uLnBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9wLycpOwogICAgICAgICAgICBsZXQgZG90c0VsZW1lbnRzID0gWy4uLmFydGljbGVOb2RlLnF1ZXJ5U2VsZWN0b3JBbGwoYGRpdi5fYWNuYmApXTsKICAgICAgICAgICAgbWVkaWFJbmRleCA9IFsuLi5kb3RzRWxlbWVudHNdLnJlZHVjZSgocmVzdWx0LCBlbGVtZW50LCBpbmRleCkgPT4gKGVsZW1lbnQuY2xhc3NMaXN0Lmxlbmd0aCA9PT0gMiA/IGluZGV4IDogcmVzdWx0KSwgbnVsbCk7CiAgICAgICAgICAgIGlmIChtZWRpYUluZGV4ID09PSBudWxsKSB0aHJvdyAnQ2Fubm90IGZpbmQgdGhlIG1lZGlhIGluZGV4JzsKCiAgICAgICAgICAgIGlmICghZGlzYWJsZU5ld1VybEZldGNoTWV0aG9kKSB1cmwgPSBhd2FpdCBnZXRVcmxGcm9tSW5mb0FwaShhcnRpY2xlTm9kZSwgbWVkaWFJbmRleCk7CiAgICAgICAgICAgIGlmICh1cmwgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGxpc3RFbGVtZW50cyA9IFsuLi5hcnRpY2xlTm9kZS5xdWVyeVNlbGVjdG9yQWxsKGA6c2NvcGUgPiBkaXYgPiBkaXY6bnRoLWNoaWxkKCR7cG9zdFZpZXcgPyAxIDogMn0pID4gZGl2ID4gZGl2Om50aC1jaGlsZCgxKSB1bCBsaVtzdHlsZSo9InRyYW5zbGF0ZVgiXWApXTsKICAgICAgICAgICAgICAgIGNvbnN0IGxpc3RFbGVtZW50V2lkdGggPSBNYXRoLm1heCguLi5saXN0RWxlbWVudHMubWFwKGVsZW1lbnQgPT4gZWxlbWVudC5jbGllbnRXaWR0aCkpOwoKICAgICAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uc01hcCA9IGxpc3RFbGVtZW50cy5yZWR1Y2UoKHJlc3VsdCwgZWxlbWVudCkgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gTWF0aC5yb3VuZChOdW1iZXIoZWxlbWVudC5zdHlsZS50cmFuc2Zvcm0ubWF0Y2goLy0/KFxkKykvKVsxXSkgLyBsaXN0RWxlbWVudFdpZHRoKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4geyAuLi5yZXN1bHQsIFtwb3NpdGlvbl06IGVsZW1lbnQgfTsKICAgICAgICAgICAgICAgIH0sIHt9KTsKCiAgICAgICAgICAgICAgICBjb25zdCBub2RlID0gcG9zaXRpb25zTWFwW21lZGlhSW5kZXhdOwogICAgICAgICAgICAgICAgaWYgKG5vZGUucXVlcnlTZWxlY3RvcigndmlkZW8nKSkgewogICAgICAgICAgICAgICAgICAgIC8vIG1lZGlhIHR5cGUgaXMgdmlkZW8KICAgICAgICAgICAgICAgICAgICBsZXQgdmlkZW9FbGVtID0gbm9kZS5xdWVyeVNlbGVjdG9yKCd2aWRlbycpOwogICAgICAgICAgICAgICAgICAgIHVybCA9IHZpZGVvRWxlbS5nZXRBdHRyaWJ1dGUoJ3NyYycpOwogICAgICAgICAgICAgICAgICAgIGlmICh2aWRlb0VsZW0uaGFzQXR0cmlidXRlKCd2aWRlb1VSTCcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IHZpZGVvRWxlbS5nZXRBdHRyaWJ1dGUoJ3ZpZGVvVVJMJyk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh1cmwgPT09IG51bGwgfHwgdXJsLmluY2x1ZGVzKCdibG9iJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gYXdhaXQgZmV0Y2hWaWRlb1VSTChhcnRpY2xlTm9kZSwgdmlkZW9FbGVtKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vZGUucXVlcnlTZWxlY3RvcignaW1nJykpIHsKICAgICAgICAgICAgICAgICAgICAvLyBtZWRpYSB0eXBlIGlzIGltYWdlCiAgICAgICAgICAgICAgICAgICAgdXJsID0gbm9kZS5xdWVyeVNlbGVjdG9yKCdpbWcnKS5nZXRBdHRyaWJ1dGUoJ3NyYycpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB7IHVybCwgbWVkaWFJbmRleCB9OwogICAgfQoKICAgIGZ1bmN0aW9uIGZpbmRIaWdobGlnaHRzSW5kZXgoKSB7CiAgICAgICAgbGV0IGN1cnJlbnREaXZQcm9ncmVzc2JhckRpdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2RpdltzdHlsZV49InRyYW5zZm9ybSJdJykucGFyZW50RWxlbWVudDsKICAgICAgICBsZXQgcHJvZ3Jlc3NiYXJSb290RGl2ID0gY3VycmVudERpdlByb2dyZXNzYmFyRGl2LnBhcmVudEVsZW1lbnQ7CiAgICAgICAgbGV0IHByb2dyZXNzYmFyRGl2cyA9IHByb2dyZXNzYmFyUm9vdERpdi5jaGlsZHJlbjsKICAgICAgICByZXR1cm4gQXJyYXkuZnJvbShwcm9ncmVzc2JhckRpdnMpLmluZGV4T2YoY3VycmVudERpdlByb2dyZXNzYmFyRGl2KTsKICAgIH0KCiAgICBsZXQgaW5mb0NhY2hlID0ge307IC8vIGtleTogbWVkaWEgaWQsIHZhbHVlOiBpbmZvIGpzb24KICAgIGxldCBtZWRpYUlkQ2FjaGUgPSB7fTsgLy8ga2V5OiBwb3N0IGlkLCB2YWx1ZTogbWVkaWEgaWQKICAgIGFzeW5jIGZ1bmN0aW9uIGdldFVybEZyb21JbmZvQXBpKGFydGljbGVOb2RlLCBtZWRpYUlkeCA9IDApIHsKICAgICAgICAvLyByZXR1cm4gbWVkaWEgdXJsIGlmIGZvdW5kIGVsc2UgcmV0dXJuIG51bGwKICAgICAgICAvLyBmZXRjaCBmbG93OgogICAgICAgIC8vCSAxLiBmaW5kIHBvc3QgaWQKICAgICAgICAvLyAgIDIuIHVzZSBzdGVwMSBwb3N0IGlkIHRvIHNlbmQgcmVxdWVzdCB0byBnZXQgcG9zdCBwYWdlCiAgICAgICAgLy8gICAzLiBmaW5kIG1lZGlhIGlkIGZyb20gdGhlIHJlcG9uc2UgdGV4dCBvZiBzdGVwMgogICAgICAgIC8vICAgNC4gZmluZCBhcHAgaWQgaW4gY2xpY2tlZCBwYWdlCiAgICAgICAgLy8gICA1LiBzZW5kIGluZm8gYXBpIHJlcXVlc3Qgd2l0aCBtZWRpYSBpZCBhbmQgYXBwIGlkCiAgICAgICAgLy8gICA2LiBnZXQgbWVkaWEgdXJsIGZyb20gcmVzcG9uc2UganNvbgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IGFwcElkUGF0dGVybiA9IC8iWC1JRy1BcHAtSUQiOiIoW1xkXSspIi87CiAgICAgICAgICAgIGNvbnN0IG1lZGlhSWRQYXR0ZXJuID0gL2luc3RhZ3JhbTpcL1wvbWVkaWFcP2lkPShcZCspfFsiJyBdbWVkaWFfaWRbIicgXTpbIicgXShcZCspWyInIF0vOwogICAgICAgICAgICBmdW5jdGlvbiBmaW5kQXBwSWQoKSB7CiAgICAgICAgICAgICAgICBsZXQgYm9keVNjcmlwdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJib2R5ID4gc2NyaXB0Iik7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJvZHlTY3JpcHRzLmxlbmd0aDsgKytpKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IG1hdGNoID0gYm9keVNjcmlwdHNbaV0udGV4dC5tYXRjaChhcHBJZFBhdHRlcm4pOwogICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaCkgcmV0dXJuIG1hdGNoWzFdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkNhbm5vdCBmaW5kIGFwcCBpZCIpOwogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIGZpbmRNZWRpYUlkKCkgewogICAgICAgICAgICAgICAgLy8gbWV0aG9kIDE6IGV4dHJhY3QgZnJvbSB1cmwuCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBtZXRob2QxKCkgewogICAgICAgICAgICAgICAgICAgIGxldCBocmVmID0gd2luZG93LmxvY2F0aW9uLmhyZWY7CiAgICAgICAgICAgICAgICAgICAgbGV0IG1hdGNoID0gaHJlZi5tYXRjaCgvd3d3Lmluc3RhZ3JhbS5jb21cL3N0b3JpZXNcL1teXC9dK1wvKFxkKykvKTsKICAgICAgICAgICAgICAgICAgICBpZiAoIWhyZWYuaW5jbHVkZXMoJ2hpZ2hsaWdodHMnKSAmJiBtYXRjaCkgcmV0dXJuIG1hdGNoWzFdOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIG1ldGhvZCAzCiAgICAgICAgICAgICAgICBhc3luYyBmdW5jdGlvbiBtZXRob2QzKCkgewogICAgICAgICAgICAgICAgICAgIGxldCBwb3N0SWQgPSBhd2FpdCBmaW5kUG9zdElkKGFydGljbGVOb2RlKTsKICAgICAgICAgICAgICAgICAgICBpZiAoIXBvc3RJZCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmICghKHBvc3RJZCBpbiBtZWRpYUlkQ2FjaGUpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwb3N0VXJsID0gYGh0dHBzOi8vd3d3Lmluc3RhZ3JhbS5jb20vcC8ke3Bvc3RJZH0vYDsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3AgPSBhd2FpdCBmZXRjaChwb3N0VXJsKTsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRleHQgPSBhd2FpdCByZXNwLnRleHQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGlkTWF0Y2ggPSB0ZXh0ID8gdGV4dC5tYXRjaChtZWRpYUlkUGF0dGVybikgOiBbXTsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1lZGlhSWQgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlkTWF0Y2gubGVuZ3RoOyArK2kpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZE1hdGNoW2ldKSBtZWRpYUlkID0gaWRNYXRjaFtpXTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW1lZGlhSWQpIHJldHVybiBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICBtZWRpYUlkQ2FjaGVbcG9zdElkXSA9IG1lZGlhSWQ7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHJldHVybiBtZWRpYUlkQ2FjaGVbcG9zdElkXTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBtZXRob2QyKCkgewogICAgICAgICAgICAgICAgICAgIGxldCBzY3JpcHRKc29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnc2NyaXB0W3R5cGU9ImFwcGxpY2F0aW9uL2pzb24iXScpOwogICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2NyaXB0SnNvbi5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICBsZXQgbWF0Y2ggPSBzY3JpcHRKc29uW2ldLnRleHQubWF0Y2goLyJwayI6IihcZCspIiwiaWQiOiJbXGRfXSsiLyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF3aW5kb3cubG9jYXRpb24uaHJlZi5pbmNsdWRlcygnaGlnaGxpZ2h0cycpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoWzFdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1hdGNocyA9IEFycmF5LmZyb20oc2NyaXB0SnNvbltpXS50ZXh0Lm1hdGNoQWxsKC8icGsiOiIoXGQrKSIsImlkIjoiW1xkX10rIi9nKSwgbWF0Y2ggPT4gbWF0Y2hbMV0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hJbmRleCA9IGZpbmRIaWdobGlnaHRzSW5kZXgoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaHMubGVuZ3RoID4gbWF0Y2hJbmRleCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXRjaHNbbWF0Y2hJbmRleF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIG1ldGhvZDEoKSB8fCBhd2FpdCBtZXRob2QzKCkgfHwgbWV0aG9kMigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBnZXRJbWdPclZlZGlvVXJsKGl0ZW0pIHsKICAgICAgICAgICAgICAgIGlmICgidmlkZW9fdmVyc2lvbnMiIGluIGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS52aWRlb192ZXJzaW9uc1swXS51cmw7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLmltYWdlX3ZlcnNpb25zMi5jYW5kaWRhdGVzWzBdLnVybDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgbGV0IGFwcElkID0gZmluZEFwcElkKCk7CiAgICAgICAgICAgIGlmICghYXBwSWQpIHJldHVybiBudWxsOwogICAgICAgICAgICBsZXQgaGVhZGVycyA9IHsKICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsCiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQWNjZXB0OiAnKi8qJywKICAgICAgICAgICAgICAgICAgICAnWC1JRy1BcHAtSUQnOiBhcHBJZAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGNyZWRlbnRpYWxzOiAnaW5jbHVkZScsCiAgICAgICAgICAgICAgICBtb2RlOiAnY29ycycKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGxldCBtZWRpYUlkID0gYXdhaXQgZmluZE1lZGlhSWQoKTsKICAgICAgICAgICAgaWYgKCFtZWRpYUlkKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiQ2Fubm90IGZpbmQgbWVkaWEgaWQiKTsKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghKG1lZGlhSWQgaW4gaW5mb0NhY2hlKSkgewogICAgICAgICAgICAgICAgbGV0IHVybCA9ICdodHRwczovL2kuaW5zdGFncmFtLmNvbS9hcGkvdjEvbWVkaWEvJyArIG1lZGlhSWQgKyAnL2luZm8vJzsKICAgICAgICAgICAgICAgIGxldCByZXNwID0gYXdhaXQgZmV0Y2godXJsLCBoZWFkZXJzKTsKICAgICAgICAgICAgICAgIGlmIChyZXNwLnN0YXR1cyAhPT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEZldGNoIGluZm8gQVBJIGZhaWxlZCB3aXRoIHN0YXR1cyBjb2RlOiAke3Jlc3Auc3RhdHVzfWApOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGV0IHJlc3BKc29uID0gYXdhaXQgcmVzcC5qc29uKCk7CiAgICAgICAgICAgICAgICBpbmZvQ2FjaGVbbWVkaWFJZF0gPSByZXNwSnNvbjsKICAgICAgICAgICAgfQogICAgICAgICAgICBsZXQgaW5mb0pzb24gPSBpbmZvQ2FjaGVbbWVkaWFJZF07CiAgICAgICAgICAgIGlmICgnY2Fyb3VzZWxfbWVkaWEnIGluIGluZm9Kc29uLml0ZW1zWzBdKSB7CiAgICAgICAgICAgICAgICAvLyBtdWx0aS1tZWRpYSBwb3N0CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0SW1nT3JWZWRpb1VybChpbmZvSnNvbi5pdGVtc1swXS5jYXJvdXNlbF9tZWRpYVttZWRpYUlkeF0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gc2luZ2xlIG1lZGlhIHBvc3QKICAgICAgICAgICAgICAgIHJldHVybiBnZXRJbWdPclZlZGlvVXJsKGluZm9Kc29uLml0ZW1zWzBdKTsKICAgICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coYFVuY2F0Y2hlZCBpbiBnZXRVcmxGcm9tSW5mb0FwaSgpOiAke2V9XG4ke2Uuc3RhY2t9YCk7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBmaW5kUG9zdE5hbWUoYXJ0aWNsZU5vZGUpIHsKICAgICAgICAvLyB0aGlzIGdyYWJzIHRoZSB1c2VybmFtZSBsaW5rIHRoYXQgaXMgdmlzdWFsbHkgaW4gdGhlIGF1dGhvcidzIHBvc3QgY29tbWVudCBiZWxvdyB0aGUgbWVkaWEgCiAgICAgICAgLy8gJ2FydGljbGUgc2VjdGlvbicgaW5jbHVkZXMgdGhlIGxpa2VzIHNlY3Rpb24gYW5kIGNvbW1lbnQgYm94CiAgICAgICAgLy8gJysgKiBhJyBwdWxscyB0aGUgZmlyc3QgZWxlbWVudCBhZnRlciB0aGUgc2VjdGlvbiB0aGF0IGNvbnRhaW5zIGEgbGluayAoY29tbWVudCBib3ggZG9lc24ndCkKICAgICAgICAvLyAnW2hyZWZePSIvIl1baHJlZiQ9Ii8iXScgcmVxdWlyZXMgdGhlIGhyZWYgYXR0cmlidXRlIHRvIGJlZ2luIGFuZCBlbmQgd2l0aCBhIHNsYXNoIHRvIG1hdGNoIGEgdXNlcm5hbWUKICAgICAgICBsZXQgaW1nTm9DYW52YXMgPSBhcnRpY2xlTm9kZS5xdWVyeVNlbGVjdG9yKCdhcnRpY2xlIHNlY3Rpb24gKyAqIGFbaHJlZl49Ii8iXVtocmVmJD0iLyJdJyk7CiAgICAgICAgaWYgKGltZ05vQ2FudmFzKSB7CiAgICAgICAgICAgIHJldHVybiBpbWdOb0NhbnZhczsKICAgICAgICB9CgogICAgICAgIC8vIHZpZGVvcyBhcmUgaGFuZGxlZCBkaWZmZXJlbnRseQogICAgICAgIGxldCBpbWdBbHQgPSBhcnRpY2xlTm9kZS5xdWVyeVNlbGVjdG9yKCdjYW52YXMgfiAqIGltZycpOwogICAgICAgIGlmIChpbWdBbHQpIHsKICAgICAgICAgICAgaW1nQWx0ID0gaW1nQWx0LmdldEF0dHJpYnV0ZSgnYWx0Jyk7CiAgICAgICAgICAgIGxldCBsaW5rcyA9IGFydGljbGVOb2RlLnF1ZXJ5U2VsZWN0b3JBbGwoJ2EnKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaW5rcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3QgcG9zdGVyTmFtZSA9IGxpbmtzW2ldLmdldEF0dHJpYnV0ZSgnaHJlZicpLnJlcGxhY2UoL1wvL2csICcnKTsKICAgICAgICAgICAgICAgIGlmIChpbWdBbHQuaW5jbHVkZXMocG9zdGVyTmFtZSkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGlua3NbaV07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBmaXJzdCBIMiB3aXRoIGEgZGlyZWN0aW9uIHNldAogICAgICAgICAgICBjb25zdCBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gyW2Rpcl0nKTsKICAgICAgICAgICAgcmV0dXJuIGVsLmlubmVyVGV4dDsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZmluZFBvc3RJZChhcnRpY2xlTm9kZSkgewogICAgICAgIGxldCBhTm9kZXMgPSBhcnRpY2xlTm9kZS5xdWVyeVNlbGVjdG9yQWxsKCdhJyk7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhTm9kZXMubGVuZ3RoOyArK2kpIHsKICAgICAgICAgICAgbGV0IGxpbmsgPSBhTm9kZXNbaV0uZ2V0QXR0cmlidXRlKCdocmVmJyk7CiAgICAgICAgICAgIGlmIChsaW5rKSB7CiAgICAgICAgICAgICAgICBsZXQgbWF0Y2ggPSBsaW5rLm1hdGNoKHBvc3RJZFBhdHRlcm4pOwogICAgICAgICAgICAgICAgaWYgKG1hdGNoKSByZXR1cm4gbWF0Y2hbMV07CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgYXN5bmMgZnVuY3Rpb24gZmV0Y2hWaWRlb1VSTChhcnRpY2xlTm9kZSwgdmlkZW9FbGVtKSB7CiAgICAgICAgbGV0IHBvc3RlciA9IHZpZGVvRWxlbS5nZXRBdHRyaWJ1dGUoJ3Bvc3RlcicpOwogICAgICAgIGxldCB0aW1lTm9kZXMgPSBhcnRpY2xlTm9kZS5xdWVyeVNlbGVjdG9yQWxsKCd0aW1lJyk7CiAgICAgICAgLy8gc3BlY2lhbCB0aGFua3Mg5a2Z5bm05b+gIChodHRwczovL2dyZWFzeWZvcmsub3JnL2VuL3NjcmlwdHMvNDA2NTM1LWluc3RhZ3JhbS1kb3dubG9hZC1idXR0b24vZGlzY3Vzc2lvbnMvMTIwMTU5KQogICAgICAgIGxldCBwb3N0ZXJVcmwgPSB0aW1lTm9kZXNbdGltZU5vZGVzLmxlbmd0aCAtIDFdLnBhcmVudE5vZGUucGFyZW50Tm9kZS5ocmVmOwogICAgICAgIGNvbnN0IHBvc3RlclBhdHRlcm4gPSAvXC8oW15cLz9dKilcPy87CiAgICAgICAgbGV0IHBvc3Rlck1hdGNoID0gcG9zdGVyLm1hdGNoKHBvc3RlclBhdHRlcm4pOwogICAgICAgIGxldCBwb3N0RmlsZU5hbWUgPSBwb3N0ZXJNYXRjaFsxXTsKICAgICAgICBsZXQgcmVzcCA9IGF3YWl0IGZldGNoKHBvc3RlclVybCk7CiAgICAgICAgbGV0IGNvbnRlbnQgPSBhd2FpdCByZXNwLnRleHQoKTsKICAgICAgICAvLyBzcGVjaWFsIHRoYW5rcyB0byDlrZnlubTlv6AgZm9yIHRoZSBwYXR0ZXJuIChodHRwczovL2dyZWFzeWZvcmsub3JnL3poLVRXL3NjcmlwdHMvNDA2NTM1LWluc3RhZ3JhbS1kb3dubG9hZC1idXR0b24vZGlzY3Vzc2lvbnMvMTE2Njc1KQogICAgICAgIGNvbnN0IHBhdHRlcm4gPSBuZXcgUmVnRXhwKGAke3Bvc3RGaWxlTmFtZX0uKj92aWRlb192ZXJzaW9ucy4qP3VybCI6KCJbXiJdKiIpYCwgJ3MnKTsKICAgICAgICBsZXQgbWF0Y2ggPSBjb250ZW50Lm1hdGNoKHBhdHRlcm4pOwogICAgICAgIGxldCB2aWRlb1VybCA9IEpTT04ucGFyc2UobWF0Y2hbMV0pOwogICAgICAgIHZpZGVvVXJsID0gdmlkZW9VcmwucmVwbGFjZSgvXig/Omh0dHBzPzpcL1wvKT8oPzpbXkBcL1xuXStAKT8oPzp3d3dcLik/KFteOlwvP1xuXSspL2csICdodHRwczovL3Njb250ZW50LmNkbmluc3RhZ3JhbS5jb20nKTsKICAgICAgICB2aWRlb0VsZW0uc2V0QXR0cmlidXRlKCd2aWRlb1VSTCcsIHZpZGVvVXJsKTsKICAgICAgICByZXR1cm4gdmlkZW9Vcmw7CiAgICB9CgogICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIC8vID09PT0gICBTdG9yeSAmIEhpZ2hsaWdodCAgICA9PT09CiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgYXN5bmMgZnVuY3Rpb24gc3RvcnlPbk1vdXNlSW4odGFyZ2V0KSB7CiAgICAgICAgbGV0IHNlY3Rpb25Ob2RlID0gc3RvcnlHZXRTZWN0aW9uTm9kZSh0YXJnZXQpOwogICAgICAgIGxldCB1cmwgPSBhd2FpdCBzdG9yeUdldFVybCh0YXJnZXQsIHNlY3Rpb25Ob2RlKTsKICAgICAgICB0YXJnZXQuc2V0QXR0cmlidXRlKCdocmVmJywgdXJsKTsKICAgIH0KCiAgICBhc3luYyBmdW5jdGlvbiBzdG9yeU9uQ2xpY2tlZCh0YXJnZXQpIHsKICAgICAgICAvLyBleHRyYWN0IHVybCBmcm9tIHRhcmdldCBzdG9yeSBhbmQgZG93bmxvYWQgb3Igb3BlbiBpdAogICAgICAgIGxldCBzZWN0aW9uTm9kZSA9IHN0b3J5R2V0U2VjdGlvbk5vZGUodGFyZ2V0KTsKICAgICAgICBsZXQgdXJsID0gYXdhaXQgc3RvcnlHZXRVcmwodGFyZ2V0LCBzZWN0aW9uTm9kZSk7CiAgICAgICAgY29uc3QgcG9zdGVyVXJsUGF0ID0gL1wvc3Rvcmllc1wvKC4qKVwvLipcLy8KICAgICAgICAvLyBkb3dubG9hZCBvciBvcGVuIG1lZGlhIHVybAogICAgICAgIGlmICh0YXJnZXQuZ2V0QXR0cmlidXRlKCdjbGFzcycpLmluY2x1ZGVzKCdkb3dubG9hZC1idG4nKSkgewogICAgICAgICAgICBsZXQgbWVkaWFOYW1lID0gdXJsLnNwbGl0KCc/JylbMF0uc3BsaXQoJ1xcJykucG9wKCkuc3BsaXQoJy8nKS5wb3AoKTsKICAgICAgICAgICAgbWVkaWFOYW1lID0gbWVkaWFOYW1lLnN1YnN0cmluZygwLCBtZWRpYU5hbWUubGFzdEluZGV4T2YoJy4nKSk7CiAgICAgICAgICAgIGxldCBkYXRldGltZSA9IG5ldyBEYXRlKHNlY3Rpb25Ob2RlLnF1ZXJ5U2VsZWN0b3IoJ3RpbWUnKS5nZXRBdHRyaWJ1dGUoJ2RhdGV0aW1lJykpOwogICAgICAgICAgICBsZXQgcG9zdGVyTmFtZSA9ICJ1bmtvd24iOwogICAgICAgICAgICAvLyBtZXRob2QgMQogICAgICAgICAgICBjb25zdCBwb3N0ZXJOYW1lSGVhZGVyID0gc2VjdGlvbk5vZGUucXVlcnlTZWxlY3RvcignaGVhZGVyIGEnKTsKICAgICAgICAgICAgaWYgKHBvc3Rlck5hbWVIZWFkZXIpIHsKICAgICAgICAgICAgICAgIHBvc3Rlck5hbWUgPSBwb3N0ZXJOYW1lSGVhZGVyLmdldEF0dHJpYnV0ZSgnaHJlZicpLnJlcGxhY2UoL1wvL2csICcnKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gbWV0aG9kIDIKICAgICAgICAgICAgaWYgKHBvc3Rlck5hbWUgPT09ICJ1bmtvd24iKSB7CiAgICAgICAgICAgICAgICBjb25zdCBtYXRjaCA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5tYXRjaChwb3N0ZXJVcmxQYXQpOwogICAgICAgICAgICAgICAgaWYgKG1hdGNoKSB7CiAgICAgICAgICAgICAgICAgICAgcG9zdGVyTmFtZSA9IG1hdGNoWzFdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGxldCBmaWxlbmFtZSA9IGZpbGVuYW1lRm9ybWF0KHN0b3J5RmlsZW5hbWVUZW1wbGF0ZSwgcG9zdGVyTmFtZSwgZGF0ZXRpbWUsIG1lZGlhTmFtZSk7CiAgICAgICAgICAgIGRvd25sb2FkUmVzb3VyY2UodXJsLCBmaWxlbmFtZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gb3BlbiB1cmwgaW4gbmV3IHRhYgogICAgICAgICAgICBvcGVuUmVzb3VyY2UodXJsKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gc3RvcnlHZXRTZWN0aW9uTm9kZSh0YXJnZXQpIHsKICAgICAgICBsZXQgc2VjdGlvbk5vZGUgPSB0YXJnZXQ7CiAgICAgICAgd2hpbGUgKHNlY3Rpb25Ob2RlICYmIHNlY3Rpb25Ob2RlLnRhZ05hbWUgIT09ICdTRUNUSU9OJykgewogICAgICAgICAgICBzZWN0aW9uTm9kZSA9IHNlY3Rpb25Ob2RlLnBhcmVudE5vZGU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzZWN0aW9uTm9kZTsKICAgIH0KCiAgICBhc3luYyBmdW5jdGlvbiBzdG9yeUdldFVybCh0YXJnZXQsIHNlY3Rpb25Ob2RlKSB7CiAgICAgICAgbGV0IHVybCA9IG51bGw7CiAgICAgICAgaWYgKCFkaXNhYmxlTmV3VXJsRmV0Y2hNZXRob2QpIHVybCA9IGF3YWl0IGdldFVybEZyb21JbmZvQXBpKHRhcmdldCk7CgogICAgICAgIGlmICghdXJsKSB7CiAgICAgICAgICAgIGlmIChzZWN0aW9uTm9kZS5xdWVyeVNlbGVjdG9yKCd2aWRlbyA+IHNvdXJjZScpKSB7CiAgICAgICAgICAgICAgICB1cmwgPSBzZWN0aW9uTm9kZS5xdWVyeVNlbGVjdG9yKCd2aWRlbyA+IHNvdXJjZScpLmdldEF0dHJpYnV0ZSgnc3JjJyk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2VjdGlvbk5vZGUucXVlcnlTZWxlY3RvcignaW1nW2RlY29kaW5nPSJzeW5jIl0nKSkgewogICAgICAgICAgICAgICAgbGV0IGltZyA9IHNlY3Rpb25Ob2RlLnF1ZXJ5U2VsZWN0b3IoJ2ltZ1tkZWNvZGluZz0ic3luYyJdJyk7CiAgICAgICAgICAgICAgICB1cmwgPSBpbWcuc3Jjc2V0LnNwbGl0KC8gXGQrdy9nKVswXS50cmltKCk7IC8vIGV4dHJhY3QgZmlyc3Qgc3JjIGZyb20gc3Jjc2V0IGF0dHIuIG9mIGltZwogICAgICAgICAgICAgICAgaWYgKHVybC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVybDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHVybCA9IHNlY3Rpb25Ob2RlLnF1ZXJ5U2VsZWN0b3IoJ2ltZ1tkZWNvZGluZz0ic3luYyJdJykuZ2V0QXR0cmlidXRlKCdzcmMnKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChzZWN0aW9uTm9kZS5xdWVyeVNlbGVjdG9yKCd2aWRlbycpKSB7CiAgICAgICAgICAgICAgICB1cmwgPSBzZWN0aW9uTm9kZS5xdWVyeVNlbGVjdG9yKCd2aWRlbycpLmdldEF0dHJpYnV0ZSgnc3JjJyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHVybDsKICAgIH0KCiAgICBmdW5jdGlvbiBmaWxlbmFtZUZvcm1hdCh0ZW1wbGF0ZSwgaWQsIGRhdGV0aW1lLCBtZWRpYW5hbWUsIHBvc3RJZCA9ICtuZXcgRGF0ZSgpLCBtZWRpYUluZGV4ID0gJzAnKSB7CiAgICAgICAgbGV0IGZpbGVuYW1lID0gdGVtcGxhdGU7CiAgICAgICAgZmlsZW5hbWUgPSBmaWxlbmFtZS5yZXBsYWNlKC8laWQlL2csIGlkKTsKICAgICAgICBmaWxlbmFtZSA9IGZpbGVuYW1lLnJlcGxhY2UoLyVkYXRldGltZSUvZywgZGF0ZXRpbWVGb3JtYXQoZGF0ZXRpbWVUZW1wbGF0ZSwgZGF0ZXRpbWUpKTsKICAgICAgICBmaWxlbmFtZSA9IGZpbGVuYW1lLnJlcGxhY2UoLyVtZWRpYW5hbWUlL2csIG1lZGlhbmFtZSk7CiAgICAgICAgZmlsZW5hbWUgPSBmaWxlbmFtZS5yZXBsYWNlKC8lcG9zdElkJS9nLCBwb3N0SWQpOwogICAgICAgIGZpbGVuYW1lID0gZmlsZW5hbWUucmVwbGFjZSgvJW1lZGlhSW5kZXglL2csIG1lZGlhSW5kZXgpOwogICAgICAgIHJldHVybiBmaWxlbmFtZTsKICAgIH0KCiAgICBmdW5jdGlvbiBkYXRldGltZUZvcm1hdCh0ZW1wbGF0ZSwgZGF0ZXRpbWUpIHsKICAgICAgICBsZXQgZGF0ZXRpbWVTdHIgPSB0ZW1wbGF0ZTsKICAgICAgICBkYXRldGltZVN0ciA9IGRhdGV0aW1lU3RyLnJlcGxhY2UoLyV5JS9nLCBkYXRldGltZS5nZXRGdWxsWWVhcigpKTsKICAgICAgICBkYXRldGltZVN0ciA9IGRhdGV0aW1lU3RyLnJlcGxhY2UoLyVtJS9nLCBmaWxsWmVybygoZGF0ZXRpbWUuZ2V0TW9udGgoKSArIDEpLnRvU3RyaW5nKCkpKTsKICAgICAgICBkYXRldGltZVN0ciA9IGRhdGV0aW1lU3RyLnJlcGxhY2UoLyVkJS9nLCBmaWxsWmVybyhkYXRldGltZS5nZXREYXRlKCkudG9TdHJpbmcoKSkpOwogICAgICAgIGRhdGV0aW1lU3RyID0gZGF0ZXRpbWVTdHIucmVwbGFjZSgvJUglL2csIGZpbGxaZXJvKGRhdGV0aW1lLmdldEhvdXJzKCkudG9TdHJpbmcoKSkpOwogICAgICAgIGRhdGV0aW1lU3RyID0gZGF0ZXRpbWVTdHIucmVwbGFjZSgvJU0lL2csIGZpbGxaZXJvKGRhdGV0aW1lLmdldE1pbnV0ZXMoKS50b1N0cmluZygpKSk7CiAgICAgICAgZGF0ZXRpbWVTdHIgPSBkYXRldGltZVN0ci5yZXBsYWNlKC8lUyUvZywgZmlsbFplcm8oZGF0ZXRpbWUuZ2V0U2Vjb25kcygpLnRvU3RyaW5nKCkpKTsKICAgICAgICByZXR1cm4gZGF0ZXRpbWVTdHI7CiAgICB9CgogICAgZnVuY3Rpb24gZmlsbFplcm8oc3RyKSB7CiAgICAgICAgaWYgKHN0ci5sZW5ndGggPT09IDEpIHsKICAgICAgICAgICAgcmV0dXJuICcwJyArIHN0cjsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN0cjsKICAgIH0KCiAgICBmdW5jdGlvbiBvcGVuUmVzb3VyY2UodXJsKSB7CiAgICAgICAgLy8gb3BlbiB1cmwgaW4gbmV3IHRhYgogICAgICAgIHZhciBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgICAgIGEuaHJlZiA9IHVybDsKICAgICAgICBhLnNldEF0dHJpYnV0ZSgndGFyZ2V0JywgJ19ibGFuaycpOwogICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSk7CiAgICAgICAgYS5jbGljaygpOwogICAgICAgIGEucmVtb3ZlKCk7CiAgICB9CgogICAgZnVuY3Rpb24gZm9yY2VEb3dubG9hZChibG9iLCBmaWxlbmFtZSwgZXh0ZW5zaW9uKSB7CiAgICAgICAgLy8gcmVmOiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy80OTQ3NDc3NS9jaHJvbWUtNjUtYmxvY2tzLWNyb3NzLW9yaWdpbi1hLWRvd25sb2FkLWNsaWVudC1zaWRlLXdvcmthcm91bmQtdG8tZm9yY2UtZG93bgogICAgICAgIHZhciBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgICAgIGlmIChyZXBsYWNlSnBlZ1dpdGhKcGcpIGV4dGVuc2lvbiA9IGV4dGVuc2lvbi5yZXBsYWNlKCdqcGVnJywgJ2pwZycpOwogICAgICAgIGEuZG93bmxvYWQgPSBmaWxlbmFtZSArICcuJyArIGV4dGVuc2lvbjsKICAgICAgICBhLmhyZWYgPSBibG9iOwogICAgICAgIC8vIEZvciBGaXJlZm94IGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8zMjIyNjA2OAogICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSk7CiAgICAgICAgYS5jbGljaygpOwogICAgICAgIGEucmVtb3ZlKCk7CiAgICB9CgogICAgLy8gQ3VycmVudCBibG9iIHNpemUgbGltaXQgaXMgYXJvdW5kIDUwME1CIGZvciBicm93c2VycwogICAgZnVuY3Rpb24gZG93bmxvYWRSZXNvdXJjZSh1cmwsIGZpbGVuYW1lKSB7CiAgICAgICAgaWYgKHVybC5zdGFydHNXaXRoKCdibG9iOicpKSB7CiAgICAgICAgICAgIGZvcmNlRG93bmxvYWQodXJsLCBmaWxlbmFtZSwgJ21wNCcpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNvbnNvbGUubG9nKGBEb3dsb2FkaW5nICR7dXJsfWApOwogICAgICAgIC8vIHJlZjogaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNDk0NzQ3NzUvY2hyb21lLTY1LWJsb2Nrcy1jcm9zcy1vcmlnaW4tYS1kb3dubG9hZC1jbGllbnQtc2lkZS13b3JrYXJvdW5kLXRvLWZvcmNlLWRvd24KICAgICAgICBpZiAoIWZpbGVuYW1lKSB7CiAgICAgICAgICAgIGZpbGVuYW1lID0gdXJsCiAgICAgICAgICAgICAgICAuc3BsaXQoJ1xcJykKICAgICAgICAgICAgICAgIC5wb3AoKQogICAgICAgICAgICAgICAgLnNwbGl0KCcvJykKICAgICAgICAgICAgICAgIC5wb3AoKTsKICAgICAgICB9CiAgICAgICAgZmV0Y2godXJsLCB7CiAgICAgICAgICAgIGhlYWRlcnM6IG5ldyBIZWFkZXJzKHsKICAgICAgICAgICAgICAgICdVc2VyLUFnZW50Jzogd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQsCiAgICAgICAgICAgICAgICBPcmlnaW46IGxvY2F0aW9uLm9yaWdpbiwKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIG1vZGU6ICdjb3JzJywKICAgICAgICB9KQogICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5ibG9iKCkpCiAgICAgICAgICAgIC50aGVuKGJsb2IgPT4gewogICAgICAgICAgICAgICAgY29uc3QgZXh0ZW5zaW9uID0gYmxvYi50eXBlLnNwbGl0KCcvJykucG9wKCk7CiAgICAgICAgICAgICAgICBsZXQgYmxvYlVybCA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOwogICAgICAgICAgICAgICAgZm9yY2VEb3dubG9hZChibG9iVXJsLCBmaWxlbmFtZSwgZXh0ZW5zaW9uKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLmNhdGNoKGUgPT4gY29uc29sZS5lcnJvcihlKSk7CiAgICB9Cn0pKCk7Cg=="},{"name":"Facebook video downloader","options":{"check_for_updates":true,"user_modified":null,"comment":null,"compatopts_for_requires":true,"compat_wrappedjsobject":false,"compat_metadata":false,"compat_foreach":false,"compat_powerful_this":null,"sandbox":null,"noframes":null,"unwrap":null,"run_at":null,"tab_types":null,"override":{"use_includes":[],"orig_includes":[],"merge_includes":true,"use_matches":[],"orig_matches":["https://www.facebook.com/*","https://web.facebook.com/*"],"merge_matches":true,"use_excludes":[],"orig_excludes":[],"merge_excludes":true,"use_connects":[],"orig_connects":[],"merge_connects":true,"use_blockers":[],"orig_run_at":"document-idle","orig_noframes":null,"orig_run_in":[]},"run_in":null,"tags":[]},"storage":{"ts":1716631064564,"data":{}},"enabled":true,"position":2,"file_url":"https://update.greasyfork.org/scripts/477748/Facebook%20video%20downloader.user.js","uuid":"d36ecfb5-4f33-44e5-94b1-8e2c80998450","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgIEZhY2Vib29rIHZpZGVvIGRvd25sb2FkZXIKLy8gQGljb24gICAgICAgIGh0dHBzOi8vd3d3LmZhY2Vib29rLmNvbS9mYXZpY29uLmljbwovLyBAbmFtZXNwYWNlICAgVmlvbGVudG1vbmtleSBTY3JpcHRzCi8vIEBtYXRjaCAgICAgICBodHRwczovL3d3dy5mYWNlYm9vay5jb20vKgovLyBAbWF0Y2ggICAgICAgaHR0cHM6Ly93ZWIuZmFjZWJvb2suY29tLyoKLy8gQGdyYW50ICAgICAgIEdNX3JlZ2lzdGVyTWVudUNvbW1hbmQKLy8gQHZlcnNpb24gICAgIDEuMwovLyBAYXV0aG9yICAgICAgaHR0cHM6Ly9naXRodWIuY29tL0hvYW5nVHJhbjA0MTAKLy8gQGRlc2NyaXB0aW9uIERvd25sb2FkIGFueSB2aWRlbyBvbiBGYWNlYm9vayAocG9zdC9jaGF0L2NvbW1lbnQpCi8vIEBsaWNlbnNlIE1JVAovLyBAZG93bmxvYWRVUkwgaHR0cHM6Ly91cGRhdGUuZ3JlYXN5Zm9yay5vcmcvc2NyaXB0cy80Nzc3NDgvRmFjZWJvb2slMjB2aWRlbyUyMGRvd25sb2FkZXIudXNlci5qcwovLyBAdXBkYXRlVVJMIGh0dHBzOi8vdXBkYXRlLmdyZWFzeWZvcmsub3JnL3NjcmlwdHMvNDc3NzQ4L0ZhY2Vib29rJTIwdmlkZW8lMjBkb3dubG9hZGVyLm1ldGEuanMKLy8gPT0vVXNlclNjcmlwdD09CgooKCkgPT4gewogIGZ1bmN0aW9uIGdldE92ZXJsYXBTY29yZShlbCkgewogICAgdmFyIHJlY3QgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIHJldHVybiAoCiAgICAgIE1hdGgubWluKAogICAgICAgIHJlY3QuYm90dG9tLAogICAgICAgIHdpbmRvdy5pbm5lckhlaWdodCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0CiAgICAgICkgLSBNYXRoLm1heCgwLCByZWN0LnRvcCkKICAgICk7CiAgfQoKICBmdW5jdGlvbiBnZXRWaWRlb0lkRnJvbVZpZGVvRWxlbWVudCh2aWRlbykgewogICAgdHJ5IHsKICAgICAgZm9yIChsZXQgayBpbiB2aWRlby5wYXJlbnRFbGVtZW50KSB7CiAgICAgICAgaWYgKGsuc3RhcnRzV2l0aCgiX19yZWFjdFByb3BzIikpIHsKICAgICAgICAgIHJldHVybiB2aWRlby5wYXJlbnRFbGVtZW50W2tdLmNoaWxkcmVuLnByb3BzLnZpZGVvRkJJRDsKICAgICAgICB9CiAgICAgIH0KICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgfQoKICBhc3luYyBmdW5jdGlvbiBnZXRXYXRjaGluZ1ZpZGVvSWQoKSB7CiAgICBsZXQgYWxsVmlkZW9zID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJ2aWRlbyIpKTsKICAgIGxldCByZXN1bHQgPSBbXTsKCiAgICBmb3IgKGxldCB2aWRlbyBvZiBhbGxWaWRlb3MpIHsKICAgICAgbGV0IHZpZGVvSWQgPSBnZXRWaWRlb0lkRnJvbVZpZGVvRWxlbWVudCh2aWRlbyk7CiAgICAgIGlmICh2aWRlb0lkKSB7CiAgICAgICAgcmVzdWx0LnB1c2goewogICAgICAgICAgdmlkZW9JZCwKICAgICAgICAgIG92ZXJsYXBTY29yZTogZ2V0T3ZlcmxhcFNjb3JlKHZpZGVvKSwKICAgICAgICAgIHBsYXlpbmc6ICEhKAogICAgICAgICAgICB2aWRlby5jdXJyZW50VGltZSA+IDAgJiYKICAgICAgICAgICAgIXZpZGVvLnBhdXNlZCAmJgogICAgICAgICAgICAhdmlkZW8uZW5kZWQgJiYKICAgICAgICAgICAgdmlkZW8ucmVhZHlTdGF0ZSA+IDIKICAgICAgICAgICksCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KCiAgICAvLyBpZiB0aGVyZSBpcyBwbGF5aW5nIHZpZGVvID0+IHJldHVybiB0aGF0CiAgICBsZXQgcGxheWluZ1ZpZGVvID0gcmVzdWx0LmZpbmQoKF8pID0+IF8ucGxheWluZyk7CiAgICBpZiAocGxheWluZ1ZpZGVvKSByZXR1cm4gW3BsYXlpbmdWaWRlby52aWRlb0lkXTsKCiAgICAvLyBlbHNlIHJldHVybiBhbGwgdmlkZW9zIGluLXZpZXdwb3J0CiAgICByZXR1cm4gcmVzdWx0CiAgICAgIC5maWx0ZXIoKF8pID0+IF8udmlkZW9JZCAmJiAoXy5vdmVybGFwU2NvcmUgPiAwIHx8IF8ucGxheWluZykpCiAgICAgIC5zb3J0KChhLCBiKSA9PiBiLm92ZXJsYXBTY29yZSAtIGEub3ZlcmxhcFNjb3JlKQogICAgICAubWFwKChfKSA9PiBfLnZpZGVvSWQpOwogIH0KCiAgYXN5bmMgZnVuY3Rpb24gZ2V0VmlkZW9VcmxGcm9tVmlkZW9JZCh2aWRlb0lkKSB7CiAgICBsZXQgZHRzZyA9IGF3YWl0IGdldER0c2coKTsKICAgIHRyeSB7CiAgICAgIHJldHVybiBhd2FpdCBnZXRMaW5rRmJWaWRlbzIodmlkZW9JZCwgZHRzZyk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIHJldHVybiBhd2FpdCBnZXRMaW5rRmJWaWRlbzEodmlkZW9JZCwgZHRzZyk7CiAgICB9CiAgfQoKICBhc3luYyBmdW5jdGlvbiBnZXRMaW5rRmJWaWRlbzIodmlkZW9JZCwgZHRzZykgewogICAgbGV0IHJlcyA9IGF3YWl0IGZldGNoKAogICAgICAiaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL3ZpZGVvL3ZpZGVvX2RhdGFfYXN5bmMvP3ZpZGVvX2lkPSIgKyB2aWRlb0lkLAogICAgICB7CiAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgaGVhZGVyczogeyAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIgfSwKICAgICAgICBib2R5OiBzdHJpbmdpZnlWYXJpYWJsZXMoewogICAgICAgICAgX19hOiAiMSIsCiAgICAgICAgICBmYl9kdHNnOiBkdHNnLAogICAgICAgIH0pLAogICAgICB9CiAgICApOwoKICAgIGxldCB0ZXh0ID0gYXdhaXQgcmVzLnRleHQoKTsKICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoImZvciAoOzspOyIsICIiKTsKICAgIGxldCBqc29uID0gSlNPTi5wYXJzZSh0ZXh0KTsKCiAgICBjb25zdCB7IGhkX3NyYywgaGRfc3JjX25vX3JhdGVsaW1pdCwgc2Rfc3JjLCBzZF9zcmNfbm9fcmF0ZWxpbWl0IH0gPQogICAgICBqc29uPy5wYXlsb2FkIHx8IHt9OwoKICAgIHJldHVybiBoZF9zcmNfbm9fcmF0ZWxpbWl0IHx8IGhkX3NyYyB8fCBzZF9zcmNfbm9fcmF0ZWxpbWl0IHx8IHNkX3NyYzsKICB9CgogIGFzeW5jIGZ1bmN0aW9uIGdldExpbmtGYlZpZGVvMSh2aWRlb0lkLCBkdHNnKSB7CiAgICBsZXQgcmVzID0gYXdhaXQgZmV0Y2hHcmFwaFFsKCI1Mjc5NDc2MDcyMTYxNjM0IiwgewogICAgICBVRkkyQ29tbWVudHNQcm92aWRlcl9jb21tZW50c0tleTogIkNvbWV0VGFob2VTaWRlUGFuZVF1ZXJ5IiwKICAgICAgY2FsbGVyOiAiQ0hBTk5FTF9WSUVXX0ZST01fUEFHRV9USU1FTElORSIsCiAgICAgIGRpc3BsYXlDb21tZW50c0NvbnRleHRFbmFibGVDb21tZW50OiBudWxsLAogICAgICBkaXNwbGF5Q29tbWVudHNDb250ZXh0SXNBZFByZXZpZXc6IG51bGwsCiAgICAgIGRpc3BsYXlDb21tZW50c0NvbnRleHRJc0FnZ3JlZ2F0ZWRTaGFyZTogbnVsbCwKICAgICAgZGlzcGxheUNvbW1lbnRzQ29udGV4dElzU3RvcnlTZXQ6IG51bGwsCiAgICAgIGRpc3BsYXlDb21tZW50c0ZlZWRiYWNrQ29udGV4dDogbnVsbCwKICAgICAgZmVlZGJhY2tTb3VyY2U6IDQxLAogICAgICBmZWVkTG9jYXRpb246ICJUQUhPRSIsCiAgICAgIGZvY3VzQ29tbWVudElEOiBudWxsLAogICAgICBwcml2YWN5U2VsZWN0b3JSZW5kZXJMb2NhdGlvbjogIkNPTUVUX1NUUkVBTSIsCiAgICAgIHJlbmRlckxvY2F0aW9uOiAidmlkZW9fY2hhbm5lbCIsCiAgICAgIHNjYWxlOiAxLAogICAgICBzdHJlYW1DaGFpbmluZ1NlY3Rpb246ICExLAogICAgICB1c2VEZWZhdWx0QWN0b3I6ICExLAogICAgICB2aWRlb0NoYWluaW5nQ29udGV4dDogbnVsbCwKICAgICAgdmlkZW9JRDogdmlkZW9JZCwKICAgIH0sIGR0c2cpOwogICAgbGV0IHRleHQgPSBhd2FpdCByZXMudGV4dCgpOwoKICAgIGxldCBhID0gSlNPTi5wYXJzZSh0ZXh0LnNwbGl0KCJcbiIpWzBdKSwKICAgICAgbGluayA9IGEuZGF0YS52aWRlby5wbGF5YWJsZV91cmxfcXVhbGl0eV9oZCB8fCBhLmRhdGEudmlkZW8ucGxheWFibGVfdXJsOwoKICAgIHJldHVybiBsaW5rOwogIH0KCiAgZnVuY3Rpb24gZmV0Y2hHcmFwaFFsKGRvY19pZCwgdmFyaWFibGVzLCBkdHNnKSB7CiAgICByZXR1cm4gZmV0Y2goImh0dHBzOi8vd3d3LmZhY2Vib29rLmNvbS9hcGkvZ3JhcGhxbC8iLCB7CiAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICBoZWFkZXJzOiB7CiAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiLAogICAgICB9LAogICAgICBib2R5OiBzdHJpbmdpZnlWYXJpYWJsZXMoewogICAgICAgIGRvY19pZDogZG9jX2lkLAogICAgICAgIHZhcmlhYmxlczogSlNPTi5zdHJpbmdpZnkodmFyaWFibGVzKSwKICAgICAgICBmYl9kdHNnOiBkdHNnLAogICAgICAgIHNlcnZlcl90aW1lc3RhbXBzOiAhMCwKICAgICAgfSksCiAgICB9KTsKICB9CgogIGZ1bmN0aW9uIHN0cmluZ2lmeVZhcmlhYmxlcyhkLCBlKSB7CiAgICBsZXQgZiA9IFtdLAogICAgICBhOwogICAgZm9yIChhIGluIGQpCiAgICAgIGlmIChkLmhhc093blByb3BlcnR5KGEpKSB7CiAgICAgICAgbGV0IGcgPSBlID8gZSArICJbIiArIGEgKyAiXSIgOiBhLAogICAgICAgICAgYiA9IGRbYV07CiAgICAgICAgZi5wdXNoKAogICAgICAgICAgbnVsbCAhPT0gYiAmJiAib2JqZWN0IiA9PSB0eXBlb2YgYgogICAgICAgICAgICA/IHN0cmluZ2lmeVZhcmlhYmxlcyhiLCBnKQogICAgICAgICAgICA6IGVuY29kZVVSSUNvbXBvbmVudChnKSArICI9IiArIGVuY29kZVVSSUNvbXBvbmVudChiKQogICAgICAgICk7CiAgICAgIH0KICAgIHJldHVybiBmLmpvaW4oIiYiKTsKICB9CgogIGFzeW5jIGZ1bmN0aW9uIGdldER0c2coKSB7CiAgICByZXR1cm4gcmVxdWlyZSgiRFRTR0luaXRpYWxEYXRhIikudG9rZW47CiAgfQoKICBmdW5jdGlvbiBkb3dubG9hZFVSTCh1cmwsIG5hbWUpIHsKICAgIHZhciBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpOwogICAgbGluay50YXJnZXQgPSAiX2JsYW5rIjsKICAgIGxpbmsuZG93bmxvYWQgPSBuYW1lOwogICAgbGluay5ocmVmID0gdXJsOwogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChsaW5rKTsKICAgIGxpbmsuY2xpY2soKTsKICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQobGluayk7CiAgfQoKICBhc3luYyBmdW5jdGlvbiBkb3dubG9hZFdhdGNoaW5nVmlkZW8oKSB7CiAgICB0cnkgewogICAgICBsZXQgbGlzdFZpZGVvSWQgPSBhd2FpdCBnZXRXYXRjaGluZ1ZpZGVvSWQoKTsKICAgICAgaWYgKCFsaXN0VmlkZW9JZD8ubGVuZ3RoID4gMCkgdGhyb3cgRXJyb3IoIk5vIHZpZGVvIGZvdW5kIGluIHRoZSBwYWdlIik7CgogICAgICBjb25zb2xlLmxvZyhsaXN0VmlkZW9JZCkKCiAgICAgIGZvciAobGV0IHZpZGVvSWQgb2YgbGlzdFZpZGVvSWQpIHsKICAgICAgICBsZXQgdmlkZW9VcmwgPSBhd2FpdCBnZXRWaWRlb1VybEZyb21WaWRlb0lkKHZpZGVvSWQpOwogICAgICAgIGlmICh2aWRlb1VybCkgZG93bmxvYWRVUkwodmlkZW9VcmwsICJmYl92aWRlby5tcDQiKTsKICAgICAgfQogICAgfSBjYXRjaCAoZSkgewogICAgICBhbGVydCgiRVJST1I6ICIgKyBlKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHJlc2lzdGVyTWVudUNvbW1hbmQoKSB7CiAgICBHTV9yZWdpc3Rlck1lbnVDb21tYW5kKCJEb3dubG9hZCB3YXRjaGluZyB2aWRlbyIsIGRvd25sb2FkV2F0Y2hpbmdWaWRlbyk7CiAgfQoKICByZXNpc3Rlck1lbnVDb21tYW5kKCk7Cn0pKCk7Cg=="},{"name":"Twitter Media Downloader","options":{"check_for_updates":true,"user_modified":1721340828091,"comment":null,"compatopts_for_requires":true,"compat_wrappedjsobject":false,"compat_metadata":false,"compat_foreach":false,"compat_powerful_this":null,"sandbox":null,"noframes":null,"unwrap":null,"run_at":null,"tab_types":null,"override":{"use_includes":[],"orig_includes":[],"merge_includes":true,"use_matches":[],"orig_matches":["https://twitter.com/*","https://x.com/*","https://mobile.twitter.com/*"],"merge_matches":true,"use_excludes":[],"orig_excludes":[],"merge_excludes":true,"use_connects":[],"orig_connects":[],"merge_connects":true,"use_blockers":[],"orig_run_at":"document-idle","orig_noframes":null,"orig_run_in":[]},"run_in":null,"tags":[]},"storage":{"ts":1736407307209,"data":{"show_sensitive":"btrue","filename":"stwitter_{user-name}(@{user-id})_{date-time}_{status-id}_{file-type}","download_history":"o[\"1814932915173589364\",\"1814933538619470237\",\"1814941973381587188\",\"1814931785425559977\",\"1814960033479762403\",\"1816389526950170725\",\"1816486525481431136\",\"1816419501044605404\",\"1816392280284299462\",\"1646475564981817344\",\"1816761095266398389\",\"1816464348484624706\",\"1817462498901320045\",\"1817504869005352977\",\"1817465490148835534\",\"1817497297409966511\",\"1817867421832860121\",\"1554474110931341314\",\"1598476185423425536\",\"1786698791812563241\",\"1819723224906887549\",\"1652336047408414720\",\"1824225516402119163\",\"1824227973660053983\",\"1824673774861529450\",\"1824743591383912777\",\"1826260743429533954\",\"1827392003124150444\",\"1829109552186298401\",\"1829094484396687384\",\"1829133302453743703\",\"1832418814182748558\",\"1833056444767142387\",\"1833766868680683562\",\"1833824431493562849\",\"1823058099466576147\",\"1834068213312921707\",\"1831709428212756664\",\"1837471653061669239\",\"1837443669944947095\",\"1836774603408232646\",\"1836364537257439351\",\"1838570726694986189\",\"1843274541025595801\",\"1845814308175020191\",\"1862828212029632599\",\"1862802494738641299\",\"1861766190487789946\",\"1860687464278712466\",\"1859873370780860725\",\"1863349605456650679\",\"1864551056476402061\",\"1858892294046576992\",\"1867781563871899750\",\"1867538450796495175\",\"1877224518256668954\"]"}},"enabled":true,"position":3,"file_url":"https://update.greasyfork.org/scripts/423001/Twitter%20Media%20Downloader.user.js","uuid":"08863cde-4ebf-463c-8bcf-382b50c74d57","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgIFR3aXR0ZXIgTWVkaWEgRG93bmxvYWRlcgovLyBAbmFtZTpqYSAgICAgVHdpdHRlciBNZWRpYSBEb3dubG9hZGVyCi8vIEBuYW1lOnpoLWNuICBUd2l0dGVyIOWqkuS9k+S4i+i9vQovLyBAbmFtZTp6aC10dyAgVHdpdHRlciDlqpLpq5TkuIvovIkKLy8gQGRlc2NyaXB0aW9uICAgIFNhdmUgVmlkZW8vUGhvdG8gYnkgT25lLUNsaWNrLgovLyBAZGVzY3JpcHRpb246amEg44Ov44Oz44Kv44Oq44OD44Kv44Gn5YuV55S744O755S75YOP44KS5L+d5a2Y44GZ44KL44CCCi8vIEBkZXNjcmlwdGlvbjp6aC1jbiDkuIDplK7kv53lrZjop4bpopEv5Zu+54mHCi8vIEBkZXNjcmlwdGlvbjp6aC10dyDkuIDpjbXkv53lrZjoppbpoLsv5ZyW54mHCi8vIEB2ZXJzaW9uICAgICAxLjI3Ci8vIEBhdXRob3IgICAgICBBTUFORQovLyBAbmFtZXNwYWNlICAgbm9uZQovLyBAbWF0Y2ggICAgICAgaHR0cHM6Ly90d2l0dGVyLmNvbS8qCi8vIEBtYXRjaCAgICAgICBodHRwczovL3guY29tLyoKLy8gQG1hdGNoICAgICAgIGh0dHBzOi8vbW9iaWxlLnR3aXR0ZXIuY29tLyoKLy8gQGdyYW50ICAgICAgIEdNX3JlZ2lzdGVyTWVudUNvbW1hbmQKLy8gQGdyYW50ICAgICAgIEdNX3NldFZhbHVlCi8vIEBncmFudCAgICAgICBHTV9nZXRWYWx1ZQovLyBAZ3JhbnQgICAgICAgR01fZG93bmxvYWQKLy8gQGNvbXBhdGlibGUgIENocm9tZQovLyBAY29tcGF0aWJsZSAgRmlyZWZveAovLyBAbGljZW5zZSAgICAgTUlUCi8vIEBkb3dubG9hZFVSTCBodHRwczovL3VwZGF0ZS5ncmVhc3lmb3JrLm9yZy9zY3JpcHRzLzQyMzAwMS9Ud2l0dGVyJTIwTWVkaWElMjBEb3dubG9hZGVyLnVzZXIuanMKLy8gQHVwZGF0ZVVSTCBodHRwczovL3VwZGF0ZS5ncmVhc3lmb3JrLm9yZy9zY3JpcHRzLzQyMzAwMS9Ud2l0dGVyJTIwTWVkaWElMjBEb3dubG9hZGVyLm1ldGEuanMKLy8gPT0vVXNlclNjcmlwdD09Ci8qIGpzaGludCBlc3ZlcnNpb246IDggKi8KCmNvbnN0IGZpbGVuYW1lID0gJ3R3aXR0ZXJfe3VzZXItbmFtZX0oQHt1c2VyLWlkfSlfe2RhdGUtdGltZX1fe3N0YXR1cy1pZH1fe2ZpbGUtdHlwZX0nOwoKY29uc3QgVE1EID0gKGZ1bmN0aW9uICgpIHsKICBsZXQgbGFuZywgaG9zdCwgaGlzdG9yeSwgc2hvd19zZW5zaXRpdmUsIGlzX3R3ZWV0ZGVjazsKICByZXR1cm4gewogICAgaW5pdDogYXN5bmMgZnVuY3Rpb24gKCkgewogICAgICBHTV9yZWdpc3Rlck1lbnVDb21tYW5kKCh0aGlzLmxhbmd1YWdlW25hdmlnYXRvci5sYW5ndWFnZV0gfHwgdGhpcy5sYW5ndWFnZS5lbikuc2V0dGluZ3MsIHRoaXMuc2V0dGluZ3MpOwogICAgICBsYW5nID0gdGhpcy5sYW5ndWFnZVtkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sJykubGFuZ10gfHwgdGhpcy5sYW5ndWFnZS5lbjsKICAgICAgaG9zdCA9IGxvY2F0aW9uLmhvc3RuYW1lOwogICAgICBpc190d2VldGRlY2sgPSBob3N0LmluZGV4T2YoJ3R3ZWV0ZGVjaycpID49IDA7CiAgICAgIGhpc3RvcnkgPSB0aGlzLnN0b3JhZ2Vfb2Jzb2xldGUoKTsKICAgICAgaWYgKGhpc3RvcnkubGVuZ3RoKSB7CiAgICAgICAgdGhpcy5zdG9yYWdlKGhpc3RvcnkpOwogICAgICAgIHRoaXMuc3RvcmFnZV9vYnNvbGV0ZSh0cnVlKTsKICAgICAgfSBlbHNlIGhpc3RvcnkgPSBhd2FpdCB0aGlzLnN0b3JhZ2UoKTsKICAgICAgc2hvd19zZW5zaXRpdmUgPSBHTV9nZXRWYWx1ZSgnc2hvd19zZW5zaXRpdmUnLCBmYWxzZSk7CiAgICAgIGRvY3VtZW50LmhlYWQuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLCAnPHN0eWxlPicgKyB0aGlzLmNzcyArIChzaG93X3NlbnNpdGl2ZSA/IHRoaXMuY3NzX3NzIDogJycpICsgJzwvc3R5bGU+Jyk7CiAgICAgIGxldCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKG1zID0+IG1zLmZvckVhY2gobSA9PiBtLmFkZGVkTm9kZXMuZm9yRWFjaChub2RlID0+IHRoaXMuZGV0ZWN0KG5vZGUpKSkpOwogICAgICBvYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LmJvZHksIHtjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IHRydWV9KTsKICAgIH0sCiAgICBkZXRlY3Q6IGZ1bmN0aW9uKG5vZGUpIHsKICAgICAgbGV0IGFydGljbGUgPSBub2RlLnRhZ05hbWUgPT0gJ0FSVElDTEUnICYmIG5vZGUgfHwgbm9kZS50YWdOYW1lID09ICdESVYnICYmIChub2RlLnF1ZXJ5U2VsZWN0b3IoJ2FydGljbGUnKSB8fCBub2RlLmNsb3Nlc3QoJ2FydGljbGUnKSk7CiAgICAgIGlmIChhcnRpY2xlKSB0aGlzLmFkZEJ1dHRvblRvKGFydGljbGUpOwogICAgICBsZXQgbGlzdGl0ZW1zID0gbm9kZS50YWdOYW1lID09ICdMSScgJiYgbm9kZS5nZXRBdHRyaWJ1dGUoJ3JvbGUnKSA9PSAnbGlzdGl0ZW0nICYmIFtub2RlXSB8fCBub2RlLnRhZ05hbWUgPT0gJ0RJVicgJiYgbm9kZS5xdWVyeVNlbGVjdG9yQWxsKCdsaVtyb2xlPSJsaXN0aXRlbSJdJyk7CiAgICAgIGlmIChsaXN0aXRlbXMpIHRoaXMuYWRkQnV0dG9uVG9NZWRpYShsaXN0aXRlbXMpOwogICAgfSwKICAgIGFkZEJ1dHRvblRvOiBmdW5jdGlvbiAoYXJ0aWNsZSkgewogICAgICBpZiAoYXJ0aWNsZS5kYXRhc2V0LmRldGVjdGVkKSByZXR1cm47CiAgICAgIGFydGljbGUuZGF0YXNldC5kZXRlY3RlZCA9ICd0cnVlJzsKICAgICAgbGV0IG1lZGlhX3NlbGVjdG9yID0gWwogICAgICAgICdhW2hyZWYqPSIvcGhvdG8vMSJdJywKICAgICAgICAnZGl2W3JvbGU9InByb2dyZXNzYmFyIl0nLAogICAgICAgICdkaXZbZGF0YS10ZXN0aWQ9InBsYXlCdXR0b24iXScsCiAgICAgICAgJ2FbaHJlZj0iL3NldHRpbmdzL2NvbnRlbnRfeW91X3NlZSJdJywgLy9oaWRkZW4gY29udGVudAogICAgICAgICdkaXYubWVkaWEtaW1hZ2UtY29udGFpbmVyJywgLy8gZm9yIHR3ZWV0ZGVjawogICAgICAgICdkaXYubWVkaWEtcHJldmlldy1jb250YWluZXInLCAvLyBmb3IgdHdlZXRkZWNrCiAgICAgICAgJ2RpdlthcmlhLWxhYmVsbGVkYnldPmRpdjpmaXJzdC1jaGlsZD5kaXZbcm9sZT0iYnV0dG9uIl1bdGFiaW5kZXg9IjAiXScgLy9mb3IgYXVkaW8gKGV4cGVyaW1lbnRhbCkKICAgICAgXTsKICAgICAgbGV0IG1lZGlhID0gYXJ0aWNsZS5xdWVyeVNlbGVjdG9yKG1lZGlhX3NlbGVjdG9yLmpvaW4oJywnKSk7CiAgICAgIGlmIChtZWRpYSkgewogICAgICAgIGxldCBzdGF0dXNfaWQgPSBhcnRpY2xlLnF1ZXJ5U2VsZWN0b3IoJ2FbaHJlZio9Ii9zdGF0dXMvIl0nKS5ocmVmLnNwbGl0KCcvc3RhdHVzLycpLnBvcCgpLnNwbGl0KCcvJykuc2hpZnQoKTsKICAgICAgICBsZXQgYnRuX2dyb3VwID0gYXJ0aWNsZS5xdWVyeVNlbGVjdG9yKCdkaXZbcm9sZT0iZ3JvdXAiXTpsYXN0LW9mLXR5cGUsIHVsLnR3ZWV0LWFjdGlvbnMsIHVsLnR3ZWV0LWRldGFpbC1hY3Rpb25zJyk7CiAgICAgICAgbGV0IGJ0bl9zaGFyZSA9IEFycmF5LmZyb20oYnRuX2dyb3VwLnF1ZXJ5U2VsZWN0b3JBbGwoJzpzY29wZT5kaXY+ZGl2LCBsaS50d2VldC1hY3Rpb24taXRlbT5hLCBsaS50d2VldC1kZXRhaWwtYWN0aW9uLWl0ZW0+YScpKS5wb3AoKS5wYXJlbnROb2RlOwogICAgICAgIGxldCBidG5fZG93biA9IGJ0bl9zaGFyZS5jbG9uZU5vZGUodHJ1ZSk7CiAgICAgICAgaWYgKGlzX3R3ZWV0ZGVjaykgewogICAgICAgICAgYnRuX2Rvd24uZmlyc3RFbGVtZW50Q2hpbGQuaW5uZXJIVE1MID0gJzxzdmcgdmlld0JveD0iMCAwIDI0IDI0IiBzdHlsZT0id2lkdGg6IDE4cHg7IGhlaWdodDogMThweDsiPicgKyB0aGlzLnN2ZyArICc8L3N2Zz4nOwogICAgICAgICAgYnRuX2Rvd24uZmlyc3RFbGVtZW50Q2hpbGQucmVtb3ZlQXR0cmlidXRlKCdyZWwnKTsKICAgICAgICAgIGJ0bl9kb3duLmNsYXNzTGlzdC5yZXBsYWNlKCJwdWxsLWxlZnQiLCAicHVsbC1yaWdodCIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBidG5fZG93bi5xdWVyeVNlbGVjdG9yKCdzdmcnKS5pbm5lckhUTUwgPSB0aGlzLnN2ZzsKICAgICAgICB9CiAgICAgICAgbGV0IGlzX2V4aXN0ID0gaGlzdG9yeS5pbmRleE9mKHN0YXR1c19pZCkgPj0gMDsKICAgICAgICB0aGlzLnN0YXR1cyhidG5fZG93biwgJ3RtZC1kb3duJyk7CiAgICAgICAgdGhpcy5zdGF0dXMoYnRuX2Rvd24sIGlzX2V4aXN0ID8gJ2NvbXBsZXRlZCcgOiAnZG93bmxvYWQnLCBpc19leGlzdCA/IGxhbmcuY29tcGxldGVkIDogbGFuZy5kb3dubG9hZCk7CiAgICAgICAgYnRuX2dyb3VwLmluc2VydEJlZm9yZShidG5fZG93biwgYnRuX3NoYXJlLm5leHRTaWJsaW5nKTsKICAgICAgICBidG5fZG93bi5vbmNsaWNrID0gKCkgPT4gdGhpcy5jbGljayhidG5fZG93biwgc3RhdHVzX2lkLCBpc19leGlzdCk7CiAgICAgICAgaWYgKHNob3dfc2Vuc2l0aXZlKSB7CiAgICAgICAgICBsZXQgYnRuX3Nob3cgPSBhcnRpY2xlLnF1ZXJ5U2VsZWN0b3IoJ2RpdlthcmlhLWxhYmVsbGVkYnldIGRpdltyb2xlPSJidXR0b24iXVt0YWJpbmRleD0iMCJdOm5vdChbZGF0YS10ZXN0aWRdKSA+IGRpdltkaXJdID4gc3BhbiA+IHNwYW4nKTsKICAgICAgICAgIGlmIChidG5fc2hvdykgYnRuX3Nob3cuY2xpY2soKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgbGV0IGltZ3MgPSBhcnRpY2xlLnF1ZXJ5U2VsZWN0b3JBbGwoJ2FbaHJlZio9Ii9waG90by8iXScpOwogICAgICBpZiAoaW1ncy5sZW5ndGggPiAxKSB7CiAgICAgICAgbGV0IHN0YXR1c19pZCA9IGFydGljbGUucXVlcnlTZWxlY3RvcignYVtocmVmKj0iL3N0YXR1cy8iXScpLmhyZWYuc3BsaXQoJy9zdGF0dXMvJykucG9wKCkuc3BsaXQoJy8nKS5zaGlmdCgpOwogICAgICAgIGxldCBidG5fZ3JvdXAgPSBhcnRpY2xlLnF1ZXJ5U2VsZWN0b3IoJ2Rpdltyb2xlPSJncm91cCJdOmxhc3Qtb2YtdHlwZScpOwogICAgICAgIGxldCBidG5fc2hhcmUgPSBBcnJheS5mcm9tKGJ0bl9ncm91cC5xdWVyeVNlbGVjdG9yQWxsKCc6c2NvcGU+ZGl2PmRpdicpKS5wb3AoKS5wYXJlbnROb2RlOwogICAgICAgIGltZ3MuZm9yRWFjaChpbWcgPT4gewogICAgICAgICAgbGV0IGluZGV4ID0gaW1nLmhyZWYuc3BsaXQoJy9zdGF0dXMvJykucG9wKCkuc3BsaXQoJy8nKS5wb3AoKTsKICAgICAgICAgIGxldCBpc19leGlzdCA9IGhpc3RvcnkuaW5kZXhPZihzdGF0dXNfaWQpID49IDA7CiAgICAgICAgICBsZXQgYnRuX2Rvd24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgIGJ0bl9kb3duLmlubmVySFRNTCA9ICc8ZGl2PjxkaXY+PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHN0eWxlPSJ3aWR0aDogMThweDsgaGVpZ2h0OiAxOHB4OyI+JyArIHRoaXMuc3ZnICsgJzwvc3ZnPjwvZGl2PjwvZGl2Pic7CiAgICAgICAgICBidG5fZG93bi5jbGFzc0xpc3QuYWRkKCd0bWQtZG93bicsICd0bWQtaW1nJyk7CiAgICAgICAgICB0aGlzLnN0YXR1cyhidG5fZG93biwgJ2Rvd25sb2FkJyk7CiAgICAgICAgICBpbWcucGFyZW50Tm9kZS5hcHBlbmRDaGlsZChidG5fZG93bik7CiAgICAgICAgICBidG5fZG93bi5vbmNsaWNrID0gZSA9PiB7CiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgdGhpcy5jbGljayhidG5fZG93biwgc3RhdHVzX2lkLCBpc19leGlzdCwgaW5kZXgpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgYWRkQnV0dG9uVG9NZWRpYTogZnVuY3Rpb24obGlzdGl0ZW1zKSB7CiAgICAgIGxpc3RpdGVtcy5mb3JFYWNoKGxpID0+IHsKICAgICAgICBpZiAobGkuZGF0YXNldC5kZXRlY3RlZCkgcmV0dXJuOwogICAgICAgIGxpLmRhdGFzZXQuZGV0ZWN0ZWQgPSAndHJ1ZSc7CiAgICAgICAgbGV0IHN0YXR1c19pZCA9IGxpLnF1ZXJ5U2VsZWN0b3IoJ2FbaHJlZio9Ii9zdGF0dXMvIl0nKS5ocmVmLnNwbGl0KCcvc3RhdHVzLycpLnBvcCgpLnNwbGl0KCcvJykuc2hpZnQoKTsKICAgICAgICBsZXQgaXNfZXhpc3QgPSBoaXN0b3J5LmluZGV4T2Yoc3RhdHVzX2lkKSA+PSAwOwogICAgICAgIGxldCBidG5fZG93biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIGJ0bl9kb3duLmlubmVySFRNTCA9ICc8ZGl2PjxkaXY+PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHN0eWxlPSJ3aWR0aDogMThweDsgaGVpZ2h0OiAxOHB4OyI+JyArIHRoaXMuc3ZnICsgJzwvc3ZnPjwvZGl2PjwvZGl2Pic7CiAgICAgICAgYnRuX2Rvd24uY2xhc3NMaXN0LmFkZCgndG1kLWRvd24nLCAndG1kLW1lZGlhJyk7CiAgICAgICAgdGhpcy5zdGF0dXMoYnRuX2Rvd24sIGlzX2V4aXN0ID8gJ2NvbXBsZXRlZCcgOiAnZG93bmxvYWQnLCBpc19leGlzdCA/IGxhbmcuY29tcGxldGVkIDogbGFuZy5kb3dubG9hZCk7CiAgICAgICAgbGkuYXBwZW5kQ2hpbGQoYnRuX2Rvd24pOwogICAgICAgIGJ0bl9kb3duLm9uY2xpY2sgPSAoKSA9PiB0aGlzLmNsaWNrKGJ0bl9kb3duLCBzdGF0dXNfaWQsIGlzX2V4aXN0KTsKICAgICAgfSk7CiAgICB9LAogICAgY2xpY2s6IGFzeW5jIGZ1bmN0aW9uIChidG4sIHN0YXR1c19pZCwgaXNfZXhpc3QsIGluZGV4KSB7CiAgICAgIGlmIChidG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdsb2FkaW5nJykpIHJldHVybjsKICAgICAgdGhpcy5zdGF0dXMoYnRuLCAnbG9hZGluZycpOwogICAgICBsZXQgb3V0ID0gKGF3YWl0IEdNX2dldFZhbHVlKCdmaWxlbmFtZScsIGZpbGVuYW1lKSkuc3BsaXQoJ1xuJykuam9pbignJyk7CiAgICAgIGxldCBzYXZlX2hpc3RvcnkgPSBhd2FpdCBHTV9nZXRWYWx1ZSgnc2F2ZV9oaXN0b3J5JywgdHJ1ZSk7CiAgICAgIGxldCBqc29uID0gYXdhaXQgdGhpcy5mZXRjaEpzb24oc3RhdHVzX2lkKTsKICAgICAgbGV0IHR3ZWV0ID0ganNvbi5sZWdhY3k7CiAgICAgIGxldCB1c2VyID0ganNvbi5jb3JlLnVzZXJfcmVzdWx0cy5yZXN1bHQubGVnYWN5OwogICAgICBsZXQgaW52YWxpZF9jaGFycyA9IHsnXFwnOiAn77y8JywgJ1wvJzogJ++8jycsICdcfCc6ICfvvZwnLCAnPCc6ICfvvJwnLCAnPic6ICfvvJ4nLCAnOic6ICfvvJonLCAnKic6ICfvvIonLCAnPyc6ICfvvJ8nLCAnIic6ICfvvIInLCAnXHUyMDBiJzogJycsICdcdTIwMGMnOiAnJywgJ1x1MjAwZCc6ICcnLCAnXHUyMDYwJzogJycsICdcdWZlZmYnOiAnJywgJ/CflJ4nOiAnJ307CiAgICAgIGxldCBkYXRldGltZSA9IG91dC5tYXRjaCgve2RhdGUtdGltZSgtbG9jYWwpPzpbXnt9XSt9LykgPyBvdXQubWF0Y2goL3tkYXRlLXRpbWUoPzotbG9jYWwpPzooW157fV0rKX0vKVsxXS5yZXBsYWNlKC9bXFwvfDw+Kj86Il0vZywgdiA9PiBpbnZhbGlkX2NoYXJzW3ZdKSA6ICdZWVlZTU1ERC1oaG1tc3MnOwogICAgICBsZXQgaW5mbyA9IHt9OwogICAgICBpbmZvWydzdGF0dXMtaWQnXSA9IHN0YXR1c19pZDsKICAgICAgaW5mb1sndXNlci1uYW1lJ10gPSB1c2VyLm5hbWUucmVwbGFjZSgvKFtcXC98Kj86Il18W1x1MjAwYi1cdTIwMGRcdTIwNjBcdWZlZmZdfPCflJ4pL2csIHYgPT4gaW52YWxpZF9jaGFyc1t2XSk7CiAgICAgIGluZm9bJ3VzZXItaWQnXSA9IHVzZXIuc2NyZWVuX25hbWU7CiAgICAgIGluZm9bJ2RhdGUtdGltZSddID0gdGhpcy5mb3JtYXREYXRlKHR3ZWV0LmNyZWF0ZWRfYXQsIGRhdGV0aW1lKTsKICAgICAgaW5mb1snZGF0ZS10aW1lLWxvY2FsJ10gPSB0aGlzLmZvcm1hdERhdGUodHdlZXQuY3JlYXRlZF9hdCwgZGF0ZXRpbWUsIHRydWUpOwogICAgICBpbmZvWydmdWxsLXRleHQnXSA9IHR3ZWV0LmZ1bGxfdGV4dC5zcGxpdCgnXG4nKS5qb2luKCcgJykucmVwbGFjZSgvXHMqaHR0cHM6XC9cL3RcLmNvXC9cdysvZywgJycpLnJlcGxhY2UoL1tcXC98PD4qPzoiXXxbXHUyMDBiLVx1MjAwZFx1MjA2MFx1ZmVmZl0vZywgdiA9PiBpbnZhbGlkX2NoYXJzW3ZdKTsKICAgICAgbGV0IG1lZGlhcyA9IHR3ZWV0LmV4dGVuZGVkX2VudGl0aWVzICYmIHR3ZWV0LmV4dGVuZGVkX2VudGl0aWVzLm1lZGlhOwogICAgICBpZiAoaW5kZXgpIG1lZGlhcyA9IFttZWRpYXNbaW5kZXggLSAxXV07CiAgICAgIGlmIChtZWRpYXMubGVuZ3RoID4gMCkgewogICAgICAgIGxldCB0YXNrcyA9IG1lZGlhcy5sZW5ndGg7CiAgICAgICAgbGV0IHRhc2tzX3Jlc3VsdCA9IFtdOwogICAgICAgIG1lZGlhcy5mb3JFYWNoKChtZWRpYSwgaSkgPT4gewogICAgICAgICAgaW5mby51cmwgPSBtZWRpYS50eXBlID09ICdwaG90bycgPyBtZWRpYS5tZWRpYV91cmxfaHR0cHMgKyAnOm9yaWcnIDogbWVkaWEudmlkZW9faW5mby52YXJpYW50cy5maWx0ZXIobiA9PiBuLmNvbnRlbnRfdHlwZSA9PSAndmlkZW8vbXA0Jykuc29ydCgoYSwgYikgPT4gYi5iaXRyYXRlIC0gYS5iaXRyYXRlKVswXS51cmw7CiAgICAgICAgICBpbmZvLmZpbGUgPSBpbmZvLnVybC5zcGxpdCgnLycpLnBvcCgpLnNwbGl0KC9bOj9dLykuc2hpZnQoKTsKICAgICAgICAgIGluZm9bJ2ZpbGUtbmFtZSddID0gaW5mby5maWxlLnNwbGl0KCcuJykuc2hpZnQoKTsKICAgICAgICAgIGluZm9bJ2ZpbGUtZXh0J10gPSBpbmZvLmZpbGUuc3BsaXQoJy4nKS5wb3AoKTsKICAgICAgICAgIGluZm9bJ2ZpbGUtdHlwZSddID0gbWVkaWEudHlwZS5yZXBsYWNlKCdhbmltYXRlZF8nLCAnJyk7CiAgICAgICAgICBpbmZvLm91dCA9IChvdXQucmVwbGFjZSgvXC4/e2ZpbGUtZXh0fS8sICcnKSArICgobWVkaWFzLmxlbmd0aCA+IDEgfHwgaW5kZXgpICYmICFvdXQubWF0Y2goJ3tmaWxlLW5hbWV9JykgPyAnLScgKyAoaW5kZXggPyBpbmRleCAtIDEgOiBpKSA6ICcnKSArICcue2ZpbGUtZXh0fScpLnJlcGxhY2UoL3soW157fTpdKykoOltee31dKyk/fS9nLCAobWF0Y2gsIG5hbWUpID0+IGluZm9bbmFtZV0pOwogICAgICAgICAgdGhpcy5kb3dubG9hZGVyLmFkZCh7CiAgICAgICAgICAgIHVybDogaW5mby51cmwsCiAgICAgICAgICAgIG5hbWU6IGluZm8ub3V0LAogICAgICAgICAgICBvbmxvYWQ6ICgpID0+IHsKICAgICAgICAgICAgICB0YXNrcyAtPSAxOwogICAgICAgICAgICAgIHRhc2tzX3Jlc3VsdC5wdXNoKCgobWVkaWFzLmxlbmd0aCA+IDEgfHwgaW5kZXgpID8gKGluZGV4ID8gaW5kZXggOiBpICsgMSkgKyAnOiAnIDogJycpICsgbGFuZy5jb21wbGV0ZWQpOwogICAgICAgICAgICAgIHRoaXMuc3RhdHVzKGJ0biwgbnVsbCwgdGFza3NfcmVzdWx0LnNvcnQoKS5qb2luKCdcbicpKTsKICAgICAgICAgICAgICBpZiAodGFza3MgPT09IDApIHsKICAgICAgICAgICAgICAgIHRoaXMuc3RhdHVzKGJ0biwgJ2NvbXBsZXRlZCcsIGxhbmcuY29tcGxldGVkKTsKICAgICAgICAgICAgICAgIGlmIChzYXZlX2hpc3RvcnkgJiYgIWlzX2V4aXN0KSB7CiAgICAgICAgICAgICAgICAgIGhpc3RvcnkucHVzaChzdGF0dXNfaWQpOwogICAgICAgICAgICAgICAgICB0aGlzLnN0b3JhZ2Uoc3RhdHVzX2lkKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9uZXJyb3I6IHJlc3VsdCA9PiB7CiAgICAgICAgICAgICAgdGFza3MgPSAtMTsKICAgICAgICAgICAgICB0YXNrc19yZXN1bHQucHVzaCgobWVkaWFzLmxlbmd0aCA+IDEgPyBpICsgMSArICc6ICcgOiAnJykgKyByZXN1bHQuZGV0YWlscy5jdXJyZW50KTsKICAgICAgICAgICAgICB0aGlzLnN0YXR1cyhidG4sICdmYWlsZWQnLCB0YXNrc19yZXN1bHQuc29ydCgpLmpvaW4oJ1xuJykpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnN0YXR1cyhidG4sICdmYWlsZWQnLCAnTUVESUFfTk9UX0ZPVU5EJyk7CiAgICAgIH0KICAgIH0sCiAgICBzdGF0dXM6IGZ1bmN0aW9uIChidG4sIGNzcywgdGl0bGUsIHN0eWxlKSB7CiAgICAgIGlmIChjc3MpIHsKICAgICAgICBidG4uY2xhc3NMaXN0LnJlbW92ZSgnZG93bmxvYWQnLCAnY29tcGxldGVkJywgJ2xvYWRpbmcnLCAnZmFpbGVkJyk7CiAgICAgICAgYnRuLmNsYXNzTGlzdC5hZGQoY3NzKTsKICAgICAgfQogICAgICBpZiAodGl0bGUpIGJ0bi50aXRsZSA9IHRpdGxlOwogICAgICBpZiAoc3R5bGUpIGJ0bi5zdHlsZS5jc3NUZXh0ID0gc3R5bGU7CiAgICB9LAogICAgc2V0dGluZ3M6IGFzeW5jIGZ1bmN0aW9uICgpIHsKICAgICAgY29uc3QgJGVsZW1lbnQgPSAocGFyZW50LCB0YWcsIHN0eWxlLCBjb250ZW50LCBjc3MpID0+IHsKICAgICAgICBsZXQgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZyk7CiAgICAgICAgaWYgKHN0eWxlKSBlbC5zdHlsZS5jc3NUZXh0ID0gc3R5bGU7CiAgICAgICAgaWYgKHR5cGVvZiBjb250ZW50ICE9PSAndW5kZWZpbmVkJykgewogICAgICAgICAgaWYgKHRhZyA9PSAnaW5wdXQnKSB7CiAgICAgICAgICAgIGlmIChjb250ZW50ID09ICdjaGVja2JveCcpIGVsLnR5cGUgPSBjb250ZW50OwogICAgICAgICAgICBlbHNlIGVsLnZhbHVlID0gY29udGVudDsKICAgICAgICAgIH0gZWxzZSBlbC5pbm5lckhUTUwgPSBjb250ZW50OwogICAgICAgIH0KICAgICAgICBpZiAoY3NzKSBjc3Muc3BsaXQoJyAnKS5mb3JFYWNoKGMgPT4gZWwuY2xhc3NMaXN0LmFkZChjKSk7CiAgICAgICAgcGFyZW50LmFwcGVuZENoaWxkKGVsKTsKICAgICAgICByZXR1cm4gZWw7CiAgICAgIH07CiAgICAgIGxldCB3YXBwZXIgPSAkZWxlbWVudChkb2N1bWVudC5ib2R5LCAnZGl2JywgJ3Bvc2l0aW9uOiBmaXhlZDsgbGVmdDogMHB4OyB0b3A6IDBweDsgd2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsgYmFja2dyb3VuZC1jb2xvcjogIzAwMDk7IHotaW5kZXg6IDEwOycpOwogICAgICBsZXQgd2FwcGVyX2Nsb3NlOwogICAgICB3YXBwZXIub25tb3VzZWRvd24gPSBlID0+IHsKICAgICAgICB3YXBwZXJfY2xvc2UgPSBlLnRhcmdldCA9PSB3YXBwZXI7CiAgICAgIH07CiAgICAgIHdhcHBlci5vbm1vdXNldXAgPSBlID0+IHsKICAgICAgICBpZiAod2FwcGVyX2Nsb3NlICYmIGUudGFyZ2V0ID09IHdhcHBlcikgd2FwcGVyLnJlbW92ZSgpOwogICAgICB9OwogICAgICBsZXQgZGlhbG9nID0gJGVsZW1lbnQod2FwcGVyLCAnZGl2JywgJ3Bvc2l0aW9uOiBhYnNvbHV0ZTsgbGVmdDogNTAlOyB0b3A6IDUwJTsgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC01MCUpIHRyYW5zbGF0ZVkoLTUwJSk7IHdpZHRoOiBmaXQtY29udGVudDsgd2lkdGg6IC1tb3otZml0LWNvbnRlbnQ7IGJhY2tncm91bmQtY29sb3I6ICNmM2YzZjM7IGJvcmRlcjogMXB4IHNvbGlkICNjY2M7IGJvcmRlci1yYWRpdXM6IDEwcHg7IGNvbG9yOiBibGFjazsnKTsKICAgICAgbGV0IHRpdGxlID0gJGVsZW1lbnQoZGlhbG9nLCAnaDMnLCAnbWFyZ2luOiAxMHB4IDIwcHg7JywgbGFuZy5kaWFsb2cudGl0bGUpOwogICAgICBsZXQgb3B0aW9ucyA9ICRlbGVtZW50KGRpYWxvZywgJ2RpdicsICdtYXJnaW46IDEwcHg7IGJvcmRlcjogMXB4IHNvbGlkICNjY2M7IGJvcmRlci1yYWRpdXM6IDVweDsnKTsKICAgICAgbGV0IHNhdmVfaGlzdG9yeV9sYWJlbCA9ICRlbGVtZW50KG9wdGlvbnMsICdsYWJlbCcsICdkaXNwbGF5OiBibG9jazsgbWFyZ2luOiAxMHB4OycsIGxhbmcuZGlhbG9nLnNhdmVfaGlzdG9yeSk7CiAgICAgIGxldCBzYXZlX2hpc3RvcnlfaW5wdXQgPSAkZWxlbWVudChzYXZlX2hpc3RvcnlfbGFiZWwsICdpbnB1dCcsICdmbG9hdDogbGVmdDsnLCAnY2hlY2tib3gnKTsKICAgICAgc2F2ZV9oaXN0b3J5X2lucHV0LmNoZWNrZWQgPSBhd2FpdCBHTV9nZXRWYWx1ZSgnc2F2ZV9oaXN0b3J5JywgdHJ1ZSk7CiAgICAgIHNhdmVfaGlzdG9yeV9pbnB1dC5vbmNoYW5nZSA9ICgpID0+IHsKICAgICAgICBHTV9zZXRWYWx1ZSgnc2F2ZV9oaXN0b3J5Jywgc2F2ZV9oaXN0b3J5X2lucHV0LmNoZWNrZWQpOwogICAgICB9CiAgICAgIGxldCBjbGVhcl9oaXN0b3J5ID0gJGVsZW1lbnQoc2F2ZV9oaXN0b3J5X2xhYmVsLCAnbGFiZWwnLCAnZGlzcGxheTogaW5saW5lLWJsb2NrOyBtYXJnaW46IDAgMTBweDsgY29sb3I6IGJsdWU7JywgbGFuZy5kaWFsb2cuY2xlYXJfaGlzdG9yeSk7CiAgICAgIGNsZWFyX2hpc3Rvcnkub25jbGljayA9ICgpID0+IHsKICAgICAgICBpZiAoY29uZmlybShsYW5nLmRpYWxvZy5jbGVhcl9jb25maXJtKSkgewogICAgICAgICAgaGlzdG9yeSA9IFtdOwogICAgICAgICAgR01fc2V0VmFsdWUoJ2Rvd25sb2FkX2hpc3RvcnknLCBbXSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBsZXQgc2hvd19zZW5zaXRpdmVfbGFiZWwgPSAkZWxlbWVudChvcHRpb25zLCAnbGFiZWwnLCAnZGlzcGxheTogYmxvY2s7IG1hcmdpbjogMTBweDsnLCBsYW5nLmRpYWxvZy5zaG93X3NlbnNpdGl2ZSk7CiAgICAgIGxldCBzaG93X3NlbnNpdGl2ZV9pbnB1dCA9ICRlbGVtZW50KHNob3dfc2Vuc2l0aXZlX2xhYmVsLCAnaW5wdXQnLCAnZmxvYXQ6IGxlZnQ7JywgJ2NoZWNrYm94Jyk7CiAgICAgIHNob3dfc2Vuc2l0aXZlX2lucHV0LmNoZWNrZWQgPSBhd2FpdCBHTV9nZXRWYWx1ZSgnc2hvd19zZW5zaXRpdmUnLCBmYWxzZSk7CiAgICAgIHNob3dfc2Vuc2l0aXZlX2lucHV0Lm9uY2hhbmdlID0gKCkgPT4gewogICAgICAgIHNob3dfc2Vuc2l0aXZlID0gc2hvd19zZW5zaXRpdmVfaW5wdXQuY2hlY2tlZDsKICAgICAgICBHTV9zZXRWYWx1ZSgnc2hvd19zZW5zaXRpdmUnLCBzaG93X3NlbnNpdGl2ZSk7CiAgICAgIH07CiAgICAgIGxldCBmaWxlbmFtZV9kaXYgPSAkZWxlbWVudChkaWFsb2csICdkaXYnLCAnbWFyZ2luOiAxMHB4OyBib3JkZXI6IDFweCBzb2xpZCAjY2NjOyBib3JkZXItcmFkaXVzOiA1cHg7Jyk7CiAgICAgIGxldCBmaWxlbmFtZV9sYWJlbCA9ICRlbGVtZW50KGZpbGVuYW1lX2RpdiwgJ2xhYmVsJywgJ2Rpc3BsYXk6IGJsb2NrOyBtYXJnaW46IDEwcHggMTVweDsnLCBsYW5nLmRpYWxvZy5wYXR0ZXJuKTsKICAgICAgbGV0IGZpbGVuYW1lX2lucHV0ID0gJGVsZW1lbnQoZmlsZW5hbWVfbGFiZWwsICd0ZXh0YXJlYScsICdkaXNwbGF5OiBibG9jazsgbWluLXdpZHRoOiA1MDBweDsgbWF4LXdpZHRoOiA1MDBweDsgbWluLWhlaWdodDogMTAwcHg7IGZvbnQtc2l6ZTogaW5oZXJpdDsgYmFja2dyb3VuZDogd2hpdGU7IGNvbG9yOiBibGFjazsnLCBhd2FpdCBHTV9nZXRWYWx1ZSgnZmlsZW5hbWUnLCBmaWxlbmFtZSkpOwogICAgICBsZXQgZmlsZW5hbWVfdGFncyA9ICRlbGVtZW50KGZpbGVuYW1lX2RpdiwgJ2xhYmVsJywgJ2Rpc3BsYXk6IHRhYmxlOyBtYXJnaW46IDEwcHg7JywgYAo8c3BhbiBjbGFzcz0idG1kLXRhZyIgdGl0bGU9InVzZXIgbmFtZSI+e3VzZXItbmFtZX08L3NwYW4+CjxzcGFuIGNsYXNzPSJ0bWQtdGFnIiB0aXRsZT0iVGhlIHVzZXIgbmFtZSBhZnRlciBAIHNpZ24uIj57dXNlci1pZH08L3NwYW4+CjxzcGFuIGNsYXNzPSJ0bWQtdGFnIiB0aXRsZT0iZXhhbXBsZTogMTIzNDU2Nzg5MDk4NzY1NDMyMSI+e3N0YXR1cy1pZH08L3NwYW4+CjxzcGFuIGNsYXNzPSJ0bWQtdGFnIiB0aXRsZT0ie2RhdGUtdGltZX0gOiBQb3N0ZWQgdGltZSBpbiBVVEMuXG57ZGF0ZS10aW1lLWxvY2FsfSA6IFlvdXIgbG9jYWwgdGltZSB6b25lLlxuXG5EZWZhdWx0OlxuWVlZWU1NREQtaGhtbXNzID0+IDIwMjAxMjMxLTIzNTk1OVxuXG5FeGFtcGxlIG9mIGN1c3RvbTpcbntkYXRlLXRpbWU6REQtTU1NLVlZIGhoLm1tfSA9PiAzMS1ERUMtMjEgMjMuNTkiPntkYXRlLXRpbWV9PC9zcGFuPjxicj4KPHNwYW4gY2xhc3M9InRtZC10YWciIHRpdGxlPSJUZXh0IGNvbnRlbnQgaW4gdHdlZXQuIj57ZnVsbC10ZXh0fTwvc3Bhbj4KPHNwYW4gY2xhc3M9InRtZC10YWciIHRpdGxlPSJUeXBlIG9mICYjMzQ7dmlkZW8mIzM0OyBvciAmIzM0O3Bob3RvJiMzNDsgb3IgJiMzNDtnaWYmIzM0Oy4iPntmaWxlLXR5cGV9PC9zcGFuPgo8c3BhbiBjbGFzcz0idG1kLXRhZyIgdGl0bGU9Ik9yaWdpbmFsIGZpbGVuYW1lIGZyb20gVVJMLiI+e2ZpbGUtbmFtZX08L3NwYW4+CmApOwogICAgICBmaWxlbmFtZV9pbnB1dC5zZWxlY3Rpb25TdGFydCA9IGZpbGVuYW1lX2lucHV0LnZhbHVlLmxlbmd0aDsKICAgICAgZmlsZW5hbWVfdGFncy5xdWVyeVNlbGVjdG9yQWxsKCcudG1kLXRhZycpLmZvckVhY2godGFnID0+IHsKICAgICAgICB0YWcub25jbGljayA9ICgpID0+IHsKICAgICAgICAgIGxldCBzcyA9IGZpbGVuYW1lX2lucHV0LnNlbGVjdGlvblN0YXJ0OwogICAgICAgICAgbGV0IHNlID0gZmlsZW5hbWVfaW5wdXQuc2VsZWN0aW9uRW5kOwogICAgICAgICAgZmlsZW5hbWVfaW5wdXQudmFsdWUgPSBmaWxlbmFtZV9pbnB1dC52YWx1ZS5zdWJzdHJpbmcoMCwgc3MpICsgdGFnLmlubmVyVGV4dCArIGZpbGVuYW1lX2lucHV0LnZhbHVlLnN1YnN0cmluZyhzZSk7CiAgICAgICAgICBmaWxlbmFtZV9pbnB1dC5zZWxlY3Rpb25TdGFydCA9IHNzICsgdGFnLmlubmVyVGV4dC5sZW5ndGg7CiAgICAgICAgICBmaWxlbmFtZV9pbnB1dC5zZWxlY3Rpb25FbmQgPSBzcyArIHRhZy5pbm5lclRleHQubGVuZ3RoOwogICAgICAgICAgZmlsZW5hbWVfaW5wdXQuZm9jdXMoKTsKICAgICAgICB9OwogICAgICB9KTsKICAgICAgbGV0IGJ0bl9zYXZlID0gJGVsZW1lbnQodGl0bGUsICdsYWJlbCcsICdmbG9hdDogcmlnaHQ7JywgbGFuZy5kaWFsb2cuc2F2ZSwgJ3RtZC1idG4nKTsKICAgICAgYnRuX3NhdmUub25jbGljayA9IGFzeW5jICgpID0+IHsKICAgICAgICBhd2FpdCBHTV9zZXRWYWx1ZSgnZmlsZW5hbWUnLCBmaWxlbmFtZV9pbnB1dC52YWx1ZSk7CiAgICAgICAgd2FwcGVyLnJlbW92ZSgpOwogICAgICB9OwogICAgfSwKICAgIGZldGNoSnNvbjogYXN5bmMgZnVuY3Rpb24gKHN0YXR1c19pZCkgewogICAgICBsZXQgYmFzZV91cmwgPSBgaHR0cHM6Ly8ke2hvc3R9L2kvYXBpL2dyYXBocWwvTm1DZUNna1Zsc1JHUzFjQXdxdGdtdy9Ud2VldERldGFpbGA7CiAgICAgIGxldCB2YXJpYWJsZXMgPSB7CiAgICAgICAgImZvY2FsVHdlZXRJZCI6c3RhdHVzX2lkLAogICAgICAgICJ3aXRoX3J1eF9pbmplY3Rpb25zIjpmYWxzZSwKICAgICAgICAiaW5jbHVkZVByb21vdGVkQ29udGVudCI6dHJ1ZSwKICAgICAgICAid2l0aENvbW11bml0eSI6dHJ1ZSwKICAgICAgICAid2l0aFF1aWNrUHJvbW90ZUVsaWdpYmlsaXR5VHdlZXRGaWVsZHMiOnRydWUsCiAgICAgICAgIndpdGhCaXJkd2F0Y2hOb3RlcyI6dHJ1ZSwKICAgICAgICAid2l0aFZvaWNlIjp0cnVlLAogICAgICAgICJ3aXRoVjJUaW1lbGluZSI6dHJ1ZQogICAgICB9OwogICAgICBsZXQgZmVhdHVyZXMgPSB7CiAgICAgICAgInJ3ZWJfbGlzdHNfdGltZWxpbmVfcmVkZXNpZ25fZW5hYmxlZCI6dHJ1ZSwKICAgICAgICAicmVzcG9uc2l2ZV93ZWJfZ3JhcGhxbF9leGNsdWRlX2RpcmVjdGl2ZV9lbmFibGVkIjp0cnVlLAogICAgICAgICJ2ZXJpZmllZF9waG9uZV9sYWJlbF9lbmFibGVkIjpmYWxzZSwKICAgICAgICAiY3JlYXRvcl9zdWJzY3JpcHRpb25zX3R3ZWV0X3ByZXZpZXdfYXBpX2VuYWJsZWQiOnRydWUsCiAgICAgICAgInJlc3BvbnNpdmVfd2ViX2dyYXBocWxfdGltZWxpbmVfbmF2aWdhdGlvbl9lbmFibGVkIjp0cnVlLAogICAgICAgICJyZXNwb25zaXZlX3dlYl9ncmFwaHFsX3NraXBfdXNlcl9wcm9maWxlX2ltYWdlX2V4dGVuc2lvbnNfZW5hYmxlZCI6ZmFsc2UsCiAgICAgICAgInR3ZWV0eXBpZV91bm1lbnRpb25fb3B0aW1pemF0aW9uX2VuYWJsZWQiOnRydWUsCiAgICAgICAgInJlc3BvbnNpdmVfd2ViX2VkaXRfdHdlZXRfYXBpX2VuYWJsZWQiOnRydWUsCiAgICAgICAgImdyYXBocWxfaXNfdHJhbnNsYXRhYmxlX3J3ZWJfdHdlZXRfaXNfdHJhbnNsYXRhYmxlX2VuYWJsZWQiOnRydWUsCiAgICAgICAgInZpZXdfY291bnRzX2V2ZXJ5d2hlcmVfYXBpX2VuYWJsZWQiOnRydWUsCiAgICAgICAgImxvbmdmb3JtX25vdGV0d2VldHNfY29uc3VtcHRpb25fZW5hYmxlZCI6dHJ1ZSwKICAgICAgICAicmVzcG9uc2l2ZV93ZWJfdHdpdHRlcl9hcnRpY2xlX3R3ZWV0X2NvbnN1bXB0aW9uX2VuYWJsZWQiOmZhbHNlLAogICAgICAgICJ0d2VldF9hd2FyZHNfd2ViX3RpcHBpbmdfZW5hYmxlZCI6ZmFsc2UsCiAgICAgICAgImZyZWVkb21fb2Zfc3BlZWNoX25vdF9yZWFjaF9mZXRjaF9lbmFibGVkIjp0cnVlLAogICAgICAgICJzdGFuZGFyZGl6ZWRfbnVkZ2VzX21pc2luZm8iOnRydWUsCiAgICAgICAgInR3ZWV0X3dpdGhfdmlzaWJpbGl0eV9yZXN1bHRzX3ByZWZlcl9ncWxfbGltaXRlZF9hY3Rpb25zX3BvbGljeV9lbmFibGVkIjp0cnVlLAogICAgICAgICJsb25nZm9ybV9ub3RldHdlZXRzX3JpY2hfdGV4dF9yZWFkX2VuYWJsZWQiOnRydWUsCiAgICAgICAgImxvbmdmb3JtX25vdGV0d2VldHNfaW5saW5lX21lZGlhX2VuYWJsZWQiOnRydWUsCiAgICAgICAgInJlc3BvbnNpdmVfd2ViX21lZGlhX2Rvd25sb2FkX3ZpZGVvX2VuYWJsZWQiOmZhbHNlLAogICAgICAgICJyZXNwb25zaXZlX3dlYl9lbmhhbmNlX2NhcmRzX2VuYWJsZWQiOmZhbHNlCiAgICAgIH07CiAgICAgIGxldCB1cmwgPSBlbmNvZGVVUkkoYCR7YmFzZV91cmx9P3ZhcmlhYmxlcz0ke0pTT04uc3RyaW5naWZ5KHZhcmlhYmxlcyl9JmZlYXR1cmVzPSR7SlNPTi5zdHJpbmdpZnkoZmVhdHVyZXMpfWApOwogICAgICBsZXQgY29va2llcyA9IHRoaXMuZ2V0Q29va2llKCk7CiAgICAgIGxldCBoZWFkZXJzID0gewogICAgICAgICdhdXRob3JpemF0aW9uJzogJ0JlYXJlciBBQUFBQUFBQUFBQUFBQUFBQUFBQUFOUklMZ0FBQUFBQW5Od0l6VWVqUkNPdUg1RTZJOHhuWno0cHVUcyUzRDFadjd0dGZrOExGODFJVXExNmNIamhMVHZKdTRGQTMzQUdXV2pDcFRuQScsCiAgICAgICAgJ3gtdHdpdHRlci1hY3RpdmUtdXNlcic6ICd5ZXMnLAogICAgICAgICd4LXR3aXR0ZXItY2xpZW50LWxhbmd1YWdlJzogY29va2llcy5sYW5nLAogICAgICAgICd4LWNzcmYtdG9rZW4nOiBjb29raWVzLmN0MAogICAgICB9OwogICAgICBpZiAoY29va2llcy5jdDAubGVuZ3RoID09IDMyKSBoZWFkZXJzWyd4LWd1ZXN0LXRva2VuJ10gPSBjb29raWVzLmd0OwogICAgICBsZXQgdHdlZXRfZGV0YWlsID0gYXdhaXQgZmV0Y2godXJsLCB7aGVhZGVyczogaGVhZGVyc30pLnRoZW4ocmVzdWx0ID0+IHJlc3VsdC5qc29uKCkpOwogICAgICBsZXQgdHdlZXRfZW50cmllID0gdHdlZXRfZGV0YWlsLmRhdGEudGhyZWFkZWRfY29udmVyc2F0aW9uX3dpdGhfaW5qZWN0aW9uc192Mi5pbnN0cnVjdGlvbnNbMF0uZW50cmllcy5maW5kKG4gPT4gbi5lbnRyeUlkID09IGB0d2VldC0ke3N0YXR1c19pZH1gKTsKICAgICAgbGV0IHR3ZWV0X3Jlc3VsdCA9IHR3ZWV0X2VudHJpZS5jb250ZW50Lml0ZW1Db250ZW50LnR3ZWV0X3Jlc3VsdHMucmVzdWx0OwogICAgICByZXR1cm4gdHdlZXRfcmVzdWx0LnR3ZWV0IHx8IHR3ZWV0X3Jlc3VsdDsKICAgIH0sCiAgICBnZXRDb29raWU6IGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgIGxldCBjb29raWVzID0ge307CiAgICAgIGRvY3VtZW50LmNvb2tpZS5zcGxpdCgnOycpLmZpbHRlcihuID0+IG4uaW5kZXhPZignPScpID4gMCkuZm9yRWFjaChuID0+IHsKICAgICAgICBuLnJlcGxhY2UoL14oW149XSspPSguKykkLywgKG1hdGNoLCBuYW1lLCB2YWx1ZSkgPT4gewogICAgICAgICAgY29va2llc1tuYW1lLnRyaW0oKV0gPSB2YWx1ZS50cmltKCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICByZXR1cm4gbmFtZSA/IGNvb2tpZXNbbmFtZV0gOiBjb29raWVzOwogICAgfSwKICAgIHN0b3JhZ2U6IGFzeW5jIGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICBsZXQgZGF0YSA9IGF3YWl0IEdNX2dldFZhbHVlKCdkb3dubG9hZF9oaXN0b3J5JywgW10pOwogICAgICBsZXQgZGF0YV9sZW5ndGggPSBkYXRhLmxlbmd0aDsKICAgICAgaWYgKHZhbHVlKSB7CiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSBkYXRhID0gZGF0YS5jb25jYXQodmFsdWUpOwogICAgICAgIGVsc2UgaWYgKGRhdGEuaW5kZXhPZih2YWx1ZSkgPCAwKSBkYXRhLnB1c2godmFsdWUpOwogICAgICB9IGVsc2UgcmV0dXJuIGRhdGE7CiAgICAgIGlmIChkYXRhLmxlbmd0aCA+IGRhdGFfbGVuZ3RoKSBHTV9zZXRWYWx1ZSgnZG93bmxvYWRfaGlzdG9yeScsIGRhdGEpOwogICAgfSwKICAgIHN0b3JhZ2Vfb2Jzb2xldGU6IGZ1bmN0aW9uIChpc19yZW1vdmUpIHsKICAgICAgbGV0IGRhdGEgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdoaXN0b3J5JykgfHwgJ1tdJyk7CiAgICAgIGlmIChpc19yZW1vdmUpIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdoaXN0b3J5Jyk7CiAgICAgIGVsc2UgcmV0dXJuIGRhdGE7CiAgICB9LAogICAgZm9ybWF0RGF0ZTogZnVuY3Rpb24gKGksIG8sIHR6KSB7CiAgICAgIGxldCBkID0gbmV3IERhdGUoaSk7CiAgICAgIGlmICh0eikgZC5zZXRNaW51dGVzKGQuZ2V0TWludXRlcygpIC0gZC5nZXRUaW1lem9uZU9mZnNldCgpKTsKICAgICAgbGV0IG0gPSBbJ0pBTicsJ0ZFQicsJ01BUicsJ0FQUicsJ01BWScsJ0pVTicsJ0pVTCcsJ0FVRycsJ1NFUCcsJ09DVCcsJ05PVicsJ0RFQyddOwogICAgICBsZXQgdiA9IHsKICAgICAgICBZWVlZOiBkLmdldFVUQ0Z1bGxZZWFyKCkudG9TdHJpbmcoKSwKICAgICAgICBZWTogZC5nZXRVVENGdWxsWWVhcigpLnRvU3RyaW5nKCksCiAgICAgICAgTU06IGQuZ2V0VVRDTW9udGgoKSArIDEsCiAgICAgICAgTU1NOiBtW2QuZ2V0VVRDTW9udGgoKV0sCiAgICAgICAgREQ6IGQuZ2V0VVRDRGF0ZSgpLAogICAgICAgIGhoOiBkLmdldFVUQ0hvdXJzKCksCiAgICAgICAgbW06IGQuZ2V0VVRDTWludXRlcygpLAogICAgICAgIHNzOiBkLmdldFVUQ1NlY29uZHMoKSwKICAgICAgICBoMjogZC5nZXRVVENIb3VycygpICUgMTIsCiAgICAgICAgYXA6IGQuZ2V0VVRDSG91cnMoKSA8IDEyID8gJ0FNJyA6ICdQTScKICAgICAgfTsKICAgICAgcmV0dXJuIG8ucmVwbGFjZSgvKFlZKFlZKT98TU1NP3xERHxoaHxtbXxzc3xoMnxhcCkvZywgbiA9PiAoJzAnICsgdltuXSkuc3Vic3RyKC1uLmxlbmd0aCkpOwogICAgfSwKICAgIGRvd25sb2FkZXI6IChmdW5jdGlvbiAoKSB7CiAgICAgIGxldCB0YXNrcyA9IFtdLCB0aHJlYWQgPSAwLCBtYXhfdGhyZWFkID0gMiwgcmV0cnkgPSAwLCBtYXhfcmV0cnkgPSAyLCBmYWlsZWQgPSAwLCBub3RpZmllciwgaGFzX2ZhaWxlZCA9IGZhbHNlOwogICAgICByZXR1cm4gewogICAgICAgIGFkZDogZnVuY3Rpb24gKHRhc2spIHsKICAgICAgICAgIHRhc2tzLnB1c2godGFzayk7CiAgICAgICAgICBpZiAodGhyZWFkIDwgbWF4X3RocmVhZCkgewogICAgICAgICAgICB0aHJlYWQgKz0gMTsKICAgICAgICAgICAgdGhpcy5uZXh0KCk7CiAgICAgICAgICB9IGVsc2UgdGhpcy51cGRhdGUoKTsKICAgICAgICB9LAogICAgICAgIG5leHQ6IGFzeW5jIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGxldCB0YXNrID0gdGFza3Muc2hpZnQoKTsKICAgICAgICAgIGF3YWl0IHRoaXMuc3RhcnQodGFzayk7CiAgICAgICAgICBpZiAodGFza3MubGVuZ3RoID4gMCAmJiB0aHJlYWQgPD0gbWF4X3RocmVhZCkgdGhpcy5uZXh0KCk7CiAgICAgICAgICBlbHNlIHRocmVhZCAtPSAxOwogICAgICAgICAgdGhpcy51cGRhdGUoKTsKICAgICAgICB9LAogICAgICAgIHN0YXJ0OiBmdW5jdGlvbiAodGFzaykgewogICAgICAgICAgdGhpcy51cGRhdGUoKTsKICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsKICAgICAgICAgICAgR01fZG93bmxvYWQoewogICAgICAgICAgICAgIHVybDogdGFzay51cmwsCiAgICAgICAgICAgICAgbmFtZTogdGFzay5uYW1lLAogICAgICAgICAgICAgIG9ubG9hZDogcmVzdWx0ID0+IHsKICAgICAgICAgICAgICAgIHRhc2sub25sb2FkKCk7CiAgICAgICAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBvbmVycm9yOiByZXN1bHQgPT4gewogICAgICAgICAgICAgICAgdGhpcy5yZXRyeSh0YXNrLCByZXN1bHQpOwogICAgICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgb250aW1lb3V0OiByZXN1bHQgPT4gewogICAgICAgICAgICAgICAgdGhpcy5yZXRyeSh0YXNrLCByZXN1bHQpOwogICAgICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIHJldHJ5OiBmdW5jdGlvbiAodGFzaywgcmVzdWx0KSB7CiAgICAgICAgICByZXRyeSArPSAxOwogICAgICAgICAgaWYgKHJldHJ5ID09IDMpIG1heF90aHJlYWQgPSAxOwogICAgICAgICAgaWYgKHRhc2sucmV0cnkgJiYgdGFzay5yZXRyeSA+PSBtYXhfcmV0cnkgfHwKICAgICAgICAgICAgICByZXN1bHQuZGV0YWlscyAmJiByZXN1bHQuZGV0YWlscy5jdXJyZW50ID09ICdVU0VSX0NBTkNFTEVEJykgewogICAgICAgICAgICB0YXNrLm9uZXJyb3IocmVzdWx0KTsKICAgICAgICAgICAgZmFpbGVkICs9IDE7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAobWF4X3RocmVhZCA9PSAxKSB0YXNrLnJldHJ5ID0gKHRhc2sucmV0cnkgfHwgMCkgKyAxOwogICAgICAgICAgICB0aGlzLmFkZCh0YXNrKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHVwZGF0ZTogZnVuY3Rpb24oKSB7CiAgICAgICAgICBpZiAoIW5vdGlmaWVyKSB7CiAgICAgICAgICAgIG5vdGlmaWVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIG5vdGlmaWVyLnRpdGxlID0gJ1R3aXR0ZXIgTWVkaWEgRG93bmxvYWRlcic7CiAgICAgICAgICAgIG5vdGlmaWVyLmNsYXNzTGlzdC5hZGQoJ3RtZC1ub3RpZmllcicpOwogICAgICAgICAgICBub3RpZmllci5pbm5lckhUTUwgPSAnPGxhYmVsPjA8L2xhYmVsPnw8bGFiZWw+MDwvbGFiZWw+JzsKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChub3RpZmllcik7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoZmFpbGVkID4gMCAmJiAhaGFzX2ZhaWxlZCkgewogICAgICAgICAgICBoYXNfZmFpbGVkID0gdHJ1ZTsKICAgICAgICAgICAgbm90aWZpZXIuaW5uZXJIVE1MICs9ICd8JzsKICAgICAgICAgICAgbGV0IGNsZWFyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTsKICAgICAgICAgICAgbm90aWZpZXIuYXBwZW5kQ2hpbGQoY2xlYXIpOwogICAgICAgICAgICBjbGVhci5vbmNsaWNrID0gKCkgPT4gewogICAgICAgICAgICAgIG5vdGlmaWVyLmlubmVySFRNTCA9ICc8bGFiZWw+MDwvbGFiZWw+fDxsYWJlbD4wPC9sYWJlbD4nOwogICAgICAgICAgICAgIGZhaWxlZCA9IDA7CiAgICAgICAgICAgICAgaGFzX2ZhaWxlZCA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgICBub3RpZmllci5maXJzdENoaWxkLmlubmVyVGV4dCA9IHRocmVhZDsKICAgICAgICAgIG5vdGlmaWVyLmZpcnN0Q2hpbGQubmV4dEVsZW1lbnRTaWJsaW5nLmlubmVyVGV4dCA9IHRhc2tzLmxlbmd0aDsKICAgICAgICAgIGlmIChmYWlsZWQgPiAwKSBub3RpZmllci5sYXN0Q2hpbGQuaW5uZXJUZXh0ID0gZmFpbGVkOwogICAgICAgICAgaWYgKHRocmVhZCA+IDAgfHwgdGFza3MubGVuZ3RoID4gMCB8fCBmYWlsZWQgPiAwKSBub3RpZmllci5jbGFzc0xpc3QuYWRkKCdydW5uaW5nJyk7CiAgICAgICAgICBlbHNlIG5vdGlmaWVyLmNsYXNzTGlzdC5yZW1vdmUoJ3J1bm5pbmcnKTsKICAgICAgICB9CiAgICAgIH07CiAgICB9KSgpLAogICAgbGFuZ3VhZ2U6IHsKICAgICAgZW46IHtkb3dubG9hZDogJ0Rvd25sb2FkJywgY29tcGxldGVkOiAnRG93bmxvYWQgQ29tcGxldGVkJywgc2V0dGluZ3M6ICdTZXR0aW5ncycsIGRpYWxvZzoge3RpdGxlOiAnRG93bmxvYWQgU2V0dGluZ3MnLCBzYXZlOiAnU2F2ZScsIHNhdmVfaGlzdG9yeTogJ1JlbWVtYmVyIGRvd25sb2FkIGhpc3RvcnknLCBjbGVhcl9oaXN0b3J5OiAnKENsZWFyKScsIGNsZWFyX2NvbmZpcm06ICdDbGVhciBkb3dubG9hZCBoaXN0b3J5PycsIHNob3dfc2Vuc2l0aXZlOiAnQWx3YXlzIHNob3cgc2Vuc2l0aXZlIGNvbnRlbnQnLCBwYXR0ZXJuOiAnRmlsZSBOYW1lIFBhdHRlcm4nfX0sCiAgICAgIGphOiB7ZG93bmxvYWQ6ICfjg4Djgqbjg7Pjg63jg7zjg4knLCBjb21wbGV0ZWQ6ICfjg4Djgqbjg7Pjg63jg7zjg4nlrozkuoYnLCBzZXR0aW5nczogJ+ioreWumicsIGRpYWxvZzoge3RpdGxlOiAn44OA44Km44Oz44Ot44O844OJ6Kit5a6aJywgc2F2ZTogJ+S/neWtmCcsIHNhdmVfaGlzdG9yeTogJ+ODgOOCpuODs+ODreODvOODieWxpeattOOCkuS/neWtmOOBmeOCiycsIGNsZWFyX2hpc3Rvcnk6ICco44Kv44Oq44KiKScsIGNsZWFyX2NvbmZpcm06ICfjg4Djgqbjg7Pjg63jg7zjg4nlsaXmrbTjgpLliYrpmaTjgZnjgovvvJ8nLCBzaG93X3NlbnNpdGl2ZTogJ+OCu+ODs+OCt+ODhuOCo+ODluOBquWGheWuueOCkuW4uOOBq+ihqOekuuOBmeOCiycsIHBhdHRlcm46ICfjg5XjgqHjgqTjg6vlkI3jg5Hjgr/jg7zjg7MnfX0sCiAgICAgIHpoOiB7ZG93bmxvYWQ6ICfkuIvovb0nLCBjb21wbGV0ZWQ6ICfkuIvovb3lrozmiJAnLCBzZXR0aW5nczogJ+iuvue9ricsIGRpYWxvZzoge3RpdGxlOiAn5LiL6L296K6+572uJywgc2F2ZTogJ+S/neWtmCcsIHNhdmVfaGlzdG9yeTogJ+S/neWtmOS4i+i9veiusOW9lScsIGNsZWFyX2hpc3Rvcnk6ICco5riF6ZmkKScsIGNsZWFyX2NvbmZpcm06ICfnoa7orqTopoHmuIXpmaTkuIvovb3orrDlvZXvvJ8nLCBzaG93X3NlbnNpdGl2ZTogJ+iHquWKqOaYvuekuuaVj+aEn+eahOWGheWuuScsIHBhdHRlcm46ICfmlofku7blkI3moLzlvI8nfX0sCiAgICAgICd6aC1IYW50Jzoge2Rvd25sb2FkOiAn5LiL6LyJJywgY29tcGxldGVkOiAn5LiL6LyJ5a6M5oiQJywgc2V0dGluZ3M6ICfoqK3nva4nLCBkaWFsb2c6IHt0aXRsZTogJ+S4i+i8ieioree9ricsIHNhdmU6ICfkv53lrZgnLCBzYXZlX2hpc3Rvcnk6ICfkv53lrZjkuIvovInoqJjpjIQnLCBjbGVhcl9oaXN0b3J5OiAnKOa4hemZpCknLCBjbGVhcl9jb25maXJtOiAn56K66KqN6KaB5riF6Zmk5LiL6LyJ6KiY6YyE77yfJywgc2hvd19zZW5zaXRpdmU6ICfoh6rli5Xpoa/npLrmlY/mhJ/nmoTlhoXlrrknLCBwYXR0ZXJuOiAn5paH5Lu25ZCN6KaP5YmHJ319CiAgICB9LAogICAgY3NzOiBgCi50bWQtZG93biB7bWFyZ2luLWxlZnQ6IDEycHg7IG9yZGVyOiA5OTt9Ci50bWQtZG93bjpob3ZlciA+IGRpdiA+IGRpdiA+IGRpdiA+IGRpdiB7Y29sb3I6IHJnYmEoMjksIDE2MSwgMjQyLCAxLjApO30KLnRtZC1kb3duOmhvdmVyID4gZGl2ID4gZGl2ID4gZGl2ID4gZGl2ID4gZGl2IHtiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI5LCAxNjEsIDI0MiwgMC4xKTt9Ci50bWQtZG93bjphY3RpdmUgPiBkaXYgPiBkaXYgPiBkaXYgPiBkaXYgPiBkaXYge2JhY2tncm91bmQtY29sb3I6IHJnYmEoMjksIDE2MSwgMjQyLCAwLjIpO30KLnRtZC1kb3duOmhvdmVyIHN2ZyB7Y29sb3I6IHJnYmEoMjksIDE2MSwgMjQyLCAxLjApO30KLnRtZC1kb3duOmhvdmVyIGRpdjpmaXJzdC1jaGlsZDpub3QoOmxhc3QtY2hpbGQpIHtiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI5LCAxNjEsIDI0MiwgMC4xKTt9Ci50bWQtZG93bjphY3RpdmUgZGl2OmZpcnN0LWNoaWxkOm5vdCg6bGFzdC1jaGlsZCkge2JhY2tncm91bmQtY29sb3I6IHJnYmEoMjksIDE2MSwgMjQyLCAwLjIpO30KLnRtZC1kb3duLnRtZC1tZWRpYSB7cG9zaXRpb246IGFic29sdXRlOyByaWdodDogMDt9Ci50bWQtZG93bi50bWQtbWVkaWEgPiBkaXYge2Rpc3BsYXk6IGZsZXg7IGJvcmRlci1yYWRpdXM6IDk5cHg7IG1hcmdpbjogMnB4O30KLnRtZC1kb3duLnRtZC1tZWRpYSA+IGRpdiA+IGRpdiB7ZGlzcGxheTogZmxleDsgbWFyZ2luOiA2cHg7IGNvbG9yOiAjZmZmO30KLnRtZC1kb3duLnRtZC1tZWRpYTpob3ZlciA+IGRpdiB7YmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNTUsMjU1LDI1NSwgMC42KTt9Ci50bWQtZG93bi50bWQtbWVkaWE6aG92ZXIgPiBkaXYgPiBkaXYge2NvbG9yOiByZ2JhKDI5LCAxNjEsIDI0MiwgMS4wKTt9Ci50bWQtZG93bi50bWQtbWVkaWE6bm90KDpob3ZlcikgPiBkaXYgPiBkaXYge2ZpbHRlcjogZHJvcC1zaGFkb3coMCAwIDFweCAjMDAwKTt9Ci50bWQtZG93biBnIHtkaXNwbGF5OiBub25lO30KLnRtZC1kb3duLmRvd25sb2FkIGcuZG93bmxvYWQsIC50bWQtZG93bi5jb21wbGV0ZWQgZy5jb21wbGV0ZWQsIC50bWQtZG93bi5sb2FkaW5nIGcubG9hZGluZywudG1kLWRvd24uZmFpbGVkIGcuZmFpbGVkIHtkaXNwbGF5OiB1bnNldDt9Ci50bWQtZG93bi5sb2FkaW5nIHN2ZyB7YW5pbWF0aW9uOiBzcGluIDFzIGxpbmVhciBpbmZpbml0ZTt9CkBrZXlmcmFtZXMgc3BpbiB7MCUge3RyYW5zZm9ybTogcm90YXRlKDBkZWcpO30gMTAwJSB7dHJhbnNmb3JtOiByb3RhdGUoMzYwZGVnKTt9fQoudG1kLWJ0biB7ZGlzcGxheTogaW5saW5lLWJsb2NrOyBiYWNrZ3JvdW5kLWNvbG9yOiAjMURBMUYyOyBjb2xvcjogI0ZGRkZGRjsgcGFkZGluZzogMCAyMHB4OyBib3JkZXItcmFkaXVzOiA5OXB4O30KLnRtZC10YWcge2Rpc3BsYXk6IGlubGluZS1ibG9jazsgYmFja2dyb3VuZC1jb2xvcjogI0ZGRkZGRjsgY29sb3I6ICMxREExRjI7IHBhZGRpbmc6IDAgMTBweDsgYm9yZGVyLXJhZGl1czogMTBweDsgYm9yZGVyOiAxcHggc29saWQgIzFEQTFGMjsgIGZvbnQtd2VpZ2h0OiBib2xkOyBtYXJnaW46IDVweDt9Ci50bWQtYnRuOmhvdmVyIHtiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI5LCAxNjEsIDI0MiwgMC45KTt9Ci50bWQtdGFnOmhvdmVyIHtiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI5LCAxNjEsIDI0MiwgMC4xKTt9Ci50bWQtbm90aWZpZXIge2Rpc3BsYXk6IG5vbmU7IHBvc2l0aW9uOiBmaXhlZDsgbGVmdDogMTZweDsgYm90dG9tOiAxNnB4OyBjb2xvcjogIzAwMDsgYmFja2dyb3VuZDogI2ZmZjsgYm9yZGVyOiAxcHggc29saWQgI2NjYzsgYm9yZGVyLXJhZGl1czogOHB4OyBwYWRkaW5nOiA0cHg7fQoudG1kLW5vdGlmaWVyLnJ1bm5pbmcge2Rpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7fQoudG1kLW5vdGlmaWVyIGxhYmVsIHtkaXNwbGF5OiBpbmxpbmUtZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgbWFyZ2luOiAwIDhweDt9Ci50bWQtbm90aWZpZXIgbGFiZWw6YmVmb3JlIHtjb250ZW50OiAiICI7IHdpZHRoOiAzMnB4OyBoZWlnaHQ6IDE2cHg7IGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDt9Ci50bWQtbm90aWZpZXIgbGFiZWw6bnRoLWNoaWxkKDEpOmJlZm9yZSB7YmFja2dyb3VuZC1pbWFnZTp1cmwoImRhdGE6aW1hZ2Uvc3ZnK3htbDtjaGFyc2V0PXV0ZjgsPHN2ZyB4bWxucz0lMjJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyUyMiB3aWR0aD0lMjIxNiUyMiBoZWlnaHQ9JTIyMTYlMjIgdmlld0JveD0lMjIwIDAgMjQgMjQlMjI+PHBhdGggZD0lMjJNMywxNCB2NSBxMCwyIDIsMiBoMTQgcTIsMCAyLC0yIHYtNSBNNywxMCBsNCw0IHExLDEgMiwwIGw0LC00IE0xMiwzIHYxMSUyMiBmaWxsPSUyMm5vbmUlMjIgc3Ryb2tlPSUyMiUyMzY2NiUyMiBzdHJva2Utd2lkdGg9JTIyMiUyMiBzdHJva2UtbGluZWNhcD0lMjJyb3VuZCUyMiAvPjwvc3ZnPiIpO30KLnRtZC1ub3RpZmllciBsYWJlbDpudGgtY2hpbGQoMik6YmVmb3JlIHtiYWNrZ3JvdW5kLWltYWdlOnVybCgiZGF0YTppbWFnZS9zdmcreG1sO2NoYXJzZXQ9dXRmOCw8c3ZnIHhtbG5zPSUyMmh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJTIyIHdpZHRoPSUyMjE2JTIyIGhlaWdodD0lMjIxNiUyMiB2aWV3Qm94PSUyMjAgMCAyNCAyNCUyMj48cGF0aCBkPSUyMk0xMiwyIGExLDEgMCAwIDEgMCwyMCBhMSwxIDAgMCAxIDAsLTIwIE0xMiw1IHY3IGg2JTIyIGZpbGw9JTIybm9uZSUyMiBzdHJva2U9JTIyJTIzOTk5JTIyIHN0cm9rZS13aWR0aD0lMjIyJTIyIHN0cm9rZS1saW5lam9pbj0lMjJyb3VuZCUyMiBzdHJva2UtbGluZWNhcD0lMjJyb3VuZCUyMiAvPjwvc3ZnPiIpO30KLnRtZC1ub3RpZmllciBsYWJlbDpudGgtY2hpbGQoMyk6YmVmb3JlIHtiYWNrZ3JvdW5kLWltYWdlOnVybCgiZGF0YTppbWFnZS9zdmcreG1sO2NoYXJzZXQ9dXRmOCw8c3ZnIHhtbG5zPSUyMmh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJTIyIHdpZHRoPSUyMjE2JTIyIGhlaWdodD0lMjIxNiUyMiB2aWV3Qm94PSUyMjAgMCAyNCAyNCUyMj48cGF0aCBkPSUyMk0xMiwwIGEyLDIgMCAwIDAgMCwyNCBhMiwyIDAgMCAwIDAsLTI0JTIyIGZpbGw9JTIyJTIzZjY2JTIyIHN0cm9rZT0lMjJub25lJTIyIC8+PHBhdGggZD0lMjJNMTQuNSw1IGExLDEgMCAwIDAgLTUsMCBsMC41LDkgYTEsMSAwIDAgMCA0LDAgeiBNMTIsMTcgYTIsMiAwIDAgMCAwLDUgYTIsMiAwIDAgMCAwLC01JTIyIGZpbGw9JTIyJTIzZmZmJTIyIHN0cm9rZT0lMjJub25lJTIyIC8+PC9zdmc+Iik7fQoudG1kLWRvd24udG1kLWltZyB7cG9zaXRpb246IGFic29sdXRlOyByaWdodDogMDsgYm90dG9tOiAwOyBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7fQoudG1kLWRvd24udG1kLWltZyA+IGRpdiB7ZGlzcGxheTogZmxleDsgYm9yZGVyLXJhZGl1czogOTlweDsgbWFyZ2luOiAycHg7IGJhY2tncm91bmQtY29sb3I6IHJnYmEoMjU1LDI1NSwyNTUsIDAuNik7fQoudG1kLWRvd24udG1kLWltZyA+IGRpdiA+IGRpdiB7ZGlzcGxheTogZmxleDsgbWFyZ2luOiA2cHg7IGNvbG9yOiAjZmZmICFpbXBvcnRhbnQ7fQoudG1kLWRvd24udG1kLWltZzpub3QoOmhvdmVyKSA+IGRpdiA+IGRpdiB7ZmlsdGVyOiBkcm9wLXNoYWRvdygwIDAgMXB4ICMwMDApO30KLnRtZC1kb3duLnRtZC1pbWc6aG92ZXIgPiBkaXYgPiBkaXYge2NvbG9yOiByZ2JhKDI5LCAxNjEsIDI0MiwgMS4wKTt9Cjpob3ZlciA+IC50bWQtZG93bi50bWQtaW1nLCAudG1kLWltZy5sb2FkaW5nLCAudG1kLWltZy5jb21wbGV0ZWQsIC50bWQtaW1nLmZhaWxlZCB7ZGlzcGxheTogYmxvY2sgIWltcG9ydGFudDt9Ci50d2VldC1kZXRhaWwtYWN0aW9uLWl0ZW0ge3dpZHRoOiAyMCUgIWltcG9ydGFudDt9CmAsCiAgICBjc3Nfc3M6IGAKLyogc2hvdyBzZW5zaXRpdmUgaW4gbWVkaWEgdGFiICovCmxpW3JvbGU9Imxpc3RpdGVtIl0+ZGl2PmRpdj5kaXY+ZGl2Om5vdCg6bGFzdC1jaGlsZCkge2ZpbHRlcjogbm9uZTt9CmxpW3JvbGU9Imxpc3RpdGVtIl0+ZGl2PmRpdj5kaXY+ZGl2K2RpdjpsYXN0LWNoaWxkIHtkaXNwbGF5OiBub25lO30KYCwKICAgIHN2ZzogYAo8ZyBjbGFzcz0iZG93bmxvYWQiPjxwYXRoIGQ9Ik0zLDE0IHY1IHEwLDIgMiwyIGgxNCBxMiwwIDIsLTIgdi01IE03LDEwIGw0LDQgcTEsMSAyLDAgbDQsLTQgTTEyLDMgdjExIiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIC8+PC9nPgo8ZyBjbGFzcz0iY29tcGxldGVkIj48cGF0aCBkPSJNMywxNCB2NSBxMCwyIDIsMiBoMTQgcTIsMCAyLC0yIHYtNSBNNywxMCBsMyw0IHExLDEgMiwwIGw4LC0xMSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMURBMUYyIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgLz48L2c+CjxnIGNsYXNzPSJsb2FkaW5nIj48Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMURBMUYyIiBzdHJva2Utd2lkdGg9IjQiIG9wYWNpdHk9IjAuNCIgLz48cGF0aCBkPSJNMTIsMiBhMTAsMTAgMCAwIDEgMTAsMTAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzFEQTFGMiIgc3Ryb2tlLXdpZHRoPSI0IiBzdHJva2UtbGluZWNhcD0icm91bmQiIC8+PC9nPgo8ZyBjbGFzcz0iZmFpbGVkIj48Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMSIgZmlsbD0iI2YzMyIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS13aWR0aD0iMiIgb3BhY2l0eT0iMC44IiAvPjxwYXRoIGQ9Ik0xNCw1IGExLDEgMCAwIDAgLTQsMCBsMC41LDkuNSBhMS41LDEuNSAwIDAgMCAzLDAgeiBNMTIsMTcgYTIsMiAwIDAgMCAwLDQgYTIsMiAwIDAgMCAwLC00IiBmaWxsPSIjZmZmIiBzdHJva2U9Im5vbmUiIC8+PC9nPgpgCiAgfTsKfSkoKTsKClRNRC5pbml0KCk7Cg=="},{"name":"Download Weibo Images & Videos (Only support new version weibo UI)","options":{"check_for_updates":true,"user_modified":null,"comment":null,"compatopts_for_requires":true,"compat_wrappedjsobject":false,"compat_metadata":false,"compat_foreach":false,"compat_powerful_this":null,"sandbox":null,"noframes":null,"unwrap":null,"run_at":null,"tab_types":null,"override":{"use_includes":[],"orig_includes":[],"merge_includes":true,"use_matches":[],"orig_matches":["https://weibo.com/*","https://www.weibo.com/*","https://s.weibo.com/weibo*","https://s.weibo.com/realtime*","https://s.weibo.com/video*"],"merge_matches":true,"use_excludes":[],"orig_excludes":["https://weibo.com/tv/*","https://www.weibo.com/tv/*","https://weibo.com/p/*","https://www.weibo.com/p/*"],"merge_excludes":true,"use_connects":[],"orig_connects":["weibo.com","www.weibo.com","sinaimg.cn","weibocdn.com","localhost"],"merge_connects":true,"use_blockers":[],"orig_run_at":"document-end","orig_noframes":null,"orig_run_in":[]},"run_in":null,"tags":[]},"storage":{"ts":1732106100794,"data":{"dlFileName":"s{original}.{ext}","retweetMode":"bfalse","retweetFileName":"s{original}.{ext}","zipMode":"bfalse","packFileName":"s{mblogid}.zip","retweetPackFileName":"s{mblogid}.zip","ariaMode":"bfalse","ariaRpcUrl":"shttp://localhost:6800/jsonrpc","isSet":"n1","dlVidCov":"btrue","rmWtrMrk":"btrue"}},"enabled":false,"position":4,"file_url":"https://update.greasyfork.org/scripts/430877/Download%20Weibo%20Images%20%20Videos%20%28Only%20support%20new%20version%20weibo%20UI%29.user.js","uuid":"d6f63deb-f084-4fec-be99-6efaaea4f371","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBEb3dubG9hZCBXZWlibyBJbWFnZXMgJiBWaWRlb3MgKE9ubHkgc3VwcG9ydCBuZXcgdmVyc2lvbiB3ZWlibyBVSSkKLy8gQG5hbWU6emgtQ04gICDkuIvovb3lvq7ljZrlm77niYflkozop4bpopHvvIjku4XmlK/mjIHmlrDniYjnlYzpnaLvvIkKLy8gQHZlcnNpb24gICAgICAxLjMuMgovLyBAZGVzY3JpcHRpb24gIERvd25sb2FkIGltYWdlcyBhbmQgdmlkZW9zIGZyb20gbmV3IHZlcnNpb24gd2VpYm8gVUkgd2VicGFnZS4KLy8gQGRlc2NyaXB0aW9uOnpoLUNOIOS7juaWsOeJiOW+ruWNmueVjOmdouS4i+i9veWbvueJh+WSjOinhumikeOAggovLyBAYXV0aG9yICAgICAgIE9XRU5EU1dBTkcKLy8gQG1hdGNoICAgICAgICBodHRwczovL3dlaWJvLmNvbS8qCi8vIEBtYXRjaCAgICAgICAgaHR0cHM6Ly93d3cud2VpYm8uY29tLyoKLy8gQG1hdGNoICAgICAgICBodHRwczovL3Mud2VpYm8uY29tL3dlaWJvKgovLyBAbWF0Y2ggICAgICAgIGh0dHBzOi8vcy53ZWliby5jb20vcmVhbHRpbWUqCi8vIEBtYXRjaCAgICAgICAgaHR0cHM6Ly9zLndlaWJvLmNvbS92aWRlbyoKLy8gQGV4Y2x1ZGUgICAgICBodHRwczovL3dlaWJvLmNvbS90di8qCi8vIEBleGNsdWRlICAgICAgaHR0cHM6Ly93d3cud2VpYm8uY29tL3R2LyoKLy8gQGV4Y2x1ZGUgICAgICBodHRwczovL3dlaWJvLmNvbS9wLyoKLy8gQGV4Y2x1ZGUgICAgICBodHRwczovL3d3dy53ZWliby5jb20vcC8qCi8vIEBpY29uICAgICAgICAgaHR0cHM6Ly93ZWliby5jb20vZmF2aWNvbi5pY28KLy8gQGxpY2Vuc2UgICAgICBNSVQKLy8gQGhvbWVwYWdlICAgICBodHRwczovL2dyZWFzeWZvcmsub3JnL3NjcmlwdHMvNDMwODc3Ci8vIEBzdXBwb3J0VVJMICAgaHR0cHM6Ly9naXRodWIuY29tL293ZW5kc3dhbmcvRG93bmxvYWQtV2VpYm8tSW1hZ2VzLVZpZGVvcwovLyBAZ3JhbnQgICAgICAgIEdNX3htbGh0dHBSZXF1ZXN0Ci8vIEBncmFudCAgICAgICAgR01fbm90aWZpY2F0aW9uCi8vIEBncmFudCAgICAgICAgR01fZ2V0VmFsdWUKLy8gQGdyYW50ICAgICAgICBHTV9zZXRWYWx1ZQovLyBAZ3JhbnQgICAgICAgIEdNX3JlZ2lzdGVyTWVudUNvbW1hbmQKLy8gQGNvbm5lY3QgICAgICB3ZWliby5jb20KLy8gQGNvbm5lY3QgICAgICB3d3cud2VpYm8uY29tCi8vIEBjb25uZWN0ICAgICAgc2luYWltZy5jbgovLyBAY29ubmVjdCAgICAgIHdlaWJvY2RuLmNvbQovLyBAY29ubmVjdCAgICAgIGxvY2FsaG9zdAovLyBAbmFtZXNwYWNlICAgIGh0dHA6Ly90YW1wZXJtb25rZXkubmV0LwovLyBAcnVuLWF0ICAgICAgIGRvY3VtZW50LWVuZAovLyBAcmVxdWlyZSAgICAgIGh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2pzemlwLzMuOS4xL2pzemlwLm1pbi5qcwovLyBAZG93bmxvYWRVUkwgaHR0cHM6Ly91cGRhdGUuZ3JlYXN5Zm9yay5vcmcvc2NyaXB0cy80MzA4NzcvRG93bmxvYWQlMjBXZWlibyUyMEltYWdlcyUyMCUyMFZpZGVvcyUyMCUyOE9ubHklMjBzdXBwb3J0JTIwbmV3JTIwdmVyc2lvbiUyMHdlaWJvJTIwVUklMjkudXNlci5qcwovLyBAdXBkYXRlVVJMIGh0dHBzOi8vdXBkYXRlLmdyZWFzeWZvcmsub3JnL3NjcmlwdHMvNDMwODc3L0Rvd25sb2FkJTIwV2VpYm8lMjBJbWFnZXMlMjAlMjBWaWRlb3MlMjAlMjhPbmx5JTIwc3VwcG9ydCUyMG5ldyUyMHZlcnNpb24lMjB3ZWlibyUyMFVJJTI5Lm1ldGEuanMKLy8gPT0vVXNlclNjcmlwdD09CgooZnVuY3Rpb24oKSB7CiAgICAndXNlIHN0cmljdCc7CgogICAgY29uc3Qgc2V0dGluZ1ZlcnNpb24gPSAxOwoKICAgIGxldCB0ZXh0ID0gW107CiAgICBsZXQgdGV4dF96aCA9IFsKLyowKi8gICAn5re75Yqg5LiL6L295oyJ6ZKuJywKLyoxKi8gICAn5qyi6L+O5L2/55So4oCc5LiL6L295b6u5Y2a5Zu+54mH4oCd6ISa5pysJywKLyoyKi8gICAn6K+36YCJ5oup5re75Yqg5LiL6L295oyJ6ZKu55qE5pa55byP77yaJywKLyozKi8gICAn54K55Ye74oCc5re75Yqg5LiL6L295oyJ6ZKu4oCd5p2l5re75Yqg5LiL6L295oyJ6ZKu44CCJywKLyo0Ki8gICAn5b2T6byg5qCH5L2N5LqO5rWP6KeI5Zmo6aG16Z2i5pe25re75Yqg5LiL6L295oyJ6ZKu77yM5L2G6L+Z56eN5pa55byP5Lya5Y2g55So5b6I5aSaQ1BV6LWE5rqQ44CCJywKLyo1Ki8gICAn56Gu5a6aJywKLyo2Ki8gICAn5LiL6L296K6+572uJywKLyo3Ki8gICAn5LiL6L295paH5Lu25ZCN56ewJywKLyo4Ki8gICAne29yaWdpbmFsfSAtIOWOn+aWh+S7tuWQjVxue3VzZXJuYW1lfSAtIOWOn+WNmuS4u+WQjeensFxue3VzZXJpZH0gLSDljp/ljZrkuLtJRFxue21ibG9naWR9IC0g5Y6f5Y2abWJsb2dpZFxue3VpZH0gLSDljp/ljZp1aWRcbntleHR9IC0g5paH5Lu25ZCO57yAXG57aW5kZXh9IC0g5Zu+54mH5bqP5Y+3XG57WVlZWX0ge01NfSB7RER9IHtISH0ge21tfSB7c3N9IC0g5Y6f5Y2a5Y+R5biD5pe2XG7pl7TnmoTlubTku73jgIHmnIjku73jgIHml6XmnJ/jgIHlsI/ml7bjgIHliIbpkp/jgIHnp5LvvIzlj69cbuWIhuW8gOeLrOeri+S9v+eUqFxue2NvbnRlbnR9IC0g5Y2a5paH5YaF5a6577yI5pyA5aSa5YmNMjXkuKrlrZfnrKbvvIknLAovKjkqLyAgICfkuIvovb3pmJ/liJcnLAovKjEwKi8gICfph43or5UnLAovKjExKi8gICflhbPpl60nLAovKjEyKi8gICflj5bmtognLAovKjEzKi8gICfmiZPljIXkuIvovb0nLAovKjE0Ki8gICfmiZPljIXmlofku7blkI0nLAovKjE1Ki8gICfkuI7igJzkuIvovb3mlofku7blkI3np7DigJ3op4TliJnnm7jlkIzvvIzkvYZ7b3JpZ2luYWx944CBe2V4dH3jgIF7aW5kZXh96Zmk5aSWJywKLyoxNiovICAn5Y2V54us6K6+572u6L2s5Y+R5b6u5Y2a5LiL6L295paH5Lu25ZCN56ewJywKLyoxNyovICAn6L2s5Y+R5b6u5Y2a5LiL6L295paH5Lu25ZCN56ewJywKLyoxOCovICAn6Zmk4oCc5LiL6L295paH5Lu25ZCN4oCd6KeE5YiZ5aSW77yM6aKd5aSW5qCH562+5aaC5LiL77yaXG57cmUubWJsb2dpZH0gLSDovazljZptYmxvZ2lkXG57cmUudXNlcm5hbWV9IC0g6L2s5Y+R5Y2a5Li75ZCN56ewXG57cmUudXNlcmlkfSAtIOi9rOWPkeWNmuS4u0lEXG57cmUudWlkfSAtIOi9rOWNmnVpZFxue3JlLmNvbnRlbnR9IC0g6L2s5Y+R5Y2a5paH5YaF5a6577yI5pyA5aSa5YmNMjXkuKrlrZfnrKbvvIlcbntyZS5ZWVlZfSB7cmUuTU19IHtyZS5ERH0ge3JlLkhIfSB7cmUubW19IHtyZS5zc31cbiAtIOWOn+WNmuWPkeW4g+aXtumXtOeahOW5tOS7veOAgeaciOS7veOAgeaXpeacn+OAgeWwj+aXtuOAgVxu5YiG6ZKf44CB56eS77yM5Y+v5YiG5byA54us56uL5L2/55SoJywKLyoxOSovICAn6L2s5Y+R5b6u5Y2a5omT5YyF5paH5Lu25ZCNJywKLyoyMCovICAn5LiO4oCc6L2s5Y+R5b6u5Y2a5LiL6L295paH5Lu25ZCN56ew4oCd6KeE5YiZ55u45ZCM77yM5L2Ge29yaWdpbmFsfeOAgXtleHR944CBe2luZGV4femZpOWklicsCi8qMjEqLyAgJ+S9v+eUqEFyaWEyY+i/nOeoi+S4i+i9vScsCi8qMjIqLyAgJ1JQQ+aOpeWPo+WcsOWdgCcsCi8qMjMqLyAgJ+S9v+eUqOatpOaWueW8j+S4i+i9ve+8jOaXoOazleS9v+eUqOaJk+WMheWKn+iDve+8jOaXoOazleWcqOmhtemdouWPs+S4i+inkuaYvuekuuS4i+i9vei/m+W6puWSjOe7k+aenOOAgicsCi8qMjQqLyAgJ+WmguaenOaOpeWPo+WcsOWdgOS4jeaYr2xvY2FsaG9zdO+8jOmcgOaJi+WKqOWwhuWcsOWdgOa3u+WKoOWIsFhIUueZveWQjeWNleOAgicsCi8qMjUqLyAgJ+iuvue9ricsCi8qMjYqLyAgJzxiPuazqOaEjzwvYj7vvJonLAovKjI3Ki8gICflkK/nlKjigJzmiZPljIXkuIvovb3igJ3ml7bvvIzpnIDljLrliIblpJrmlofku7blkI3np7DvvIxcbumBv+WFjemHjeWkjeiAjOWvvOiHtOaJk+WMheWQjuWPquacieS4gOS4quaWh+S7tu+8jOaWh+S7tuWRvVxu5ZCN5pe277yM5b+F6aG75YyF5ZCre29yaWdpbmFsfeOAgXtpbmRleH3kuK3oh7PlsJHkuIDkuKpcbuagh+etvuOAgicsCi8qMjgqLyAgJ+S4i+i9veinhumikeWwgemdoicsCi8qMjkqLyAgJ+S4i+i9veaXoOawtOWNsOWbvueJhycsCi8qMzAqLyAgJ+WbvueJh+i0qOmHj+S8muS4i+mZjScsCiAgICBdOwogICAgbGV0IHRleHRfZW4gPSBbCi8qMCovICAgJ0FkZCBEb3dubG9hZCBCdXR0b25zJywKLyoxKi8gICAnV2VsY29tZSBVc2luZyBcJ0Rvd25sb2FkIFdlaWJvIEltYWdlc1wnIFNjcmlwdCcsCi8qMiovICAgJ1doaWNoIHdheSBkbyB5b3UgbGlrZSB0byBhZGQgZG93bmxvYWQgYnV0dG9ucyB0byBlYWNoIHdlaWJvIHBvc3Q/JywKLyozKi8gICAnQ2xpY2sgXCdBZGQgRG93bmxvYWQgQnV0dG9uc1wnIGJ1dHRvbiB0byBhZGQgZG93bmxvYWQgYnV0dG9ucy4nLAovKjQqLyAgICdXaGVuIG1vdXNlIG92ZXIgYnJvd3NlciBwYWdlLCBhZGQgZG93bmxvYWQgYnV0dG9ucyBhdXRvbWF0aWNhbGx5LiBCdXQgaXQgdGFrZXMgYSBsb3Qgb2YgQ1BVIHVzYWdlLicsCi8qNSovICAgJ09LJywKLyo2Ki8gICAnRG93bmxvYWQgU2V0dGluZycsCi8qNyovICAgJ0Rvd25sb2FkIEZpbGUgTmFtZScsCi8qOCovICAgJ3tvcmlnaW5hbH0gLSBPcmlnaW5hbCBmaWxlIG5hbWVcbnt1c2VybmFtZX0gLSBPcmlnaW5hbCB1c2VyIG5hbWVcbnt1c2VyaWR9IC0gT3JpZ2luYWwgdXNlciBJRFxue21ibG9naWR9IC0gT3JpZ2luYWwgbWJsb2dpZFxue3VpZH0gLSBPcmlnaW5hbCB1aWRcbntleHR9IC0gRmlsZSBleHRlbnRpb25cbntpbmRleH0gLSBJbWFnZSBpbmRleFxue1lZWVl9IHtNTX0ge0REfSB7SEh9IHttbX0ge3NzfSAtICJZZWFyIiwgXG4iTW9udGgiLCAiRGF0ZSIsICJIb3VyIiwgIk1pbnV0ZSIsICJTZWNvbmQiIFxub2YgdGhlIGNyZWF0ZWQgdGltZSBvZiB0aGUgb3JpZ2luYWwgcG9zdFxue2NvbnRlbnR9IC0gT3JpZ2luYWwgcG9zdCBjb250ZW50IChsaW1pdGVkIHRvIFxuZmlyc3QgMjUgY2hhcmFjdGVycyknLAovKjkqLyAgICdEb3dubG9hZCBRdWV1ZScsCi8qMTAqLyAgJ1JldHJ5JywKLyoxMSovICAnQ2xvc2UnLAovKjEyKi8gICdDYW5jZWwnLAovKjEzKi8gICdQYWNrIGRvd25sb2FkIGZpbGVzIGFzIGEgWklQIGZpbGUnLAovKjE0Ki8gICdaSVAgRmlsZSBOYW1lJywKLyoxNSovICAnVGhlIHNhbWUgcnVsZXMgYXMgIkRvd25sb2FkIEZpbGUgTmFtZSIgZXhjZXB0IHtvcmlnaW5hbH0sIHtleHR9IGFuZCB7aW5kZXh9JywKLyoxNiovICAnRGlmZmVyZW50IEZpbGUgTmFtZSBmb3IgUmV0d2VldHMnLAovKjE3Ki8gICdSZXR3ZWV0IERvd25sb2FkIEZpbGUgTmFtZScsCi8qMTgqLyAgJ0V4Y2VwdCB0aGUgcnVsZXMgZm9yICJEb3dubG9hZCBGaWxlIE5hbWUiLCB0aGVyZSBhcmUgYWRkaXRpb25hbCB0YWdzIGFzIGJlbG93Llxue3JlLm1ibG9naWR9IC0gUmV0d2VldCBtYmxvZ2lkXG57cmUudXNlcm5hbWV9IC0gUmV0d2VldCB1c2VyIG5hbWVcbntyZS51c2VyaWR9IC0gUmV0d2VldCB1c2VyIElEXG57cmUudWlkfSAtIFJldHdlZXQgdWlkXG57cmUuY29udGVudH0gLSBSZXR3ZWV0IHBvc3QgY29udGVudCAobGltaXRlZCB0byBmaXJzdCAyNSBjaGFyYWN0ZXJzKVxue3JlLllZWVl9IHtyZS5NTX0ge3JlLkREfSB7cmUuSEh9IHtyZS5tbX0ge3JlLnNzfSAtICJZZWFyIiwgIk1vbnRoIiwgIkRhdGUiLCAiSG91ciIsICJNaW51dGUiLCAiU2Vjb25kIiBvZiB0aGUgY3JlYXRlZCB0aW1lIG9mIHRoZSByZXR3ZWV0IHBvc3QnLAovKjE5Ki8gICdSZXR3ZWV0IFppcCBGaWxlIE5hbWUnLAovKjIwKi8gICdUaGUgc2FtZSBydWxlcyBhcyAiUmV0d2VldCBEb3dubG9hZCBGaWxlIE5hbWUiIGV4Y2VwdCB7b3JpZ2luYWx9LCB7ZXh0fSBhbmQge2luZGV4fScsCi8qMjEqLyAgJ1VzZSBBcmlhMmMgcmVtb3RlIGRvd25sb2FkIEFQSScsCi8qMjIqLyAgJ1JQQyBVcmwnLAovKjIzKi8gICdJbiB0aGlzIG1vZGUsIFlvdSB3b3VsZCBub3QgYmUgYWJsZSB0byBkb3dubG9hZCBpbiBaSVAgbW9kZSBhbmQgdG8gb2JzZXJ2ZSBkb3dubG9hZCBwcm9ncmVzcyBhbmQgcmVzdWx0LicsCi8qMjQqLyAgJ0lmIGl0XCdzIG5vdCBcJ2xvY2FsaG9zdFwnLCB5b3Ugd291bGQgaGF2ZSB0byBhZGQgaXQgdG8gXCdYSFIgd2hpdGUgbGlzdFwnLicsCi8qMjUqLyAgJ1NldHRpbmdzJywKLyoyNiovICAnPGI+QXR0ZW50aW9uPC9iPjogJywKLyoyNyovICAnV2hlbiBcJ1pJUCBtb2RlXCcgZW5hYmxlZCwgeW91IGhhdmUgXG50byBpbmNsdWRlIG9uZSBvZiB0aGUgdGFncyB7b3JpZ2luYWx9IG9yIHtpbmRleH0gXG50byBhdm9pZCBkdXBsaWNhdGVkIG9uZXMgYmVpbmcgb3ZlcndyaXR0ZW4uJywKLyoyOCovICAnRG93bmxvYWQgdmlkZW8gY292ZXIgaW1hZ2UnLAovKjI5Ki8gICdEb3dubG9hZCBJbWFnZXMgd2l0aG91dCB3YXRlcm1hcmtzJywKLyoyOSovICAnSW1hZ2UgcXVhbGl0eSBpcyBsb3dlciB0aGFuIHRob3NlIFxud2l0aCB3YXRlcm1hcmtzJywKICAgIF07CiAgICBpZihuYXZpZ2F0b3IubGFuZ3VhZ2Uuc3Vic3RyKDAsIDIpID09ICd6aCcpIHsKICAgICAgICB0ZXh0ID0gdGV4dF96aDsKICAgIH0gZWxzZSB7CiAgICAgICAgdGV4dCA9IHRleHRfZW47CiAgICB9CgogICAgbGV0IGRvd25sb2FkUXVldWVDYXJkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICBkb3dubG9hZFF1ZXVlQ2FyZC5zdHlsZS5wb3NpdGlvbiA9ICdmaXhlZCc7CiAgICBkb3dubG9hZFF1ZXVlQ2FyZC5zdHlsZS5ib3R0b20gPSAnMC41cmVtJzsKICAgIGRvd25sb2FkUXVldWVDYXJkLnN0eWxlLmxlZnQgPSAnMC41cmVtJzsKICAgIGRvd25sb2FkUXVldWVDYXJkLnN0eWxlLm1heEhlaWdodCA9ICc1MHZoJzsKICAgIGRvd25sb2FkUXVldWVDYXJkLnN0eWxlLm92ZXJmbG93WSA9ICdhdXRvJzsKICAgIGRvd25sb2FkUXVldWVDYXJkLnN0eWxlLm92ZXJmbG93WCA9ICdoaWRkZW4nOwogICAgbGV0IGRvd25sb2FkUXVldWVUaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgZG93bmxvYWRRdWV1ZVRpdGxlLnRleHRDb250ZW50ID0gdGV4dFs5XTsKICAgIGRvd25sb2FkUXVldWVUaXRsZS5zdHlsZS5mb250U2l6ZSA9ICcwLjhyZW0nOwogICAgZG93bmxvYWRRdWV1ZVRpdGxlLnN0eWxlLmNvbG9yID0gJ2dyYXknOwogICAgZG93bmxvYWRRdWV1ZVRpdGxlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICBkb3dubG9hZFF1ZXVlQ2FyZC5hcHBlbmRDaGlsZChkb3dubG9hZFF1ZXVlVGl0bGUpOwogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChkb3dubG9hZFF1ZXVlQ2FyZCk7CiAgICBsZXQgcHJvZ3Jlc3NCYXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgIHByb2dyZXNzQmFyLnN0eWxlLmhlaWdodCA9ICcxLjRyZW0nOwogICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSAnMjNyZW0nOwogICAgLy8gcHJvZ3Jlc3NCYXIuc3R5bGUuYmFja2dyb3VuZCA9ICdsaW5lYXItZ3JhZGllbnQodG8gcmlnaHQsIHJlZCAxMDAlLCB0cmFuc3BhcmVudCAxMDAlKSc7CiAgICBwcm9ncmVzc0Jhci5zdHlsZS5ib3JkZXJTdHlsZSA9ICdzb2xpZCc7CiAgICBwcm9ncmVzc0Jhci5zdHlsZS5ib3JkZXJXaWR0aCA9ICcwLjFyZW0nOwogICAgcHJvZ3Jlc3NCYXIuc3R5bGUuYm9yZGVyQ29sb3IgPSAnZ3JleSc7CiAgICBwcm9ncmVzc0Jhci5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnMC41cmVtJzsKICAgIHByb2dyZXNzQmFyLnN0eWxlLmJveFNpemluZyA9ICdjb250ZW50LWJveCc7CiAgICBwcm9ncmVzc0Jhci5zdHlsZS5tYXJnaW5Ub3AgPSAnMC41cmVtJzsKICAgIHByb2dyZXNzQmFyLnN0eWxlLm1hcmdpblJpZ2h0ID0gJzFyZW0nOwogICAgcHJvZ3Jlc3NCYXIuc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnOwogICAgbGV0IHByb2dyZXNzVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgLy8gcHJvZ3Jlc3NUZXh0LnRleHRDb250ZW50ID0gJ3Rlc3QudGVzdCc7CiAgICBwcm9ncmVzc1RleHQuc3R5bGUubWl4QmxlbmRNb2RlID0gJ3NjcmVlbic7CiAgICBwcm9ncmVzc1RleHQuc3R5bGUud2lkdGggPSAnMTAwJSc7CiAgICBwcm9ncmVzc1RleHQuc3R5bGUudGV4dEFsaWduID0gJ2NlbnRlcic7CiAgICBwcm9ncmVzc1RleHQuc3R5bGUuY29sb3IgPSAnb3JhbmdlJzsKICAgIHByb2dyZXNzVGV4dC5zdHlsZS5mb250U2l6ZSA9ICcwLjdyZW0nOwogICAgcHJvZ3Jlc3NUZXh0LnN0eWxlLmxpbmVIZWlnaHQgPSAnMS40cmVtJzsKICAgIHByb2dyZXNzVGV4dC5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nOwogICAgcHJvZ3Jlc3NCYXIuYXBwZW5kQ2hpbGQocHJvZ3Jlc3NUZXh0KTsKICAgIGxldCBwcm9ncmVzc0Nsb3NlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICBwcm9ncmVzc0Nsb3NlQnRuLnN0eWxlLmJvcmRlciA9ICd1bnNldCc7CiAgICBwcm9ncmVzc0Nsb3NlQnRuLnN0eWxlLmJhY2tncm91bmQgPSAndW5zZXQnOwogICAgcHJvZ3Jlc3NDbG9zZUJ0bi5zdHlsZS5jb2xvciA9ICdvcmFuZ2UnOwogICAgcHJvZ3Jlc3NDbG9zZUJ0bi5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7CiAgICBwcm9ncmVzc0Nsb3NlQnRuLnN0eWxlLnJpZ2h0ID0gJzAnOwogICAgcHJvZ3Jlc3NDbG9zZUJ0bi5zdHlsZS50b3AgPSAnMC4xcmVtJzsKICAgIHByb2dyZXNzQ2xvc2VCdG4uc3R5bGUuZm9udFNpemUgPSAnMXJlbSc7CiAgICBwcm9ncmVzc0Nsb3NlQnRuLnN0eWxlLmxpbmVIZWlnaHQgPSAnMXJlbSc7CiAgICBwcm9ncmVzc0Nsb3NlQnRuLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJzsKICAgIHByb2dyZXNzQ2xvc2VCdG4udGV4dENvbnRlbnQgPSAnw5cnOwogICAgcHJvZ3Jlc3NDbG9zZUJ0bi50aXRsZSA9IHRleHRbMTJdOwogICAgcHJvZ3Jlc3NDbG9zZUJ0bi5vbm1vdXNlb3ZlciA9IGZ1bmN0aW9uKGUpewogICAgICAgIHRoaXMuc3R5bGUuY29sb3IgPSAncmVkJzsKICAgIH0KICAgIHByb2dyZXNzQ2xvc2VCdG4ub25tb3VzZW91dCA9IGZ1bmN0aW9uKGUpewogICAgICAgIHRoaXMuc3R5bGUuY29sb3IgPSAnb3JhbmdlJzsKICAgIH0KICAgIHByb2dyZXNzQmFyLmFwcGVuZENoaWxkKHByb2dyZXNzQ2xvc2VCdG4pOwogICAgLy8gZG93bmxvYWRRdWV1ZUNhcmQuYXBwZW5kQ2hpbGQocHJvZ3Jlc3NCYXIpOwoKICAgIGZ1bmN0aW9uIHNhdmVBcyhibG9iLCBuYW1lKSB7CiAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTsKICAgICAgICBsaW5rLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgbGluay5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsKICAgICAgICBsaW5rLmRvd25sb2FkID0gbmFtZTsKICAgICAgICBsaW5rLnRhcmdldCA9ICdfYmxhbmsnOwogICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGluayk7CiAgICAgICAgbGluay5jbGljaygpOwogICAgICAgIGNvbnN0IHRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTChsaW5rLmhyZWYpOwogICAgICAgICAgICBsaW5rLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobGluayk7CiAgICAgICAgfSwgMTAwMCk7CiAgICB9CgogICAgZnVuY3Rpb24gc2VuZDJBcmlhMmModXJsLCBmaWxlTmFtZSwgaGVhZGVyRmxhZykgewogICAgICAgIC8vIGNvbnNvbGUubG9nKGRvd25sb2FkVXJsKTsKICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgIGxldCBoZWFkZXIgPSBbICdVc2VyLUFnZW50OiAnICsgd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQgXTsKICAgICAgICAgICAgaWYgKGhlYWRlckZsYWcpIHsKICAgICAgICAgICAgICAgIGhlYWRlci5wdXNoKCdSZWZlcmVyOiBodHRwczovLycgKyBsb2NhdGlvbi5ob3N0KTsKICAgICAgICAgICAgICAgIGhlYWRlci5wdXNoKCdPcmlnaW46IGh0dHBzOi8vJyArIGxvY2F0aW9uLmhvc3QpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGRvd25sb2FkUXVldWVUaXRsZS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgbGV0IHByb2dyZXNzID0gZG93bmxvYWRRdWV1ZUNhcmQuYXBwZW5kQ2hpbGQocHJvZ3Jlc3NCYXIuY2xvbmVOb2RlKHRydWUpKTsKICAgICAgICAgICAgcHJvZ3Jlc3MuZmlyc3RDaGlsZC50ZXh0Q29udGVudCA9IGZpbGVOYW1lOwogICAgICAgICAgICBHTV94bWxodHRwUmVxdWVzdCh7CiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgICAgICAgICAgIHVybDogR01fZ2V0VmFsdWUoJ2FyaWFScGNVcmwnLCdodHRwOi8vbG9jYWxob3N0OjY4MDAvanNvbnJwYycpLAogICAgICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgICAgIGpzb25ycGM6ICcyLjAnLAogICAgICAgICAgICAgICAgICAgIGlkOiAnd2VpYm8nLAogICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2FyaWEyLmFkZFVyaScsCiAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiBbIFsgdXJsIF0sIHsgaGVhZGVyLCBvdXQ6IGZpbGVOYW1lIH0gXSwKICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgaGVhZGVyczogeyJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiJ9LAogICAgICAgICAgICAgICAgb25sb2FkOiBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlc3BvbnNlLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3Muc3R5bGUuYmFja2dyb3VuZCA9ICdncmVlbic7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBwcm9ncmVzcy5yZW1vdmUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoZG93bmxvYWRRdWV1ZUNhcmQuY2hpbGRFbGVtZW50Q291bnQgPT0gMSkgZG93bmxvYWRRdWV1ZVRpdGxlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MubGFzdENoaWxkLm9uY2xpY2sgPSBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgICAgICBpZihkb3dubG9hZFF1ZXVlQ2FyZC5jaGlsZEVsZW1lbnRDb3VudCA9PSAxKSBkb3dubG9hZFF1ZXVlVGl0bGUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgb25hYm9ydDogZnVuY3Rpb24oZSkgeyByZXNvbHZlKG51bGwpOyB9LAogICAgICAgICAgICAgICAgb25lcnJvcjogZnVuY3Rpb24oZSkgeyBkb3dubG9hZEVycm9yKGUsIHVybCwgZmlsZU5hbWUsIGhlYWRlckZsYWcsIHByb2dyZXNzKTsgcmVzb2x2ZShudWxsKTsgfSwKICAgICAgICAgICAgICAgIG9udGltZW91dDogZnVuY3Rpb24oZSkgeyBkb3dubG9hZEVycm9yKGUsIHVybCwgZmlsZU5hbWUsIGhlYWRlckZsYWcsIHByb2dyZXNzKTsgcmVzb2x2ZShudWxsKTsgfSwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIC8vIOS4i+mdoui/meenjeWOn+eUn+eahOaWueazle+8jOWboOS4uuWuieWFqOWOn+WboO+8jOS4jeiiq+a1j+iniOWZqOWFgeiuuO+8jOWxnuS6jui3qOWfn++8jOS4lOWcqGh0dHBz6aG16Z2i5LiK6K+35rGCaHR0cOOAggogICAgICAgICAgICAvKmxldCBvUmVxID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7CiAgICAgICAgICAgIG9SZXEub3BlbigiUE9TVCIsIEdNX2dldFZhbHVlKCdhcmlhUnBjVXJsJywnaHR0cDovL2xvY2FsaG9zdDo2ODAwL2pzb25ycGMnKSk7CiAgICAgICAgICAgIG9SZXEuc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL2pzb24nKQogICAgICAgICAgICBvUmVxLm9ubG9hZCA9IChlKSA9PiB7CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXNwb25zZS5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgcHJvZ3Jlc3Muc3R5bGUuYmFja2dyb3VuZCA9ICdncmVlbic7CiAgICAgICAgICAgICAgICBjb25zdCB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICAgICAgaWYoZG93bmxvYWRRdWV1ZUNhcmQuY2hpbGRFbGVtZW50Q291bnQgPT0gMSkgZG93bmxvYWRRdWV1ZVRpdGxlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgICAgICAgIHByb2dyZXNzLmxhc3RDaGlsZC5vbmNsaWNrID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudE5vZGUucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICAgICAgaWYoZG93bmxvYWRRdWV1ZUNhcmQuY2hpbGRFbGVtZW50Q291bnQgPT0gMSkgZG93bmxvYWRRdWV1ZVRpdGxlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXNvbHZlKG9SZXEucmVzcG9uc2UpOwogICAgICAgICAgICB9OwogICAgICAgICAgICBvUmVxLm9uZXJyb3IgPSAoZSkgPT4geyBkb3dubG9hZEVycm9yKGUsIHVybCwgZmlsZU5hbWUsIGhlYWRlckZsYWcsIHByb2dyZXNzKTsgcmVzb2x2ZShudWxsKTsgfTsKICAgICAgICAgICAgb1JlcS5vbmFib3J0ID0gKGUpID0+IHsgcmVzb2x2ZShudWxsKTsgfTsKICAgICAgICAgICAgb1JlcS5vbnRpbWVvdXQgPSAoZSkgPT4geyBkb3dubG9hZEVycm9yKGUsIHVybCwgZmlsZU5hbWUsIGhlYWRlckZsYWcsIHByb2dyZXNzKTsgcmVzb2x2ZShudWxsKTsgfTsKICAgICAgICAgICAgb1JlcS5zZW5kKEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgIGpzb25ycGM6ICcyLjAnLAogICAgICAgICAgICAgICAgaWQ6ICd3ZWlibycsCiAgICAgICAgICAgICAgICBtZXRob2Q6ICdhcmlhMi5hZGRVcmknLAogICAgICAgICAgICAgICAgcGFyYW1zOiBbIFsgdXJsIF0sIHsgaGVhZGVyLCBvdXQ6IGZpbGVOYW1lIH0gXSwKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICBwcm9ncmVzcy5sYXN0Q2hpbGQub25jbGljayA9IGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgICAgIG9SZXEuYWJvcnQoKTsKICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIGlmKGRvd25sb2FkUXVldWVDYXJkLmNoaWxkRWxlbWVudENvdW50ID09IDEpIGRvd25sb2FkUXVldWVUaXRsZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICB9OyovCiAgICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gaHR0cFJlcXVlc3QodXJsLCBtZXRob2QgPSAnR0VUJywgZGF0YSA9IG51bGwpIHsKICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgIGxldCBvUmVxID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7CiAgICAgICAgICAgIG9SZXEub3BlbihtZXRob2QsIHVybCk7CiAgICAgICAgICAgIG9SZXEucmVzcG9uc2VUeXBlID0gJ2pzb24nOwogICAgICAgICAgICBvUmVxLm9ubG9hZCA9IChlKSA9PiB7IHJlc29sdmUob1JlcS5yZXNwb25zZSk7IH07CiAgICAgICAgICAgIG9SZXEub25lcnJvciA9IChlKSA9PiB7IHJlc29sdmUobnVsbCk7IH07CiAgICAgICAgICAgIG9SZXEub25hYm9ydCA9IChlKSA9PiB7IHJlc29sdmUobnVsbCk7IH07CiAgICAgICAgICAgIG9SZXEub250aW1lb3V0ID0gKGUpID0+IHsgcmVzb2x2ZShudWxsKTsgfTsKICAgICAgICAgICAgb1JlcS5zZXRSZXF1ZXN0SGVhZGVyKCdYLVhTUkYtVE9LRU4nLCBnZXRDb29raWUoJ1hTUkYtVE9LRU4nKSk7CiAgICAgICAgICAgIGlmKHR5cGVvZihkYXRhKSA9PT0gJ3N0cmluZycpIHsKICAgICAgICAgICAgICAgIG9SZXEuc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcpOwogICAgICAgICAgICAgICAgb1JlcS5zZW5kKGRhdGEpOwogICAgICAgICAgICB9IGVsc2UgaWYodHlwZW9mKGRhdGEpID09PSAnb2JqZWN0JykgewogICAgICAgICAgICAgICAgb1JlcS5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LVR5cGUnLCAnYXBwbGljYXRpb24vanNvbjtjaGFyc2V0PVVURi04Jyk7CiAgICAgICAgICAgICAgICBvUmVxLnNlbmQoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgb1JlcS5zZW5kKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBnbUh0dHBSZXF1ZXN0KHVybCwgbWV0aG9kID0gJ0dFVCcsIGRhdGEgPSBudWxsLCB1YSA9IG51bGwpIHsKICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHVybCk7CiAgICAgICAgICAgIGxldCBoZWFkZXJzID0gewogICAgICAgICAgICAgICAgJ1JlZmVyZXInOiAnaHR0cHM6Ly8nICsgbG9jYXRpb24uaG9zdCwKICAgICAgICAgICAgICAgICdPcmlnaW4nOiAnaHR0cHM6Ly8nICsgbG9jYXRpb24uaG9zdCwKICAgICAgICAgICAgICAgICdYLVhTUkYtVE9LRU4nOiBnZXRDb29raWUoJ1hTUkYtVE9LRU4nKSwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgaWYodHlwZW9mKGRhdGEpID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAgICAgaGVhZGVyc1snQ29udGVudC1UeXBlJ10gPSAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJzsKICAgICAgICAgICAgfSBlbHNlIGlmKHR5cGVvZihkYXRhKSA9PT0gJ29iamVjdCcpIHsKICAgICAgICAgICAgICAgIGhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddID0gJ2FwcGxpY2F0aW9uL2pzb247Y2hhcnNldD1VVEYtOCc7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYodWEpIHsKICAgICAgICAgICAgICAgIGhlYWRlcnNbJ1VzZXItQWdlbnQnXSA9IHVhOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGhlYWRlcnMpCiAgICAgICAgICAgIEdNX3htbGh0dHBSZXF1ZXN0KHsKICAgICAgICAgICAgICAgIG1ldGhvZCwKICAgICAgICAgICAgICAgIHVybCwKICAgICAgICAgICAgICAgIGRhdGEsCiAgICAgICAgICAgICAgICByZXNwb25zZVR5cGU6ICdqc29uJywKICAgICAgICAgICAgICAgIGhlYWRlcnMsCiAgICAgICAgICAgICAgICBvbmxvYWQ6ICh7IHN0YXR1cywgcmVzcG9uc2UgfSkgPT4gewogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIG9uYWJvcnQ6IGZ1bmN0aW9uKGUpIHsgcmVzb2x2ZShudWxsKTsgfSwKICAgICAgICAgICAgICAgIG9uZXJyb3I6IGZ1bmN0aW9uKGUpIHsgcmVzb2x2ZShudWxsKTsgfSwKICAgICAgICAgICAgICAgIG9udGltZW91dDogZnVuY3Rpb24oZSkgeyByZXNvbHZlKG51bGwpOyB9LAogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBkb3dubG9hZEVycm9yKGUsIHVybCwgbmFtZSwgaGVhZGVyRmxhZywgcHJvZ3Jlc3MsIHppcE1vZGUgPSBmYWxzZSwgYXJpYU1vZGUgPSBmYWxzZSkgewogICAgICAgIC8vIGNvbnNvbGUubG9nKGUsIHVybCk7CiAgICAgICAgLypHTV9ub3RpZmljYXRpb24oewogICAgICAgICAgICB0aXRsZTogJ0Rvd25sb2FkIGVycm9yJywKICAgICAgICAgICAgdGV4dDogJ0Vycm9yOiAnICsgZS5lcnJvciArICdcblVybDogJyArIHVybCwKICAgICAgICAgICAgc2lsZW50OiB0cnVlLAogICAgICAgICAgICB0aW1lb3V0OiAzLAogICAgICAgIH0pOyovCiAgICAgICAgcHJvZ3Jlc3Muc3R5bGUuYmFja2dyb3VuZCA9ICdyZWQnOwogICAgICAgIHByb2dyZXNzLmZpcnN0Q2hpbGQudGV4dENvbnRlbnQgPSBuYW1lICsgJyBbJyArIChlLmVycm9yIHx8ICdVbmtub3duJykgKyAnXSc7CiAgICAgICAgcHJvZ3Jlc3MuZmlyc3RDaGlsZC5zdHlsZS5jb2xvciA9ICd5ZWxsb3cnOwogICAgICAgIHByb2dyZXNzLmZpcnN0Q2hpbGQuc3R5bGUubWl4QmxlbmRNb2RlID0gJ3Vuc2V0JzsKICAgICAgICBpZiAoIXppcE1vZGUpIHsKICAgICAgICAgICAgbGV0IHByb2dyZXNzUmV0cnlCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICAgICAgcHJvZ3Jlc3NSZXRyeUJ0bi5zdHlsZS5ib3JkZXIgPSAndW5zZXQnOwogICAgICAgICAgICBwcm9ncmVzc1JldHJ5QnRuLnN0eWxlLmJhY2tncm91bmQgPSAndW5zZXQnOwogICAgICAgICAgICBwcm9ncmVzc1JldHJ5QnRuLnN0eWxlLmNvbG9yID0gJ3llbGxvdyc7CiAgICAgICAgICAgIHByb2dyZXNzUmV0cnlCdG4uc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnOwogICAgICAgICAgICBwcm9ncmVzc1JldHJ5QnRuLnN0eWxlLnJpZ2h0ID0gJzEuMnJlbSc7CiAgICAgICAgICAgIHByb2dyZXNzUmV0cnlCdG4uc3R5bGUudG9wID0gJzAuMDVyZW0nOwogICAgICAgICAgICBwcm9ncmVzc1JldHJ5QnRuLnN0eWxlLmZvbnRTaXplID0gJzFyZW0nOwogICAgICAgICAgICBwcm9ncmVzc1JldHJ5QnRuLnN0eWxlLmxpbmVIZWlnaHQgPSAnMXJlbSc7CiAgICAgICAgICAgIHByb2dyZXNzUmV0cnlCdG4uc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInOwogICAgICAgICAgICBwcm9ncmVzc1JldHJ5QnRuLnN0eWxlLmxldHRlclNwYWNpbmcgPSAnLTAuMnJlbSc7CiAgICAgICAgICAgIHByb2dyZXNzUmV0cnlCdG4udGV4dENvbnRlbnQgPSAn4qSk4qSmJzsKICAgICAgICAgICAgcHJvZ3Jlc3NSZXRyeUJ0bi50aXRsZSA9IHRleHRbMTBdOwogICAgICAgICAgICBwcm9ncmVzc1JldHJ5QnRuLm9ubW91c2VvdmVyID0gZnVuY3Rpb24oZSl7CiAgICAgICAgICAgICAgICB0aGlzLnN0eWxlLmNvbG9yID0gJ3doaXRlJzsKICAgICAgICAgICAgfQogICAgICAgICAgICBwcm9ncmVzc1JldHJ5QnRuLm9ubW91c2VvdXQgPSBmdW5jdGlvbihlKXsKICAgICAgICAgICAgICAgIHRoaXMuc3R5bGUuY29sb3IgPSAneWVsbG93JzsKICAgICAgICAgICAgfQogICAgICAgICAgICBwcm9ncmVzc1JldHJ5QnRuLm9uY2xpY2sgPSBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudE5vZGUucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICBpZiAoYXJpYU1vZGUpIHsKICAgICAgICAgICAgICAgICAgICBzZW5kMkFyaWEyYyh1cmwsIG5hbWUsIGhlYWRlckZsYWcpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBkb3dubG9hZFdyYXBwZXIodXJsLCBuYW1lLCBoZWFkZXJGbGFnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBwcm9ncmVzcy5pbnNlcnRCZWZvcmUocHJvZ3Jlc3NSZXRyeUJ0biwgcHJvZ3Jlc3MubGFzdENoaWxkKTsKICAgICAgICB9CiAgICAgICAgcHJvZ3Jlc3MubGFzdENoaWxkLnRpdGxlID0gdGV4dFsxMV07CiAgICAgICAgcHJvZ3Jlc3MubGFzdENoaWxkLnN0eWxlLmNvbG9yID0gJ3llbGxvdyc7CiAgICAgICAgcHJvZ3Jlc3MubGFzdENoaWxkLm9ubW91c2VvdmVyID0gZnVuY3Rpb24oZSl7CiAgICAgICAgICAgIHRoaXMuc3R5bGUuY29sb3IgPSAnd2hpdGUnOwogICAgICAgIH07CiAgICAgICAgcHJvZ3Jlc3MubGFzdENoaWxkLm9ubW91c2VvdXQgPSBmdW5jdGlvbihlKXsKICAgICAgICAgICAgdGhpcy5zdHlsZS5jb2xvciA9ICd5ZWxsb3cnOwogICAgICAgIH07CiAgICAgICAgcHJvZ3Jlc3MubGFzdENoaWxkLm9uY2xpY2sgPSBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5yZW1vdmUoKTsKICAgICAgICAgICAgaWYocHJvZ3Jlc3MucGFyZW50LmNoaWxkRWxlbWVudENvdW50ID09IDEpIHByb2dyZXNzLnBhcmVudC5maXJzdENoaWxkLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgfTsKICAgICAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHsgcHJvZ3Jlc3MucmVtb3ZlKCk7IGlmKGRvd25sb2FkUXVldWVDYXJkLmNoaWxkRWxlbWVudENvdW50ID09IDEpIGRvd25sb2FkUXVldWVUaXRsZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOyB9LCAxMDAwKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRDb29raWUoa2V5ID0gbnVsbCkgewogICAgICAgIGxldCBjb29raWVzQXJyID0gZG9jdW1lbnQuY29va2llLnNwbGl0KCc7ICcpOwogICAgICAgIGxldCBjb29raWVzT2JqID0ge307CiAgICAgICAgZm9yIChjb25zdCBjb29raWUgb2YgY29va2llc0FycikgewogICAgICAgICAgICBsZXQgWyBuYW1lLCB2YWx1ZSBdID0gY29va2llLnNwbGl0KCc9Jyk7CiAgICAgICAgICAgIGNvb2tpZXNPYmpbbmFtZV0gPSB2YWx1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKGtleSkgewogICAgICAgICAgICByZXR1cm4gY29va2llc09ialtrZXldOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBjb29raWVzT2JqOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBkb3dubG9hZFdyYXBwZXIodXJsLCBuYW1lLCBoZWFkZXJGbGFnID0gZmFsc2UsIHppcE1vZGUgPSBmYWxzZSkgewogICAgICAgIC8vIGNvbnNvbGUubG9nKHVybCk7CiAgICAgICAgZG93bmxvYWRRdWV1ZVRpdGxlLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgIGxldCBwcm9ncmVzcyA9IGRvd25sb2FkUXVldWVDYXJkLmFwcGVuZENoaWxkKHByb2dyZXNzQmFyLmNsb25lTm9kZSh0cnVlKSk7CiAgICAgICAgcHJvZ3Jlc3MuZmlyc3RDaGlsZC50ZXh0Q29udGVudCA9IG5hbWUgKyAnIFswJV0nOwogICAgICAgIGlmICh6aXBNb2RlKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGRvd25sb2FkID0gR01feG1saHR0cFJlcXVlc3QoewogICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsCiAgICAgICAgICAgICAgICAgICAgdXJsLAogICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlVHlwZTogJ2Jsb2InLAogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlckZsYWcgPyB7CiAgICAgICAgICAgICAgICAgICAgICAgICdSZWZlcmVyJzogJ2h0dHBzOi8vJyArIGxvY2F0aW9uLmhvc3QsCiAgICAgICAgICAgICAgICAgICAgICAgICdPcmlnaW4nOiAnaHR0cHM6Ly8nICsgbG9jYXRpb24uaG9zdAogICAgICAgICAgICAgICAgICAgIH0gOiBudWxsLAogICAgICAgICAgICAgICAgICAgIG9ucHJvZ3Jlc3M6IChlKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGUgPSB7IGludCBkb25lLCBmaW5hbFVybCwgYm9vbCBsZW5ndGhDb21wdXRhYmxlLCBpbnQgbG9hZGVkLCBpbnQgcG9zaXRpb24sIGludCByZWFkeVN0YXRlLCByZXNwb25zZSwgc3RyIHJlc3BvbnNlSGVhZGVycywgcmVzcG9uc2VUZXh0LCByZXNwb25zZVhNTCwgaW50IHN0YXR1cywgc3RhdHVzVGV4dCwgaW50IHRvdGFsLCBpbnQgdG90YWxTaXplIH0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGVyY2VudCA9IGUuZG9uZSAvIGUudG90YWwgKiAxMDA7CiAgICAgICAgICAgICAgICAgICAgICAgIHByb2dyZXNzLnN0eWxlLmJhY2tncm91bmQgPSAnbGluZWFyLWdyYWRpZW50KHRvIHJpZ2h0LCBncmVlbiAnICsgcGVyY2VudCArICclLCB0cmFuc3BhcmVudCAnICsgcGVyY2VudCArICclKSc7CiAgICAgICAgICAgICAgICAgICAgICAgIHByb2dyZXNzLmZpcnN0Q2hpbGQudGV4dENvbnRlbnQgPSBuYW1lICsgJyBbJyArIHBlcmNlbnQudG9GaXhlZCgwKSArICclXSc7CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBvbmxvYWQ6ICh7IHN0YXR1cywgcmVzcG9uc2UgfSkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9ncmVzcy5yZW1vdmUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRvd25sb2FkUXVldWVDYXJkLmNoaWxkRWxlbWVudENvdW50ID09IDEpIGRvd25sb2FkUXVldWVUaXRsZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MubGFzdENoaWxkLm9uY2xpY2sgPSBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudE5vZGUucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihkb3dubG9hZFF1ZXVlQ2FyZC5jaGlsZEVsZW1lbnRDb3VudCA9PSAxKSBkb3dubG9hZFF1ZXVlVGl0bGUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBvbmFib3J0OiBmdW5jdGlvbihlKSB7IHJlc29sdmUobnVsbCk7IH0sCiAgICAgICAgICAgICAgICAgICAgb25lcnJvcjogZnVuY3Rpb24oZSkgeyBkb3dubG9hZEVycm9yKGUsIHVybCwgbmFtZSwgaGVhZGVyRmxhZywgcHJvZ3Jlc3MpOyByZXNvbHZlKG51bGwpOyB9LAogICAgICAgICAgICAgICAgICAgIG9udGltZW91dDogZnVuY3Rpb24oZSkgeyBkb3dubG9hZEVycm9yKGUsIHVybCwgbmFtZSwgaGVhZGVyRmxhZywgcHJvZ3Jlc3MpOyByZXNvbHZlKG51bGwpOyB9LAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBwcm9ncmVzcy5sYXN0Q2hpbGQub25jbGljayA9IGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgICAgICAgICBkb3dubG9hZC5hYm9ydCgpOwogICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgICAgICBpZihkb3dubG9hZFF1ZXVlQ2FyZC5jaGlsZEVsZW1lbnRDb3VudCA9PSAxKSBkb3dubG9hZFF1ZXVlVGl0bGUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAvLyDkuIvpnaLov5nnp43ljp/nlJ/nmoTmlrnms5XvvIzlj6/ku6XmraPluLjkuIvovb3pnZ5WK+eahOi1hOa6kO+8jOmBh+WIsFYr55qE6LWE5rqQ5Lya5oql6ZSZ44CCCiAgICAgICAgICAgICAgICAvKmxldCBvUmVxID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7CiAgICAgICAgICAgICAgICBvUmVxLm9wZW4oIkdFVCIsIHVybCk7CiAgICAgICAgICAgICAgICBvUmVxLnJlc3BvbnNlVHlwZSA9ICdibG9iJzsKICAgICAgICAgICAgICAgIG9SZXEub25wcm9ncmVzcyA9IChlKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZSk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGVyY2VudCA9IGUubG9hZGVkIC8gZS50b3RhbCAqIDEwMDsKICAgICAgICAgICAgICAgICAgICBwcm9ncmVzcy5zdHlsZS5iYWNrZ3JvdW5kID0gJ2xpbmVhci1ncmFkaWVudCh0byByaWdodCwgZ3JlZW4gJyArIHBlcmNlbnQgKyAnJSwgdHJhbnNwYXJlbnQgJyArIHBlcmNlbnQgKyAnJSknOwogICAgICAgICAgICAgICAgICAgIHByb2dyZXNzLmZpcnN0Q2hpbGQudGV4dENvbnRlbnQgPSBuYW1lICsgJyBbJyArIHBlcmNlbnQudG9GaXhlZCgwKSArICclXSc7CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgb1JlcS5vbmxvYWQgPSAoZSkgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRvd25sb2FkUXVldWVDYXJkLmNoaWxkRWxlbWVudENvdW50ID09IDEpIGRvd25sb2FkUXVldWVUaXRsZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgIH0sIDEwMDApOwogICAgICAgICAgICAgICAgICAgIHByb2dyZXNzLmxhc3RDaGlsZC5vbmNsaWNrID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgb1JlcS5hYm9ydCgpOwogICAgICAgICAgICAgICAgICAgICAgICBpZihkb3dubG9hZFF1ZXVlQ2FyZC5jaGlsZEVsZW1lbnRDb3VudCA9PSAxKSBkb3dubG9hZFF1ZXVlVGl0bGUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHJlc29sdmUob1JlcS5yZXNwb25zZSk7CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgb1JlcS5vbmVycm9yID0gKGUpID0+IHsgZG93bmxvYWRFcnJvcihlLCB1cmwsIG5hbWUsIGhlYWRlckZsYWcsIHByb2dyZXNzKTsgcmVzb2x2ZShudWxsKTsgfTsKICAgICAgICAgICAgICAgIG9SZXEub25hYm9ydCA9IChlKSA9PiB7IHJlc29sdmUobnVsbCk7IH07CiAgICAgICAgICAgICAgICBvUmVxLm9udGltZW91dCA9IChlKSA9PiB7IGRvd25sb2FkRXJyb3IoZSwgdXJsLCBuYW1lLCBoZWFkZXJGbGFnLCBwcm9ncmVzcyk7IHJlc29sdmUobnVsbCk7IH07CiAgICAgICAgICAgICAgICBvUmVxLnNlbmQoKTsKICAgICAgICAgICAgICAgIHByb2dyZXNzLmxhc3RDaGlsZC5vbmNsaWNrID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgICAgICBvUmVxLmFib3J0KCk7CiAgICAgICAgICAgICAgICAgICAgaWYoZG93bmxvYWRRdWV1ZUNhcmQuY2hpbGRFbGVtZW50Q291bnQgPT0gMSkgZG93bmxvYWRRdWV1ZVRpdGxlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICB9OyovCiAgICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8qY29uc3QgZG93bmxvYWQgPSBHTV9kb3dubG9hZCh7CiAgICAgICAgICAgICAgICB1cmwsCiAgICAgICAgICAgICAgICBuYW1lLAogICAgICAgICAgICAgICAgaGVhZGVyczogaGVhZGVyRmxhZyA/IHsKICAgICAgICAgICAgICAgICAgICAnUmVmZXJlcic6ICdodHRwczovLycgKyBsb2NhdGlvbi5ob3N0LAogICAgICAgICAgICAgICAgICAgICdPcmlnaW4nOiAnaHR0cHM6Ly8nICsgbG9jYXRpb24uaG9zdAogICAgICAgICAgICAgICAgfSA6IG51bGwsCiAgICAgICAgICAgICAgICBvbnByb2dyZXNzOiAoZSkgPT4gewogICAgICAgICAgICAgICAgICAgIC8vIGUgPSB7IGludCBkb25lLCBmaW5hbFVybCwgYm9vbCBsZW5ndGhDb21wdXRhYmxlLCBpbnQgbG9hZGVkLCBpbnQgcG9zaXRpb24sIGludCByZWFkeVN0YXRlLCByZXNwb25zZSwgc3RyIHJlc3BvbnNlSGVhZGVycywgcmVzcG9uc2VUZXh0LCByZXNwb25zZVhNTCwgaW50IHN0YXR1cywgc3RhdHVzVGV4dCwgaW50IHRvdGFsLCBpbnQgdG90YWxTaXplIH0KICAgICAgICAgICAgICAgICAgICBjb25zdCBwZXJjZW50ID0gZS5kb25lIC8gZS50b3RhbCAqIDEwMDsKICAgICAgICAgICAgICAgICAgICBwcm9ncmVzcy5zdHlsZS5iYWNrZ3JvdW5kID0gJ2xpbmVhci1ncmFkaWVudCh0byByaWdodCwgZ3JlZW4gJyArIHBlcmNlbnQgKyAnJSwgdHJhbnNwYXJlbnQgJyArIHBlcmNlbnQgKyAnJSknOwogICAgICAgICAgICAgICAgICAgIHByb2dyZXNzLmZpcnN0Q2hpbGQudGV4dENvbnRlbnQgPSBuYW1lICsgJyBbJyArIHBlcmNlbnQudG9GaXhlZCgwKSArICclXSc7CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgb25sb2FkOiAoeyBzdGF0dXMsIHJlc3BvbnNlIH0pID0+IHsKICAgICAgICAgICAgICAgICAgICBjb25zdCB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHByb2dyZXNzLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgICAgICBpZihkb3dubG9hZFF1ZXVlQ2FyZC5jaGlsZEVsZW1lbnRDb3VudCA9PSAxKSBkb3dubG9hZFF1ZXVlVGl0bGUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgICAgICAgICAgICBwcm9ncmVzcy5sYXN0Q2hpbGQub25jbGljayA9IGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudE5vZGUucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRvd25sb2FkUXVldWVDYXJkLmNoaWxkRWxlbWVudENvdW50ID09IDEpIGRvd25sb2FkUXVldWVUaXRsZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBvbmVycm9yOiAoZSkgPT4geyBkb3dubG9hZEVycm9yKGUsIHVybCwgbmFtZSwgaGVhZGVyRmxhZywgcHJvZ3Jlc3MpOyB9LAogICAgICAgICAgICAgICAgb250aW1lb3V0OiAoZSkgPT4geyBkb3dubG9hZEVycm9yKGUsIHVybCwgbmFtZSwgaGVhZGVyRmxhZywgcHJvZ3Jlc3MpOyB9LAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcHJvZ3Jlc3MubGFzdENoaWxkLm9uY2xpY2sgPSBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICBkb3dubG9hZC5hYm9ydCgpOwogICAgICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgaWYoZG93bmxvYWRRdWV1ZUNhcmQuY2hpbGRFbGVtZW50Q291bnQgPT0gMSkgZG93bmxvYWRRdWV1ZVRpdGxlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgIH07Ki8KICAgICAgICAgICAgLy8g6L+Z5Liq5pa55rOV5Lmf5Y+v5Lul77yM6ICM5LiU5LiN5piv6LWwR01fZG93bmxvYWTvvIzkuI3kvJrooqvmsrnnjLTorr7nva7ph4znmoTkuIvovb3pgInpobnlvbHlk43jgIIKICAgICAgICAgICAgY29uc3QgZG93bmxvYWQgPSBHTV94bWxodHRwUmVxdWVzdCh7CiAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLAogICAgICAgICAgICAgICAgdXJsLAogICAgICAgICAgICAgICAgcmVzcG9uc2VUeXBlOiAnYmxvYicsCiAgICAgICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJGbGFnID8gewogICAgICAgICAgICAgICAgICAgICdSZWZlcmVyJzogJ2h0dHBzOi8vJyArIGxvY2F0aW9uLmhvc3QsCiAgICAgICAgICAgICAgICAgICAgJ09yaWdpbic6ICdodHRwczovLycgKyBsb2NhdGlvbi5ob3N0CiAgICAgICAgICAgICAgICB9IDogbnVsbCwKICAgICAgICAgICAgICAgIG9ucHJvZ3Jlc3M6IChlKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgLy8gZSA9IHsgaW50IGRvbmUsIGZpbmFsVXJsLCBib29sIGxlbmd0aENvbXB1dGFibGUsIGludCBsb2FkZWQsIGludCBwb3NpdGlvbiwgaW50IHJlYWR5U3RhdGUsIHJlc3BvbnNlLCBzdHIgcmVzcG9uc2VIZWFkZXJzLCByZXNwb25zZVRleHQsIHJlc3BvbnNlWE1MLCBpbnQgc3RhdHVzLCBzdGF0dXNUZXh0LCBpbnQgdG90YWwsIGludCB0b3RhbFNpemUgfQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBlcmNlbnQgPSBlLmRvbmUgLyBlLnRvdGFsICogMTAwOwogICAgICAgICAgICAgICAgICAgIHByb2dyZXNzLnN0eWxlLmJhY2tncm91bmQgPSAnbGluZWFyLWdyYWRpZW50KHRvIHJpZ2h0LCBncmVlbiAnICsgcGVyY2VudCArICclLCB0cmFuc3BhcmVudCAnICsgcGVyY2VudCArICclKSc7CiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MuZmlyc3RDaGlsZC50ZXh0Q29udGVudCA9IG5hbWUgKyAnIFsnICsgcGVyY2VudC50b0ZpeGVkKDApICsgJyVdJzsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBvbmxvYWQ6ICh7IHN0YXR1cywgcmVzcG9uc2UgfSkgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRvd25sb2FkUXVldWVDYXJkLmNoaWxkRWxlbWVudENvdW50ID09IDEpIGRvd25sb2FkUXVldWVUaXRsZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgIH0sIDEwMDApOwogICAgICAgICAgICAgICAgICAgIHByb2dyZXNzLmxhc3RDaGlsZC5vbmNsaWNrID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoZG93bmxvYWRRdWV1ZUNhcmQuY2hpbGRFbGVtZW50Q291bnQgPT0gMSkgZG93bmxvYWRRdWV1ZVRpdGxlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBzYXZlQXMocmVzcG9uc2UsIG5hbWUpOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHByb2dyZXNzLmxhc3RDaGlsZC5vbmNsaWNrID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgZG93bmxvYWQuYWJvcnQoKTsKICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIGlmKGRvd25sb2FkUXVldWVDYXJkLmNoaWxkRWxlbWVudENvdW50ID09IDEpIGRvd25sb2FkUXVldWVUaXRsZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICB9OwogICAgICAgICAgICAvLyDkuIvpnaLov5nnp43ljp/nlJ/nmoTmlrnms5XvvIzlj6/ku6XmraPluLjkuIvovb3pnZ5WK+eahOi1hOa6kO+8jOmBh+WIsFYr55qE6LWE5rqQ5Lya5oql6ZSZ44CCCiAgICAgICAgICAgIC8qbGV0IG9SZXEgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsKICAgICAgICAgICAgb1JlcS5vcGVuKCJHRVQiLCB1cmwpOwogICAgICAgICAgICBvUmVxLnJlc3BvbnNlVHlwZSA9ICdibG9iJzsKICAgICAgICAgICAgb1JlcS5vbnByb2dyZXNzID0gKGUpID0+IHsKICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICAgICAgY29uc3QgcGVyY2VudCA9IGUubG9hZGVkIC8gZS50b3RhbCAqIDEwMDsKICAgICAgICAgICAgICAgIHByb2dyZXNzLnN0eWxlLmJhY2tncm91bmQgPSAnbGluZWFyLWdyYWRpZW50KHRvIHJpZ2h0LCBncmVlbiAnICsgcGVyY2VudCArICclLCB0cmFuc3BhcmVudCAnICsgcGVyY2VudCArICclKSc7CiAgICAgICAgICAgICAgICBwcm9ncmVzcy5maXJzdENoaWxkLnRleHRDb250ZW50ID0gbmFtZSArICcgWycgKyBwZXJjZW50LnRvRml4ZWQoMCkgKyAnJV0nOwogICAgICAgICAgICB9OwogICAgICAgICAgICBvUmVxLm9ubG9hZCA9IChlKSA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICAgICAgaWYoZG93bmxvYWRRdWV1ZUNhcmQuY2hpbGRFbGVtZW50Q291bnQgPT0gMSkgZG93bmxvYWRRdWV1ZVRpdGxlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgICAgICAgIHByb2dyZXNzLmxhc3RDaGlsZC5vbmNsaWNrID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudE5vZGUucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICAgICAgb1JlcS5hYm9ydCgpOwogICAgICAgICAgICAgICAgICAgIGlmKGRvd25sb2FkUXVldWVDYXJkLmNoaWxkRWxlbWVudENvdW50ID09IDEpIGRvd25sb2FkUXVldWVUaXRsZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIHNhdmVBcyhvUmVxLnJlc3BvbnNlLCBuYW1lKTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgb1JlcS5vbmVycm9yID0gKGUpID0+IHsgZG93bmxvYWRFcnJvcihlLCB1cmwsIG5hbWUsIGhlYWRlckZsYWcsIHByb2dyZXNzKTsgfTsKICAgICAgICAgICAgb1JlcS5vbnRpbWVvdXQgPSAoZSkgPT4geyBkb3dubG9hZEVycm9yKGUsIHVybCwgbmFtZSwgaGVhZGVyRmxhZywgcHJvZ3Jlc3MpOyB9OwogICAgICAgICAgICBvUmVxLnNlbmQoKTsKICAgICAgICAgICAgcHJvZ3Jlc3MubGFzdENoaWxkLm9uY2xpY2sgPSBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudE5vZGUucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICBvUmVxLmFib3J0KCk7CiAgICAgICAgICAgICAgICBpZihkb3dubG9hZFF1ZXVlQ2FyZC5jaGlsZEVsZW1lbnRDb3VudCA9PSAxKSBkb3dubG9hZFF1ZXVlVGl0bGUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgfTsqLwogICAgICAgICAgICAvLyDkuIvpnaJmZXRjaOeahOaWueazle+8jOaEn+inieS4jeaYr+W+iOWlveWGme+8jOaJgOS7peWwseS4jeeUqOS4i+mdoueahOaWueazleOAggogICAgICAgICAgICAvKihhc3luYyBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBsZXQgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTsKICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7IHNpZ25hbDogY29udHJvbGxlci5zaWduYWwgfSk7CiAgICAgICAgICAgICAgICBwcm9ncmVzcy5sYXN0Q2hpbGQub25jbGljayA9IGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmFib3J0KCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgIGlmKGRvd25sb2FkUXVldWVDYXJkLmNoaWxkRWxlbWVudENvdW50ID09IDEpIGRvd25sb2FkUXVldWVUaXRsZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29uc3QgY29udGVudExlbmd0aCA9IHJlc3BvbnNlLmhlYWRlcnMuZ2V0KCdjb250ZW50LWxlbmd0aCcpOwogICAgICAgICAgICAgICAgY29uc3QgdG90YWwgPSBwYXJzZUludChjb250ZW50TGVuZ3RoLCAxMCk7CiAgICAgICAgICAgICAgICBsZXQgbG9hZGVkID0gMDsKICAgICAgICAgICAgICAgIGNvbnN0IHJlYWRlciA9IHJlc3BvbnNlLmJvZHkuZ2V0UmVhZGVyKCk7CiAgICAgICAgICAgICAgICBjb25zdCByZXMgPSBuZXcgUmVzcG9uc2UobmV3IFJlYWRhYmxlU3RyZWFtKHsKICAgICAgICAgICAgICAgICAgICBhc3luYyBzdGFydChjb250cm9sbGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlKHRydWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUpIGxvYWRlZCArPSB2YWx1ZS5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwZXJjZW50ID0gbG9hZGVkIC8gdG90YWwgKiAxMDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9ncmVzcy5zdHlsZS5iYWNrZ3JvdW5kID0gJ2xpbmVhci1ncmFkaWVudCh0byByaWdodCwgZ3JlZW4gJyArIHBlcmNlbnQgKyAnJSwgdHJhbnNwYXJlbnQgJyArIHBlcmNlbnQgKyAnJSknOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MuZmlyc3RDaGlsZC50ZXh0Q29udGVudCA9IG5hbWUgKyAnIFsnICsgcGVyY2VudC50b0ZpeGVkKDApICsgJyVdJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb25lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5jbG9zZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IHJlcy5ibG9iKCk7CiAgICAgICAgICAgICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpOwogICAgICAgICAgICAgICAgbGluay5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAgICAgICAgICAgbGluay5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsKICAgICAgICAgICAgICAgIGxpbmsuZG93bmxvYWQgPSBuYW1lOwogICAgICAgICAgICAgICAgbGluay50YXJnZXQgPSAnX2JsYW5rJzsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGluayk7CiAgICAgICAgICAgICAgICBsaW5rLmNsaWNrKCk7CiAgICAgICAgICAgICAgICBwcm9ncmVzcy5zdHlsZS5iYWNrZ3JvdW5kID0gJ2dyZWVuJzsKICAgICAgICAgICAgICAgIGNvbnN0IHRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICBwcm9ncmVzcy5yZW1vdmUoKTsKICAgICAgICAgICAgICAgICAgICBpZihkb3dubG9hZFF1ZXVlQ2FyZC5jaGlsZEVsZW1lbnRDb3VudCA9PSAxKSBkb3dubG9hZFF1ZXVlVGl0bGUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKGxpbmsuaHJlZik7CiAgICAgICAgICAgICAgICAgICAgbGluay5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGxpbmspOwogICAgICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICAgICAgICBwcm9ncmVzcy5sYXN0Q2hpbGQub25jbGljayA9IGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwobGluay5ocmVmKTsKICAgICAgICAgICAgICAgICAgICBsaW5rLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobGluayk7CiAgICAgICAgICAgICAgICAgICAgaWYoZG93bmxvYWRRdWV1ZUNhcmQuY2hpbGRFbGVtZW50Q291bnQgPT0gMSkgZG93bmxvYWRRdWV1ZVRpdGxlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pKCk7Ki8KICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0TmFtZShuYW1lU2V0dGluZywgb3JpZ2luYWxOYW1lLCBleHQsIHVzZXJOYW1lLCB1c2VySWQsIHBvc3RJZCwgcG9zdFVpZCwgaW5kZXgsIHBvc3RUaW1lLCBjb250ZW50LCByZXR3ZWV0UG9zdElkLCByZXR3ZWV0VXNlck5hbWUsIHJldHdlZXRVc2VySWQsIHJldHdlZXRQb3N0VWlkLCByZXR3ZWV0UG9zdFRpbWUsIHJldHdlZXRDb250ZW50KSB7CiAgICAgICAgbGV0IHNldE5hbWUgPSBuYW1lU2V0dGluZzsKICAgICAgICBzZXROYW1lID0gc2V0TmFtZS5yZXBsYWNlKCd7ZXh0fScsIGV4dCk7CiAgICAgICAgc2V0TmFtZSA9IHNldE5hbWUucmVwbGFjZSgne29yaWdpbmFsfScsIG9yaWdpbmFsTmFtZSk7CiAgICAgICAgc2V0TmFtZSA9IHNldE5hbWUucmVwbGFjZSgne3VzZXJuYW1lfScsIHVzZXJOYW1lKTsKICAgICAgICBzZXROYW1lID0gc2V0TmFtZS5yZXBsYWNlKCd7dXNlcmlkfScsIHVzZXJJZCk7CiAgICAgICAgc2V0TmFtZSA9IHNldE5hbWUucmVwbGFjZSgne21ibG9naWR9JywgcG9zdElkKTsKICAgICAgICBzZXROYW1lID0gc2V0TmFtZS5yZXBsYWNlKCd7dWlkfScsIHBvc3RVaWQpOwogICAgICAgIHNldE5hbWUgPSBzZXROYW1lLnJlcGxhY2UoJ3tpbmRleH0nLCBpbmRleCk7CiAgICAgICAgc2V0TmFtZSA9IHNldE5hbWUucmVwbGFjZSgne2NvbnRlbnR9JywgY29udGVudC5zdWJzdHJpbmcoMCwgMjUpKTsKICAgICAgICBsZXQgWVlZWSwgTU0sIERELCBISCwgbW0sIHNzOwogICAgICAgIGNvbnN0IHBvc3RBdCA9IG5ldyBEYXRlKHBvc3RUaW1lKTsKICAgICAgICBpZiAocG9zdFRpbWUpIHsKICAgICAgICAgICAgWVlZWSA9IHBvc3RBdC5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCk7CiAgICAgICAgICAgIE1NID0gKHBvc3RBdC5nZXRNb250aCgpICsgMSkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpOwogICAgICAgICAgICBERCA9IHBvc3RBdC5nZXREYXRlKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpOwogICAgICAgICAgICBISCA9IHBvc3RBdC5nZXRIb3VycygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKTsKICAgICAgICAgICAgbW0gPSBwb3N0QXQuZ2V0TWludXRlcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKTsKICAgICAgICAgICAgc3MgPSBwb3N0QXQuZ2V0U2Vjb25kcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKTsKICAgICAgICB9CiAgICAgICAgc2V0TmFtZSA9IHNldE5hbWUucmVwbGFjZSgne1lZWVl9JywgWVlZWSk7CiAgICAgICAgc2V0TmFtZSA9IHNldE5hbWUucmVwbGFjZSgne01NfScsIE1NKTsKICAgICAgICBzZXROYW1lID0gc2V0TmFtZS5yZXBsYWNlKCd7RER9JywgREQpOwogICAgICAgIHNldE5hbWUgPSBzZXROYW1lLnJlcGxhY2UoJ3tISH0nLCBISCk7CiAgICAgICAgc2V0TmFtZSA9IHNldE5hbWUucmVwbGFjZSgne21tfScsIG1tKTsKICAgICAgICBzZXROYW1lID0gc2V0TmFtZS5yZXBsYWNlKCd7c3N9Jywgc3MpOwogICAgICAgIGlmIChyZXR3ZWV0UG9zdElkICYmIEdNX2dldFZhbHVlKCdyZXR3ZWV0TW9kZScsIGZhbHNlKSkgewogICAgICAgICAgICBzZXROYW1lID0gc2V0TmFtZS5yZXBsYWNlKCd7cmUubWJsb2dpZH0nLCByZXR3ZWV0UG9zdElkKTsKICAgICAgICAgICAgc2V0TmFtZSA9IHNldE5hbWUucmVwbGFjZSgne3JlLnVzZXJuYW1lfScsIHJldHdlZXRVc2VyTmFtZSk7CiAgICAgICAgICAgIHNldE5hbWUgPSBzZXROYW1lLnJlcGxhY2UoJ3tyZS51c2VyaWR9JywgcmV0d2VldFVzZXJJZCk7CiAgICAgICAgICAgIHNldE5hbWUgPSBzZXROYW1lLnJlcGxhY2UoJ3tyZS51aWR9JywgcmV0d2VldFBvc3RVaWQpOwogICAgICAgICAgICBzZXROYW1lID0gc2V0TmFtZS5yZXBsYWNlKCd7cmUuY29udGVudH0nLCByZXR3ZWV0Q29udGVudC5zdWJzdHJpbmcoMCwgMjUpKTsKICAgICAgICAgICAgbGV0IHJlWVlZWSwgcmVNTSwgcmVERCwgcmVISCwgcmVtbSwgcmVzczsKICAgICAgICAgICAgY29uc3QgcmV0d2VldFBvc3RBdCA9IG5ldyBEYXRlKHJldHdlZXRQb3N0VGltZSk7CiAgICAgICAgICAgIGlmIChyZXR3ZWV0UG9zdFRpbWUpIHsKICAgICAgICAgICAgICAgIHJlWVlZWSA9IHJldHdlZXRQb3N0QXQuZ2V0RnVsbFllYXIoKS50b1N0cmluZygpOwogICAgICAgICAgICAgICAgcmVNTSA9IChyZXR3ZWV0UG9zdEF0LmdldE1vbnRoKCkgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyk7CiAgICAgICAgICAgICAgICByZUREID0gcmV0d2VldFBvc3RBdC5nZXREYXRlKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpOwogICAgICAgICAgICAgICAgcmVISCA9IHJldHdlZXRQb3N0QXQuZ2V0SG91cnMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyk7CiAgICAgICAgICAgICAgICByZW1tID0gcmV0d2VldFBvc3RBdC5nZXRNaW51dGVzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpOwogICAgICAgICAgICAgICAgcmVzcyA9IHJldHdlZXRQb3N0QXQuZ2V0U2Vjb25kcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBzZXROYW1lID0gc2V0TmFtZS5yZXBsYWNlKCd7cmUuWVlZWX0nLCByZVlZWVkpOwogICAgICAgICAgICBzZXROYW1lID0gc2V0TmFtZS5yZXBsYWNlKCd7cmUuTU19JywgcmVNTSk7CiAgICAgICAgICAgIHNldE5hbWUgPSBzZXROYW1lLnJlcGxhY2UoJ3tyZS5ERH0nLCByZUREKTsKICAgICAgICAgICAgc2V0TmFtZSA9IHNldE5hbWUucmVwbGFjZSgne3JlLkhIfScsIHJlSEgpOwogICAgICAgICAgICBzZXROYW1lID0gc2V0TmFtZS5yZXBsYWNlKCd7cmUubW19JywgcmVtbSk7CiAgICAgICAgICAgIHNldE5hbWUgPSBzZXROYW1lLnJlcGxhY2UoJ3tyZS5zc30nLCByZXNzKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHNldE5hbWUucmVwbGFjZSgvWzx8PnwqfCJ8XC98XHw6fD98XG5dL2csICdfJyk7CiAgICB9CgogICAgZnVuY3Rpb24gaGFuZGxlRG93bmxvYWRMaXN0KGRvd25sb2FkTGlzdCwgcGFja05hbWUpIHsKICAgICAgICBpZiAoR01fZ2V0VmFsdWUoJ2FyaWFNb2RlJywgZmFsc2UpKSB7CiAgICAgICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBkb3dubG9hZExpc3QpIHsKICAgICAgICAgICAgICAgIHNlbmQyQXJpYTJjKGl0ZW0udXJsLCBpdGVtLm5hbWUsIGl0ZW0uaGVhZGVyRmxhZyk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKEdNX2dldFZhbHVlKCd6aXBNb2RlJywgZmFsc2UpKSB7CiAgICAgICAgICAgIGxldCB6aXAgPSBuZXcgSlNaaXAoKTsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3ppcCcsIHppcCk7CiAgICAgICAgICAgIGxldCBwcm9taXNlcyA9IGRvd25sb2FkTGlzdC5tYXAoYXN5bmMgZnVuY3Rpb24oZWxlLCBpZHgpIHsKICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCBkb3dubG9hZFdyYXBwZXIoZWxlLnVybCwgZWxlLm5hbWUsIGVsZS5oZWFkZXJGbGFnLCB0cnVlKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhlbGUsIGlkeCwgJ2RhdGEnLCBkYXRhKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyRGF0ZSA9IG5ldyBEYXRlKCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZVdpdGhPZmZzZXQgPSBuZXcgRGF0ZShjdXJyRGF0ZS5nZXRUaW1lKCkgLSBjdXJyRGF0ZS5nZXRUaW1lem9uZU9mZnNldCgpICogNjAwMDApOwogICAgICAgICAgICAgICAgICAgIGlmIChkYXRhKSB6aXAuZmlsZShkb3dubG9hZExpc3RbaWR4XS5uYW1lLCBkYXRhLCB7IGRhdGU6IGRhdGVXaXRoT2Zmc2V0IH0pOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygncHJvbWlzZXMnLCBwcm9taXNlcyk7CiAgICAgICAgICAgIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGFzeW5jIGZ1bmN0aW9uKHJlc3BvbnNlTGlzdCkgewogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3Jlc3BvbnNlTGlzdCcsIHJlc3BvbnNlTGlzdCk7CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnemlwJywgemlwKTsKICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdnZW5lcmF0ZUFzeW5jJywgemlwLmdlbmVyYXRlQXN5bmMoKSk7CiAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgemlwLmdlbmVyYXRlQXN5bmMoeyB0eXBlOiAnYmxvYicsIHN0cmVhbUZpbGVzOiB0cnVlIH0vKiwgZnVuY3Rpb24oeyBwZXJjZW50LCBjdXJyZW50RmlsZSB9KSB7IGNvbnNvbGUubG9nKHBlcmNlbnQpOyB9Ki8pOwogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2NvbnRlbnQnLCBjb250ZW50KTsKICAgICAgICAgICAgICAgIGlmICh6aXAuZmlsZXMgJiYgT2JqZWN0LmtleXMoemlwLmZpbGVzKS5sZW5ndGggPiAwKSBzYXZlQXMoY29udGVudCwgcGFja05hbWUpOwogICAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgZG93bmxvYWRMaXN0KSB7CiAgICAgICAgICAgICAgICBkb3dubG9hZFdyYXBwZXIoaXRlbS51cmwsIGl0ZW0ubmFtZSwgaXRlbS5oZWFkZXJGbGFnKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBhc3luYyBmdW5jdGlvbiBoYW5kbGVWaWRlbyhtZWRpYUluZm8sIHBhZExlbmd0aCwgdXNlck5hbWUsIHVzZXJJZCwgcG9zdElkLCBwb3N0VWlkLCBpbmRleCwgcG9zdFRpbWUsIHRleHQsIHJldHdlZXRQb3N0SWQsIHJldHdlZXRVc2VyTmFtZSwgcmV0d2VldFVzZXJJZCwgcmV0d2VldFBvc3RVaWQsIHJldHdlZXRQb3N0VGltZSwgcmV0d2VldFRleHQpIHsKICAgICAgICBjb25zdCBuZXdMaXN0ID0gW107CiAgICAgICAgbGV0IGxhcmdlVmlkVXJsID0gbWVkaWFJbmZvLnBsYXliYWNrX2xpc3QgPyBtZWRpYUluZm8ucGxheWJhY2tfbGlzdFswXS5wbGF5X2luZm8udXJsIDogKCBtZWRpYUluZm8ubXA0X2hkX3VybCB8fCBtZWRpYUluZm8uc3RyZWFtX3VybF9oZCB8fCBtZWRpYUluZm8uc3RyZWFtX3VybCApOwogICAgICAgIGlmKG1lZGlhSW5mby5oYXNPd25Qcm9wZXJ0eSgnaDVfdXJsJykgJiYgbWVkaWFJbmZvLmg1X3VybCkgewogICAgICAgICAgICBjb25zdCB1cmxPYmogPSBuZXcgVVJMKG1lZGlhSW5mby5oNV91cmwpOyAvLyBlLmcuICdodHRwczovL3ZpZGVvLndlaWJvLmNvbS9zaG93P2ZpZD0xMDM0OjQ5MjQ1MTE0Mzk3NDkxMzknCiAgICAgICAgICAgIGNvbnN0IGZpZCA9IHVybE9iai5zZWFyY2hQYXJhbXMuZ2V0KCdmaWQnKTsKICAgICAgICAgICAgbGV0IHVybCA9ICdodHRwczovLycgKyBsb2NhdGlvbi5ob3N0ICsgJy90di9hcGkvY29tcG9uZW50P3BhZ2U9L3R2L3Nob3cvJyArIGZpZDsgLy8gZS5nLiAnaHR0cHM6Ly93ZWliby5jb20vdHYvYXBpL2NvbXBvbmVudD9wYWdlPS90di9zaG93LzEwMzQ6NDkyNDUxMTQzOTc0OTEzOScKICAgICAgICAgICAgLy8gbGV0IHVybCA9ICdodHRwczovL2g1LnZpZGVvLndlaWJvLmNvbS9hcGkvY29tcG9uZW50P3BhZ2U9L3Nob3cvJyArIGZpZDsgLy8gZS5nLiAnaHR0cHM6Ly9oNS52aWRlby53ZWliby5jb20vYXBpL2NvbXBvbmVudD9wYWdlPS9zaG93LzEwMzQ6NTA3MDU3Mjc5NTY1ODMxOScKICAgICAgICAgICAgbGV0IGRhdGEgPSAnZGF0YT17IkNvbXBvbmVudF9QbGF5X1BsYXlpbmZvIjp7Im9pZCI6IicgKyBmaWQgKyAnIn19JzsgLy8gZS5nLiAnZGF0YT17IkNvbXBvbmVudF9QbGF5X1BsYXlpbmZvIjp7Im9pZCI6IjEwMzQ6NDkyNDUxMTQzOTc0OTEzOSJ9fScKICAgICAgICAgICAgLy8gY29uc29sZS5sb2codXJsLCBkYXRhKTsKICAgICAgICAgICAgbGV0IHR2UmVzID0gYXdhaXQgZ21IdHRwUmVxdWVzdCh1cmwsICdQT1NUJywgZGF0YSk7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHR2UmVzKTsKICAgICAgICAgICAgaWYodHZSZXMgJiYgdHZSZXMuZGF0YSAmJiB0dlJlcy5kYXRhLkNvbXBvbmVudF9QbGF5X1BsYXlpbmZvICYmIHR2UmVzLmRhdGEuQ29tcG9uZW50X1BsYXlfUGxheWluZm8udXJscyAmJiBPYmplY3Qua2V5cyh0dlJlcy5kYXRhLkNvbXBvbmVudF9QbGF5X1BsYXlpbmZvLnVybHMpLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIGxhcmdlVmlkVXJsID0gdHZSZXMuZGF0YS5Db21wb25lbnRfUGxheV9QbGF5aW5mby51cmxzW09iamVjdC5rZXlzKHR2UmVzLmRhdGEuQ29tcG9uZW50X1BsYXlfUGxheWluZm8udXJscylbMF1dOwogICAgICAgICAgICAgICAgaWYobGFyZ2VWaWRVcmwuc3RhcnRzV2l0aCgnLy8nKSkgewogICAgICAgICAgICAgICAgICAgIGxhcmdlVmlkVXJsID0gJ2h0dHA6JyArIGxhcmdlVmlkVXJsOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC8vIGNvbnNvbGUubG9nKGxhcmdlVmlkVXJsKTsKICAgICAgICBsZXQgdmlkTmFtZSA9IGxhcmdlVmlkVXJsLnNwbGl0KCc/JylbMF07CiAgICAgICAgdmlkTmFtZSA9IHZpZE5hbWUuc3BsaXQoJy8nKVt2aWROYW1lLnNwbGl0KCcvJykubGVuZ3RoIC0gMV0uc3BsaXQoJz8nKVswXTsKICAgICAgICBsZXQgb3JpZ2luYWxOYW1lID0gdmlkTmFtZS5zcGxpdCgnLicpWzBdOwogICAgICAgIGxldCBleHQgPSB2aWROYW1lLnNwbGl0KCcuJylbMV07CiAgICAgICAgY29uc3Qgc2V0TmFtZSA9IGdldE5hbWUoKEdNX2dldFZhbHVlKCdyZXR3ZWV0TW9kZScsIGZhbHNlKSAmJiByZXR3ZWV0UG9zdElkKSA/IEdNX2dldFZhbHVlKCdyZXR3ZWV0RmlsZU5hbWUnLCAne29yaWdpbmFsfS57ZXh0fScpIDogR01fZ2V0VmFsdWUoJ2RsRmlsZU5hbWUnLCAne29yaWdpbmFsfS57ZXh0fScpLCBvcmlnaW5hbE5hbWUsIGV4dCwgdXNlck5hbWUsIHVzZXJJZCwgcG9zdElkLCBwb3N0VWlkLCBpbmRleC50b1N0cmluZygpLnBhZFN0YXJ0KHBhZExlbmd0aCwgJzAnKSwgcG9zdFRpbWUsIHRleHQsIHJldHdlZXRQb3N0SWQsIHJldHdlZXRVc2VyTmFtZSwgcmV0d2VldFVzZXJJZCwgcmV0d2VldFBvc3RVaWQsIHJldHdlZXRQb3N0VGltZSwgcmV0d2VldFRleHQpOwogICAgICAgIG5ld0xpc3QucHVzaCh7IHVybDogbGFyZ2VWaWRVcmwsIG5hbWU6IHNldE5hbWUsIGhlYWRlckZsYWc6IHRydWUgfSk7CiAgICAgICAgaWYoR01fZ2V0VmFsdWUoJ2RsVmlkQ292JywgdHJ1ZSkgJiYgbWVkaWFJbmZvLmhhc093blByb3BlcnR5KCdiaWdfcGljX2luZm8nKSkgewogICAgICAgICAgICBsZXQgcGljVXJsID0gbWVkaWFJbmZvLmJpZ19waWNfaW5mby5waWNfYmlnLnVybDsKICAgICAgICAgICAgbGV0IGxhcmdlUGljVXJsID0gcGljVXJsLnJlcGxhY2UoJy9vcmo0ODAvJywgR01fZ2V0VmFsdWUoJ3JtV3RyTXJrJywgZmFsc2UpID8gJy9vc2xhcmdlLycgOiAnL2xhcmdlLycpOwogICAgICAgICAgICBsZXQgcGljTmFtZSA9IGxhcmdlUGljVXJsLnNwbGl0KCcvJylbbGFyZ2VQaWNVcmwuc3BsaXQoJy8nKS5sZW5ndGggLSAxXS5zcGxpdCgnPycpWzBdOwogICAgICAgICAgICBsZXQgb3JpZ2luYWxOYW1lID0gcGljTmFtZS5zcGxpdCgnLicpWzBdOwogICAgICAgICAgICBsZXQgZXh0ID0gcGljTmFtZS5zcGxpdCgnLicpWzFdOwogICAgICAgICAgICBjb25zdCBzZXROYW1lID0gZ2V0TmFtZSgoR01fZ2V0VmFsdWUoJ3JldHdlZXRNb2RlJywgZmFsc2UpICYmIHJldHdlZXRQb3N0SWQpID8gR01fZ2V0VmFsdWUoJ3JldHdlZXRGaWxlTmFtZScsICd7b3JpZ2luYWx9LntleHR9JykgOiBHTV9nZXRWYWx1ZSgnZGxGaWxlTmFtZScsICd7b3JpZ2luYWx9LntleHR9JyksIG9yaWdpbmFsTmFtZSwgZXh0LCB1c2VyTmFtZSwgdXNlcklkLCBwb3N0SWQsIHBvc3RVaWQsIGluZGV4LnRvU3RyaW5nKCkucGFkU3RhcnQocGFkTGVuZ3RoLCAnMCcpLCBwb3N0VGltZSwgdGV4dCwgcmV0d2VldFBvc3RJZCwgcmV0d2VldFVzZXJOYW1lLCByZXR3ZWV0VXNlcklkLCByZXR3ZWV0UG9zdFVpZCwgcmV0d2VldFBvc3RUaW1lLCByZXR3ZWV0VGV4dCk7CiAgICAgICAgICAgIG5ld0xpc3QucHVzaCh7dXJsOiBsYXJnZVBpY1VybCwgbmFtZTogc2V0TmFtZSwgaGVhZGVyRmxhZzogdHJ1ZSB9KTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ld0xpc3Q7CiAgICB9CgogICAgZnVuY3Rpb24gaGFuZGxlUGljKHBpYywgcGFkTGVuZ3RoLCB1c2VyTmFtZSwgdXNlcklkLCBwb3N0SWQsIHBvc3RVaWQsIGluZGV4LCBwb3N0VGltZSwgdGV4dCwgcmV0d2VldFBvc3RJZCwgcmV0d2VldFVzZXJOYW1lLCByZXR3ZWV0VXNlcklkLCByZXR3ZWV0UG9zdFVpZCwgcmV0d2VldFBvc3RUaW1lLCByZXR3ZWV0VGV4dCkgewogICAgICAgIGxldCBuZXdMaXN0ID0gW107CiAgICAgICAgbGV0IHBpY1VybCA9IHBpYy5sYXJnZXN0Py51cmwgfHwgcGljLnBpY19iaWc/LnVybDsKICAgICAgICBsZXQgcGljU2l6ZSA9IHBpY1VybC5zcGxpdCgnLycpWzNdOwogICAgICAgIGxldCBsYXJnZVBpY1VybCA9IHBpY1VybC5yZXBsYWNlKCcvJyArIHBpY1NpemUgKyAnLycsIEdNX2dldFZhbHVlKCdybVd0ck1yaycsIGZhbHNlKSA/ICcvb3NsYXJnZS8nIDogJy9sYXJnZS8nKTsKICAgICAgICBsZXQgcGljTmFtZSA9IGxhcmdlUGljVXJsLnNwbGl0KCcvJylbbGFyZ2VQaWNVcmwuc3BsaXQoJy8nKS5sZW5ndGggLSAxXS5zcGxpdCgnPycpWzBdOwogICAgICAgIGxldCBvcmlnaW5hbE5hbWUgPSBwaWNOYW1lLnNwbGl0KCcuJylbMF07CiAgICAgICAgbGV0IGV4dCA9IHBpY05hbWUuc3BsaXQoJy4nKVsxXTsKICAgICAgICBjb25zdCBzZXROYW1lID0gZ2V0TmFtZSgoR01fZ2V0VmFsdWUoJ3JldHdlZXRNb2RlJywgZmFsc2UpICYmIHJldHdlZXRQb3N0SWQpID8gR01fZ2V0VmFsdWUoJ3JldHdlZXRGaWxlTmFtZScsICd7b3JpZ2luYWx9LntleHR9JykgOiBHTV9nZXRWYWx1ZSgnZGxGaWxlTmFtZScsICd7b3JpZ2luYWx9LntleHR9JyksIG9yaWdpbmFsTmFtZSwgZXh0LCB1c2VyTmFtZSwgdXNlcklkLCBwb3N0SWQsIHBvc3RVaWQsIGluZGV4LnRvU3RyaW5nKCkucGFkU3RhcnQocGFkTGVuZ3RoLCAnMCcpLCBwb3N0VGltZSwgdGV4dCwgcmV0d2VldFBvc3RJZCwgcmV0d2VldFVzZXJOYW1lLCByZXR3ZWV0VXNlcklkLCByZXR3ZWV0UG9zdFVpZCwgcmV0d2VldFBvc3RUaW1lLCByZXR3ZWV0VGV4dCk7CiAgICAgICAgbmV3TGlzdC5wdXNoKHsgdXJsOiBsYXJnZVBpY1VybCwgbmFtZTogc2V0TmFtZSwgaGVhZGVyRmxhZzogdHJ1ZSB9KTsKICAgICAgICBpZihwaWMuaGFzT3duUHJvcGVydHkoJ3ZpZGVvJykpIHsKICAgICAgICAgICAgbGV0IHZpZGVvVXJsID0gcGljLnZpZGVvOwogICAgICAgICAgICBsZXQgdmlkZW9OYW1lID0gdmlkZW9Vcmwuc3BsaXQoJyUyRicpW3ZpZGVvVXJsLnNwbGl0KCclMkYnKS5sZW5ndGggLSAxXS5zcGxpdCgnPycpWzBdOwogICAgICAgICAgICB2aWRlb05hbWUgPSB2aWRlb05hbWUuc3BsaXQoJy8nKVt2aWRlb05hbWUuc3BsaXQoJy8nKS5sZW5ndGggLSAxXS5zcGxpdCgnPycpWzBdOwogICAgICAgICAgICBpZiAoIXZpZGVvTmFtZS5pbmNsdWRlcygnLicpKSB2aWRlb05hbWUgPSB2aWRlb1VybC5zcGxpdCgnLycpW3ZpZGVvVXJsLnNwbGl0KCcvJykubGVuZ3RoIC0gMV0uc3BsaXQoJz8nKVswXTsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2codmlkZW9VcmwsIHZpZGVvTmFtZSk7CiAgICAgICAgICAgIGxldCBvcmlnaW5hbE5hbWUgPSB2aWRlb05hbWUuc3BsaXQoJy4nKVswXTsKICAgICAgICAgICAgbGV0IGV4dCA9IHZpZGVvTmFtZS5zcGxpdCgnLicpWzFdOwogICAgICAgICAgICBjb25zdCBzZXROYW1lID0gZ2V0TmFtZSgoR01fZ2V0VmFsdWUoJ3JldHdlZXRNb2RlJywgZmFsc2UpICYmIHJldHdlZXRQb3N0SWQpID8gR01fZ2V0VmFsdWUoJ3JldHdlZXRGaWxlTmFtZScsICd7b3JpZ2luYWx9LntleHR9JykgOiBHTV9nZXRWYWx1ZSgnZGxGaWxlTmFtZScsICd7b3JpZ2luYWx9LntleHR9JyksIG9yaWdpbmFsTmFtZSwgZXh0LCB1c2VyTmFtZSwgdXNlcklkLCBwb3N0SWQsIHBvc3RVaWQsIGluZGV4LnRvU3RyaW5nKCkucGFkU3RhcnQocGFkTGVuZ3RoLCAnMCcpLCBwb3N0VGltZSwgdGV4dCwgcmV0d2VldFBvc3RJZCwgcmV0d2VldFVzZXJOYW1lLCByZXR3ZWV0VXNlcklkLCByZXR3ZWV0UG9zdFVpZCwgcmV0d2VldFBvc3RUaW1lLCByZXR3ZWV0VGV4dCk7CiAgICAgICAgICAgIG5ld0xpc3QucHVzaCh7IHVybDogdmlkZW9VcmwsIG5hbWU6IHNldE5hbWUsIGhlYWRlckZsYWc6IHRydWUgfSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBuZXdMaXN0OwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZERsQnRuKGZvb3RlcikgewogICAgICAgIC8vIGNvbnNvbGUubG9nKCdhZGQgZG93bmxvYWQgYnV0dG9uJyk7CiAgICAgICAgbGV0IGRsQnRuRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgZGxCdG5EaXYuY2xhc3NOYW1lID0gJ3dvby1ib3gtaXRlbS1mbGV4IHRvb2xiYXJfaXRlbV8xa3lfRCB0b29sYmFyX2N1cnNvcl8zNGo1Vic7CiAgICAgICAgbGV0IGRpdkluRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgZGl2SW5EaXYuY2xhc3NOYW1lID0gJ3dvby1ib3gtZmxleCB3b28tYm94LWFsaWduQ2VudGVyIHdvby1ib3gtanVzdGlmeUNlbnRlciB0b29sYmFyX2xpa2VfMjB5UEkgdG9vbGJhcl9saWtlYm94XzFyTGZaIHRvb2xiYXJfd3JhcF9ucDZVZyc7CiAgICAgICAgbGV0IGRsQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgZGxCdG4uY2xhc3NOYW1lID0gJ3dvby1saWtlLW1haW4gdG9vbGJhcl9idG5fQ2c5dHogZG93bmxvYWQtYnV0dG9uJzsKICAgICAgICBkbEJ0bi5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJzAnKTsKICAgICAgICBkbEJ0bi5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgJ+S4i+i9vScpOwogICAgICAgIC8vIGRsQnRuLmlubmVySFRNTCA9ICc8c3BhbiBjbGFzcz0id29vLWxpa2UtaWNvbldyYXAiPjxzdmcgY2xhc3M9Indvby1saWtlLWljb24iPjx1c2UgeGxpbms6aHJlZj0iI3dvb19zdmdfZG93bmxvYWQiPjwvdXNlPjwvc3ZnPjwvc3Bhbj48c3BhbiBjbGFzcz0id29vLWxpa2UtY291bnQiPuS4i+i9vTwvc3Bhbj4nOwogICAgICAgIGRsQnRuLmlubmVySFRNTCA9ICc8c3BhbiBjbGFzcz0id29vLWxpa2UtaWNvbldyYXAiPjxpIGNsYXNzPSJ3b28tZm9udCB3b28tZm9udC0taW1nU2F2ZSB3b28tbGlrZS1pY29uIj48L2k+PC9zcGFuPjxzcGFuIGNsYXNzPSJ3b28tbGlrZS1jb3VudCI+5LiL6L29PC9zcGFuPic7CiAgICAgICAgZGxCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICBjb25zdCBhcnRpY2xlID0gdGhpcy5jbG9zZXN0KCdhcnRpY2xlLndvby1wYW5lbC1tYWluJyk7CiAgICAgICAgICAgIGlmKGFydGljbGUpIHsKICAgICAgICAgICAgICAgIC8vIGxldCBjb250ZW50Um93ID0gYXJ0aWNsZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjb250ZW50X3Jvd18tcjVUaycpWzBdOwogICAgICAgICAgICAgICAgY29uc3QgaGVhZGVyID0gYXJ0aWNsZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZGVyJylbMF07CiAgICAgICAgICAgICAgICBjb25zdCBwb3N0TGluayA9IGhlYWRlci5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdoZWFkLWluZm9fdGltZV82c0ZRZycpWzBdOwogICAgICAgICAgICAgICAgbGV0IHBvc3RJZCA9IHBvc3RMaW5rLmhyZWYuc3BsaXQoJy8nKVtwb3N0TGluay5ocmVmLnNwbGl0KCcvJykubGVuZ3RoIC0gMV07CiAgICAgICAgICAgICAgICBjb25zdCByZXNKc29uID0gYXdhaXQgaHR0cFJlcXVlc3QoJ2h0dHBzOi8vJyArIGxvY2F0aW9uLmhvc3QgKyAnL2FqYXgvc3RhdHVzZXMvc2hvdz9pZD0nICsgcG9zdElkKTsKICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlc0pzb24pOwogICAgICAgICAgICAgICAgbGV0IHN0YXR1cyA9IHJlc0pzb247CiAgICAgICAgICAgICAgICBsZXQgcmV0d2VldFBvc3RJZCwgcmV0d2VldFVzZXJOYW1lLCByZXR3ZWV0VXNlcklkLCByZXR3ZWV0UG9zdFVpZCwgcmV0d2VldFBvc3RUaW1lLCByZXR3ZWV0VGV4dDsKICAgICAgICAgICAgICAgIGlmKHJlc0pzb24uaGFzT3duUHJvcGVydHkoJ3JldHdlZXRlZF9zdGF0dXMnKSkgewogICAgICAgICAgICAgICAgICAgIHN0YXR1cyA9IHJlc0pzb24ucmV0d2VldGVkX3N0YXR1czsKICAgICAgICAgICAgICAgICAgICByZXR3ZWV0UG9zdElkID0gcmVzSnNvbi5tYmxvZ2lkOwogICAgICAgICAgICAgICAgICAgIHJldHdlZXRVc2VyTmFtZSA9IHJlc0pzb24udXNlci5zY3JlZW5fbmFtZTsKICAgICAgICAgICAgICAgICAgICByZXR3ZWV0VXNlcklkID0gcmVzSnNvbi51c2VyLmlkc3RyOwogICAgICAgICAgICAgICAgICAgIHJldHdlZXRQb3N0VWlkID0gcmVzSnNvbi5pZHN0cjsKICAgICAgICAgICAgICAgICAgICByZXR3ZWV0UG9zdFRpbWUgPSByZXNKc29uLmNyZWF0ZWRfYXQ7CiAgICAgICAgICAgICAgICAgICAgcmV0d2VldFRleHQgPSByZXNKc29uLnRleHRfcmF3OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcG9zdElkID0gc3RhdHVzLm1ibG9naWQ7CiAgICAgICAgICAgICAgICBjb25zdCBwaWNJbmZvcyA9IHN0YXR1cy5waWNfaW5mb3M7CiAgICAgICAgICAgICAgICBjb25zdCBtaXhNZWRpYUluZm8gPSBzdGF0dXMubWl4X21lZGlhX2luZm87CiAgICAgICAgICAgICAgICBjb25zdCB1c2VyTmFtZSA9IHN0YXR1cy51c2VyLnNjcmVlbl9uYW1lOwogICAgICAgICAgICAgICAgY29uc3QgdXNlcklkID0gc3RhdHVzLnVzZXIuaWRzdHI7CiAgICAgICAgICAgICAgICBjb25zdCBwb3N0VWlkID0gc3RhdHVzLmlkc3RyOwogICAgICAgICAgICAgICAgY29uc3QgcG9zdFRpbWUgPSBzdGF0dXMuY3JlYXRlZF9hdDsKICAgICAgICAgICAgICAgIGNvbnN0IHRleHQgPSBzdGF0dXMudGV4dF9yYXc7CiAgICAgICAgICAgICAgICBsZXQgZG93bmxvYWRMaXN0ID0gW107CiAgICAgICAgICAgICAgICBpZihmb290ZXIucGFyZW50RWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgndmlkZW8nKS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2Rvd25sb2FkIHZpZGVvJyk7CiAgICAgICAgICAgICAgICAgICAgaWYocmVzSnNvbi5wYWdlX2luZm8/Lm1lZGlhX2luZm8pIHsKICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRMaXN0ID0gZG93bmxvYWRMaXN0LmNvbmNhdChhd2FpdCBoYW5kbGVWaWRlbyhyZXNKc29uLnBhZ2VfaW5mby5tZWRpYV9pbmZvLCAxLCB1c2VyTmFtZSwgdXNlcklkLCBwb3N0SWQsIHBvc3RVaWQsIDEsIHBvc3RUaW1lLCB0ZXh0LCByZXR3ZWV0UG9zdElkLCByZXR3ZWV0VXNlck5hbWUsIHJldHdlZXRVc2VySWQsIHJldHdlZXRQb3N0VWlkLCByZXR3ZWV0UG9zdFRpbWUsIHJldHdlZXRUZXh0KSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC8qaWYocmVzSnNvbi5wYWdlX2luZm8/LnBpY19pbmZvICYmIEdNX2dldFZhbHVlKCdkbFZpZENvdicsIHRydWUpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkTGlzdCA9IGRvd25sb2FkTGlzdC5jb25jYXQoaGFuZGxlUGljKHJlc0pzb24ucGFnZV9pbmZvLnBpY19pbmZvLCAxLCB1c2VyTmFtZSwgdXNlcklkLCBwb3N0SWQsIHBvc3RVaWQsIDEsIHBvc3RUaW1lLCB0ZXh0LCByZXR3ZWV0UG9zdElkLCByZXR3ZWV0VXNlck5hbWUsIHJldHdlZXRVc2VySWQsIHJldHdlZXRQb3N0VWlkLCByZXR3ZWV0UG9zdFRpbWUsIHJldHdlZXRUZXh0KSk7CiAgICAgICAgICAgICAgICAgICAgfSovCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAocGljSW5mb3MpIHsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnZG93bmxvYWQgaW1hZ2VzJyk7CiAgICAgICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gMDsKICAgICAgICAgICAgICAgICAgICBsZXQgcGFkTGVuZ3RoID0gT2JqZWN0LmVudHJpZXMocGljSW5mb3MpLmxlbmd0aC50b1N0cmluZygpLmxlbmd0aDsKICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtpZCwgcGljXSBvZiBPYmplY3QuZW50cmllcyhwaWNJbmZvcykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggKz0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRMaXN0ID0gZG93bmxvYWRMaXN0LmNvbmNhdChoYW5kbGVQaWMocGljLCBwYWRMZW5ndGgsIHVzZXJOYW1lLCB1c2VySWQsIHBvc3RJZCwgcG9zdFVpZCwgaW5kZXgsIHBvc3RUaW1lLCB0ZXh0LCByZXR3ZWV0UG9zdElkLCByZXR3ZWV0VXNlck5hbWUsIHJldHdlZXRVc2VySWQsIHJldHdlZXRQb3N0VWlkLCByZXR3ZWV0UG9zdFRpbWUsIHJldHdlZXRUZXh0KSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1peE1lZGlhSW5mbyAmJiBtaXhNZWRpYUluZm8uaXRlbXMpIHsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnbWl4IG1lZGlhJyk7CiAgICAgICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gMDsKICAgICAgICAgICAgICAgICAgICBsZXQgcGFkTGVuZ3RoID0gT2JqZWN0LmVudHJpZXMobWl4TWVkaWFJbmZvLml0ZW1zKS5sZW5ndGgudG9TdHJpbmcoKS5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBbaWQsIG1lZGlhXSBvZiBPYmplY3QuZW50cmllcyhtaXhNZWRpYUluZm8uaXRlbXMpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ICs9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKG1lZGlhLnR5cGUgPT09ICd2aWRlbycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkTGlzdCA9IGRvd25sb2FkTGlzdC5jb25jYXQoYXdhaXQgaGFuZGxlVmlkZW8obWVkaWEuZGF0YS5tZWRpYV9pbmZvLCBwYWRMZW5ndGgsIHVzZXJOYW1lLCB1c2VySWQsIHBvc3RJZCwgcG9zdFVpZCwgaW5kZXgsIHBvc3RUaW1lLCB0ZXh0LCByZXR3ZWV0UG9zdElkLCByZXR3ZWV0VXNlck5hbWUsIHJldHdlZXRVc2VySWQsIHJldHdlZXRQb3N0VWlkLCByZXR3ZWV0UG9zdFRpbWUsIHJldHdlZXRUZXh0KSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoR01fZ2V0VmFsdWUoJ2RsVmlkQ292JywgdHJ1ZSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb3dubG9hZExpc3QgPSBkb3dubG9hZExpc3QuY29uY2F0KGhhbmRsZVBpYyhtZWRpYS5kYXRhLnBpY19pbmZvLCBwYWRMZW5ndGgsIHVzZXJOYW1lLCB1c2VySWQsIHBvc3RJZCwgcG9zdFVpZCwgaW5kZXgsIHBvc3RUaW1lLCB0ZXh0LCByZXR3ZWV0UG9zdElkLCByZXR3ZWV0VXNlck5hbWUsIHJldHdlZXRVc2VySWQsIHJldHdlZXRQb3N0VWlkLCByZXR3ZWV0UG9zdFRpbWUsIHJldHdlZXRUZXh0KSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWVkaWEudHlwZSA9PT0gJ3BpYycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkTGlzdCA9IGRvd25sb2FkTGlzdC5jb25jYXQoaGFuZGxlUGljKG1lZGlhLmRhdGEsIHBhZExlbmd0aCwgdXNlck5hbWUsIHVzZXJJZCwgcG9zdElkLCBwb3N0VWlkLCBpbmRleCwgcG9zdFRpbWUsIHRleHQsIHJldHdlZXRQb3N0SWQsIHJldHdlZXRVc2VyTmFtZSwgcmV0d2VldFVzZXJJZCwgcmV0d2VldFBvc3RVaWQsIHJldHdlZXRQb3N0VGltZSwgcmV0d2VldFRleHQpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnN0IHBhY2tOYW1lID0gZ2V0TmFtZSgoR01fZ2V0VmFsdWUoJ3JldHdlZXRNb2RlJywgZmFsc2UpICYmIHJldHdlZXRQb3N0SWQpID8gR01fZ2V0VmFsdWUoJ3JldHdlZXRQYWNrRmlsZU5hbWUnLCAne21ibG9naWR9LnppcCcpIDogR01fZ2V0VmFsdWUoJ3BhY2tGaWxlTmFtZScsICd7bWJsb2dpZH0uemlwJyksICd7b3JpZ2luYWx9JywgJ3tleHR9JywgdXNlck5hbWUsIHVzZXJJZCwgcG9zdElkLCBwb3N0VWlkLCAne2luZGV4fScsIHBvc3RUaW1lLCB0ZXh0LCByZXR3ZWV0UG9zdElkLCByZXR3ZWV0VXNlck5hbWUsIHJldHdlZXRVc2VySWQsIHJldHdlZXRQb3N0VWlkLCByZXR3ZWV0UG9zdFRpbWUsIHJldHdlZXRUZXh0KTsKICAgICAgICAgICAgICAgIGhhbmRsZURvd25sb2FkTGlzdChkb3dubG9hZExpc3QsIHBhY2tOYW1lKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIGRpdkluRGl2LmFwcGVuZENoaWxkKGRsQnRuKTsKICAgICAgICBkbEJ0bkRpdi5hcHBlbmRDaGlsZChkaXZJbkRpdik7CiAgICAgICAgZm9vdGVyLmZpcnN0Q2hpbGQuZmlyc3RDaGlsZC5maXJzdENoaWxkLmFwcGVuZENoaWxkKGRsQnRuRGl2KTsKICAgICAgICAvLyBjb25zb2xlLmxvZygnYWRkZWQgZG93bmxvYWQgYnV0dG9uJyk7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkU2luZ2xlRGxCdG4oaW1nLCBpZHggPSAwKSB7CiAgICAgICAgLy8gY29uc29sZS5sb2coaW1nKTsKICAgICAgICBjb25zdCBpbWdDdG4gPSBpbWcucGFyZW50RWxlbWVudDsKICAgICAgICBjb25zdCBkbEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIGRsQnRuLnN0eWxlLmNvbG9yID0gJ2RpbWdyYXknOwogICAgICAgIGRsQnRuLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJzsKICAgICAgICBkbEJ0bi5zdHlsZS5ib3R0b20gPSAnMCc7CiAgICAgICAgZGxCdG4uc3R5bGUubGVmdCA9ICcwJzsKICAgICAgICBkbEJ0bi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjQpJzsKICAgICAgICBkbEJ0bi5zdHlsZS5wYWRkaW5nID0gJzAuM3JlbSc7CiAgICAgICAgZGxCdG4uc3R5bGUuYm9yZGVyUmFkaXVzID0gJzAgOHB4JzsKICAgICAgICBkbEJ0bi5zdHlsZS53aWR0aCA9ICcxcmVtJzsKICAgICAgICBkbEJ0bi5zdHlsZS5oZWlnaHQgPSAnMXJlbSc7CiAgICAgICAgZGxCdG4uc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInOwogICAgICAgIGRsQnRuLnN0eWxlLnpJbmRleCA9ICcxMSc7CiAgICAgICAgZGxCdG4uaW5uZXJIVE1MID0gJzxpIGNsYXNzPSJ3b28tZm9udCB3b28tZm9udC0taW1nU2F2ZSI+PC9pPic7CiAgICAgICAgZGxCdG4uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIChldmVudCkgPT4geyBkbEJ0bi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjgpJzsgZGxCdG4uc3R5bGUuY29sb3IgPSAnYmxhY2snOyB9KTsKICAgICAgICBkbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKGV2ZW50KSA9PiB7IGRsQnRuLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNCknOyBkbEJ0bi5zdHlsZS5jb2xvciA9ICdkaW1ncmF5JzsgfSk7CiAgICAgICAgZGxCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgY29uc3QgYXJ0aWNsZSA9IHRoaXMuY2xvc2VzdCgnYXJ0aWNsZS53b28tcGFuZWwtbWFpbicpOwogICAgICAgICAgICBpZihhcnRpY2xlKSB7CiAgICAgICAgICAgICAgICAvLyBsZXQgY29udGVudFJvdyA9IGFydGljbGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY29udGVudF9yb3dfLXI1VGsnKVswXTsKICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlciA9IGFydGljbGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWRlcicpWzBdOwogICAgICAgICAgICAgICAgY29uc3QgcG9zdExpbmsgPSBoZWFkZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnaGVhZC1pbmZvX3RpbWVfNnNGUWcnKVswXTsKICAgICAgICAgICAgICAgIGxldCBwb3N0SWQgPSBwb3N0TGluay5ocmVmLnNwbGl0KCcvJylbcG9zdExpbmsuaHJlZi5zcGxpdCgnLycpLmxlbmd0aCAtIDFdOwogICAgICAgICAgICAgICAgY29uc3QgcmVzSnNvbiA9IGF3YWl0IGh0dHBSZXF1ZXN0KCdodHRwczovLycgKyBsb2NhdGlvbi5ob3N0ICsgJy9hamF4L3N0YXR1c2VzL3Nob3c/aWQ9JyArIHBvc3RJZCk7CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXNKc29uKTsKICAgICAgICAgICAgICAgIGxldCBzdGF0dXMgPSByZXNKc29uOwogICAgICAgICAgICAgICAgbGV0IHJldHdlZXRQb3N0SWQsIHJldHdlZXRVc2VyTmFtZSwgcmV0d2VldFVzZXJJZCwgcmV0d2VldFBvc3RVaWQsIHJldHdlZXRQb3N0VGltZSwgcmV0d2VldFRleHQ7CiAgICAgICAgICAgICAgICBpZihyZXNKc29uLmhhc093blByb3BlcnR5KCdyZXR3ZWV0ZWRfc3RhdHVzJykpIHsKICAgICAgICAgICAgICAgICAgICBzdGF0dXMgPSByZXNKc29uLnJldHdlZXRlZF9zdGF0dXM7CiAgICAgICAgICAgICAgICAgICAgcmV0d2VldFBvc3RJZCA9IHJlc0pzb24ubWJsb2dpZDsKICAgICAgICAgICAgICAgICAgICByZXR3ZWV0VXNlck5hbWUgPSByZXNKc29uLnVzZXIuc2NyZWVuX25hbWU7CiAgICAgICAgICAgICAgICAgICAgcmV0d2VldFVzZXJJZCA9IHJlc0pzb24udXNlci5pZHN0cjsKICAgICAgICAgICAgICAgICAgICByZXR3ZWV0UG9zdFVpZCA9IHJlc0pzb24uaWRzdHI7CiAgICAgICAgICAgICAgICAgICAgcmV0d2VldFBvc3RUaW1lID0gcmVzSnNvbi5jcmVhdGVkX2F0OwogICAgICAgICAgICAgICAgICAgIHJldHdlZXRUZXh0ID0gcmVzSnNvbi50ZXh0X3JhdzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHBvc3RJZCA9IHN0YXR1cy5tYmxvZ2lkOwogICAgICAgICAgICAgICAgY29uc3QgcGljSW5mb3MgPSBzdGF0dXMucGljX2luZm9zOwogICAgICAgICAgICAgICAgY29uc3QgbWl4TWVkaWFJbmZvID0gc3RhdHVzLm1peF9tZWRpYV9pbmZvOwogICAgICAgICAgICAgICAgY29uc3QgdXNlck5hbWUgPSBzdGF0dXMudXNlci5zY3JlZW5fbmFtZTsKICAgICAgICAgICAgICAgIGNvbnN0IHVzZXJJZCA9IHN0YXR1cy51c2VyLmlkc3RyOwogICAgICAgICAgICAgICAgY29uc3QgcG9zdFVpZCA9IHN0YXR1cy5pZHN0cjsKICAgICAgICAgICAgICAgIGNvbnN0IHBvc3RUaW1lID0gc3RhdHVzLmNyZWF0ZWRfYXQ7CiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gc3RhdHVzLnRleHRfcmF3OwogICAgICAgICAgICAgICAgbGV0IGRvd25sb2FkTGlzdCA9IFtdOwogICAgICAgICAgICAgICAgaWYgKHBpY0luZm9zKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2Rvd25sb2FkIGltYWdlcycpOwogICAgICAgICAgICAgICAgICAgIGxldCBwYWRMZW5ndGggPSBPYmplY3QuZW50cmllcyhwaWNJbmZvcykubGVuZ3RoLnRvU3RyaW5nKCkubGVuZ3RoOwogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGlkeCwgcGljSW5mb3MpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBpYyA9IE9iamVjdC5lbnRyaWVzKHBpY0luZm9zKVtpZHhdWzFdOwogICAgICAgICAgICAgICAgICAgIGRvd25sb2FkTGlzdCA9IGRvd25sb2FkTGlzdC5jb25jYXQoaGFuZGxlUGljKHBpYywgcGFkTGVuZ3RoLCB1c2VyTmFtZSwgdXNlcklkLCBwb3N0SWQsIHBvc3RVaWQsIGlkeCArIDEsIHBvc3RUaW1lLCB0ZXh0LCByZXR3ZWV0UG9zdElkLCByZXR3ZWV0VXNlck5hbWUsIHJldHdlZXRVc2VySWQsIHJldHdlZXRQb3N0VWlkLCByZXR3ZWV0UG9zdFRpbWUsIHJldHdlZXRUZXh0KSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAobWl4TWVkaWFJbmZvICYmIG1peE1lZGlhSW5mby5pdGVtcykgewogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdtaXggbWVkaWEnKTsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhtaXhNZWRpYUluZm8uaXRlbXMpOwogICAgICAgICAgICAgICAgICAgIGxldCBwYWRMZW5ndGggPSBPYmplY3QuZW50cmllcyhtaXhNZWRpYUluZm8uaXRlbXMpLmxlbmd0aC50b1N0cmluZygpLmxlbmd0aDsKICAgICAgICAgICAgICAgICAgICBjb25zdCBtZWRpYSA9IE9iamVjdC5lbnRyaWVzKG1peE1lZGlhSW5mby5pdGVtcylbaWR4XVsxXTsKICAgICAgICAgICAgICAgICAgICBpZihtZWRpYS50eXBlID09PSAndmlkZW8nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkTGlzdCA9IGRvd25sb2FkTGlzdC5jb25jYXQoYXdhaXQgaGFuZGxlVmlkZW8obWVkaWEuZGF0YS5tZWRpYV9pbmZvLCBwYWRMZW5ndGgsIHVzZXJOYW1lLCB1c2VySWQsIHBvc3RJZCwgcG9zdFVpZCwgaWR4ICsgMSwgcG9zdFRpbWUsIHRleHQsIHJldHdlZXRQb3N0SWQsIHJldHdlZXRVc2VyTmFtZSwgcmV0d2VldFVzZXJJZCwgcmV0d2VldFBvc3RVaWQsIHJldHdlZXRQb3N0VGltZSwgcmV0d2VldFRleHQpKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoR01fZ2V0VmFsdWUoJ2RsVmlkQ292JywgdHJ1ZSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkTGlzdCA9IGRvd25sb2FkTGlzdC5jb25jYXQoaGFuZGxlUGljKG1lZGlhLmRhdGEucGljX2luZm8sIHBhZExlbmd0aCwgdXNlck5hbWUsIHVzZXJJZCwgcG9zdElkLCBwb3N0VWlkLCBpZHggKyAxLCBwb3N0VGltZSwgdGV4dCwgcmV0d2VldFBvc3RJZCwgcmV0d2VldFVzZXJOYW1lLCByZXR3ZWV0VXNlcklkLCByZXR3ZWV0UG9zdFVpZCwgcmV0d2VldFBvc3RUaW1lLCByZXR3ZWV0VGV4dCkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtZWRpYS50eXBlID09PSAncGljJykgewogICAgICAgICAgICAgICAgICAgICAgICBkb3dubG9hZExpc3QgPSBkb3dubG9hZExpc3QuY29uY2F0KGhhbmRsZVBpYyhtZWRpYS5kYXRhLCBwYWRMZW5ndGgsIHVzZXJOYW1lLCB1c2VySWQsIHBvc3RJZCwgcG9zdFVpZCwgaWR4ICsgMSwgcG9zdFRpbWUsIHRleHQsIHJldHdlZXRQb3N0SWQsIHJldHdlZXRVc2VyTmFtZSwgcmV0d2VldFVzZXJJZCwgcmV0d2VldFBvc3RVaWQsIHJldHdlZXRQb3N0VGltZSwgcmV0d2VldFRleHQpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25zdCBwYWNrTmFtZSA9IGdldE5hbWUoKEdNX2dldFZhbHVlKCdyZXR3ZWV0TW9kZScsIGZhbHNlKSAmJiByZXR3ZWV0UG9zdElkKSA/IEdNX2dldFZhbHVlKCdyZXR3ZWV0UGFja0ZpbGVOYW1lJywgJ3ttYmxvZ2lkfS56aXAnKSA6IEdNX2dldFZhbHVlKCdwYWNrRmlsZU5hbWUnLCAne21ibG9naWR9LnppcCcpLCAne29yaWdpbmFsfScsICd7ZXh0fScsIHVzZXJOYW1lLCB1c2VySWQsIHBvc3RJZCwgcG9zdFVpZCwgJ3tpbmRleH0nLCBwb3N0VGltZSwgdGV4dCwgcmV0d2VldFBvc3RJZCwgcmV0d2VldFVzZXJOYW1lLCByZXR3ZWV0VXNlcklkLCByZXR3ZWV0UG9zdFVpZCwgcmV0d2VldFBvc3RUaW1lLCByZXR3ZWV0VGV4dCk7CiAgICAgICAgICAgICAgICBoYW5kbGVEb3dubG9hZExpc3QoZG93bmxvYWRMaXN0LCBwYWNrTmFtZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBpbWdDdG4uYXBwZW5kQ2hpbGQoZGxCdG4pOwogICAgfQoKICAgIGZ1bmN0aW9uIHNBZGREbEJ0bihmb290ZXIpIHsKICAgICAgICAvLyBjb25zb2xlLmxvZygnYWRkIGRvd25sb2FkIGJ1dHRvbiBvbiBzZWFyY2gnKTsKICAgICAgICBjb25zdCBsaXMgPSBmb290ZXIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2xpJyk7CiAgICAgICAgZm9yIChjb25zdCBsaSBvZiBsaXMpIHsKICAgICAgICAgICAgbGkuc3R5bGUud2lkdGggPSAnMjUlJzsKICAgICAgICB9CiAgICAgICAgbGV0IGRsQnRuTGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpOwogICAgICAgIGRsQnRuTGkuc3R5bGUud2lkdGggPSAnMjUlJzsKICAgICAgICBsZXQgYUluTGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CiAgICAgICAgYUluTGkuY2xhc3NOYW1lID0gJ3dvby1ib3gtZmxleCB3b28tYm94LWFsaWduQ2VudGVyIHdvby1ib3gtanVzdGlmeUNlbnRlcic7CiAgICAgICAgYUluTGkuc2V0QXR0cmlidXRlKCd0aXRsZScsICfkuIvovb0nKTsKICAgICAgICBhSW5MaS5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCAnamF2YXNjcmlwdDp2b2lkKDApOycpOwogICAgICAgIGxldCBkbEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICAgIGRsQnRuLmNsYXNzTmFtZSA9ICd3b28tbGlrZS1tYWluIHRvb2xiYXJfYnRuIGRvd25sb2FkLWJ1dHRvbic7CiAgICAgICAgZGxCdG4uaW5uZXJIVE1MID0gJzxzcGFuIGNsYXNzPSJ3b28tbGlrZS1pY29uV3JhcCI+PHN2ZyBjbGFzcz0id29vLWxpa2UtaWNvbiI+PHVzZSB4bGluazpocmVmPSIjd29vX3N2Z19kb3dubG9hZCI+PC91c2U+PC9zdmc+PC9zcGFuPjxzcGFuIGNsYXNzPSJ3b28tbGlrZS1jb3VudCI+5LiL6L29PC9zcGFuPic7CiAgICAgICAgYUluTGkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkgeyBldmVudC5wcmV2ZW50RGVmYXVsdCgpOyB9KTsKICAgICAgICBkbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdkb3dubG9hZCcpOwogICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICBjb25zdCBjYXJkV3JhcCA9IHRoaXMuY2xvc2VzdCgnZGl2LmNhcmQtd3JhcCcpOwogICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhjYXJkV3JhcCk7CiAgICAgICAgICAgIGNvbnN0IG1pZCA9IGNhcmRXcmFwLmdldEF0dHJpYnV0ZSgnbWlkJyk7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKG1pZCk7CiAgICAgICAgICAgIGlmKG1pZCkgewogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2h0dHBzOi8vJyArIGxvY2F0aW9uLmhvc3QgKyAnL2FqYXgvc3RhdHVzZXMvc2hvdz9pZD0nICsgbWlkKTsKICAgICAgICAgICAgICAgIGNvbnN0IHJlc0pzb24gPSBhd2FpdCBnbUh0dHBSZXF1ZXN0KCdodHRwczovL3dlaWJvLmNvbS9hamF4L3N0YXR1c2VzL3Nob3c/aWQ9JyArIG1pZCk7CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXNKc29uKTsKICAgICAgICAgICAgICAgIGxldCBzdGF0dXMgPSByZXNKc29uOwogICAgICAgICAgICAgICAgbGV0IHJldHdlZXRQb3N0SWQsIHJldHdlZXRVc2VyTmFtZSwgcmV0d2VldFVzZXJJZCwgcmV0d2VldFBvc3RVaWQsIHJldHdlZXRQb3N0VGltZSwgcmV0d2VldFRleHQ7CiAgICAgICAgICAgICAgICBpZihyZXNKc29uLmhhc093blByb3BlcnR5KCdyZXR3ZWV0ZWRfc3RhdHVzJykpIHsKICAgICAgICAgICAgICAgICAgICBzdGF0dXMgPSByZXNKc29uLnJldHdlZXRlZF9zdGF0dXM7CiAgICAgICAgICAgICAgICAgICAgcmV0d2VldFBvc3RJZCA9IHJlc0pzb24ubWJsb2dpZDsKICAgICAgICAgICAgICAgICAgICByZXR3ZWV0VXNlck5hbWUgPSByZXNKc29uLnVzZXIuc2NyZWVuX25hbWU7CiAgICAgICAgICAgICAgICAgICAgcmV0d2VldFVzZXJJZCA9IHJlc0pzb24udXNlci5pZHN0cjsKICAgICAgICAgICAgICAgICAgICByZXR3ZWV0UG9zdFVpZCA9IHJlc0pzb24uaWRzdHI7CiAgICAgICAgICAgICAgICAgICAgcmV0d2VldFBvc3RUaW1lID0gcmVzSnNvbi5jcmVhdGVkX2F0OwogICAgICAgICAgICAgICAgICAgIHJldHdlZXRUZXh0ID0gcmVzSnNvbi50ZXh0X3JhdzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnN0IHBvc3RJZCA9IHN0YXR1cy5tYmxvZ2lkOwogICAgICAgICAgICAgICAgY29uc3QgcGljSW5mb3MgPSBzdGF0dXMucGljX2luZm9zOwogICAgICAgICAgICAgICAgY29uc3QgbWl4TWVkaWFJbmZvID0gc3RhdHVzLm1peF9tZWRpYV9pbmZvOwogICAgICAgICAgICAgICAgY29uc3QgdXNlck5hbWUgPSBzdGF0dXMudXNlci5zY3JlZW5fbmFtZTsKICAgICAgICAgICAgICAgIGNvbnN0IHVzZXJJZCA9IHN0YXR1cy51c2VyLmlkc3RyOwogICAgICAgICAgICAgICAgY29uc3QgcG9zdFVpZCA9IHN0YXR1cy5pZHN0cjsKICAgICAgICAgICAgICAgIGNvbnN0IHBvc3RUaW1lID0gc3RhdHVzLmNyZWF0ZWRfYXQ7CiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gc3RhdHVzLnRleHRfcmF3OwogICAgICAgICAgICAgICAgbGV0IGRvd25sb2FkTGlzdCA9IFtdOwogICAgICAgICAgICAgICAgaWYoZm9vdGVyLnBhcmVudEVsZW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3ZpZGVvJykubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdkb3dubG9hZCB2aWRlbycpOwogICAgICAgICAgICAgICAgICAgIGlmKHJlc0pzb24ucGFnZV9pbmZvPy5tZWRpYV9pbmZvKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkTGlzdCA9IGRvd25sb2FkTGlzdC5jb25jYXQoYXdhaXQgaGFuZGxlVmlkZW8ocmVzSnNvbi5wYWdlX2luZm8ubWVkaWFfaW5mbywgMSwgdXNlck5hbWUsIHVzZXJJZCwgcG9zdElkLCBwb3N0VWlkLCAxLCBwb3N0VGltZSwgdGV4dCwgcmV0d2VldFBvc3RJZCwgcmV0d2VldFVzZXJOYW1lLCByZXR3ZWV0VXNlcklkLCByZXR3ZWV0UG9zdFVpZCwgcmV0d2VldFBvc3RUaW1lLCByZXR3ZWV0VGV4dCkpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZihyZXNKc29uLnBhZ2VfaW5mbz8ucGljX2luZm8gJiYgR01fZ2V0VmFsdWUoJ2RsVmlkQ292JywgdHJ1ZSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRMaXN0ID0gZG93bmxvYWRMaXN0LmNvbmNhdChoYW5kbGVQaWMocmVzSnNvbi5wYWdlX2luZm8ucGljX2luZm8sIDEsIHVzZXJOYW1lLCB1c2VySWQsIHBvc3RJZCwgcG9zdFVpZCwgMSwgcG9zdFRpbWUsIHRleHQsIHJldHdlZXRQb3N0SWQsIHJldHdlZXRVc2VyTmFtZSwgcmV0d2VldFVzZXJJZCwgcmV0d2VldFBvc3RVaWQsIHJldHdlZXRQb3N0VGltZSwgcmV0d2VldFRleHQpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAocGljSW5mb3MpIHsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnZG93bmxvYWQgaW1hZ2VzJyk7CiAgICAgICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gMDsKICAgICAgICAgICAgICAgICAgICBsZXQgcGFkTGVuZ3RoID0gT2JqZWN0LmVudHJpZXMocGljSW5mb3MpLmxlbmd0aC50b1N0cmluZygpLmxlbmd0aDsKICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtpZCwgcGljXSBvZiBPYmplY3QuZW50cmllcyhwaWNJbmZvcykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggKz0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRMaXN0ID0gZG93bmxvYWRMaXN0LmNvbmNhdChoYW5kbGVQaWMocGljLCBwYWRMZW5ndGgsIHVzZXJOYW1lLCB1c2VySWQsIHBvc3RJZCwgcG9zdFVpZCwgaW5kZXgsIHBvc3RUaW1lLCB0ZXh0LCByZXR3ZWV0UG9zdElkLCByZXR3ZWV0VXNlck5hbWUsIHJldHdlZXRVc2VySWQsIHJldHdlZXRQb3N0VWlkLCByZXR3ZWV0UG9zdFRpbWUsIHJldHdlZXRUZXh0KSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1peE1lZGlhSW5mbyAmJiBtaXhNZWRpYUluZm8uaXRlbXMpIHsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnbWl4IG1lZGlhJyk7CiAgICAgICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gMDsKICAgICAgICAgICAgICAgICAgICBsZXQgcGFkTGVuZ3RoID0gT2JqZWN0LmVudHJpZXMobWl4TWVkaWFJbmZvLml0ZW1zKS5sZW5ndGgudG9TdHJpbmcoKS5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBbaWQsIG1lZGlhXSBvZiBPYmplY3QuZW50cmllcyhtaXhNZWRpYUluZm8uaXRlbXMpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ICs9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKG1lZGlhLnR5cGUgPT09ICd2aWRlbycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkTGlzdCA9IGRvd25sb2FkTGlzdC5jb25jYXQoYXdhaXQgaGFuZGxlVmlkZW8obWVkaWEuZGF0YS5tZWRpYV9pbmZvLCBwYWRMZW5ndGgsIHVzZXJOYW1lLCB1c2VySWQsIHBvc3RJZCwgcG9zdFVpZCwgaW5kZXgsIHBvc3RUaW1lLCB0ZXh0LCByZXR3ZWV0UG9zdElkLCByZXR3ZWV0VXNlck5hbWUsIHJldHdlZXRVc2VySWQsIHJldHdlZXRQb3N0VWlkLCByZXR3ZWV0UG9zdFRpbWUsIHJldHdlZXRUZXh0KSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihHTV9nZXRWYWx1ZSgnZGxWaWRDb3YnLCB0cnVlKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkTGlzdCA9IGRvd25sb2FkTGlzdC5jb25jYXQoaGFuZGxlUGljKG1lZGlhLmRhdGEucGljX2luZm8sIHBhZExlbmd0aCwgdXNlck5hbWUsIHVzZXJJZCwgcG9zdElkLCBwb3N0VWlkLCBpbmRleCwgcG9zdFRpbWUsIHRleHQsIHJldHdlZXRQb3N0SWQsIHJldHdlZXRVc2VyTmFtZSwgcmV0d2VldFVzZXJJZCwgcmV0d2VldFBvc3RVaWQsIHJldHdlZXRQb3N0VGltZSwgcmV0d2VldFRleHQpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtZWRpYS50eXBlID09PSAncGljJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRMaXN0ID0gZG93bmxvYWRMaXN0LmNvbmNhdChoYW5kbGVQaWMobWVkaWEuZGF0YSwgcGFkTGVuZ3RoLCB1c2VyTmFtZSwgdXNlcklkLCBwb3N0SWQsIHBvc3RVaWQsIGluZGV4LCBwb3N0VGltZSwgdGV4dCwgcmV0d2VldFBvc3RJZCwgcmV0d2VldFVzZXJOYW1lLCByZXR3ZWV0VXNlcklkLCByZXR3ZWV0UG9zdFVpZCwgcmV0d2VldFBvc3RUaW1lLCByZXR3ZWV0VGV4dCkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29uc3QgcGFja05hbWUgPSBnZXROYW1lKChHTV9nZXRWYWx1ZSgncmV0d2VldE1vZGUnLCBmYWxzZSkgJiYgcmV0d2VldFBvc3RJZCkgPyBHTV9nZXRWYWx1ZSgncmV0d2VldFBhY2tGaWxlTmFtZScsICd7bWJsb2dpZH0uemlwJykgOiBHTV9nZXRWYWx1ZSgncGFja0ZpbGVOYW1lJywgJ3ttYmxvZ2lkfS56aXAnKSwgJ3tvcmlnaW5hbH0nLCAne2V4dH0nLCB1c2VyTmFtZSwgdXNlcklkLCBwb3N0SWQsIHBvc3RVaWQsICd7aW5kZXh9JywgcG9zdFRpbWUsIHRleHQsIHJldHdlZXRQb3N0SWQsIHJldHdlZXRVc2VyTmFtZSwgcmV0d2VldFVzZXJJZCwgcmV0d2VldFBvc3RVaWQsIHJldHdlZXRQb3N0VGltZSwgcmV0d2VldFRleHQpOwogICAgICAgICAgICAgICAgaGFuZGxlRG93bmxvYWRMaXN0KGRvd25sb2FkTGlzdCwgcGFja05hbWUpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgYUluTGkuYXBwZW5kQ2hpbGQoZGxCdG4pOwogICAgICAgIGRsQnRuTGkuYXBwZW5kQ2hpbGQoZGxCdG4pOwogICAgICAgIGZvb3Rlci5maXJzdENoaWxkLmFwcGVuZENoaWxkKGRsQnRuTGkpOwogICAgICAgIC8vIGNvbnNvbGUubG9nKCdhZGRlZCBkb3dubG9hZCBidXR0b24nKTsKICAgIH0KLyoKICAgIGZ1bmN0aW9uIGJvZHlNb3VzZU92ZXIoZXZlbnQpIHsKICAgICAgICBpZiAobG9jYXRpb24uaG9zdCA9PSAnd2VpYm8uY29tJyB8fCBsb2NhdGlvbi5ob3N0ID09ICd3d3cud2VpYm8uY29tJykgewogICAgICAgICAgICAvLyBsZXQgYXJ0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdhcnRpY2xlJyk7CiAgICAgICAgICAgIGNvbnN0IGZvb3RlcnMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnZm9vdGVyJyk7CiAgICAgICAgICAgIGZvciAoY29uc3QgZm9vdGVyIG9mIGZvb3RlcnMpIHsKICAgICAgICAgICAgICAgIGlmKGZvb3Rlci5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdkb3dubG9hZC1idXR0b24nKS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2FscmVhZHkgYWRkZWQgZG93bmxvYWQgYnV0dG9uJyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGZvb3Rlci5wYXJlbnRFbGVtZW50KTsKICAgICAgICAgICAgICAgICAgICBpZihmb290ZXIucGFyZW50RWxlbWVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT0gJ2FydGljbGUnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFydGljbGUgPSBmb290ZXIucGFyZW50RWxlbWVudDsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaW1ncyA9IGFydGljbGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2ltZycpOwogICAgICAgICAgICAgICAgICAgICAgICBsZXQgYWRkZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coaW1ncyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGltZ3MubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGFkZEZsYWcgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaW1nIG9mIGltZ3MpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihbJ3dvby1waWN0dXJlLWltZycsICdwaWN0dXJlX2ZvY3VzSW1nXzF6NUluJywgJ3BpY3R1cmUtdmlld2VyX3BpY18zN1lRMyddLmluY2x1ZGVzKGltZy5jbGFzc05hbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZEZsYWcgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGFkZEZsYWcgPT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZERsQnRuKGZvb3Rlcik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB2aWRlb3MgPSBhcnRpY2xlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd2aWRlbycpOwogICAgICAgICAgICAgICAgICAgICAgICBpZih2aWRlb3MubGVuZ3RoID4gMCAmJiBhZGRlZCA9PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkRGxCdG4oZm9vdGVyKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAobG9jYXRpb24uaG9zdCA9PSAncy53ZWliby5jb20nKSB7CiAgICAgICAgICAgIC8vIGxldCBjYXJkcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNwbF9mZWVkbGlzdF9pbmRleCAuY2FyZC13cmFwJyk7CiAgICAgICAgICAgIGNvbnN0IGZvb3RlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjcGxfZmVlZGxpc3RfaW5kZXggLmNhcmQtYWN0Jyk7CiAgICAgICAgICAgIGZvciAoY29uc3QgZm9vdGVyIG9mIGZvb3RlcnMpIHsKICAgICAgICAgICAgICAgIGlmKGZvb3Rlci5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdkb3dubG9hZC1idXR0b24nKS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2FscmVhZHkgYWRkZWQgZG93bmxvYWQgYnV0dG9uJyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGZvb3Rlci5wYXJlbnRFbGVtZW50KTsKICAgICAgICAgICAgICAgICAgICBpZihmb290ZXIucGFyZW50RWxlbWVudC5jbGFzc05hbWUgPT0gJ2NhcmQnICYmIGZvb3Rlci5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuY2xhc3NOYW1lID09ICdjYXJkLXdyYXAnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhcmQgPSBmb290ZXIucGFyZW50RWxlbWVudDsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGFkZGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lZGlhX3ByZXYgPSBjYXJkLnF1ZXJ5U2VsZWN0b3IoJ2Rpdltub2RlLXR5cGU9ImZlZWRfbGlzdF9tZWRpYV9wcmV2Il0nKTsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cobWVkaWFfcHJldik7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZWRpYV9wcmV2KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpbWdzID0gbWVkaWFfcHJldi5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW1nJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhpbWdzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGltZ3MubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNBZGREbEJ0bihmb290ZXIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZpZGVvcyA9IGNhcmQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3ZpZGVvJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih2aWRlb3MubGVuZ3RoID4gMCAmJiBhZGRlZCA9PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNBZGREbEJ0bihmb290ZXIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoqLwogICAgZnVuY3Rpb24gaGFuZGxlQ2FyZChjYXJkKSB7CiAgICAgICAgLy8gY29uc29sZS5sb2coY2FyZCk7CiAgICAgICAgY29uc3QgZm9vdGVyID0gY2FyZC5xdWVyeVNlbGVjdG9yQWxsKCdmb290ZXInKVsxXSB8fCBjYXJkLnF1ZXJ5U2VsZWN0b3IoJ2Zvb3RlcicpOwogICAgICAgIGNvbnN0IGltZ3MgPSBjYXJkLnF1ZXJ5U2VsZWN0b3JBbGwoJ2ltZy53b28tcGljdHVyZS1pbWcsaW1nLnBpY3R1cmVfZm9jdXNJbWdfMXo1SW4saW1nLnBpY3R1cmUtdmlld2VyX3BpY18zN1lRMyx2aWRlby5waWN0dXJlLXZpZXdlcl9waWNfMzdZUTMnKTsKICAgICAgICAvLyBjb25zb2xlLmxvZyhpbWdzKTsKICAgICAgICBpZiAoZm9vdGVyKSB7CiAgICAgICAgICAgIGlmIChmb290ZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZG93bmxvYWQtYnV0dG9uJykubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2FscmVhZHkgYWRkZWQgZG93bmxvYWQgYnV0dG9uJyk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhmb290ZXIucGFyZW50RWxlbWVudCk7CiAgICAgICAgICAgICAgICBsZXQgYWRkZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGlmIChpbWdzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICBhZGREbEJ0bihmb290ZXIpOwogICAgICAgICAgICAgICAgICAgIGFkZGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBpZiAoaW1ncy5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgWyBpZHgsIGltZyBdIG9mIE9iamVjdC5lbnRyaWVzKGltZ3MpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW1nLnBhcmVudEVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZG93bmxvYWQtc2luZ2xlLWJ1dHRvbicpLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbWcuY2xhc3NOYW1lLmluY2x1ZGVzKCdwaWN0dXJlLXZpZXdlcl9waWNfMzdZUTMnKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2aWV3cyA9IGNhcmQucXVlcnlTZWxlY3RvckFsbCgnZGl2LnBpY3R1cmUtdmlld2VyX3ByZXZpZXdfMndPU3EnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBbIGluZGV4LCBwcmV2aWV3IF0gb2YgT2JqZWN0LmVudHJpZXMocHJldmlld3MpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldmlldy5jbGFzc05hbWUuaW5jbHVkZXMoJ3BpY3R1cmUtdmlld2VyX2N1cl9hblVFWScpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkU2luZ2xlRGxCdG4oaW1nLCBwYXJzZUludChpbmRleCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkU2luZ2xlRGxCdG4oaW1nLCBwYXJzZUludChpZHgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBsZXQgdmlkZW9zID0gY2FyZC5nZXRFbGVtZW50c0J5VGFnTmFtZSgndmlkZW8nKTsKICAgICAgICAgICAgICAgIGlmKHZpZGVvcy5sZW5ndGggPiAwICYmIGFkZGVkID09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICAgICAgYWRkRGxCdG4oZm9vdGVyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KLyoKICAgIGxldCBzdGFydEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgc3RhcnRCdXR0b24udGV4dENvbnRlbnQgPSB0ZXh0WzBdOwogICAgc3RhcnRCdXR0b24uaWQgPSAnc3RhcnRCdXR0b24nOwogICAgc3RhcnRCdXR0b24uc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnOwogICAgc3RhcnRCdXR0b24uc3R5bGUudG9wID0gJzE0cmVtJzsKICAgIHN0YXJ0QnV0dG9uLnN0eWxlLmxlZnQgPSAnMXJlbSc7CiAgICBzdGFydEJ1dHRvbi5zdHlsZS56SW5kZXggPSA0MDA7CiAgICBzdGFydEJ1dHRvbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnYmxhY2snOwogICAgc3RhcnRCdXR0b24uc3R5bGUuY29sb3IgPSAnbGlnaHRncmF5JzsKICAgIHN0YXJ0QnV0dG9uLnN0eWxlLnBhZGRpbmdMZWZ0ID0gJzFyZW0nOwogICAgc3RhcnRCdXR0b24uc3R5bGUucGFkZGluZ1JpZ2h0ID0gJzFyZW0nOwogICAgc3RhcnRCdXR0b24uc3R5bGUucGFkZGluZ1RvcCA9ICcwLjVyZW0nOwogICAgc3RhcnRCdXR0b24uc3R5bGUucGFkZGluZ0JvdHRvbSA9ICcwLjVyZW0nOwogICAgc3RhcnRCdXR0b24uc3R5bGUuZm9udFdlaWdodCA9ICdib2xkJzsKICAgIHN0YXJ0QnV0dG9uLnN0eWxlLmJvcmRlcldpZHRoID0gJzAuMTVyZW0nOwogICAgc3RhcnRCdXR0b24uc3R5bGUuYm9yZGVyQ29sb3IgPSAnbGlnaHRncmF5JzsKICAgIHN0YXJ0QnV0dG9uLnN0eWxlLmJvcmRlclJhZGl1cyA9ICcwLjRyZW0nOwogICAgc3RhcnRCdXR0b24uc3R5bGUuYm9yZGVyU3R5bGUgPSAnc29saWQnOwogICAgc3RhcnRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICBzdGFydEJ1dHRvbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnbGlnaHRncmF5JzsKICAgICAgICBzdGFydEJ1dHRvbi5zdHlsZS5jb2xvciA9ICdibGFjayc7CiAgICAgICAgc3RhcnRCdXR0b24uc3R5bGUuYm9yZGVyQ29sb3IgPSAnYmxhY2snOwogICAgfSk7CiAgICBzdGFydEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsIGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgc3RhcnRCdXR0b24uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ2JsYWNrJzsKICAgICAgICBzdGFydEJ1dHRvbi5zdHlsZS5jb2xvciA9ICdsaWdodGdyYXknOwogICAgICAgIHN0YXJ0QnV0dG9uLnN0eWxlLmJvcmRlckNvbG9yID0gJ2xpZ2h0Z3JheSc7CiAgICB9KTsKICAgIHN0YXJ0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgc3RhcnRCdXR0b24uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ2dyYXknOwogICAgfSk7CiAgICBzdGFydEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICBzdGFydEJ1dHRvbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnbGlnaHRncmF5JzsKICAgIH0pOwogICAgc3RhcnRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBib2R5TW91c2VPdmVyKTsKCiAgICBmdW5jdGlvbiBhZGRTdGFydEJ1dHRvbigpIHsKICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHN0YXJ0QnV0dG9uKTsKICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsIGJvZHlNb3VzZU92ZXIpCiAgICB9CgogICAgZnVuY3Rpb24gYWRkRXZlbnRMaXN0ZW5lcigpIHsKICAgICAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsIGJvZHlNb3VzZU92ZXIpOwogICAgICAgIGlmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFydEJ1dHRvbicpKSB7CiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoc3RhcnRCdXR0b24pOwogICAgICAgIH0KICAgIH0KKi8KICAgIC8vIGxldCBhZGREbEJ0bk1vZGUgPSBHTV9nZXRWYWx1ZSgnYWRkRGxCdG5Nb2RlJywgMCk7CgogICAgZnVuY3Rpb24gc2hvd01vZGFsKGV2ZW50KSB7CiAgICAgICAgLy8gY29uc29sZS5sb2coYWRkRGxCdG5Nb2RlKTsKICAgICAgICBsZXQgYmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBiZy5zdHlsZS5wb3NpdGlvbiA9ICdmaXhlZCc7CiAgICAgICAgYmcuc3R5bGUudG9wID0gMDsKICAgICAgICBiZy5zdHlsZS5sZWZ0ID0gMDsKICAgICAgICBiZy5zdHlsZS56SW5kZXggPSA1MDA7CiAgICAgICAgYmcuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ2JsYWNrJzsKICAgICAgICBiZy5zdHlsZS5vcGFjaXR5ID0gMC41OwogICAgICAgIGxldCBtb2RhbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYmcpOwogICAgICAgIG1vZGFsLnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJzsKICAgICAgICBtb2RhbC5zdHlsZS53aWR0aCA9ICcyNXJlbSc7CiAgICAgICAgbW9kYWwuc3R5bGUuaGVpZ2h0ID0gJ2F1dG8nOwogICAgICAgIG1vZGFsLnN0eWxlLm1heEhlaWdodCA9ICc4MHZoJzsKICAgICAgICBtb2RhbC5zdHlsZS56SW5kZXggPSA2MDA7CiAgICAgICAgbW9kYWwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3doaXRlJzsKICAgICAgICBtb2RhbC5zdHlsZS5ib3JkZXJTdHlsZSA9ICdzb2xpZCc7CiAgICAgICAgbW9kYWwuc3R5bGUuYm9yZGVyV2lkdGggPSAnMC4ycmVtJzsKICAgICAgICBtb2RhbC5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnMC41cmVtJzsKICAgICAgICBtb2RhbC5zdHlsZS5ib3JkZXJDb2xvciA9ICdibGFjayc7CiAgICAgICAgbW9kYWwuc3R5bGUub3ZlcmZsb3dYID0gJ2hpZGRlbic7CiAgICAgICAgbW9kYWwuc3R5bGUub3ZlcmZsb3dZID0gJ2F1dG8nOwogICAgICAgIG1vZGFsLnN0eWxlLmZvbnRTaXplID0gJzFyZW0nOwogICAgICAgIGxldCB0aXRsZUJhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIHRpdGxlQmFyLnRleHRDb250ZW50ID0gdGV4dFsxXTsKICAgICAgICB0aXRsZUJhci5zdHlsZS53aWR0aCA9ICcxMDAlJzsKICAgICAgICB0aXRsZUJhci5zdHlsZS50ZXh0QWxpZ24gPSAnY2VudGVyJzsKICAgICAgICB0aXRsZUJhci5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnYmxhY2snOwogICAgICAgIHRpdGxlQmFyLnN0eWxlLmNvbG9yID0gJ3doaXRlJzsKICAgICAgICB0aXRsZUJhci5zdHlsZS5mb250U2l6ZSA9ICcxcmVtJzsKICAgICAgICB0aXRsZUJhci5zdHlsZS5mb250V2VpZ2h0ID0gJ2JvbGQnOwogICAgICAgIHRpdGxlQmFyLnN0eWxlLnBhZGRpbmdUb3AgPSAnMC41cmVtJzsKICAgICAgICB0aXRsZUJhci5zdHlsZS5wYWRkaW5nQm90dG9tID0gJzAuNXJlbSc7CiAgICAgICAgdGl0bGVCYXIuc3R5bGUuYm9yZGVyVG9wTGVmdFJhZGl1cyA9ICcwLjNyZW0nOwogICAgICAgIHRpdGxlQmFyLnN0eWxlLmJvcmRlclRvcFJpZ2h0UmFkaXVzID0gJzAuM3JlbSc7CiAgICAgICAgbW9kYWwuYXBwZW5kQ2hpbGQodGl0bGVCYXIpOwogICAgICAgIC8qbGV0IHF1ZXN0aW9uMSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTsKICAgICAgICBxdWVzdGlvbjEudGV4dENvbnRlbnQgPSB0ZXh0WzJdOwogICAgICAgIHF1ZXN0aW9uMS5zdHlsZS5wYWRkaW5nTGVmdCA9ICcycmVtJzsKICAgICAgICBxdWVzdGlvbjEuc3R5bGUucGFkZGluZ1JpZ2h0ID0gJzJyZW0nOwogICAgICAgIHF1ZXN0aW9uMS5zdHlsZS5tYXJnaW5Ub3AgPSAnMXJlbSc7CiAgICAgICAgcXVlc3Rpb24xLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcxcmVtJzsKICAgICAgICBsZXQgY2hvb3NlQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsKICAgICAgICBjaG9vc2VCdXR0b24udHlwZSA9ICdyYWRpbyc7CiAgICAgICAgY2hvb3NlQnV0dG9uLmlkID0gJ2Nob29zZUJ1dHRvbic7CiAgICAgICAgY2hvb3NlQnV0dG9uLm5hbWUgPSAnY2hvb3NlU2V0dGluZyc7CiAgICAgICAgY2hvb3NlQnV0dG9uLnZhbHVlID0gMTsKICAgICAgICBjaG9vc2VCdXR0b24uc3R5bGUubWFyZ2luID0gJzAuNXJlbSAwLjVyZW0gMCAwLjVyZW0nOwogICAgICAgIGxldCBsYWJlbEZvckNob29zZUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7CiAgICAgICAgbGFiZWxGb3JDaG9vc2VCdXR0b24uaHRtbEZvciA9ICdjaG9vc2VCdXR0b24nOwogICAgICAgIGxhYmVsRm9yQ2hvb3NlQnV0dG9uLnRleHRDb250ZW50ID0gdGV4dFszXTsKICAgICAgICBsZXQgZGl2Rm9yQ2hvb3NlQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgZGl2Rm9yQ2hvb3NlQnV0dG9uLmFwcGVuZENoaWxkKGNob29zZUJ1dHRvbik7CiAgICAgICAgZGl2Rm9yQ2hvb3NlQnV0dG9uLmFwcGVuZENoaWxkKGxhYmVsRm9yQ2hvb3NlQnV0dG9uKTsKICAgICAgICBxdWVzdGlvbjEuYXBwZW5kQ2hpbGQoZGl2Rm9yQ2hvb3NlQnV0dG9uKTsKICAgICAgICBsZXQgY2hvb3NlRXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOwogICAgICAgIGNob29zZUV2ZW50LnR5cGUgPSAncmFkaW8nOwogICAgICAgIGNob29zZUV2ZW50LmlkID0gJ2Nob29zZUV2ZW50JzsKICAgICAgICBjaG9vc2VFdmVudC5uYW1lID0gJ2Nob29zZVNldHRpbmcnOwogICAgICAgIGNob29zZUV2ZW50LnZhbHVlID0gMjsKICAgICAgICBjaG9vc2VFdmVudC5zdHlsZS5tYXJnaW4gPSAnMC41cmVtIDAuNXJlbSAwIDAuNXJlbSc7CiAgICAgICAgaWYgKGFkZERsQnRuTW9kZSA9PSAyKSB7CiAgICAgICAgICAgIGNob29zZUV2ZW50LmNoZWNrZWQgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNob29zZUJ1dHRvbi5jaGVja2VkID0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgbGV0IGxhYmVsRm9yQ2hvb3NlRXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpOwogICAgICAgIGxhYmVsRm9yQ2hvb3NlRXZlbnQuaHRtbEZvciA9ICdjaG9vc2VFdmVudCc7CiAgICAgICAgbGFiZWxGb3JDaG9vc2VFdmVudC50ZXh0Q29udGVudCA9IHRleHRbNF07CiAgICAgICAgbGV0IGRpdkZvckNob29zZUV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgZGl2Rm9yQ2hvb3NlRXZlbnQuYXBwZW5kQ2hpbGQoY2hvb3NlRXZlbnQpOwogICAgICAgIGRpdkZvckNob29zZUV2ZW50LmFwcGVuZENoaWxkKGxhYmVsRm9yQ2hvb3NlRXZlbnQpOwogICAgICAgIHF1ZXN0aW9uMS5hcHBlbmRDaGlsZChkaXZGb3JDaG9vc2VFdmVudCk7CiAgICAgICAgbW9kYWwuYXBwZW5kQ2hpbGQocXVlc3Rpb24xKTsqLwogICAgICAgIGxldCBxdWVzdGlvbjIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7CiAgICAgICAgcXVlc3Rpb24yLnN0eWxlLnBhZGRpbmdMZWZ0ID0gJzJyZW0nOwogICAgICAgIHF1ZXN0aW9uMi5zdHlsZS5wYWRkaW5nUmlnaHQgPSAnMnJlbSc7CiAgICAgICAgcXVlc3Rpb24yLnN0eWxlLm1hcmdpblRvcCA9ICcxcmVtJzsKICAgICAgICBxdWVzdGlvbjIuc3R5bGUubWFyZ2luQm90dG9tID0gJzFyZW0nOwogICAgICAgIGxldCBsYWJlbEZpbGVOYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTsKICAgICAgICBsYWJlbEZpbGVOYW1lLnRleHRDb250ZW50ID0gdGV4dFs3XTsKICAgICAgICBsYWJlbEZpbGVOYW1lLnNldEF0dHJpYnV0ZSgnZm9yJywgJ2RsRmlsZU5hbWUnKTsKICAgICAgICBsYWJlbEZpbGVOYW1lLnN0eWxlLmNvbG9yID0gImJsYWNrIjsKICAgICAgICBxdWVzdGlvbjIuYXBwZW5kQ2hpbGQobGFiZWxGaWxlTmFtZSk7CiAgICAgICAgbGV0IGlucHV0RmlsZU5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOwogICAgICAgIGlucHV0RmlsZU5hbWUudHlwZSA9ICd0ZXh0JzsKICAgICAgICBpbnB1dEZpbGVOYW1lLmlkID0gJ2RsRmlsZU5hbWUnOwogICAgICAgIGlucHV0RmlsZU5hbWUubmFtZSA9ICdkbEZpbGVOYW1lJzsKICAgICAgICBpbnB1dEZpbGVOYW1lLnN0eWxlLm1hcmdpblRvcCA9ICcwLjVyZW0nOwogICAgICAgIGlucHV0RmlsZU5hbWUuc3R5bGUud2lkdGggPSAnY2FsYygxMDAlIC0gMXJlbSknOwogICAgICAgIGlucHV0RmlsZU5hbWUuc3R5bGUucGFkZGluZyA9ICcwLjFyZW0gMC4ycmVtIDAuMXJlbSAwLjJyZW0nOwogICAgICAgIGlucHV0RmlsZU5hbWUuc3R5bGUuYm9yZGVyU3R5bGUgPSAnc29saWQnOwogICAgICAgIGlucHV0RmlsZU5hbWUuc3R5bGUuYm9yZGVyQ29sb3IgPSAnZ3JheSc7CiAgICAgICAgaW5wdXRGaWxlTmFtZS5zdHlsZS5ib3JkZXJXaWR0aCA9ICcwLjE0cmVtJzsKICAgICAgICBpbnB1dEZpbGVOYW1lLnN0eWxlLmJvcmRlclJhZGl1cyA9ICcwLjJyZW0nOwogICAgICAgIGlucHV0RmlsZU5hbWUuZGVmYXVsdFZhbHVlID0gR01fZ2V0VmFsdWUoJ2RsRmlsZU5hbWUnLCAne29yaWdpbmFsfS57ZXh0fScpOwogICAgICAgIHF1ZXN0aW9uMi5hcHBlbmRDaGlsZChpbnB1dEZpbGVOYW1lKTsKICAgICAgICBsZXQgZmlsZU5hbWVFeHBsYWluMSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTsKICAgICAgICBmaWxlTmFtZUV4cGxhaW4xLmlubmVySFRNTCA9IHRleHRbOF07CiAgICAgICAgZmlsZU5hbWVFeHBsYWluMS5zdHlsZS5tYXJnaW5Ub3AgPSAnMC41cmVtJzsKICAgICAgICBmaWxlTmFtZUV4cGxhaW4xLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcwJzsKICAgICAgICBmaWxlTmFtZUV4cGxhaW4xLnN0eWxlLndoaXRlU3BhY2UgPSAncHJlJzsKICAgICAgICBmaWxlTmFtZUV4cGxhaW4xLnN0eWxlLmNvbG9yID0gJ2dyYXknOwogICAgICAgIHF1ZXN0aW9uMi5hcHBlbmRDaGlsZChmaWxlTmFtZUV4cGxhaW4xKTsKICAgICAgICBsZXQgZmlsZU5hbWVFeHBsYWluMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTsKICAgICAgICBmaWxlTmFtZUV4cGxhaW4yLmlubmVySFRNTCA9IHRleHRbMjZdICsgdGV4dFsyN107CiAgICAgICAgZmlsZU5hbWVFeHBsYWluMi5zdHlsZS5tYXJnaW5Ub3AgPSAnMC41cmVtJzsKICAgICAgICBmaWxlTmFtZUV4cGxhaW4yLnN0eWxlLndoaXRlU3BhY2UgPSAncHJlJzsKICAgICAgICBmaWxlTmFtZUV4cGxhaW4yLnN0eWxlLmNvbG9yID0gJ2dyYXknOwogICAgICAgIHF1ZXN0aW9uMi5hcHBlbmRDaGlsZChmaWxlTmFtZUV4cGxhaW4yKTsKICAgICAgICBtb2RhbC5hcHBlbmRDaGlsZChxdWVzdGlvbjIpOwogICAgICAgIGxldCBxdWVzdGlvbjMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7CiAgICAgICAgcXVlc3Rpb24zLnN0eWxlLnBhZGRpbmdMZWZ0ID0gJzJyZW0nOwogICAgICAgIHF1ZXN0aW9uMy5zdHlsZS5wYWRkaW5nUmlnaHQgPSAnMnJlbSc7CiAgICAgICAgcXVlc3Rpb24zLnN0eWxlLm1hcmdpblRvcCA9ICcxcmVtJzsKICAgICAgICBxdWVzdGlvbjMuc3R5bGUubWFyZ2luQm90dG9tID0gJzAnOwogICAgICAgIGxldCBsYWJlbFppcE1vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpOwogICAgICAgIGxhYmVsWmlwTW9kZS5zZXRBdHRyaWJ1dGUoJ2ZvcicsICd6aXBNb2RlJyk7CiAgICAgICAgbGFiZWxaaXBNb2RlLnRleHRDb250ZW50ID0gdGV4dFsxM107CiAgICAgICAgbGFiZWxaaXBNb2RlLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJzsKICAgICAgICBsYWJlbFppcE1vZGUuc3R5bGUucGFkZGluZ1JpZ2h0ID0gJzAuMnJlbSc7CiAgICAgICAgbGFiZWxaaXBNb2RlLnN0eWxlLmNvbG9yID0gR01fZ2V0VmFsdWUoJ2FyaWFNb2RlJywgZmFsc2UpID8gImdyYXkiIDogImJsYWNrIjsKICAgICAgICBxdWVzdGlvbjMuYXBwZW5kQ2hpbGQobGFiZWxaaXBNb2RlKTsKICAgICAgICBsZXQgaW5wdXRaaXBNb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsKICAgICAgICBpbnB1dFppcE1vZGUudHlwZSA9ICdjaGVja2JveCc7CiAgICAgICAgaW5wdXRaaXBNb2RlLmlkID0gJ3ppcE1vZGUnOwogICAgICAgIGlucHV0WmlwTW9kZS5jaGVja2VkID0gR01fZ2V0VmFsdWUoJ3ppcE1vZGUnLCBmYWxzZSk7CiAgICAgICAgaW5wdXRaaXBNb2RlLmRpc2FibGVkID0gR01fZ2V0VmFsdWUoJ2FyaWFNb2RlJywgZmFsc2UpOwogICAgICAgIHF1ZXN0aW9uMy5hcHBlbmRDaGlsZChpbnB1dFppcE1vZGUpOwogICAgICAgIGxldCBsYWJlbFBhY2tOYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTsKICAgICAgICBsYWJlbFBhY2tOYW1lLnRleHRDb250ZW50ID0gdGV4dFsxNF07CiAgICAgICAgbGFiZWxQYWNrTmFtZS5zZXRBdHRyaWJ1dGUoJ2ZvcicsICdwYWNrRmlsZU5hbWUnKTsKICAgICAgICBsYWJlbFBhY2tOYW1lLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgIGxhYmVsUGFja05hbWUuc3R5bGUubWFyZ2luVG9wID0gJzAuNXJlbSc7CiAgICAgICAgbGFiZWxQYWNrTmFtZS5zdHlsZS5jb2xvciA9IChHTV9nZXRWYWx1ZSgnemlwTW9kZScsIGZhbHNlKSAmJiAhR01fZ2V0VmFsdWUoJ2FyaWFNb2RlJywgZmFsc2UpKSA/ICJibGFjayIgOiAiZ3JheSI7CiAgICAgICAgLy8gbGFiZWxQYWNrTmFtZS5zdHlsZS5kaXNwbGF5ID0gR01fZ2V0VmFsdWUoJ3ppcE1vZGUnLCBmYWxzZSkgPyAnYmxvY2snIDogJ25vbmUnOwogICAgICAgIHF1ZXN0aW9uMy5hcHBlbmRDaGlsZChsYWJlbFBhY2tOYW1lKTsKICAgICAgICBsZXQgaW5wdXRQYWNrTmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7CiAgICAgICAgaW5wdXRQYWNrTmFtZS50eXBlID0gJ3RleHQnOwogICAgICAgIGlucHV0UGFja05hbWUuaWQgPSAncGFja0ZpbGVOYW1lJzsKICAgICAgICBpbnB1dFBhY2tOYW1lLm5hbWUgPSAncGFja0ZpbGVOYW1lJzsKICAgICAgICBpbnB1dFBhY2tOYW1lLnN0eWxlLm1hcmdpblRvcCA9ICcwLjVyZW0nOwogICAgICAgIGlucHV0UGFja05hbWUuc3R5bGUud2lkdGggPSAnY2FsYygxMDAlIC0gMXJlbSknOwogICAgICAgIGlucHV0UGFja05hbWUuc3R5bGUucGFkZGluZyA9ICcwLjFyZW0gMC4ycmVtIDAuMXJlbSAwLjJyZW0nOwogICAgICAgIGlucHV0UGFja05hbWUuc3R5bGUuYm9yZGVyU3R5bGUgPSAnc29saWQnOwogICAgICAgIGlucHV0UGFja05hbWUuc3R5bGUuYm9yZGVyQ29sb3IgPSAoR01fZ2V0VmFsdWUoJ3ppcE1vZGUnLCBmYWxzZSkgJiYgIUdNX2dldFZhbHVlKCdhcmlhTW9kZScsIGZhbHNlKSkgPyAnYmxhY2snIDogJ2dyYXknOwogICAgICAgIGlucHV0UGFja05hbWUuc3R5bGUuYm9yZGVyV2lkdGggPSAnMC4xNHJlbSc7CiAgICAgICAgaW5wdXRQYWNrTmFtZS5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnMC4ycmVtJzsKICAgICAgICBpbnB1dFBhY2tOYW1lLmRlZmF1bHRWYWx1ZSA9IEdNX2dldFZhbHVlKCdwYWNrRmlsZU5hbWUnLCAne21ibG9naWR9LnppcCcpOwogICAgICAgIC8vIGlucHV0UGFja05hbWUuc3R5bGUuZGlzcGxheSA9IEdNX2dldFZhbHVlKCd6aXBNb2RlJywgZmFsc2UpID8gJ2Jsb2NrJyA6ICdub25lJzsKICAgICAgICBpbnB1dFBhY2tOYW1lLmRpc2FibGVkID0gKEdNX2dldFZhbHVlKCd6aXBNb2RlJywgZmFsc2UpICYmICFHTV9nZXRWYWx1ZSgnYXJpYU1vZGUnLCBmYWxzZSkpID8gZmFsc2UgOiB0cnVlOwogICAgICAgIHF1ZXN0aW9uMy5hcHBlbmRDaGlsZChpbnB1dFBhY2tOYW1lKTsKICAgICAgICBsZXQgZmlsZVBhY2tFeHBsYWluID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpOwogICAgICAgIGZpbGVQYWNrRXhwbGFpbi50ZXh0Q29udGVudCA9IHRleHRbMTVdOwogICAgICAgIGZpbGVQYWNrRXhwbGFpbi5zdHlsZS5tYXJnaW5Ub3AgPSAnMC41cmVtJzsKICAgICAgICBmaWxlUGFja0V4cGxhaW4uc3R5bGUubWFyZ2luQm90dG9tID0gJzAnOwogICAgICAgIGZpbGVQYWNrRXhwbGFpbi5zdHlsZS5jb2xvciA9ICdncmF5JzsKICAgICAgICAvLyBmaWxlUGFja0V4cGxhaW4uc3R5bGUuZGlzcGxheSA9IEdNX2dldFZhbHVlKCd6aXBNb2RlJywgZmFsc2UpID8gJ2Jsb2NrJyA6ICdub25lJzsKICAgICAgICBxdWVzdGlvbjMuYXBwZW5kQ2hpbGQoZmlsZVBhY2tFeHBsYWluKTsKICAgICAgICBtb2RhbC5hcHBlbmRDaGlsZChxdWVzdGlvbjMpOwogICAgICAgIGxldCBxdWVzdGlvbjQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7CiAgICAgICAgcXVlc3Rpb240LnN0eWxlLnBhZGRpbmdMZWZ0ID0gJzJyZW0nOwogICAgICAgIHF1ZXN0aW9uNC5zdHlsZS5wYWRkaW5nUmlnaHQgPSAnMnJlbSc7CiAgICAgICAgcXVlc3Rpb240LnN0eWxlLm1hcmdpblRvcCA9ICcxcmVtJzsKICAgICAgICBxdWVzdGlvbjQuc3R5bGUubWFyZ2luQm90dG9tID0gJzAnOwogICAgICAgIGxldCBsYWJlbFJldHdlZXRNb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTsKICAgICAgICBsYWJlbFJldHdlZXRNb2RlLnNldEF0dHJpYnV0ZSgnZm9yJywgJ3JldHdlZXRNb2RlJyk7CiAgICAgICAgbGFiZWxSZXR3ZWV0TW9kZS50ZXh0Q29udGVudCA9IHRleHRbMTZdOwogICAgICAgIGxhYmVsUmV0d2VldE1vZGUuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtYmxvY2snOwogICAgICAgIGxhYmVsUmV0d2VldE1vZGUuc3R5bGUucGFkZGluZ1JpZ2h0ID0gJzAuMnJlbSc7CiAgICAgICAgbGFiZWxSZXR3ZWV0TW9kZS5zdHlsZS5jb2xvciA9ICJibGFjayI7CiAgICAgICAgcXVlc3Rpb240LmFwcGVuZENoaWxkKGxhYmVsUmV0d2VldE1vZGUpOwogICAgICAgIGxldCBpbnB1dFJldHdlZXRNb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsKICAgICAgICBpbnB1dFJldHdlZXRNb2RlLnR5cGUgPSAnY2hlY2tib3gnOwogICAgICAgIGlucHV0UmV0d2VldE1vZGUuaWQgPSAncmV0d2VldE1vZGUnOwogICAgICAgIGlucHV0UmV0d2VldE1vZGUuY2hlY2tlZCA9IEdNX2dldFZhbHVlKCdyZXR3ZWV0TW9kZScsIGZhbHNlKTsKICAgICAgICBxdWVzdGlvbjQuYXBwZW5kQ2hpbGQoaW5wdXRSZXR3ZWV0TW9kZSk7CiAgICAgICAgbGV0IGxhYmVsUmV0d2VldEZpbGVOYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTsKICAgICAgICBsYWJlbFJldHdlZXRGaWxlTmFtZS50ZXh0Q29udGVudCA9IHRleHRbMTddOwogICAgICAgIGxhYmVsUmV0d2VldEZpbGVOYW1lLnNldEF0dHJpYnV0ZSgnZm9yJywgJ3JldHdlZXRGaWxlTmFtZScpOwogICAgICAgIGxhYmVsUmV0d2VldEZpbGVOYW1lLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgIGxhYmVsUmV0d2VldEZpbGVOYW1lLnN0eWxlLm1hcmdpblRvcCA9ICcwLjVyZW0nOwogICAgICAgIGxhYmVsUmV0d2VldEZpbGVOYW1lLnN0eWxlLmNvbG9yID0gR01fZ2V0VmFsdWUoJ3JldHdlZXRNb2RlJywgZmFsc2UpID8gImJsYWNrIiA6ICdncmF5JzsKICAgICAgICAvLyBsYWJlbFBhY2tOYW1lLnN0eWxlLmRpc3BsYXkgPSBHTV9nZXRWYWx1ZSgncmV0d2VldE1vZGUnLCBmYWxzZSkgPyAnYmxvY2snIDogJ25vbmUnOwogICAgICAgIHF1ZXN0aW9uNC5hcHBlbmRDaGlsZChsYWJlbFJldHdlZXRGaWxlTmFtZSk7CiAgICAgICAgbGV0IGlucHV0UmV0d2VldEZpbGVOYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsKICAgICAgICBpbnB1dFJldHdlZXRGaWxlTmFtZS50eXBlID0gJ3RleHQnOwogICAgICAgIGlucHV0UmV0d2VldEZpbGVOYW1lLmlkID0gJ3JldHdlZXRGaWxlTmFtZSc7CiAgICAgICAgaW5wdXRSZXR3ZWV0RmlsZU5hbWUubmFtZSA9ICdyZXR3ZWV0RmlsZU5hbWUnOwogICAgICAgIGlucHV0UmV0d2VldEZpbGVOYW1lLnN0eWxlLm1hcmdpblRvcCA9ICcwLjVyZW0nOwogICAgICAgIGlucHV0UmV0d2VldEZpbGVOYW1lLnN0eWxlLndpZHRoID0gJ2NhbGMoMTAwJSAtIDFyZW0pJzsKICAgICAgICBpbnB1dFJldHdlZXRGaWxlTmFtZS5zdHlsZS5wYWRkaW5nID0gJzAuMXJlbSAwLjJyZW0gMC4xcmVtIDAuMnJlbSc7CiAgICAgICAgaW5wdXRSZXR3ZWV0RmlsZU5hbWUuc3R5bGUuYm9yZGVyU3R5bGUgPSAnc29saWQnOwogICAgICAgIGlucHV0UmV0d2VldEZpbGVOYW1lLnN0eWxlLmJvcmRlckNvbG9yID0gJ2xpZ2h0Z3JheSc7CiAgICAgICAgaW5wdXRSZXR3ZWV0RmlsZU5hbWUuc3R5bGUuYm9yZGVyV2lkdGggPSAnMC4xNHJlbSc7CiAgICAgICAgaW5wdXRSZXR3ZWV0RmlsZU5hbWUuc3R5bGUuYm9yZGVyUmFkaXVzID0gJzAuMnJlbSc7CiAgICAgICAgaW5wdXRSZXR3ZWV0RmlsZU5hbWUuZGVmYXVsdFZhbHVlID0gR01fZ2V0VmFsdWUoJ3JldHdlZXRGaWxlTmFtZScsICd7b3JpZ2luYWx9LntleHR9Jyk7CiAgICAgICAgLy8gaW5wdXRSZXR3ZWV0RmlsZU5hbWUuc3R5bGUuZGlzcGxheSA9IEdNX2dldFZhbHVlKCdyZXR3ZWV0TW9kZScsIGZhbHNlKSA/ICdibG9jaycgOiAnbm9uZSc7CiAgICAgICAgaW5wdXRSZXR3ZWV0RmlsZU5hbWUuZGlzYWJsZWQgPSBHTV9nZXRWYWx1ZSgncmV0d2VldE1vZGUnLCBmYWxzZSkgPyBmYWxzZSA6IHRydWU7CiAgICAgICAgcXVlc3Rpb240LmFwcGVuZENoaWxkKGlucHV0UmV0d2VldEZpbGVOYW1lKTsKICAgICAgICBsZXQgcmV0d2VldEZpbGVOYW1lRXhwbGFpbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTsKICAgICAgICByZXR3ZWV0RmlsZU5hbWVFeHBsYWluLnRleHRDb250ZW50ID0gdGV4dFsxOF07CiAgICAgICAgcmV0d2VldEZpbGVOYW1lRXhwbGFpbi5zdHlsZS5tYXJnaW5Ub3AgPSAnMC41cmVtJzsKICAgICAgICByZXR3ZWV0RmlsZU5hbWVFeHBsYWluLnN0eWxlLndoaXRlU3BhY2UgPSAncHJlJzsKICAgICAgICByZXR3ZWV0RmlsZU5hbWVFeHBsYWluLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcwJzsKICAgICAgICByZXR3ZWV0RmlsZU5hbWVFeHBsYWluLnN0eWxlLmNvbG9yID0gJ2dyYXknOwogICAgICAgIC8vIHJldHdlZXRGaWxlTmFtZUV4cGxhaW4uc3R5bGUuZGlzcGxheSA9IEdNX2dldFZhbHVlKCdyZXR3ZWV0TW9kZScsIGZhbHNlKSA/ICdibG9jaycgOiAnbm9uZSc7CiAgICAgICAgcXVlc3Rpb240LmFwcGVuZENoaWxkKHJldHdlZXRGaWxlTmFtZUV4cGxhaW4pOwogICAgICAgIGxldCBsYWJlbFJldHdlZXRQYWNrTmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7CiAgICAgICAgbGFiZWxSZXR3ZWV0UGFja05hbWUudGV4dENvbnRlbnQgPSB0ZXh0WzE5XTsKICAgICAgICBsYWJlbFJldHdlZXRQYWNrTmFtZS5zZXRBdHRyaWJ1dGUoJ2ZvcicsICdyZXR3ZWV0UGFja0ZpbGVOYW1lJyk7CiAgICAgICAgbGFiZWxSZXR3ZWV0UGFja05hbWUuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgbGFiZWxSZXR3ZWV0UGFja05hbWUuc3R5bGUubWFyZ2luVG9wID0gJzAuNXJlbSc7CiAgICAgICAgbGFiZWxSZXR3ZWV0UGFja05hbWUuc3R5bGUuY29sb3IgPSAoR01fZ2V0VmFsdWUoJ3ppcE1vZGUnLCBmYWxzZSkgJiYgR01fZ2V0VmFsdWUoJ3JldHdlZXRNb2RlJywgZmFsc2UpICYmICFHTV9nZXRWYWx1ZSgnYXJpYU1vZGUnLCBmYWxzZSkpID8gImJsYWNrIiA6ICdncmF5JzsKICAgICAgICAvLyBsYWJlbFJldHdlZXRQYWNrTmFtZS5zdHlsZS5kaXNwbGF5ID0gR01fZ2V0VmFsdWUoJ3ppcE1vZGUnLCBmYWxzZSkgPyAnYmxvY2snIDogJ25vbmUnOwogICAgICAgIHF1ZXN0aW9uNC5hcHBlbmRDaGlsZChsYWJlbFJldHdlZXRQYWNrTmFtZSk7CiAgICAgICAgbGV0IGlucHV0UmV0d2VldFBhY2tOYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsKICAgICAgICBpbnB1dFJldHdlZXRQYWNrTmFtZS50eXBlID0gJ3RleHQnOwogICAgICAgIGlucHV0UmV0d2VldFBhY2tOYW1lLmlkID0gJ3JldHdlZXRQYWNrRmlsZU5hbWUnOwogICAgICAgIGlucHV0UmV0d2VldFBhY2tOYW1lLm5hbWUgPSAncmV0d2VldFBhY2tGaWxlTmFtZSc7CiAgICAgICAgaW5wdXRSZXR3ZWV0UGFja05hbWUuc3R5bGUubWFyZ2luVG9wID0gJzAuNXJlbSc7CiAgICAgICAgaW5wdXRSZXR3ZWV0UGFja05hbWUuc3R5bGUud2lkdGggPSAnY2FsYygxMDAlIC0gMXJlbSknOwogICAgICAgIGlucHV0UmV0d2VldFBhY2tOYW1lLnN0eWxlLnBhZGRpbmcgPSAnMC4xcmVtIDAuMnJlbSAwLjFyZW0gMC4ycmVtJzsKICAgICAgICBpbnB1dFJldHdlZXRQYWNrTmFtZS5zdHlsZS5ib3JkZXJTdHlsZSA9ICdzb2xpZCc7CiAgICAgICAgaW5wdXRSZXR3ZWV0UGFja05hbWUuc3R5bGUuYm9yZGVyQ29sb3IgPSAnbGlnaHRncmF5JzsKICAgICAgICBpbnB1dFJldHdlZXRQYWNrTmFtZS5zdHlsZS5ib3JkZXJXaWR0aCA9ICcwLjE0cmVtJzsKICAgICAgICBpbnB1dFJldHdlZXRQYWNrTmFtZS5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnMC4ycmVtJzsKICAgICAgICBpbnB1dFJldHdlZXRQYWNrTmFtZS5kZWZhdWx0VmFsdWUgPSBHTV9nZXRWYWx1ZSgncmV0d2VldFBhY2tGaWxlTmFtZScsICd7bWJsb2dpZH0uemlwJyk7CiAgICAgICAgLy8gaW5wdXRSZXR3ZWV0UGFja05hbWUuc3R5bGUuZGlzcGxheSA9IChHTV9nZXRWYWx1ZSgnemlwTW9kZScsIGZhbHNlKSAmJiBHTV9nZXRWYWx1ZSgncmV0d2VldE1vZGUnLCBmYWxzZSkgJiYgIUdNX2dldFZhbHVlKCdhcmlhTW9kZScsIGZhbHNlKSkgPyAnYmxvY2snIDogJ25vbmUnOwogICAgICAgIGlucHV0UmV0d2VldFBhY2tOYW1lLmRpc2FibGVkID0gKEdNX2dldFZhbHVlKCd6aXBNb2RlJywgZmFsc2UpICYmIEdNX2dldFZhbHVlKCdyZXR3ZWV0TW9kZScsIGZhbHNlKSAmJiAhR01fZ2V0VmFsdWUoJ2FyaWFNb2RlJywgZmFsc2UpKSA/IGZhbHNlIDogdHJ1ZTsKICAgICAgICBxdWVzdGlvbjQuYXBwZW5kQ2hpbGQoaW5wdXRSZXR3ZWV0UGFja05hbWUpOwogICAgICAgIGxldCByZXR3ZWV0UGFja0V4cGxhaW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7CiAgICAgICAgcmV0d2VldFBhY2tFeHBsYWluLnRleHRDb250ZW50ID0gdGV4dFsyMF07CiAgICAgICAgcmV0d2VldFBhY2tFeHBsYWluLnN0eWxlLm1hcmdpblRvcCA9ICcwLjVyZW0nOwogICAgICAgIHJldHdlZXRQYWNrRXhwbGFpbi5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMCc7CiAgICAgICAgcmV0d2VldFBhY2tFeHBsYWluLnN0eWxlLmNvbG9yID0gJ2dyYXknOwogICAgICAgIC8vIHJldHdlZXRQYWNrRXhwbGFpbi5zdHlsZS5kaXNwbGF5ID0gKEdNX2dldFZhbHVlKCd6aXBNb2RlJywgZmFsc2UpICYmIEdNX2dldFZhbHVlKCdyZXR3ZWV0TW9kZScsIGZhbHNlKSAmJiAhR01fZ2V0VmFsdWUoJ2FyaWFNb2RlJywgZmFsc2UpKSA/ICdibG9jaycgOiAnbm9uZSc7CiAgICAgICAgcXVlc3Rpb240LmFwcGVuZENoaWxkKHJldHdlZXRQYWNrRXhwbGFpbik7CiAgICAgICAgbW9kYWwuYXBwZW5kQ2hpbGQocXVlc3Rpb240KTsKICAgICAgICBsZXQgcXVlc3Rpb241ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpOwogICAgICAgIHF1ZXN0aW9uNS5zdHlsZS5wYWRkaW5nTGVmdCA9ICcycmVtJzsKICAgICAgICBxdWVzdGlvbjUuc3R5bGUucGFkZGluZ1JpZ2h0ID0gJzJyZW0nOwogICAgICAgIHF1ZXN0aW9uNS5zdHlsZS5tYXJnaW5Ub3AgPSAnMXJlbSc7CiAgICAgICAgcXVlc3Rpb241LnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcwJzsKICAgICAgICBsZXQgbGFiZWxBcmlhTW9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7CiAgICAgICAgbGFiZWxBcmlhTW9kZS5zZXRBdHRyaWJ1dGUoJ2ZvcicsICdhcmlhTW9kZScpOwogICAgICAgIGxhYmVsQXJpYU1vZGUudGV4dENvbnRlbnQgPSB0ZXh0WzIxXTsKICAgICAgICBsYWJlbEFyaWFNb2RlLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJzsKICAgICAgICBsYWJlbEFyaWFNb2RlLnN0eWxlLnBhZGRpbmdSaWdodCA9ICcwLjJyZW0nOwogICAgICAgIGxhYmVsQXJpYU1vZGUuc3R5bGUuY29sb3IgPSAnYmxhY2snOwogICAgICAgIHF1ZXN0aW9uNS5hcHBlbmRDaGlsZChsYWJlbEFyaWFNb2RlKTsKICAgICAgICBsZXQgaW5wdXRBcmlhTW9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7CiAgICAgICAgaW5wdXRBcmlhTW9kZS50eXBlID0gJ2NoZWNrYm94JzsKICAgICAgICBpbnB1dEFyaWFNb2RlLmlkID0gJ2FyaWFNb2RlJzsKICAgICAgICBpbnB1dEFyaWFNb2RlLmNoZWNrZWQgPSBHTV9nZXRWYWx1ZSgnYXJpYU1vZGUnLCBmYWxzZSk7CiAgICAgICAgcXVlc3Rpb241LmFwcGVuZENoaWxkKGlucHV0QXJpYU1vZGUpOwogICAgICAgIGxldCBhcmlhTW9kZUV4cGxhaW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7CiAgICAgICAgYXJpYU1vZGVFeHBsYWluLnRleHRDb250ZW50ID0gdGV4dFsyM107CiAgICAgICAgYXJpYU1vZGVFeHBsYWluLnN0eWxlLm1hcmdpblRvcCA9ICcwLjVyZW0nOwogICAgICAgIGFyaWFNb2RlRXhwbGFpbi5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMCc7CiAgICAgICAgYXJpYU1vZGVFeHBsYWluLnN0eWxlLmNvbG9yID0gJ2dyYXknOwogICAgICAgIHF1ZXN0aW9uNS5hcHBlbmRDaGlsZChhcmlhTW9kZUV4cGxhaW4pOwogICAgICAgIGxldCBsYWJlbEFyaWFScGNVcmwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpOwogICAgICAgIGxhYmVsQXJpYVJwY1VybC50ZXh0Q29udGVudCA9IHRleHRbMjJdOwogICAgICAgIGxhYmVsQXJpYVJwY1VybC5zZXRBdHRyaWJ1dGUoJ2ZvcicsICdhcmlhUnBjVXJsJyk7CiAgICAgICAgbGFiZWxBcmlhUnBjVXJsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgIGxhYmVsQXJpYVJwY1VybC5zdHlsZS5tYXJnaW5Ub3AgPSAnMC41cmVtJzsKICAgICAgICBsYWJlbEFyaWFScGNVcmwuc3R5bGUuY29sb3IgPSBHTV9nZXRWYWx1ZSgnYXJpYU1vZGUnLCBmYWxzZSkgPyAiYmxhY2siIDogImdyYXkiOwogICAgICAgIHF1ZXN0aW9uNS5hcHBlbmRDaGlsZChsYWJlbEFyaWFScGNVcmwpOwogICAgICAgIGxldCBpbnB1dEFyaWFScGNVcmwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOwogICAgICAgIGlucHV0QXJpYVJwY1VybC50eXBlID0gJ3RleHQnOwogICAgICAgIGlucHV0QXJpYVJwY1VybC5pZCA9ICdhcmlhUnBjVXJsJzsKICAgICAgICBpbnB1dEFyaWFScGNVcmwubmFtZSA9ICdhcmlhUnBjVXJsJzsKICAgICAgICBpbnB1dEFyaWFScGNVcmwuc3R5bGUubWFyZ2luVG9wID0gJzAuNXJlbSc7CiAgICAgICAgaW5wdXRBcmlhUnBjVXJsLnN0eWxlLndpZHRoID0gJ2NhbGMoMTAwJSAtIDFyZW0pJzsKICAgICAgICBpbnB1dEFyaWFScGNVcmwuc3R5bGUucGFkZGluZyA9ICcwLjFyZW0gMC4ycmVtIDAuMXJlbSAwLjJyZW0nOwogICAgICAgIGlucHV0QXJpYVJwY1VybC5zdHlsZS5ib3JkZXJTdHlsZSA9ICdzb2xpZCc7CiAgICAgICAgaW5wdXRBcmlhUnBjVXJsLnN0eWxlLmJvcmRlckNvbG9yID0gJ2xpZ2h0Z3JheSc7CiAgICAgICAgaW5wdXRBcmlhUnBjVXJsLnN0eWxlLmJvcmRlcldpZHRoID0gJzAuMTRyZW0nOwogICAgICAgIGlucHV0QXJpYVJwY1VybC5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnMC4ycmVtJzsKICAgICAgICBpbnB1dEFyaWFScGNVcmwuZGVmYXVsdFZhbHVlID0gR01fZ2V0VmFsdWUoJ2FyaWFScGNVcmwnLCAnaHR0cDovL2xvY2FsaG9zdDo2ODAwL2pzb25ycGMnKTsKICAgICAgICAvLyBpbnB1dEFyaWFScGNVcmwuc3R5bGUuZGlzcGxheSA9IEdNX2dldFZhbHVlKCdhcmlhTW9kZScsIGZhbHNlKSA/ICdibG9jaycgOiAnbm9uZSc7CiAgICAgICAgaW5wdXRBcmlhUnBjVXJsLmRpc2FibGVkID0gR01fZ2V0VmFsdWUoJ2FyaWFNb2RlJywgZmFsc2UpID8gZmFsc2UgOiB0cnVlOwogICAgICAgIHF1ZXN0aW9uNS5hcHBlbmRDaGlsZChpbnB1dEFyaWFScGNVcmwpOwogICAgICAgIGxldCBpbnB1dEFyaWFFeHBsYWluID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpOwogICAgICAgIGlucHV0QXJpYUV4cGxhaW4udGV4dENvbnRlbnQgPSB0ZXh0WzI0XTsKICAgICAgICBpbnB1dEFyaWFFeHBsYWluLnN0eWxlLm1hcmdpblRvcCA9ICcwLjVyZW0nOwogICAgICAgIGlucHV0QXJpYUV4cGxhaW4uc3R5bGUubWFyZ2luQm90dG9tID0gJzAnOwogICAgICAgIGlucHV0QXJpYUV4cGxhaW4uc3R5bGUuY29sb3IgPSAnZ3JheSc7CiAgICAgICAgcXVlc3Rpb241LmFwcGVuZENoaWxkKGlucHV0QXJpYUV4cGxhaW4pOwogICAgICAgIG1vZGFsLmFwcGVuZENoaWxkKHF1ZXN0aW9uNSk7CiAgICAgICAgbGV0IHF1ZXN0aW9uNiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTsKICAgICAgICBxdWVzdGlvbjYuc3R5bGUucGFkZGluZ0xlZnQgPSAnMnJlbSc7CiAgICAgICAgcXVlc3Rpb242LnN0eWxlLnBhZGRpbmdSaWdodCA9ICcycmVtJzsKICAgICAgICBxdWVzdGlvbjYuc3R5bGUubWFyZ2luVG9wID0gJzFyZW0nOwogICAgICAgIHF1ZXN0aW9uNi5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMCc7CiAgICAgICAgbGV0IGxhYmVsRGxWaWRDb3YgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpOwogICAgICAgIGxhYmVsRGxWaWRDb3Yuc2V0QXR0cmlidXRlKCdmb3InLCAnZGxWaWRDb3YnKTsKICAgICAgICBsYWJlbERsVmlkQ292LnRleHRDb250ZW50ID0gdGV4dFsyOF07CiAgICAgICAgbGFiZWxEbFZpZENvdi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7CiAgICAgICAgbGFiZWxEbFZpZENvdi5zdHlsZS5wYWRkaW5nUmlnaHQgPSAnMC4ycmVtJzsKICAgICAgICBsYWJlbERsVmlkQ292LnN0eWxlLmNvbG9yID0gImJsYWNrIjsKICAgICAgICBxdWVzdGlvbjYuYXBwZW5kQ2hpbGQobGFiZWxEbFZpZENvdik7CiAgICAgICAgbGV0IGlucHV0RGxWaWRDb3YgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOwogICAgICAgIGlucHV0RGxWaWRDb3YudHlwZSA9ICdjaGVja2JveCc7CiAgICAgICAgaW5wdXREbFZpZENvdi5pZCA9ICdkbFZpZENvdic7CiAgICAgICAgaW5wdXREbFZpZENvdi5jaGVja2VkID0gR01fZ2V0VmFsdWUoJ2RsVmlkQ292JywgdHJ1ZSk7CiAgICAgICAgcXVlc3Rpb242LmFwcGVuZENoaWxkKGlucHV0RGxWaWRDb3YpOwogICAgICAgIG1vZGFsLmFwcGVuZENoaWxkKHF1ZXN0aW9uNik7CiAgICAgICAgbGV0IHF1ZXN0aW9uNyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTsKICAgICAgICBxdWVzdGlvbjcuc3R5bGUucGFkZGluZ0xlZnQgPSAnMnJlbSc7CiAgICAgICAgcXVlc3Rpb243LnN0eWxlLnBhZGRpbmdSaWdodCA9ICcycmVtJzsKICAgICAgICBxdWVzdGlvbjcuc3R5bGUubWFyZ2luVG9wID0gJzFyZW0nOwogICAgICAgIHF1ZXN0aW9uNy5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMCc7CiAgICAgICAgbGV0IGxhYmVsUm1XdHJNcmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpOwogICAgICAgIGxhYmVsUm1XdHJNcmsuc2V0QXR0cmlidXRlKCdmb3InLCAncm1XdHJNcmsnKTsKICAgICAgICBsYWJlbFJtV3RyTXJrLnRleHRDb250ZW50ID0gdGV4dFsyOV07CiAgICAgICAgbGFiZWxSbVd0ck1yay5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7CiAgICAgICAgbGFiZWxSbVd0ck1yay5zdHlsZS5wYWRkaW5nUmlnaHQgPSAnMC4ycmVtJzsKICAgICAgICBsYWJlbFJtV3RyTXJrLnN0eWxlLmNvbG9yID0gImJsYWNrIjsKICAgICAgICBxdWVzdGlvbjcuYXBwZW5kQ2hpbGQobGFiZWxSbVd0ck1yayk7CiAgICAgICAgbGV0IGlucHV0Um1XdHJNcmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOwogICAgICAgIGlucHV0Um1XdHJNcmsudHlwZSA9ICdjaGVja2JveCc7CiAgICAgICAgaW5wdXRSbVd0ck1yay5pZCA9ICdybVd0ck1yayc7CiAgICAgICAgaW5wdXRSbVd0ck1yay5jaGVja2VkID0gR01fZ2V0VmFsdWUoJ3JtV3RyTXJrJywgZmFsc2UpOwogICAgICAgIHF1ZXN0aW9uNy5hcHBlbmRDaGlsZChpbnB1dFJtV3RyTXJrKTsKICAgICAgICBsZXQgcm1XdHJNcmtFeHBsYWluID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpOwogICAgICAgIHJtV3RyTXJrRXhwbGFpbi5pbm5lckhUTUwgPSB0ZXh0WzMwXTsKICAgICAgICBybVd0ck1ya0V4cGxhaW4uc3R5bGUubWFyZ2luVG9wID0gJzAuNXJlbSc7CiAgICAgICAgcm1XdHJNcmtFeHBsYWluLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcwJzsKICAgICAgICBybVd0ck1ya0V4cGxhaW4uc3R5bGUud2hpdGVTcGFjZSA9ICdwcmUnOwogICAgICAgIHJtV3RyTXJrRXhwbGFpbi5zdHlsZS5jb2xvciA9ICdncmF5JzsKICAgICAgICBxdWVzdGlvbjcuYXBwZW5kQ2hpbGQocm1XdHJNcmtFeHBsYWluKTsKICAgICAgICBtb2RhbC5hcHBlbmRDaGlsZChxdWVzdGlvbjcpOwogICAgICAgIGlucHV0UmV0d2VldE1vZGUuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICAgICAgaWYgKGV2ZW50LmN1cnJlbnRUYXJnZXQuY2hlY2tlZCkgewogICAgICAgICAgICAgICAgLy8gbGFiZWxSZXR3ZWV0RmlsZU5hbWUuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgICAgICAvLyBpbnB1dFJldHdlZXRGaWxlTmFtZS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgICAgIC8vIHJldHdlZXRGaWxlTmFtZUV4cGxhaW4uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgICAgICBpbnB1dFJldHdlZXRGaWxlTmFtZS5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgbGFiZWxSZXR3ZWV0RmlsZU5hbWUuc3R5bGUuY29sb3IgPSAiYmxhY2siOwogICAgICAgICAgICAgICAgaW5wdXRSZXR3ZWV0RmlsZU5hbWUuc3R5bGUuYm9yZGVyQ29sb3IgPSAnZ3JheSc7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBsYWJlbFJldHdlZXRGaWxlTmFtZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgLy8gaW5wdXRSZXR3ZWV0RmlsZU5hbWUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgIC8vIHJldHdlZXRGaWxlTmFtZUV4cGxhaW4uc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgIGlucHV0UmV0d2VldEZpbGVOYW1lLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGxhYmVsUmV0d2VldEZpbGVOYW1lLnN0eWxlLmNvbG9yID0gJ2dyYXknOwogICAgICAgICAgICAgICAgaW5wdXRSZXR3ZWV0RmlsZU5hbWUuc3R5bGUuYm9yZGVyQ29sb3IgPSAnbGlnaHRncmF5JzsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoZXZlbnQuY3VycmVudFRhcmdldC5jaGVja2VkICYmIGlucHV0WmlwTW9kZS5jaGVja2VkICYmICFpbnB1dEFyaWFNb2RlLmNoZWNrZWQpIHsKICAgICAgICAgICAgICAgIGlucHV0UmV0d2VldFBhY2tOYW1lLmRpc2FibGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBsYWJlbFJldHdlZXRQYWNrTmFtZS5zdHlsZS5jb2xvciA9ICJibGFjayI7CiAgICAgICAgICAgICAgICBpbnB1dFJldHdlZXRQYWNrTmFtZS5zdHlsZS5ib3JkZXJDb2xvciA9ICdncmF5JzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlucHV0UmV0d2VldFBhY2tOYW1lLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGxhYmVsUmV0d2VldFBhY2tOYW1lLnN0eWxlLmNvbG9yID0gJ2dyYXknOwogICAgICAgICAgICAgICAgaW5wdXRSZXR3ZWV0UGFja05hbWUuc3R5bGUuYm9yZGVyQ29sb3IgPSAnbGlnaHRncmF5JzsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIGlucHV0WmlwTW9kZS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICBpZiAoZXZlbnQuY3VycmVudFRhcmdldC5jaGVja2VkKSB7CiAgICAgICAgICAgICAgICAvLyBsYWJlbFBhY2tOYW1lLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgICAgICAgICAgLy8gaW5wdXRQYWNrTmFtZS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgICAgIC8vIGZpbGVQYWNrRXhwbGFpbi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgICAgIGlucHV0UGFja05hbWUuZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGxhYmVsUGFja05hbWUuc3R5bGUuY29sb3IgPSAiYmxhY2siOwogICAgICAgICAgICAgICAgaW5wdXRQYWNrTmFtZS5zdHlsZS5ib3JkZXJDb2xvciA9ICdncmF5JzsKICAgICAgICAgICAgICAgIGlucHV0QXJpYU1vZGUuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgbGFiZWxBcmlhTW9kZS5zdHlsZS5jb2xvciA9ICJncmF5IjsKICAgICAgICAgICAgICAgIC8vIGlucHV0QXJpYU1vZGUuY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gbGFiZWxQYWNrTmFtZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgLy8gaW5wdXRQYWNrTmFtZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgLy8gZmlsZVBhY2tFeHBsYWluLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICBpbnB1dFBhY2tOYW1lLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGxhYmVsUGFja05hbWUuc3R5bGUuY29sb3IgPSAnZ3JheSc7CiAgICAgICAgICAgICAgICBpbnB1dFBhY2tOYW1lLnN0eWxlLmJvcmRlckNvbG9yID0gJ2xpZ2h0Z3JheSc7CiAgICAgICAgICAgICAgICBpbnB1dEFyaWFNb2RlLmRpc2FibGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBsYWJlbEFyaWFNb2RlLnN0eWxlLmNvbG9yID0gImJsYWNrIjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoZXZlbnQuY3VycmVudFRhcmdldC5jaGVja2VkICYmIGlucHV0UmV0d2VldE1vZGUuY2hlY2tlZCkgewogICAgICAgICAgICAgICAgaW5wdXRSZXR3ZWV0UGFja05hbWUuZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGxhYmVsUmV0d2VldFBhY2tOYW1lLnN0eWxlLmNvbG9yID0gImJsYWNrIjsKICAgICAgICAgICAgICAgIGlucHV0UmV0d2VldFBhY2tOYW1lLnN0eWxlLmJvcmRlckNvbG9yID0gJ2dyYXknOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaW5wdXRSZXR3ZWV0UGFja05hbWUuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgbGFiZWxSZXR3ZWV0UGFja05hbWUuc3R5bGUuY29sb3IgPSAnZ3JheSc7CiAgICAgICAgICAgICAgICBpbnB1dFJldHdlZXRQYWNrTmFtZS5zdHlsZS5ib3JkZXJDb2xvciA9ICdsaWdodGdyYXknOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgaW5wdXRBcmlhTW9kZS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICBpZiAoZXZlbnQuY3VycmVudFRhcmdldC5jaGVja2VkKSB7CiAgICAgICAgICAgICAgICAvLyBsYWJlbEFyaWFScGNVcmwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgICAgICAvLyBpbnB1dEFyaWFScGNVcmwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgICAgICBpbnB1dEFyaWFScGNVcmwuZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGxhYmVsQXJpYVJwY1VybC5zdHlsZS5jb2xvciA9ICJibGFjayI7CiAgICAgICAgICAgICAgICBpbnB1dEFyaWFScGNVcmwuc3R5bGUuYm9yZGVyQ29sb3IgPSAnZ3JheSc7CiAgICAgICAgICAgICAgICBpbnB1dFppcE1vZGUuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgbGFiZWxaaXBNb2RlLnN0eWxlLmNvbG9yID0gJ2dyYXknOwogICAgICAgICAgICAgICAgLy8gaW5wdXRaaXBNb2RlLmNoZWNrZWQgPSBmYWxzZTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIGxhYmVsQXJpYVJwY1VybC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgLy8gaW5wdXRBcmlhUnBjVXJsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICBpbnB1dEFyaWFScGNVcmwuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgbGFiZWxBcmlhUnBjVXJsLnN0eWxlLmNvbG9yID0gJ2dyYXknOwogICAgICAgICAgICAgICAgaW5wdXRBcmlhUnBjVXJsLnN0eWxlLmJvcmRlckNvbG9yID0gJ2xpZ2h0Z3JheSc7CiAgICAgICAgICAgICAgICBpbnB1dFppcE1vZGUuZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGxhYmVsWmlwTW9kZS5zdHlsZS5jb2xvciA9ICJibGFjayI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFldmVudC5jdXJyZW50VGFyZ2V0LmNoZWNrZWQgJiYgaW5wdXRaaXBNb2RlLmNoZWNrZWQpIHsKICAgICAgICAgICAgICAgIGlucHV0UGFja05hbWUuZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGxhYmVsUGFja05hbWUuc3R5bGUuY29sb3IgPSAiYmxhY2siOwogICAgICAgICAgICAgICAgaW5wdXRQYWNrTmFtZS5zdHlsZS5ib3JkZXJDb2xvciA9ICdncmF5JzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlucHV0UGFja05hbWUuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgbGFiZWxQYWNrTmFtZS5zdHlsZS5jb2xvciA9ICdncmF5JzsKICAgICAgICAgICAgICAgIGlucHV0UGFja05hbWUuc3R5bGUuYm9yZGVyQ29sb3IgPSAnbGlnaHRncmF5JzsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIWV2ZW50LmN1cnJlbnRUYXJnZXQuY2hlY2tlZCAmJiBpbnB1dFppcE1vZGUuY2hlY2tlZCAmJiBpbnB1dFJldHdlZXRNb2RlLmNoZWNrZWQpIHsKICAgICAgICAgICAgICAgIGlucHV0UmV0d2VldFBhY2tOYW1lLmRpc2FibGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBsYWJlbFJldHdlZXRQYWNrTmFtZS5zdHlsZS5jb2xvciA9ICJibGFjayI7CiAgICAgICAgICAgICAgICBpbnB1dFJldHdlZXRQYWNrTmFtZS5zdHlsZS5ib3JkZXJDb2xvciA9ICdncmF5JzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlucHV0UmV0d2VldFBhY2tOYW1lLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGxhYmVsUmV0d2VldFBhY2tOYW1lLnN0eWxlLmNvbG9yID0gJ2dyYXknOwogICAgICAgICAgICAgICAgaW5wdXRSZXR3ZWV0UGFja05hbWUuc3R5bGUuYm9yZGVyQ29sb3IgPSAnbGlnaHRncmF5JzsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIGxldCBva0J1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICAgIG9rQnV0dG9uLnRleHRDb250ZW50ID0gdGV4dFs1XTsKICAgICAgICBva0J1dHRvbi5zdHlsZS5wYWRkaW5nVG9wID0gJzAuNXJlbSc7CiAgICAgICAgb2tCdXR0b24uc3R5bGUucGFkZGluZ0JvdHRvbSA9ICcwLjVyZW0nOwogICAgICAgIG9rQnV0dG9uLnN0eWxlLm1hcmdpbiA9ICcycmVtJzsKICAgICAgICBva0J1dHRvbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnZGFya2JsdWUnOwogICAgICAgIG9rQnV0dG9uLnN0eWxlLmNvbG9yID0gJ3doaXRlJzsKICAgICAgICBva0J1dHRvbi5zdHlsZS5mb250U2l6ZSA9ICcxLjVyZW0nOwogICAgICAgIG9rQnV0dG9uLnN0eWxlLmZvbnRXZWlnaHQgPSAnYm9sZCc7CiAgICAgICAgb2tCdXR0b24uc3R5bGUud2lkdGggPSAnMjFyZW0nOwogICAgICAgIG9rQnV0dG9uLnN0eWxlLmJvcmRlclN0eWxlID0gJ3NvbGlkJzsKICAgICAgICBva0J1dHRvbi5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnMC41cmVtJzsKICAgICAgICBva0J1dHRvbi5zdHlsZS5ib3JkZXJDb2xvciA9ICdibGFjayc7CiAgICAgICAgb2tCdXR0b24uc3R5bGUuYm9yZGVyV2lkdGggPSAnMC4ycmVtJzsKICAgICAgICBva0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICBva0J1dHRvbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnYmx1ZSc7CiAgICAgICAgfSk7CiAgICAgICAgb2tCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdXQnLCBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICBva0J1dHRvbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnZGFya2JsdWUnOwogICAgICAgIH0pOwogICAgICAgIG9rQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgICAgIG9rQnV0dG9uLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdkYXJrYmx1ZSc7CiAgICAgICAgfSk7CiAgICAgICAgb2tCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICAgICAgb2tCdXR0b24uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ2JsdWUnOwogICAgICAgIH0pOwogICAgICAgIGZ1bmN0aW9uIHJlc2l6ZVdpbmRvdyhldmVudCkgewogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygncmVzaXplJyk7CiAgICAgICAgICAgIGJnLnN0eWxlLndpZHRoID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoLnRvU3RyaW5nKCkgKyAncHgnOwogICAgICAgICAgICBiZy5zdHlsZS5oZWlnaHQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0LnRvU3RyaW5nKCkgKyAncHgnOwogICAgICAgICAgICBtb2RhbC5zdHlsZS50b3AgPSAoKCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gbW9kYWwub2Zmc2V0SGVpZ2h0ICkgLyAyKS50b1N0cmluZygpICsgJ3B4JzsKICAgICAgICAgICAgbW9kYWwuc3R5bGUubGVmdCA9ICgoIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCAtIG1vZGFsLm9mZnNldFdpZHRoICkgLyAyKS50b1N0cmluZygpICsgJ3B4JzsKICAgICAgICB9CiAgICAgICAgb2tCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICAvKmlmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaG9vc2VCdXR0b24nKS5jaGVja2VkID09IHRydWUpIHsKICAgICAgICAgICAgICAgIEdNX3NldFZhbHVlKCdhZGREbEJ0bk1vZGUnLCAxKTsKICAgICAgICAgICAgICAgIGFkZERsQnRuTW9kZSA9IDE7CiAgICAgICAgICAgICAgICBhZGRTdGFydEJ1dHRvbigpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgR01fc2V0VmFsdWUoJ2FkZERsQnRuTW9kZScsIDIpOwogICAgICAgICAgICAgICAgYWRkRGxCdG5Nb2RlID0gMjsKICAgICAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIoKTsKICAgICAgICAgICAgfSovCiAgICAgICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnemlwTW9kZScpLmNoZWNrZWQgJiYgIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkbEZpbGVOYW1lJykudmFsdWUuaW5jbHVkZXMoJ3tvcmlnaW5hbH0nKSAmJiAhZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RsRmlsZU5hbWUnKS52YWx1ZS5pbmNsdWRlcygne2luZGV4fScpKSB7CiAgICAgICAgICAgICAgICBhbGVydCh0ZXh0WzI3XS5yZXBsYWNlQWxsKC9cbi9nLCAnJykpOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RsRmlsZU5hbWUnKS5mb2N1cygpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIEdNX3NldFZhbHVlKCdkbEZpbGVOYW1lJywgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RsRmlsZU5hbWUnKS52YWx1ZSk7CiAgICAgICAgICAgIEdNX3NldFZhbHVlKCdyZXR3ZWV0TW9kZScsIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXR3ZWV0TW9kZScpLmNoZWNrZWQpOwogICAgICAgICAgICBHTV9zZXRWYWx1ZSgncmV0d2VldEZpbGVOYW1lJywgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JldHdlZXRGaWxlTmFtZScpLnZhbHVlKTsKICAgICAgICAgICAgR01fc2V0VmFsdWUoJ3ppcE1vZGUnLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnemlwTW9kZScpLmNoZWNrZWQpOwogICAgICAgICAgICBHTV9zZXRWYWx1ZSgncGFja0ZpbGVOYW1lJywgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhY2tGaWxlTmFtZScpLnZhbHVlKTsKICAgICAgICAgICAgR01fc2V0VmFsdWUoJ3JldHdlZXRQYWNrRmlsZU5hbWUnLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV0d2VldFBhY2tGaWxlTmFtZScpLnZhbHVlKTsKICAgICAgICAgICAgR01fc2V0VmFsdWUoJ2FyaWFNb2RlJywgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FyaWFNb2RlJykuY2hlY2tlZCk7CiAgICAgICAgICAgIEdNX3NldFZhbHVlKCdhcmlhUnBjVXJsJywgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FyaWFScGNVcmwnKS52YWx1ZSk7CiAgICAgICAgICAgIEdNX3NldFZhbHVlKCdkbFZpZENvdicsIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkbFZpZENvdicpLmNoZWNrZWQpOwogICAgICAgICAgICBHTV9zZXRWYWx1ZSgncm1XdHJNcmsnLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncm1XdHJNcmsnKS5jaGVja2VkKTsKICAgICAgICAgICAgR01fc2V0VmFsdWUoJ2lzU2V0Jywgc2V0dGluZ1ZlcnNpb24pOwogICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG1vZGFsKTsKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChiZyk7CiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCByZXNpemVXaW5kb3cpOwogICAgICAgIH0pOwogICAgICAgIG1vZGFsLmFwcGVuZENoaWxkKG9rQnV0dG9uKTsKICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG1vZGFsKTsKICAgICAgICAvKmJnLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChtb2RhbCk7CiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoYmcpOwogICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgcmVzaXplV2luZG93KTsKICAgICAgICB9KTsqLwogICAgICAgIHJlc2l6ZVdpbmRvdygpOwogICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCByZXNpemVXaW5kb3cpOwogICAgfQoKICAgIGxldCBzdmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnX19TVkdfU1BSSVRFX05PREVfXycpOwogICAgbGV0IHN5bWJvbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnc3ltYm9sJyk7CiAgICBzeW1ib2wuaWQgPSAnd29vX3N2Z19kb3dubG9hZCc7CiAgICBzeW1ib2wuc2V0QXR0cmlidXRlKCd2aWV3Qm94JywgJzAgMCAxMDAgMTAwJyk7CiAgICBzeW1ib2wuaW5uZXJIVE1MID0gJzxwYXRoIGQ9Im0yNSwwbDUwLDBsMCw1MGwyNSwwbC01MCw1MGwtNTAsLTUwbDI1LDBsMCwtNTAiIGZpbGw9ImN1cnJlbnRDb2xvciI+PC9wYXRoPjxwYXRoIGQ9Im0zMCw1bDQwLDBsMCw1MGwyMCwwbC00MCw0MGwtNDAsLTQwbDIwLDBsMCwtNTAiIGZpbGw9IndoaXRlIj48L3BhdGg+JzsKICAgIHN2Zy5hcHBlbmRDaGlsZChzeW1ib2wpOwovKgogICAgaWYoYWRkRGxCdG5Nb2RlID09IDApIHsKICAgICAgICBzaG93TW9kYWwoKTsKICAgIH0gZWxzZSBpZiAoYWRkRGxCdG5Nb2RlID09IDEpIHsKICAgICAgICBhZGRTdGFydEJ1dHRvbigpOwogICAgfSBlbHNlIGlmIChhZGREbEJ0bk1vZGUgPT0gMikgewogICAgICAgIGFkZEV2ZW50TGlzdGVuZXIoKTsKICAgIH0KKi8KICAgIGlmKEdNX2dldFZhbHVlKCdpc1NldCcsIG51bGwpICE9PSBzZXR0aW5nVmVyc2lvbikgewogICAgICAgIHNob3dNb2RhbCgpOwogICAgfQogICAgbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dGF0aW9uTGlzdCwgb2JzZXJ2ZXIpID0+IHsKICAgICAgICAvLyBjb25zb2xlLmxvZyhtdXRhdGlvbkxpc3QpOwogICAgICAgIGlmIChsb2NhdGlvbi5ob3N0ID09ICd3ZWliby5jb20nIHx8IGxvY2F0aW9uLmhvc3QgPT0gJ3d3dy53ZWliby5jb20nKSB7CiAgICAgICAgICAgIGNvbnN0IGNhcmRzID0gZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yQWxsKCdhcnRpY2xlLndvby1wYW5lbC1tYWluJyk7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGNhcmRzKTsKICAgICAgICAgICAgZm9yIChjb25zdCBjYXJkIG9mIGNhcmRzKSB7CiAgICAgICAgICAgICAgICBoYW5kbGVDYXJkKGNhcmQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25MaXN0KSB7CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhtdXRhdGlvbi50YXJnZXQpOwogICAgICAgICAgICAgICAgaWYgKG11dGF0aW9uLnR5cGUgPT09ICdjaGlsZExpc3QnICYmIG11dGF0aW9uLnRhcmdldC50YWdOYW1lID09PSAnRElWJyAmJiAobXV0YXRpb24udGFyZ2V0LmNsYXNzTmFtZS5pbmNsdWRlcygnd2Jwcm8tZmVlZC1jb250ZW50JykgfHwgbXV0YXRpb24udGFyZ2V0LmNsYXNzTmFtZS5pbmNsdWRlcygnRmVlZF9yZXR3ZWV0X0pxWkpiJykpKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIG11dGF0aW9uLmFkZGVkTm9kZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cobm9kZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGltZ3MgPSBub2RlLnF1ZXJ5U2VsZWN0b3JBbGwoJ2ltZy53b28tcGljdHVyZS1pbWcsaW1nLnBpY3R1cmVfZm9jdXNJbWdfMXo1SW4saW1nLnBpY3R1cmUtdmlld2VyX3BpY18zN1lRMyx2aWRlby5waWN0dXJlLXZpZXdlcl9waWNfMzdZUTMnKTsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coaW1ncyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgWyBpZHgsIGltZyBdIG9mIE9iamVjdC5lbnRyaWVzKGltZ3MpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW1nLnBhcmVudEVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZG93bmxvYWQtc2luZ2xlLWJ1dHRvbicpLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbWcuY2xhc3NOYW1lLmluY2x1ZGVzKCdwaWN0dXJlLXZpZXdlcl9waWNfMzdZUTMnKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2aWV3cyA9IG5vZGUucXVlcnlTZWxlY3RvckFsbCgnZGl2LnBpY3R1cmUtdmlld2VyX3ByZXZpZXdfMndPU3EnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBbIGluZGV4LCBwcmV2aWV3IF0gb2YgT2JqZWN0LmVudHJpZXMocHJldmlld3MpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldmlldy5jbGFzc05hbWUuaW5jbHVkZXMoJ3BpY3R1cmUtdmlld2VyX2N1cl9hblVFWScpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkU2luZ2xlRGxCdG4oaW1nLCBwYXJzZUludChpbmRleCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkU2luZ2xlRGxCdG4oaW1nLCBwYXJzZUludChpZHgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGxvY2F0aW9uLmhvc3QgPT0gJ3Mud2VpYm8uY29tJykgewogICAgICAgICAgICAvLyBsZXQgY2FyZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjcGxfZmVlZGxpc3RfaW5kZXggLmNhcmQtd3JhcCcpOwogICAgICAgICAgICBjb25zdCBmb290ZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI3BsX2ZlZWRsaXN0X2luZGV4IC5jYXJkLWFjdCcpOwogICAgICAgICAgICBmb3IgKGNvbnN0IGZvb3RlciBvZiBmb290ZXJzKSB7CiAgICAgICAgICAgICAgICBpZihmb290ZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZG93bmxvYWQtYnV0dG9uJykubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdhbHJlYWR5IGFkZGVkIGRvd25sb2FkIGJ1dHRvbicpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhmb290ZXIucGFyZW50RWxlbWVudCk7CiAgICAgICAgICAgICAgICAgICAgaWYoZm9vdGVyLnBhcmVudEVsZW1lbnQuY2xhc3NOYW1lID09ICdjYXJkJyAmJiBmb290ZXIucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LmNsYXNzTmFtZSA9PSAnY2FyZC13cmFwJykgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYXJkID0gZm9vdGVyLnBhcmVudEVsZW1lbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBhZGRlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtZWRpYV9wcmV2ID0gY2FyZC5xdWVyeVNlbGVjdG9yKCdkaXZbbm9kZS10eXBlPSJmZWVkX2xpc3RfbWVkaWFfcHJldiJdJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKG1lZGlhX3ByZXYpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAobWVkaWFfcHJldikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaW1ncyA9IG1lZGlhX3ByZXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2ltZycpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coaW1ncyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpbWdzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzQWRkRGxCdG4oZm9vdGVyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2aWRlb3MgPSBjYXJkLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd2aWRlbycpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodmlkZW9zLmxlbmd0aCA+IDAgJiYgYWRkZWQgPT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzQWRkRGxCdG4oZm9vdGVyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0pLm9ic2VydmUoZG9jdW1lbnQuYm9keSwgeyBhdHRyaWJ1dGVzOiBmYWxzZSwgY2hpbGRMaXN0OiB0cnVlLCBzdWJ0cmVlOiB0cnVlIH0pOwoKICAgIGxldCBzZXR0aW5nQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICBzZXR0aW5nQnV0dG9uLnRleHRDb250ZW50ID0gdGV4dFs2XTsKICAgIHNldHRpbmdCdXR0b24uc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnOwogICAgc2V0dGluZ0J1dHRvbi5zdHlsZS50b3AgPSAnNHJlbSc7CiAgICBzZXR0aW5nQnV0dG9uLnN0eWxlLmxlZnQgPSAnMHJlbSc7CiAgICBzZXR0aW5nQnV0dG9uLnN0eWxlLmZvbnRTaXplID0gJzAuN3JlbSc7CiAgICBzZXR0aW5nQnV0dG9uLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdncmF5JzsKICAgIHNldHRpbmdCdXR0b24uc3R5bGUuY29sb3IgPSAnd2hpdGUnOwogICAgc2V0dGluZ0J1dHRvbi5zdHlsZS5ib3JkZXJXaWR0aCA9ICcwLjJyZW0nOwogICAgc2V0dGluZ0J1dHRvbi5zdHlsZS5ib3JkZXJTdHlsZSA9ICdzb2xpZCc7CiAgICBzZXR0aW5nQnV0dG9uLnN0eWxlLmJvcmRlclJhZGl1cyA9ICcwLjVyZW0nOwogICAgc2V0dGluZ0J1dHRvbi5zdHlsZS5ib3JkZXJDb2xvciA9ICdsaWdodGdyZXknOwogICAgc2V0dGluZ0J1dHRvbi5zdHlsZS56SW5kZXggPSA0MDA7CiAgICBzZXR0aW5nQnV0dG9uLnN0eWxlLnBhZGRpbmdMZWZ0ID0gJzFyZW0nOwogICAgc2V0dGluZ0J1dHRvbi5zdHlsZS5wYWRkaW5nUmlnaHQgPSAnMXJlbSc7CiAgICBzZXR0aW5nQnV0dG9uLnN0eWxlLnBhZGRpbmdUb3AgPSAnMC4ycmVtJzsKICAgIHNldHRpbmdCdXR0b24uc3R5bGUucGFkZGluZ0JvdHRvbSA9ICcwLjJyZW0nOwogICAgc2V0dGluZ0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCBmdW5jdGlvbihldmVudCkgewogICAgICAgIHNldHRpbmdCdXR0b24uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ2RhcmtncmF5JzsKICAgICAgICBzZXR0aW5nQnV0dG9uLnN0eWxlLmNvbG9yID0gJ2JsYWNrJzsKICAgIH0pOwogICAgc2V0dGluZ0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsIGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgc2V0dGluZ0J1dHRvbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnZ3JheSc7CiAgICAgICAgc2V0dGluZ0J1dHRvbi5zdHlsZS5jb2xvciA9ICd3aGl0ZSc7CiAgICB9KTsKICAgIHNldHRpbmdCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICBzZXR0aW5nQnV0dG9uLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdncmF5JzsKICAgICAgICBzZXR0aW5nQnV0dG9uLnN0eWxlLmNvbG9yID0gJ3doaXRlJzsKICAgIH0pOwogICAgc2V0dGluZ0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICBzZXR0aW5nQnV0dG9uLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdkYXJrZ3JheSc7CiAgICAgICAgc2V0dGluZ0J1dHRvbi5zdHlsZS5jb2xvciA9ICdibGFjayc7CiAgICB9KTsKICAgIHNldHRpbmdCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzaG93TW9kYWwpOwogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzZXR0aW5nQnV0dG9uKTsKICAgIEdNX3JlZ2lzdGVyTWVudUNvbW1hbmQodGV4dFsyNV0sIHNob3dNb2RhbCwgIjAiKTsKICAgIC8vIGNvbnNvbGUubG9nKEdNX2luZm8uZG93bmxvYWRNb2RlKTsKfSkoKTsK","requires":[{"meta":{"name":"jszip.min.js","url":"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.9.1/jszip.min.js","ts":1728754649680,"mimetype":"text/javascript"},"source":"LyohCgpKU1ppcCB2My45LjEgLSBBIEphdmFTY3JpcHQgY2xhc3MgZm9yIGdlbmVyYXRpbmcgYW5kIHJlYWRpbmcgemlwIGZpbGVzCjxodHRwOi8vc3R1YXJ0ay5jb20vanN6aXA+CgooYykgMjAwOS0yMDE2IFN0dWFydCBLbmlnaHRsZXkgPHN0dWFydCBbYXRdIHN0dWFydGsuY29tPgpEdWFsIGxpY2VuY2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBvciBHUEx2My4gU2VlIGh0dHBzOi8vcmF3LmdpdGh1Yi5jb20vU3R1ay9qc3ppcC9tYXN0ZXIvTElDRU5TRS5tYXJrZG93bi4KCkpTWmlwIHVzZXMgdGhlIGxpYnJhcnkgcGFrbyByZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgOgpodHRwczovL2dpdGh1Yi5jb20vbm9kZWNhL3Bha28vYmxvYi9tYXN0ZXIvTElDRU5TRQoqLwoKIWZ1bmN0aW9uKHQpe2lmKCJvYmplY3QiPT10eXBlb2YgZXhwb3J0cyYmInVuZGVmaW5lZCIhPXR5cGVvZiBtb2R1bGUpbW9kdWxlLmV4cG9ydHM9dCgpO2Vsc2UgaWYoImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZClkZWZpbmUoW10sdCk7ZWxzZXsoInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3c/d2luZG93OiJ1bmRlZmluZWQiIT10eXBlb2YgZ2xvYmFsP2dsb2JhbDoidW5kZWZpbmVkIiE9dHlwZW9mIHNlbGY/c2VsZjp0aGlzKS5KU1ppcD10KCl9fShmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbiBzKGEsbyxoKXtmdW5jdGlvbiB1KHIsdCl7aWYoIW9bcl0pe2lmKCFhW3JdKXt2YXIgZT0iZnVuY3Rpb24iPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighdCYmZSlyZXR1cm4gZShyLCEwKTtpZihsKXJldHVybiBsKHIsITApO3ZhciBpPW5ldyBFcnJvcigiQ2Fubm90IGZpbmQgbW9kdWxlICciK3IrIiciKTt0aHJvdyBpLmNvZGU9Ik1PRFVMRV9OT1RfRk9VTkQiLGl9dmFyIG49b1tyXT17ZXhwb3J0czp7fX07YVtyXVswXS5jYWxsKG4uZXhwb3J0cyxmdW5jdGlvbih0KXt2YXIgZT1hW3JdWzFdW3RdO3JldHVybiB1KGV8fHQpfSxuLG4uZXhwb3J0cyxzLGEsbyxoKX1yZXR1cm4gb1tyXS5leHBvcnRzfWZvcih2YXIgbD0iZnVuY3Rpb24iPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSx0PTA7dDxoLmxlbmd0aDt0KyspdShoW3RdKTtyZXR1cm4gdX0oezE6W2Z1bmN0aW9uKHQsZSxyKXsidXNlIHN0cmljdCI7dmFyIGM9dCgiLi91dGlscyIpLGQ9dCgiLi9zdXBwb3J0IikscD0iQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLz0iO3IuZW5jb2RlPWZ1bmN0aW9uKHQpe2Zvcih2YXIgZSxyLGksbixzLGEsbyxoPVtdLHU9MCxsPXQubGVuZ3RoLGY9bCxkPSJzdHJpbmciIT09Yy5nZXRUeXBlT2YodCk7dTx0Lmxlbmd0aDspZj1sLXUsaT1kPyhlPXRbdSsrXSxyPXU8bD90W3UrK106MCx1PGw/dFt1KytdOjApOihlPXQuY2hhckNvZGVBdCh1KyspLHI9dTxsP3QuY2hhckNvZGVBdCh1KyspOjAsdTxsP3QuY2hhckNvZGVBdCh1KyspOjApLG49ZT4+MixzPSgzJmUpPDw0fHI+PjQsYT0xPGY/KDE1JnIpPDwyfGk+PjY6NjQsbz0yPGY/NjMmaTo2NCxoLnB1c2gocC5jaGFyQXQobikrcC5jaGFyQXQocykrcC5jaGFyQXQoYSkrcC5jaGFyQXQobykpO3JldHVybiBoLmpvaW4oIiIpfSxyLmRlY29kZT1mdW5jdGlvbih0KXt2YXIgZSxyLGksbixzLGEsbz0wLGg9MCx1PSJkYXRhOiI7aWYodC5zdWJzdHIoMCx1Lmxlbmd0aCk9PT11KXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBiYXNlNjQgaW5wdXQsIGl0IGxvb2tzIGxpa2UgYSBkYXRhIHVybC4iKTt2YXIgbCxmPTMqKHQ9dC5yZXBsYWNlKC9bXkEtWmEtejAtOVwrXC9cPV0vZywiIikpLmxlbmd0aC80O2lmKHQuY2hhckF0KHQubGVuZ3RoLTEpPT09cC5jaGFyQXQoNjQpJiZmLS0sdC5jaGFyQXQodC5sZW5ndGgtMik9PT1wLmNoYXJBdCg2NCkmJmYtLSxmJTEhPTApdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGJhc2U2NCBpbnB1dCwgYmFkIGNvbnRlbnQgbGVuZ3RoLiIpO2ZvcihsPWQudWludDhhcnJheT9uZXcgVWludDhBcnJheSgwfGYpOm5ldyBBcnJheSgwfGYpO288dC5sZW5ndGg7KWU9cC5pbmRleE9mKHQuY2hhckF0KG8rKykpPDwyfChuPXAuaW5kZXhPZih0LmNoYXJBdChvKyspKSk+PjQscj0oMTUmbik8PDR8KHM9cC5pbmRleE9mKHQuY2hhckF0KG8rKykpKT4+MixpPSgzJnMpPDw2fChhPXAuaW5kZXhPZih0LmNoYXJBdChvKyspKSksbFtoKytdPWUsNjQhPT1zJiYobFtoKytdPXIpLDY0IT09YSYmKGxbaCsrXT1pKTtyZXR1cm4gbH19LHsiLi9zdXBwb3J0IjozMCwiLi91dGlscyI6MzJ9XSwyOltmdW5jdGlvbih0LGUscil7InVzZSBzdHJpY3QiO3ZhciBpPXQoIi4vZXh0ZXJuYWwiKSxuPXQoIi4vc3RyZWFtL0RhdGFXb3JrZXIiKSxzPXQoIi4vc3RyZWFtL0NyYzMyUHJvYmUiKSxhPXQoIi4vc3RyZWFtL0RhdGFMZW5ndGhQcm9iZSIpO2Z1bmN0aW9uIG8odCxlLHIsaSxuKXt0aGlzLmNvbXByZXNzZWRTaXplPXQsdGhpcy51bmNvbXByZXNzZWRTaXplPWUsdGhpcy5jcmMzMj1yLHRoaXMuY29tcHJlc3Npb249aSx0aGlzLmNvbXByZXNzZWRDb250ZW50PW59by5wcm90b3R5cGU9e2dldENvbnRlbnRXb3JrZXI6ZnVuY3Rpb24oKXt2YXIgdD1uZXcgbihpLlByb21pc2UucmVzb2x2ZSh0aGlzLmNvbXByZXNzZWRDb250ZW50KSkucGlwZSh0aGlzLmNvbXByZXNzaW9uLnVuY29tcHJlc3NXb3JrZXIoKSkucGlwZShuZXcgYSgiZGF0YV9sZW5ndGgiKSksZT10aGlzO3JldHVybiB0Lm9uKCJlbmQiLGZ1bmN0aW9uKCl7aWYodGhpcy5zdHJlYW1JbmZvLmRhdGFfbGVuZ3RoIT09ZS51bmNvbXByZXNzZWRTaXplKXRocm93IG5ldyBFcnJvcigiQnVnIDogdW5jb21wcmVzc2VkIGRhdGEgc2l6ZSBtaXNtYXRjaCIpfSksdH0sZ2V0Q29tcHJlc3NlZFdvcmtlcjpmdW5jdGlvbigpe3JldHVybiBuZXcgbihpLlByb21pc2UucmVzb2x2ZSh0aGlzLmNvbXByZXNzZWRDb250ZW50KSkud2l0aFN0cmVhbUluZm8oImNvbXByZXNzZWRTaXplIix0aGlzLmNvbXByZXNzZWRTaXplKS53aXRoU3RyZWFtSW5mbygidW5jb21wcmVzc2VkU2l6ZSIsdGhpcy51bmNvbXByZXNzZWRTaXplKS53aXRoU3RyZWFtSW5mbygiY3JjMzIiLHRoaXMuY3JjMzIpLndpdGhTdHJlYW1JbmZvKCJjb21wcmVzc2lvbiIsdGhpcy5jb21wcmVzc2lvbil9fSxvLmNyZWF0ZVdvcmtlckZyb209ZnVuY3Rpb24odCxlLHIpe3JldHVybiB0LnBpcGUobmV3IHMpLnBpcGUobmV3IGEoInVuY29tcHJlc3NlZFNpemUiKSkucGlwZShlLmNvbXByZXNzV29ya2VyKHIpKS5waXBlKG5ldyBhKCJjb21wcmVzc2VkU2l6ZSIpKS53aXRoU3RyZWFtSW5mbygiY29tcHJlc3Npb24iLGUpfSxlLmV4cG9ydHM9b30seyIuL2V4dGVybmFsIjo2LCIuL3N0cmVhbS9DcmMzMlByb2JlIjoyNSwiLi9zdHJlYW0vRGF0YUxlbmd0aFByb2JlIjoyNiwiLi9zdHJlYW0vRGF0YVdvcmtlciI6Mjd9XSwzOltmdW5jdGlvbih0LGUscil7InVzZSBzdHJpY3QiO3ZhciBpPXQoIi4vc3RyZWFtL0dlbmVyaWNXb3JrZXIiKTtyLlNUT1JFPXttYWdpYzoiXDBcMCIsY29tcHJlc3NXb3JrZXI6ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBpKCJTVE9SRSBjb21wcmVzc2lvbiIpfSx1bmNvbXByZXNzV29ya2VyOmZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBpKCJTVE9SRSBkZWNvbXByZXNzaW9uIil9fSxyLkRFRkxBVEU9dCgiLi9mbGF0ZSIpfSx7Ii4vZmxhdGUiOjcsIi4vc3RyZWFtL0dlbmVyaWNXb3JrZXIiOjI4fV0sNDpbZnVuY3Rpb24odCxlLHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgaT10KCIuL3V0aWxzIik7dmFyIG89ZnVuY3Rpb24oKXtmb3IodmFyIHQsZT1bXSxyPTA7cjwyNTY7cisrKXt0PXI7Zm9yKHZhciBpPTA7aTw4O2krKyl0PTEmdD8zOTg4MjkyMzg0XnQ+Pj4xOnQ+Pj4xO2Vbcl09dH1yZXR1cm4gZX0oKTtlLmV4cG9ydHM9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdm9pZCAwIT09dCYmdC5sZW5ndGg/InN0cmluZyIhPT1pLmdldFR5cGVPZih0KT9mdW5jdGlvbih0LGUscixpKXt2YXIgbj1vLHM9aStyO3RePS0xO2Zvcih2YXIgYT1pO2E8czthKyspdD10Pj4+OF5uWzI1NSYodF5lW2FdKV07cmV0dXJuLTFedH0oMHxlLHQsdC5sZW5ndGgsMCk6ZnVuY3Rpb24odCxlLHIsaSl7dmFyIG49byxzPWkrcjt0Xj0tMTtmb3IodmFyIGE9aTthPHM7YSsrKXQ9dD4+PjheblsyNTUmKHReZS5jaGFyQ29kZUF0KGEpKV07cmV0dXJuLTFedH0oMHxlLHQsdC5sZW5ndGgsMCk6MH19LHsiLi91dGlscyI6MzJ9XSw1OltmdW5jdGlvbih0LGUscil7InVzZSBzdHJpY3QiO3IuYmFzZTY0PSExLHIuYmluYXJ5PSExLHIuZGlyPSExLHIuY3JlYXRlRm9sZGVycz0hMCxyLmRhdGU9bnVsbCxyLmNvbXByZXNzaW9uPW51bGwsci5jb21wcmVzc2lvbk9wdGlvbnM9bnVsbCxyLmNvbW1lbnQ9bnVsbCxyLnVuaXhQZXJtaXNzaW9ucz1udWxsLHIuZG9zUGVybWlzc2lvbnM9bnVsbH0se31dLDY6W2Z1bmN0aW9uKHQsZSxyKXsidXNlIHN0cmljdCI7dmFyIGk9bnVsbDtpPSJ1bmRlZmluZWQiIT10eXBlb2YgUHJvbWlzZT9Qcm9taXNlOnQoImxpZSIpLGUuZXhwb3J0cz17UHJvbWlzZTppfX0se2xpZTozN31dLDc6W2Z1bmN0aW9uKHQsZSxyKXsidXNlIHN0cmljdCI7dmFyIGk9InVuZGVmaW5lZCIhPXR5cGVvZiBVaW50OEFycmF5JiYidW5kZWZpbmVkIiE9dHlwZW9mIFVpbnQxNkFycmF5JiYidW5kZWZpbmVkIiE9dHlwZW9mIFVpbnQzMkFycmF5LG49dCgicGFrbyIpLHM9dCgiLi91dGlscyIpLGE9dCgiLi9zdHJlYW0vR2VuZXJpY1dvcmtlciIpLG89aT8idWludDhhcnJheSI6ImFycmF5IjtmdW5jdGlvbiBoKHQsZSl7YS5jYWxsKHRoaXMsIkZsYXRlV29ya2VyLyIrdCksdGhpcy5fcGFrbz1udWxsLHRoaXMuX3Bha29BY3Rpb249dCx0aGlzLl9wYWtvT3B0aW9ucz1lLHRoaXMubWV0YT17fX1yLm1hZ2ljPSJcYlwwIixzLmluaGVyaXRzKGgsYSksaC5wcm90b3R5cGUucHJvY2Vzc0NodW5rPWZ1bmN0aW9uKHQpe3RoaXMubWV0YT10Lm1ldGEsbnVsbD09PXRoaXMuX3Bha28mJnRoaXMuX2NyZWF0ZVBha28oKSx0aGlzLl9wYWtvLnB1c2gocy50cmFuc2Zvcm1UbyhvLHQuZGF0YSksITEpfSxoLnByb3RvdHlwZS5mbHVzaD1mdW5jdGlvbigpe2EucHJvdG90eXBlLmZsdXNoLmNhbGwodGhpcyksbnVsbD09PXRoaXMuX3Bha28mJnRoaXMuX2NyZWF0ZVBha28oKSx0aGlzLl9wYWtvLnB1c2goW10sITApfSxoLnByb3RvdHlwZS5jbGVhblVwPWZ1bmN0aW9uKCl7YS5wcm90b3R5cGUuY2xlYW5VcC5jYWxsKHRoaXMpLHRoaXMuX3Bha289bnVsbH0saC5wcm90b3R5cGUuX2NyZWF0ZVBha289ZnVuY3Rpb24oKXt0aGlzLl9wYWtvPW5ldyBuW3RoaXMuX3Bha29BY3Rpb25dKHtyYXc6ITAsbGV2ZWw6dGhpcy5fcGFrb09wdGlvbnMubGV2ZWx8fC0xfSk7dmFyIGU9dGhpczt0aGlzLl9wYWtvLm9uRGF0YT1mdW5jdGlvbih0KXtlLnB1c2goe2RhdGE6dCxtZXRhOmUubWV0YX0pfX0sci5jb21wcmVzc1dvcmtlcj1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGgoIkRlZmxhdGUiLHQpfSxyLnVuY29tcHJlc3NXb3JrZXI9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGgoIkluZmxhdGUiLHt9KX19LHsiLi9zdHJlYW0vR2VuZXJpY1dvcmtlciI6MjgsIi4vdXRpbHMiOjMyLHBha286Mzh9XSw4OltmdW5jdGlvbih0LGUscil7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIEEodCxlKXt2YXIgcixpPSIiO2ZvcihyPTA7cjxlO3IrKylpKz1TdHJpbmcuZnJvbUNoYXJDb2RlKDI1NSZ0KSx0Pj4+PTg7cmV0dXJuIGl9ZnVuY3Rpb24gaSh0LGUscixpLG4scyl7dmFyIGEsbyxoPXQuZmlsZSx1PXQuY29tcHJlc3Npb24sbD1zIT09Ty51dGY4ZW5jb2RlLGY9SS50cmFuc2Zvcm1Ubygic3RyaW5nIixzKGgubmFtZSkpLGQ9SS50cmFuc2Zvcm1Ubygic3RyaW5nIixPLnV0ZjhlbmNvZGUoaC5uYW1lKSksYz1oLmNvbW1lbnQscD1JLnRyYW5zZm9ybVRvKCJzdHJpbmciLHMoYykpLG09SS50cmFuc2Zvcm1Ubygic3RyaW5nIixPLnV0ZjhlbmNvZGUoYykpLF89ZC5sZW5ndGghPT1oLm5hbWUubGVuZ3RoLGc9bS5sZW5ndGghPT1jLmxlbmd0aCxiPSIiLHY9IiIseT0iIix3PWguZGlyLGs9aC5kYXRlLHg9e2NyYzMyOjAsY29tcHJlc3NlZFNpemU6MCx1bmNvbXByZXNzZWRTaXplOjB9O2UmJiFyfHwoeC5jcmMzMj10LmNyYzMyLHguY29tcHJlc3NlZFNpemU9dC5jb21wcmVzc2VkU2l6ZSx4LnVuY29tcHJlc3NlZFNpemU9dC51bmNvbXByZXNzZWRTaXplKTt2YXIgUz0wO2UmJihTfD04KSxsfHwhXyYmIWd8fChTfD0yMDQ4KTt2YXIgej0wLEM9MDt3JiYoenw9MTYpLCJVTklYIj09PW4/KEM9Nzk4LHp8PWZ1bmN0aW9uKHQsZSl7dmFyIHI9dDtyZXR1cm4gdHx8KHI9ZT8xNjg5MzozMzIwNCksKDY1NTM1JnIpPDwxNn0oaC51bml4UGVybWlzc2lvbnMsdykpOihDPTIwLHp8PWZ1bmN0aW9uKHQpe3JldHVybiA2MyYodHx8MCl9KGguZG9zUGVybWlzc2lvbnMpKSxhPWsuZ2V0VVRDSG91cnMoKSxhPDw9NixhfD1rLmdldFVUQ01pbnV0ZXMoKSxhPDw9NSxhfD1rLmdldFVUQ1NlY29uZHMoKS8yLG89ay5nZXRVVENGdWxsWWVhcigpLTE5ODAsbzw8PTQsb3w9ay5nZXRVVENNb250aCgpKzEsbzw8PTUsb3w9ay5nZXRVVENEYXRlKCksXyYmKHY9QSgxLDEpK0EoQihmKSw0KStkLGIrPSJ1cCIrQSh2Lmxlbmd0aCwyKSt2KSxnJiYoeT1BKDEsMSkrQShCKHApLDQpK20sYis9InVjIitBKHkubGVuZ3RoLDIpK3kpO3ZhciBFPSIiO3JldHVybiBFKz0iXG5cMCIsRSs9QShTLDIpLEUrPXUubWFnaWMsRSs9QShhLDIpLEUrPUEobywyKSxFKz1BKHguY3JjMzIsNCksRSs9QSh4LmNvbXByZXNzZWRTaXplLDQpLEUrPUEoeC51bmNvbXByZXNzZWRTaXplLDQpLEUrPUEoZi5sZW5ndGgsMiksRSs9QShiLmxlbmd0aCwyKSx7ZmlsZVJlY29yZDpSLkxPQ0FMX0ZJTEVfSEVBREVSK0UrZitiLGRpclJlY29yZDpSLkNFTlRSQUxfRklMRV9IRUFERVIrQShDLDIpK0UrQShwLmxlbmd0aCwyKSsiXDBcMFwwXDAiK0Eoeiw0KStBKGksNCkrZitiK3B9fXZhciBJPXQoIi4uL3V0aWxzIiksbj10KCIuLi9zdHJlYW0vR2VuZXJpY1dvcmtlciIpLE89dCgiLi4vdXRmOCIpLEI9dCgiLi4vY3JjMzIiKSxSPXQoIi4uL3NpZ25hdHVyZSIpO2Z1bmN0aW9uIHModCxlLHIsaSl7bi5jYWxsKHRoaXMsIlppcEZpbGVXb3JrZXIiKSx0aGlzLmJ5dGVzV3JpdHRlbj0wLHRoaXMuemlwQ29tbWVudD1lLHRoaXMuemlwUGxhdGZvcm09cix0aGlzLmVuY29kZUZpbGVOYW1lPWksdGhpcy5zdHJlYW1GaWxlcz10LHRoaXMuYWNjdW11bGF0ZT0hMSx0aGlzLmNvbnRlbnRCdWZmZXI9W10sdGhpcy5kaXJSZWNvcmRzPVtdLHRoaXMuY3VycmVudFNvdXJjZU9mZnNldD0wLHRoaXMuZW50cmllc0NvdW50PTAsdGhpcy5jdXJyZW50RmlsZT1udWxsLHRoaXMuX3NvdXJjZXM9W119SS5pbmhlcml0cyhzLG4pLHMucHJvdG90eXBlLnB1c2g9ZnVuY3Rpb24odCl7dmFyIGU9dC5tZXRhLnBlcmNlbnR8fDAscj10aGlzLmVudHJpZXNDb3VudCxpPXRoaXMuX3NvdXJjZXMubGVuZ3RoO3RoaXMuYWNjdW11bGF0ZT90aGlzLmNvbnRlbnRCdWZmZXIucHVzaCh0KToodGhpcy5ieXRlc1dyaXR0ZW4rPXQuZGF0YS5sZW5ndGgsbi5wcm90b3R5cGUucHVzaC5jYWxsKHRoaXMse2RhdGE6dC5kYXRhLG1ldGE6e2N1cnJlbnRGaWxlOnRoaXMuY3VycmVudEZpbGUscGVyY2VudDpyPyhlKzEwMCooci1pLTEpKS9yOjEwMH19KSl9LHMucHJvdG90eXBlLm9wZW5lZFNvdXJjZT1mdW5jdGlvbih0KXt0aGlzLmN1cnJlbnRTb3VyY2VPZmZzZXQ9dGhpcy5ieXRlc1dyaXR0ZW4sdGhpcy5jdXJyZW50RmlsZT10LmZpbGUubmFtZTt2YXIgZT10aGlzLnN0cmVhbUZpbGVzJiYhdC5maWxlLmRpcjtpZihlKXt2YXIgcj1pKHQsZSwhMSx0aGlzLmN1cnJlbnRTb3VyY2VPZmZzZXQsdGhpcy56aXBQbGF0Zm9ybSx0aGlzLmVuY29kZUZpbGVOYW1lKTt0aGlzLnB1c2goe2RhdGE6ci5maWxlUmVjb3JkLG1ldGE6e3BlcmNlbnQ6MH19KX1lbHNlIHRoaXMuYWNjdW11bGF0ZT0hMH0scy5wcm90b3R5cGUuY2xvc2VkU291cmNlPWZ1bmN0aW9uKHQpe3RoaXMuYWNjdW11bGF0ZT0hMTt2YXIgZT10aGlzLnN0cmVhbUZpbGVzJiYhdC5maWxlLmRpcixyPWkodCxlLCEwLHRoaXMuY3VycmVudFNvdXJjZU9mZnNldCx0aGlzLnppcFBsYXRmb3JtLHRoaXMuZW5jb2RlRmlsZU5hbWUpO2lmKHRoaXMuZGlyUmVjb3Jkcy5wdXNoKHIuZGlyUmVjb3JkKSxlKXRoaXMucHVzaCh7ZGF0YTpmdW5jdGlvbih0KXtyZXR1cm4gUi5EQVRBX0RFU0NSSVBUT1IrQSh0LmNyYzMyLDQpK0EodC5jb21wcmVzc2VkU2l6ZSw0KStBKHQudW5jb21wcmVzc2VkU2l6ZSw0KX0odCksbWV0YTp7cGVyY2VudDoxMDB9fSk7ZWxzZSBmb3IodGhpcy5wdXNoKHtkYXRhOnIuZmlsZVJlY29yZCxtZXRhOntwZXJjZW50OjB9fSk7dGhpcy5jb250ZW50QnVmZmVyLmxlbmd0aDspdGhpcy5wdXNoKHRoaXMuY29udGVudEJ1ZmZlci5zaGlmdCgpKTt0aGlzLmN1cnJlbnRGaWxlPW51bGx9LHMucHJvdG90eXBlLmZsdXNoPWZ1bmN0aW9uKCl7Zm9yKHZhciB0PXRoaXMuYnl0ZXNXcml0dGVuLGU9MDtlPHRoaXMuZGlyUmVjb3Jkcy5sZW5ndGg7ZSsrKXRoaXMucHVzaCh7ZGF0YTp0aGlzLmRpclJlY29yZHNbZV0sbWV0YTp7cGVyY2VudDoxMDB9fSk7dmFyIHI9dGhpcy5ieXRlc1dyaXR0ZW4tdCxpPWZ1bmN0aW9uKHQsZSxyLGksbil7dmFyIHM9SS50cmFuc2Zvcm1Ubygic3RyaW5nIixuKGkpKTtyZXR1cm4gUi5DRU5UUkFMX0RJUkVDVE9SWV9FTkQrIlwwXDBcMFwwIitBKHQsMikrQSh0LDIpK0EoZSw0KStBKHIsNCkrQShzLmxlbmd0aCwyKStzfSh0aGlzLmRpclJlY29yZHMubGVuZ3RoLHIsdCx0aGlzLnppcENvbW1lbnQsdGhpcy5lbmNvZGVGaWxlTmFtZSk7dGhpcy5wdXNoKHtkYXRhOmksbWV0YTp7cGVyY2VudDoxMDB9fSl9LHMucHJvdG90eXBlLnByZXBhcmVOZXh0U291cmNlPWZ1bmN0aW9uKCl7dGhpcy5wcmV2aW91cz10aGlzLl9zb3VyY2VzLnNoaWZ0KCksdGhpcy5vcGVuZWRTb3VyY2UodGhpcy5wcmV2aW91cy5zdHJlYW1JbmZvKSx0aGlzLmlzUGF1c2VkP3RoaXMucHJldmlvdXMucGF1c2UoKTp0aGlzLnByZXZpb3VzLnJlc3VtZSgpfSxzLnByb3RvdHlwZS5yZWdpc3RlclByZXZpb3VzPWZ1bmN0aW9uKHQpe3RoaXMuX3NvdXJjZXMucHVzaCh0KTt2YXIgZT10aGlzO3JldHVybiB0Lm9uKCJkYXRhIixmdW5jdGlvbih0KXtlLnByb2Nlc3NDaHVuayh0KX0pLHQub24oImVuZCIsZnVuY3Rpb24oKXtlLmNsb3NlZFNvdXJjZShlLnByZXZpb3VzLnN0cmVhbUluZm8pLGUuX3NvdXJjZXMubGVuZ3RoP2UucHJlcGFyZU5leHRTb3VyY2UoKTplLmVuZCgpfSksdC5vbigiZXJyb3IiLGZ1bmN0aW9uKHQpe2UuZXJyb3IodCl9KSx0aGlzfSxzLnByb3RvdHlwZS5yZXN1bWU9ZnVuY3Rpb24oKXtyZXR1cm4hIW4ucHJvdG90eXBlLnJlc3VtZS5jYWxsKHRoaXMpJiYoIXRoaXMucHJldmlvdXMmJnRoaXMuX3NvdXJjZXMubGVuZ3RoPyh0aGlzLnByZXBhcmVOZXh0U291cmNlKCksITApOnRoaXMucHJldmlvdXN8fHRoaXMuX3NvdXJjZXMubGVuZ3RofHx0aGlzLmdlbmVyYXRlZEVycm9yP3ZvaWQgMDoodGhpcy5lbmQoKSwhMCkpfSxzLnByb3RvdHlwZS5lcnJvcj1mdW5jdGlvbih0KXt2YXIgZT10aGlzLl9zb3VyY2VzO2lmKCFuLnByb3RvdHlwZS5lcnJvci5jYWxsKHRoaXMsdCkpcmV0dXJuITE7Zm9yKHZhciByPTA7cjxlLmxlbmd0aDtyKyspdHJ5e2Vbcl0uZXJyb3IodCl9Y2F0Y2godCl7fXJldHVybiEwfSxzLnByb3RvdHlwZS5sb2NrPWZ1bmN0aW9uKCl7bi5wcm90b3R5cGUubG9jay5jYWxsKHRoaXMpO2Zvcih2YXIgdD10aGlzLl9zb3VyY2VzLGU9MDtlPHQubGVuZ3RoO2UrKyl0W2VdLmxvY2soKX0sZS5leHBvcnRzPXN9LHsiLi4vY3JjMzIiOjQsIi4uL3NpZ25hdHVyZSI6MjMsIi4uL3N0cmVhbS9HZW5lcmljV29ya2VyIjoyOCwiLi4vdXRmOCI6MzEsIi4uL3V0aWxzIjozMn1dLDk6W2Z1bmN0aW9uKHQsZSxyKXsidXNlIHN0cmljdCI7dmFyIHU9dCgiLi4vY29tcHJlc3Npb25zIiksaT10KCIuL1ppcEZpbGVXb3JrZXIiKTtyLmdlbmVyYXRlV29ya2VyPWZ1bmN0aW9uKHQsYSxlKXt2YXIgbz1uZXcgaShhLnN0cmVhbUZpbGVzLGUsYS5wbGF0Zm9ybSxhLmVuY29kZUZpbGVOYW1lKSxoPTA7dHJ5e3QuZm9yRWFjaChmdW5jdGlvbih0LGUpe2grKzt2YXIgcj1mdW5jdGlvbih0LGUpe3ZhciByPXR8fGUsaT11W3JdO2lmKCFpKXRocm93IG5ldyBFcnJvcihyKyIgaXMgbm90IGEgdmFsaWQgY29tcHJlc3Npb24gbWV0aG9kICEiKTtyZXR1cm4gaX0oZS5vcHRpb25zLmNvbXByZXNzaW9uLGEuY29tcHJlc3Npb24pLGk9ZS5vcHRpb25zLmNvbXByZXNzaW9uT3B0aW9uc3x8YS5jb21wcmVzc2lvbk9wdGlvbnN8fHt9LG49ZS5kaXIscz1lLmRhdGU7ZS5fY29tcHJlc3NXb3JrZXIocixpKS53aXRoU3RyZWFtSW5mbygiZmlsZSIse25hbWU6dCxkaXI6bixkYXRlOnMsY29tbWVudDplLmNvbW1lbnR8fCIiLHVuaXhQZXJtaXNzaW9uczplLnVuaXhQZXJtaXNzaW9ucyxkb3NQZXJtaXNzaW9uczplLmRvc1Blcm1pc3Npb25zfSkucGlwZShvKX0pLG8uZW50cmllc0NvdW50PWh9Y2F0Y2godCl7by5lcnJvcih0KX1yZXR1cm4gb319LHsiLi4vY29tcHJlc3Npb25zIjozLCIuL1ppcEZpbGVXb3JrZXIiOjh9XSwxMDpbZnVuY3Rpb24odCxlLHIpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBpKCl7aWYoISh0aGlzIGluc3RhbmNlb2YgaSkpcmV0dXJuIG5ldyBpO2lmKGFyZ3VtZW50cy5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJUaGUgY29uc3RydWN0b3Igd2l0aCBwYXJhbWV0ZXJzIGhhcyBiZWVuIHJlbW92ZWQgaW4gSlNaaXAgMy4wLCBwbGVhc2UgY2hlY2sgdGhlIHVwZ3JhZGUgZ3VpZGUuIik7dGhpcy5maWxlcz1PYmplY3QuY3JlYXRlKG51bGwpLHRoaXMuY29tbWVudD1udWxsLHRoaXMucm9vdD0iIix0aGlzLmNsb25lPWZ1bmN0aW9uKCl7dmFyIHQ9bmV3IGk7Zm9yKHZhciBlIGluIHRoaXMpImZ1bmN0aW9uIiE9dHlwZW9mIHRoaXNbZV0mJih0W2VdPXRoaXNbZV0pO3JldHVybiB0fX0oaS5wcm90b3R5cGU9dCgiLi9vYmplY3QiKSkubG9hZEFzeW5jPXQoIi4vbG9hZCIpLGkuc3VwcG9ydD10KCIuL3N1cHBvcnQiKSxpLmRlZmF1bHRzPXQoIi4vZGVmYXVsdHMiKSxpLnZlcnNpb249IjMuOS4xIixpLmxvYWRBc3luYz1mdW5jdGlvbih0LGUpe3JldHVybihuZXcgaSkubG9hZEFzeW5jKHQsZSl9LGkuZXh0ZXJuYWw9dCgiLi9leHRlcm5hbCIpLGUuZXhwb3J0cz1pfSx7Ii4vZGVmYXVsdHMiOjUsIi4vZXh0ZXJuYWwiOjYsIi4vbG9hZCI6MTEsIi4vb2JqZWN0IjoxNSwiLi9zdXBwb3J0IjozMH1dLDExOltmdW5jdGlvbih0LGUscil7InVzZSBzdHJpY3QiO3ZhciB1PXQoIi4vdXRpbHMiKSxuPXQoIi4vZXh0ZXJuYWwiKSxpPXQoIi4vdXRmOCIpLHM9dCgiLi96aXBFbnRyaWVzIiksYT10KCIuL3N0cmVhbS9DcmMzMlByb2JlIiksbD10KCIuL25vZGVqc1V0aWxzIik7ZnVuY3Rpb24gZihpKXtyZXR1cm4gbmV3IG4uUHJvbWlzZShmdW5jdGlvbih0LGUpe3ZhciByPWkuZGVjb21wcmVzc2VkLmdldENvbnRlbnRXb3JrZXIoKS5waXBlKG5ldyBhKTtyLm9uKCJlcnJvciIsZnVuY3Rpb24odCl7ZSh0KX0pLm9uKCJlbmQiLGZ1bmN0aW9uKCl7ci5zdHJlYW1JbmZvLmNyYzMyIT09aS5kZWNvbXByZXNzZWQuY3JjMzI/ZShuZXcgRXJyb3IoIkNvcnJ1cHRlZCB6aXAgOiBDUkMzMiBtaXNtYXRjaCIpKTp0KCl9KS5yZXN1bWUoKX0pfWUuZXhwb3J0cz1mdW5jdGlvbih0LG8pe3ZhciBoPXRoaXM7cmV0dXJuIG89dS5leHRlbmQob3x8e30se2Jhc2U2NDohMSxjaGVja0NSQzMyOiExLG9wdGltaXplZEJpbmFyeVN0cmluZzohMSxjcmVhdGVGb2xkZXJzOiExLGRlY29kZUZpbGVOYW1lOmkudXRmOGRlY29kZX0pLGwuaXNOb2RlJiZsLmlzU3RyZWFtKHQpP24uUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCJKU1ppcCBjYW4ndCBhY2NlcHQgYSBzdHJlYW0gd2hlbiBsb2FkaW5nIGEgemlwIGZpbGUuIikpOnUucHJlcGFyZUNvbnRlbnQoInRoZSBsb2FkZWQgemlwIGZpbGUiLHQsITAsby5vcHRpbWl6ZWRCaW5hcnlTdHJpbmcsby5iYXNlNjQpLnRoZW4oZnVuY3Rpb24odCl7dmFyIGU9bmV3IHMobyk7cmV0dXJuIGUubG9hZCh0KSxlfSkudGhlbihmdW5jdGlvbih0KXt2YXIgZT1bbi5Qcm9taXNlLnJlc29sdmUodCldLHI9dC5maWxlcztpZihvLmNoZWNrQ1JDMzIpZm9yKHZhciBpPTA7aTxyLmxlbmd0aDtpKyspZS5wdXNoKGYocltpXSkpO3JldHVybiBuLlByb21pc2UuYWxsKGUpfSkudGhlbihmdW5jdGlvbih0KXtmb3IodmFyIGU9dC5zaGlmdCgpLHI9ZS5maWxlcyxpPTA7aTxyLmxlbmd0aDtpKyspe3ZhciBuPXJbaV0scz1uLmZpbGVOYW1lU3RyLGE9dS5yZXNvbHZlKG4uZmlsZU5hbWVTdHIpO2guZmlsZShhLG4uZGVjb21wcmVzc2VkLHtiaW5hcnk6ITAsb3B0aW1pemVkQmluYXJ5U3RyaW5nOiEwLGRhdGU6bi5kYXRlLGRpcjpuLmRpcixjb21tZW50Om4uZmlsZUNvbW1lbnRTdHIubGVuZ3RoP24uZmlsZUNvbW1lbnRTdHI6bnVsbCx1bml4UGVybWlzc2lvbnM6bi51bml4UGVybWlzc2lvbnMsZG9zUGVybWlzc2lvbnM6bi5kb3NQZXJtaXNzaW9ucyxjcmVhdGVGb2xkZXJzOm8uY3JlYXRlRm9sZGVyc30pLG4uZGlyfHwoaC5maWxlKGEpLnVuc2FmZU9yaWdpbmFsTmFtZT1zKX1yZXR1cm4gZS56aXBDb21tZW50Lmxlbmd0aCYmKGguY29tbWVudD1lLnppcENvbW1lbnQpLGh9KX19LHsiLi9leHRlcm5hbCI6NiwiLi9ub2RlanNVdGlscyI6MTQsIi4vc3RyZWFtL0NyYzMyUHJvYmUiOjI1LCIuL3V0ZjgiOjMxLCIuL3V0aWxzIjozMiwiLi96aXBFbnRyaWVzIjozM31dLDEyOltmdW5jdGlvbih0LGUscil7InVzZSBzdHJpY3QiO3ZhciBpPXQoIi4uL3V0aWxzIiksbj10KCIuLi9zdHJlYW0vR2VuZXJpY1dvcmtlciIpO2Z1bmN0aW9uIHModCxlKXtuLmNhbGwodGhpcywiTm9kZWpzIHN0cmVhbSBpbnB1dCBhZGFwdGVyIGZvciAiK3QpLHRoaXMuX3Vwc3RyZWFtRW5kZWQ9ITEsdGhpcy5fYmluZFN0cmVhbShlKX1pLmluaGVyaXRzKHMsbikscy5wcm90b3R5cGUuX2JpbmRTdHJlYW09ZnVuY3Rpb24odCl7dmFyIGU9dGhpczsodGhpcy5fc3RyZWFtPXQpLnBhdXNlKCksdC5vbigiZGF0YSIsZnVuY3Rpb24odCl7ZS5wdXNoKHtkYXRhOnQsbWV0YTp7cGVyY2VudDowfX0pfSkub24oImVycm9yIixmdW5jdGlvbih0KXtlLmlzUGF1c2VkP3RoaXMuZ2VuZXJhdGVkRXJyb3I9dDplLmVycm9yKHQpfSkub24oImVuZCIsZnVuY3Rpb24oKXtlLmlzUGF1c2VkP2UuX3Vwc3RyZWFtRW5kZWQ9ITA6ZS5lbmQoKX0pfSxzLnByb3RvdHlwZS5wYXVzZT1mdW5jdGlvbigpe3JldHVybiEhbi5wcm90b3R5cGUucGF1c2UuY2FsbCh0aGlzKSYmKHRoaXMuX3N0cmVhbS5wYXVzZSgpLCEwKX0scy5wcm90b3R5cGUucmVzdW1lPWZ1bmN0aW9uKCl7cmV0dXJuISFuLnByb3RvdHlwZS5yZXN1bWUuY2FsbCh0aGlzKSYmKHRoaXMuX3Vwc3RyZWFtRW5kZWQ/dGhpcy5lbmQoKTp0aGlzLl9zdHJlYW0ucmVzdW1lKCksITApfSxlLmV4cG9ydHM9c30seyIuLi9zdHJlYW0vR2VuZXJpY1dvcmtlciI6MjgsIi4uL3V0aWxzIjozMn1dLDEzOltmdW5jdGlvbih0LGUscil7InVzZSBzdHJpY3QiO3ZhciBuPXQoInJlYWRhYmxlLXN0cmVhbSIpLlJlYWRhYmxlO2Z1bmN0aW9uIGkodCxlLHIpe24uY2FsbCh0aGlzLGUpLHRoaXMuX2hlbHBlcj10O3ZhciBpPXRoaXM7dC5vbigiZGF0YSIsZnVuY3Rpb24odCxlKXtpLnB1c2godCl8fGkuX2hlbHBlci5wYXVzZSgpLHImJnIoZSl9KS5vbigiZXJyb3IiLGZ1bmN0aW9uKHQpe2kuZW1pdCgiZXJyb3IiLHQpfSkub24oImVuZCIsZnVuY3Rpb24oKXtpLnB1c2gobnVsbCl9KX10KCIuLi91dGlscyIpLmluaGVyaXRzKGksbiksaS5wcm90b3R5cGUuX3JlYWQ9ZnVuY3Rpb24oKXt0aGlzLl9oZWxwZXIucmVzdW1lKCl9LGUuZXhwb3J0cz1pfSx7Ii4uL3V0aWxzIjozMiwicmVhZGFibGUtc3RyZWFtIjoxNn1dLDE0OltmdW5jdGlvbih0LGUscil7InVzZSBzdHJpY3QiO2UuZXhwb3J0cz17aXNOb2RlOiJ1bmRlZmluZWQiIT10eXBlb2YgQnVmZmVyLG5ld0J1ZmZlckZyb206ZnVuY3Rpb24odCxlKXtpZihCdWZmZXIuZnJvbSYmQnVmZmVyLmZyb20hPT1VaW50OEFycmF5LmZyb20pcmV0dXJuIEJ1ZmZlci5mcm9tKHQsZSk7aWYoIm51bWJlciI9PXR5cGVvZiB0KXRocm93IG5ldyBFcnJvcignVGhlICJkYXRhIiBhcmd1bWVudCBtdXN0IG5vdCBiZSBhIG51bWJlcicpO3JldHVybiBuZXcgQnVmZmVyKHQsZSl9LGFsbG9jQnVmZmVyOmZ1bmN0aW9uKHQpe2lmKEJ1ZmZlci5hbGxvYylyZXR1cm4gQnVmZmVyLmFsbG9jKHQpO3ZhciBlPW5ldyBCdWZmZXIodCk7cmV0dXJuIGUuZmlsbCgwKSxlfSxpc0J1ZmZlcjpmdW5jdGlvbih0KXtyZXR1cm4gQnVmZmVyLmlzQnVmZmVyKHQpfSxpc1N0cmVhbTpmdW5jdGlvbih0KXtyZXR1cm4gdCYmImZ1bmN0aW9uIj09dHlwZW9mIHQub24mJiJmdW5jdGlvbiI9PXR5cGVvZiB0LnBhdXNlJiYiZnVuY3Rpb24iPT10eXBlb2YgdC5yZXN1bWV9fX0se31dLDE1OltmdW5jdGlvbih0LGUscil7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHModCxlLHIpe3ZhciBpLG49dS5nZXRUeXBlT2YoZSkscz11LmV4dGVuZChyfHx7fSxmKTtzLmRhdGU9cy5kYXRlfHxuZXcgRGF0ZSxudWxsIT09cy5jb21wcmVzc2lvbiYmKHMuY29tcHJlc3Npb249cy5jb21wcmVzc2lvbi50b1VwcGVyQ2FzZSgpKSwic3RyaW5nIj09dHlwZW9mIHMudW5peFBlcm1pc3Npb25zJiYocy51bml4UGVybWlzc2lvbnM9cGFyc2VJbnQocy51bml4UGVybWlzc2lvbnMsOCkpLHMudW5peFBlcm1pc3Npb25zJiYxNjM4NCZzLnVuaXhQZXJtaXNzaW9ucyYmKHMuZGlyPSEwKSxzLmRvc1Blcm1pc3Npb25zJiYxNiZzLmRvc1Blcm1pc3Npb25zJiYocy5kaXI9ITApLHMuZGlyJiYodD1nKHQpKSxzLmNyZWF0ZUZvbGRlcnMmJihpPV8odCkpJiZiLmNhbGwodGhpcyxpLCEwKTt2YXIgYT0ic3RyaW5nIj09PW4mJiExPT09cy5iaW5hcnkmJiExPT09cy5iYXNlNjQ7ciYmdm9pZCAwIT09ci5iaW5hcnl8fChzLmJpbmFyeT0hYSksKGUgaW5zdGFuY2VvZiBkJiYwPT09ZS51bmNvbXByZXNzZWRTaXplfHxzLmRpcnx8IWV8fDA9PT1lLmxlbmd0aCkmJihzLmJhc2U2ND0hMSxzLmJpbmFyeT0hMCxlPSIiLHMuY29tcHJlc3Npb249IlNUT1JFIixuPSJzdHJpbmciKTt2YXIgbz1udWxsO289ZSBpbnN0YW5jZW9mIGR8fGUgaW5zdGFuY2VvZiBsP2U6cC5pc05vZGUmJnAuaXNTdHJlYW0oZSk/bmV3IG0odCxlKTp1LnByZXBhcmVDb250ZW50KHQsZSxzLmJpbmFyeSxzLm9wdGltaXplZEJpbmFyeVN0cmluZyxzLmJhc2U2NCk7dmFyIGg9bmV3IGModCxvLHMpO3RoaXMuZmlsZXNbdF09aH12YXIgbj10KCIuL3V0ZjgiKSx1PXQoIi4vdXRpbHMiKSxsPXQoIi4vc3RyZWFtL0dlbmVyaWNXb3JrZXIiKSxhPXQoIi4vc3RyZWFtL1N0cmVhbUhlbHBlciIpLGY9dCgiLi9kZWZhdWx0cyIpLGQ9dCgiLi9jb21wcmVzc2VkT2JqZWN0IiksYz10KCIuL3ppcE9iamVjdCIpLG89dCgiLi9nZW5lcmF0ZSIpLHA9dCgiLi9ub2RlanNVdGlscyIpLG09dCgiLi9ub2RlanMvTm9kZWpzU3RyZWFtSW5wdXRBZGFwdGVyIiksXz1mdW5jdGlvbih0KXsiLyI9PT10LnNsaWNlKC0xKSYmKHQ9dC5zdWJzdHJpbmcoMCx0Lmxlbmd0aC0xKSk7dmFyIGU9dC5sYXN0SW5kZXhPZigiLyIpO3JldHVybiAwPGU/dC5zdWJzdHJpbmcoMCxlKToiIn0sZz1mdW5jdGlvbih0KXtyZXR1cm4iLyIhPT10LnNsaWNlKC0xKSYmKHQrPSIvIiksdH0sYj1mdW5jdGlvbih0LGUpe3JldHVybiBlPXZvaWQgMCE9PWU/ZTpmLmNyZWF0ZUZvbGRlcnMsdD1nKHQpLHRoaXMuZmlsZXNbdF18fHMuY2FsbCh0aGlzLHQsbnVsbCx7ZGlyOiEwLGNyZWF0ZUZvbGRlcnM6ZX0pLHRoaXMuZmlsZXNbdF19O2Z1bmN0aW9uIGgodCl7cmV0dXJuIltvYmplY3QgUmVnRXhwXSI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCl9dmFyIGk9e2xvYWQ6ZnVuY3Rpb24oKXt0aHJvdyBuZXcgRXJyb3IoIlRoaXMgbWV0aG9kIGhhcyBiZWVuIHJlbW92ZWQgaW4gSlNaaXAgMy4wLCBwbGVhc2UgY2hlY2sgdGhlIHVwZ3JhZGUgZ3VpZGUuIil9LGZvckVhY2g6ZnVuY3Rpb24odCl7dmFyIGUscixpO2ZvcihlIGluIHRoaXMuZmlsZXMpaT10aGlzLmZpbGVzW2VdLChyPWUuc2xpY2UodGhpcy5yb290Lmxlbmd0aCxlLmxlbmd0aCkpJiZlLnNsaWNlKDAsdGhpcy5yb290Lmxlbmd0aCk9PT10aGlzLnJvb3QmJnQocixpKX0sZmlsdGVyOmZ1bmN0aW9uKHIpe3ZhciBpPVtdO3JldHVybiB0aGlzLmZvckVhY2goZnVuY3Rpb24odCxlKXtyKHQsZSkmJmkucHVzaChlKX0pLGl9LGZpbGU6ZnVuY3Rpb24odCxlLHIpe2lmKDEhPT1hcmd1bWVudHMubGVuZ3RoKXJldHVybiB0PXRoaXMucm9vdCt0LHMuY2FsbCh0aGlzLHQsZSxyKSx0aGlzO2lmKGgodCkpe3ZhciBpPXQ7cmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9uKHQsZSl7cmV0dXJuIWUuZGlyJiZpLnRlc3QodCl9KX12YXIgbj10aGlzLmZpbGVzW3RoaXMucm9vdCt0XTtyZXR1cm4gbiYmIW4uZGlyP246bnVsbH0sZm9sZGVyOmZ1bmN0aW9uKHIpe2lmKCFyKXJldHVybiB0aGlzO2lmKGgocikpcmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUuZGlyJiZyLnRlc3QodCl9KTt2YXIgdD10aGlzLnJvb3QrcixlPWIuY2FsbCh0aGlzLHQpLGk9dGhpcy5jbG9uZSgpO3JldHVybiBpLnJvb3Q9ZS5uYW1lLGl9LHJlbW92ZTpmdW5jdGlvbihyKXtyPXRoaXMucm9vdCtyO3ZhciB0PXRoaXMuZmlsZXNbcl07aWYodHx8KCIvIiE9PXIuc2xpY2UoLTEpJiYocis9Ii8iKSx0PXRoaXMuZmlsZXNbcl0pLHQmJiF0LmRpcilkZWxldGUgdGhpcy5maWxlc1tyXTtlbHNlIGZvcih2YXIgZT10aGlzLmZpbHRlcihmdW5jdGlvbih0LGUpe3JldHVybiBlLm5hbWUuc2xpY2UoMCxyLmxlbmd0aCk9PT1yfSksaT0wO2k8ZS5sZW5ndGg7aSsrKWRlbGV0ZSB0aGlzLmZpbGVzW2VbaV0ubmFtZV07cmV0dXJuIHRoaXN9LGdlbmVyYXRlOmZ1bmN0aW9uKHQpe3Rocm93IG5ldyBFcnJvcigiVGhpcyBtZXRob2QgaGFzIGJlZW4gcmVtb3ZlZCBpbiBKU1ppcCAzLjAsIHBsZWFzZSBjaGVjayB0aGUgdXBncmFkZSBndWlkZS4iKX0sZ2VuZXJhdGVJbnRlcm5hbFN0cmVhbTpmdW5jdGlvbih0KXt2YXIgZSxyPXt9O3RyeXtpZigocj11LmV4dGVuZCh0fHx7fSx7c3RyZWFtRmlsZXM6ITEsY29tcHJlc3Npb246IlNUT1JFIixjb21wcmVzc2lvbk9wdGlvbnM6bnVsbCx0eXBlOiIiLHBsYXRmb3JtOiJET1MiLGNvbW1lbnQ6bnVsbCxtaW1lVHlwZToiYXBwbGljYXRpb24vemlwIixlbmNvZGVGaWxlTmFtZTpuLnV0ZjhlbmNvZGV9KSkudHlwZT1yLnR5cGUudG9Mb3dlckNhc2UoKSxyLmNvbXByZXNzaW9uPXIuY29tcHJlc3Npb24udG9VcHBlckNhc2UoKSwiYmluYXJ5c3RyaW5nIj09PXIudHlwZSYmKHIudHlwZT0ic3RyaW5nIiksIXIudHlwZSl0aHJvdyBuZXcgRXJyb3IoIk5vIG91dHB1dCB0eXBlIHNwZWNpZmllZC4iKTt1LmNoZWNrU3VwcG9ydChyLnR5cGUpLCJkYXJ3aW4iIT09ci5wbGF0Zm9ybSYmImZyZWVic2QiIT09ci5wbGF0Zm9ybSYmImxpbnV4IiE9PXIucGxhdGZvcm0mJiJzdW5vcyIhPT1yLnBsYXRmb3JtfHwoci5wbGF0Zm9ybT0iVU5JWCIpLCJ3aW4zMiI9PT1yLnBsYXRmb3JtJiYoci5wbGF0Zm9ybT0iRE9TIik7dmFyIGk9ci5jb21tZW50fHx0aGlzLmNvbW1lbnR8fCIiO2U9by5nZW5lcmF0ZVdvcmtlcih0aGlzLHIsaSl9Y2F0Y2godCl7KGU9bmV3IGwoImVycm9yIikpLmVycm9yKHQpfXJldHVybiBuZXcgYShlLHIudHlwZXx8InN0cmluZyIsci5taW1lVHlwZSl9LGdlbmVyYXRlQXN5bmM6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5nZW5lcmF0ZUludGVybmFsU3RyZWFtKHQpLmFjY3VtdWxhdGUoZSl9LGdlbmVyYXRlTm9kZVN0cmVhbTpmdW5jdGlvbih0LGUpe3JldHVybih0PXR8fHt9KS50eXBlfHwodC50eXBlPSJub2RlYnVmZmVyIiksdGhpcy5nZW5lcmF0ZUludGVybmFsU3RyZWFtKHQpLnRvTm9kZWpzU3RyZWFtKGUpfX07ZS5leHBvcnRzPWl9LHsiLi9jb21wcmVzc2VkT2JqZWN0IjoyLCIuL2RlZmF1bHRzIjo1LCIuL2dlbmVyYXRlIjo5LCIuL25vZGVqcy9Ob2RlanNTdHJlYW1JbnB1dEFkYXB0ZXIiOjEyLCIuL25vZGVqc1V0aWxzIjoxNCwiLi9zdHJlYW0vR2VuZXJpY1dvcmtlciI6MjgsIi4vc3RyZWFtL1N0cmVhbUhlbHBlciI6MjksIi4vdXRmOCI6MzEsIi4vdXRpbHMiOjMyLCIuL3ppcE9iamVjdCI6MzV9XSwxNjpbZnVuY3Rpb24odCxlLHIpe2UuZXhwb3J0cz10KCJzdHJlYW0iKX0se3N0cmVhbTp2b2lkIDB9XSwxNzpbZnVuY3Rpb24odCxlLHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgaT10KCIuL0RhdGFSZWFkZXIiKTtmdW5jdGlvbiBuKHQpe2kuY2FsbCh0aGlzLHQpO2Zvcih2YXIgZT0wO2U8dGhpcy5kYXRhLmxlbmd0aDtlKyspdFtlXT0yNTUmdFtlXX10KCIuLi91dGlscyIpLmluaGVyaXRzKG4saSksbi5wcm90b3R5cGUuYnl0ZUF0PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmRhdGFbdGhpcy56ZXJvK3RdfSxuLnByb3RvdHlwZS5sYXN0SW5kZXhPZlNpZ25hdHVyZT1mdW5jdGlvbih0KXtmb3IodmFyIGU9dC5jaGFyQ29kZUF0KDApLHI9dC5jaGFyQ29kZUF0KDEpLGk9dC5jaGFyQ29kZUF0KDIpLG49dC5jaGFyQ29kZUF0KDMpLHM9dGhpcy5sZW5ndGgtNDswPD1zOy0tcylpZih0aGlzLmRhdGFbc109PT1lJiZ0aGlzLmRhdGFbcysxXT09PXImJnRoaXMuZGF0YVtzKzJdPT09aSYmdGhpcy5kYXRhW3MrM109PT1uKXJldHVybiBzLXRoaXMuemVybztyZXR1cm4tMX0sbi5wcm90b3R5cGUucmVhZEFuZENoZWNrU2lnbmF0dXJlPWZ1bmN0aW9uKHQpe3ZhciBlPXQuY2hhckNvZGVBdCgwKSxyPXQuY2hhckNvZGVBdCgxKSxpPXQuY2hhckNvZGVBdCgyKSxuPXQuY2hhckNvZGVBdCgzKSxzPXRoaXMucmVhZERhdGEoNCk7cmV0dXJuIGU9PT1zWzBdJiZyPT09c1sxXSYmaT09PXNbMl0mJm49PT1zWzNdfSxuLnByb3RvdHlwZS5yZWFkRGF0YT1mdW5jdGlvbih0KXtpZih0aGlzLmNoZWNrT2Zmc2V0KHQpLDA9PT10KXJldHVybltdO3ZhciBlPXRoaXMuZGF0YS5zbGljZSh0aGlzLnplcm8rdGhpcy5pbmRleCx0aGlzLnplcm8rdGhpcy5pbmRleCt0KTtyZXR1cm4gdGhpcy5pbmRleCs9dCxlfSxlLmV4cG9ydHM9bn0seyIuLi91dGlscyI6MzIsIi4vRGF0YVJlYWRlciI6MTh9XSwxODpbZnVuY3Rpb24odCxlLHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgaT10KCIuLi91dGlscyIpO2Z1bmN0aW9uIG4odCl7dGhpcy5kYXRhPXQsdGhpcy5sZW5ndGg9dC5sZW5ndGgsdGhpcy5pbmRleD0wLHRoaXMuemVybz0wfW4ucHJvdG90eXBlPXtjaGVja09mZnNldDpmdW5jdGlvbih0KXt0aGlzLmNoZWNrSW5kZXgodGhpcy5pbmRleCt0KX0sY2hlY2tJbmRleDpmdW5jdGlvbih0KXtpZih0aGlzLmxlbmd0aDx0aGlzLnplcm8rdHx8dDwwKXRocm93IG5ldyBFcnJvcigiRW5kIG9mIGRhdGEgcmVhY2hlZCAoZGF0YSBsZW5ndGggPSAiK3RoaXMubGVuZ3RoKyIsIGFza2VkIGluZGV4ID0gIit0KyIpLiBDb3JydXB0ZWQgemlwID8iKX0sc2V0SW5kZXg6ZnVuY3Rpb24odCl7dGhpcy5jaGVja0luZGV4KHQpLHRoaXMuaW5kZXg9dH0sc2tpcDpmdW5jdGlvbih0KXt0aGlzLnNldEluZGV4KHRoaXMuaW5kZXgrdCl9LGJ5dGVBdDpmdW5jdGlvbih0KXt9LHJlYWRJbnQ6ZnVuY3Rpb24odCl7dmFyIGUscj0wO2Zvcih0aGlzLmNoZWNrT2Zmc2V0KHQpLGU9dGhpcy5pbmRleCt0LTE7ZT49dGhpcy5pbmRleDtlLS0pcj0ocjw8OCkrdGhpcy5ieXRlQXQoZSk7cmV0dXJuIHRoaXMuaW5kZXgrPXQscn0scmVhZFN0cmluZzpmdW5jdGlvbih0KXtyZXR1cm4gaS50cmFuc2Zvcm1Ubygic3RyaW5nIix0aGlzLnJlYWREYXRhKHQpKX0scmVhZERhdGE6ZnVuY3Rpb24odCl7fSxsYXN0SW5kZXhPZlNpZ25hdHVyZTpmdW5jdGlvbih0KXt9LHJlYWRBbmRDaGVja1NpZ25hdHVyZTpmdW5jdGlvbih0KXt9LHJlYWREYXRlOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5yZWFkSW50KDQpO3JldHVybiBuZXcgRGF0ZShEYXRlLlVUQygxOTgwKyh0Pj4yNSYxMjcpLCh0Pj4yMSYxNSktMSx0Pj4xNiYzMSx0Pj4xMSYzMSx0Pj41JjYzLCgzMSZ0KTw8MSkpfX0sZS5leHBvcnRzPW59LHsiLi4vdXRpbHMiOjMyfV0sMTk6W2Z1bmN0aW9uKHQsZSxyKXsidXNlIHN0cmljdCI7dmFyIGk9dCgiLi9VaW50OEFycmF5UmVhZGVyIik7ZnVuY3Rpb24gbih0KXtpLmNhbGwodGhpcyx0KX10KCIuLi91dGlscyIpLmluaGVyaXRzKG4saSksbi5wcm90b3R5cGUucmVhZERhdGE9ZnVuY3Rpb24odCl7dGhpcy5jaGVja09mZnNldCh0KTt2YXIgZT10aGlzLmRhdGEuc2xpY2UodGhpcy56ZXJvK3RoaXMuaW5kZXgsdGhpcy56ZXJvK3RoaXMuaW5kZXgrdCk7cmV0dXJuIHRoaXMuaW5kZXgrPXQsZX0sZS5leHBvcnRzPW59LHsiLi4vdXRpbHMiOjMyLCIuL1VpbnQ4QXJyYXlSZWFkZXIiOjIxfV0sMjA6W2Z1bmN0aW9uKHQsZSxyKXsidXNlIHN0cmljdCI7dmFyIGk9dCgiLi9EYXRhUmVhZGVyIik7ZnVuY3Rpb24gbih0KXtpLmNhbGwodGhpcyx0KX10KCIuLi91dGlscyIpLmluaGVyaXRzKG4saSksbi5wcm90b3R5cGUuYnl0ZUF0PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmRhdGEuY2hhckNvZGVBdCh0aGlzLnplcm8rdCl9LG4ucHJvdG90eXBlLmxhc3RJbmRleE9mU2lnbmF0dXJlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmRhdGEubGFzdEluZGV4T2YodCktdGhpcy56ZXJvfSxuLnByb3RvdHlwZS5yZWFkQW5kQ2hlY2tTaWduYXR1cmU9ZnVuY3Rpb24odCl7cmV0dXJuIHQ9PT10aGlzLnJlYWREYXRhKDQpfSxuLnByb3RvdHlwZS5yZWFkRGF0YT1mdW5jdGlvbih0KXt0aGlzLmNoZWNrT2Zmc2V0KHQpO3ZhciBlPXRoaXMuZGF0YS5zbGljZSh0aGlzLnplcm8rdGhpcy5pbmRleCx0aGlzLnplcm8rdGhpcy5pbmRleCt0KTtyZXR1cm4gdGhpcy5pbmRleCs9dCxlfSxlLmV4cG9ydHM9bn0seyIuLi91dGlscyI6MzIsIi4vRGF0YVJlYWRlciI6MTh9XSwyMTpbZnVuY3Rpb24odCxlLHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgaT10KCIuL0FycmF5UmVhZGVyIik7ZnVuY3Rpb24gbih0KXtpLmNhbGwodGhpcyx0KX10KCIuLi91dGlscyIpLmluaGVyaXRzKG4saSksbi5wcm90b3R5cGUucmVhZERhdGE9ZnVuY3Rpb24odCl7aWYodGhpcy5jaGVja09mZnNldCh0KSwwPT09dClyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoMCk7dmFyIGU9dGhpcy5kYXRhLnN1YmFycmF5KHRoaXMuemVybyt0aGlzLmluZGV4LHRoaXMuemVybyt0aGlzLmluZGV4K3QpO3JldHVybiB0aGlzLmluZGV4Kz10LGV9LGUuZXhwb3J0cz1ufSx7Ii4uL3V0aWxzIjozMiwiLi9BcnJheVJlYWRlciI6MTd9XSwyMjpbZnVuY3Rpb24odCxlLHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgaT10KCIuLi91dGlscyIpLG49dCgiLi4vc3VwcG9ydCIpLHM9dCgiLi9BcnJheVJlYWRlciIpLGE9dCgiLi9TdHJpbmdSZWFkZXIiKSxvPXQoIi4vTm9kZUJ1ZmZlclJlYWRlciIpLGg9dCgiLi9VaW50OEFycmF5UmVhZGVyIik7ZS5leHBvcnRzPWZ1bmN0aW9uKHQpe3ZhciBlPWkuZ2V0VHlwZU9mKHQpO3JldHVybiBpLmNoZWNrU3VwcG9ydChlKSwic3RyaW5nIiE9PWV8fG4udWludDhhcnJheT8ibm9kZWJ1ZmZlciI9PT1lP25ldyBvKHQpOm4udWludDhhcnJheT9uZXcgaChpLnRyYW5zZm9ybVRvKCJ1aW50OGFycmF5Iix0KSk6bmV3IHMoaS50cmFuc2Zvcm1UbygiYXJyYXkiLHQpKTpuZXcgYSh0KX19LHsiLi4vc3VwcG9ydCI6MzAsIi4uL3V0aWxzIjozMiwiLi9BcnJheVJlYWRlciI6MTcsIi4vTm9kZUJ1ZmZlclJlYWRlciI6MTksIi4vU3RyaW5nUmVhZGVyIjoyMCwiLi9VaW50OEFycmF5UmVhZGVyIjoyMX1dLDIzOltmdW5jdGlvbih0LGUscil7InVzZSBzdHJpY3QiO3IuTE9DQUxfRklMRV9IRUFERVI9IlBLAwQiLHIuQ0VOVFJBTF9GSUxFX0hFQURFUj0iUEsBAiIsci5DRU5UUkFMX0RJUkVDVE9SWV9FTkQ9IlBLBQYiLHIuWklQNjRfQ0VOVFJBTF9ESVJFQ1RPUllfTE9DQVRPUj0iUEsGByIsci5aSVA2NF9DRU5UUkFMX0RJUkVDVE9SWV9FTkQ9IlBLBgYiLHIuREFUQV9ERVNDUklQVE9SPSJQSwdcYiJ9LHt9XSwyNDpbZnVuY3Rpb24odCxlLHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgaT10KCIuL0dlbmVyaWNXb3JrZXIiKSxuPXQoIi4uL3V0aWxzIik7ZnVuY3Rpb24gcyh0KXtpLmNhbGwodGhpcywiQ29udmVydFdvcmtlciB0byAiK3QpLHRoaXMuZGVzdFR5cGU9dH1uLmluaGVyaXRzKHMsaSkscy5wcm90b3R5cGUucHJvY2Vzc0NodW5rPWZ1bmN0aW9uKHQpe3RoaXMucHVzaCh7ZGF0YTpuLnRyYW5zZm9ybVRvKHRoaXMuZGVzdFR5cGUsdC5kYXRhKSxtZXRhOnQubWV0YX0pfSxlLmV4cG9ydHM9c30seyIuLi91dGlscyI6MzIsIi4vR2VuZXJpY1dvcmtlciI6Mjh9XSwyNTpbZnVuY3Rpb24odCxlLHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgaT10KCIuL0dlbmVyaWNXb3JrZXIiKSxuPXQoIi4uL2NyYzMyIik7ZnVuY3Rpb24gcygpe2kuY2FsbCh0aGlzLCJDcmMzMlByb2JlIiksdGhpcy53aXRoU3RyZWFtSW5mbygiY3JjMzIiLDApfXQoIi4uL3V0aWxzIikuaW5oZXJpdHMocyxpKSxzLnByb3RvdHlwZS5wcm9jZXNzQ2h1bms9ZnVuY3Rpb24odCl7dGhpcy5zdHJlYW1JbmZvLmNyYzMyPW4odC5kYXRhLHRoaXMuc3RyZWFtSW5mby5jcmMzMnx8MCksdGhpcy5wdXNoKHQpfSxlLmV4cG9ydHM9c30seyIuLi9jcmMzMiI6NCwiLi4vdXRpbHMiOjMyLCIuL0dlbmVyaWNXb3JrZXIiOjI4fV0sMjY6W2Z1bmN0aW9uKHQsZSxyKXsidXNlIHN0cmljdCI7dmFyIGk9dCgiLi4vdXRpbHMiKSxuPXQoIi4vR2VuZXJpY1dvcmtlciIpO2Z1bmN0aW9uIHModCl7bi5jYWxsKHRoaXMsIkRhdGFMZW5ndGhQcm9iZSBmb3IgIit0KSx0aGlzLnByb3BOYW1lPXQsdGhpcy53aXRoU3RyZWFtSW5mbyh0LDApfWkuaW5oZXJpdHMocyxuKSxzLnByb3RvdHlwZS5wcm9jZXNzQ2h1bms9ZnVuY3Rpb24odCl7aWYodCl7dmFyIGU9dGhpcy5zdHJlYW1JbmZvW3RoaXMucHJvcE5hbWVdfHwwO3RoaXMuc3RyZWFtSW5mb1t0aGlzLnByb3BOYW1lXT1lK3QuZGF0YS5sZW5ndGh9bi5wcm90b3R5cGUucHJvY2Vzc0NodW5rLmNhbGwodGhpcyx0KX0sZS5leHBvcnRzPXN9LHsiLi4vdXRpbHMiOjMyLCIuL0dlbmVyaWNXb3JrZXIiOjI4fV0sMjc6W2Z1bmN0aW9uKHQsZSxyKXsidXNlIHN0cmljdCI7dmFyIGk9dCgiLi4vdXRpbHMiKSxuPXQoIi4vR2VuZXJpY1dvcmtlciIpO2Z1bmN0aW9uIHModCl7bi5jYWxsKHRoaXMsIkRhdGFXb3JrZXIiKTt2YXIgZT10aGlzO3RoaXMuZGF0YUlzUmVhZHk9ITEsdGhpcy5pbmRleD0wLHRoaXMubWF4PTAsdGhpcy5kYXRhPW51bGwsdGhpcy50eXBlPSIiLHRoaXMuX3RpY2tTY2hlZHVsZWQ9ITEsdC50aGVuKGZ1bmN0aW9uKHQpe2UuZGF0YUlzUmVhZHk9ITAsZS5kYXRhPXQsZS5tYXg9dCYmdC5sZW5ndGh8fDAsZS50eXBlPWkuZ2V0VHlwZU9mKHQpLGUuaXNQYXVzZWR8fGUuX3RpY2tBbmRSZXBlYXQoKX0sZnVuY3Rpb24odCl7ZS5lcnJvcih0KX0pfWkuaW5oZXJpdHMocyxuKSxzLnByb3RvdHlwZS5jbGVhblVwPWZ1bmN0aW9uKCl7bi5wcm90b3R5cGUuY2xlYW5VcC5jYWxsKHRoaXMpLHRoaXMuZGF0YT1udWxsfSxzLnByb3RvdHlwZS5yZXN1bWU9ZnVuY3Rpb24oKXtyZXR1cm4hIW4ucHJvdG90eXBlLnJlc3VtZS5jYWxsKHRoaXMpJiYoIXRoaXMuX3RpY2tTY2hlZHVsZWQmJnRoaXMuZGF0YUlzUmVhZHkmJih0aGlzLl90aWNrU2NoZWR1bGVkPSEwLGkuZGVsYXkodGhpcy5fdGlja0FuZFJlcGVhdCxbXSx0aGlzKSksITApfSxzLnByb3RvdHlwZS5fdGlja0FuZFJlcGVhdD1mdW5jdGlvbigpe3RoaXMuX3RpY2tTY2hlZHVsZWQ9ITEsdGhpcy5pc1BhdXNlZHx8dGhpcy5pc0ZpbmlzaGVkfHwodGhpcy5fdGljaygpLHRoaXMuaXNGaW5pc2hlZHx8KGkuZGVsYXkodGhpcy5fdGlja0FuZFJlcGVhdCxbXSx0aGlzKSx0aGlzLl90aWNrU2NoZWR1bGVkPSEwKSl9LHMucHJvdG90eXBlLl90aWNrPWZ1bmN0aW9uKCl7aWYodGhpcy5pc1BhdXNlZHx8dGhpcy5pc0ZpbmlzaGVkKXJldHVybiExO3ZhciB0PW51bGwsZT1NYXRoLm1pbih0aGlzLm1heCx0aGlzLmluZGV4KzE2Mzg0KTtpZih0aGlzLmluZGV4Pj10aGlzLm1heClyZXR1cm4gdGhpcy5lbmQoKTtzd2l0Y2godGhpcy50eXBlKXtjYXNlInN0cmluZyI6dD10aGlzLmRhdGEuc3Vic3RyaW5nKHRoaXMuaW5kZXgsZSk7YnJlYWs7Y2FzZSJ1aW50OGFycmF5Ijp0PXRoaXMuZGF0YS5zdWJhcnJheSh0aGlzLmluZGV4LGUpO2JyZWFrO2Nhc2UiYXJyYXkiOmNhc2Uibm9kZWJ1ZmZlciI6dD10aGlzLmRhdGEuc2xpY2UodGhpcy5pbmRleCxlKX1yZXR1cm4gdGhpcy5pbmRleD1lLHRoaXMucHVzaCh7ZGF0YTp0LG1ldGE6e3BlcmNlbnQ6dGhpcy5tYXg/dGhpcy5pbmRleC90aGlzLm1heCoxMDA6MH19KX0sZS5leHBvcnRzPXN9LHsiLi4vdXRpbHMiOjMyLCIuL0dlbmVyaWNXb3JrZXIiOjI4fV0sMjg6W2Z1bmN0aW9uKHQsZSxyKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gaSh0KXt0aGlzLm5hbWU9dHx8ImRlZmF1bHQiLHRoaXMuc3RyZWFtSW5mbz17fSx0aGlzLmdlbmVyYXRlZEVycm9yPW51bGwsdGhpcy5leHRyYVN0cmVhbUluZm89e30sdGhpcy5pc1BhdXNlZD0hMCx0aGlzLmlzRmluaXNoZWQ9ITEsdGhpcy5pc0xvY2tlZD0hMSx0aGlzLl9saXN0ZW5lcnM9e2RhdGE6W10sZW5kOltdLGVycm9yOltdfSx0aGlzLnByZXZpb3VzPW51bGx9aS5wcm90b3R5cGU9e3B1c2g6ZnVuY3Rpb24odCl7dGhpcy5lbWl0KCJkYXRhIix0KX0sZW5kOmZ1bmN0aW9uKCl7aWYodGhpcy5pc0ZpbmlzaGVkKXJldHVybiExO3RoaXMuZmx1c2goKTt0cnl7dGhpcy5lbWl0KCJlbmQiKSx0aGlzLmNsZWFuVXAoKSx0aGlzLmlzRmluaXNoZWQ9ITB9Y2F0Y2godCl7dGhpcy5lbWl0KCJlcnJvciIsdCl9cmV0dXJuITB9LGVycm9yOmZ1bmN0aW9uKHQpe3JldHVybiF0aGlzLmlzRmluaXNoZWQmJih0aGlzLmlzUGF1c2VkP3RoaXMuZ2VuZXJhdGVkRXJyb3I9dDoodGhpcy5pc0ZpbmlzaGVkPSEwLHRoaXMuZW1pdCgiZXJyb3IiLHQpLHRoaXMucHJldmlvdXMmJnRoaXMucHJldmlvdXMuZXJyb3IodCksdGhpcy5jbGVhblVwKCkpLCEwKX0sb246ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5fbGlzdGVuZXJzW3RdLnB1c2goZSksdGhpc30sY2xlYW5VcDpmdW5jdGlvbigpe3RoaXMuc3RyZWFtSW5mbz10aGlzLmdlbmVyYXRlZEVycm9yPXRoaXMuZXh0cmFTdHJlYW1JbmZvPW51bGwsdGhpcy5fbGlzdGVuZXJzPVtdfSxlbWl0OmZ1bmN0aW9uKHQsZSl7aWYodGhpcy5fbGlzdGVuZXJzW3RdKWZvcih2YXIgcj0wO3I8dGhpcy5fbGlzdGVuZXJzW3RdLmxlbmd0aDtyKyspdGhpcy5fbGlzdGVuZXJzW3RdW3JdLmNhbGwodGhpcyxlKX0scGlwZTpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZWdpc3RlclByZXZpb3VzKHRoaXMpfSxyZWdpc3RlclByZXZpb3VzOmZ1bmN0aW9uKHQpe2lmKHRoaXMuaXNMb2NrZWQpdGhyb3cgbmV3IEVycm9yKCJUaGUgc3RyZWFtICciK3RoaXMrIicgaGFzIGFscmVhZHkgYmVlbiB1c2VkLiIpO3RoaXMuc3RyZWFtSW5mbz10LnN0cmVhbUluZm8sdGhpcy5tZXJnZVN0cmVhbUluZm8oKSx0aGlzLnByZXZpb3VzPXQ7dmFyIGU9dGhpcztyZXR1cm4gdC5vbigiZGF0YSIsZnVuY3Rpb24odCl7ZS5wcm9jZXNzQ2h1bmsodCl9KSx0Lm9uKCJlbmQiLGZ1bmN0aW9uKCl7ZS5lbmQoKX0pLHQub24oImVycm9yIixmdW5jdGlvbih0KXtlLmVycm9yKHQpfSksdGhpc30scGF1c2U6ZnVuY3Rpb24oKXtyZXR1cm4hdGhpcy5pc1BhdXNlZCYmIXRoaXMuaXNGaW5pc2hlZCYmKHRoaXMuaXNQYXVzZWQ9ITAsdGhpcy5wcmV2aW91cyYmdGhpcy5wcmV2aW91cy5wYXVzZSgpLCEwKX0scmVzdW1lOmZ1bmN0aW9uKCl7aWYoIXRoaXMuaXNQYXVzZWR8fHRoaXMuaXNGaW5pc2hlZClyZXR1cm4hMTt2YXIgdD10aGlzLmlzUGF1c2VkPSExO3JldHVybiB0aGlzLmdlbmVyYXRlZEVycm9yJiYodGhpcy5lcnJvcih0aGlzLmdlbmVyYXRlZEVycm9yKSx0PSEwKSx0aGlzLnByZXZpb3VzJiZ0aGlzLnByZXZpb3VzLnJlc3VtZSgpLCF0fSxmbHVzaDpmdW5jdGlvbigpe30scHJvY2Vzc0NodW5rOmZ1bmN0aW9uKHQpe3RoaXMucHVzaCh0KX0sd2l0aFN0cmVhbUluZm86ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5leHRyYVN0cmVhbUluZm9bdF09ZSx0aGlzLm1lcmdlU3RyZWFtSW5mbygpLHRoaXN9LG1lcmdlU3RyZWFtSW5mbzpmdW5jdGlvbigpe2Zvcih2YXIgdCBpbiB0aGlzLmV4dHJhU3RyZWFtSW5mbyl0aGlzLmV4dHJhU3RyZWFtSW5mby5oYXNPd25Qcm9wZXJ0eSh0KSYmKHRoaXMuc3RyZWFtSW5mb1t0XT10aGlzLmV4dHJhU3RyZWFtSW5mb1t0XSl9LGxvY2s6ZnVuY3Rpb24oKXtpZih0aGlzLmlzTG9ja2VkKXRocm93IG5ldyBFcnJvcigiVGhlIHN0cmVhbSAnIit0aGlzKyInIGhhcyBhbHJlYWR5IGJlZW4gdXNlZC4iKTt0aGlzLmlzTG9ja2VkPSEwLHRoaXMucHJldmlvdXMmJnRoaXMucHJldmlvdXMubG9jaygpfSx0b1N0cmluZzpmdW5jdGlvbigpe3ZhciB0PSJXb3JrZXIgIit0aGlzLm5hbWU7cmV0dXJuIHRoaXMucHJldmlvdXM/dGhpcy5wcmV2aW91cysiIC0+ICIrdDp0fX0sZS5leHBvcnRzPWl9LHt9XSwyOTpbZnVuY3Rpb24odCxlLHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgaD10KCIuLi91dGlscyIpLG49dCgiLi9Db252ZXJ0V29ya2VyIikscz10KCIuL0dlbmVyaWNXb3JrZXIiKSx1PXQoIi4uL2Jhc2U2NCIpLGk9dCgiLi4vc3VwcG9ydCIpLGE9dCgiLi4vZXh0ZXJuYWwiKSxvPW51bGw7aWYoaS5ub2Rlc3RyZWFtKXRyeXtvPXQoIi4uL25vZGVqcy9Ob2RlanNTdHJlYW1PdXRwdXRBZGFwdGVyIil9Y2F0Y2godCl7fWZ1bmN0aW9uIGwodCxvKXtyZXR1cm4gbmV3IGEuUHJvbWlzZShmdW5jdGlvbihlLHIpe3ZhciBpPVtdLG49dC5faW50ZXJuYWxUeXBlLHM9dC5fb3V0cHV0VHlwZSxhPXQuX21pbWVUeXBlO3Qub24oImRhdGEiLGZ1bmN0aW9uKHQsZSl7aS5wdXNoKHQpLG8mJm8oZSl9KS5vbigiZXJyb3IiLGZ1bmN0aW9uKHQpe2k9W10scih0KX0pLm9uKCJlbmQiLGZ1bmN0aW9uKCl7dHJ5e3ZhciB0PWZ1bmN0aW9uKHQsZSxyKXtzd2l0Y2godCl7Y2FzZSJibG9iIjpyZXR1cm4gaC5uZXdCbG9iKGgudHJhbnNmb3JtVG8oImFycmF5YnVmZmVyIixlKSxyKTtjYXNlImJhc2U2NCI6cmV0dXJuIHUuZW5jb2RlKGUpO2RlZmF1bHQ6cmV0dXJuIGgudHJhbnNmb3JtVG8odCxlKX19KHMsZnVuY3Rpb24odCxlKXt2YXIgcixpPTAsbj1udWxsLHM9MDtmb3Iocj0wO3I8ZS5sZW5ndGg7cisrKXMrPWVbcl0ubGVuZ3RoO3N3aXRjaCh0KXtjYXNlInN0cmluZyI6cmV0dXJuIGUuam9pbigiIik7Y2FzZSJhcnJheSI6cmV0dXJuIEFycmF5LnByb3RvdHlwZS5jb25jYXQuYXBwbHkoW10sZSk7Y2FzZSJ1aW50OGFycmF5Ijpmb3Iobj1uZXcgVWludDhBcnJheShzKSxyPTA7cjxlLmxlbmd0aDtyKyspbi5zZXQoZVtyXSxpKSxpKz1lW3JdLmxlbmd0aDtyZXR1cm4gbjtjYXNlIm5vZGVidWZmZXIiOnJldHVybiBCdWZmZXIuY29uY2F0KGUpO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJjb25jYXQgOiB1bnN1cHBvcnRlZCB0eXBlICciK3QrIiciKX19KG4saSksYSk7ZSh0KX1jYXRjaCh0KXtyKHQpfWk9W119KS5yZXN1bWUoKX0pfWZ1bmN0aW9uIGYodCxlLHIpe3ZhciBpPWU7c3dpdGNoKGUpe2Nhc2UiYmxvYiI6Y2FzZSJhcnJheWJ1ZmZlciI6aT0idWludDhhcnJheSI7YnJlYWs7Y2FzZSJiYXNlNjQiOmk9InN0cmluZyJ9dHJ5e3RoaXMuX2ludGVybmFsVHlwZT1pLHRoaXMuX291dHB1dFR5cGU9ZSx0aGlzLl9taW1lVHlwZT1yLGguY2hlY2tTdXBwb3J0KGkpLHRoaXMuX3dvcmtlcj10LnBpcGUobmV3IG4oaSkpLHQubG9jaygpfWNhdGNoKHQpe3RoaXMuX3dvcmtlcj1uZXcgcygiZXJyb3IiKSx0aGlzLl93b3JrZXIuZXJyb3IodCl9fWYucHJvdG90eXBlPXthY2N1bXVsYXRlOmZ1bmN0aW9uKHQpe3JldHVybiBsKHRoaXMsdCl9LG9uOmZ1bmN0aW9uKHQsZSl7dmFyIHI9dGhpcztyZXR1cm4iZGF0YSI9PT10P3RoaXMuX3dvcmtlci5vbih0LGZ1bmN0aW9uKHQpe2UuY2FsbChyLHQuZGF0YSx0Lm1ldGEpfSk6dGhpcy5fd29ya2VyLm9uKHQsZnVuY3Rpb24oKXtoLmRlbGF5KGUsYXJndW1lbnRzLHIpfSksdGhpc30scmVzdW1lOmZ1bmN0aW9uKCl7cmV0dXJuIGguZGVsYXkodGhpcy5fd29ya2VyLnJlc3VtZSxbXSx0aGlzLl93b3JrZXIpLHRoaXN9LHBhdXNlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3dvcmtlci5wYXVzZSgpLHRoaXN9LHRvTm9kZWpzU3RyZWFtOmZ1bmN0aW9uKHQpe2lmKGguY2hlY2tTdXBwb3J0KCJub2Rlc3RyZWFtIiksIm5vZGVidWZmZXIiIT09dGhpcy5fb3V0cHV0VHlwZSl0aHJvdyBuZXcgRXJyb3IodGhpcy5fb3V0cHV0VHlwZSsiIGlzIG5vdCBzdXBwb3J0ZWQgYnkgdGhpcyBtZXRob2QiKTtyZXR1cm4gbmV3IG8odGhpcyx7b2JqZWN0TW9kZToibm9kZWJ1ZmZlciIhPT10aGlzLl9vdXRwdXRUeXBlfSx0KX19LGUuZXhwb3J0cz1mfSx7Ii4uL2Jhc2U2NCI6MSwiLi4vZXh0ZXJuYWwiOjYsIi4uL25vZGVqcy9Ob2RlanNTdHJlYW1PdXRwdXRBZGFwdGVyIjoxMywiLi4vc3VwcG9ydCI6MzAsIi4uL3V0aWxzIjozMiwiLi9Db252ZXJ0V29ya2VyIjoyNCwiLi9HZW5lcmljV29ya2VyIjoyOH1dLDMwOltmdW5jdGlvbih0LGUscil7InVzZSBzdHJpY3QiO2lmKHIuYmFzZTY0PSEwLHIuYXJyYXk9ITAsci5zdHJpbmc9ITAsci5hcnJheWJ1ZmZlcj0idW5kZWZpbmVkIiE9dHlwZW9mIEFycmF5QnVmZmVyJiYidW5kZWZpbmVkIiE9dHlwZW9mIFVpbnQ4QXJyYXksci5ub2RlYnVmZmVyPSJ1bmRlZmluZWQiIT10eXBlb2YgQnVmZmVyLHIudWludDhhcnJheT0idW5kZWZpbmVkIiE9dHlwZW9mIFVpbnQ4QXJyYXksInVuZGVmaW5lZCI9PXR5cGVvZiBBcnJheUJ1ZmZlcilyLmJsb2I9ITE7ZWxzZXt2YXIgaT1uZXcgQXJyYXlCdWZmZXIoMCk7dHJ5e3IuYmxvYj0wPT09bmV3IEJsb2IoW2ldLHt0eXBlOiJhcHBsaWNhdGlvbi96aXAifSkuc2l6ZX1jYXRjaCh0KXt0cnl7dmFyIG49bmV3KHNlbGYuQmxvYkJ1aWxkZXJ8fHNlbGYuV2ViS2l0QmxvYkJ1aWxkZXJ8fHNlbGYuTW96QmxvYkJ1aWxkZXJ8fHNlbGYuTVNCbG9iQnVpbGRlcik7bi5hcHBlbmQoaSksci5ibG9iPTA9PT1uLmdldEJsb2IoImFwcGxpY2F0aW9uL3ppcCIpLnNpemV9Y2F0Y2godCl7ci5ibG9iPSExfX19dHJ5e3Iubm9kZXN0cmVhbT0hIXQoInJlYWRhYmxlLXN0cmVhbSIpLlJlYWRhYmxlfWNhdGNoKHQpe3Iubm9kZXN0cmVhbT0hMX19LHsicmVhZGFibGUtc3RyZWFtIjoxNn1dLDMxOltmdW5jdGlvbih0LGUscyl7InVzZSBzdHJpY3QiO2Zvcih2YXIgbz10KCIuL3V0aWxzIiksaD10KCIuL3N1cHBvcnQiKSxyPXQoIi4vbm9kZWpzVXRpbHMiKSxpPXQoIi4vc3RyZWFtL0dlbmVyaWNXb3JrZXIiKSx1PW5ldyBBcnJheSgyNTYpLG49MDtuPDI1NjtuKyspdVtuXT0yNTI8PW4/NjoyNDg8PW4/NToyNDA8PW4/NDoyMjQ8PW4/MzoxOTI8PW4/MjoxO3VbMjU0XT11WzI1NF09MTtmdW5jdGlvbiBhKCl7aS5jYWxsKHRoaXMsInV0Zi04IGRlY29kZSIpLHRoaXMubGVmdE92ZXI9bnVsbH1mdW5jdGlvbiBsKCl7aS5jYWxsKHRoaXMsInV0Zi04IGVuY29kZSIpfXMudXRmOGVuY29kZT1mdW5jdGlvbih0KXtyZXR1cm4gaC5ub2RlYnVmZmVyP3IubmV3QnVmZmVyRnJvbSh0LCJ1dGYtOCIpOmZ1bmN0aW9uKHQpe3ZhciBlLHIsaSxuLHMsYT10Lmxlbmd0aCxvPTA7Zm9yKG49MDtuPGE7bisrKTU1Mjk2PT0oNjQ1MTImKHI9dC5jaGFyQ29kZUF0KG4pKSkmJm4rMTxhJiY1NjMyMD09KDY0NTEyJihpPXQuY2hhckNvZGVBdChuKzEpKSkmJihyPTY1NTM2KyhyLTU1Mjk2PDwxMCkrKGktNTYzMjApLG4rKyksbys9cjwxMjg/MTpyPDIwNDg/MjpyPDY1NTM2PzM6NDtmb3IoZT1oLnVpbnQ4YXJyYXk/bmV3IFVpbnQ4QXJyYXkobyk6bmV3IEFycmF5KG8pLG49cz0wO3M8bztuKyspNTUyOTY9PSg2NDUxMiYocj10LmNoYXJDb2RlQXQobikpKSYmbisxPGEmJjU2MzIwPT0oNjQ1MTImKGk9dC5jaGFyQ29kZUF0KG4rMSkpKSYmKHI9NjU1MzYrKHItNTUyOTY8PDEwKSsoaS01NjMyMCksbisrKSxyPDEyOD9lW3MrK109cjoocjwyMDQ4P2VbcysrXT0xOTJ8cj4+PjY6KHI8NjU1MzY/ZVtzKytdPTIyNHxyPj4+MTI6KGVbcysrXT0yNDB8cj4+PjE4LGVbcysrXT0xMjh8cj4+PjEyJjYzKSxlW3MrK109MTI4fHI+Pj42JjYzKSxlW3MrK109MTI4fDYzJnIpO3JldHVybiBlfSh0KX0scy51dGY4ZGVjb2RlPWZ1bmN0aW9uKHQpe3JldHVybiBoLm5vZGVidWZmZXI/by50cmFuc2Zvcm1Ubygibm9kZWJ1ZmZlciIsdCkudG9TdHJpbmcoInV0Zi04Iik6ZnVuY3Rpb24odCl7dmFyIGUscixpLG4scz10Lmxlbmd0aCxhPW5ldyBBcnJheSgyKnMpO2ZvcihlPXI9MDtlPHM7KWlmKChpPXRbZSsrXSk8MTI4KWFbcisrXT1pO2Vsc2UgaWYoNDwobj11W2ldKSlhW3IrK109NjU1MzMsZSs9bi0xO2Vsc2V7Zm9yKGkmPTI9PT1uPzMxOjM9PT1uPzE1Ojc7MTxuJiZlPHM7KWk9aTw8Nnw2MyZ0W2UrK10sbi0tOzE8bj9hW3IrK109NjU1MzM6aTw2NTUzNj9hW3IrK109aTooaS09NjU1MzYsYVtyKytdPTU1Mjk2fGk+PjEwJjEwMjMsYVtyKytdPTU2MzIwfDEwMjMmaSl9cmV0dXJuIGEubGVuZ3RoIT09ciYmKGEuc3ViYXJyYXk/YT1hLnN1YmFycmF5KDAscik6YS5sZW5ndGg9ciksby5hcHBseUZyb21DaGFyQ29kZShhKX0odD1vLnRyYW5zZm9ybVRvKGgudWludDhhcnJheT8idWludDhhcnJheSI6ImFycmF5Iix0KSl9LG8uaW5oZXJpdHMoYSxpKSxhLnByb3RvdHlwZS5wcm9jZXNzQ2h1bms9ZnVuY3Rpb24odCl7dmFyIGU9by50cmFuc2Zvcm1UbyhoLnVpbnQ4YXJyYXk/InVpbnQ4YXJyYXkiOiJhcnJheSIsdC5kYXRhKTtpZih0aGlzLmxlZnRPdmVyJiZ0aGlzLmxlZnRPdmVyLmxlbmd0aCl7aWYoaC51aW50OGFycmF5KXt2YXIgcj1lOyhlPW5ldyBVaW50OEFycmF5KHIubGVuZ3RoK3RoaXMubGVmdE92ZXIubGVuZ3RoKSkuc2V0KHRoaXMubGVmdE92ZXIsMCksZS5zZXQocix0aGlzLmxlZnRPdmVyLmxlbmd0aCl9ZWxzZSBlPXRoaXMubGVmdE92ZXIuY29uY2F0KGUpO3RoaXMubGVmdE92ZXI9bnVsbH12YXIgaT1mdW5jdGlvbih0LGUpe3ZhciByO2ZvcigoZT1lfHx0Lmxlbmd0aCk+dC5sZW5ndGgmJihlPXQubGVuZ3RoKSxyPWUtMTswPD1yJiYxMjg9PSgxOTImdFtyXSk7KXItLTtyZXR1cm4gcjwwP2U6MD09PXI/ZTpyK3VbdFtyXV0+ZT9yOmV9KGUpLG49ZTtpIT09ZS5sZW5ndGgmJihoLnVpbnQ4YXJyYXk/KG49ZS5zdWJhcnJheSgwLGkpLHRoaXMubGVmdE92ZXI9ZS5zdWJhcnJheShpLGUubGVuZ3RoKSk6KG49ZS5zbGljZSgwLGkpLHRoaXMubGVmdE92ZXI9ZS5zbGljZShpLGUubGVuZ3RoKSkpLHRoaXMucHVzaCh7ZGF0YTpzLnV0ZjhkZWNvZGUobiksbWV0YTp0Lm1ldGF9KX0sYS5wcm90b3R5cGUuZmx1c2g9ZnVuY3Rpb24oKXt0aGlzLmxlZnRPdmVyJiZ0aGlzLmxlZnRPdmVyLmxlbmd0aCYmKHRoaXMucHVzaCh7ZGF0YTpzLnV0ZjhkZWNvZGUodGhpcy5sZWZ0T3ZlciksbWV0YTp7fX0pLHRoaXMubGVmdE92ZXI9bnVsbCl9LHMuVXRmOERlY29kZVdvcmtlcj1hLG8uaW5oZXJpdHMobCxpKSxsLnByb3RvdHlwZS5wcm9jZXNzQ2h1bms9ZnVuY3Rpb24odCl7dGhpcy5wdXNoKHtkYXRhOnMudXRmOGVuY29kZSh0LmRhdGEpLG1ldGE6dC5tZXRhfSl9LHMuVXRmOEVuY29kZVdvcmtlcj1sfSx7Ii4vbm9kZWpzVXRpbHMiOjE0LCIuL3N0cmVhbS9HZW5lcmljV29ya2VyIjoyOCwiLi9zdXBwb3J0IjozMCwiLi91dGlscyI6MzJ9XSwzMjpbZnVuY3Rpb24odCxlLGEpeyJ1c2Ugc3RyaWN0Ijt2YXIgbz10KCIuL3N1cHBvcnQiKSxoPXQoIi4vYmFzZTY0Iikscj10KCIuL25vZGVqc1V0aWxzIiksaT10KCJzZXQtaW1tZWRpYXRlLXNoaW0iKSx1PXQoIi4vZXh0ZXJuYWwiKTtmdW5jdGlvbiBuKHQpe3JldHVybiB0fWZ1bmN0aW9uIGwodCxlKXtmb3IodmFyIHI9MDtyPHQubGVuZ3RoOysrcillW3JdPTI1NSZ0LmNoYXJDb2RlQXQocik7cmV0dXJuIGV9YS5uZXdCbG9iPWZ1bmN0aW9uKGUscil7YS5jaGVja1N1cHBvcnQoImJsb2IiKTt0cnl7cmV0dXJuIG5ldyBCbG9iKFtlXSx7dHlwZTpyfSl9Y2F0Y2godCl7dHJ5e3ZhciBpPW5ldyhzZWxmLkJsb2JCdWlsZGVyfHxzZWxmLldlYktpdEJsb2JCdWlsZGVyfHxzZWxmLk1vekJsb2JCdWlsZGVyfHxzZWxmLk1TQmxvYkJ1aWxkZXIpO3JldHVybiBpLmFwcGVuZChlKSxpLmdldEJsb2Iocil9Y2F0Y2godCl7dGhyb3cgbmV3IEVycm9yKCJCdWcgOiBjYW4ndCBjb25zdHJ1Y3QgdGhlIEJsb2IuIil9fX07dmFyIHM9e3N0cmluZ2lmeUJ5Q2h1bms6ZnVuY3Rpb24odCxlLHIpe3ZhciBpPVtdLG49MCxzPXQubGVuZ3RoO2lmKHM8PXIpcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCx0KTtmb3IoO248czspImFycmF5Ij09PWV8fCJub2RlYnVmZmVyIj09PWU/aS5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCx0LnNsaWNlKG4sTWF0aC5taW4obityLHMpKSkpOmkucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsdC5zdWJhcnJheShuLE1hdGgubWluKG4rcixzKSkpKSxuKz1yO3JldHVybiBpLmpvaW4oIiIpfSxzdHJpbmdpZnlCeUNoYXI6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPSIiLHI9MDtyPHQubGVuZ3RoO3IrKyllKz1TdHJpbmcuZnJvbUNoYXJDb2RlKHRbcl0pO3JldHVybiBlfSxhcHBseUNhbkJlVXNlZDp7dWludDhhcnJheTpmdW5jdGlvbigpe3RyeXtyZXR1cm4gby51aW50OGFycmF5JiYxPT09U3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLG5ldyBVaW50OEFycmF5KDEpKS5sZW5ndGh9Y2F0Y2godCl7cmV0dXJuITF9fSgpLG5vZGVidWZmZXI6ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIG8ubm9kZWJ1ZmZlciYmMT09PVN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCxyLmFsbG9jQnVmZmVyKDEpKS5sZW5ndGh9Y2F0Y2godCl7cmV0dXJuITF9fSgpfX07ZnVuY3Rpb24gZih0KXt2YXIgZT02NTUzNixyPWEuZ2V0VHlwZU9mKHQpLGk9ITA7aWYoInVpbnQ4YXJyYXkiPT09cj9pPXMuYXBwbHlDYW5CZVVzZWQudWludDhhcnJheToibm9kZWJ1ZmZlciI9PT1yJiYoaT1zLmFwcGx5Q2FuQmVVc2VkLm5vZGVidWZmZXIpLGkpZm9yKDsxPGU7KXRyeXtyZXR1cm4gcy5zdHJpbmdpZnlCeUNodW5rKHQscixlKX1jYXRjaCh0KXtlPU1hdGguZmxvb3IoZS8yKX1yZXR1cm4gcy5zdHJpbmdpZnlCeUNoYXIodCl9ZnVuY3Rpb24gZCh0LGUpe2Zvcih2YXIgcj0wO3I8dC5sZW5ndGg7cisrKWVbcl09dFtyXTtyZXR1cm4gZX1hLmFwcGx5RnJvbUNoYXJDb2RlPWY7dmFyIGM9e307Yy5zdHJpbmc9e3N0cmluZzpuLGFycmF5OmZ1bmN0aW9uKHQpe3JldHVybiBsKHQsbmV3IEFycmF5KHQubGVuZ3RoKSl9LGFycmF5YnVmZmVyOmZ1bmN0aW9uKHQpe3JldHVybiBjLnN0cmluZy51aW50OGFycmF5KHQpLmJ1ZmZlcn0sdWludDhhcnJheTpmdW5jdGlvbih0KXtyZXR1cm4gbCh0LG5ldyBVaW50OEFycmF5KHQubGVuZ3RoKSl9LG5vZGVidWZmZXI6ZnVuY3Rpb24odCl7cmV0dXJuIGwodCxyLmFsbG9jQnVmZmVyKHQubGVuZ3RoKSl9fSxjLmFycmF5PXtzdHJpbmc6ZixhcnJheTpuLGFycmF5YnVmZmVyOmZ1bmN0aW9uKHQpe3JldHVybiBuZXcgVWludDhBcnJheSh0KS5idWZmZXJ9LHVpbnQ4YXJyYXk6ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBVaW50OEFycmF5KHQpfSxub2RlYnVmZmVyOmZ1bmN0aW9uKHQpe3JldHVybiByLm5ld0J1ZmZlckZyb20odCl9fSxjLmFycmF5YnVmZmVyPXtzdHJpbmc6ZnVuY3Rpb24odCl7cmV0dXJuIGYobmV3IFVpbnQ4QXJyYXkodCkpfSxhcnJheTpmdW5jdGlvbih0KXtyZXR1cm4gZChuZXcgVWludDhBcnJheSh0KSxuZXcgQXJyYXkodC5ieXRlTGVuZ3RoKSl9LGFycmF5YnVmZmVyOm4sdWludDhhcnJheTpmdW5jdGlvbih0KXtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkodCl9LG5vZGVidWZmZXI6ZnVuY3Rpb24odCl7cmV0dXJuIHIubmV3QnVmZmVyRnJvbShuZXcgVWludDhBcnJheSh0KSl9fSxjLnVpbnQ4YXJyYXk9e3N0cmluZzpmLGFycmF5OmZ1bmN0aW9uKHQpe3JldHVybiBkKHQsbmV3IEFycmF5KHQubGVuZ3RoKSl9LGFycmF5YnVmZmVyOmZ1bmN0aW9uKHQpe3JldHVybiB0LmJ1ZmZlcn0sdWludDhhcnJheTpuLG5vZGVidWZmZXI6ZnVuY3Rpb24odCl7cmV0dXJuIHIubmV3QnVmZmVyRnJvbSh0KX19LGMubm9kZWJ1ZmZlcj17c3RyaW5nOmYsYXJyYXk6ZnVuY3Rpb24odCl7cmV0dXJuIGQodCxuZXcgQXJyYXkodC5sZW5ndGgpKX0sYXJyYXlidWZmZXI6ZnVuY3Rpb24odCl7cmV0dXJuIGMubm9kZWJ1ZmZlci51aW50OGFycmF5KHQpLmJ1ZmZlcn0sdWludDhhcnJheTpmdW5jdGlvbih0KXtyZXR1cm4gZCh0LG5ldyBVaW50OEFycmF5KHQubGVuZ3RoKSl9LG5vZGVidWZmZXI6bn0sYS50cmFuc2Zvcm1Ubz1mdW5jdGlvbih0LGUpe2lmKGU9ZXx8IiIsIXQpcmV0dXJuIGU7YS5jaGVja1N1cHBvcnQodCk7dmFyIHI9YS5nZXRUeXBlT2YoZSk7cmV0dXJuIGNbcl1bdF0oZSl9LGEucmVzb2x2ZT1mdW5jdGlvbih0KXtmb3IodmFyIGU9dC5zcGxpdCgiLyIpLHI9W10saT0wO2k8ZS5sZW5ndGg7aSsrKXt2YXIgbj1lW2ldOyIuIj09PW58fCIiPT09biYmMCE9PWkmJmkhPT1lLmxlbmd0aC0xfHwoIi4uIj09PW4/ci5wb3AoKTpyLnB1c2gobikpfXJldHVybiByLmpvaW4oIi8iKX0sYS5nZXRUeXBlT2Y9ZnVuY3Rpb24odCl7cmV0dXJuInN0cmluZyI9PXR5cGVvZiB0PyJzdHJpbmciOiJbb2JqZWN0IEFycmF5XSI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCk/ImFycmF5IjpvLm5vZGVidWZmZXImJnIuaXNCdWZmZXIodCk/Im5vZGVidWZmZXIiOm8udWludDhhcnJheSYmdCBpbnN0YW5jZW9mIFVpbnQ4QXJyYXk/InVpbnQ4YXJyYXkiOm8uYXJyYXlidWZmZXImJnQgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj8iYXJyYXlidWZmZXIiOnZvaWQgMH0sYS5jaGVja1N1cHBvcnQ9ZnVuY3Rpb24odCl7aWYoIW9bdC50b0xvd2VyQ2FzZSgpXSl0aHJvdyBuZXcgRXJyb3IodCsiIGlzIG5vdCBzdXBwb3J0ZWQgYnkgdGhpcyBwbGF0Zm9ybSIpfSxhLk1BWF9WQUxVRV8xNkJJVFM9NjU1MzUsYS5NQVhfVkFMVUVfMzJCSVRTPS0xLGEucHJldHR5PWZ1bmN0aW9uKHQpe3ZhciBlLHIsaT0iIjtmb3Iocj0wO3I8KHR8fCIiKS5sZW5ndGg7cisrKWkrPSJcXHgiKygoZT10LmNoYXJDb2RlQXQocikpPDE2PyIwIjoiIikrZS50b1N0cmluZygxNikudG9VcHBlckNhc2UoKTtyZXR1cm4gaX0sYS5kZWxheT1mdW5jdGlvbih0LGUscil7aShmdW5jdGlvbigpe3QuYXBwbHkocnx8bnVsbCxlfHxbXSl9KX0sYS5pbmhlcml0cz1mdW5jdGlvbih0LGUpe2Z1bmN0aW9uIHIoKXt9ci5wcm90b3R5cGU9ZS5wcm90b3R5cGUsdC5wcm90b3R5cGU9bmV3IHJ9LGEuZXh0ZW5kPWZ1bmN0aW9uKCl7dmFyIHQsZSxyPXt9O2Zvcih0PTA7dDxhcmd1bWVudHMubGVuZ3RoO3QrKylmb3IoZSBpbiBhcmd1bWVudHNbdF0pYXJndW1lbnRzW3RdLmhhc093blByb3BlcnR5KGUpJiZ2b2lkIDA9PT1yW2VdJiYocltlXT1hcmd1bWVudHNbdF1bZV0pO3JldHVybiByfSxhLnByZXBhcmVDb250ZW50PWZ1bmN0aW9uKHIsdCxpLG4scyl7cmV0dXJuIHUuUHJvbWlzZS5yZXNvbHZlKHQpLnRoZW4oZnVuY3Rpb24oaSl7cmV0dXJuIG8uYmxvYiYmKGkgaW5zdGFuY2VvZiBCbG9ifHwtMSE9PVsiW29iamVjdCBGaWxlXSIsIltvYmplY3QgQmxvYl0iXS5pbmRleE9mKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpKSkpJiYidW5kZWZpbmVkIiE9dHlwZW9mIEZpbGVSZWFkZXI/bmV3IHUuUHJvbWlzZShmdW5jdGlvbihlLHIpe3ZhciB0PW5ldyBGaWxlUmVhZGVyO3Qub25sb2FkPWZ1bmN0aW9uKHQpe2UodC50YXJnZXQucmVzdWx0KX0sdC5vbmVycm9yPWZ1bmN0aW9uKHQpe3IodC50YXJnZXQuZXJyb3IpfSx0LnJlYWRBc0FycmF5QnVmZmVyKGkpfSk6aX0pLnRoZW4oZnVuY3Rpb24odCl7dmFyIGU9YS5nZXRUeXBlT2YodCk7cmV0dXJuIGU/KCJhcnJheWJ1ZmZlciI9PT1lP3Q9YS50cmFuc2Zvcm1UbygidWludDhhcnJheSIsdCk6InN0cmluZyI9PT1lJiYocz90PWguZGVjb2RlKHQpOmkmJiEwIT09biYmKHQ9ZnVuY3Rpb24odCl7cmV0dXJuIGwodCxvLnVpbnQ4YXJyYXk/bmV3IFVpbnQ4QXJyYXkodC5sZW5ndGgpOm5ldyBBcnJheSh0Lmxlbmd0aCkpfSh0KSkpLHQpOnUuUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCJDYW4ndCByZWFkIHRoZSBkYXRhIG9mICciK3IrIicuIElzIGl0IGluIGEgc3VwcG9ydGVkIEphdmFTY3JpcHQgdHlwZSAoU3RyaW5nLCBCbG9iLCBBcnJheUJ1ZmZlciwgZXRjKSA/IikpfSl9fSx7Ii4vYmFzZTY0IjoxLCIuL2V4dGVybmFsIjo2LCIuL25vZGVqc1V0aWxzIjoxNCwiLi9zdXBwb3J0IjozMCwic2V0LWltbWVkaWF0ZS1zaGltIjo1NH1dLDMzOltmdW5jdGlvbih0LGUscil7InVzZSBzdHJpY3QiO3ZhciBpPXQoIi4vcmVhZGVyL3JlYWRlckZvciIpLG49dCgiLi91dGlscyIpLHM9dCgiLi9zaWduYXR1cmUiKSxhPXQoIi4vemlwRW50cnkiKSxvPSh0KCIuL3V0ZjgiKSx0KCIuL3N1cHBvcnQiKSk7ZnVuY3Rpb24gaCh0KXt0aGlzLmZpbGVzPVtdLHRoaXMubG9hZE9wdGlvbnM9dH1oLnByb3RvdHlwZT17Y2hlY2tTaWduYXR1cmU6ZnVuY3Rpb24odCl7aWYoIXRoaXMucmVhZGVyLnJlYWRBbmRDaGVja1NpZ25hdHVyZSh0KSl7dGhpcy5yZWFkZXIuaW5kZXgtPTQ7dmFyIGU9dGhpcy5yZWFkZXIucmVhZFN0cmluZyg0KTt0aHJvdyBuZXcgRXJyb3IoIkNvcnJ1cHRlZCB6aXAgb3IgYnVnOiB1bmV4cGVjdGVkIHNpZ25hdHVyZSAoIituLnByZXR0eShlKSsiLCBleHBlY3RlZCAiK24ucHJldHR5KHQpKyIpIil9fSxpc1NpZ25hdHVyZTpmdW5jdGlvbih0LGUpe3ZhciByPXRoaXMucmVhZGVyLmluZGV4O3RoaXMucmVhZGVyLnNldEluZGV4KHQpO3ZhciBpPXRoaXMucmVhZGVyLnJlYWRTdHJpbmcoNCk9PT1lO3JldHVybiB0aGlzLnJlYWRlci5zZXRJbmRleChyKSxpfSxyZWFkQmxvY2tFbmRPZkNlbnRyYWw6ZnVuY3Rpb24oKXt0aGlzLmRpc2tOdW1iZXI9dGhpcy5yZWFkZXIucmVhZEludCgyKSx0aGlzLmRpc2tXaXRoQ2VudHJhbERpclN0YXJ0PXRoaXMucmVhZGVyLnJlYWRJbnQoMiksdGhpcy5jZW50cmFsRGlyUmVjb3Jkc09uVGhpc0Rpc2s9dGhpcy5yZWFkZXIucmVhZEludCgyKSx0aGlzLmNlbnRyYWxEaXJSZWNvcmRzPXRoaXMucmVhZGVyLnJlYWRJbnQoMiksdGhpcy5jZW50cmFsRGlyU2l6ZT10aGlzLnJlYWRlci5yZWFkSW50KDQpLHRoaXMuY2VudHJhbERpck9mZnNldD10aGlzLnJlYWRlci5yZWFkSW50KDQpLHRoaXMuemlwQ29tbWVudExlbmd0aD10aGlzLnJlYWRlci5yZWFkSW50KDIpO3ZhciB0PXRoaXMucmVhZGVyLnJlYWREYXRhKHRoaXMuemlwQ29tbWVudExlbmd0aCksZT1vLnVpbnQ4YXJyYXk/InVpbnQ4YXJyYXkiOiJhcnJheSIscj1uLnRyYW5zZm9ybVRvKGUsdCk7dGhpcy56aXBDb21tZW50PXRoaXMubG9hZE9wdGlvbnMuZGVjb2RlRmlsZU5hbWUocil9LHJlYWRCbG9ja1ppcDY0RW5kT2ZDZW50cmFsOmZ1bmN0aW9uKCl7dGhpcy56aXA2NEVuZE9mQ2VudHJhbFNpemU9dGhpcy5yZWFkZXIucmVhZEludCg4KSx0aGlzLnJlYWRlci5za2lwKDQpLHRoaXMuZGlza051bWJlcj10aGlzLnJlYWRlci5yZWFkSW50KDQpLHRoaXMuZGlza1dpdGhDZW50cmFsRGlyU3RhcnQ9dGhpcy5yZWFkZXIucmVhZEludCg0KSx0aGlzLmNlbnRyYWxEaXJSZWNvcmRzT25UaGlzRGlzaz10aGlzLnJlYWRlci5yZWFkSW50KDgpLHRoaXMuY2VudHJhbERpclJlY29yZHM9dGhpcy5yZWFkZXIucmVhZEludCg4KSx0aGlzLmNlbnRyYWxEaXJTaXplPXRoaXMucmVhZGVyLnJlYWRJbnQoOCksdGhpcy5jZW50cmFsRGlyT2Zmc2V0PXRoaXMucmVhZGVyLnJlYWRJbnQoOCksdGhpcy56aXA2NEV4dGVuc2libGVEYXRhPXt9O2Zvcih2YXIgdCxlLHIsaT10aGlzLnppcDY0RW5kT2ZDZW50cmFsU2l6ZS00NDswPGk7KXQ9dGhpcy5yZWFkZXIucmVhZEludCgyKSxlPXRoaXMucmVhZGVyLnJlYWRJbnQoNCkscj10aGlzLnJlYWRlci5yZWFkRGF0YShlKSx0aGlzLnppcDY0RXh0ZW5zaWJsZURhdGFbdF09e2lkOnQsbGVuZ3RoOmUsdmFsdWU6cn19LHJlYWRCbG9ja1ppcDY0RW5kT2ZDZW50cmFsTG9jYXRvcjpmdW5jdGlvbigpe2lmKHRoaXMuZGlza1dpdGhaaXA2NENlbnRyYWxEaXJTdGFydD10aGlzLnJlYWRlci5yZWFkSW50KDQpLHRoaXMucmVsYXRpdmVPZmZzZXRFbmRPZlppcDY0Q2VudHJhbERpcj10aGlzLnJlYWRlci5yZWFkSW50KDgpLHRoaXMuZGlza3NDb3VudD10aGlzLnJlYWRlci5yZWFkSW50KDQpLDE8dGhpcy5kaXNrc0NvdW50KXRocm93IG5ldyBFcnJvcigiTXVsdGktdm9sdW1lcyB6aXAgYXJlIG5vdCBzdXBwb3J0ZWQiKX0scmVhZExvY2FsRmlsZXM6ZnVuY3Rpb24oKXt2YXIgdCxlO2Zvcih0PTA7dDx0aGlzLmZpbGVzLmxlbmd0aDt0KyspZT10aGlzLmZpbGVzW3RdLHRoaXMucmVhZGVyLnNldEluZGV4KGUubG9jYWxIZWFkZXJPZmZzZXQpLHRoaXMuY2hlY2tTaWduYXR1cmUocy5MT0NBTF9GSUxFX0hFQURFUiksZS5yZWFkTG9jYWxQYXJ0KHRoaXMucmVhZGVyKSxlLmhhbmRsZVVURjgoKSxlLnByb2Nlc3NBdHRyaWJ1dGVzKCl9LHJlYWRDZW50cmFsRGlyOmZ1bmN0aW9uKCl7dmFyIHQ7Zm9yKHRoaXMucmVhZGVyLnNldEluZGV4KHRoaXMuY2VudHJhbERpck9mZnNldCk7dGhpcy5yZWFkZXIucmVhZEFuZENoZWNrU2lnbmF0dXJlKHMuQ0VOVFJBTF9GSUxFX0hFQURFUik7KSh0PW5ldyBhKHt6aXA2NDp0aGlzLnppcDY0fSx0aGlzLmxvYWRPcHRpb25zKSkucmVhZENlbnRyYWxQYXJ0KHRoaXMucmVhZGVyKSx0aGlzLmZpbGVzLnB1c2godCk7aWYodGhpcy5jZW50cmFsRGlyUmVjb3JkcyE9PXRoaXMuZmlsZXMubGVuZ3RoJiYwIT09dGhpcy5jZW50cmFsRGlyUmVjb3JkcyYmMD09PXRoaXMuZmlsZXMubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiQ29ycnVwdGVkIHppcCBvciBidWc6IGV4cGVjdGVkICIrdGhpcy5jZW50cmFsRGlyUmVjb3JkcysiIHJlY29yZHMgaW4gY2VudHJhbCBkaXIsIGdvdCAiK3RoaXMuZmlsZXMubGVuZ3RoKX0scmVhZEVuZE9mQ2VudHJhbDpmdW5jdGlvbigpe3ZhciB0PXRoaXMucmVhZGVyLmxhc3RJbmRleE9mU2lnbmF0dXJlKHMuQ0VOVFJBTF9ESVJFQ1RPUllfRU5EKTtpZih0PDApdGhyb3chdGhpcy5pc1NpZ25hdHVyZSgwLHMuTE9DQUxfRklMRV9IRUFERVIpP25ldyBFcnJvcigiQ2FuJ3QgZmluZCBlbmQgb2YgY2VudHJhbCBkaXJlY3RvcnkgOiBpcyB0aGlzIGEgemlwIGZpbGUgPyBJZiBpdCBpcywgc2VlIGh0dHBzOi8vc3R1ay5naXRodWIuaW8vanN6aXAvZG9jdW1lbnRhdGlvbi9ob3d0by9yZWFkX3ppcC5odG1sIik6bmV3IEVycm9yKCJDb3JydXB0ZWQgemlwOiBjYW4ndCBmaW5kIGVuZCBvZiBjZW50cmFsIGRpcmVjdG9yeSIpO3RoaXMucmVhZGVyLnNldEluZGV4KHQpO3ZhciBlPXQ7aWYodGhpcy5jaGVja1NpZ25hdHVyZShzLkNFTlRSQUxfRElSRUNUT1JZX0VORCksdGhpcy5yZWFkQmxvY2tFbmRPZkNlbnRyYWwoKSx0aGlzLmRpc2tOdW1iZXI9PT1uLk1BWF9WQUxVRV8xNkJJVFN8fHRoaXMuZGlza1dpdGhDZW50cmFsRGlyU3RhcnQ9PT1uLk1BWF9WQUxVRV8xNkJJVFN8fHRoaXMuY2VudHJhbERpclJlY29yZHNPblRoaXNEaXNrPT09bi5NQVhfVkFMVUVfMTZCSVRTfHx0aGlzLmNlbnRyYWxEaXJSZWNvcmRzPT09bi5NQVhfVkFMVUVfMTZCSVRTfHx0aGlzLmNlbnRyYWxEaXJTaXplPT09bi5NQVhfVkFMVUVfMzJCSVRTfHx0aGlzLmNlbnRyYWxEaXJPZmZzZXQ9PT1uLk1BWF9WQUxVRV8zMkJJVFMpe2lmKHRoaXMuemlwNjQ9ITAsKHQ9dGhpcy5yZWFkZXIubGFzdEluZGV4T2ZTaWduYXR1cmUocy5aSVA2NF9DRU5UUkFMX0RJUkVDVE9SWV9MT0NBVE9SKSk8MCl0aHJvdyBuZXcgRXJyb3IoIkNvcnJ1cHRlZCB6aXA6IGNhbid0IGZpbmQgdGhlIFpJUDY0IGVuZCBvZiBjZW50cmFsIGRpcmVjdG9yeSBsb2NhdG9yIik7aWYodGhpcy5yZWFkZXIuc2V0SW5kZXgodCksdGhpcy5jaGVja1NpZ25hdHVyZShzLlpJUDY0X0NFTlRSQUxfRElSRUNUT1JZX0xPQ0FUT1IpLHRoaXMucmVhZEJsb2NrWmlwNjRFbmRPZkNlbnRyYWxMb2NhdG9yKCksIXRoaXMuaXNTaWduYXR1cmUodGhpcy5yZWxhdGl2ZU9mZnNldEVuZE9mWmlwNjRDZW50cmFsRGlyLHMuWklQNjRfQ0VOVFJBTF9ESVJFQ1RPUllfRU5EKSYmKHRoaXMucmVsYXRpdmVPZmZzZXRFbmRPZlppcDY0Q2VudHJhbERpcj10aGlzLnJlYWRlci5sYXN0SW5kZXhPZlNpZ25hdHVyZShzLlpJUDY0X0NFTlRSQUxfRElSRUNUT1JZX0VORCksdGhpcy5yZWxhdGl2ZU9mZnNldEVuZE9mWmlwNjRDZW50cmFsRGlyPDApKXRocm93IG5ldyBFcnJvcigiQ29ycnVwdGVkIHppcDogY2FuJ3QgZmluZCB0aGUgWklQNjQgZW5kIG9mIGNlbnRyYWwgZGlyZWN0b3J5Iik7dGhpcy5yZWFkZXIuc2V0SW5kZXgodGhpcy5yZWxhdGl2ZU9mZnNldEVuZE9mWmlwNjRDZW50cmFsRGlyKSx0aGlzLmNoZWNrU2lnbmF0dXJlKHMuWklQNjRfQ0VOVFJBTF9ESVJFQ1RPUllfRU5EKSx0aGlzLnJlYWRCbG9ja1ppcDY0RW5kT2ZDZW50cmFsKCl9dmFyIHI9dGhpcy5jZW50cmFsRGlyT2Zmc2V0K3RoaXMuY2VudHJhbERpclNpemU7dGhpcy56aXA2NCYmKHIrPTIwLHIrPTEyK3RoaXMuemlwNjRFbmRPZkNlbnRyYWxTaXplKTt2YXIgaT1lLXI7aWYoMDxpKXRoaXMuaXNTaWduYXR1cmUoZSxzLkNFTlRSQUxfRklMRV9IRUFERVIpfHwodGhpcy5yZWFkZXIuemVybz1pKTtlbHNlIGlmKGk8MCl0aHJvdyBuZXcgRXJyb3IoIkNvcnJ1cHRlZCB6aXA6IG1pc3NpbmcgIitNYXRoLmFicyhpKSsiIGJ5dGVzLiIpfSxwcmVwYXJlUmVhZGVyOmZ1bmN0aW9uKHQpe3RoaXMucmVhZGVyPWkodCl9LGxvYWQ6ZnVuY3Rpb24odCl7dGhpcy5wcmVwYXJlUmVhZGVyKHQpLHRoaXMucmVhZEVuZE9mQ2VudHJhbCgpLHRoaXMucmVhZENlbnRyYWxEaXIoKSx0aGlzLnJlYWRMb2NhbEZpbGVzKCl9fSxlLmV4cG9ydHM9aH0seyIuL3JlYWRlci9yZWFkZXJGb3IiOjIyLCIuL3NpZ25hdHVyZSI6MjMsIi4vc3VwcG9ydCI6MzAsIi4vdXRmOCI6MzEsIi4vdXRpbHMiOjMyLCIuL3ppcEVudHJ5IjozNH1dLDM0OltmdW5jdGlvbih0LGUscil7InVzZSBzdHJpY3QiO3ZhciBpPXQoIi4vcmVhZGVyL3JlYWRlckZvciIpLHM9dCgiLi91dGlscyIpLG49dCgiLi9jb21wcmVzc2VkT2JqZWN0IiksYT10KCIuL2NyYzMyIiksbz10KCIuL3V0ZjgiKSxoPXQoIi4vY29tcHJlc3Npb25zIiksdT10KCIuL3N1cHBvcnQiKTtmdW5jdGlvbiBsKHQsZSl7dGhpcy5vcHRpb25zPXQsdGhpcy5sb2FkT3B0aW9ucz1lfWwucHJvdG90eXBlPXtpc0VuY3J5cHRlZDpmdW5jdGlvbigpe3JldHVybiAxPT0oMSZ0aGlzLmJpdEZsYWcpfSx1c2VVVEY4OmZ1bmN0aW9uKCl7cmV0dXJuIDIwNDg9PSgyMDQ4JnRoaXMuYml0RmxhZyl9LHJlYWRMb2NhbFBhcnQ6ZnVuY3Rpb24odCl7dmFyIGUscjtpZih0LnNraXAoMjIpLHRoaXMuZmlsZU5hbWVMZW5ndGg9dC5yZWFkSW50KDIpLHI9dC5yZWFkSW50KDIpLHRoaXMuZmlsZU5hbWU9dC5yZWFkRGF0YSh0aGlzLmZpbGVOYW1lTGVuZ3RoKSx0LnNraXAociksLTE9PT10aGlzLmNvbXByZXNzZWRTaXplfHwtMT09PXRoaXMudW5jb21wcmVzc2VkU2l6ZSl0aHJvdyBuZXcgRXJyb3IoIkJ1ZyBvciBjb3JydXB0ZWQgemlwIDogZGlkbid0IGdldCBlbm91Z2ggaW5mb3JtYXRpb24gZnJvbSB0aGUgY2VudHJhbCBkaXJlY3RvcnkgKGNvbXByZXNzZWRTaXplID09PSAtMSB8fCB1bmNvbXByZXNzZWRTaXplID09PSAtMSkiKTtpZihudWxsPT09KGU9ZnVuY3Rpb24odCl7Zm9yKHZhciBlIGluIGgpaWYoaC5oYXNPd25Qcm9wZXJ0eShlKSYmaFtlXS5tYWdpYz09PXQpcmV0dXJuIGhbZV07cmV0dXJuIG51bGx9KHRoaXMuY29tcHJlc3Npb25NZXRob2QpKSl0aHJvdyBuZXcgRXJyb3IoIkNvcnJ1cHRlZCB6aXAgOiBjb21wcmVzc2lvbiAiK3MucHJldHR5KHRoaXMuY29tcHJlc3Npb25NZXRob2QpKyIgdW5rbm93biAoaW5uZXIgZmlsZSA6ICIrcy50cmFuc2Zvcm1Ubygic3RyaW5nIix0aGlzLmZpbGVOYW1lKSsiKSIpO3RoaXMuZGVjb21wcmVzc2VkPW5ldyBuKHRoaXMuY29tcHJlc3NlZFNpemUsdGhpcy51bmNvbXByZXNzZWRTaXplLHRoaXMuY3JjMzIsZSx0LnJlYWREYXRhKHRoaXMuY29tcHJlc3NlZFNpemUpKX0scmVhZENlbnRyYWxQYXJ0OmZ1bmN0aW9uKHQpe3RoaXMudmVyc2lvbk1hZGVCeT10LnJlYWRJbnQoMiksdC5za2lwKDIpLHRoaXMuYml0RmxhZz10LnJlYWRJbnQoMiksdGhpcy5jb21wcmVzc2lvbk1ldGhvZD10LnJlYWRTdHJpbmcoMiksdGhpcy5kYXRlPXQucmVhZERhdGUoKSx0aGlzLmNyYzMyPXQucmVhZEludCg0KSx0aGlzLmNvbXByZXNzZWRTaXplPXQucmVhZEludCg0KSx0aGlzLnVuY29tcHJlc3NlZFNpemU9dC5yZWFkSW50KDQpO3ZhciBlPXQucmVhZEludCgyKTtpZih0aGlzLmV4dHJhRmllbGRzTGVuZ3RoPXQucmVhZEludCgyKSx0aGlzLmZpbGVDb21tZW50TGVuZ3RoPXQucmVhZEludCgyKSx0aGlzLmRpc2tOdW1iZXJTdGFydD10LnJlYWRJbnQoMiksdGhpcy5pbnRlcm5hbEZpbGVBdHRyaWJ1dGVzPXQucmVhZEludCgyKSx0aGlzLmV4dGVybmFsRmlsZUF0dHJpYnV0ZXM9dC5yZWFkSW50KDQpLHRoaXMubG9jYWxIZWFkZXJPZmZzZXQ9dC5yZWFkSW50KDQpLHRoaXMuaXNFbmNyeXB0ZWQoKSl0aHJvdyBuZXcgRXJyb3IoIkVuY3J5cHRlZCB6aXAgYXJlIG5vdCBzdXBwb3J0ZWQiKTt0LnNraXAoZSksdGhpcy5yZWFkRXh0cmFGaWVsZHModCksdGhpcy5wYXJzZVpJUDY0RXh0cmFGaWVsZCh0KSx0aGlzLmZpbGVDb21tZW50PXQucmVhZERhdGEodGhpcy5maWxlQ29tbWVudExlbmd0aCl9LHByb2Nlc3NBdHRyaWJ1dGVzOmZ1bmN0aW9uKCl7dGhpcy51bml4UGVybWlzc2lvbnM9bnVsbCx0aGlzLmRvc1Blcm1pc3Npb25zPW51bGw7dmFyIHQ9dGhpcy52ZXJzaW9uTWFkZUJ5Pj44O3RoaXMuZGlyPSEhKDE2JnRoaXMuZXh0ZXJuYWxGaWxlQXR0cmlidXRlcyksMD09dCYmKHRoaXMuZG9zUGVybWlzc2lvbnM9NjMmdGhpcy5leHRlcm5hbEZpbGVBdHRyaWJ1dGVzKSwzPT10JiYodGhpcy51bml4UGVybWlzc2lvbnM9dGhpcy5leHRlcm5hbEZpbGVBdHRyaWJ1dGVzPj4xNiY2NTUzNSksdGhpcy5kaXJ8fCIvIiE9PXRoaXMuZmlsZU5hbWVTdHIuc2xpY2UoLTEpfHwodGhpcy5kaXI9ITApfSxwYXJzZVpJUDY0RXh0cmFGaWVsZDpmdW5jdGlvbih0KXtpZih0aGlzLmV4dHJhRmllbGRzWzFdKXt2YXIgZT1pKHRoaXMuZXh0cmFGaWVsZHNbMV0udmFsdWUpO3RoaXMudW5jb21wcmVzc2VkU2l6ZT09PXMuTUFYX1ZBTFVFXzMyQklUUyYmKHRoaXMudW5jb21wcmVzc2VkU2l6ZT1lLnJlYWRJbnQoOCkpLHRoaXMuY29tcHJlc3NlZFNpemU9PT1zLk1BWF9WQUxVRV8zMkJJVFMmJih0aGlzLmNvbXByZXNzZWRTaXplPWUucmVhZEludCg4KSksdGhpcy5sb2NhbEhlYWRlck9mZnNldD09PXMuTUFYX1ZBTFVFXzMyQklUUyYmKHRoaXMubG9jYWxIZWFkZXJPZmZzZXQ9ZS5yZWFkSW50KDgpKSx0aGlzLmRpc2tOdW1iZXJTdGFydD09PXMuTUFYX1ZBTFVFXzMyQklUUyYmKHRoaXMuZGlza051bWJlclN0YXJ0PWUucmVhZEludCg0KSl9fSxyZWFkRXh0cmFGaWVsZHM6ZnVuY3Rpb24odCl7dmFyIGUscixpLG49dC5pbmRleCt0aGlzLmV4dHJhRmllbGRzTGVuZ3RoO2Zvcih0aGlzLmV4dHJhRmllbGRzfHwodGhpcy5leHRyYUZpZWxkcz17fSk7dC5pbmRleCs0PG47KWU9dC5yZWFkSW50KDIpLHI9dC5yZWFkSW50KDIpLGk9dC5yZWFkRGF0YShyKSx0aGlzLmV4dHJhRmllbGRzW2VdPXtpZDplLGxlbmd0aDpyLHZhbHVlOml9O3Quc2V0SW5kZXgobil9LGhhbmRsZVVURjg6ZnVuY3Rpb24oKXt2YXIgdD11LnVpbnQ4YXJyYXk/InVpbnQ4YXJyYXkiOiJhcnJheSI7aWYodGhpcy51c2VVVEY4KCkpdGhpcy5maWxlTmFtZVN0cj1vLnV0ZjhkZWNvZGUodGhpcy5maWxlTmFtZSksdGhpcy5maWxlQ29tbWVudFN0cj1vLnV0ZjhkZWNvZGUodGhpcy5maWxlQ29tbWVudCk7ZWxzZXt2YXIgZT10aGlzLmZpbmRFeHRyYUZpZWxkVW5pY29kZVBhdGgoKTtpZihudWxsIT09ZSl0aGlzLmZpbGVOYW1lU3RyPWU7ZWxzZXt2YXIgcj1zLnRyYW5zZm9ybVRvKHQsdGhpcy5maWxlTmFtZSk7dGhpcy5maWxlTmFtZVN0cj10aGlzLmxvYWRPcHRpb25zLmRlY29kZUZpbGVOYW1lKHIpfXZhciBpPXRoaXMuZmluZEV4dHJhRmllbGRVbmljb2RlQ29tbWVudCgpO2lmKG51bGwhPT1pKXRoaXMuZmlsZUNvbW1lbnRTdHI9aTtlbHNle3ZhciBuPXMudHJhbnNmb3JtVG8odCx0aGlzLmZpbGVDb21tZW50KTt0aGlzLmZpbGVDb21tZW50U3RyPXRoaXMubG9hZE9wdGlvbnMuZGVjb2RlRmlsZU5hbWUobil9fX0sZmluZEV4dHJhRmllbGRVbmljb2RlUGF0aDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZXh0cmFGaWVsZHNbMjg3ODldO2lmKHQpe3ZhciBlPWkodC52YWx1ZSk7cmV0dXJuIDEhPT1lLnJlYWRJbnQoMSk/bnVsbDphKHRoaXMuZmlsZU5hbWUpIT09ZS5yZWFkSW50KDQpP251bGw6by51dGY4ZGVjb2RlKGUucmVhZERhdGEodC5sZW5ndGgtNSkpfXJldHVybiBudWxsfSxmaW5kRXh0cmFGaWVsZFVuaWNvZGVDb21tZW50OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5leHRyYUZpZWxkc1syNTQ2MV07aWYodCl7dmFyIGU9aSh0LnZhbHVlKTtyZXR1cm4gMSE9PWUucmVhZEludCgxKT9udWxsOmEodGhpcy5maWxlQ29tbWVudCkhPT1lLnJlYWRJbnQoNCk/bnVsbDpvLnV0ZjhkZWNvZGUoZS5yZWFkRGF0YSh0Lmxlbmd0aC01KSl9cmV0dXJuIG51bGx9fSxlLmV4cG9ydHM9bH0seyIuL2NvbXByZXNzZWRPYmplY3QiOjIsIi4vY29tcHJlc3Npb25zIjozLCIuL2NyYzMyIjo0LCIuL3JlYWRlci9yZWFkZXJGb3IiOjIyLCIuL3N1cHBvcnQiOjMwLCIuL3V0ZjgiOjMxLCIuL3V0aWxzIjozMn1dLDM1OltmdW5jdGlvbih0LGUscil7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGkodCxlLHIpe3RoaXMubmFtZT10LHRoaXMuZGlyPXIuZGlyLHRoaXMuZGF0ZT1yLmRhdGUsdGhpcy5jb21tZW50PXIuY29tbWVudCx0aGlzLnVuaXhQZXJtaXNzaW9ucz1yLnVuaXhQZXJtaXNzaW9ucyx0aGlzLmRvc1Blcm1pc3Npb25zPXIuZG9zUGVybWlzc2lvbnMsdGhpcy5fZGF0YT1lLHRoaXMuX2RhdGFCaW5hcnk9ci5iaW5hcnksdGhpcy5vcHRpb25zPXtjb21wcmVzc2lvbjpyLmNvbXByZXNzaW9uLGNvbXByZXNzaW9uT3B0aW9uczpyLmNvbXByZXNzaW9uT3B0aW9uc319dmFyIHM9dCgiLi9zdHJlYW0vU3RyZWFtSGVscGVyIiksbj10KCIuL3N0cmVhbS9EYXRhV29ya2VyIiksYT10KCIuL3V0ZjgiKSxvPXQoIi4vY29tcHJlc3NlZE9iamVjdCIpLGg9dCgiLi9zdHJlYW0vR2VuZXJpY1dvcmtlciIpO2kucHJvdG90eXBlPXtpbnRlcm5hbFN0cmVhbTpmdW5jdGlvbih0KXt2YXIgZT1udWxsLHI9InN0cmluZyI7dHJ5e2lmKCF0KXRocm93IG5ldyBFcnJvcigiTm8gb3V0cHV0IHR5cGUgc3BlY2lmaWVkLiIpO3ZhciBpPSJzdHJpbmciPT09KHI9dC50b0xvd2VyQ2FzZSgpKXx8InRleHQiPT09cjsiYmluYXJ5c3RyaW5nIiE9PXImJiJ0ZXh0IiE9PXJ8fChyPSJzdHJpbmciKSxlPXRoaXMuX2RlY29tcHJlc3NXb3JrZXIoKTt2YXIgbj0hdGhpcy5fZGF0YUJpbmFyeTtuJiYhaSYmKGU9ZS5waXBlKG5ldyBhLlV0ZjhFbmNvZGVXb3JrZXIpKSwhbiYmaSYmKGU9ZS5waXBlKG5ldyBhLlV0ZjhEZWNvZGVXb3JrZXIpKX1jYXRjaCh0KXsoZT1uZXcgaCgiZXJyb3IiKSkuZXJyb3IodCl9cmV0dXJuIG5ldyBzKGUsciwiIil9LGFzeW5jOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuaW50ZXJuYWxTdHJlYW0odCkuYWNjdW11bGF0ZShlKX0sbm9kZVN0cmVhbTpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLmludGVybmFsU3RyZWFtKHR8fCJub2RlYnVmZmVyIikudG9Ob2RlanNTdHJlYW0oZSl9LF9jb21wcmVzc1dvcmtlcjpmdW5jdGlvbih0LGUpe2lmKHRoaXMuX2RhdGEgaW5zdGFuY2VvZiBvJiZ0aGlzLl9kYXRhLmNvbXByZXNzaW9uLm1hZ2ljPT09dC5tYWdpYylyZXR1cm4gdGhpcy5fZGF0YS5nZXRDb21wcmVzc2VkV29ya2VyKCk7dmFyIHI9dGhpcy5fZGVjb21wcmVzc1dvcmtlcigpO3JldHVybiB0aGlzLl9kYXRhQmluYXJ5fHwocj1yLnBpcGUobmV3IGEuVXRmOEVuY29kZVdvcmtlcikpLG8uY3JlYXRlV29ya2VyRnJvbShyLHQsZSl9LF9kZWNvbXByZXNzV29ya2VyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2RhdGEgaW5zdGFuY2VvZiBvP3RoaXMuX2RhdGEuZ2V0Q29udGVudFdvcmtlcigpOnRoaXMuX2RhdGEgaW5zdGFuY2VvZiBoP3RoaXMuX2RhdGE6bmV3IG4odGhpcy5fZGF0YSl9fTtmb3IodmFyIHU9WyJhc1RleHQiLCJhc0JpbmFyeSIsImFzTm9kZUJ1ZmZlciIsImFzVWludDhBcnJheSIsImFzQXJyYXlCdWZmZXIiXSxsPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IEVycm9yKCJUaGlzIG1ldGhvZCBoYXMgYmVlbiByZW1vdmVkIGluIEpTWmlwIDMuMCwgcGxlYXNlIGNoZWNrIHRoZSB1cGdyYWRlIGd1aWRlLiIpfSxmPTA7Zjx1Lmxlbmd0aDtmKyspaS5wcm90b3R5cGVbdVtmXV09bDtlLmV4cG9ydHM9aX0seyIuL2NvbXByZXNzZWRPYmplY3QiOjIsIi4vc3RyZWFtL0RhdGFXb3JrZXIiOjI3LCIuL3N0cmVhbS9HZW5lcmljV29ya2VyIjoyOCwiLi9zdHJlYW0vU3RyZWFtSGVscGVyIjoyOSwiLi91dGY4IjozMX1dLDM2OltmdW5jdGlvbih0LGwsZSl7KGZ1bmN0aW9uKGUpeyJ1c2Ugc3RyaWN0Ijt2YXIgcixpLHQ9ZS5NdXRhdGlvbk9ic2VydmVyfHxlLldlYktpdE11dGF0aW9uT2JzZXJ2ZXI7aWYodCl7dmFyIG49MCxzPW5ldyB0KHUpLGE9ZS5kb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgiIik7cy5vYnNlcnZlKGEse2NoYXJhY3RlckRhdGE6ITB9KSxyPWZ1bmN0aW9uKCl7YS5kYXRhPW49KytuJTJ9fWVsc2UgaWYoZS5zZXRJbW1lZGlhdGV8fHZvaWQgMD09PWUuTWVzc2FnZUNoYW5uZWwpcj0iZG9jdW1lbnQiaW4gZSYmIm9ucmVhZHlzdGF0ZWNoYW5nZSJpbiBlLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpP2Z1bmN0aW9uKCl7dmFyIHQ9ZS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTt0Lm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpe3UoKSx0Lm9ucmVhZHlzdGF0ZWNoYW5nZT1udWxsLHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0KSx0PW51bGx9LGUuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKHQpfTpmdW5jdGlvbigpe3NldFRpbWVvdXQodSwwKX07ZWxzZXt2YXIgbz1uZXcgZS5NZXNzYWdlQ2hhbm5lbDtvLnBvcnQxLm9ubWVzc2FnZT11LHI9ZnVuY3Rpb24oKXtvLnBvcnQyLnBvc3RNZXNzYWdlKDApfX12YXIgaD1bXTtmdW5jdGlvbiB1KCl7dmFyIHQsZTtpPSEwO2Zvcih2YXIgcj1oLmxlbmd0aDtyOyl7Zm9yKGU9aCxoPVtdLHQ9LTE7Kyt0PHI7KWVbdF0oKTtyPWgubGVuZ3RofWk9ITF9bC5leHBvcnRzPWZ1bmN0aW9uKHQpezEhPT1oLnB1c2godCl8fGl8fHIoKX19KS5jYWxsKHRoaXMsInVuZGVmaW5lZCIhPXR5cGVvZiBnbG9iYWw/Z2xvYmFsOiJ1bmRlZmluZWQiIT10eXBlb2Ygc2VsZj9zZWxmOiJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93P3dpbmRvdzp7fSl9LHt9XSwzNzpbZnVuY3Rpb24odCxlLHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgbj10KCJpbW1lZGlhdGUiKTtmdW5jdGlvbiB1KCl7fXZhciBsPXt9LHM9WyJSRUpFQ1RFRCJdLGE9WyJGVUxGSUxMRUQiXSxpPVsiUEVORElORyJdO2Z1bmN0aW9uIG8odCl7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIHQpdGhyb3cgbmV3IFR5cGVFcnJvcigicmVzb2x2ZXIgbXVzdCBiZSBhIGZ1bmN0aW9uIik7dGhpcy5zdGF0ZT1pLHRoaXMucXVldWU9W10sdGhpcy5vdXRjb21lPXZvaWQgMCx0IT09dSYmYyh0aGlzLHQpfWZ1bmN0aW9uIGgodCxlLHIpe3RoaXMucHJvbWlzZT10LCJmdW5jdGlvbiI9PXR5cGVvZiBlJiYodGhpcy5vbkZ1bGZpbGxlZD1lLHRoaXMuY2FsbEZ1bGZpbGxlZD10aGlzLm90aGVyQ2FsbEZ1bGZpbGxlZCksImZ1bmN0aW9uIj09dHlwZW9mIHImJih0aGlzLm9uUmVqZWN0ZWQ9cix0aGlzLmNhbGxSZWplY3RlZD10aGlzLm90aGVyQ2FsbFJlamVjdGVkKX1mdW5jdGlvbiBmKGUscixpKXtuKGZ1bmN0aW9uKCl7dmFyIHQ7dHJ5e3Q9cihpKX1jYXRjaCh0KXtyZXR1cm4gbC5yZWplY3QoZSx0KX10PT09ZT9sLnJlamVjdChlLG5ldyBUeXBlRXJyb3IoIkNhbm5vdCByZXNvbHZlIHByb21pc2Ugd2l0aCBpdHNlbGYiKSk6bC5yZXNvbHZlKGUsdCl9KX1mdW5jdGlvbiBkKHQpe3ZhciBlPXQmJnQudGhlbjtpZih0JiYoIm9iamVjdCI9PXR5cGVvZiB0fHwiZnVuY3Rpb24iPT10eXBlb2YgdCkmJiJmdW5jdGlvbiI9PXR5cGVvZiBlKXJldHVybiBmdW5jdGlvbigpe2UuYXBwbHkodCxhcmd1bWVudHMpfX1mdW5jdGlvbiBjKGUsdCl7dmFyIHI9ITE7ZnVuY3Rpb24gaSh0KXtyfHwocj0hMCxsLnJlamVjdChlLHQpKX1mdW5jdGlvbiBuKHQpe3J8fChyPSEwLGwucmVzb2x2ZShlLHQpKX12YXIgcz1wKGZ1bmN0aW9uKCl7dChuLGkpfSk7ImVycm9yIj09PXMuc3RhdHVzJiZpKHMudmFsdWUpfWZ1bmN0aW9uIHAodCxlKXt2YXIgcj17fTt0cnl7ci52YWx1ZT10KGUpLHIuc3RhdHVzPSJzdWNjZXNzIn1jYXRjaCh0KXtyLnN0YXR1cz0iZXJyb3IiLHIudmFsdWU9dH1yZXR1cm4gcn0oZS5leHBvcnRzPW8pLnByb3RvdHlwZS5maW5hbGx5PWZ1bmN0aW9uKGUpe2lmKCJmdW5jdGlvbiIhPXR5cGVvZiBlKXJldHVybiB0aGlzO3ZhciByPXRoaXMuY29uc3RydWN0b3I7cmV0dXJuIHRoaXMudGhlbihmdW5jdGlvbih0KXtyZXR1cm4gci5yZXNvbHZlKGUoKSkudGhlbihmdW5jdGlvbigpe3JldHVybiB0fSl9LGZ1bmN0aW9uKHQpe3JldHVybiByLnJlc29sdmUoZSgpKS50aGVuKGZ1bmN0aW9uKCl7dGhyb3cgdH0pfSl9LG8ucHJvdG90eXBlLmNhdGNoPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnRoZW4obnVsbCx0KX0sby5wcm90b3R5cGUudGhlbj1mdW5jdGlvbih0LGUpe2lmKCJmdW5jdGlvbiIhPXR5cGVvZiB0JiZ0aGlzLnN0YXRlPT09YXx8ImZ1bmN0aW9uIiE9dHlwZW9mIGUmJnRoaXMuc3RhdGU9PT1zKXJldHVybiB0aGlzO3ZhciByPW5ldyB0aGlzLmNvbnN0cnVjdG9yKHUpO3RoaXMuc3RhdGUhPT1pP2Yocix0aGlzLnN0YXRlPT09YT90OmUsdGhpcy5vdXRjb21lKTp0aGlzLnF1ZXVlLnB1c2gobmV3IGgocix0LGUpKTtyZXR1cm4gcn0saC5wcm90b3R5cGUuY2FsbEZ1bGZpbGxlZD1mdW5jdGlvbih0KXtsLnJlc29sdmUodGhpcy5wcm9taXNlLHQpfSxoLnByb3RvdHlwZS5vdGhlckNhbGxGdWxmaWxsZWQ9ZnVuY3Rpb24odCl7Zih0aGlzLnByb21pc2UsdGhpcy5vbkZ1bGZpbGxlZCx0KX0saC5wcm90b3R5cGUuY2FsbFJlamVjdGVkPWZ1bmN0aW9uKHQpe2wucmVqZWN0KHRoaXMucHJvbWlzZSx0KX0saC5wcm90b3R5cGUub3RoZXJDYWxsUmVqZWN0ZWQ9ZnVuY3Rpb24odCl7Zih0aGlzLnByb21pc2UsdGhpcy5vblJlamVjdGVkLHQpfSxsLnJlc29sdmU9ZnVuY3Rpb24odCxlKXt2YXIgcj1wKGQsZSk7aWYoImVycm9yIj09PXIuc3RhdHVzKXJldHVybiBsLnJlamVjdCh0LHIudmFsdWUpO3ZhciBpPXIudmFsdWU7aWYoaSljKHQsaSk7ZWxzZXt0LnN0YXRlPWEsdC5vdXRjb21lPWU7Zm9yKHZhciBuPS0xLHM9dC5xdWV1ZS5sZW5ndGg7KytuPHM7KXQucXVldWVbbl0uY2FsbEZ1bGZpbGxlZChlKX1yZXR1cm4gdH0sbC5yZWplY3Q9ZnVuY3Rpb24odCxlKXt0LnN0YXRlPXMsdC5vdXRjb21lPWU7Zm9yKHZhciByPS0xLGk9dC5xdWV1ZS5sZW5ndGg7KytyPGk7KXQucXVldWVbcl0uY2FsbFJlamVjdGVkKGUpO3JldHVybiB0fSxvLnJlc29sdmU9ZnVuY3Rpb24odCl7aWYodCBpbnN0YW5jZW9mIHRoaXMpcmV0dXJuIHQ7cmV0dXJuIGwucmVzb2x2ZShuZXcgdGhpcyh1KSx0KX0sby5yZWplY3Q9ZnVuY3Rpb24odCl7dmFyIGU9bmV3IHRoaXModSk7cmV0dXJuIGwucmVqZWN0KGUsdCl9LG8uYWxsPWZ1bmN0aW9uKHQpe3ZhciByPXRoaXM7aWYoIltvYmplY3QgQXJyYXldIiE9PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KSlyZXR1cm4gdGhpcy5yZWplY3QobmV3IFR5cGVFcnJvcigibXVzdCBiZSBhbiBhcnJheSIpKTt2YXIgaT10Lmxlbmd0aCxuPSExO2lmKCFpKXJldHVybiB0aGlzLnJlc29sdmUoW10pO3ZhciBzPW5ldyBBcnJheShpKSxhPTAsZT0tMSxvPW5ldyB0aGlzKHUpO2Zvcig7KytlPGk7KWgodFtlXSxlKTtyZXR1cm4gbztmdW5jdGlvbiBoKHQsZSl7ci5yZXNvbHZlKHQpLnRoZW4oZnVuY3Rpb24odCl7c1tlXT10LCsrYSE9PWl8fG58fChuPSEwLGwucmVzb2x2ZShvLHMpKX0sZnVuY3Rpb24odCl7bnx8KG49ITAsbC5yZWplY3Qobyx0KSl9KX19LG8ucmFjZT1mdW5jdGlvbih0KXt2YXIgZT10aGlzO2lmKCJbb2JqZWN0IEFycmF5XSIhPT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCkpcmV0dXJuIHRoaXMucmVqZWN0KG5ldyBUeXBlRXJyb3IoIm11c3QgYmUgYW4gYXJyYXkiKSk7dmFyIHI9dC5sZW5ndGgsaT0hMTtpZighcilyZXR1cm4gdGhpcy5yZXNvbHZlKFtdKTt2YXIgbj0tMSxzPW5ldyB0aGlzKHUpO2Zvcig7KytuPHI7KWE9dFtuXSxlLnJlc29sdmUoYSkudGhlbihmdW5jdGlvbih0KXtpfHwoaT0hMCxsLnJlc29sdmUocyx0KSl9LGZ1bmN0aW9uKHQpe2l8fChpPSEwLGwucmVqZWN0KHMsdCkpfSk7dmFyIGE7cmV0dXJuIHN9fSx7aW1tZWRpYXRlOjM2fV0sMzg6W2Z1bmN0aW9uKHQsZSxyKXsidXNlIHN0cmljdCI7dmFyIGk9e307KDAsdCgiLi9saWIvdXRpbHMvY29tbW9uIikuYXNzaWduKShpLHQoIi4vbGliL2RlZmxhdGUiKSx0KCIuL2xpYi9pbmZsYXRlIiksdCgiLi9saWIvemxpYi9jb25zdGFudHMiKSksZS5leHBvcnRzPWl9LHsiLi9saWIvZGVmbGF0ZSI6MzksIi4vbGliL2luZmxhdGUiOjQwLCIuL2xpYi91dGlscy9jb21tb24iOjQxLCIuL2xpYi96bGliL2NvbnN0YW50cyI6NDR9XSwzOTpbZnVuY3Rpb24odCxlLHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgYT10KCIuL3psaWIvZGVmbGF0ZSIpLG89dCgiLi91dGlscy9jb21tb24iKSxoPXQoIi4vdXRpbHMvc3RyaW5ncyIpLG49dCgiLi96bGliL21lc3NhZ2VzIikscz10KCIuL3psaWIvenN0cmVhbSIpLHU9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyxsPTAsZj0tMSxkPTAsYz04O2Z1bmN0aW9uIHAodCl7aWYoISh0aGlzIGluc3RhbmNlb2YgcCkpcmV0dXJuIG5ldyBwKHQpO3RoaXMub3B0aW9ucz1vLmFzc2lnbih7bGV2ZWw6ZixtZXRob2Q6YyxjaHVua1NpemU6MTYzODQsd2luZG93Qml0czoxNSxtZW1MZXZlbDo4LHN0cmF0ZWd5OmQsdG86IiJ9LHR8fHt9KTt2YXIgZT10aGlzLm9wdGlvbnM7ZS5yYXcmJjA8ZS53aW5kb3dCaXRzP2Uud2luZG93Qml0cz0tZS53aW5kb3dCaXRzOmUuZ3ppcCYmMDxlLndpbmRvd0JpdHMmJmUud2luZG93Qml0czwxNiYmKGUud2luZG93Qml0cys9MTYpLHRoaXMuZXJyPTAsdGhpcy5tc2c9IiIsdGhpcy5lbmRlZD0hMSx0aGlzLmNodW5rcz1bXSx0aGlzLnN0cm09bmV3IHMsdGhpcy5zdHJtLmF2YWlsX291dD0wO3ZhciByPWEuZGVmbGF0ZUluaXQyKHRoaXMuc3RybSxlLmxldmVsLGUubWV0aG9kLGUud2luZG93Qml0cyxlLm1lbUxldmVsLGUuc3RyYXRlZ3kpO2lmKHIhPT1sKXRocm93IG5ldyBFcnJvcihuW3JdKTtpZihlLmhlYWRlciYmYS5kZWZsYXRlU2V0SGVhZGVyKHRoaXMuc3RybSxlLmhlYWRlciksZS5kaWN0aW9uYXJ5KXt2YXIgaTtpZihpPSJzdHJpbmciPT10eXBlb2YgZS5kaWN0aW9uYXJ5P2guc3RyaW5nMmJ1ZihlLmRpY3Rpb25hcnkpOiJbb2JqZWN0IEFycmF5QnVmZmVyXSI9PT11LmNhbGwoZS5kaWN0aW9uYXJ5KT9uZXcgVWludDhBcnJheShlLmRpY3Rpb25hcnkpOmUuZGljdGlvbmFyeSwocj1hLmRlZmxhdGVTZXREaWN0aW9uYXJ5KHRoaXMuc3RybSxpKSkhPT1sKXRocm93IG5ldyBFcnJvcihuW3JdKTt0aGlzLl9kaWN0X3NldD0hMH19ZnVuY3Rpb24gaSh0LGUpe3ZhciByPW5ldyBwKGUpO2lmKHIucHVzaCh0LCEwKSxyLmVycil0aHJvdyByLm1zZ3x8bltyLmVycl07cmV0dXJuIHIucmVzdWx0fXAucHJvdG90eXBlLnB1c2g9ZnVuY3Rpb24odCxlKXt2YXIgcixpLG49dGhpcy5zdHJtLHM9dGhpcy5vcHRpb25zLmNodW5rU2l6ZTtpZih0aGlzLmVuZGVkKXJldHVybiExO2k9ZT09PX5+ZT9lOiEwPT09ZT80OjAsInN0cmluZyI9PXR5cGVvZiB0P24uaW5wdXQ9aC5zdHJpbmcyYnVmKHQpOiJbb2JqZWN0IEFycmF5QnVmZmVyXSI9PT11LmNhbGwodCk/bi5pbnB1dD1uZXcgVWludDhBcnJheSh0KTpuLmlucHV0PXQsbi5uZXh0X2luPTAsbi5hdmFpbF9pbj1uLmlucHV0Lmxlbmd0aDtkb3tpZigwPT09bi5hdmFpbF9vdXQmJihuLm91dHB1dD1uZXcgby5CdWY4KHMpLG4ubmV4dF9vdXQ9MCxuLmF2YWlsX291dD1zKSwxIT09KHI9YS5kZWZsYXRlKG4saSkpJiZyIT09bClyZXR1cm4gdGhpcy5vbkVuZChyKSwhKHRoaXMuZW5kZWQ9ITApOzAhPT1uLmF2YWlsX291dCYmKDAhPT1uLmF2YWlsX2lufHw0IT09aSYmMiE9PWkpfHwoInN0cmluZyI9PT10aGlzLm9wdGlvbnMudG8/dGhpcy5vbkRhdGEoaC5idWYyYmluc3RyaW5nKG8uc2hyaW5rQnVmKG4ub3V0cHV0LG4ubmV4dF9vdXQpKSk6dGhpcy5vbkRhdGEoby5zaHJpbmtCdWYobi5vdXRwdXQsbi5uZXh0X291dCkpKX13aGlsZSgoMDxuLmF2YWlsX2lufHwwPT09bi5hdmFpbF9vdXQpJiYxIT09cik7cmV0dXJuIDQ9PT1pPyhyPWEuZGVmbGF0ZUVuZCh0aGlzLnN0cm0pLHRoaXMub25FbmQociksdGhpcy5lbmRlZD0hMCxyPT09bCk6MiE9PWl8fCh0aGlzLm9uRW5kKGwpLCEobi5hdmFpbF9vdXQ9MCkpfSxwLnByb3RvdHlwZS5vbkRhdGE9ZnVuY3Rpb24odCl7dGhpcy5jaHVua3MucHVzaCh0KX0scC5wcm90b3R5cGUub25FbmQ9ZnVuY3Rpb24odCl7dD09PWwmJigic3RyaW5nIj09PXRoaXMub3B0aW9ucy50bz90aGlzLnJlc3VsdD10aGlzLmNodW5rcy5qb2luKCIiKTp0aGlzLnJlc3VsdD1vLmZsYXR0ZW5DaHVua3ModGhpcy5jaHVua3MpKSx0aGlzLmNodW5rcz1bXSx0aGlzLmVycj10LHRoaXMubXNnPXRoaXMuc3RybS5tc2d9LHIuRGVmbGF0ZT1wLHIuZGVmbGF0ZT1pLHIuZGVmbGF0ZVJhdz1mdW5jdGlvbih0LGUpe3JldHVybihlPWV8fHt9KS5yYXc9ITAsaSh0LGUpfSxyLmd6aXA9ZnVuY3Rpb24odCxlKXtyZXR1cm4oZT1lfHx7fSkuZ3ppcD0hMCxpKHQsZSl9fSx7Ii4vdXRpbHMvY29tbW9uIjo0MSwiLi91dGlscy9zdHJpbmdzIjo0MiwiLi96bGliL2RlZmxhdGUiOjQ2LCIuL3psaWIvbWVzc2FnZXMiOjUxLCIuL3psaWIvenN0cmVhbSI6NTN9XSw0MDpbZnVuY3Rpb24odCxlLHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgZD10KCIuL3psaWIvaW5mbGF0ZSIpLGM9dCgiLi91dGlscy9jb21tb24iKSxwPXQoIi4vdXRpbHMvc3RyaW5ncyIpLG09dCgiLi96bGliL2NvbnN0YW50cyIpLGk9dCgiLi96bGliL21lc3NhZ2VzIiksbj10KCIuL3psaWIvenN0cmVhbSIpLHM9dCgiLi96bGliL2d6aGVhZGVyIiksXz1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO2Z1bmN0aW9uIGEodCl7aWYoISh0aGlzIGluc3RhbmNlb2YgYSkpcmV0dXJuIG5ldyBhKHQpO3RoaXMub3B0aW9ucz1jLmFzc2lnbih7Y2h1bmtTaXplOjE2Mzg0LHdpbmRvd0JpdHM6MCx0bzoiIn0sdHx8e30pO3ZhciBlPXRoaXMub3B0aW9ucztlLnJhdyYmMDw9ZS53aW5kb3dCaXRzJiZlLndpbmRvd0JpdHM8MTYmJihlLndpbmRvd0JpdHM9LWUud2luZG93Qml0cywwPT09ZS53aW5kb3dCaXRzJiYoZS53aW5kb3dCaXRzPS0xNSkpLCEoMDw9ZS53aW5kb3dCaXRzJiZlLndpbmRvd0JpdHM8MTYpfHx0JiZ0LndpbmRvd0JpdHN8fChlLndpbmRvd0JpdHMrPTMyKSwxNTxlLndpbmRvd0JpdHMmJmUud2luZG93Qml0czw0OCYmMD09KDE1JmUud2luZG93Qml0cykmJihlLndpbmRvd0JpdHN8PTE1KSx0aGlzLmVycj0wLHRoaXMubXNnPSIiLHRoaXMuZW5kZWQ9ITEsdGhpcy5jaHVua3M9W10sdGhpcy5zdHJtPW5ldyBuLHRoaXMuc3RybS5hdmFpbF9vdXQ9MDt2YXIgcj1kLmluZmxhdGVJbml0Mih0aGlzLnN0cm0sZS53aW5kb3dCaXRzKTtpZihyIT09bS5aX09LKXRocm93IG5ldyBFcnJvcihpW3JdKTt0aGlzLmhlYWRlcj1uZXcgcyxkLmluZmxhdGVHZXRIZWFkZXIodGhpcy5zdHJtLHRoaXMuaGVhZGVyKX1mdW5jdGlvbiBvKHQsZSl7dmFyIHI9bmV3IGEoZSk7aWYoci5wdXNoKHQsITApLHIuZXJyKXRocm93IHIubXNnfHxpW3IuZXJyXTtyZXR1cm4gci5yZXN1bHR9YS5wcm90b3R5cGUucHVzaD1mdW5jdGlvbih0LGUpe3ZhciByLGksbixzLGEsbyxoPXRoaXMuc3RybSx1PXRoaXMub3B0aW9ucy5jaHVua1NpemUsbD10aGlzLm9wdGlvbnMuZGljdGlvbmFyeSxmPSExO2lmKHRoaXMuZW5kZWQpcmV0dXJuITE7aT1lPT09fn5lP2U6ITA9PT1lP20uWl9GSU5JU0g6bS5aX05PX0ZMVVNILCJzdHJpbmciPT10eXBlb2YgdD9oLmlucHV0PXAuYmluc3RyaW5nMmJ1Zih0KToiW29iamVjdCBBcnJheUJ1ZmZlcl0iPT09Xy5jYWxsKHQpP2guaW5wdXQ9bmV3IFVpbnQ4QXJyYXkodCk6aC5pbnB1dD10LGgubmV4dF9pbj0wLGguYXZhaWxfaW49aC5pbnB1dC5sZW5ndGg7ZG97aWYoMD09PWguYXZhaWxfb3V0JiYoaC5vdXRwdXQ9bmV3IGMuQnVmOCh1KSxoLm5leHRfb3V0PTAsaC5hdmFpbF9vdXQ9dSksKHI9ZC5pbmZsYXRlKGgsbS5aX05PX0ZMVVNIKSk9PT1tLlpfTkVFRF9ESUNUJiZsJiYobz0ic3RyaW5nIj09dHlwZW9mIGw/cC5zdHJpbmcyYnVmKGwpOiJbb2JqZWN0IEFycmF5QnVmZmVyXSI9PT1fLmNhbGwobCk/bmV3IFVpbnQ4QXJyYXkobCk6bCxyPWQuaW5mbGF0ZVNldERpY3Rpb25hcnkodGhpcy5zdHJtLG8pKSxyPT09bS5aX0JVRl9FUlJPUiYmITA9PT1mJiYocj1tLlpfT0ssZj0hMSksciE9PW0uWl9TVFJFQU1fRU5EJiZyIT09bS5aX09LKXJldHVybiB0aGlzLm9uRW5kKHIpLCEodGhpcy5lbmRlZD0hMCk7aC5uZXh0X291dCYmKDAhPT1oLmF2YWlsX291dCYmciE9PW0uWl9TVFJFQU1fRU5EJiYoMCE9PWguYXZhaWxfaW58fGkhPT1tLlpfRklOSVNIJiZpIT09bS5aX1NZTkNfRkxVU0gpfHwoInN0cmluZyI9PT10aGlzLm9wdGlvbnMudG8/KG49cC51dGY4Ym9yZGVyKGgub3V0cHV0LGgubmV4dF9vdXQpLHM9aC5uZXh0X291dC1uLGE9cC5idWYyc3RyaW5nKGgub3V0cHV0LG4pLGgubmV4dF9vdXQ9cyxoLmF2YWlsX291dD11LXMscyYmYy5hcnJheVNldChoLm91dHB1dCxoLm91dHB1dCxuLHMsMCksdGhpcy5vbkRhdGEoYSkpOnRoaXMub25EYXRhKGMuc2hyaW5rQnVmKGgub3V0cHV0LGgubmV4dF9vdXQpKSkpLDA9PT1oLmF2YWlsX2luJiYwPT09aC5hdmFpbF9vdXQmJihmPSEwKX13aGlsZSgoMDxoLmF2YWlsX2lufHwwPT09aC5hdmFpbF9vdXQpJiZyIT09bS5aX1NUUkVBTV9FTkQpO3JldHVybiByPT09bS5aX1NUUkVBTV9FTkQmJihpPW0uWl9GSU5JU0gpLGk9PT1tLlpfRklOSVNIPyhyPWQuaW5mbGF0ZUVuZCh0aGlzLnN0cm0pLHRoaXMub25FbmQociksdGhpcy5lbmRlZD0hMCxyPT09bS5aX09LKTppIT09bS5aX1NZTkNfRkxVU0h8fCh0aGlzLm9uRW5kKG0uWl9PSyksIShoLmF2YWlsX291dD0wKSl9LGEucHJvdG90eXBlLm9uRGF0YT1mdW5jdGlvbih0KXt0aGlzLmNodW5rcy5wdXNoKHQpfSxhLnByb3RvdHlwZS5vbkVuZD1mdW5jdGlvbih0KXt0PT09bS5aX09LJiYoInN0cmluZyI9PT10aGlzLm9wdGlvbnMudG8/dGhpcy5yZXN1bHQ9dGhpcy5jaHVua3Muam9pbigiIik6dGhpcy5yZXN1bHQ9Yy5mbGF0dGVuQ2h1bmtzKHRoaXMuY2h1bmtzKSksdGhpcy5jaHVua3M9W10sdGhpcy5lcnI9dCx0aGlzLm1zZz10aGlzLnN0cm0ubXNnfSxyLkluZmxhdGU9YSxyLmluZmxhdGU9byxyLmluZmxhdGVSYXc9ZnVuY3Rpb24odCxlKXtyZXR1cm4oZT1lfHx7fSkucmF3PSEwLG8odCxlKX0sci51bmd6aXA9b30seyIuL3V0aWxzL2NvbW1vbiI6NDEsIi4vdXRpbHMvc3RyaW5ncyI6NDIsIi4vemxpYi9jb25zdGFudHMiOjQ0LCIuL3psaWIvZ3poZWFkZXIiOjQ3LCIuL3psaWIvaW5mbGF0ZSI6NDksIi4vemxpYi9tZXNzYWdlcyI6NTEsIi4vemxpYi96c3RyZWFtIjo1M31dLDQxOltmdW5jdGlvbih0LGUscil7InVzZSBzdHJpY3QiO3ZhciBpPSJ1bmRlZmluZWQiIT10eXBlb2YgVWludDhBcnJheSYmInVuZGVmaW5lZCIhPXR5cGVvZiBVaW50MTZBcnJheSYmInVuZGVmaW5lZCIhPXR5cGVvZiBJbnQzMkFycmF5O3IuYXNzaWduPWZ1bmN0aW9uKHQpe2Zvcih2YXIgZT1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSk7ZS5sZW5ndGg7KXt2YXIgcj1lLnNoaWZ0KCk7aWYocil7aWYoIm9iamVjdCIhPXR5cGVvZiByKXRocm93IG5ldyBUeXBlRXJyb3IocisibXVzdCBiZSBub24tb2JqZWN0Iik7Zm9yKHZhciBpIGluIHIpci5oYXNPd25Qcm9wZXJ0eShpKSYmKHRbaV09cltpXSl9fXJldHVybiB0fSxyLnNocmlua0J1Zj1mdW5jdGlvbih0LGUpe3JldHVybiB0Lmxlbmd0aD09PWU/dDp0LnN1YmFycmF5P3Quc3ViYXJyYXkoMCxlKToodC5sZW5ndGg9ZSx0KX07dmFyIG49e2FycmF5U2V0OmZ1bmN0aW9uKHQsZSxyLGksbil7aWYoZS5zdWJhcnJheSYmdC5zdWJhcnJheSl0LnNldChlLnN1YmFycmF5KHIscitpKSxuKTtlbHNlIGZvcih2YXIgcz0wO3M8aTtzKyspdFtuK3NdPWVbcitzXX0sZmxhdHRlbkNodW5rczpmdW5jdGlvbih0KXt2YXIgZSxyLGksbixzLGE7Zm9yKGU9aT0wLHI9dC5sZW5ndGg7ZTxyO2UrKylpKz10W2VdLmxlbmd0aDtmb3IoYT1uZXcgVWludDhBcnJheShpKSxlPW49MCxyPXQubGVuZ3RoO2U8cjtlKyspcz10W2VdLGEuc2V0KHMsbiksbis9cy5sZW5ndGg7cmV0dXJuIGF9fSxzPXthcnJheVNldDpmdW5jdGlvbih0LGUscixpLG4pe2Zvcih2YXIgcz0wO3M8aTtzKyspdFtuK3NdPWVbcitzXX0sZmxhdHRlbkNodW5rczpmdW5jdGlvbih0KXtyZXR1cm5bXS5jb25jYXQuYXBwbHkoW10sdCl9fTtyLnNldFR5cGVkPWZ1bmN0aW9uKHQpe3Q/KHIuQnVmOD1VaW50OEFycmF5LHIuQnVmMTY9VWludDE2QXJyYXksci5CdWYzMj1JbnQzMkFycmF5LHIuYXNzaWduKHIsbikpOihyLkJ1Zjg9QXJyYXksci5CdWYxNj1BcnJheSxyLkJ1ZjMyPUFycmF5LHIuYXNzaWduKHIscykpfSxyLnNldFR5cGVkKGkpfSx7fV0sNDI6W2Z1bmN0aW9uKHQsZSxyKXsidXNlIHN0cmljdCI7dmFyIGg9dCgiLi9jb21tb24iKSxuPSEwLHM9ITA7dHJ5e1N0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCxbMF0pfWNhdGNoKHQpe249ITF9dHJ5e1N0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCxuZXcgVWludDhBcnJheSgxKSl9Y2F0Y2godCl7cz0hMX1mb3IodmFyIHU9bmV3IGguQnVmOCgyNTYpLGk9MDtpPDI1NjtpKyspdVtpXT0yNTI8PWk/NjoyNDg8PWk/NToyNDA8PWk/NDoyMjQ8PWk/MzoxOTI8PWk/MjoxO2Z1bmN0aW9uIGwodCxlKXtpZihlPDY1NTM3JiYodC5zdWJhcnJheSYmc3x8IXQuc3ViYXJyYXkmJm4pKXJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsaC5zaHJpbmtCdWYodCxlKSk7Zm9yKHZhciByPSIiLGk9MDtpPGU7aSsrKXIrPVN0cmluZy5mcm9tQ2hhckNvZGUodFtpXSk7cmV0dXJuIHJ9dVsyNTRdPXVbMjU0XT0xLHIuc3RyaW5nMmJ1Zj1mdW5jdGlvbih0KXt2YXIgZSxyLGksbixzLGE9dC5sZW5ndGgsbz0wO2ZvcihuPTA7bjxhO24rKyk1NTI5Nj09KDY0NTEyJihyPXQuY2hhckNvZGVBdChuKSkpJiZuKzE8YSYmNTYzMjA9PSg2NDUxMiYoaT10LmNoYXJDb2RlQXQobisxKSkpJiYocj02NTUzNisoci01NTI5Njw8MTApKyhpLTU2MzIwKSxuKyspLG8rPXI8MTI4PzE6cjwyMDQ4PzI6cjw2NTUzNj8zOjQ7Zm9yKGU9bmV3IGguQnVmOChvKSxuPXM9MDtzPG87bisrKTU1Mjk2PT0oNjQ1MTImKHI9dC5jaGFyQ29kZUF0KG4pKSkmJm4rMTxhJiY1NjMyMD09KDY0NTEyJihpPXQuY2hhckNvZGVBdChuKzEpKSkmJihyPTY1NTM2KyhyLTU1Mjk2PDwxMCkrKGktNTYzMjApLG4rKykscjwxMjg/ZVtzKytdPXI6KHI8MjA0OD9lW3MrK109MTkyfHI+Pj42OihyPDY1NTM2P2VbcysrXT0yMjR8cj4+PjEyOihlW3MrK109MjQwfHI+Pj4xOCxlW3MrK109MTI4fHI+Pj4xMiY2MyksZVtzKytdPTEyOHxyPj4+NiY2MyksZVtzKytdPTEyOHw2MyZyKTtyZXR1cm4gZX0sci5idWYyYmluc3RyaW5nPWZ1bmN0aW9uKHQpe3JldHVybiBsKHQsdC5sZW5ndGgpfSxyLmJpbnN0cmluZzJidWY9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPW5ldyBoLkJ1ZjgodC5sZW5ndGgpLHI9MCxpPWUubGVuZ3RoO3I8aTtyKyspZVtyXT10LmNoYXJDb2RlQXQocik7cmV0dXJuIGV9LHIuYnVmMnN0cmluZz1mdW5jdGlvbih0LGUpe3ZhciByLGksbixzLGE9ZXx8dC5sZW5ndGgsbz1uZXcgQXJyYXkoMiphKTtmb3Iocj1pPTA7cjxhOylpZigobj10W3IrK10pPDEyOClvW2krK109bjtlbHNlIGlmKDQ8KHM9dVtuXSkpb1tpKytdPTY1NTMzLHIrPXMtMTtlbHNle2ZvcihuJj0yPT09cz8zMTozPT09cz8xNTo3OzE8cyYmcjxhOyluPW48PDZ8NjMmdFtyKytdLHMtLTsxPHM/b1tpKytdPTY1NTMzOm48NjU1MzY/b1tpKytdPW46KG4tPTY1NTM2LG9baSsrXT01NTI5NnxuPj4xMCYxMDIzLG9baSsrXT01NjMyMHwxMDIzJm4pfXJldHVybiBsKG8saSl9LHIudXRmOGJvcmRlcj1mdW5jdGlvbih0LGUpe3ZhciByO2ZvcigoZT1lfHx0Lmxlbmd0aCk+dC5sZW5ndGgmJihlPXQubGVuZ3RoKSxyPWUtMTswPD1yJiYxMjg9PSgxOTImdFtyXSk7KXItLTtyZXR1cm4gcjwwP2U6MD09PXI/ZTpyK3VbdFtyXV0+ZT9yOmV9fSx7Ii4vY29tbW9uIjo0MX1dLDQzOltmdW5jdGlvbih0LGUscil7InVzZSBzdHJpY3QiO2UuZXhwb3J0cz1mdW5jdGlvbih0LGUscixpKXtmb3IodmFyIG49NjU1MzUmdHwwLHM9dD4+PjE2JjY1NTM1fDAsYT0wOzAhPT1yOyl7Zm9yKHItPWE9MmUzPHI/MmUzOnI7cz1zKyhuPW4rZVtpKytdfDApfDAsLS1hOyk7biU9NjU1MjEscyU9NjU1MjF9cmV0dXJuIG58czw8MTZ8MH19LHt9XSw0NDpbZnVuY3Rpb24odCxlLHIpeyJ1c2Ugc3RyaWN0IjtlLmV4cG9ydHM9e1pfTk9fRkxVU0g6MCxaX1BBUlRJQUxfRkxVU0g6MSxaX1NZTkNfRkxVU0g6MixaX0ZVTExfRkxVU0g6MyxaX0ZJTklTSDo0LFpfQkxPQ0s6NSxaX1RSRUVTOjYsWl9PSzowLFpfU1RSRUFNX0VORDoxLFpfTkVFRF9ESUNUOjIsWl9FUlJOTzotMSxaX1NUUkVBTV9FUlJPUjotMixaX0RBVEFfRVJST1I6LTMsWl9CVUZfRVJST1I6LTUsWl9OT19DT01QUkVTU0lPTjowLFpfQkVTVF9TUEVFRDoxLFpfQkVTVF9DT01QUkVTU0lPTjo5LFpfREVGQVVMVF9DT01QUkVTU0lPTjotMSxaX0ZJTFRFUkVEOjEsWl9IVUZGTUFOX09OTFk6MixaX1JMRTozLFpfRklYRUQ6NCxaX0RFRkFVTFRfU1RSQVRFR1k6MCxaX0JJTkFSWTowLFpfVEVYVDoxLFpfVU5LTk9XTjoyLFpfREVGTEFURUQ6OH19LHt9XSw0NTpbZnVuY3Rpb24odCxlLHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgbz1mdW5jdGlvbigpe2Zvcih2YXIgdCxlPVtdLHI9MDtyPDI1NjtyKyspe3Q9cjtmb3IodmFyIGk9MDtpPDg7aSsrKXQ9MSZ0PzM5ODgyOTIzODRedD4+PjE6dD4+PjE7ZVtyXT10fXJldHVybiBlfSgpO2UuZXhwb3J0cz1mdW5jdGlvbih0LGUscixpKXt2YXIgbj1vLHM9aStyO3RePS0xO2Zvcih2YXIgYT1pO2E8czthKyspdD10Pj4+OF5uWzI1NSYodF5lW2FdKV07cmV0dXJuLTFedH19LHt9XSw0NjpbZnVuY3Rpb24odCxlLHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgaCxkPXQoIi4uL3V0aWxzL2NvbW1vbiIpLHU9dCgiLi90cmVlcyIpLGM9dCgiLi9hZGxlcjMyIikscD10KCIuL2NyYzMyIiksaT10KCIuL21lc3NhZ2VzIiksbD0wLGY9NCxtPTAsXz0tMixnPS0xLGI9NCxuPTIsdj04LHk9OSxzPTI4NixhPTMwLG89MTksdz0yKnMrMSxrPTE1LHg9MyxTPTI1OCx6PVMreCsxLEM9NDIsRT0xMTMsQT0xLEk9MixPPTMsQj00O2Z1bmN0aW9uIFIodCxlKXtyZXR1cm4gdC5tc2c9aVtlXSxlfWZ1bmN0aW9uIFQodCl7cmV0dXJuKHQ8PDEpLSg0PHQ/OTowKX1mdW5jdGlvbiBEKHQpe2Zvcih2YXIgZT10Lmxlbmd0aDswPD0tLWU7KXRbZV09MH1mdW5jdGlvbiBGKHQpe3ZhciBlPXQuc3RhdGUscj1lLnBlbmRpbmc7cj50LmF2YWlsX291dCYmKHI9dC5hdmFpbF9vdXQpLDAhPT1yJiYoZC5hcnJheVNldCh0Lm91dHB1dCxlLnBlbmRpbmdfYnVmLGUucGVuZGluZ19vdXQscix0Lm5leHRfb3V0KSx0Lm5leHRfb3V0Kz1yLGUucGVuZGluZ19vdXQrPXIsdC50b3RhbF9vdXQrPXIsdC5hdmFpbF9vdXQtPXIsZS5wZW5kaW5nLT1yLDA9PT1lLnBlbmRpbmcmJihlLnBlbmRpbmdfb3V0PTApKX1mdW5jdGlvbiBOKHQsZSl7dS5fdHJfZmx1c2hfYmxvY2sodCwwPD10LmJsb2NrX3N0YXJ0P3QuYmxvY2tfc3RhcnQ6LTEsdC5zdHJzdGFydC10LmJsb2NrX3N0YXJ0LGUpLHQuYmxvY2tfc3RhcnQ9dC5zdHJzdGFydCxGKHQuc3RybSl9ZnVuY3Rpb24gVSh0LGUpe3QucGVuZGluZ19idWZbdC5wZW5kaW5nKytdPWV9ZnVuY3Rpb24gUCh0LGUpe3QucGVuZGluZ19idWZbdC5wZW5kaW5nKytdPWU+Pj44JjI1NSx0LnBlbmRpbmdfYnVmW3QucGVuZGluZysrXT0yNTUmZX1mdW5jdGlvbiBMKHQsZSl7dmFyIHIsaSxuPXQubWF4X2NoYWluX2xlbmd0aCxzPXQuc3Ryc3RhcnQsYT10LnByZXZfbGVuZ3RoLG89dC5uaWNlX21hdGNoLGg9dC5zdHJzdGFydD50Lndfc2l6ZS16P3Quc3Ryc3RhcnQtKHQud19zaXplLXopOjAsdT10LndpbmRvdyxsPXQud19tYXNrLGY9dC5wcmV2LGQ9dC5zdHJzdGFydCtTLGM9dVtzK2EtMV0scD11W3MrYV07dC5wcmV2X2xlbmd0aD49dC5nb29kX21hdGNoJiYobj4+PTIpLG8+dC5sb29rYWhlYWQmJihvPXQubG9va2FoZWFkKTtkb3tpZih1WyhyPWUpK2FdPT09cCYmdVtyK2EtMV09PT1jJiZ1W3JdPT09dVtzXSYmdVsrK3JdPT09dVtzKzFdKXtzKz0yLHIrKztkb3t9d2hpbGUodVsrK3NdPT09dVsrK3JdJiZ1Wysrc109PT11Wysrcl0mJnVbKytzXT09PXVbKytyXSYmdVsrK3NdPT09dVsrK3JdJiZ1Wysrc109PT11Wysrcl0mJnVbKytzXT09PXVbKytyXSYmdVsrK3NdPT09dVsrK3JdJiZ1Wysrc109PT11Wysrcl0mJnM8ZCk7aWYoaT1TLShkLXMpLHM9ZC1TLGE8aSl7aWYodC5tYXRjaF9zdGFydD1lLG88PShhPWkpKWJyZWFrO2M9dVtzK2EtMV0scD11W3MrYV19fX13aGlsZSgoZT1mW2UmbF0pPmgmJjAhPS0tbik7cmV0dXJuIGE8PXQubG9va2FoZWFkP2E6dC5sb29rYWhlYWR9ZnVuY3Rpb24gaih0KXt2YXIgZSxyLGksbixzLGEsbyxoLHUsbCxmPXQud19zaXplO2Rve2lmKG49dC53aW5kb3dfc2l6ZS10Lmxvb2thaGVhZC10LnN0cnN0YXJ0LHQuc3Ryc3RhcnQ+PWYrKGYteikpe2ZvcihkLmFycmF5U2V0KHQud2luZG93LHQud2luZG93LGYsZiwwKSx0Lm1hdGNoX3N0YXJ0LT1mLHQuc3Ryc3RhcnQtPWYsdC5ibG9ja19zdGFydC09ZixlPXI9dC5oYXNoX3NpemU7aT10LmhlYWRbLS1lXSx0LmhlYWRbZV09Zjw9aT9pLWY6MCwtLXI7KTtmb3IoZT1yPWY7aT10LnByZXZbLS1lXSx0LnByZXZbZV09Zjw9aT9pLWY6MCwtLXI7KTtuKz1mfWlmKDA9PT10LnN0cm0uYXZhaWxfaW4pYnJlYWs7aWYoYT10LnN0cm0sbz10LndpbmRvdyxoPXQuc3Ryc3RhcnQrdC5sb29rYWhlYWQsdT1uLGw9dm9pZCAwLGw9YS5hdmFpbF9pbix1PGwmJihsPXUpLHI9MD09PWw/MDooYS5hdmFpbF9pbi09bCxkLmFycmF5U2V0KG8sYS5pbnB1dCxhLm5leHRfaW4sbCxoKSwxPT09YS5zdGF0ZS53cmFwP2EuYWRsZXI9YyhhLmFkbGVyLG8sbCxoKToyPT09YS5zdGF0ZS53cmFwJiYoYS5hZGxlcj1wKGEuYWRsZXIsbyxsLGgpKSxhLm5leHRfaW4rPWwsYS50b3RhbF9pbis9bCxsKSx0Lmxvb2thaGVhZCs9cix0Lmxvb2thaGVhZCt0Lmluc2VydD49eClmb3Iocz10LnN0cnN0YXJ0LXQuaW5zZXJ0LHQuaW5zX2g9dC53aW5kb3dbc10sdC5pbnNfaD0odC5pbnNfaDw8dC5oYXNoX3NoaWZ0XnQud2luZG93W3MrMV0pJnQuaGFzaF9tYXNrO3QuaW5zZXJ0JiYodC5pbnNfaD0odC5pbnNfaDw8dC5oYXNoX3NoaWZ0XnQud2luZG93W3MreC0xXSkmdC5oYXNoX21hc2ssdC5wcmV2W3MmdC53X21hc2tdPXQuaGVhZFt0Lmluc19oXSx0LmhlYWRbdC5pbnNfaF09cyxzKyssdC5pbnNlcnQtLSwhKHQubG9va2FoZWFkK3QuaW5zZXJ0PHgpKTspO313aGlsZSh0Lmxvb2thaGVhZDx6JiYwIT09dC5zdHJtLmF2YWlsX2luKX1mdW5jdGlvbiBaKHQsZSl7Zm9yKHZhciByLGk7Oyl7aWYodC5sb29rYWhlYWQ8eil7aWYoaih0KSx0Lmxvb2thaGVhZDx6JiZlPT09bClyZXR1cm4gQTtpZigwPT09dC5sb29rYWhlYWQpYnJlYWt9aWYocj0wLHQubG9va2FoZWFkPj14JiYodC5pbnNfaD0odC5pbnNfaDw8dC5oYXNoX3NoaWZ0XnQud2luZG93W3Quc3Ryc3RhcnQreC0xXSkmdC5oYXNoX21hc2sscj10LnByZXZbdC5zdHJzdGFydCZ0LndfbWFza109dC5oZWFkW3QuaW5zX2hdLHQuaGVhZFt0Lmluc19oXT10LnN0cnN0YXJ0KSwwIT09ciYmdC5zdHJzdGFydC1yPD10Lndfc2l6ZS16JiYodC5tYXRjaF9sZW5ndGg9TCh0LHIpKSx0Lm1hdGNoX2xlbmd0aD49eClpZihpPXUuX3RyX3RhbGx5KHQsdC5zdHJzdGFydC10Lm1hdGNoX3N0YXJ0LHQubWF0Y2hfbGVuZ3RoLXgpLHQubG9va2FoZWFkLT10Lm1hdGNoX2xlbmd0aCx0Lm1hdGNoX2xlbmd0aDw9dC5tYXhfbGF6eV9tYXRjaCYmdC5sb29rYWhlYWQ+PXgpe2Zvcih0Lm1hdGNoX2xlbmd0aC0tO3Quc3Ryc3RhcnQrKyx0Lmluc19oPSh0Lmluc19oPDx0Lmhhc2hfc2hpZnRedC53aW5kb3dbdC5zdHJzdGFydCt4LTFdKSZ0Lmhhc2hfbWFzayxyPXQucHJldlt0LnN0cnN0YXJ0JnQud19tYXNrXT10LmhlYWRbdC5pbnNfaF0sdC5oZWFkW3QuaW5zX2hdPXQuc3Ryc3RhcnQsMCE9LS10Lm1hdGNoX2xlbmd0aDspO3Quc3Ryc3RhcnQrK31lbHNlIHQuc3Ryc3RhcnQrPXQubWF0Y2hfbGVuZ3RoLHQubWF0Y2hfbGVuZ3RoPTAsdC5pbnNfaD10LndpbmRvd1t0LnN0cnN0YXJ0XSx0Lmluc19oPSh0Lmluc19oPDx0Lmhhc2hfc2hpZnRedC53aW5kb3dbdC5zdHJzdGFydCsxXSkmdC5oYXNoX21hc2s7ZWxzZSBpPXUuX3RyX3RhbGx5KHQsMCx0LndpbmRvd1t0LnN0cnN0YXJ0XSksdC5sb29rYWhlYWQtLSx0LnN0cnN0YXJ0Kys7aWYoaSYmKE4odCwhMSksMD09PXQuc3RybS5hdmFpbF9vdXQpKXJldHVybiBBfXJldHVybiB0Lmluc2VydD10LnN0cnN0YXJ0PHgtMT90LnN0cnN0YXJ0OngtMSxlPT09Zj8oTih0LCEwKSwwPT09dC5zdHJtLmF2YWlsX291dD9POkIpOnQubGFzdF9saXQmJihOKHQsITEpLDA9PT10LnN0cm0uYXZhaWxfb3V0KT9BOkl9ZnVuY3Rpb24gVyh0LGUpe2Zvcih2YXIgcixpLG47Oyl7aWYodC5sb29rYWhlYWQ8eil7aWYoaih0KSx0Lmxvb2thaGVhZDx6JiZlPT09bClyZXR1cm4gQTtpZigwPT09dC5sb29rYWhlYWQpYnJlYWt9aWYocj0wLHQubG9va2FoZWFkPj14JiYodC5pbnNfaD0odC5pbnNfaDw8dC5oYXNoX3NoaWZ0XnQud2luZG93W3Quc3Ryc3RhcnQreC0xXSkmdC5oYXNoX21hc2sscj10LnByZXZbdC5zdHJzdGFydCZ0LndfbWFza109dC5oZWFkW3QuaW5zX2hdLHQuaGVhZFt0Lmluc19oXT10LnN0cnN0YXJ0KSx0LnByZXZfbGVuZ3RoPXQubWF0Y2hfbGVuZ3RoLHQucHJldl9tYXRjaD10Lm1hdGNoX3N0YXJ0LHQubWF0Y2hfbGVuZ3RoPXgtMSwwIT09ciYmdC5wcmV2X2xlbmd0aDx0Lm1heF9sYXp5X21hdGNoJiZ0LnN0cnN0YXJ0LXI8PXQud19zaXplLXomJih0Lm1hdGNoX2xlbmd0aD1MKHQsciksdC5tYXRjaF9sZW5ndGg8PTUmJigxPT09dC5zdHJhdGVneXx8dC5tYXRjaF9sZW5ndGg9PT14JiY0MDk2PHQuc3Ryc3RhcnQtdC5tYXRjaF9zdGFydCkmJih0Lm1hdGNoX2xlbmd0aD14LTEpKSx0LnByZXZfbGVuZ3RoPj14JiZ0Lm1hdGNoX2xlbmd0aDw9dC5wcmV2X2xlbmd0aCl7Zm9yKG49dC5zdHJzdGFydCt0Lmxvb2thaGVhZC14LGk9dS5fdHJfdGFsbHkodCx0LnN0cnN0YXJ0LTEtdC5wcmV2X21hdGNoLHQucHJldl9sZW5ndGgteCksdC5sb29rYWhlYWQtPXQucHJldl9sZW5ndGgtMSx0LnByZXZfbGVuZ3RoLT0yOysrdC5zdHJzdGFydDw9biYmKHQuaW5zX2g9KHQuaW5zX2g8PHQuaGFzaF9zaGlmdF50LndpbmRvd1t0LnN0cnN0YXJ0K3gtMV0pJnQuaGFzaF9tYXNrLHI9dC5wcmV2W3Quc3Ryc3RhcnQmdC53X21hc2tdPXQuaGVhZFt0Lmluc19oXSx0LmhlYWRbdC5pbnNfaF09dC5zdHJzdGFydCksMCE9LS10LnByZXZfbGVuZ3RoOyk7aWYodC5tYXRjaF9hdmFpbGFibGU9MCx0Lm1hdGNoX2xlbmd0aD14LTEsdC5zdHJzdGFydCsrLGkmJihOKHQsITEpLDA9PT10LnN0cm0uYXZhaWxfb3V0KSlyZXR1cm4gQX1lbHNlIGlmKHQubWF0Y2hfYXZhaWxhYmxlKXtpZigoaT11Ll90cl90YWxseSh0LDAsdC53aW5kb3dbdC5zdHJzdGFydC0xXSkpJiZOKHQsITEpLHQuc3Ryc3RhcnQrKyx0Lmxvb2thaGVhZC0tLDA9PT10LnN0cm0uYXZhaWxfb3V0KXJldHVybiBBfWVsc2UgdC5tYXRjaF9hdmFpbGFibGU9MSx0LnN0cnN0YXJ0KyssdC5sb29rYWhlYWQtLX1yZXR1cm4gdC5tYXRjaF9hdmFpbGFibGUmJihpPXUuX3RyX3RhbGx5KHQsMCx0LndpbmRvd1t0LnN0cnN0YXJ0LTFdKSx0Lm1hdGNoX2F2YWlsYWJsZT0wKSx0Lmluc2VydD10LnN0cnN0YXJ0PHgtMT90LnN0cnN0YXJ0OngtMSxlPT09Zj8oTih0LCEwKSwwPT09dC5zdHJtLmF2YWlsX291dD9POkIpOnQubGFzdF9saXQmJihOKHQsITEpLDA9PT10LnN0cm0uYXZhaWxfb3V0KT9BOkl9ZnVuY3Rpb24gTSh0LGUscixpLG4pe3RoaXMuZ29vZF9sZW5ndGg9dCx0aGlzLm1heF9sYXp5PWUsdGhpcy5uaWNlX2xlbmd0aD1yLHRoaXMubWF4X2NoYWluPWksdGhpcy5mdW5jPW59ZnVuY3Rpb24gSCgpe3RoaXMuc3RybT1udWxsLHRoaXMuc3RhdHVzPTAsdGhpcy5wZW5kaW5nX2J1Zj1udWxsLHRoaXMucGVuZGluZ19idWZfc2l6ZT0wLHRoaXMucGVuZGluZ19vdXQ9MCx0aGlzLnBlbmRpbmc9MCx0aGlzLndyYXA9MCx0aGlzLmd6aGVhZD1udWxsLHRoaXMuZ3ppbmRleD0wLHRoaXMubWV0aG9kPXYsdGhpcy5sYXN0X2ZsdXNoPS0xLHRoaXMud19zaXplPTAsdGhpcy53X2JpdHM9MCx0aGlzLndfbWFzaz0wLHRoaXMud2luZG93PW51bGwsdGhpcy53aW5kb3dfc2l6ZT0wLHRoaXMucHJldj1udWxsLHRoaXMuaGVhZD1udWxsLHRoaXMuaW5zX2g9MCx0aGlzLmhhc2hfc2l6ZT0wLHRoaXMuaGFzaF9iaXRzPTAsdGhpcy5oYXNoX21hc2s9MCx0aGlzLmhhc2hfc2hpZnQ9MCx0aGlzLmJsb2NrX3N0YXJ0PTAsdGhpcy5tYXRjaF9sZW5ndGg9MCx0aGlzLnByZXZfbWF0Y2g9MCx0aGlzLm1hdGNoX2F2YWlsYWJsZT0wLHRoaXMuc3Ryc3RhcnQ9MCx0aGlzLm1hdGNoX3N0YXJ0PTAsdGhpcy5sb29rYWhlYWQ9MCx0aGlzLnByZXZfbGVuZ3RoPTAsdGhpcy5tYXhfY2hhaW5fbGVuZ3RoPTAsdGhpcy5tYXhfbGF6eV9tYXRjaD0wLHRoaXMubGV2ZWw9MCx0aGlzLnN0cmF0ZWd5PTAsdGhpcy5nb29kX21hdGNoPTAsdGhpcy5uaWNlX21hdGNoPTAsdGhpcy5keW5fbHRyZWU9bmV3IGQuQnVmMTYoMip3KSx0aGlzLmR5bl9kdHJlZT1uZXcgZC5CdWYxNigyKigyKmErMSkpLHRoaXMuYmxfdHJlZT1uZXcgZC5CdWYxNigyKigyKm8rMSkpLEQodGhpcy5keW5fbHRyZWUpLEQodGhpcy5keW5fZHRyZWUpLEQodGhpcy5ibF90cmVlKSx0aGlzLmxfZGVzYz1udWxsLHRoaXMuZF9kZXNjPW51bGwsdGhpcy5ibF9kZXNjPW51bGwsdGhpcy5ibF9jb3VudD1uZXcgZC5CdWYxNihrKzEpLHRoaXMuaGVhcD1uZXcgZC5CdWYxNigyKnMrMSksRCh0aGlzLmhlYXApLHRoaXMuaGVhcF9sZW49MCx0aGlzLmhlYXBfbWF4PTAsdGhpcy5kZXB0aD1uZXcgZC5CdWYxNigyKnMrMSksRCh0aGlzLmRlcHRoKSx0aGlzLmxfYnVmPTAsdGhpcy5saXRfYnVmc2l6ZT0wLHRoaXMubGFzdF9saXQ9MCx0aGlzLmRfYnVmPTAsdGhpcy5vcHRfbGVuPTAsdGhpcy5zdGF0aWNfbGVuPTAsdGhpcy5tYXRjaGVzPTAsdGhpcy5pbnNlcnQ9MCx0aGlzLmJpX2J1Zj0wLHRoaXMuYmlfdmFsaWQ9MH1mdW5jdGlvbiBHKHQpe3ZhciBlO3JldHVybiB0JiZ0LnN0YXRlPyh0LnRvdGFsX2luPXQudG90YWxfb3V0PTAsdC5kYXRhX3R5cGU9biwoZT10LnN0YXRlKS5wZW5kaW5nPTAsZS5wZW5kaW5nX291dD0wLGUud3JhcDwwJiYoZS53cmFwPS1lLndyYXApLGUuc3RhdHVzPWUud3JhcD9DOkUsdC5hZGxlcj0yPT09ZS53cmFwPzA6MSxlLmxhc3RfZmx1c2g9bCx1Ll90cl9pbml0KGUpLG0pOlIodCxfKX1mdW5jdGlvbiBLKHQpe3ZhciBlPUcodCk7cmV0dXJuIGU9PT1tJiZmdW5jdGlvbih0KXt0LndpbmRvd19zaXplPTIqdC53X3NpemUsRCh0LmhlYWQpLHQubWF4X2xhenlfbWF0Y2g9aFt0LmxldmVsXS5tYXhfbGF6eSx0Lmdvb2RfbWF0Y2g9aFt0LmxldmVsXS5nb29kX2xlbmd0aCx0Lm5pY2VfbWF0Y2g9aFt0LmxldmVsXS5uaWNlX2xlbmd0aCx0Lm1heF9jaGFpbl9sZW5ndGg9aFt0LmxldmVsXS5tYXhfY2hhaW4sdC5zdHJzdGFydD0wLHQuYmxvY2tfc3RhcnQ9MCx0Lmxvb2thaGVhZD0wLHQuaW5zZXJ0PTAsdC5tYXRjaF9sZW5ndGg9dC5wcmV2X2xlbmd0aD14LTEsdC5tYXRjaF9hdmFpbGFibGU9MCx0Lmluc19oPTB9KHQuc3RhdGUpLGV9ZnVuY3Rpb24gWSh0LGUscixpLG4scyl7aWYoIXQpcmV0dXJuIF87dmFyIGE9MTtpZihlPT09ZyYmKGU9NiksaTwwPyhhPTAsaT0taSk6MTU8aSYmKGE9MixpLT0xNiksbjwxfHx5PG58fHIhPT12fHxpPDh8fDE1PGl8fGU8MHx8OTxlfHxzPDB8fGI8cylyZXR1cm4gUih0LF8pOzg9PT1pJiYoaT05KTt2YXIgbz1uZXcgSDtyZXR1cm4odC5zdGF0ZT1vKS5zdHJtPXQsby53cmFwPWEsby5nemhlYWQ9bnVsbCxvLndfYml0cz1pLG8ud19zaXplPTE8PG8ud19iaXRzLG8ud19tYXNrPW8ud19zaXplLTEsby5oYXNoX2JpdHM9bis3LG8uaGFzaF9zaXplPTE8PG8uaGFzaF9iaXRzLG8uaGFzaF9tYXNrPW8uaGFzaF9zaXplLTEsby5oYXNoX3NoaWZ0PX5+KChvLmhhc2hfYml0cyt4LTEpL3gpLG8ud2luZG93PW5ldyBkLkJ1ZjgoMipvLndfc2l6ZSksby5oZWFkPW5ldyBkLkJ1ZjE2KG8uaGFzaF9zaXplKSxvLnByZXY9bmV3IGQuQnVmMTYoby53X3NpemUpLG8ubGl0X2J1ZnNpemU9MTw8bis2LG8ucGVuZGluZ19idWZfc2l6ZT00Km8ubGl0X2J1ZnNpemUsby5wZW5kaW5nX2J1Zj1uZXcgZC5CdWY4KG8ucGVuZGluZ19idWZfc2l6ZSksby5kX2J1Zj0xKm8ubGl0X2J1ZnNpemUsby5sX2J1Zj0zKm8ubGl0X2J1ZnNpemUsby5sZXZlbD1lLG8uc3RyYXRlZ3k9cyxvLm1ldGhvZD1yLEsodCl9aD1bbmV3IE0oMCwwLDAsMCxmdW5jdGlvbih0LGUpe3ZhciByPTY1NTM1O2ZvcihyPnQucGVuZGluZ19idWZfc2l6ZS01JiYocj10LnBlbmRpbmdfYnVmX3NpemUtNSk7Oyl7aWYodC5sb29rYWhlYWQ8PTEpe2lmKGoodCksMD09PXQubG9va2FoZWFkJiZlPT09bClyZXR1cm4gQTtpZigwPT09dC5sb29rYWhlYWQpYnJlYWt9dC5zdHJzdGFydCs9dC5sb29rYWhlYWQsdC5sb29rYWhlYWQ9MDt2YXIgaT10LmJsb2NrX3N0YXJ0K3I7aWYoKDA9PT10LnN0cnN0YXJ0fHx0LnN0cnN0YXJ0Pj1pKSYmKHQubG9va2FoZWFkPXQuc3Ryc3RhcnQtaSx0LnN0cnN0YXJ0PWksTih0LCExKSwwPT09dC5zdHJtLmF2YWlsX291dCkpcmV0dXJuIEE7aWYodC5zdHJzdGFydC10LmJsb2NrX3N0YXJ0Pj10Lndfc2l6ZS16JiYoTih0LCExKSwwPT09dC5zdHJtLmF2YWlsX291dCkpcmV0dXJuIEF9cmV0dXJuIHQuaW5zZXJ0PTAsZT09PWY/KE4odCwhMCksMD09PXQuc3RybS5hdmFpbF9vdXQ/TzpCKToodC5zdHJzdGFydD50LmJsb2NrX3N0YXJ0JiYoTih0LCExKSx0LnN0cm0uYXZhaWxfb3V0KSxBKX0pLG5ldyBNKDQsNCw4LDQsWiksbmV3IE0oNCw1LDE2LDgsWiksbmV3IE0oNCw2LDMyLDMyLFopLG5ldyBNKDQsNCwxNiwxNixXKSxuZXcgTSg4LDE2LDMyLDMyLFcpLG5ldyBNKDgsMTYsMTI4LDEyOCxXKSxuZXcgTSg4LDMyLDEyOCwyNTYsVyksbmV3IE0oMzIsMTI4LDI1OCwxMDI0LFcpLG5ldyBNKDMyLDI1OCwyNTgsNDA5NixXKV0sci5kZWZsYXRlSW5pdD1mdW5jdGlvbih0LGUpe3JldHVybiBZKHQsZSx2LDE1LDgsMCl9LHIuZGVmbGF0ZUluaXQyPVksci5kZWZsYXRlUmVzZXQ9SyxyLmRlZmxhdGVSZXNldEtlZXA9RyxyLmRlZmxhdGVTZXRIZWFkZXI9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdCYmdC5zdGF0ZT8yIT09dC5zdGF0ZS53cmFwP186KHQuc3RhdGUuZ3poZWFkPWUsbSk6X30sci5kZWZsYXRlPWZ1bmN0aW9uKHQsZSl7dmFyIHIsaSxuLHM7aWYoIXR8fCF0LnN0YXRlfHw1PGV8fGU8MClyZXR1cm4gdD9SKHQsXyk6XztpZihpPXQuc3RhdGUsIXQub3V0cHV0fHwhdC5pbnB1dCYmMCE9PXQuYXZhaWxfaW58fDY2Nj09PWkuc3RhdHVzJiZlIT09ZilyZXR1cm4gUih0LDA9PT10LmF2YWlsX291dD8tNTpfKTtpZihpLnN0cm09dCxyPWkubGFzdF9mbHVzaCxpLmxhc3RfZmx1c2g9ZSxpLnN0YXR1cz09PUMpaWYoMj09PWkud3JhcCl0LmFkbGVyPTAsVShpLDMxKSxVKGksMTM5KSxVKGksOCksaS5nemhlYWQ/KFUoaSwoaS5nemhlYWQudGV4dD8xOjApKyhpLmd6aGVhZC5oY3JjPzI6MCkrKGkuZ3poZWFkLmV4dHJhPzQ6MCkrKGkuZ3poZWFkLm5hbWU/ODowKSsoaS5nemhlYWQuY29tbWVudD8xNjowKSksVShpLDI1NSZpLmd6aGVhZC50aW1lKSxVKGksaS5nemhlYWQudGltZT4+OCYyNTUpLFUoaSxpLmd6aGVhZC50aW1lPj4xNiYyNTUpLFUoaSxpLmd6aGVhZC50aW1lPj4yNCYyNTUpLFUoaSw5PT09aS5sZXZlbD8yOjI8PWkuc3RyYXRlZ3l8fGkubGV2ZWw8Mj80OjApLFUoaSwyNTUmaS5nemhlYWQub3MpLGkuZ3poZWFkLmV4dHJhJiZpLmd6aGVhZC5leHRyYS5sZW5ndGgmJihVKGksMjU1JmkuZ3poZWFkLmV4dHJhLmxlbmd0aCksVShpLGkuZ3poZWFkLmV4dHJhLmxlbmd0aD4+OCYyNTUpKSxpLmd6aGVhZC5oY3JjJiYodC5hZGxlcj1wKHQuYWRsZXIsaS5wZW5kaW5nX2J1ZixpLnBlbmRpbmcsMCkpLGkuZ3ppbmRleD0wLGkuc3RhdHVzPTY5KTooVShpLDApLFUoaSwwKSxVKGksMCksVShpLDApLFUoaSwwKSxVKGksOT09PWkubGV2ZWw/MjoyPD1pLnN0cmF0ZWd5fHxpLmxldmVsPDI/NDowKSxVKGksMyksaS5zdGF0dXM9RSk7ZWxzZXt2YXIgYT12KyhpLndfYml0cy04PDw0KTw8ODthfD0oMjw9aS5zdHJhdGVneXx8aS5sZXZlbDwyPzA6aS5sZXZlbDw2PzE6Nj09PWkubGV2ZWw/MjozKTw8NiwwIT09aS5zdHJzdGFydCYmKGF8PTMyKSxhKz0zMS1hJTMxLGkuc3RhdHVzPUUsUChpLGEpLDAhPT1pLnN0cnN0YXJ0JiYoUChpLHQuYWRsZXI+Pj4xNiksUChpLDY1NTM1JnQuYWRsZXIpKSx0LmFkbGVyPTF9aWYoNjk9PT1pLnN0YXR1cylpZihpLmd6aGVhZC5leHRyYSl7Zm9yKG49aS5wZW5kaW5nO2kuZ3ppbmRleDwoNjU1MzUmaS5nemhlYWQuZXh0cmEubGVuZ3RoKSYmKGkucGVuZGluZyE9PWkucGVuZGluZ19idWZfc2l6ZXx8KGkuZ3poZWFkLmhjcmMmJmkucGVuZGluZz5uJiYodC5hZGxlcj1wKHQuYWRsZXIsaS5wZW5kaW5nX2J1ZixpLnBlbmRpbmctbixuKSksRih0KSxuPWkucGVuZGluZyxpLnBlbmRpbmchPT1pLnBlbmRpbmdfYnVmX3NpemUpKTspVShpLDI1NSZpLmd6aGVhZC5leHRyYVtpLmd6aW5kZXhdKSxpLmd6aW5kZXgrKztpLmd6aGVhZC5oY3JjJiZpLnBlbmRpbmc+biYmKHQuYWRsZXI9cCh0LmFkbGVyLGkucGVuZGluZ19idWYsaS5wZW5kaW5nLW4sbikpLGkuZ3ppbmRleD09PWkuZ3poZWFkLmV4dHJhLmxlbmd0aCYmKGkuZ3ppbmRleD0wLGkuc3RhdHVzPTczKX1lbHNlIGkuc3RhdHVzPTczO2lmKDczPT09aS5zdGF0dXMpaWYoaS5nemhlYWQubmFtZSl7bj1pLnBlbmRpbmc7ZG97aWYoaS5wZW5kaW5nPT09aS5wZW5kaW5nX2J1Zl9zaXplJiYoaS5nemhlYWQuaGNyYyYmaS5wZW5kaW5nPm4mJih0LmFkbGVyPXAodC5hZGxlcixpLnBlbmRpbmdfYnVmLGkucGVuZGluZy1uLG4pKSxGKHQpLG49aS5wZW5kaW5nLGkucGVuZGluZz09PWkucGVuZGluZ19idWZfc2l6ZSkpe3M9MTticmVha31zPWkuZ3ppbmRleDxpLmd6aGVhZC5uYW1lLmxlbmd0aD8yNTUmaS5nemhlYWQubmFtZS5jaGFyQ29kZUF0KGkuZ3ppbmRleCsrKTowLFUoaSxzKX13aGlsZSgwIT09cyk7aS5nemhlYWQuaGNyYyYmaS5wZW5kaW5nPm4mJih0LmFkbGVyPXAodC5hZGxlcixpLnBlbmRpbmdfYnVmLGkucGVuZGluZy1uLG4pKSwwPT09cyYmKGkuZ3ppbmRleD0wLGkuc3RhdHVzPTkxKX1lbHNlIGkuc3RhdHVzPTkxO2lmKDkxPT09aS5zdGF0dXMpaWYoaS5nemhlYWQuY29tbWVudCl7bj1pLnBlbmRpbmc7ZG97aWYoaS5wZW5kaW5nPT09aS5wZW5kaW5nX2J1Zl9zaXplJiYoaS5nemhlYWQuaGNyYyYmaS5wZW5kaW5nPm4mJih0LmFkbGVyPXAodC5hZGxlcixpLnBlbmRpbmdfYnVmLGkucGVuZGluZy1uLG4pKSxGKHQpLG49aS5wZW5kaW5nLGkucGVuZGluZz09PWkucGVuZGluZ19idWZfc2l6ZSkpe3M9MTticmVha31zPWkuZ3ppbmRleDxpLmd6aGVhZC5jb21tZW50Lmxlbmd0aD8yNTUmaS5nemhlYWQuY29tbWVudC5jaGFyQ29kZUF0KGkuZ3ppbmRleCsrKTowLFUoaSxzKX13aGlsZSgwIT09cyk7aS5nemhlYWQuaGNyYyYmaS5wZW5kaW5nPm4mJih0LmFkbGVyPXAodC5hZGxlcixpLnBlbmRpbmdfYnVmLGkucGVuZGluZy1uLG4pKSwwPT09cyYmKGkuc3RhdHVzPTEwMyl9ZWxzZSBpLnN0YXR1cz0xMDM7aWYoMTAzPT09aS5zdGF0dXMmJihpLmd6aGVhZC5oY3JjPyhpLnBlbmRpbmcrMj5pLnBlbmRpbmdfYnVmX3NpemUmJkYodCksaS5wZW5kaW5nKzI8PWkucGVuZGluZ19idWZfc2l6ZSYmKFUoaSwyNTUmdC5hZGxlciksVShpLHQuYWRsZXI+PjgmMjU1KSx0LmFkbGVyPTAsaS5zdGF0dXM9RSkpOmkuc3RhdHVzPUUpLDAhPT1pLnBlbmRpbmcpe2lmKEYodCksMD09PXQuYXZhaWxfb3V0KXJldHVybiBpLmxhc3RfZmx1c2g9LTEsbX1lbHNlIGlmKDA9PT10LmF2YWlsX2luJiZUKGUpPD1UKHIpJiZlIT09ZilyZXR1cm4gUih0LC01KTtpZig2NjY9PT1pLnN0YXR1cyYmMCE9PXQuYXZhaWxfaW4pcmV0dXJuIFIodCwtNSk7aWYoMCE9PXQuYXZhaWxfaW58fDAhPT1pLmxvb2thaGVhZHx8ZSE9PWwmJjY2NiE9PWkuc3RhdHVzKXt2YXIgbz0yPT09aS5zdHJhdGVneT9mdW5jdGlvbih0LGUpe2Zvcih2YXIgcjs7KXtpZigwPT09dC5sb29rYWhlYWQmJihqKHQpLDA9PT10Lmxvb2thaGVhZCkpe2lmKGU9PT1sKXJldHVybiBBO2JyZWFrfWlmKHQubWF0Y2hfbGVuZ3RoPTAscj11Ll90cl90YWxseSh0LDAsdC53aW5kb3dbdC5zdHJzdGFydF0pLHQubG9va2FoZWFkLS0sdC5zdHJzdGFydCsrLHImJihOKHQsITEpLDA9PT10LnN0cm0uYXZhaWxfb3V0KSlyZXR1cm4gQX1yZXR1cm4gdC5pbnNlcnQ9MCxlPT09Zj8oTih0LCEwKSwwPT09dC5zdHJtLmF2YWlsX291dD9POkIpOnQubGFzdF9saXQmJihOKHQsITEpLDA9PT10LnN0cm0uYXZhaWxfb3V0KT9BOkl9KGksZSk6Mz09PWkuc3RyYXRlZ3k/ZnVuY3Rpb24odCxlKXtmb3IodmFyIHIsaSxuLHMsYT10LndpbmRvdzs7KXtpZih0Lmxvb2thaGVhZDw9Uyl7aWYoaih0KSx0Lmxvb2thaGVhZDw9UyYmZT09PWwpcmV0dXJuIEE7aWYoMD09PXQubG9va2FoZWFkKWJyZWFrfWlmKHQubWF0Y2hfbGVuZ3RoPTAsdC5sb29rYWhlYWQ+PXgmJjA8dC5zdHJzdGFydCYmKGk9YVtuPXQuc3Ryc3RhcnQtMV0pPT09YVsrK25dJiZpPT09YVsrK25dJiZpPT09YVsrK25dKXtzPXQuc3Ryc3RhcnQrUztkb3t9d2hpbGUoaT09PWFbKytuXSYmaT09PWFbKytuXSYmaT09PWFbKytuXSYmaT09PWFbKytuXSYmaT09PWFbKytuXSYmaT09PWFbKytuXSYmaT09PWFbKytuXSYmaT09PWFbKytuXSYmbjxzKTt0Lm1hdGNoX2xlbmd0aD1TLShzLW4pLHQubWF0Y2hfbGVuZ3RoPnQubG9va2FoZWFkJiYodC5tYXRjaF9sZW5ndGg9dC5sb29rYWhlYWQpfWlmKHQubWF0Y2hfbGVuZ3RoPj14PyhyPXUuX3RyX3RhbGx5KHQsMSx0Lm1hdGNoX2xlbmd0aC14KSx0Lmxvb2thaGVhZC09dC5tYXRjaF9sZW5ndGgsdC5zdHJzdGFydCs9dC5tYXRjaF9sZW5ndGgsdC5tYXRjaF9sZW5ndGg9MCk6KHI9dS5fdHJfdGFsbHkodCwwLHQud2luZG93W3Quc3Ryc3RhcnRdKSx0Lmxvb2thaGVhZC0tLHQuc3Ryc3RhcnQrKyksciYmKE4odCwhMSksMD09PXQuc3RybS5hdmFpbF9vdXQpKXJldHVybiBBfXJldHVybiB0Lmluc2VydD0wLGU9PT1mPyhOKHQsITApLDA9PT10LnN0cm0uYXZhaWxfb3V0P086Qik6dC5sYXN0X2xpdCYmKE4odCwhMSksMD09PXQuc3RybS5hdmFpbF9vdXQpP0E6SX0oaSxlKTpoW2kubGV2ZWxdLmZ1bmMoaSxlKTtpZihvIT09TyYmbyE9PUJ8fChpLnN0YXR1cz02NjYpLG89PT1BfHxvPT09TylyZXR1cm4gMD09PXQuYXZhaWxfb3V0JiYoaS5sYXN0X2ZsdXNoPS0xKSxtO2lmKG89PT1JJiYoMT09PWU/dS5fdHJfYWxpZ24oaSk6NSE9PWUmJih1Ll90cl9zdG9yZWRfYmxvY2soaSwwLDAsITEpLDM9PT1lJiYoRChpLmhlYWQpLDA9PT1pLmxvb2thaGVhZCYmKGkuc3Ryc3RhcnQ9MCxpLmJsb2NrX3N0YXJ0PTAsaS5pbnNlcnQ9MCkpKSxGKHQpLDA9PT10LmF2YWlsX291dCkpcmV0dXJuIGkubGFzdF9mbHVzaD0tMSxtfXJldHVybiBlIT09Zj9tOmkud3JhcDw9MD8xOigyPT09aS53cmFwPyhVKGksMjU1JnQuYWRsZXIpLFUoaSx0LmFkbGVyPj44JjI1NSksVShpLHQuYWRsZXI+PjE2JjI1NSksVShpLHQuYWRsZXI+PjI0JjI1NSksVShpLDI1NSZ0LnRvdGFsX2luKSxVKGksdC50b3RhbF9pbj4+OCYyNTUpLFUoaSx0LnRvdGFsX2luPj4xNiYyNTUpLFUoaSx0LnRvdGFsX2luPj4yNCYyNTUpKTooUChpLHQuYWRsZXI+Pj4xNiksUChpLDY1NTM1JnQuYWRsZXIpKSxGKHQpLDA8aS53cmFwJiYoaS53cmFwPS1pLndyYXApLDAhPT1pLnBlbmRpbmc/bToxKX0sci5kZWZsYXRlRW5kPWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiB0JiZ0LnN0YXRlPyhlPXQuc3RhdGUuc3RhdHVzKSE9PUMmJjY5IT09ZSYmNzMhPT1lJiY5MSE9PWUmJjEwMyE9PWUmJmUhPT1FJiY2NjYhPT1lP1IodCxfKToodC5zdGF0ZT1udWxsLGU9PT1FP1IodCwtMyk6bSk6X30sci5kZWZsYXRlU2V0RGljdGlvbmFyeT1mdW5jdGlvbih0LGUpe3ZhciByLGksbixzLGEsbyxoLHUsbD1lLmxlbmd0aDtpZighdHx8IXQuc3RhdGUpcmV0dXJuIF87aWYoMj09PShzPShyPXQuc3RhdGUpLndyYXApfHwxPT09cyYmci5zdGF0dXMhPT1DfHxyLmxvb2thaGVhZClyZXR1cm4gXztmb3IoMT09PXMmJih0LmFkbGVyPWModC5hZGxlcixlLGwsMCkpLHIud3JhcD0wLGw+PXIud19zaXplJiYoMD09PXMmJihEKHIuaGVhZCksci5zdHJzdGFydD0wLHIuYmxvY2tfc3RhcnQ9MCxyLmluc2VydD0wKSx1PW5ldyBkLkJ1Zjgoci53X3NpemUpLGQuYXJyYXlTZXQodSxlLGwtci53X3NpemUsci53X3NpemUsMCksZT11LGw9ci53X3NpemUpLGE9dC5hdmFpbF9pbixvPXQubmV4dF9pbixoPXQuaW5wdXQsdC5hdmFpbF9pbj1sLHQubmV4dF9pbj0wLHQuaW5wdXQ9ZSxqKHIpO3IubG9va2FoZWFkPj14Oyl7Zm9yKGk9ci5zdHJzdGFydCxuPXIubG9va2FoZWFkLSh4LTEpO3IuaW5zX2g9KHIuaW5zX2g8PHIuaGFzaF9zaGlmdF5yLndpbmRvd1tpK3gtMV0pJnIuaGFzaF9tYXNrLHIucHJldltpJnIud19tYXNrXT1yLmhlYWRbci5pbnNfaF0sci5oZWFkW3IuaW5zX2hdPWksaSsrLC0tbjspO3Iuc3Ryc3RhcnQ9aSxyLmxvb2thaGVhZD14LTEsaihyKX1yZXR1cm4gci5zdHJzdGFydCs9ci5sb29rYWhlYWQsci5ibG9ja19zdGFydD1yLnN0cnN0YXJ0LHIuaW5zZXJ0PXIubG9va2FoZWFkLHIubG9va2FoZWFkPTAsci5tYXRjaF9sZW5ndGg9ci5wcmV2X2xlbmd0aD14LTEsci5tYXRjaF9hdmFpbGFibGU9MCx0Lm5leHRfaW49byx0LmlucHV0PWgsdC5hdmFpbF9pbj1hLHIud3JhcD1zLG19LHIuZGVmbGF0ZUluZm89InBha28gZGVmbGF0ZSAoZnJvbSBOb2RlY2EgcHJvamVjdCkifSx7Ii4uL3V0aWxzL2NvbW1vbiI6NDEsIi4vYWRsZXIzMiI6NDMsIi4vY3JjMzIiOjQ1LCIuL21lc3NhZ2VzIjo1MSwiLi90cmVlcyI6NTJ9XSw0NzpbZnVuY3Rpb24odCxlLHIpeyJ1c2Ugc3RyaWN0IjtlLmV4cG9ydHM9ZnVuY3Rpb24oKXt0aGlzLnRleHQ9MCx0aGlzLnRpbWU9MCx0aGlzLnhmbGFncz0wLHRoaXMub3M9MCx0aGlzLmV4dHJhPW51bGwsdGhpcy5leHRyYV9sZW49MCx0aGlzLm5hbWU9IiIsdGhpcy5jb21tZW50PSIiLHRoaXMuaGNyYz0wLHRoaXMuZG9uZT0hMX19LHt9XSw0ODpbZnVuY3Rpb24odCxlLHIpeyJ1c2Ugc3RyaWN0IjtlLmV4cG9ydHM9ZnVuY3Rpb24odCxlKXt2YXIgcixpLG4scyxhLG8saCx1LGwsZixkLGMscCxtLF8sZyxiLHYseSx3LGsseCxTLHosQztyPXQuc3RhdGUsaT10Lm5leHRfaW4sej10LmlucHV0LG49aSsodC5hdmFpbF9pbi01KSxzPXQubmV4dF9vdXQsQz10Lm91dHB1dCxhPXMtKGUtdC5hdmFpbF9vdXQpLG89cysodC5hdmFpbF9vdXQtMjU3KSxoPXIuZG1heCx1PXIud3NpemUsbD1yLndoYXZlLGY9ci53bmV4dCxkPXIud2luZG93LGM9ci5ob2xkLHA9ci5iaXRzLG09ci5sZW5jb2RlLF89ci5kaXN0Y29kZSxnPSgxPDxyLmxlbmJpdHMpLTEsYj0oMTw8ci5kaXN0Yml0cyktMTt0OmRve3A8MTUmJihjKz16W2krK108PHAscCs9OCxjKz16W2krK108PHAscCs9OCksdj1tW2MmZ107ZTpmb3IoOzspe2lmKGM+Pj49eT12Pj4+MjQscC09eSwwPT09KHk9dj4+PjE2JjI1NSkpQ1tzKytdPTY1NTM1JnY7ZWxzZXtpZighKDE2JnkpKXtpZigwPT0oNjQmeSkpe3Y9bVsoNjU1MzUmdikrKGMmKDE8PHkpLTEpXTtjb250aW51ZSBlfWlmKDMyJnkpe3IubW9kZT0xMjticmVhayB0fXQubXNnPSJpbnZhbGlkIGxpdGVyYWwvbGVuZ3RoIGNvZGUiLHIubW9kZT0zMDticmVhayB0fXc9NjU1MzUmdiwoeSY9MTUpJiYocDx5JiYoYys9eltpKytdPDxwLHArPTgpLHcrPWMmKDE8PHkpLTEsYz4+Pj15LHAtPXkpLHA8MTUmJihjKz16W2krK108PHAscCs9OCxjKz16W2krK108PHAscCs9OCksdj1fW2MmYl07cjpmb3IoOzspe2lmKGM+Pj49eT12Pj4+MjQscC09eSwhKDE2Jih5PXY+Pj4xNiYyNTUpKSl7aWYoMD09KDY0JnkpKXt2PV9bKDY1NTM1JnYpKyhjJigxPDx5KS0xKV07Y29udGludWUgcn10Lm1zZz0iaW52YWxpZCBkaXN0YW5jZSBjb2RlIixyLm1vZGU9MzA7YnJlYWsgdH1pZihrPTY1NTM1JnYscDwoeSY9MTUpJiYoYys9eltpKytdPDxwLChwKz04KTx5JiYoYys9eltpKytdPDxwLHArPTgpKSxoPChrKz1jJigxPDx5KS0xKSl7dC5tc2c9ImludmFsaWQgZGlzdGFuY2UgdG9vIGZhciBiYWNrIixyLm1vZGU9MzA7YnJlYWsgdH1pZihjPj4+PXkscC09eSwoeT1zLWEpPGspe2lmKGw8KHk9ay15KSYmci5zYW5lKXt0Lm1zZz0iaW52YWxpZCBkaXN0YW5jZSB0b28gZmFyIGJhY2siLHIubW9kZT0zMDticmVhayB0fWlmKFM9ZCwoeD0wKT09PWYpe2lmKHgrPXUteSx5PHcpe2Zvcih3LT15O0NbcysrXT1kW3grK10sLS15Oyk7eD1zLWssUz1DfX1lbHNlIGlmKGY8eSl7aWYoeCs9dStmLXksKHktPWYpPHcpe2Zvcih3LT15O0NbcysrXT1kW3grK10sLS15Oyk7aWYoeD0wLGY8dyl7Zm9yKHctPXk9ZjtDW3MrK109ZFt4KytdLC0teTspO3g9cy1rLFM9Q319fWVsc2UgaWYoeCs9Zi15LHk8dyl7Zm9yKHctPXk7Q1tzKytdPWRbeCsrXSwtLXk7KTt4PXMtayxTPUN9Zm9yKDsyPHc7KUNbcysrXT1TW3grK10sQ1tzKytdPVNbeCsrXSxDW3MrK109U1t4KytdLHctPTM7dyYmKENbcysrXT1TW3grK10sMTx3JiYoQ1tzKytdPVNbeCsrXSkpfWVsc2V7Zm9yKHg9cy1rO0NbcysrXT1DW3grK10sQ1tzKytdPUNbeCsrXSxDW3MrK109Q1t4KytdLDI8KHctPTMpOyk7dyYmKENbcysrXT1DW3grK10sMTx3JiYoQ1tzKytdPUNbeCsrXSkpfWJyZWFrfX1icmVha319d2hpbGUoaTxuJiZzPG8pO2ktPXc9cD4+MyxjJj0oMTw8KHAtPXc8PDMpKS0xLHQubmV4dF9pbj1pLHQubmV4dF9vdXQ9cyx0LmF2YWlsX2luPWk8bj9uLWkrNTo1LShpLW4pLHQuYXZhaWxfb3V0PXM8bz9vLXMrMjU3OjI1Ny0ocy1vKSxyLmhvbGQ9YyxyLmJpdHM9cH19LHt9XSw0OTpbZnVuY3Rpb24odCxlLHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgST10KCIuLi91dGlscy9jb21tb24iKSxPPXQoIi4vYWRsZXIzMiIpLEI9dCgiLi9jcmMzMiIpLFI9dCgiLi9pbmZmYXN0IiksVD10KCIuL2luZnRyZWVzIiksRD0xLEY9MixOPTAsVT0tMixQPTEsaT04NTIsbj01OTI7ZnVuY3Rpb24gTCh0KXtyZXR1cm4odD4+PjI0JjI1NSkrKHQ+Pj44JjY1MjgwKSsoKDY1MjgwJnQpPDw4KSsoKDI1NSZ0KTw8MjQpfWZ1bmN0aW9uIHMoKXt0aGlzLm1vZGU9MCx0aGlzLmxhc3Q9ITEsdGhpcy53cmFwPTAsdGhpcy5oYXZlZGljdD0hMSx0aGlzLmZsYWdzPTAsdGhpcy5kbWF4PTAsdGhpcy5jaGVjaz0wLHRoaXMudG90YWw9MCx0aGlzLmhlYWQ9bnVsbCx0aGlzLndiaXRzPTAsdGhpcy53c2l6ZT0wLHRoaXMud2hhdmU9MCx0aGlzLnduZXh0PTAsdGhpcy53aW5kb3c9bnVsbCx0aGlzLmhvbGQ9MCx0aGlzLmJpdHM9MCx0aGlzLmxlbmd0aD0wLHRoaXMub2Zmc2V0PTAsdGhpcy5leHRyYT0wLHRoaXMubGVuY29kZT1udWxsLHRoaXMuZGlzdGNvZGU9bnVsbCx0aGlzLmxlbmJpdHM9MCx0aGlzLmRpc3RiaXRzPTAsdGhpcy5uY29kZT0wLHRoaXMubmxlbj0wLHRoaXMubmRpc3Q9MCx0aGlzLmhhdmU9MCx0aGlzLm5leHQ9bnVsbCx0aGlzLmxlbnM9bmV3IEkuQnVmMTYoMzIwKSx0aGlzLndvcms9bmV3IEkuQnVmMTYoMjg4KSx0aGlzLmxlbmR5bj1udWxsLHRoaXMuZGlzdGR5bj1udWxsLHRoaXMuc2FuZT0wLHRoaXMuYmFjaz0wLHRoaXMud2FzPTB9ZnVuY3Rpb24gYSh0KXt2YXIgZTtyZXR1cm4gdCYmdC5zdGF0ZT8oZT10LnN0YXRlLHQudG90YWxfaW49dC50b3RhbF9vdXQ9ZS50b3RhbD0wLHQubXNnPSIiLGUud3JhcCYmKHQuYWRsZXI9MSZlLndyYXApLGUubW9kZT1QLGUubGFzdD0wLGUuaGF2ZWRpY3Q9MCxlLmRtYXg9MzI3NjgsZS5oZWFkPW51bGwsZS5ob2xkPTAsZS5iaXRzPTAsZS5sZW5jb2RlPWUubGVuZHluPW5ldyBJLkJ1ZjMyKGkpLGUuZGlzdGNvZGU9ZS5kaXN0ZHluPW5ldyBJLkJ1ZjMyKG4pLGUuc2FuZT0xLGUuYmFjaz0tMSxOKTpVfWZ1bmN0aW9uIG8odCl7dmFyIGU7cmV0dXJuIHQmJnQuc3RhdGU/KChlPXQuc3RhdGUpLndzaXplPTAsZS53aGF2ZT0wLGUud25leHQ9MCxhKHQpKTpVfWZ1bmN0aW9uIGgodCxlKXt2YXIgcixpO3JldHVybiB0JiZ0LnN0YXRlPyhpPXQuc3RhdGUsZTwwPyhyPTAsZT0tZSk6KHI9MSsoZT4+NCksZTw0OCYmKGUmPTE1KSksZSYmKGU8OHx8MTU8ZSk/VToobnVsbCE9PWkud2luZG93JiZpLndiaXRzIT09ZSYmKGkud2luZG93PW51bGwpLGkud3JhcD1yLGkud2JpdHM9ZSxvKHQpKSk6VX1mdW5jdGlvbiB1KHQsZSl7dmFyIHIsaTtyZXR1cm4gdD8oaT1uZXcgcywodC5zdGF0ZT1pKS53aW5kb3c9bnVsbCwocj1oKHQsZSkpIT09TiYmKHQuc3RhdGU9bnVsbCkscik6VX12YXIgbCxmLGQ9ITA7ZnVuY3Rpb24gaih0KXtpZihkKXt2YXIgZTtmb3IobD1uZXcgSS5CdWYzMig1MTIpLGY9bmV3IEkuQnVmMzIoMzIpLGU9MDtlPDE0NDspdC5sZW5zW2UrK109ODtmb3IoO2U8MjU2Oyl0LmxlbnNbZSsrXT05O2Zvcig7ZTwyODA7KXQubGVuc1tlKytdPTc7Zm9yKDtlPDI4ODspdC5sZW5zW2UrK109ODtmb3IoVChELHQubGVucywwLDI4OCxsLDAsdC53b3JrLHtiaXRzOjl9KSxlPTA7ZTwzMjspdC5sZW5zW2UrK109NTtUKEYsdC5sZW5zLDAsMzIsZiwwLHQud29yayx7Yml0czo1fSksZD0hMX10LmxlbmNvZGU9bCx0LmxlbmJpdHM9OSx0LmRpc3Rjb2RlPWYsdC5kaXN0Yml0cz01fWZ1bmN0aW9uIFoodCxlLHIsaSl7dmFyIG4scz10LnN0YXRlO3JldHVybiBudWxsPT09cy53aW5kb3cmJihzLndzaXplPTE8PHMud2JpdHMscy53bmV4dD0wLHMud2hhdmU9MCxzLndpbmRvdz1uZXcgSS5CdWY4KHMud3NpemUpKSxpPj1zLndzaXplPyhJLmFycmF5U2V0KHMud2luZG93LGUsci1zLndzaXplLHMud3NpemUsMCkscy53bmV4dD0wLHMud2hhdmU9cy53c2l6ZSk6KGk8KG49cy53c2l6ZS1zLnduZXh0KSYmKG49aSksSS5hcnJheVNldChzLndpbmRvdyxlLHItaSxuLHMud25leHQpLChpLT1uKT8oSS5hcnJheVNldChzLndpbmRvdyxlLHItaSxpLDApLHMud25leHQ9aSxzLndoYXZlPXMud3NpemUpOihzLnduZXh0Kz1uLHMud25leHQ9PT1zLndzaXplJiYocy53bmV4dD0wKSxzLndoYXZlPHMud3NpemUmJihzLndoYXZlKz1uKSkpLDB9ci5pbmZsYXRlUmVzZXQ9byxyLmluZmxhdGVSZXNldDI9aCxyLmluZmxhdGVSZXNldEtlZXA9YSxyLmluZmxhdGVJbml0PWZ1bmN0aW9uKHQpe3JldHVybiB1KHQsMTUpfSxyLmluZmxhdGVJbml0Mj11LHIuaW5mbGF0ZT1mdW5jdGlvbih0LGUpe3ZhciByLGksbixzLGEsbyxoLHUsbCxmLGQsYyxwLG0sXyxnLGIsdix5LHcsayx4LFMseixDPTAsRT1uZXcgSS5CdWY4KDQpLEE9WzE2LDE3LDE4LDAsOCw3LDksNiwxMCw1LDExLDQsMTIsMywxMywyLDE0LDEsMTVdO2lmKCF0fHwhdC5zdGF0ZXx8IXQub3V0cHV0fHwhdC5pbnB1dCYmMCE9PXQuYXZhaWxfaW4pcmV0dXJuIFU7MTI9PT0ocj10LnN0YXRlKS5tb2RlJiYoci5tb2RlPTEzKSxhPXQubmV4dF9vdXQsbj10Lm91dHB1dCxoPXQuYXZhaWxfb3V0LHM9dC5uZXh0X2luLGk9dC5pbnB1dCxvPXQuYXZhaWxfaW4sdT1yLmhvbGQsbD1yLmJpdHMsZj1vLGQ9aCx4PU47dDpmb3IoOzspc3dpdGNoKHIubW9kZSl7Y2FzZSBQOmlmKDA9PT1yLndyYXApe3IubW9kZT0xMzticmVha31mb3IoO2w8MTY7KXtpZigwPT09bylicmVhayB0O28tLSx1Kz1pW3MrK108PGwsbCs9OH1pZigyJnIud3JhcCYmMzU2MTU9PT11KXtFW3IuY2hlY2s9MF09MjU1JnUsRVsxXT11Pj4+OCYyNTUsci5jaGVjaz1CKHIuY2hlY2ssRSwyLDApLGw9dT0wLHIubW9kZT0yO2JyZWFrfWlmKHIuZmxhZ3M9MCxyLmhlYWQmJihyLmhlYWQuZG9uZT0hMSksISgxJnIud3JhcCl8fCgoKDI1NSZ1KTw8OCkrKHU+PjgpKSUzMSl7dC5tc2c9ImluY29ycmVjdCBoZWFkZXIgY2hlY2siLHIubW9kZT0zMDticmVha31pZig4IT0oMTUmdSkpe3QubXNnPSJ1bmtub3duIGNvbXByZXNzaW9uIG1ldGhvZCIsci5tb2RlPTMwO2JyZWFrfWlmKGwtPTQsaz04KygxNSYodT4+Pj00KSksMD09PXIud2JpdHMpci53Yml0cz1rO2Vsc2UgaWYoaz5yLndiaXRzKXt0Lm1zZz0iaW52YWxpZCB3aW5kb3cgc2l6ZSIsci5tb2RlPTMwO2JyZWFrfXIuZG1heD0xPDxrLHQuYWRsZXI9ci5jaGVjaz0xLHIubW9kZT01MTImdT8xMDoxMixsPXU9MDticmVhaztjYXNlIDI6Zm9yKDtsPDE2Oyl7aWYoMD09PW8pYnJlYWsgdDtvLS0sdSs9aVtzKytdPDxsLGwrPTh9aWYoci5mbGFncz11LDghPSgyNTUmci5mbGFncykpe3QubXNnPSJ1bmtub3duIGNvbXByZXNzaW9uIG1ldGhvZCIsci5tb2RlPTMwO2JyZWFrfWlmKDU3MzQ0JnIuZmxhZ3Mpe3QubXNnPSJ1bmtub3duIGhlYWRlciBmbGFncyBzZXQiLHIubW9kZT0zMDticmVha31yLmhlYWQmJihyLmhlYWQudGV4dD11Pj44JjEpLDUxMiZyLmZsYWdzJiYoRVswXT0yNTUmdSxFWzFdPXU+Pj44JjI1NSxyLmNoZWNrPUIoci5jaGVjayxFLDIsMCkpLGw9dT0wLHIubW9kZT0zO2Nhc2UgMzpmb3IoO2w8MzI7KXtpZigwPT09bylicmVhayB0O28tLSx1Kz1pW3MrK108PGwsbCs9OH1yLmhlYWQmJihyLmhlYWQudGltZT11KSw1MTImci5mbGFncyYmKEVbMF09MjU1JnUsRVsxXT11Pj4+OCYyNTUsRVsyXT11Pj4+MTYmMjU1LEVbM109dT4+PjI0JjI1NSxyLmNoZWNrPUIoci5jaGVjayxFLDQsMCkpLGw9dT0wLHIubW9kZT00O2Nhc2UgNDpmb3IoO2w8MTY7KXtpZigwPT09bylicmVhayB0O28tLSx1Kz1pW3MrK108PGwsbCs9OH1yLmhlYWQmJihyLmhlYWQueGZsYWdzPTI1NSZ1LHIuaGVhZC5vcz11Pj44KSw1MTImci5mbGFncyYmKEVbMF09MjU1JnUsRVsxXT11Pj4+OCYyNTUsci5jaGVjaz1CKHIuY2hlY2ssRSwyLDApKSxsPXU9MCxyLm1vZGU9NTtjYXNlIDU6aWYoMTAyNCZyLmZsYWdzKXtmb3IoO2w8MTY7KXtpZigwPT09bylicmVhayB0O28tLSx1Kz1pW3MrK108PGwsbCs9OH1yLmxlbmd0aD11LHIuaGVhZCYmKHIuaGVhZC5leHRyYV9sZW49dSksNTEyJnIuZmxhZ3MmJihFWzBdPTI1NSZ1LEVbMV09dT4+PjgmMjU1LHIuY2hlY2s9QihyLmNoZWNrLEUsMiwwKSksbD11PTB9ZWxzZSByLmhlYWQmJihyLmhlYWQuZXh0cmE9bnVsbCk7ci5tb2RlPTY7Y2FzZSA2OmlmKDEwMjQmci5mbGFncyYmKG88KGM9ci5sZW5ndGgpJiYoYz1vKSxjJiYoci5oZWFkJiYoaz1yLmhlYWQuZXh0cmFfbGVuLXIubGVuZ3RoLHIuaGVhZC5leHRyYXx8KHIuaGVhZC5leHRyYT1uZXcgQXJyYXkoci5oZWFkLmV4dHJhX2xlbikpLEkuYXJyYXlTZXQoci5oZWFkLmV4dHJhLGkscyxjLGspKSw1MTImci5mbGFncyYmKHIuY2hlY2s9QihyLmNoZWNrLGksYyxzKSksby09YyxzKz1jLHIubGVuZ3RoLT1jKSxyLmxlbmd0aCkpYnJlYWsgdDtyLmxlbmd0aD0wLHIubW9kZT03O2Nhc2UgNzppZigyMDQ4JnIuZmxhZ3Mpe2lmKDA9PT1vKWJyZWFrIHQ7Zm9yKGM9MDtrPWlbcytjKytdLHIuaGVhZCYmayYmci5sZW5ndGg8NjU1MzYmJihyLmhlYWQubmFtZSs9U3RyaW5nLmZyb21DaGFyQ29kZShrKSksayYmYzxvOyk7aWYoNTEyJnIuZmxhZ3MmJihyLmNoZWNrPUIoci5jaGVjayxpLGMscykpLG8tPWMscys9YyxrKWJyZWFrIHR9ZWxzZSByLmhlYWQmJihyLmhlYWQubmFtZT1udWxsKTtyLmxlbmd0aD0wLHIubW9kZT04O2Nhc2UgODppZig0MDk2JnIuZmxhZ3Mpe2lmKDA9PT1vKWJyZWFrIHQ7Zm9yKGM9MDtrPWlbcytjKytdLHIuaGVhZCYmayYmci5sZW5ndGg8NjU1MzYmJihyLmhlYWQuY29tbWVudCs9U3RyaW5nLmZyb21DaGFyQ29kZShrKSksayYmYzxvOyk7aWYoNTEyJnIuZmxhZ3MmJihyLmNoZWNrPUIoci5jaGVjayxpLGMscykpLG8tPWMscys9YyxrKWJyZWFrIHR9ZWxzZSByLmhlYWQmJihyLmhlYWQuY29tbWVudD1udWxsKTtyLm1vZGU9OTtjYXNlIDk6aWYoNTEyJnIuZmxhZ3Mpe2Zvcig7bDwxNjspe2lmKDA9PT1vKWJyZWFrIHQ7by0tLHUrPWlbcysrXTw8bCxsKz04fWlmKHUhPT0oNjU1MzUmci5jaGVjaykpe3QubXNnPSJoZWFkZXIgY3JjIG1pc21hdGNoIixyLm1vZGU9MzA7YnJlYWt9bD11PTB9ci5oZWFkJiYoci5oZWFkLmhjcmM9ci5mbGFncz4+OSYxLHIuaGVhZC5kb25lPSEwKSx0LmFkbGVyPXIuY2hlY2s9MCxyLm1vZGU9MTI7YnJlYWs7Y2FzZSAxMDpmb3IoO2w8MzI7KXtpZigwPT09bylicmVhayB0O28tLSx1Kz1pW3MrK108PGwsbCs9OH10LmFkbGVyPXIuY2hlY2s9TCh1KSxsPXU9MCxyLm1vZGU9MTE7Y2FzZSAxMTppZigwPT09ci5oYXZlZGljdClyZXR1cm4gdC5uZXh0X291dD1hLHQuYXZhaWxfb3V0PWgsdC5uZXh0X2luPXMsdC5hdmFpbF9pbj1vLHIuaG9sZD11LHIuYml0cz1sLDI7dC5hZGxlcj1yLmNoZWNrPTEsci5tb2RlPTEyO2Nhc2UgMTI6aWYoNT09PWV8fDY9PT1lKWJyZWFrIHQ7Y2FzZSAxMzppZihyLmxhc3Qpe3U+Pj49NyZsLGwtPTcmbCxyLm1vZGU9Mjc7YnJlYWt9Zm9yKDtsPDM7KXtpZigwPT09bylicmVhayB0O28tLSx1Kz1pW3MrK108PGwsbCs9OH1zd2l0Y2goci5sYXN0PTEmdSxsLT0xLDMmKHU+Pj49MSkpe2Nhc2UgMDpyLm1vZGU9MTQ7YnJlYWs7Y2FzZSAxOmlmKGoociksci5tb2RlPTIwLDYhPT1lKWJyZWFrO3U+Pj49MixsLT0yO2JyZWFrIHQ7Y2FzZSAyOnIubW9kZT0xNzticmVhaztjYXNlIDM6dC5tc2c9ImludmFsaWQgYmxvY2sgdHlwZSIsci5tb2RlPTMwfXU+Pj49MixsLT0yO2JyZWFrO2Nhc2UgMTQ6Zm9yKHU+Pj49NyZsLGwtPTcmbDtsPDMyOyl7aWYoMD09PW8pYnJlYWsgdDtvLS0sdSs9aVtzKytdPDxsLGwrPTh9aWYoKDY1NTM1JnUpIT0odT4+PjE2XjY1NTM1KSl7dC5tc2c9ImludmFsaWQgc3RvcmVkIGJsb2NrIGxlbmd0aHMiLHIubW9kZT0zMDticmVha31pZihyLmxlbmd0aD02NTUzNSZ1LGw9dT0wLHIubW9kZT0xNSw2PT09ZSlicmVhayB0O2Nhc2UgMTU6ci5tb2RlPTE2O2Nhc2UgMTY6aWYoYz1yLmxlbmd0aCl7aWYobzxjJiYoYz1vKSxoPGMmJihjPWgpLDA9PT1jKWJyZWFrIHQ7SS5hcnJheVNldChuLGkscyxjLGEpLG8tPWMscys9YyxoLT1jLGErPWMsci5sZW5ndGgtPWM7YnJlYWt9ci5tb2RlPTEyO2JyZWFrO2Nhc2UgMTc6Zm9yKDtsPDE0Oyl7aWYoMD09PW8pYnJlYWsgdDtvLS0sdSs9aVtzKytdPDxsLGwrPTh9aWYoci5ubGVuPTI1NysoMzEmdSksdT4+Pj01LGwtPTUsci5uZGlzdD0xKygzMSZ1KSx1Pj4+PTUsbC09NSxyLm5jb2RlPTQrKDE1JnUpLHU+Pj49NCxsLT00LDI4NjxyLm5sZW58fDMwPHIubmRpc3Qpe3QubXNnPSJ0b28gbWFueSBsZW5ndGggb3IgZGlzdGFuY2Ugc3ltYm9scyIsci5tb2RlPTMwO2JyZWFrfXIuaGF2ZT0wLHIubW9kZT0xODtjYXNlIDE4OmZvcig7ci5oYXZlPHIubmNvZGU7KXtmb3IoO2w8Mzspe2lmKDA9PT1vKWJyZWFrIHQ7by0tLHUrPWlbcysrXTw8bCxsKz04fXIubGVuc1tBW3IuaGF2ZSsrXV09NyZ1LHU+Pj49MyxsLT0zfWZvcig7ci5oYXZlPDE5OylyLmxlbnNbQVtyLmhhdmUrK11dPTA7aWYoci5sZW5jb2RlPXIubGVuZHluLHIubGVuYml0cz03LFM9e2JpdHM6ci5sZW5iaXRzfSx4PVQoMCxyLmxlbnMsMCwxOSxyLmxlbmNvZGUsMCxyLndvcmssUyksci5sZW5iaXRzPVMuYml0cyx4KXt0Lm1zZz0iaW52YWxpZCBjb2RlIGxlbmd0aHMgc2V0IixyLm1vZGU9MzA7YnJlYWt9ci5oYXZlPTAsci5tb2RlPTE5O2Nhc2UgMTk6Zm9yKDtyLmhhdmU8ci5ubGVuK3IubmRpc3Q7KXtmb3IoO2c9KEM9ci5sZW5jb2RlW3UmKDE8PHIubGVuYml0cyktMV0pPj4+MTYmMjU1LGI9NjU1MzUmQywhKChfPUM+Pj4yNCk8PWwpOyl7aWYoMD09PW8pYnJlYWsgdDtvLS0sdSs9aVtzKytdPDxsLGwrPTh9aWYoYjwxNil1Pj4+PV8sbC09XyxyLmxlbnNbci5oYXZlKytdPWI7ZWxzZXtpZigxNj09PWIpe2Zvcih6PV8rMjtsPHo7KXtpZigwPT09bylicmVhayB0O28tLSx1Kz1pW3MrK108PGwsbCs9OH1pZih1Pj4+PV8sbC09XywwPT09ci5oYXZlKXt0Lm1zZz0iaW52YWxpZCBiaXQgbGVuZ3RoIHJlcGVhdCIsci5tb2RlPTMwO2JyZWFrfWs9ci5sZW5zW3IuaGF2ZS0xXSxjPTMrKDMmdSksdT4+Pj0yLGwtPTJ9ZWxzZSBpZigxNz09PWIpe2Zvcih6PV8rMztsPHo7KXtpZigwPT09bylicmVhayB0O28tLSx1Kz1pW3MrK108PGwsbCs9OH1sLT1fLGs9MCxjPTMrKDcmKHU+Pj49XykpLHU+Pj49MyxsLT0zfWVsc2V7Zm9yKHo9Xys3O2w8ejspe2lmKDA9PT1vKWJyZWFrIHQ7by0tLHUrPWlbcysrXTw8bCxsKz04fWwtPV8saz0wLGM9MTErKDEyNyYodT4+Pj1fKSksdT4+Pj03LGwtPTd9aWYoci5oYXZlK2M+ci5ubGVuK3IubmRpc3Qpe3QubXNnPSJpbnZhbGlkIGJpdCBsZW5ndGggcmVwZWF0IixyLm1vZGU9MzA7YnJlYWt9Zm9yKDtjLS07KXIubGVuc1tyLmhhdmUrK109a319aWYoMzA9PT1yLm1vZGUpYnJlYWs7aWYoMD09PXIubGVuc1syNTZdKXt0Lm1zZz0iaW52YWxpZCBjb2RlIC0tIG1pc3NpbmcgZW5kLW9mLWJsb2NrIixyLm1vZGU9MzA7YnJlYWt9aWYoci5sZW5iaXRzPTksUz17Yml0czpyLmxlbmJpdHN9LHg9VChELHIubGVucywwLHIubmxlbixyLmxlbmNvZGUsMCxyLndvcmssUyksci5sZW5iaXRzPVMuYml0cyx4KXt0Lm1zZz0iaW52YWxpZCBsaXRlcmFsL2xlbmd0aHMgc2V0IixyLm1vZGU9MzA7YnJlYWt9aWYoci5kaXN0Yml0cz02LHIuZGlzdGNvZGU9ci5kaXN0ZHluLFM9e2JpdHM6ci5kaXN0Yml0c30seD1UKEYsci5sZW5zLHIubmxlbixyLm5kaXN0LHIuZGlzdGNvZGUsMCxyLndvcmssUyksci5kaXN0Yml0cz1TLmJpdHMseCl7dC5tc2c9ImludmFsaWQgZGlzdGFuY2VzIHNldCIsci5tb2RlPTMwO2JyZWFrfWlmKHIubW9kZT0yMCw2PT09ZSlicmVhayB0O2Nhc2UgMjA6ci5tb2RlPTIxO2Nhc2UgMjE6aWYoNjw9byYmMjU4PD1oKXt0Lm5leHRfb3V0PWEsdC5hdmFpbF9vdXQ9aCx0Lm5leHRfaW49cyx0LmF2YWlsX2luPW8sci5ob2xkPXUsci5iaXRzPWwsUih0LGQpLGE9dC5uZXh0X291dCxuPXQub3V0cHV0LGg9dC5hdmFpbF9vdXQscz10Lm5leHRfaW4saT10LmlucHV0LG89dC5hdmFpbF9pbix1PXIuaG9sZCxsPXIuYml0cywxMj09PXIubW9kZSYmKHIuYmFjaz0tMSk7YnJlYWt9Zm9yKHIuYmFjaz0wO2c9KEM9ci5sZW5jb2RlW3UmKDE8PHIubGVuYml0cyktMV0pPj4+MTYmMjU1LGI9NjU1MzUmQywhKChfPUM+Pj4yNCk8PWwpOyl7aWYoMD09PW8pYnJlYWsgdDtvLS0sdSs9aVtzKytdPDxsLGwrPTh9aWYoZyYmMD09KDI0MCZnKSl7Zm9yKHY9Xyx5PWcsdz1iO2c9KEM9ci5sZW5jb2RlW3crKCh1JigxPDx2K3kpLTEpPj52KV0pPj4+MTYmMjU1LGI9NjU1MzUmQywhKHYrKF89Qz4+PjI0KTw9bCk7KXtpZigwPT09bylicmVhayB0O28tLSx1Kz1pW3MrK108PGwsbCs9OH11Pj4+PXYsbC09dixyLmJhY2srPXZ9aWYodT4+Pj1fLGwtPV8sci5iYWNrKz1fLHIubGVuZ3RoPWIsMD09PWcpe3IubW9kZT0yNjticmVha31pZigzMiZnKXtyLmJhY2s9LTEsci5tb2RlPTEyO2JyZWFrfWlmKDY0Jmcpe3QubXNnPSJpbnZhbGlkIGxpdGVyYWwvbGVuZ3RoIGNvZGUiLHIubW9kZT0zMDticmVha31yLmV4dHJhPTE1Jmcsci5tb2RlPTIyO2Nhc2UgMjI6aWYoci5leHRyYSl7Zm9yKHo9ci5leHRyYTtsPHo7KXtpZigwPT09bylicmVhayB0O28tLSx1Kz1pW3MrK108PGwsbCs9OH1yLmxlbmd0aCs9dSYoMTw8ci5leHRyYSktMSx1Pj4+PXIuZXh0cmEsbC09ci5leHRyYSxyLmJhY2srPXIuZXh0cmF9ci53YXM9ci5sZW5ndGgsci5tb2RlPTIzO2Nhc2UgMjM6Zm9yKDtnPShDPXIuZGlzdGNvZGVbdSYoMTw8ci5kaXN0Yml0cyktMV0pPj4+MTYmMjU1LGI9NjU1MzUmQywhKChfPUM+Pj4yNCk8PWwpOyl7aWYoMD09PW8pYnJlYWsgdDtvLS0sdSs9aVtzKytdPDxsLGwrPTh9aWYoMD09KDI0MCZnKSl7Zm9yKHY9Xyx5PWcsdz1iO2c9KEM9ci5kaXN0Y29kZVt3KygodSYoMTw8dit5KS0xKT4+dildKT4+PjE2JjI1NSxiPTY1NTM1JkMsISh2KyhfPUM+Pj4yNCk8PWwpOyl7aWYoMD09PW8pYnJlYWsgdDtvLS0sdSs9aVtzKytdPDxsLGwrPTh9dT4+Pj12LGwtPXYsci5iYWNrKz12fWlmKHU+Pj49XyxsLT1fLHIuYmFjays9Xyw2NCZnKXt0Lm1zZz0iaW52YWxpZCBkaXN0YW5jZSBjb2RlIixyLm1vZGU9MzA7YnJlYWt9ci5vZmZzZXQ9YixyLmV4dHJhPTE1Jmcsci5tb2RlPTI0O2Nhc2UgMjQ6aWYoci5leHRyYSl7Zm9yKHo9ci5leHRyYTtsPHo7KXtpZigwPT09bylicmVhayB0O28tLSx1Kz1pW3MrK108PGwsbCs9OH1yLm9mZnNldCs9dSYoMTw8ci5leHRyYSktMSx1Pj4+PXIuZXh0cmEsbC09ci5leHRyYSxyLmJhY2srPXIuZXh0cmF9aWYoci5vZmZzZXQ+ci5kbWF4KXt0Lm1zZz0iaW52YWxpZCBkaXN0YW5jZSB0b28gZmFyIGJhY2siLHIubW9kZT0zMDticmVha31yLm1vZGU9MjU7Y2FzZSAyNTppZigwPT09aClicmVhayB0O2lmKGM9ZC1oLHIub2Zmc2V0PmMpe2lmKChjPXIub2Zmc2V0LWMpPnIud2hhdmUmJnIuc2FuZSl7dC5tc2c9ImludmFsaWQgZGlzdGFuY2UgdG9vIGZhciBiYWNrIixyLm1vZGU9MzA7YnJlYWt9cD1jPnIud25leHQ/KGMtPXIud25leHQsci53c2l6ZS1jKTpyLnduZXh0LWMsYz5yLmxlbmd0aCYmKGM9ci5sZW5ndGgpLG09ci53aW5kb3d9ZWxzZSBtPW4scD1hLXIub2Zmc2V0LGM9ci5sZW5ndGg7Zm9yKGg8YyYmKGM9aCksaC09YyxyLmxlbmd0aC09YztuW2ErK109bVtwKytdLC0tYzspOzA9PT1yLmxlbmd0aCYmKHIubW9kZT0yMSk7YnJlYWs7Y2FzZSAyNjppZigwPT09aClicmVhayB0O25bYSsrXT1yLmxlbmd0aCxoLS0sci5tb2RlPTIxO2JyZWFrO2Nhc2UgMjc6aWYoci53cmFwKXtmb3IoO2w8MzI7KXtpZigwPT09bylicmVhayB0O28tLSx1fD1pW3MrK108PGwsbCs9OH1pZihkLT1oLHQudG90YWxfb3V0Kz1kLHIudG90YWwrPWQsZCYmKHQuYWRsZXI9ci5jaGVjaz1yLmZsYWdzP0Ioci5jaGVjayxuLGQsYS1kKTpPKHIuY2hlY2ssbixkLGEtZCkpLGQ9aCwoci5mbGFncz91OkwodSkpIT09ci5jaGVjayl7dC5tc2c9ImluY29ycmVjdCBkYXRhIGNoZWNrIixyLm1vZGU9MzA7YnJlYWt9bD11PTB9ci5tb2RlPTI4O2Nhc2UgMjg6aWYoci53cmFwJiZyLmZsYWdzKXtmb3IoO2w8MzI7KXtpZigwPT09bylicmVhayB0O28tLSx1Kz1pW3MrK108PGwsbCs9OH1pZih1IT09KDQyOTQ5NjcyOTUmci50b3RhbCkpe3QubXNnPSJpbmNvcnJlY3QgbGVuZ3RoIGNoZWNrIixyLm1vZGU9MzA7YnJlYWt9bD11PTB9ci5tb2RlPTI5O2Nhc2UgMjk6eD0xO2JyZWFrIHQ7Y2FzZSAzMDp4PS0zO2JyZWFrIHQ7Y2FzZSAzMTpyZXR1cm4tNDtjYXNlIDMyOmRlZmF1bHQ6cmV0dXJuIFV9cmV0dXJuIHQubmV4dF9vdXQ9YSx0LmF2YWlsX291dD1oLHQubmV4dF9pbj1zLHQuYXZhaWxfaW49byxyLmhvbGQ9dSxyLmJpdHM9bCwoci53c2l6ZXx8ZCE9PXQuYXZhaWxfb3V0JiZyLm1vZGU8MzAmJihyLm1vZGU8Mjd8fDQhPT1lKSkmJloodCx0Lm91dHB1dCx0Lm5leHRfb3V0LGQtdC5hdmFpbF9vdXQpPyhyLm1vZGU9MzEsLTQpOihmLT10LmF2YWlsX2luLGQtPXQuYXZhaWxfb3V0LHQudG90YWxfaW4rPWYsdC50b3RhbF9vdXQrPWQsci50b3RhbCs9ZCxyLndyYXAmJmQmJih0LmFkbGVyPXIuY2hlY2s9ci5mbGFncz9CKHIuY2hlY2ssbixkLHQubmV4dF9vdXQtZCk6TyhyLmNoZWNrLG4sZCx0Lm5leHRfb3V0LWQpKSx0LmRhdGFfdHlwZT1yLmJpdHMrKHIubGFzdD82NDowKSsoMTI9PT1yLm1vZGU/MTI4OjApKygyMD09PXIubW9kZXx8MTU9PT1yLm1vZGU/MjU2OjApLCgwPT1mJiYwPT09ZHx8ND09PWUpJiZ4PT09TiYmKHg9LTUpLHgpfSxyLmluZmxhdGVFbmQ9ZnVuY3Rpb24odCl7aWYoIXR8fCF0LnN0YXRlKXJldHVybiBVO3ZhciBlPXQuc3RhdGU7cmV0dXJuIGUud2luZG93JiYoZS53aW5kb3c9bnVsbCksdC5zdGF0ZT1udWxsLE59LHIuaW5mbGF0ZUdldEhlYWRlcj1mdW5jdGlvbih0LGUpe3ZhciByO3JldHVybiB0JiZ0LnN0YXRlPzA9PSgyJihyPXQuc3RhdGUpLndyYXApP1U6KChyLmhlYWQ9ZSkuZG9uZT0hMSxOKTpVfSxyLmluZmxhdGVTZXREaWN0aW9uYXJ5PWZ1bmN0aW9uKHQsZSl7dmFyIHIsaT1lLmxlbmd0aDtyZXR1cm4gdCYmdC5zdGF0ZT8wIT09KHI9dC5zdGF0ZSkud3JhcCYmMTEhPT1yLm1vZGU/VToxMT09PXIubW9kZSYmTygxLGUsaSwwKSE9PXIuY2hlY2s/LTM6Wih0LGUsaSxpKT8oci5tb2RlPTMxLC00KTooci5oYXZlZGljdD0xLE4pOlV9LHIuaW5mbGF0ZUluZm89InBha28gaW5mbGF0ZSAoZnJvbSBOb2RlY2EgcHJvamVjdCkifSx7Ii4uL3V0aWxzL2NvbW1vbiI6NDEsIi4vYWRsZXIzMiI6NDMsIi4vY3JjMzIiOjQ1LCIuL2luZmZhc3QiOjQ4LCIuL2luZnRyZWVzIjo1MH1dLDUwOltmdW5jdGlvbih0LGUscil7InVzZSBzdHJpY3QiO3ZhciBEPXQoIi4uL3V0aWxzL2NvbW1vbiIpLEY9WzMsNCw1LDYsNyw4LDksMTAsMTEsMTMsMTUsMTcsMTksMjMsMjcsMzEsMzUsNDMsNTEsNTksNjcsODMsOTksMTE1LDEzMSwxNjMsMTk1LDIyNywyNTgsMCwwXSxOPVsxNiwxNiwxNiwxNiwxNiwxNiwxNiwxNiwxNywxNywxNywxNywxOCwxOCwxOCwxOCwxOSwxOSwxOSwxOSwyMCwyMCwyMCwyMCwyMSwyMSwyMSwyMSwxNiw3Miw3OF0sVT1bMSwyLDMsNCw1LDcsOSwxMywxNywyNSwzMyw0OSw2NSw5NywxMjksMTkzLDI1NywzODUsNTEzLDc2OSwxMDI1LDE1MzcsMjA0OSwzMDczLDQwOTcsNjE0NSw4MTkzLDEyMjg5LDE2Mzg1LDI0NTc3LDAsMF0sUD1bMTYsMTYsMTYsMTYsMTcsMTcsMTgsMTgsMTksMTksMjAsMjAsMjEsMjEsMjIsMjIsMjMsMjMsMjQsMjQsMjUsMjUsMjYsMjYsMjcsMjcsMjgsMjgsMjksMjksNjQsNjRdO2UuZXhwb3J0cz1mdW5jdGlvbih0LGUscixpLG4scyxhLG8pe3ZhciBoLHUsbCxmLGQsYyxwLG0sXyxnPW8uYml0cyxiPTAsdj0wLHk9MCx3PTAsaz0wLHg9MCxTPTAsej0wLEM9MCxFPTAsQT1udWxsLEk9MCxPPW5ldyBELkJ1ZjE2KDE2KSxCPW5ldyBELkJ1ZjE2KDE2KSxSPW51bGwsVD0wO2ZvcihiPTA7Yjw9MTU7YisrKU9bYl09MDtmb3Iodj0wO3Y8aTt2KyspT1tlW3Irdl1dKys7Zm9yKGs9Zyx3PTE1OzE8PXcmJjA9PT1PW3ddO3ctLSk7aWYodzxrJiYoaz13KSwwPT09dylyZXR1cm4gbltzKytdPTIwOTcxNTIwLG5bcysrXT0yMDk3MTUyMCxvLmJpdHM9MSwwO2Zvcih5PTE7eTx3JiYwPT09T1t5XTt5KyspO2ZvcihrPHkmJihrPXkpLGI9ej0xO2I8PTE1O2IrKylpZih6PDw9MSwoei09T1tiXSk8MClyZXR1cm4tMTtpZigwPHomJigwPT09dHx8MSE9PXcpKXJldHVybi0xO2ZvcihCWzFdPTAsYj0xO2I8MTU7YisrKUJbYisxXT1CW2JdK09bYl07Zm9yKHY9MDt2PGk7disrKTAhPT1lW3Irdl0mJihhW0JbZVtyK3ZdXSsrXT12KTtpZihjPTA9PT10PyhBPVI9YSwxOSk6MT09PXQ/KEE9RixJLT0yNTcsUj1OLFQtPTI1NywyNTYpOihBPVUsUj1QLC0xKSxiPXksZD1zLFM9dj1FPTAsbD0tMSxmPShDPTE8PCh4PWspKS0xLDE9PT10JiY4NTI8Q3x8Mj09PXQmJjU5MjxDKXJldHVybiAxO2Zvcig7Oyl7Zm9yKHA9Yi1TLF89YVt2XTxjPyhtPTAsYVt2XSk6YVt2XT5jPyhtPVJbVCthW3ZdXSxBW0krYVt2XV0pOihtPTk2LDApLGg9MTw8Yi1TLHk9dT0xPDx4O25bZCsoRT4+UykrKHUtPWgpXT1wPDwyNHxtPDwxNnxffDAsMCE9PXU7KTtmb3IoaD0xPDxiLTE7RSZoOyloPj49MTtpZigwIT09aD8oRSY9aC0xLEUrPWgpOkU9MCx2KyssMD09LS1PW2JdKXtpZihiPT09dylicmVhaztiPWVbcithW3ZdXX1pZihrPGImJihFJmYpIT09bCl7Zm9yKDA9PT1TJiYoUz1rKSxkKz15LHo9MTw8KHg9Yi1TKTt4K1M8dyYmISgoei09T1t4K1NdKTw9MCk7KXgrKyx6PDw9MTtpZihDKz0xPDx4LDE9PT10JiY4NTI8Q3x8Mj09PXQmJjU5MjxDKXJldHVybiAxO25bbD1FJmZdPWs8PDI0fHg8PDE2fGQtc3wwfX1yZXR1cm4gMCE9PUUmJihuW2QrRV09Yi1TPDwyNHw2NDw8MTZ8MCksby5iaXRzPWssMH19LHsiLi4vdXRpbHMvY29tbW9uIjo0MX1dLDUxOltmdW5jdGlvbih0LGUscil7InVzZSBzdHJpY3QiO2UuZXhwb3J0cz17MjoibmVlZCBkaWN0aW9uYXJ5IiwxOiJzdHJlYW0gZW5kIiwwOiIiLCItMSI6ImZpbGUgZXJyb3IiLCItMiI6InN0cmVhbSBlcnJvciIsIi0zIjoiZGF0YSBlcnJvciIsIi00IjoiaW5zdWZmaWNpZW50IG1lbW9yeSIsIi01IjoiYnVmZmVyIGVycm9yIiwiLTYiOiJpbmNvbXBhdGlibGUgdmVyc2lvbiJ9fSx7fV0sNTI6W2Z1bmN0aW9uKHQsZSxyKXsidXNlIHN0cmljdCI7dmFyIG49dCgiLi4vdXRpbHMvY29tbW9uIiksbz0wLGg9MTtmdW5jdGlvbiBpKHQpe2Zvcih2YXIgZT10Lmxlbmd0aDswPD0tLWU7KXRbZV09MH12YXIgcz0wLGE9MjksdT0yNTYsbD11KzErYSxmPTMwLGQ9MTksXz0yKmwrMSxnPTE1LGM9MTYscD03LG09MjU2LGI9MTYsdj0xNyx5PTE4LHc9WzAsMCwwLDAsMCwwLDAsMCwxLDEsMSwxLDIsMiwyLDIsMywzLDMsMyw0LDQsNCw0LDUsNSw1LDUsMF0saz1bMCwwLDAsMCwxLDEsMiwyLDMsMyw0LDQsNSw1LDYsNiw3LDcsOCw4LDksOSwxMCwxMCwxMSwxMSwxMiwxMiwxMywxM10seD1bMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwyLDMsN10sUz1bMTYsMTcsMTgsMCw4LDcsOSw2LDEwLDUsMTEsNCwxMiwzLDEzLDIsMTQsMSwxNV0sej1uZXcgQXJyYXkoMioobCsyKSk7aSh6KTt2YXIgQz1uZXcgQXJyYXkoMipmKTtpKEMpO3ZhciBFPW5ldyBBcnJheSg1MTIpO2koRSk7dmFyIEE9bmV3IEFycmF5KDI1Nik7aShBKTt2YXIgST1uZXcgQXJyYXkoYSk7aShJKTt2YXIgTyxCLFIsVD1uZXcgQXJyYXkoZik7ZnVuY3Rpb24gRCh0LGUscixpLG4pe3RoaXMuc3RhdGljX3RyZWU9dCx0aGlzLmV4dHJhX2JpdHM9ZSx0aGlzLmV4dHJhX2Jhc2U9cix0aGlzLmVsZW1zPWksdGhpcy5tYXhfbGVuZ3RoPW4sdGhpcy5oYXNfc3RyZWU9dCYmdC5sZW5ndGh9ZnVuY3Rpb24gRih0LGUpe3RoaXMuZHluX3RyZWU9dCx0aGlzLm1heF9jb2RlPTAsdGhpcy5zdGF0X2Rlc2M9ZX1mdW5jdGlvbiBOKHQpe3JldHVybiB0PDI1Nj9FW3RdOkVbMjU2Kyh0Pj4+NyldfWZ1bmN0aW9uIFUodCxlKXt0LnBlbmRpbmdfYnVmW3QucGVuZGluZysrXT0yNTUmZSx0LnBlbmRpbmdfYnVmW3QucGVuZGluZysrXT1lPj4+OCYyNTV9ZnVuY3Rpb24gUCh0LGUscil7dC5iaV92YWxpZD5jLXI/KHQuYmlfYnVmfD1lPDx0LmJpX3ZhbGlkJjY1NTM1LFUodCx0LmJpX2J1ZiksdC5iaV9idWY9ZT4+Yy10LmJpX3ZhbGlkLHQuYmlfdmFsaWQrPXItYyk6KHQuYmlfYnVmfD1lPDx0LmJpX3ZhbGlkJjY1NTM1LHQuYmlfdmFsaWQrPXIpfWZ1bmN0aW9uIEwodCxlLHIpe1AodCxyWzIqZV0sclsyKmUrMV0pfWZ1bmN0aW9uIGoodCxlKXtmb3IodmFyIHI9MDtyfD0xJnQsdD4+Pj0xLHI8PD0xLDA8LS1lOyk7cmV0dXJuIHI+Pj4xfWZ1bmN0aW9uIFoodCxlLHIpe3ZhciBpLG4scz1uZXcgQXJyYXkoZysxKSxhPTA7Zm9yKGk9MTtpPD1nO2krKylzW2ldPWE9YStyW2ktMV08PDE7Zm9yKG49MDtuPD1lO24rKyl7dmFyIG89dFsyKm4rMV07MCE9PW8mJih0WzIqbl09aihzW29dKyssbykpfX1mdW5jdGlvbiBXKHQpe3ZhciBlO2ZvcihlPTA7ZTxsO2UrKyl0LmR5bl9sdHJlZVsyKmVdPTA7Zm9yKGU9MDtlPGY7ZSsrKXQuZHluX2R0cmVlWzIqZV09MDtmb3IoZT0wO2U8ZDtlKyspdC5ibF90cmVlWzIqZV09MDt0LmR5bl9sdHJlZVsyKm1dPTEsdC5vcHRfbGVuPXQuc3RhdGljX2xlbj0wLHQubGFzdF9saXQ9dC5tYXRjaGVzPTB9ZnVuY3Rpb24gTSh0KXs4PHQuYmlfdmFsaWQ/VSh0LHQuYmlfYnVmKTowPHQuYmlfdmFsaWQmJih0LnBlbmRpbmdfYnVmW3QucGVuZGluZysrXT10LmJpX2J1ZiksdC5iaV9idWY9MCx0LmJpX3ZhbGlkPTB9ZnVuY3Rpb24gSCh0LGUscixpKXt2YXIgbj0yKmUscz0yKnI7cmV0dXJuIHRbbl08dFtzXXx8dFtuXT09PXRbc10mJmlbZV08PWlbcl19ZnVuY3Rpb24gRyh0LGUscil7Zm9yKHZhciBpPXQuaGVhcFtyXSxuPXI8PDE7bjw9dC5oZWFwX2xlbiYmKG48dC5oZWFwX2xlbiYmSChlLHQuaGVhcFtuKzFdLHQuaGVhcFtuXSx0LmRlcHRoKSYmbisrLCFIKGUsaSx0LmhlYXBbbl0sdC5kZXB0aCkpOyl0LmhlYXBbcl09dC5oZWFwW25dLHI9bixuPDw9MTt0LmhlYXBbcl09aX1mdW5jdGlvbiBLKHQsZSxyKXt2YXIgaSxuLHMsYSxvPTA7aWYoMCE9PXQubGFzdF9saXQpZm9yKDtpPXQucGVuZGluZ19idWZbdC5kX2J1ZisyKm9dPDw4fHQucGVuZGluZ19idWZbdC5kX2J1ZisyKm8rMV0sbj10LnBlbmRpbmdfYnVmW3QubF9idWYrb10sbysrLDA9PT1pP0wodCxuLGUpOihMKHQsKHM9QVtuXSkrdSsxLGUpLDAhPT0oYT13W3NdKSYmUCh0LG4tPUlbc10sYSksTCh0LHM9TigtLWkpLHIpLDAhPT0oYT1rW3NdKSYmUCh0LGktPVRbc10sYSkpLG88dC5sYXN0X2xpdDspO0wodCxtLGUpfWZ1bmN0aW9uIFkodCxlKXt2YXIgcixpLG4scz1lLmR5bl90cmVlLGE9ZS5zdGF0X2Rlc2Muc3RhdGljX3RyZWUsbz1lLnN0YXRfZGVzYy5oYXNfc3RyZWUsaD1lLnN0YXRfZGVzYy5lbGVtcyx1PS0xO2Zvcih0LmhlYXBfbGVuPTAsdC5oZWFwX21heD1fLHI9MDtyPGg7cisrKTAhPT1zWzIqcl0/KHQuaGVhcFsrK3QuaGVhcF9sZW5dPXU9cix0LmRlcHRoW3JdPTApOnNbMipyKzFdPTA7Zm9yKDt0LmhlYXBfbGVuPDI7KXNbMioobj10LmhlYXBbKyt0LmhlYXBfbGVuXT11PDI/Kyt1OjApXT0xLHQuZGVwdGhbbl09MCx0Lm9wdF9sZW4tLSxvJiYodC5zdGF0aWNfbGVuLT1hWzIqbisxXSk7Zm9yKGUubWF4X2NvZGU9dSxyPXQuaGVhcF9sZW4+PjE7MTw9cjtyLS0pRyh0LHMscik7Zm9yKG49aDtyPXQuaGVhcFsxXSx0LmhlYXBbMV09dC5oZWFwW3QuaGVhcF9sZW4tLV0sRyh0LHMsMSksaT10LmhlYXBbMV0sdC5oZWFwWy0tdC5oZWFwX21heF09cix0LmhlYXBbLS10LmhlYXBfbWF4XT1pLHNbMipuXT1zWzIqcl0rc1syKmldLHQuZGVwdGhbbl09KHQuZGVwdGhbcl0+PXQuZGVwdGhbaV0/dC5kZXB0aFtyXTp0LmRlcHRoW2ldKSsxLHNbMipyKzFdPXNbMippKzFdPW4sdC5oZWFwWzFdPW4rKyxHKHQscywxKSwyPD10LmhlYXBfbGVuOyk7dC5oZWFwWy0tdC5oZWFwX21heF09dC5oZWFwWzFdLGZ1bmN0aW9uKHQsZSl7dmFyIHIsaSxuLHMsYSxvLGg9ZS5keW5fdHJlZSx1PWUubWF4X2NvZGUsbD1lLnN0YXRfZGVzYy5zdGF0aWNfdHJlZSxmPWUuc3RhdF9kZXNjLmhhc19zdHJlZSxkPWUuc3RhdF9kZXNjLmV4dHJhX2JpdHMsYz1lLnN0YXRfZGVzYy5leHRyYV9iYXNlLHA9ZS5zdGF0X2Rlc2MubWF4X2xlbmd0aCxtPTA7Zm9yKHM9MDtzPD1nO3MrKyl0LmJsX2NvdW50W3NdPTA7Zm9yKGhbMip0LmhlYXBbdC5oZWFwX21heF0rMV09MCxyPXQuaGVhcF9tYXgrMTtyPF87cisrKXA8KHM9aFsyKmhbMiooaT10LmhlYXBbcl0pKzFdKzFdKzEpJiYocz1wLG0rKyksaFsyKmkrMV09cyx1PGl8fCh0LmJsX2NvdW50W3NdKyssYT0wLGM8PWkmJihhPWRbaS1jXSksbz1oWzIqaV0sdC5vcHRfbGVuKz1vKihzK2EpLGYmJih0LnN0YXRpY19sZW4rPW8qKGxbMippKzFdK2EpKSk7aWYoMCE9PW0pe2Rve2ZvcihzPXAtMTswPT09dC5ibF9jb3VudFtzXTspcy0tO3QuYmxfY291bnRbc10tLSx0LmJsX2NvdW50W3MrMV0rPTIsdC5ibF9jb3VudFtwXS0tLG0tPTJ9d2hpbGUoMDxtKTtmb3Iocz1wOzAhPT1zO3MtLSlmb3IoaT10LmJsX2NvdW50W3NdOzAhPT1pOyl1PChuPXQuaGVhcFstLXJdKXx8KGhbMipuKzFdIT09cyYmKHQub3B0X2xlbis9KHMtaFsyKm4rMV0pKmhbMipuXSxoWzIqbisxXT1zKSxpLS0pfX0odCxlKSxaKHMsdSx0LmJsX2NvdW50KX1mdW5jdGlvbiBYKHQsZSxyKXt2YXIgaSxuLHM9LTEsYT1lWzFdLG89MCxoPTcsdT00O2ZvcigwPT09YSYmKGg9MTM4LHU9MyksZVsyKihyKzEpKzFdPTY1NTM1LGk9MDtpPD1yO2krKyluPWEsYT1lWzIqKGkrMSkrMV0sKytvPGgmJm49PT1hfHwobzx1P3QuYmxfdHJlZVsyKm5dKz1vOjAhPT1uPyhuIT09cyYmdC5ibF90cmVlWzIqbl0rKyx0LmJsX3RyZWVbMipiXSsrKTpvPD0xMD90LmJsX3RyZWVbMip2XSsrOnQuYmxfdHJlZVsyKnldKysscz1uLHU9KG89MCk9PT1hPyhoPTEzOCwzKTpuPT09YT8oaD02LDMpOihoPTcsNCkpfWZ1bmN0aW9uIFYodCxlLHIpe3ZhciBpLG4scz0tMSxhPWVbMV0sbz0wLGg9Nyx1PTQ7Zm9yKDA9PT1hJiYoaD0xMzgsdT0zKSxpPTA7aTw9cjtpKyspaWYobj1hLGE9ZVsyKihpKzEpKzFdLCEoKytvPGgmJm49PT1hKSl7aWYobzx1KWZvcig7TCh0LG4sdC5ibF90cmVlKSwwIT0tLW87KTtlbHNlIDAhPT1uPyhuIT09cyYmKEwodCxuLHQuYmxfdHJlZSksby0tKSxMKHQsYix0LmJsX3RyZWUpLFAodCxvLTMsMikpOm88PTEwPyhMKHQsdix0LmJsX3RyZWUpLFAodCxvLTMsMykpOihMKHQseSx0LmJsX3RyZWUpLFAodCxvLTExLDcpKTtzPW4sdT0obz0wKT09PWE/KGg9MTM4LDMpOm49PT1hPyhoPTYsMyk6KGg9Nyw0KX19aShUKTt2YXIgcT0hMTtmdW5jdGlvbiBKKHQsZSxyLGkpe1AodCwoczw8MSkrKGk/MTowKSwzKSxmdW5jdGlvbih0LGUscixpKXtNKHQpLGkmJihVKHQsciksVSh0LH5yKSksbi5hcnJheVNldCh0LnBlbmRpbmdfYnVmLHQud2luZG93LGUscix0LnBlbmRpbmcpLHQucGVuZGluZys9cn0odCxlLHIsITApfXIuX3RyX2luaXQ9ZnVuY3Rpb24odCl7cXx8KGZ1bmN0aW9uKCl7dmFyIHQsZSxyLGksbixzPW5ldyBBcnJheShnKzEpO2ZvcihpPXI9MDtpPGEtMTtpKyspZm9yKElbaV09cix0PTA7dDwxPDx3W2ldO3QrKylBW3IrK109aTtmb3IoQVtyLTFdPWksaT1uPTA7aTwxNjtpKyspZm9yKFRbaV09bix0PTA7dDwxPDxrW2ldO3QrKylFW24rK109aTtmb3Iobj4+PTc7aTxmO2krKylmb3IoVFtpXT1uPDw3LHQ9MDt0PDE8PGtbaV0tNzt0KyspRVsyNTYrbisrXT1pO2ZvcihlPTA7ZTw9ZztlKyspc1tlXT0wO2Zvcih0PTA7dDw9MTQzOyl6WzIqdCsxXT04LHQrKyxzWzhdKys7Zm9yKDt0PD0yNTU7KXpbMip0KzFdPTksdCsrLHNbOV0rKztmb3IoO3Q8PTI3OTspelsyKnQrMV09Nyx0Kyssc1s3XSsrO2Zvcig7dDw9Mjg3Oyl6WzIqdCsxXT04LHQrKyxzWzhdKys7Zm9yKFooeixsKzEscyksdD0wO3Q8Zjt0KyspQ1syKnQrMV09NSxDWzIqdF09aih0LDUpO089bmV3IEQoeix3LHUrMSxsLGcpLEI9bmV3IEQoQyxrLDAsZixnKSxSPW5ldyBEKG5ldyBBcnJheSgwKSx4LDAsZCxwKX0oKSxxPSEwKSx0LmxfZGVzYz1uZXcgRih0LmR5bl9sdHJlZSxPKSx0LmRfZGVzYz1uZXcgRih0LmR5bl9kdHJlZSxCKSx0LmJsX2Rlc2M9bmV3IEYodC5ibF90cmVlLFIpLHQuYmlfYnVmPTAsdC5iaV92YWxpZD0wLFcodCl9LHIuX3RyX3N0b3JlZF9ibG9jaz1KLHIuX3RyX2ZsdXNoX2Jsb2NrPWZ1bmN0aW9uKHQsZSxyLGkpe3ZhciBuLHMsYT0wOzA8dC5sZXZlbD8oMj09PXQuc3RybS5kYXRhX3R5cGUmJih0LnN0cm0uZGF0YV90eXBlPWZ1bmN0aW9uKHQpe3ZhciBlLHI9NDA5MzYyNDQ0Nztmb3IoZT0wO2U8PTMxO2UrKyxyPj4+PTEpaWYoMSZyJiYwIT09dC5keW5fbHRyZWVbMiplXSlyZXR1cm4gbztpZigwIT09dC5keW5fbHRyZWVbMThdfHwwIT09dC5keW5fbHRyZWVbMjBdfHwwIT09dC5keW5fbHRyZWVbMjZdKXJldHVybiBoO2ZvcihlPTMyO2U8dTtlKyspaWYoMCE9PXQuZHluX2x0cmVlWzIqZV0pcmV0dXJuIGg7cmV0dXJuIG99KHQpKSxZKHQsdC5sX2Rlc2MpLFkodCx0LmRfZGVzYyksYT1mdW5jdGlvbih0KXt2YXIgZTtmb3IoWCh0LHQuZHluX2x0cmVlLHQubF9kZXNjLm1heF9jb2RlKSxYKHQsdC5keW5fZHRyZWUsdC5kX2Rlc2MubWF4X2NvZGUpLFkodCx0LmJsX2Rlc2MpLGU9ZC0xOzM8PWUmJjA9PT10LmJsX3RyZWVbMipTW2VdKzFdO2UtLSk7cmV0dXJuIHQub3B0X2xlbis9MyooZSsxKSs1KzUrNCxlfSh0KSxuPXQub3B0X2xlbiszKzc+Pj4zLChzPXQuc3RhdGljX2xlbiszKzc+Pj4zKTw9biYmKG49cykpOm49cz1yKzUscis0PD1uJiYtMSE9PWU/Sih0LGUscixpKTo0PT09dC5zdHJhdGVneXx8cz09PW4/KFAodCwyKyhpPzE6MCksMyksSyh0LHosQykpOihQKHQsNCsoaT8xOjApLDMpLGZ1bmN0aW9uKHQsZSxyLGkpe3ZhciBuO2ZvcihQKHQsZS0yNTcsNSksUCh0LHItMSw1KSxQKHQsaS00LDQpLG49MDtuPGk7bisrKVAodCx0LmJsX3RyZWVbMipTW25dKzFdLDMpO1YodCx0LmR5bl9sdHJlZSxlLTEpLFYodCx0LmR5bl9kdHJlZSxyLTEpfSh0LHQubF9kZXNjLm1heF9jb2RlKzEsdC5kX2Rlc2MubWF4X2NvZGUrMSxhKzEpLEsodCx0LmR5bl9sdHJlZSx0LmR5bl9kdHJlZSkpLFcodCksaSYmTSh0KX0sci5fdHJfdGFsbHk9ZnVuY3Rpb24odCxlLHIpe3JldHVybiB0LnBlbmRpbmdfYnVmW3QuZF9idWYrMip0Lmxhc3RfbGl0XT1lPj4+OCYyNTUsdC5wZW5kaW5nX2J1Zlt0LmRfYnVmKzIqdC5sYXN0X2xpdCsxXT0yNTUmZSx0LnBlbmRpbmdfYnVmW3QubF9idWYrdC5sYXN0X2xpdF09MjU1JnIsdC5sYXN0X2xpdCsrLDA9PT1lP3QuZHluX2x0cmVlWzIqcl0rKzoodC5tYXRjaGVzKyssZS0tLHQuZHluX2x0cmVlWzIqKEFbcl0rdSsxKV0rKyx0LmR5bl9kdHJlZVsyKk4oZSldKyspLHQubGFzdF9saXQ9PT10LmxpdF9idWZzaXplLTF9LHIuX3RyX2FsaWduPWZ1bmN0aW9uKHQpe1AodCwyLDMpLEwodCxtLHopLGZ1bmN0aW9uKHQpezE2PT09dC5iaV92YWxpZD8oVSh0LHQuYmlfYnVmKSx0LmJpX2J1Zj0wLHQuYmlfdmFsaWQ9MCk6ODw9dC5iaV92YWxpZCYmKHQucGVuZGluZ19idWZbdC5wZW5kaW5nKytdPTI1NSZ0LmJpX2J1Zix0LmJpX2J1Zj4+PTgsdC5iaV92YWxpZC09OCl9KHQpfX0seyIuLi91dGlscy9jb21tb24iOjQxfV0sNTM6W2Z1bmN0aW9uKHQsZSxyKXsidXNlIHN0cmljdCI7ZS5leHBvcnRzPWZ1bmN0aW9uKCl7dGhpcy5pbnB1dD1udWxsLHRoaXMubmV4dF9pbj0wLHRoaXMuYXZhaWxfaW49MCx0aGlzLnRvdGFsX2luPTAsdGhpcy5vdXRwdXQ9bnVsbCx0aGlzLm5leHRfb3V0PTAsdGhpcy5hdmFpbF9vdXQ9MCx0aGlzLnRvdGFsX291dD0wLHRoaXMubXNnPSIiLHRoaXMuc3RhdGU9bnVsbCx0aGlzLmRhdGFfdHlwZT0yLHRoaXMuYWRsZXI9MH19LHt9XSw1NDpbZnVuY3Rpb24odCxlLHIpeyJ1c2Ugc3RyaWN0IjtlLmV4cG9ydHM9ImZ1bmN0aW9uIj09dHlwZW9mIHNldEltbWVkaWF0ZT9zZXRJbW1lZGlhdGU6ZnVuY3Rpb24oKXt2YXIgdD1bXS5zbGljZS5hcHBseShhcmd1bWVudHMpO3Quc3BsaWNlKDEsMCwwKSxzZXRUaW1lb3V0LmFwcGx5KG51bGwsdCl9fSx7fV19LHt9LFsxMF0pKDEwKX0pOw=="}]},{"name":"","options":{"check_for_updates":true,"user_modified":null,"comment":null,"compatopts_for_requires":true,"compat_wrappedjsobject":false,"compat_metadata":false,"compat_foreach":false,"compat_powerful_this":null,"sandbox":null,"noframes":null,"unwrap":null,"run_at":null,"run_in":null,"tags":[],"override":{"use_includes":[],"orig_includes":["*://tieba.baidu.com/*","*://dq.tieba.com/*","*://jump2.bdimg.com/*","*://jump.bdimg.com/*"],"merge_includes":true,"use_matches":[],"orig_matches":[],"merge_matches":true,"use_excludes":[],"orig_excludes":["*://tieba.baidu.com/f/fdir*"],"merge_excludes":true,"use_connects":[],"orig_connects":[],"merge_connects":true,"use_blockers":[],"orig_run_at":"document-body","orig_run_in":[],"orig_noframes":null,"orig_tags":[]}},"storage":{"ts":1733530213527,"data":{"version":"s2.8.0"}},"enabled":true,"position":5,"file_url":"https://update.greasyfork.org/scripts/23687/%E8%B4%B4%E5%90%A7%E9%A1%B5%E9%9D%A2%E7%B2%BE%E7%AE%80.user.js","uuid":"05335ee8-693d-4538-93d3-f60ff1ee14bf","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICDotLTlkKfpobXpnaLnsr7nroAKLy8gQG5hbWVzcGFjZSAgICBodHRwczovL2dyZWFzeWZvcmsub3JnL3poLUNOL3NjcmlwdHMvMjM2ODcKLy8gQG5hbWVzcGFjZSAgICBodHRwczovL2NvZGluZy5uZXQvdS9CYWNrUnVubmVyL3AvR3JlYXNlTW9ua2V5LUpTL2dpdAovLyBAdmVyc2lvbiAgICAgIDIuOC4wCi8vIEBkZXNjcmlwdGlvbiAg44CQ5Y+v6IO95piv5L2g6YGH5Yiw55qE5pyA5aW955So55qE6LS05ZCn57K+566A6ISa5pys44CR77yM5Y676Zmk5ZCE56eN5bm/5ZGK5Y+K5omw55y85qih5Z2X77yM5YWo6Z2i5pSv5oyB5ZCE56eN6LS05ZCn6aG16Z2i77yM5YWN55m75b2V55yL5biW77yM44CQ5YCS5bqP55yL5biW44CRCi8vIEBhdXRob3IgICAgICAgQmFja1J1bm5lcgovLyBAaW5jbHVkZSAgICAgICo6Ly90aWViYS5iYWlkdS5jb20vKgovLyBAaW5jbHVkZSAgICAgICo6Ly9kcS50aWViYS5jb20vKgovLyBAaW5jbHVkZSAgICAgICo6Ly9qdW1wMi5iZGltZy5jb20vKgovLyBAaW5jbHVkZSAgICAgICo6Ly9qdW1wLmJkaW1nLmNvbS8qCi8vIEBleGNsdWRlICAgICAgKjovL3RpZWJhLmJhaWR1LmNvbS9mL2ZkaXIqCi8vIEBydW4tYXQgICAgICAgZG9jdW1lbnQtYm9keQovLyBAcmVxdWlyZSAgICAgIGh0dHBzOi8vY2RuLmJvb3Rjc3MuY29tL2pxdWVyeS8zLjQuMS9qcXVlcnkubWluLmpzCi8vIEBsaWNlbnNlICAgICAgTUlUCi8vIEBncmFudCAgICAgICAgdW5zYWZlV2luZG93Ci8vIEBncmFudCAgICAgICAgR01fc2V0VmFsdWUKLy8gQGdyYW50ICAgICAgICBHTV9nZXRWYWx1ZQovLyBAZ3JhbnQgICAgICAgIEdNX2RlbGV0ZVZhbHVlCi8vIEBncmFudCAgICAgICAgR01fbGlzdFZhbHVlcwovLyBAZ3JhbnQgICAgICAgIEdNX2luZm8KLy8gQGRvd25sb2FkVVJMIGh0dHBzOi8vdXBkYXRlLmdyZWFzeWZvcmsub3JnL3NjcmlwdHMvMjM2ODcvJUU4JUI0JUI0JUU1JTkwJUE3JUU5JUExJUI1JUU5JTlEJUEyJUU3JUIyJUJFJUU3JUFFJTgwLnVzZXIuanMKLy8gQHVwZGF0ZVVSTCBodHRwczovL3VwZGF0ZS5ncmVhc3lmb3JrLm9yZy9zY3JpcHRzLzIzNjg3LyVFOCVCNCVCNCVFNSU5MCVBNyVFOSVBMSVCNSVFOSU5RCVBMiVFNyVCMiVCRSVFNyVBRSU4MC5tZXRhLmpzCi8vID09L1VzZXJTY3JpcHQ9PQoKLy8gPT09PSAgVGlwcyA9PT09PQovLyDkvb/nlKhUYW1wZXJNb25rZXnnmoTnlKjmiLflj6/ku6XlsIbohJrmnKznmoTliqDovb3kvY3nva7orr7nva7kuLpkb2N1bWVudC1zdGFydOiOt+W+l+abtOWlveaViOaenO+8jOiLpeWHuueOsOS4jeeUn+aViOetiemUmeivr+ivt+i/mOWOn+iuvue9rgovLyDor7fmoLnmja7mgqjnmoTpnIDopoHmoLnmja7kuIvpnaLku6PnoIHnmoTms6jph4rpgInmi6npnIDopoHpmpDol4/nmoTmqKHlnZfvvIzmnInkuI3mg7PpmpDol4/nmoTmqKHlnZflj6/ku6Xms6jph4rmjonpgqPkuIDooYzku6PnoIEKLy8g6K+35qC55o2u5oKo55qE6ZyA6KaB5LiO5rOo6YeK6LCD5pW05Y+Y6YeP5a6a5LmJ5YaF55qE5YaF5a65Ci8vIOaCqOiHquihjOS/ruaUueeahOS7o+eggeS8muWcqOabtOaWsOeahOaXtuWAmeiiq+imhueblu+8jOW7uuiuruaCqOWkh+S7veaCqOS/ruaUueeahOWGheWuuQovLyDpgYfliLDpl67popjor7fnq4vljbPlj43ppogKLy8gPT09PSBEb25hdGUgPT09PQovLyDlpoLmnpzmgqjop4nlvpfmnKzohJrmnKzlpb3nlKjlj6/ku6XotZ7liqnmiJHkuIDngrnpm7boirEKLy8gZG9uYXRlQGJhY2tydW5uZXIudG9wICjmlK/ku5jlrp0pCi8vID09PSDmm7TmlrDml6Xlv5cgPT09Ci8vIDIwMjAuMDEuMTYgLSAyLjguMAovLyDkv67lpI3pl67popgKLy8gMjAxOC4xMi4yNiAtIDIuNy4xNQovLyDkv67lpI1DaHJvbWXmlrDniYjmnKzkuIrnmoTlhbzlrrnpl67popjjgIIKLy8gMjAxOC4xMC4yMSAtIDIuNy4xNAovLyDmt7vliqDkuIDkuKrln5/lkI3ph43lrprlkJHop4TliJkKLy8gMjAxOC4xMC4xMyAtIDIuNy4xMwovLyDmm7TmjaJqUXVlcnnnmoRDRE7vvIzohJrmnKzliqDovb3mj5DpgJ8KLy8g5L+u5aSN5LqG5LiA5Lqb6Zeu6aKYCi8vID09PT09PT09PT09PT09PT0KCgooZnVuY3Rpb24oKSB7CiAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIC8vICAgICAgICDlj5jph4/lrprkuYkKICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PQogICAgdmFyIHNsZWVwVGltZTsKICAgIHZhciBzbGVlcFRpbWVXaGVuUGFnZVR1cm47CiAgICB2YXIgcmV2ZXJzZVNsZWVwVGltZTsKICAgIHZhciBwb3N0cHJvY2VzczsKICAgIHZhciBob21lUGFnZVByb2Nlc3M7CiAgICB2YXIgZ3JvdXBQYWdlUHJvY2VzczsKICAgIHZhciBub0xvZ2luUHJvY2VzczsKICAgIHZhciByZXZlcnNlOwogICAgdmFyIGhvbWVQcm9jZXNzOwogICAgdmFyIGlzSGVhZGltZzsKICAgIHZhciBjaGVja3JhdGU7CiAgICB2YXIgZGVsYXlTY3JpcHRSdW5UaW1lczsKICAgIHZhciBpc1JlZGlyZWN0OwogICAgdmFyIGRpc3BsYXlMaXZlOwogICAgdmFyIGRpc3BsYXlTaWduOwogICAgdmFyIGF1dG9DbG9zZUd1aWRlOwogICAgLy/ohJrmnKzlm7rlrprlvIDlhbMKICAgIHZhciBpc0N0cmxQYW5lbE9uOwogICAgLy/lupXpg6jkv6Hmga9kaXYKICAgIHZhciBmb290OwogICAgdmFyIGhvbWVQYWdlTWF0Y2ggPSBSZWdFeHAoIihodHRwfGh0dHBzKTpcL1wvdGllYmEuYmFpZHUuY29tXC8oIyokKXwoaHR0cHxodHRwcyk6XC9cL3RpZWJhLmJhaWR1LmNvbVwvKGluZGV4XC5odG1sIyokKSIpOwogICAgLy89PT09PT09PT09PT09PT09PT09PT0KICAgIC8v5Lul5LiK5YaF5a655Y+v5Lul5L+u5pS577yM6K+35Yu/5L+u5pS55Lul5LiL5YaF5a65CiAgICAvLz09PT09PT09PT09PT09PT09PT09PQogICAgdmFyIHN0YXJ0VGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpOwogICAgdmFyIGZpbmlzaFRpbWUgPSAtMTsKICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PQogICAgLy8gICAgICAgIOS4u+aJp+ihjOWMugogICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAvL+aOp+WItuWPsOS/oeaBrwogICAgY29uc29sZS53YXJuKCfotLTlkKfpobXpnaLnsr7nroA6IOWIneWni+WMlicpOwogICAgLy/liJ3lp4vljJYKICAgIGluaXRpYWxpemUoKTsKICAgIGNvbnNvbGUud2Fybign6LS05ZCn6aG16Z2i57K+566AOiDlkK/liqgnKTsKICAgIC8v6YeN5a6a5ZCRCiAgICBpZiAoaXNSZWRpcmVjdCl7CiAgICAgICAgcmVkaXJlY3QoKTsKICAgIH0KICAgIC8vY3Nz5L+u5pS5CiAgICBhcHBlbmRDU1MoKTsKICAgIC8v5pu05paw5L+h5oGvCiAgICB1cGRhdGVBbGVydCgpOwogICAgLy/lhY3nmbvlvZUKICAgIGlmIChub0xvZ2luUHJvY2Vzcyl7CiAgICAgICAgbm9Mb2dpbigpOwogICAgfQogICAgaWYgKHBvc3Rwcm9jZXNzKXsKICAgICAgICAvL+aDsOaAp+iEmuacrOaJp+ihjAogICAgICAgICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIC8v5Yqg6L296K6h5pe2CiAgICAgICAgICAgIGZpbmlzaFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIHN0YXJ0VGltZTsKICAgICAgICAgICAgY29uc29sZS5sb2coJ+i0tOWQp+mhtemdoueyvueugDog6aG16Z2i5Yqg6L2955So5pe2OiAnICsgZmluaXNoVGltZSk7CiAgICAgICAgICAgIGNvbnNvbGUud2Fybign6LS05ZCn6aG16Z2i57K+566AOiDlvIDlp4vmiafooYzmg7DmgKfohJrmnKwnKTsKICAgICAgICAgICAgLy/mjqfliLbpnaLmnb8KICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCfotLTlkKfpobXpnaLnsr7nroA6IOato+WcqOWIm+W7uuaOp+WItumdouadvycpOwogICAgICAgICAgICAgICAgaWYoaXNDdHJsUGFuZWxPbil7CiAgICAgICAgICAgICAgICAgICAgY3JlYXRlQ29udHJvbFBhbmVsKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2goZSl7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8v5bqV6YOo5L+h5oGvCiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIGNyZWF0ZUZvb3RlckxheWVyKCk7CiAgICAgICAgICAgICAgICBhZGRGaW5pc2hUaW1lVG9Gb290ZXIoKTsKICAgICAgICAgICAgfSBjYXRjaChlKXsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy/lr7zoiKrmoI/nv7vpobXnm5HlkKwKICAgICAgICAgICAgYWRkTGlzdGVuZXJUb05hdigpOwogICAgICAgICAgICAvL+WIl+ihqOe/u+mhteebkeWQrAogICAgICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLnNlYXJjaC5pbmRleE9mKCJrdz0iKSE9IC0xICYmIHdpbmRvdy5sb2NhdGlvbi5ocmVmLmluZGV4T2YoInNlYXJjaCIpPT0tMSl7CiAgICAgICAgICAgICAgICBhZGRMaXN0ZW5lclRvTGlzdCgpOwogICAgICAgICAgICAgICAgYWRpbkxpc3RDbGVhbigpOwogICAgICAgICAgICAgICAgZGlzYWJsZUZvcnVtQ2FyZCgpOwogICAgICAgICAgICAgICAgLy/oh6rliqjmlLbotbfmjIflvJUgKjIwMTgwNTA5CiAgICAgICAgICAgICAgICBjbG9zZUd1aWRlKCk7CiAgICAgICAgICAgICAgICAvL+W8ueahhuWFs+mXrSAqMjAxODEwMTMKICAgICAgICAgICAgICAgIHJlbW92ZVBvcHVwTW9kYWwoKTsKICAgICAgICAgICAgICAgIC8v5YWz5rOo5oyJ6ZKu5L+u5aSNICoyMDIwMDExNgogICAgICAgICAgICAgICAgZml4Rm9jdXNCdXR0b24oKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24uaHJlZi5pbmRleE9mKCJ0aWViYS5iYWlkdS5jb20vcC8iKSAhPSAtMSl7CiAgICAgICAgICAgICAgICAgICAgYWRkTGlzdGVuZXJUb1BhZ2UoKTsKICAgICAgICAgICAgICAgICAgICB0cG9pbnRBRENsZWFuKCk7CiAgICAgICAgICAgICAgICAgICAgYWRpblBhZ2VDbGVhbigpOwogICAgICAgICAgICAgICAgICAgIHJldmVyc2VvcmRlcigpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLmhyZWYuaW5kZXhPZigidGllYmEuYmFpZHUuY29tL2dyb3VwIikgIT0gLTEpewogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ+i0tOWQp+mhtemdoueyvueugDog5b2T5YmN5L2N5LqO576k57uE6aG16Z2i77yM5LiN5omn6KGM576k57uE6aG16Z2i5oOw5oCn6ISa5pysJyk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhvbWVQYWdlTWF0Y2gudGVzdCh3aW5kb3cubG9jYXRpb24uaHJlZikpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmluZENsZWFuSW5kZXhBREV2ZW50KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ+i0tOWQp+mhtemdoueyvueugDog6aG16Z2i5pyq6YCC6YWN5bu26L+f6ISa5pysJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICAvL+W7tui/n+aJp+ihjAogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXsKICAgICAgICAgICAgdmFyIGludGVydmFsID0gc2V0SW50ZXJ2YWwoY2hlY2ssc2xlZXBUaW1lICogY2hlY2tyYXRlKTsKICAgICAgICAgICAgdmFyIG49MDsKICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2soKXsKICAgICAgICAgICAgICAgIHZhciB0aW1lcyA9IG4rMTsKICAgICAgICAgICAgICAgIGNvbnNvbGUud2Fybign6LS05ZCn6aG16Z2i57K+566AOiDlu7bov5/ohJrmnKzmraPlnKjmiafooYznrKwgJyArIHRpbWVzICsgJyDmrKEnKTsKICAgICAgICAgICAgICAgIC8v5o6n5Yi26Z2i5p2/CiAgICAgICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCfotLTlkKfpobXpnaLnsr7nroA6IOato+WcqOWIm+W7uuaOp+WItumdouadvycpOwogICAgICAgICAgICAgICAgICAgIGlmKGlzQ3RybFBhbmVsT24pewogICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVDb250cm9sUGFuZWwoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGNhdGNoKGUpewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvL+W6lemDqOS/oeaBrwogICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgIGNyZWF0ZUZvb3RlckxheWVyKCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoKGUpewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvL+WvvOiIquagj+e/u+mhteebkeWQrAogICAgICAgICAgICAgICAgYWRkTGlzdGVuZXJUb05hdigpOwogICAgICAgICAgICAgICAgLy/liJfooajnv7vpobXnm5HlkKwKICAgICAgICAgICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24uc2VhcmNoLmluZGV4T2YoImt3PSIpIT0gLTEgJiYgd2luZG93LmxvY2F0aW9uLmhyZWYuaW5kZXhPZigic2VhcmNoIik9PS0xKXsKICAgICAgICAgICAgICAgICAgICBhZGRMaXN0ZW5lclRvTGlzdCgpOwogICAgICAgICAgICAgICAgICAgIGFkaW5MaXN0Q2xlYW4oKTsKICAgICAgICAgICAgICAgICAgICBkaXNhYmxlRm9ydW1DYXJkKCk7CiAgICAgICAgICAgICAgICAgICAgLy/oh6rliqjmlLbotbfmjIflvJUgKjIwMTgwNTA5CiAgICAgICAgICAgICAgICAgICAgY2xvc2VHdWlkZSgpOwogICAgICAgICAgICAgICAgICAgIC8v5by55qGG5YWz6ZetICoyMDE4MTAxMwogICAgICAgICAgICAgICAgICAgIHJlbW92ZVBvcHVwTW9kYWwoKTsKICAgICAgICAgICAgICAgICAgICAvL+S/ruWkjeWFs+azqOaMiemSriAqMjAyMDAxMTYKICAgICAgICAgICAgICAgICAgICBmaXhGb2N1c0J1dHRvbigpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLmhyZWYuaW5kZXhPZigidGllYmEuYmFpZHUuY29tL3AvIikgIT0gLTEpewogICAgICAgICAgICAgICAgICAgICAgICBhZGRMaXN0ZW5lclRvUGFnZSgpOwogICAgICAgICAgICAgICAgICAgICAgICB0cG9pbnRBRENsZWFuKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGFkaW5QYWdlQ2xlYW4oKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV2ZXJzZW9yZGVyKCk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhvbWVQYWdlTWF0Y2gudGVzdCh3aW5kb3cubG9jYXRpb24uaHJlZikpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmluZENsZWFuSW5kZXhBREV2ZW50KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhbkFEaW5JbmRleCgpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmVTdGFydCgpOwogICAgICAgICAgICAgICAgZnVuY3Rpb24gcmVTdGFydCgpewogICAgICAgICAgICAgICAgICAgIG4rKzsKICAgICAgICAgICAgICAgICAgICBpZiAobj5kZWxheVNjcmlwdFJ1blRpbWVzLTEpewogICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGludGVydmFsKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LHNsZWVwVGltZSk7CiAgICB9IGVsc2UgewogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXsKICAgICAgICAgICAgdmFyIGludGVydmFsID0gc2V0SW50ZXJ2YWwoY2hlY2ssc2xlZXBUaW1lICogY2hlY2tyYXRlKTsKICAgICAgICAgICAgdmFyIG4gPSAwOwogICAgICAgICAgICBmdW5jdGlvbiBjaGVjaygpewogICAgICAgICAgICAgICAgLy/mjqfliLbpnaLmnb8KICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ+i0tOWQp+mhtemdoueyvueugDog5q2j5Zyo5Yib5bu65o6n5Yi26Z2i5p2/Jyk7CiAgICAgICAgICAgICAgICAgICAgaWYoaXNDdHJsUGFuZWxPbil7CiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZUNvbnRyb2xQYW5lbCgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gY2F0Y2goZSl7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8v5bqV6YOo5L+h5oGvCiAgICAgICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICAgICAgY3JlYXRlRm9vdGVyTGF5ZXIoKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2goZSl7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIG4rKzsKICAgICAgICAgICAgICAgIGlmIChuPmRlbGF5U2NyaXB0UnVuVGltZXMgLTEpewogICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIC8v5Yqg6L296K6h5pe2CiAgICAgICAgICAgIGZpbmlzaFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIHN0YXJ0VGltZTsKICAgICAgICAgICAgY29uc29sZS5sb2coJ+i0tOWQp+mhtemdoueyvueugDog6aG16Z2i5Yqg6L2955So5pe2OiAnICsgZmluaXNoVGltZSk7CiAgICAgICAgICAgIC8v5o6n5Yi26Z2i5p2/CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIGNvbnNvbGUud2Fybign6LS05ZCn6aG16Z2i57K+566AOiDmraPlnKjliJvlu7rmjqfliLbpnaLmnb8nKTsKICAgICAgICAgICAgICAgIGlmKGlzQ3RybFBhbmVsT24pewogICAgICAgICAgICAgICAgICAgIGNyZWF0ZUNvbnRyb2xQYW5lbCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoKGUpewogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvL+W6lemDqOS/oeaBrwogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICBjcmVhdGVGb290ZXJMYXllcigpOwogICAgICAgICAgICAgICAgYWRkRmluaXNoVGltZVRvRm9vdGVyKCk7CiAgICAgICAgICAgIH0gY2F0Y2goZSl7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgY29uc29sZS53YXJuKCfotLTlkKfpobXpnaLnsr7nroA6IOWQjuWkhOeQhuiEmuacrOW3sui3s+i/hycpOwogICAgfQogICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09CgogICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAvL+WKn+iDveWMuiDor7fli7/kv67mlLnkuIvpnaLnmoTlhoXlrrkKICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PQogICAgLy/liJ3lp4vljJYKICAgIGZ1bmN0aW9uIGluaXRpYWxpemUoKXsKICAgICAgICBzbGVlcFRpbWUgPSBpbml0aWFsaXplX3Zhcigic2xlZXBUaW1lIiwzMDApOwogICAgICAgIHNsZWVwVGltZVdoZW5QYWdlVHVybiA9IGluaXRpYWxpemVfdmFyKCJzbGVlcFRpbWVXaGVuUGFnZVR1cm4iLDgwMCk7CiAgICAgICAgcmV2ZXJzZVNsZWVwVGltZSA9IGluaXRpYWxpemVfdmFyKCJyZXZlcnNlU2xlZXBUaW1lIiwyMDApOwogICAgICAgIHBvc3Rwcm9jZXNzID0gaW5pdGlhbGl6ZV92YXIoInBvc3Rwcm9jZXNzIix0cnVlKTsKICAgICAgICBpc1JlZGlyZWN0ID0gaW5pdGlhbGl6ZV92YXIoImlzUmVkaXJlY3QiLHRydWUpOwogICAgICAgIGhvbWVQYWdlUHJvY2VzcyA9IGluaXRpYWxpemVfdmFyKCJob21lUGFnZVByb2Nlc3MiLHRydWUpOwogICAgICAgIGdyb3VwUGFnZVByb2Nlc3MgPSBpbml0aWFsaXplX3ZhcigiZ3JvdXBQYWdlUHJvY2VzcyIsdHJ1ZSk7CiAgICAgICAgbm9Mb2dpblByb2Nlc3MgPSBpbml0aWFsaXplX3Zhcigibm9Mb2dpblByb2Nlc3MiLHRydWUpOwogICAgICAgIHJldmVyc2UgPSBpbml0aWFsaXplX3ZhcigicmV2ZXJzZSIsZmFsc2UpOwogICAgICAgIGhvbWVQcm9jZXNzID0gaW5pdGlhbGl6ZV92YXIoImhvbWVQcm9jZXNzIix0cnVlKTsKICAgICAgICBpc0hlYWRpbWcgPSBpbml0aWFsaXplX3ZhcigiaXNIZWFkaW1nIixmYWxzZSk7CiAgICAgICAgY2hlY2tyYXRlID0gaW5pdGlhbGl6ZV92YXIoImNoZWNrcmF0ZSIsMSk7CiAgICAgICAgZGVsYXlTY3JpcHRSdW5UaW1lcyA9IGluaXRpYWxpemVfdmFyKCJkZWxheVNjcmlwdFJ1blRpbWVzIiw2KTsKICAgICAgICBkaXNwbGF5TGl2ZSA9IGluaXRpYWxpemVfdmFyKCJkaXNwbGF5TGl2ZSIsZmFsc2UpOwogICAgICAgIGRpc3BsYXlTaWduID0gaW5pdGlhbGl6ZV92YXIoImRpc3BsYXlTaWduIixmYWxzZSk7CiAgICAgICAgYXV0b0Nsb3NlR3VpZGUgPSBpbml0aWFsaXplX3ZhcigiYXV0b0Nsb3NlR3VpZGUiLHRydWUpOwogICAgICAgIC8v5Zu65a6a5byA5YWzICoyMDE4MDUxMAogICAgICAgIGlzQ3RybFBhbmVsT24gPSBpbml0aWFsaXplX3ZhcigiaXNDdHJsUGFuZWxPbiIsdHJ1ZSk7CiAgICB9CiAgICBmdW5jdGlvbiBpbml0aWFsaXplX3ZhcihuYW1lLGRlZmF1bHRTZXQpewogICAgICAgIHZhciBvYmogPSBHTV9nZXRWYWx1ZShuYW1lLGRlZmF1bHRTZXQpOwogICAgICAgIGlmIChvYmogPT09IHVuZGVmaW5lZCl7CiAgICAgICAgICAgIG9iaiA9IGRlZmF1bHRTZXQ7CiAgICAgICAgfQogICAgICAgIHJldHVybiBvYmo7CiAgICB9CiAgICAvL2Nzc+S/ruaUuQogICAgZnVuY3Rpb24gYXBwZW5kQ1NTKCl7CiAgICAgICAgdmFyIGNzc1RleHQgPSAiIjsKICAgICAgICAvL+mhtumDqOebtOaSreagjwogICAgICAgIGNzc1RleHQgKz0gJyN2aWRlb19mcnNfaGVhZCB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIC8v5Y+z5L6n5Lya5ZGY5qih5Z2XCiAgICAgICAgY3NzVGV4dCArPSAnLmNlbGVicml0eSB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIC8v5Y+z5L6n5oiR55qE5bqU55So5qih5Z2XCiAgICAgICAgY3NzVGV4dCArPSAnLm15X2FwcCB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIC8v54Ot6K6u5qacCiAgICAgICAgY3NzVGV4dCArPSAnLnRvcGljX2xpc3RfYm94IHtkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgLy/lub/lkYrngbDoibJsYWJlbAogICAgICAgIGNzc1RleHQgKz0gJy5sYWJlbF90ZXh0IHtkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgLy/lj7PovrnkuIDmjpLlm77moIcKICAgICAgICBjc3NUZXh0ICs9ICcual9pY29uX3Nsb3Qge2Rpc3BsYXk6IG5vbmUgIWltcG9ydGFudDt9JzsKICAgICAgICAvL+S8muWRmOWbvuagh++8iOS8mumAoOaIkOeUqOaIt+WQjeW3puenu++8jOS4gOWumueoi+W6puS4iuW9seWTjeaVtOS9k+e+juingu+8iQogICAgICAgIC8vY3NzVGV4dCArPSAnLmljb25fdGJ3b3JsZCB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIC8v5oKo5Y+v6IO95oSf5YW06Laj55qE5ZCnCiAgICAgICAgY3NzVGV4dCArPSAnLmZvcnVtX3JlY29tbWVuZCB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIC8v5Y+z5LiK6KeS5bqU55So5Lit5b+DCiAgICAgICAgY3NzVGV4dCArPSAnLnVfbWVudV93cmFwLnVfYXBwY2VudGVyRW50cmFuY2Vfd3JhcCB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIC8v5Y+z5LiK6KeS5Lya5ZGY5a6Y572RCiAgICAgICAgY3NzVGV4dCArPSAnLnVfam9pbnZpcF93cmFwLnZpcF9yZWQual9idG5fZ2V0bWVtYmVyIHtkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgY3NzVGV4dCArPSAnLnVfam9pbnZpcCB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIC8v5YaF6aG16aG26YOoYmFubmVyCiAgICAgICAgY3NzVGV4dCArPSAnLmxfYmFubmVyIHtkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgLy/lhoXpobXmiJDlsLFzZWN0aW9uCiAgICAgICAgY3NzVGV4dCArPSAnLmFjaGlldmVtZW50X21lZGFsX3NlY3Rpb24ge2Rpc3BsYXk6IG5vbmUgIWltcG9ydGFudDt9JzsKICAgICAgICAvL+mhtumDqOa4uOaIj+S/oeaBrwogICAgICAgIGNzc1RleHQgKz0gJy5nYW1lLWhlYWQtZ2FtZS1pbmZvLXdyYXBwZXIge2Rpc3BsYXk6IG5vbmUgIWltcG9ydGFudDt9JzsKICAgICAgICAvL+WGhemhtemAgeekvOeJqeaMiemSrgogICAgICAgIGNzc1RleHQgKz0gJy5wb3N0LWZvb3Qtc2VuZC1naWZ0LWJ0biB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIC8v5Lya5ZGY5oy95bCK5oyJ6ZKuCiAgICAgICAgY3NzVGV4dCArPSAnLnNhdmVfZmFjZV9iZyB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIGNzc1RleHQgKz0gJy5zYXZlX2ZhY2VfYmdfMiB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIC8v5bqV6YOo5ri45oiP5byA5rWLCiAgICAgICAgY3NzVGV4dCArPSAnI2R1b2t1X3NlcnZlcnNfbGlzdCB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIC8v5Y+z5L6n54Ot6Zeo5Y2h5YyFCiAgICAgICAgY3NzVGV4dCArPSAnLnU5X2FzaWRlIHtkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgLy/lj7PkvqflsI/or7TkurrmsJTmppwKICAgICAgICBjc3NUZXh0ICs9ICcubm92ZWwtcmFua2luZy1mcnMtYm9keSB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIC8v5aS05YOP5LiL6Z2i55qE5LiA5o6S5Zu+5qCHCiAgICAgICAgY3NzVGV4dCArPSAnLmljb25fd3JhcCB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIC8v6LS05ZCn6Kem54K55o6o5bm/5Zu+54mH77yI5Zyo5bu26L+f5aSE55CG5YmN6aKE5aSE55CG77yJCiAgICAgICAgY3NzVGV4dCArPSAnLnRwb2ludC1pbWdzIHtkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgLy/lj7PkuIvop5Lngq7nrZIKICAgICAgICBjc3NUZXh0ICs9ICcuai1maXJld29yay1zZW5kZXIge2Rpc3BsYXk6IG5vbmUgIWltcG9ydGFudDt9JzsKICAgICAgICAvL+iuv+iwiOebtOaSrQogICAgICAgIGlmICghZGlzcGxheUxpdmUpewogICAgICAgICAgICBjc3NUZXh0ICs9ICcuaW50ZXJ2aWV3IHtkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgfQogICAgICAgIC8v6LS05YaF55u45YWz5o6o6I2QCiAgICAgICAgY3NzVGV4dCArPSAnLnRocmVhZF9yZWNvbW1lbmQge2Rpc3BsYXk6IG5vbmUgIWltcG9ydGFudDt9JzsKICAgICAgICAvL+i0tOWGheW5v+WRigogICAgICAgIGNzc1RleHQgKz0gJy5pZnJhbWVfd3JhcHBlciB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIC8v5Y+z5L6n6LS05ZCn5L2c6ICF6K6k6K+BCiAgICAgICAgY3NzVGV4dCArPSAnLmF1dGhvci1tYW5hZ2VyIHtkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgLy/ovpPlhaXmoYZwbGFjZWhvbGRlcgogICAgICAgIGNzc1RleHQgKz0gJy50Yl9wb3N0ZXJfcGxhY2Vob2xkZXIge2Rpc3BsYXk6IG5vbmUgIWltcG9ydGFudDt9JzsKICAgICAgICAvL+WbvueJh+etvuWQjeahowogICAgICAgIGlmICghZGlzcGxheVNpZ24pewogICAgICAgICAgICBjc3NUZXh0ICs9ICcual91c2VyX3NpZ24ge2Rpc3BsYXk6IG5vbmUgIWltcG9ydGFudDt9JzsKICAgICAgICAgICAgY3NzVGV4dCArPSAnLmRfc2lnbl9zcGxpdCB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIH0KICAgICAgICAvL+S8muWRmOWQjeeJjAogICAgICAgIGNzc1RleHQgKz0gJy5wYl9uYW1lcGxhdGUge2Rpc3BsYXk6IG5vbmUgIWltcG9ydGFudDt9JzsKICAgICAgICAvL+WPs+S+p+iPnOWNleagj+eyvueugAogICAgICAgIGNzc1RleHQgKz0gJy50YnVpX2ZiYXJfcHJvcHMge2Rpc3BsYXk6IG5vbmUgIWltcG9ydGFudDt9JzsKICAgICAgICBjc3NUZXh0ICs9ICcudGJ1aV9mYmFyX3RzdWtrb21pIHtkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgLy/lkKfkuLvkuJPniYgKICAgICAgICBjc3NUZXh0ICs9ICcudGJ1aV9mYmFyX2Jhemh1IHtkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgLy/lj7Pkvqflj6/ngrnlh7vlub/lkYoKICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLmhyZWYgIT09ICJodHRwOi8vdGllYmEuYmFpZHUuY29tLyIgJiYgd2luZG93LmxvY2F0aW9uLmhyZWYgIT09ICJodHRwczovL3RpZWJhLmJhaWR1LmNvbS8iKXsKICAgICAgICAgICAgY3NzVGV4dCArPSAnLmpfY2xpY2tfc3RhdHMge2Rpc3BsYXk6IG5vbmUgIWltcG9ydGFudDt9JzsKICAgICAgICB9CiAgICAgICAgLy/lj7Pkvqfop4bpopHmjqjojZAKICAgICAgICBjc3NUZXh0ICs9ICcjdmlkZW9fYXNpZGUge2Rpc3BsYXk6IG5vbmUgIWltcG9ydGFudDt9JzsKICAgICAgICAvL+S4gOalvOeUteW9seW5v+WRigogICAgICAgIGNzc1RleHQgKz0gJy50cG9pbnQtc2tpbiB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIC8v55u05pKt6aG16Z2i5bqV6YOo5by55Ye65qCPCiAgICAgICAgY3NzVGV4dCArPSAnLmF0dGVudGlvbl90aXBfd3JhcCB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIC8v5bqV6YOo5rOo5YaML+eZu+W9leaoquadoQogICAgICAgIGNzc1RleHQgKz0gJy5ndWlkYW5jZV9mYyB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIC8vY29udGVudC1hZCBzcGFuCiAgICAgICAgY3NzVGV4dCArPSAnLmNvbnRlbnQtYWQge2Rpc3BsYXk6IG5vbmUgIWltcG9ydGFudDt9JzsKICAgICAgICAvL2hlYWQgYWQgc3BhbgogICAgICAgIGNzc1RleHQgKz0gJy5oZWFkX2FkX3RhZyB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIGNzc1RleHQgKz0gJy5oZWFkX2FkX3BvcCB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIC8v5Lya5ZGY572u6aG2YnViYmxlCiAgICAgICAgY3NzVGV4dCArPSAnI3RiX21lc3NhZ2VfdGlwX2Qge2Rpc3BsYXk6IG5vbmUgIWltcG9ydGFudDt9JzsKICAgICAgICAvL+W6lOeUqOS4reW/g25hdgogICAgICAgIGNzc1RleHQgKz0gJy5hcHBfZm9ydW1fdG9wX25hdiB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIGNzc1RleHQgKz0gJyNqX2NvcmVfdGl0bGVfd3JhcCB7dG9wOjBweCAhaW1wb3J0YW50O30nOwogICAgICAgIC8v6aG25qCP5Lya5ZGYCiAgICAgICAgY3NzVGV4dCArPSAnLnVfbWVtYmVyIHtkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgLy/lr7zoiKrmoI/muLjmiI8KICAgICAgICBjc3NUZXh0ICs9ICcjal9uYXZ0YWJfZ2FtZSB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIC8v5Y+R5biW5qGG5rCU5rOhCiAgICAgICAgY3NzVGV4dCArPSAnLnVpX2J1YmJsZV9ib2R5IHtkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgLy/npLzotZ4KICAgICAgICBjc3NUZXh0ICs9ICcuZ2lmdC1nb2luIHtkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgLy/mvILmtYHnk7YKICAgICAgICBjc3NUZXh0ICs9ICcudGJ1aV9mYmFyX25vYm90dGxlIHtkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgLy/miavmj4/kuIvovb1BUFAKICAgICAgICBjc3NUZXh0ICs9ICcuYXBwX2Rvd25sb2FkX2JveCB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIC8v5p+Q5Liq5Y+z5L6n5rWu5Yqo5bm/5ZGK55qEY2xvc2XmjInpkq4KICAgICAgICBjc3NUZXh0ICs9ICcual9jbGlja19jbG9zZSB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgIC8vNjE4IEJhbm5lcgogICAgICAgIGNzc1RleHQgKz0gJy5zaG93QmFyIHtkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgLy/lj7PkuIrop5LmsJTms6EKICAgICAgICBjc3NUZXh0ICs9ICcudWlfYnViYmxlX2NvbnRlbnQge2Rpc3BsYXk6IG5vbmUgIWltcG9ydGFudH0nOwogICAgICAgIC8vSGFvMTIzCiAgICAgICAgY3NzVGV4dCArPSAnLmpfdV9tZW51X2V4dHJhX3VybF9saW5rIHtkaXNwbGF5OiBub25lICFpbXBvcnRhbnR9JzsKICAgICAgICAvL+Wkp+WutumDveWcqOaQnAogICAgICAgIGNzc1RleHQgKz0gJy5zZWFyY2hfYmFja19ib3gge2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fSc7CiAgICAgICAgLy/kuIvovb1BUFAKICAgICAgICBjc3NUZXh0ICs9ICcudGJ1aV9mYmFyX2Rvd24ge2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fSc7CiAgICAgICAgLy9uYW5pCiAgICAgICAgY3NzVGV4dCArPSAnLm5hbmlfYXBwX2Rvd25sb2FkX2JveCB7ZGlzcGxheTpub25lICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgLy/kvJrlkZjoj5zljZUKICAgICAgICBjc3NUZXh0ICs9ICcudV9tZW51X21lbWJlciB7ZGlzcGxheTpub25lICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgLy/oj5zljZUgKjIwMTgxMDEyCiAgICAgICAgY3NzVGV4dCArPSAnLnVfbXl0Ym1hbGwsLnVfZ2FtZSwudV9ibHVle2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50O30nOwoKICAgICAgICAvL+e+pOe7hOmhtemdouWPs+S+p+S4i+i9vQogICAgICAgIGlmIChncm91cFBhZ2VQcm9jZXNzKXsKICAgICAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5ocmVmLmluZGV4T2YoInRpZWJhLmJhaWR1LmNvbS9ncm91cCIpICE9IC0xKXsKICAgICAgICAgICAgICAgIGNzc1RleHQgKz0gJy5yaWdodCB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvL+S4u+mhteaooeWdl+eyvueugAogICAgICAgIGlmIChob21lUGFnZVByb2Nlc3MpewogICAgICAgICAgICBpZiAoaG9tZVBhZ2VNYXRjaC50ZXN0KHdpbmRvdy5sb2NhdGlvbi5ocmVmKSl7CiAgICAgICAgICAgICAgICAvL+mhtumDqAogICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgIGlmICh1bnNhZmVXaW5kb3cuUGFnZURhdGEudXNlci5pc19sb2dpbiA9PT0gMSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGNzc1RleHQgKz0gJy50b3Atc2VjIHtkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBjYXRjaCAoZSl7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcign6LS05ZCn6aG16Z2i57K+566AOiDnmbvlvZXnirbmgIHmo4Dmn6XplJnor68nKTsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy/nm7Tmkq3np4AKICAgICAgICAgICAgICAgIGNzc1RleHQgKz0gJy5zcGFnZV9saXZlc2hvd19zbGlkZSB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgICAgICAgICAgLy/ku6XkuIvmqKHlnZflm6DkuLrlnKjlj7PkvqfmnInkuIDkuKrkuIvmu5HpobXpnaLml7borqnmqKHlnZfku43nhLbkv53mjIHlnKjlj6/op4bljLrln5/lhoXnmoTorr7orqHvvIzljZXni6znsr7nroDkuIDkuKrkvJrpgKDmiJDmu5rliqjpobXpnaLml7bmqKHlnZfplJnkvY3vvIzmiYDku6Xlhajpg6jnsr7nroAKICAgICAgICAgICAgICAgIC8v5Lmx5LiD5YWr57Of55qE5rua5Yqo5rS75Yqo5qih5Z2XCiAgICAgICAgICAgICAgICBjc3NUZXh0ICs9ICcjcGxhdF9hY3Rfd3JhcHBlciB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgICAgICAgICAgLy/osarlj4vkv7HkuZDpg6gKICAgICAgICAgICAgICAgIGNzc1RleHQgKz0gJy5tZW1iZXJfcmFuayB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgICAgICAgICAgLy/lqpLkvZPov5vpqbsKICAgICAgICAgICAgICAgIGNzc1RleHQgKz0gJyNhZGlkZV9wbGF0Zm9ybSB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgICAgICAgICAgLy/otLTlkKflqLHkuZAKICAgICAgICAgICAgICAgIGNzc1RleHQgKz0gJyNtZWRpYV9pdGVtIHtkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgICAgICAgICAvL+aIkeeahOa4uOaIjwogICAgICAgICAgICAgICAgY3NzVGV4dCArPSAnI3NwYWdlX2dhbWVfdGFiX3dyYXBwZXIge2Rpc3BsYXk6IG5vbmUgIWltcG9ydGFudDt9JzsKICAgICAgICAgICAgICAgIC8v5YWs5ZGK5p2/CiAgICAgICAgICAgICAgICBjc3NUZXh0ICs9ICcjbm90aWNlX2l0ZW0ge2Rpc3BsYXk6IG5vbmUgIWltcG9ydGFudDt9JzsKICAgICAgICAgICAgICAgIC8v6LCD5pW05L2N572uICoyMDE3MTIyMwogICAgICAgICAgICAgICAgY3NzVGV4dCArPSAnLnJpZ2h0LXNlYyB7bWFyZ2luLXRvcDotMTVweCAhaW1wb3J0YW50O30nOwogICAgICAgICAgICAgICAgLy/otLTlkKfnsr7pgInkuJPpopggKjIwMTcxMjIzCiAgICAgICAgICAgICAgICBjc3NUZXh0ICs9ICcuYWdncmVnYXRlX2VudHJhbmNlX3dyYXAge2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50O30nOwogICAgICAgICAgICAgICAgLy/mnKrnmbvlvZXml7bnmoTmu5rliqjmqKrluYUgKjIwMTgwNTA0CiAgICAgICAgICAgICAgICBjc3NUZXh0ICs9ICcjcmVjX2xlZnQge2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50O30gI3JlY19yaWdodHtmbG9hdDpyaWdodDtwb3NpdGlvbjphYnNvbHV0ZTtyaWdodDozMHB4O21hcmdpbi10b3A6MTVweDt9JzsKICAgICAgICAgICAgICAgIC8v55So5oi36Z2i5p2/55qE5LiA5Lqb5Zu+6KGo562JICoyMDE4MTAxMgogICAgICAgICAgICAgICAgY3NzVGV4dCArPSAnLmljb25fdGJ3b3JsZCB7ZGlzcGxheTpub25lICFpbXBvcnRhbnQ7fSAudXNlcl9zY29yZXtkaXNwbGF5Om5vbmUgIWltcG9ydGFudDt9JzsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy/kuKrkurrkuLvpobXnsr7nroAKICAgICAgICBpZiAoaG9tZVByb2Nlc3MpewogICAgICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLmhyZWYuaW5kZXhPZigidGllYmEuYmFpZHUuY29tL2hvbWUiKSAhPT0gLTEpewogICAgICAgICAgICAgICAgLy/lj7PkvqfnpLznianpnaLmnb8KICAgICAgICAgICAgICAgIGNzc1RleHQgKz0gIi5paG9tZS1hc2lkZS1naWZ0LWNlbnRlciB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50fSI7CiAgICAgICAgICAgICAgICAvL+axguWpmuaMiemSrgogICAgICAgICAgICAgICAgY3NzVGV4dCArPSAiLnVzZXJpbmZvLW1hcnJ5IHtkaXNwbGF5OiBub25lICFpbXBvcnRhbnR9IjsKICAgICAgICAgICAgICAgIC8v5oiR55qE5aS65a6dCiAgICAgICAgICAgICAgICBjc3NUZXh0ICs9ICIuaWhvbWUtYXNpZGUtZ3JhYi10cmVhc3VyZSB7ZGlzcGxheTogbm9uZSAhaW1wb3J0YW50fSI7CiAgICAgICAgICAgICAgICAvL+aIkeeahFTosYbjgIHok53pkrsKICAgICAgICAgICAgICAgIGNzc1RleHQgKz0gIi51c2VyaW5mb19zY29yZXMge2Rpc3BsYXk6IG5vbmUgIWltcG9ydGFudH0iOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvL+WIl+ihqOmhteWktOWbvueyvueugAogICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24uaHJlZi5pbmRleE9mKCJ0aWViYS5iYWlkdS5jb20vZiIpICE9PSAtMSl7CiAgICAgICAgICAgIGlmIChpc0hlYWRpbWcpewogICAgICAgICAgICAgICAgY3NzVGV4dCArPSAiLmhlYWRfYmFubmVyX2ltZywuaGVhZF9hZF9wb3AsLmhlYWRfYmFubmVyIHtkaXNwbGF5OiBub25lICFpbXBvcnRhbnR9IjsKICAgICAgICAgICAgICAgIC8v6aG26YOoY3Nz6LCD5pW0ICoyMDE3MTIyMwogICAgICAgICAgICAgICAgY3NzVGV4dCArPSAnLmhlYWRfY29udGVudCB7cGFkZGluZy10b3A6MjBweCAhaW1wb3J0YW50fSc7CiAgICAgICAgICAgICAgICBjc3NUZXh0ICs9ICcuY2FyZF9iYW5uZXIsLnBsYXRfcmVjb21fY2Fyb3VzZWwge2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fSc7CiAgICAgICAgICAgICAgICBjc3NUZXh0ICs9ICcuY2FyZF9oZWFkIHt3aWR0aDo3MHB4ICFpbXBvcnRhbnQ7aGVpZ2h0OjcwcHggIWltcG9ydGFudDttYXJnaW4tYm90dG9tOjEwcHggIWltcG9ydGFudDttYXJnaW4tdG9wOjEwMHB4ICFpbXBvcnRhbnR9JzsKICAgICAgICAgICAgICAgIGNzc1RleHQgKz0gJy5jYXJkX2hlYWRfaW1nIHt3aWR0aDo3MHB4ICFpbXBvcnRhbnQ7aGVpZ2h0OjcwcHggIWltcG9ydGFudDt9JzsKICAgICAgICAgICAgICAgIGNzc1RleHQgKz0gJy5jYXJkX3RpdGxlIHttYXJnaW4tbGVmdDotNTBweCAhaW1wb3J0YW50O30nOwogICAgICAgICAgICAgICAgY3NzVGV4dCArPSAnLmNhcmRfc2xvZ2FuIHttYXJnaW4tbGVmdDotNTBweCAhaW1wb3J0YW50O30nOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvL+iuvue9rumdouadv2NzcwogICAgICAgIGNzc1RleHQgKz0gJyNiYWNrcnVubmVySlNTZXR0aW5nX3Jvb3Qge3JpZ2h0OjAgIWltcG9ydGFudDt9ICNiYWNrcnVubmVySlNTZXR0aW5nX2NvbiB7cmlnaHQ6MCAhaW1wb3J0YW50O3dpZHRoOjIwMHB4IGltcG9ydGFudDt9JzsKICAgICAgICBjc3NUZXh0ICs9ICcjYmFja3J1bm5lckpTU2V0dGluZ19jb24gYSB7ZGlzcGxheTpibG9jayAhaW1wb3J0YW50O3doaXRlLXNwYWNlOm5vd3JhcDsgIWltcG9ydGFudH0nOwogICAgICAgIGNzc1RleHQgKz0gJyNiYWNrcnVubmVySlNTZXR0aW5nX2NvbiBsaSB7bGluZS1oZWlnaHQ6MjNweCAhaW1wb3J0YW50O2Rpc3BsYXk6YmxvY2sgIWltcG9ydGFudDt3aGl0ZS1zcGFjZTpub3dyYXAgIWltcG9ydGFudDt9JzsKICAgICAgICBjc3NUZXh0ICs9ICcjYmFja3J1bm5lckpTU2V0dGluZ19jb24gbGkgYSB7cGFkZGluZy10b3A6MHB4ICFpbXBvcnRhbnQ7cGFkZGluZy1ib3R0b206MHB4ICFpbXBvcnRhbnQ7cGFkZGluZy1yaWdodDoxZW0gIWltcG9ydGFudDtwYWRkaW5nLWxlZnQ6MWVtICFpbXBvcnRhbnQ7bWFyZ2luOjAgIWltcG9ydGFudDtsaW5lLWhlaWdodDoyLjRlbSAhaW1wb3J0YW50O30nOwogICAgICAgIGNzc1RleHQgKz0gJy5zZWFyY2hfbmF2IHttYXJnaW4tcmlnaHQ6NDcwcHggIWltcG9ydGFudDt9JzsKCiAgICAgICAgLy9yZXZlcnNl55u45YWzY3NzICoyMDE3MTIyMwogICAgICAgIGNzc1RleHQgKz0gJy5icl9yZXZlcnNlX2xpIHtkaXNwbGF5OmlubGluZS1ibG9jayAhaW1wb3J0YW50O21hcmdpbi1sZWZ0OjE1cHggIWltcG9ydGFudDttYXJnaW4tdG9wOi0xNHB4ICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgY3NzVGV4dCArPSAnLmNvcmVfdGl0bGVfdHh0IHt3aWR0aDo0MDBweCAhaW1wb3J0YW50O30nOwoKICAgICAgICAvL+W6lemDqOS/oeaBr2NzcwogICAgICAgIGNzc1RleHQgKz0gJyNmb290ZXIge3BhZGRpbmctYm90dG9tOjBweCAhaW1wb3J0YW50O30nOwoKICAgICAgICBjb25zb2xlLmxvZygn6LS05ZCn6aG16Z2i57K+566AOiBjc3PliJvlu7rlrozmiJAnKTsKCiAgICAgICAgdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaW5rJyk7CiAgICAgICAgZWxlbWVudC5yZWw9InN0eWxlc2hlZXQiOwogICAgICAgIGVsZW1lbnQudHlwZT0idGV4dC9jc3MiOwogICAgICAgIGVsZW1lbnQuaHJlZj0nZGF0YTp0ZXh0L2NzcywnK2Nzc1RleHQ7CgogICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hcHBlbmRDaGlsZChlbGVtZW50KTsKCiAgICAgICAgdmFyIG1vZFN0eWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21vZENTUycpOwogICAgICAgIGlmIChtb2RTdHlsZSA9PT0gbnVsbCl7CiAgICAgICAgICAgIG1vZFN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKICAgICAgICAgICAgbW9kU3R5bGUuaWQgPSAnbW9kQ1NTJzsKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtb2RTdHlsZSk7CiAgICAgICAgICAgIG1vZFN0eWxlLmlubmVySFRNTCA9IGNzc1RleHQ7CiAgICAgICAgfQogICAgICAgIGNvbnNvbGUubG9nKCfotLTlkKfpobXpnaLnsr7nroA6IGNzc+W3sua3u+WKoCcpOwogICAgfQogICAgLy/liJfooajnv7vpobXnm5HlkKwKICAgIGZ1bmN0aW9uIGFkZExpc3RlbmVyVG9MaXN0KCl7CiAgICAgICAgJCgnI2Zyc19saXN0X3BhZ2VyIGEnKS5lYWNoKGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLGxpc3RQYWdlVHVybkV2ZW50KTsKICAgICAgICB9KTsKICAgICAgICBjb25zb2xlLmxvZygn6LS05ZCn6aG16Z2i57K+566AOiDliJfooajnv7vpobXnm5HlkKzmt7vliqDlrozmr5UnKTsKICAgIH0KICAgIC8v5biW5a2Q44CB57K+5ZOB57+76aG155uR5ZCsCiAgICBmdW5jdGlvbiBhZGRMaXN0ZW5lclRvTmF2KCl7CiAgICAgICAgJCgnLm5hdl9saXN0IGxpJykuZWFjaChmdW5jdGlvbigpewogICAgICAgICAgICBpZih0aGlzLmF0dHJpYnV0ZXNbJ2RhdGEtdGFiLW1haW4nXSB8fCB0aGlzLmF0dHJpYnV0ZXNbJ2RhdGEtdGFiLWdvb2QnXSl7CiAgICAgICAgICAgICAgICB0aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdhJylbMF0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLGxpc3RQYWdlVHVybkV2ZW50KTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfQogICAgLy/liJfooajnv7vpobXnm5HlkKzkuovku7YKICAgIGZ1bmN0aW9uIGxpc3RQYWdlVHVybkV2ZW50KCl7CiAgICAgICAgY29uc29sZS53YXJuKCfotLTlkKfpobXpnaLnsr7nroA6IOWIl+ihqOe/u+mhteS6i+S7tuinpuWPkScpOwogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXsKICAgICAgICAgICAgdmFyIGludGVydmFsID0gc2V0SW50ZXJ2YWwoY2hlY2ssc2xlZXBUaW1lV2hlblBhZ2VUdXJuICogY2hlY2tyYXRlKTsKICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2soKXsKICAgICAgICAgICAgICAgIGFkZExpc3RlbmVyVG9OYXYoKTsKICAgICAgICAgICAgICAgIGFkZExpc3RlbmVyVG9MaXN0KCk7CiAgICAgICAgICAgICAgICBhZGluTGlzdENsZWFuKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpewogICAgICAgICAgICAgICAgYWRkTGlzdGVuZXJUb05hdigpOwogICAgICAgICAgICAgICAgYWRkTGlzdGVuZXJUb0xpc3QoKTsKICAgICAgICAgICAgICAgIGFkaW5MaXN0Q2xlYW4oKTsKICAgICAgICAgICAgfSxzbGVlcFRpbWUpOwogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICBhZGRMaXN0ZW5lclRvTmF2KCk7CiAgICAgICAgICAgICAgICBhZGRMaXN0ZW5lclRvTGlzdCgpOwogICAgICAgICAgICAgICAgYWRpbkxpc3RDbGVhbigpOwogICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7CiAgICAgICAgICAgIH0sZmluaXNoVGltZS8zKTsKICAgICAgICB9LHNsZWVwVGltZVdoZW5QYWdlVHVybik7CiAgICB9CiAgICBmdW5jdGlvbiBhZGRMaXN0ZW5lclRvUGFnZSgpewogICAgICAgICQoJy5sX3BhZ2VyIGEnKS5lYWNoKGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLHBhZ2VUdXJuRXZlbnQpOwogICAgICAgIH0pOwogICAgICAgIGNvbnNvbGUubG9nKCfotLTlkKfpobXpnaLnsr7nroA6IOW4luWtkOe/u+mhteebkeWQrOa3u+WKoOWujOavlScpOwogICAgfQogICAgZnVuY3Rpb24gcGFnZVR1cm5FdmVudCgpewogICAgICAgIGNvbnNvbGUud2Fybign6LS05ZCn6aG16Z2i57K+566AOiDluJblrZDnv7vpobXkuovku7bop6blj5EnKTsKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHZhciBpbnRlcnZhbCA9IHNldEludGVydmFsKGNoZWNrLHNsZWVwVGltZVdoZW5QYWdlVHVybiAqIGNoZWNrcmF0ZSk7CiAgICAgICAgICAgIGZ1bmN0aW9uIGNoZWNrKCl7CiAgICAgICAgICAgICAgICBhZGRMaXN0ZW5lclRvTmF2KCk7CiAgICAgICAgICAgICAgICBhZGRMaXN0ZW5lclRvUGFnZSgpOwogICAgICAgICAgICAgICAgYWRpblBhZ2VDbGVhbigpOwogICAgICAgICAgICAgICAgdHBvaW50QURDbGVhbigpOwogICAgICAgICAgICAgICAgcmV2ZXJzZW9yZGVyKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpewogICAgICAgICAgICAgICAgYWRkTGlzdGVuZXJUb05hdigpOwogICAgICAgICAgICAgICAgYWRkTGlzdGVuZXJUb1BhZ2UoKTsKICAgICAgICAgICAgICAgIGFkaW5QYWdlQ2xlYW4oKTsKICAgICAgICAgICAgICAgIHRwb2ludEFEQ2xlYW4oKTsKICAgICAgICAgICAgICAgIHJldmVyc2VvcmRlcigpOwogICAgICAgICAgICB9LHNsZWVwVGltZSk7CiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgIGFkZExpc3RlbmVyVG9OYXYoKTsKICAgICAgICAgICAgICAgIGFkZExpc3RlbmVyVG9QYWdlKCk7CiAgICAgICAgICAgICAgICBhZGluUGFnZUNsZWFuKCk7CiAgICAgICAgICAgICAgICB0cG9pbnRBRENsZWFuKCk7CiAgICAgICAgICAgICAgICByZXZlcnNlb3JkZXIoKTsKICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpOwogICAgICAgICAgICB9LGZpbmlzaFRpbWUvMyk7CiAgICAgICAgfSxzbGVlcFRpbWVXaGVuUGFnZVR1cm4pOwogICAgfQogICAgLy/op6bngrnmjqjlub8KICAgIGZ1bmN0aW9uIHRwb2ludEFEQ2xlYW4oKXsKICAgICAgICBjb25zb2xlLmxvZygn6LS05ZCn6aG16Z2i57K+566AOiDlvIDlp4vnsr7nroDop6bngrnmjqjlub8nKTsKICAgICAgICB2YXIgcG9pbnRhZCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3Rwb2ludC1pbWdzJyk7CiAgICAgICAgY29uc29sZS5sb2coJ+i0tOWQp+mhtemdoueyvueugDog5oqT5Y+W5Yiw55qE5bm/5ZGK5YWD57Sg5pWw6YePOiAnK3BvaW50YWQubGVuZ3RoKTsKICAgICAgICBmb3IodmFyIGk9MDtpPHBvaW50YWQubGVuZ3RoO2krKyl7CiAgICAgICAgICAgIHBvaW50YWRbaV0ucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQocG9pbnRhZFtpXS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUpOwogICAgICAgIH0KICAgICAgICBjb25zb2xlLmxvZygn6LS05ZCn6aG16Z2i57K+566AOiDop6bngrnmjqjlub/nsr7nroDlrozmr5UnKTsKICAgIH0KCiAgICAvL+WIl+ihqOWGheW5v+WRigogICAgZnVuY3Rpb24gYWRpbkxpc3RDbGVhbigpewogICAgICAgIGNvbnNvbGUubG9nKCfotLTlkKfpobXpnaLnsr7nroA6IOW8gOWni+eyvueugOWIl+ihqOWGheW5v+WRiicpOwogICAgICAgIHZhciBhZGluTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3RocmVhZGxpc3RfcmVwX251bScpOwogICAgICAgIHZhciBudW0gPSAwOwogICAgICAgIGNvbnNvbGUubG9nKCfotLTlkKfpobXpnaLnsr7nroA6IOWIl+ihqOWGheWFg+e0oOaKk+WPlumHjzogJythZGluTGlzdC5sZW5ndGgpOwogICAgICAgIGZvciAodmFyIGk9MDtpPGFkaW5MaXN0Lmxlbmd0aDtpKyspewogICAgICAgICAgICBpZiAoYWRpbkxpc3RbaV0udGl0bGUgPT09ICLlub/lkYoiIHx8IGFkaW5MaXN0W2ldLnRpdGxlID09PSAi54Ot6ZeoIil7CiAgICAgICAgICAgICAgICBudW0rKzsKICAgICAgICAgICAgICAgIGFkaW5MaXN0W2ldLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYWRpbkxpc3RbaV0ucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNvbnNvbGUubG9nKCfotLTlkKfpobXpnaLnsr7nroA6IOWIl+ihqOWGheW5v+WRiueyvueugOWujOavle+8jOWFseeyvueugCAnKyBudW0gKyAnIOS4qicpOwogICAgICAgIC8v5paw5aKe5qC55o2uY2xhc3Pov4fmu6QKICAgICAgICB2YXIgbGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aHJlYWRfbGlzdCcpLmNoaWxkcmVuOwogICAgICAgIGZvciAoaT0wO2k8bGlzdC5sZW5ndGg7aSsrKXsKICAgICAgICAgICAgdmFyIGNsYXNzTmFtZT1saXN0W2ldLmdldEF0dHJpYnV0ZSgnY2xhc3MnKTsKICAgICAgICAgICAgaWYgKGNsYXNzTmFtZSAhPSBudWxsKXsKICAgICAgICAgICAgICAgIGlmIChsaXN0W2ldLmdldEF0dHJpYnV0ZSgnY2xhc3MnKS5pbmRleE9mKCd0aHJlYWRfdG9wX2xpc3RfZm9sZGVyJyk9PS0xICYmIGxpc3RbaV0uZ2V0QXR0cmlidXRlKCdjbGFzcycpLmluZGV4T2YoJ2pfdGhyZWFkX2xpc3QnKT09LTEpewogICAgICAgICAgICAgICAgICAgIGxpc3RbaV0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChsaXN0W2ldKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb25zb2xlLmxvZygn6LS05ZCn6aG16Z2i57K+566AOiDmiavmj4/liJfooajnsr7nroDlhbbku5blub/lkYonKTsKICAgICAgICAvL+a4heeQhuaXoOeUqHRhYiAqMjAxODEwMTIKICAgICAgICB2YXIgdGFicyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImpfdGJuYXZfdGFiX2EiKTsKICAgICAgICBmb3IgKGk9MDtpPHRhYnMubGVuZ3RoO2krKyl7CiAgICAgICAgICAgIGlmICh0YWJzW2ldLmlubmVySFRNTC5pbmRleE9mKCLnm7Tmkq0iKSAhPSAtMSl7CiAgICAgICAgICAgICAgICB0YWJzW2ldLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGFic1tpXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHRhYnNbaV0uaW5uZXJIVE1MLmluZGV4T2YoIuW6lOeUqCIpICE9IC0xKXsKICAgICAgICAgICAgICAgIHRhYnNbaV0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0YWJzW2ldKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvL+i0tOWGheW5v+WRigogICAgZnVuY3Rpb24gYWRpblBhZ2VDbGVhbigpewogICAgICAgIGNvbnNvbGUubG9nKCfotLTlkKfpobXpnaLnsr7nroA6IOW8gOWni+eyvueugOi0tOWGheW5v+WRiicpOwogICAgICAgIHZhciBhZCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2lmcmFtZV93cmFwcGVyJyk7CiAgICAgICAgY29uc29sZS5sb2coJ+i0tOWQp+mhtemdoueyvueugDog5oqT5Y+W5Yiw55qE5bm/5ZGK5YWD57Sg5pWw6YePOiAnK2FkLmxlbmd0aCk7CiAgICAgICAgZm9yKHZhciBpPTA7aTxhZC5sZW5ndGg7aSsrKXsKICAgICAgICAgICAgYWRbaV0ucGFyZW50Tm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGFkW2ldLnBhcmVudE5vZGUpOwogICAgICAgIH0KICAgICAgICBjb25zb2xlLmxvZygn6LS05ZCn6aG16Z2i57K+566AOiDotLTlhoXlub/lkYrnsr7nroDlrozmr5UnKTsKICAgICAgICAvL+i0tOWGheaPkuWFpeW5v+WRigogICAgICAgIHZhciBwbHVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZF9uYW1lJyk7CiAgICAgICAgZm9yIChpPTA7aTxwbHVzLmxlbmd0aDtpKyspewogICAgICAgICAgICB2YXIgZGF0ID0gcGx1c1tpXS5nZXRBdHRyaWJ1dGUoJ2RhdGEtZmllbGQnKTsKICAgICAgICAgICAgaWYoIWRhdCB8fCAhZGF0LnJlcGxhY2UoL1xzL2csJycpKXsKICAgICAgICAgICAgICAgIHBsdXNbaV0ucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChwbHVzW2ldLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvL+WFjeeZu+W9leeci+W4lgogICAgZnVuY3Rpb24gbm9Mb2dpbigpewogICAgICAgIHRyeXsKICAgICAgICAgICAgdmFyIGxvZ2luID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7CiAgICAgICAgICAgIGxvZ2luLmlubmVySFRNTD0iUGFnZURhdGEudXNlci5pc19sb2dpbiA9IHRydWUiOwogICAgICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGxvZ2luKTsKICAgICAgICB9IGNhdGNoKGUpewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCfotLTlkKfpobXpnaLnsr7nroA6IOWFjeeZu+W9leeci+W4luWKoOi9vemUmeivrycpOwogICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpOwogICAgICAgIH0KICAgIH0KCiAgICAvL+abtOaWsOaPkOmGkgogICAgZnVuY3Rpb24gdXBkYXRlQWxlcnQoKXsKICAgICAgICB2YXIgc191cGRhdGUgPSAi6LS05ZCn6aG16Z2i57K+566A77yaXG7mo4DmtYvliLDohJrmnKzniYjmnKzmm7TmlLlcblxuIjsKICAgICAgICB2YXIgdmVyc2lvbiA9IEdNX2dldFZhbHVlKCJ2ZXJzaW9uIik7CiAgICAgICAgaWYgKHZlcnNpb24gIT09IEdNX2luZm8uc2NyaXB0LnZlcnNpb24pewogICAgICAgICAgICBjb25zb2xlLndhcm4oIui0tOWQp+mhtemdoueyvueugO+8muajgOa1i+WIsOiEmuacrOeJiOacrOabtOaUue+8miIgKyB2ZXJzaW9uICsgIiDihpIgIiArIEdNX2luZm8uc2NyaXB0LnZlcnNpb24pOwogICAgICAgICAgICBpZiAodmVyc2lvbiA9PT0gdW5kZWZpbmVkKXsKICAgICAgICAgICAgICAgIHZlcnNpb24gPSAi5pyq55+lIjsKICAgICAgICAgICAgfQogICAgICAgICAgICBzd2l0Y2ggKHZlcnNpb24pewogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAvL+eJiOacrOabtOaWsOaXtuWIoOmZpOW6n+W8g+WPmOmHjwogICAgICAgICAgICAgICAgICAgIGRlbGV0ZVRyYXNoVmFsdWUoKTsKICAgICAgICAgICAgICAgICAgICBzX3VwZGF0ZSArPSAi54mI5pys5bey5LuOICIgKyB2ZXJzaW9uICsgIiDmm7TmlrDkuLogIiArIEdNX2luZm8uc2NyaXB0LnZlcnNpb24gKyAiXG5cbiIgKyBHTV9pbmZvLnNjcmlwdC52ZXJzaW9uICsgIueJiOacrOeahOabtOaWsOWGheWuueS4uu+8mlxu5L+u5aSN5a+55paw54mIQ2hyb21l55qE5YW85a655oCn6Zeu6aKY44CCXG5cbuWmguaenOmBh+WIsEJ1Z+ivt+WPiuaXtuaPkOS6pOWPjemmiO+8jOaEn+iwouOAglxuXG7jgJDph43opoHmj5DphpLvvIHlv4XnnIvvvIHjgJFcbuWmguaenOaCqOayoeacieWuieijhUFkYmxvY2vvvIzor7flronoo4VBZGJsb2Nr5Lul6I635b6X5pyA5L2z5L2T6aqMXG5cbueUseS6jui/meS4quiEmuacrOW3sue7j+avlOi+g+eos+Wumu+8jOWQjue7reWPquS/ruWkjUJ1Z+WSjOagueaNrui0tOWQp+eahOWPmOWMlua3u+ihpeaWsOWKn+iDvVxuIjsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgIuacquefpSI6CiAgICAgICAgICAgICAgICAgICAgc191cGRhdGUgKz0gIuasoui/juS9v+eUqOi0tOWQp+mhtemdoueyvueugOiEmuacrFxu5oKo5b2T5YmN55qE6ISa5pys54mI5pys5Li677yaICIgKyB2ZXJzaW9uICsgIlxuXG7jgJDlhbPkuo7orr7nva7jgJFcbuaCqOWPr+S7pemAmui/h+WPs+S4iuinkueahOiuvue9rumdouadv+iuvue9ruebuOWFs+WKn+iDveS7peiOt+W+l+acgOS9s+S9k+mqjFxuXG7jgJDph43opoHmj5DphpLvvIHlv4XnnIvvvIHjgJFcbuWmguaenOaCqOayoeacieWuieijhUFkYmxvY2vvvIzor7flronoo4VBZGJsb2Nr5Lul6I635b6X5pyA5L2z5L2T6aqMXG5cbueUseS6jui/meS4quiEmuacrOW3sue7j+avlOi+g+eos+Wumu+8jOWQjue7reWPquS/ruWkjUJ1Z+WSjOagueaNrui0tOWQp+eahOWPmOWMlua3u+ihpeaWsOWKn+iDvVxuIjsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgIjIuOC4wIjoKICAgICAgICAgICAgICAgICAgICBzX3VwZGF0ZSArPSAi54mI5pys5bey5LuOICIgKyB2ZXJzaW9uICsgIiDpmY3nuqfkuLogIiArIEdNX2luZm8uc2NyaXB0LnZlcnNpb24gKyAiXG5cbiIgKyAi5bu66K6u5L2/55So5pyA5paw54mI5pys55qE6ISa5pys5Lul6I635b6X5pyA5L2z5L2T6aqMXG7pmY3nuqfkvJrpgKDmiJDmgqjnmoTorr7nva7kuKLlpLHvvIzor7fmo4Dmn6XmgqjnmoTorr7nva5cbiI7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc191cGRhdGUgKz0gIlxu6YGH5Yiw5Lu75L2V6Zeu6aKY6K+356uL5Yi75YiwR3JlYXN5Rm9ya+WPjemmiFxu5oiW6ICF5Y+R6YCB6YKu5Lu26IezZGV2QGJhY2tydW5uZXIudG9wXG7lpoLmnpzmgqjop4nlvpfmnKzohJrmnKzlpb3nlKjlj6/kvb/nlKjmlK/ku5jlrp3miavmj49HcmVhc3lGb3Jr5Lit55qE5LqM57u056CB5oiW5bqV6YOo6LWe5Yqp6ZO+5o6l5Lit55qE5LqM57u056CB5ZCR5oiR5o2Q6LWgXG7mlLbliLDmgqjnmoTmjZDotaDlkI7miJHkvJrlsIbmgqjnmoRpZOWKoOWFpeWIsOaEn+iwouWQjeWNlVxu5oSf6LCi5ZCN5Y2V5pi+56S65Zyo6L+Z6YeM5ZKM6ISa5pys5o+P6L+w5YaFIjsKICAgICAgICAgICAgYWxlcnQoc191cGRhdGUpOwogICAgICAgICAgICBHTV9zZXRWYWx1ZSgidmVyc2lvbiIsR01faW5mby5zY3JpcHQudmVyc2lvbik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS53YXJuKCLotLTlkKfpobXpnaLnsr7nroDvvJrmnKrmo4DmtYvliLDohJrmnKzniYjmnKzmm7TmlLkiKTsKICAgICAgICB9CiAgICB9CiAgICAvL+WIm+W7uumhtuagj+aOp+WItumdouadvwogICAgZnVuY3Rpb24gY3JlYXRlQ29udHJvbFBhbmVsKCl7CiAgICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNiYWNrcnVubmVySlNTZXR0aW5nX3Jvb3QnKSA9PT0gbnVsbCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIC8vdXNlcmJhcuiOt+WPluS4juS4u+WxguWIm+W7ugogICAgICAgICAgICAgICAgdmFyIHVzZXJiYXIgPSAkKCcjY29tX3VzZXJiYXInKS5jaGlsZHJlbigndWwnKVswXTsKICAgICAgICAgICAgICAgIHZhciBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7CiAgICAgICAgICAgICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICB2YXIgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKCiAgICAgICAgICAgICAgICAvL+S4u+Wxguiuvue9rgogICAgICAgICAgICAgICAgYS5pbm5lckhUTUwgPSAi6ISa5pys6K6+572uIjsKCiAgICAgICAgICAgICAgICAvL+S4u+WxguS6i+S7tgogICAgICAgICAgICAgICAgZGl2LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLGNwT25Nb3VzZUVudGVyKTsKICAgICAgICAgICAgICAgIGRpdi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJyxjcE9uTW91c2VMZWF2ZSk7CgogICAgICAgICAgICAgICAgLy/oj5zljZXlsYLliJvlu7oKICAgICAgICAgICAgICAgIHZhciBtZW51cm9vdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgdmFyIG1lbnVjb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgIHZhciBtZW51ZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICBtZW51cm9vdC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywndV9kZGwnKTsKICAgICAgICAgICAgICAgIG1lbnVyb290LnNldEF0dHJpYnV0ZSgnaWQnLCdiYWNrcnVubmVySlNTZXR0aW5nX3Jvb3QnKTsKICAgICAgICAgICAgICAgIG1lbnVjb24uc2V0QXR0cmlidXRlKCdjbGFzcycsJ3VfZGRsX2NvbicpOwogICAgICAgICAgICAgICAgbWVudWNvbi5zZXRBdHRyaWJ1dGUoJ2lkJywnYmFja3J1bm5lckpTU2V0dGluZ19jb24nKTsKICAgICAgICAgICAgICAgIG1lbnVkaXYuc2V0QXR0cmlidXRlKCdjbGFzcycsJ3VfZGRsX2Nvbl90b3AnKTsKICAgICAgICAgICAgICAgIG1lbnVkaXYuc2V0QXR0cmlidXRlKCdpZCcsJ2JhY2tydW5uZXJKU1NldHRpbmdfbWFpbicpOwogICAgICAgICAgICAgICAgbWVudWNvbi5hcHBlbmRDaGlsZChtZW51ZGl2KTsKICAgICAgICAgICAgICAgIG1lbnVyb290LmFwcGVuZENoaWxkKG1lbnVjb24pOwoKICAgICAgICAgICAgICAgIC8v6I+c5Y2V5bGC5LqL5Lu2CiAgICAgICAgICAgICAgICBtZW51cm9vdC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJyxjcE9uTW91c2VFbnRlcik7CiAgICAgICAgICAgICAgICBtZW51cm9vdC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJyxjcE9uTW91c2VMZWF2ZSk7CgogICAgICAgICAgICAgICAgLy/oj5zljZXliJfooajliJvlu7oKICAgICAgICAgICAgICAgIHZhciBtZW51ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWknKTsKICAgICAgICAgICAgICAgIC8vMDrmlofmnKzmoYYgMTrlpI3pgInmoYYgMjrmjInpkq4KICAgICAgICAgICAgICAgIGNyZWF0ZU1lbnVJdGVtKG1lbnUsMSwicG9zdHByb2Nlc3MiLCLlkI7lpITnkIbohJrmnKwiLCIiKTsKICAgICAgICAgICAgICAgIGNyZWF0ZU1lbnVJdGVtKG1lbnUsMSwiaXNSZWRpcmVjdCIsIumHjeWumuWQkSIsIiIpOwogICAgICAgICAgICAgICAgY3JlYXRlTWVudUl0ZW0obWVudSwxLCJob21lcGFnZXByb2Nlc3MiLCLkuLvpobXnsr7nroAiLCIiKTsKICAgICAgICAgICAgICAgIGNyZWF0ZU1lbnVJdGVtKG1lbnUsMSwiaXNIZWFkaW1nIiwi57K+566A5YiX6KGo6aG15aS05Zu+IiwiIik7CiAgICAgICAgICAgICAgICBjcmVhdGVNZW51SXRlbShtZW51LDEsImRpc3BsYXlMaXZlIiwi5piv5ZCm5pi+56S655u05pKt5biWIiwiIik7CiAgICAgICAgICAgICAgICBjcmVhdGVNZW51SXRlbShtZW51LDEsImRpc3BsYXlTaWduIiwi5piv5ZCm5pi+56S655So5oi3562+5ZCN5qGjIiwiIik7CiAgICAgICAgICAgICAgICBjcmVhdGVNZW51SXRlbShtZW51LDEsImF1dG9DbG9zZUd1aWRlIiwi6Ieq5Yqo5pS26LW35oyH5byVIiwiIik7CiAgICAgICAgICAgICAgICBjcmVhdGVNZW51SXRlbShtZW51LDEsImhvbWVQcm9jZXNzIiwi5Liq5Lq65Li76aG157K+566AIiwiIik7CiAgICAgICAgICAgICAgICBjcmVhdGVNZW51SXRlbShtZW51LDEsImdyb3VwcHJvY2VzcyIsIue+pOe7hOmhtemdoueyvueugCIsIiIpOwogICAgICAgICAgICAgICAgY3JlYXRlTWVudUl0ZW0obWVudSwxLCJub2xvZ2luIiwi5YWN55m75b2V55yL5biWIiwiIik7CiAgICAgICAgICAgICAgICBjcmVhdGVNZW51SXRlbShtZW51LDEsInJldmVyc2UiLCLlgJLluo/nnIvluJbvvIjlrp7pqozmgKfvvIkiLCIiKTsKICAgICAgICAgICAgICAgIGNyZWF0ZU1lbnVJdGVtKG1lbnUsMCwic2xlZXBUaW1lIiwi5Li76ISa5pys5bu26L+f5pe26Ze0Iik7CiAgICAgICAgICAgICAgICBjcmVhdGVNZW51SXRlbShtZW51LDAsImRlbGF5U2NyaXB0UnVuVGltZXMiLCLlu7bov5/ohJrmnKzmiafooYzmrKHmlbAiLCIiKTsKICAgICAgICAgICAgICAgIGNyZWF0ZU1lbnVJdGVtKG1lbnUsMCwic2xlZXBUaW1lUGFnZSIsIue/u+mhteiEmuacrOW7tui/n+aXtumXtCIsIiIpOwogICAgICAgICAgICAgICAgY3JlYXRlTWVudUl0ZW0obWVudSwwLCJyZXZlcnNlU2xlZXBUaW1lIiwi5YCS5bqP5p+l55yL6ISa5pys5bu26L+f5pe26Ze0IiwiIik7CiAgICAgICAgICAgICAgICBjcmVhdGVNZW51SXRlbShtZW51LDAsImNoZWNrcmF0ZSIsIuiEmuacrOW7tui/n+aXtumXtOWAjeeOhyIsIiIpOwogICAgICAgICAgICAgICAgY3JlYXRlTWVudUl0ZW0obWVudSwyLCJyZWZyZXNoIiwi5Yi35paw6aG16Z2iIiwi5Yi35pawIik7CiAgICAgICAgICAgICAgICBjcmVhdGVNZW51SXRlbShtZW51LDIsInN1Ym1pdCIsIuaPkOS6pOiuvue9riIsIuaPkOS6pCIpOwogICAgICAgICAgICAgICAgY3JlYXRlTWVudUl0ZW0obWVudSwyLCJyZXNldCIsIumHjee9ruiuvue9riIsIumHjee9riIpOwogICAgICAgICAgICAgICAgbWVudWRpdi5hcHBlbmRDaGlsZChtZW51KTsKCiAgICAgICAgICAgICAgICAvL+iPnOWNleWFpeWPowogICAgICAgICAgICAgICAgZGl2LmFwcGVuZENoaWxkKGEpOwogICAgICAgICAgICAgICAgZGl2LnNldEF0dHJpYnV0ZSgnY2xhc3MnLCd1X21lbnVfaXRlbScpOwogICAgICAgICAgICAgICAgZGl2LnNldEF0dHJpYnV0ZSgnaWQnLCdiYWNrcnVubmVySlNTZXR0aW5nX2l0ZW0nKTsKICAgICAgICAgICAgICAgIGxpLmFwcGVuZENoaWxkKGRpdik7CiAgICAgICAgICAgICAgICBsaS5hcHBlbmRDaGlsZChtZW51cm9vdCk7CiAgICAgICAgICAgICAgICB1c2VyYmFyLmFwcGVuZENoaWxkKGxpKTsKCiAgICAgICAgICAgICAgICAvL+iPnOWNleWGheWuueWIneWni+WMlgogICAgICAgICAgICAgICAgbWVudUluaXRpYWxpemUoKTsKCiAgICAgICAgICAgICAgICAvL+iPnOWNleWGheS6i+S7tuWIm+W7ugogICAgICAgICAgICAgICAgY3JlYXRlTWVudUV2ZW50KCk7CiAgICAgICAgICAgIH0gY2F0Y2goZSl7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS53YXJuKCfotLTlkKfpobXpnaLnsr7nroA6IOaOp+WItumdouadv+W3suWtmOWcqCcpOwogICAgICAgIH0KICAgIH0KICAgIC8v6I+c5Y2V6aG55Yib5bu6CiAgICBmdW5jdGlvbiBjcmVhdGVNZW51SXRlbShtZW51LHR5cGUsaWQsbGFiZWxDb250ZW50LGlubmVyQ29udGVudCl7CiAgICAgICAgLy/lsYLliJvlu7oKICAgICAgICB2YXIgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpOwogICAgICAgIHZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICB2YXIgZF9hID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgdmFyIGRfaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIC8v5bGC6K6+572uCiAgICAgICAgZF9hLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCdmbG9hdDpsZWZ0O3dpZHRoOjE1MHB4Jyk7CiAgICAgICAgc3dpdGNoKHR5cGUpewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBkX2kuc2V0QXR0cmlidXRlKCdzdHlsZScsJ3BhZGRpbmctdG9wOjdweDtwYWRkaW5nLWxlZnQ6MTUwcHg7cGFkZGluZy1yaWdodDoxMHB4OycpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgIGRfaS5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywncGFkZGluZy10b3A6OHB4O3BhZGRpbmctbGVmdDoxOTJweDtwYWRkaW5nLXJpZ2h0OjEwcHg7Jyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgZF9pLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCdwYWRkaW5nLXRvcDo2cHg7cGFkZGluZy1sZWZ0OjE1MHB4O3BhZGRpbmctcmlnaHQ6MTBweDsnKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICAvL+WFg+e0oOWIm+W7ugogICAgICAgIHZhciBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgICAgIHZhciBpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsKICAgICAgICAvL+WFg+e0oOiuvue9rgogICAgICAgIGEuaW5uZXJIVE1MID0gbGFiZWxDb250ZW50OwogICAgICAgIHN3aXRjaCh0eXBlKXsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaS5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywnd2lkdGg6NTBweDt0ZXh0LWFsaWduOnJpZ2h0Jyk7CiAgICAgICAgICAgICAgICBpLnNldEF0dHJpYnV0ZSgnaWQnLCdiYWNrcnVubmVyX2lfJytpZCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgLy/lpI3pgInmoYYKICAgICAgICAgICAgICAgIGkuc2V0QXR0cmlidXRlKCd0eXBlJywnY2hlY2tib3gnKTsKICAgICAgICAgICAgICAgIGkuc2V0QXR0cmlidXRlKCdpZCcsJ2JhY2tydW5uZXJfaV8nK2lkKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAvL+aMiemSrgogICAgICAgICAgICAgICAgaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICAgICAgICAgICAgaS5pbm5lckhUTUwgPSBpbm5lckNvbnRlbnQ7CiAgICAgICAgICAgICAgICBpLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCd3aWR0aDo1MnB4Jyk7CiAgICAgICAgICAgICAgICBpLnNldEF0dHJpYnV0ZSgnaWQnLCdiYWNrcnVubmVyX2J0bl8nK2lkKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgLy/lhYPntKDmt7vliqDliLDlsYIKICAgICAgICBkX2EuYXBwZW5kQ2hpbGQoYSk7CiAgICAgICAgZF9pLmFwcGVuZENoaWxkKGkpOwogICAgICAgIC8v5YWD57Sg5bGC5re75Yqg5Yiw5Li75bGCCiAgICAgICAgZGl2LmFwcGVuZENoaWxkKGRfYSk7CiAgICAgICAgZGl2LmFwcGVuZENoaWxkKGRfaSk7CiAgICAgICAgLy/kuLvlsYLmt7vliqDliLBsaQogICAgICAgIGxpLmFwcGVuZENoaWxkKGRpdik7CiAgICAgICAgLy9saea3u+WKoOWIsG1lbnUKICAgICAgICBtZW51LmFwcGVuZENoaWxkKGxpKTsKICAgIH0KICAgIC8v6I+c5Y2V5Yid5aeL5YyWCiAgICBmdW5jdGlvbiBtZW51SW5pdGlhbGl6ZSgpewogICAgICAgIG1lbnVJbml0aWFsaXplX2NoZWNrYm94KCdwb3N0cHJvY2VzcycscG9zdHByb2Nlc3MpOwogICAgICAgIG1lbnVJbml0aWFsaXplX2NoZWNrYm94KCdpc1JlZGlyZWN0Jyxpc1JlZGlyZWN0KTsKICAgICAgICBtZW51SW5pdGlhbGl6ZV9jaGVja2JveCgnaG9tZXBhZ2Vwcm9jZXNzJyxob21lUGFnZVByb2Nlc3MpOwogICAgICAgIG1lbnVJbml0aWFsaXplX2NoZWNrYm94KCdob21lUHJvY2VzcycsaG9tZVByb2Nlc3MpOwogICAgICAgIG1lbnVJbml0aWFsaXplX2NoZWNrYm94KCdpc0hlYWRpbWcnLGlzSGVhZGltZyk7CiAgICAgICAgbWVudUluaXRpYWxpemVfY2hlY2tib3goJ2dyb3VwcHJvY2VzcycsZ3JvdXBQYWdlUHJvY2Vzcyk7CiAgICAgICAgbWVudUluaXRpYWxpemVfY2hlY2tib3goJ25vbG9naW4nLG5vTG9naW5Qcm9jZXNzKTsKICAgICAgICBtZW51SW5pdGlhbGl6ZV9jaGVja2JveCgncmV2ZXJzZScscmV2ZXJzZSk7CiAgICAgICAgbWVudUluaXRpYWxpemVfY2hlY2tib3goJ2Rpc3BsYXlMaXZlJyxkaXNwbGF5TGl2ZSk7CiAgICAgICAgbWVudUluaXRpYWxpemVfY2hlY2tib3goJ2Rpc3BsYXlTaWduJyxkaXNwbGF5U2lnbik7CiAgICAgICAgbWVudUluaXRpYWxpemVfY2hlY2tib3goJ2F1dG9DbG9zZUd1aWRlJyxhdXRvQ2xvc2VHdWlkZSk7CiAgICAgICAgbWVudUluaXRpYWxpemVfaW5wdXQoJ3NsZWVwVGltZScsc2xlZXBUaW1lKTsKICAgICAgICBtZW51SW5pdGlhbGl6ZV9pbnB1dCgnZGVsYXlTY3JpcHRSdW5UaW1lcycsZGVsYXlTY3JpcHRSdW5UaW1lcyk7CiAgICAgICAgbWVudUluaXRpYWxpemVfaW5wdXQoJ3NsZWVwVGltZVBhZ2UnLHNsZWVwVGltZVdoZW5QYWdlVHVybik7CiAgICAgICAgbWVudUluaXRpYWxpemVfaW5wdXQoJ3JldmVyc2VTbGVlcFRpbWUnLHJldmVyc2VTbGVlcFRpbWUpOwogICAgICAgIG1lbnVJbml0aWFsaXplX2lucHV0KCdjaGVja3JhdGUnLGNoZWNrcmF0ZSk7CiAgICB9CiAgICAvL+iPnOWNlWNoZWNrYm945Yid5aeL5YyWCiAgICBmdW5jdGlvbiBtZW51SW5pdGlhbGl6ZV9jaGVja2JveChpZCx2YXJpYWJsZSl7CiAgICAgICAgdmFyIGkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmFja3J1bm5lcl9pXycraWQpOwogICAgICAgIGlmIChpICE9PSBudWxsKXsKICAgICAgICAgICAgaWYgKHZhcmlhYmxlKXsKICAgICAgICAgICAgICAgIGkuY2hlY2tlZCA9IHRydWU7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpLmNoZWNrZWQgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIC8v6I+c5Y2VaW5wdXTliJ3lp4vljJYKICAgIGZ1bmN0aW9uIG1lbnVJbml0aWFsaXplX2lucHV0KGlkLHZhcmlhYmxlKXsKICAgICAgICB2YXIgaSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiYWNrcnVubmVyX2lfJytpZCk7CiAgICAgICAgaWYgKGkgIT09IG51bGwpewogICAgICAgICAgICBpLnZhbHVlID0gdmFyaWFibGU7CiAgICAgICAgfQogICAgfQoKICAgIC8v6I+c5Y2V5YaF5LqL5Lu25Yib5bu6CiAgICBmdW5jdGlvbiBjcmVhdGVNZW51RXZlbnQoKXsKICAgICAgICB0cnl7CiAgICAgICAgICAgIC8v5Yi35pawCiAgICAgICAgICAgIHZhciBidG5fcmVmcmVzaCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiYWNrcnVubmVyX2J0bl9yZWZyZXNoJyk7CiAgICAgICAgICAgIGlmIChidG5fcmVmcmVzaCAhPT0gbnVsbCl7CiAgICAgICAgICAgICAgICBidG5fcmVmcmVzaC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsYnRuX3JlZnJlc2hfY2xpY2spOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8v5o+Q5LqkCiAgICAgICAgICAgIHZhciBidG5fc3VibWl0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JhY2tydW5uZXJfYnRuX3N1Ym1pdCcpOwogICAgICAgICAgICBpZiAoYnRuX3N1Ym1pdCAhPT0gbnVsbCl7CiAgICAgICAgICAgICAgICBidG5fc3VibWl0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxidG5fc3VibWl0X2NsaWNrKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvL+mHjee9rgogICAgICAgICAgICB2YXIgYnRuX3Jlc2V0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JhY2tydW5uZXJfYnRuX3Jlc2V0Jyk7CiAgICAgICAgICAgIGlmIChidG5fcmVzZXQgIT09IG51bGwpewogICAgICAgICAgICAgICAgYnRuX3Jlc2V0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxidG5fcmVzZXRfY2xpY2spOwogICAgICAgICAgICB9CiAgICAgICAgfWNhdGNoKGUpewogICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpOwogICAgICAgIH0KICAgIH0KICAgIC8v5Yi35paw5oyJ6ZKu5LqL5Lu2CiAgICBmdW5jdGlvbiBidG5fcmVmcmVzaF9jbGljaygpewogICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQodHJ1ZSk7CiAgICB9CiAgICAvL+aPkOS6pOaMiemSruS6i+S7tgogICAgZnVuY3Rpb24gYnRuX3N1Ym1pdF9jbGljaygpewogICAgICAgIHBvc3Rwcm9jZXNzID0gY29udmVydEJvb2xWYWx1ZSgncG9zdHByb2Nlc3MnKTsKICAgICAgICBpc1JlZGlyZWN0ID0gY29udmVydEJvb2xWYWx1ZSgnaXNSZWRpcmVjdCcpOwogICAgICAgIGhvbWVQYWdlUHJvY2VzcyA9IGNvbnZlcnRCb29sVmFsdWUoJ2hvbWVwYWdlcHJvY2VzcycpOwogICAgICAgIGhvbWVQcm9jZXNzID0gY29udmVydEJvb2xWYWx1ZSgnaG9tZVByb2Nlc3MnKTsKICAgICAgICBpc0hlYWRpbWcgPSBjb252ZXJ0Qm9vbFZhbHVlKCdpc0hlYWRpbWcnKTsKICAgICAgICBkaXNwbGF5TGl2ZSA9IGNvbnZlcnRCb29sVmFsdWUoJ2Rpc3BsYXlMaXZlJyk7CiAgICAgICAgZGlzcGxheVNpZ24gPSBjb252ZXJ0Qm9vbFZhbHVlKCdkaXNwbGF5U2lnbicpOwogICAgICAgIGF1dG9DbG9zZUd1aWRlID0gY29udmVydEJvb2xWYWx1ZSgnYXV0b0Nsb3NlR3VpZGUnKTsKICAgICAgICBncm91cFBhZ2VQcm9jZXNzID0gY29udmVydEJvb2xWYWx1ZSgnZ3JvdXBwcm9jZXNzJyk7CiAgICAgICAgbm9Mb2dpblByb2Nlc3MgPSBjb252ZXJ0Qm9vbFZhbHVlKCdub2xvZ2luJyk7CiAgICAgICAgcmV2ZXJzZSA9IGNvbnZlcnRCb29sVmFsdWUoJ3JldmVyc2UnKTsKICAgICAgICBzbGVlcFRpbWUgPSBjb252ZXJ0TnVtVmFsdWUoJ3NsZWVwVGltZScpOwogICAgICAgIGRlbGF5U2NyaXB0UnVuVGltZXMgPSBjb252ZXJ0TnVtVmFsdWUoJ2RlbGF5U2NyaXB0UnVuVGltZXMnKTsKICAgICAgICBzbGVlcFRpbWVXaGVuUGFnZVR1cm4gPSBjb252ZXJ0TnVtVmFsdWUoJ3NsZWVwVGltZVBhZ2UnKTsKICAgICAgICByZXZlcnNlU2xlZXBUaW1lID0gY29udmVydE51bVZhbHVlKCdyZXZlcnNlU2xlZXBUaW1lJyk7CiAgICAgICAgY2hlY2tyYXRlID0gY29udmVydE51bVZhbHVlKCdjaGVja3JhdGUnKTsKCiAgICAgICAgaWYgKHBvc3Rwcm9jZXNzKXsKICAgICAgICAgICAgaWYgKHdpbmRvdy5jb25maXJtKCfnoa7orqTopoHmm7TmlLnorr7nva7vvJ8nKSl7CiAgICAgICAgICAgICAgICByZXBsYWNlU3RvcmVkU2V0dGluZ3MoKTsKICAgICAgICAgICAgICAgIG1lbnVJbml0aWFsaXplKCk7CiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKHRydWUpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbWVudUluaXRpYWxpemUoKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICh3aW5kb3cuY29uZmlybSgn44CQ6YeN6KaB44CRXG7mgqjnpoHnlKjkuoblkI7lpITnkIbohJrmnKzvvIzmnKzohJrmnKznu53lpKfpg6jliIblip/og73lsIbml6Dms5Xkvb/nlKhcblxu56Gu6K6k6KaB5pu05pS56K6+572u77yfJykpewogICAgICAgICAgICAgICAgcmVwbGFjZVN0b3JlZFNldHRpbmdzKCk7CiAgICAgICAgICAgICAgICBtZW51SW5pdGlhbGl6ZSgpOwogICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCh0cnVlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIG1lbnVJbml0aWFsaXplKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiBidG5fcmVzZXRfY2xpY2soKXsKICAgICAgICBpZiAod2luZG93LmNvbmZpcm0oJ+ehruiupOimgemHjee9ruiuvue9ru+8nycpKXsKICAgICAgICAgICAgR01fZGVsZXRlVmFsdWUoInBvc3Rwcm9jZXNzIik7CiAgICAgICAgICAgIEdNX2RlbGV0ZVZhbHVlKCJpc1JlZGlyZWN0Iik7CiAgICAgICAgICAgIEdNX2RlbGV0ZVZhbHVlKCJzbGVlcFRpbWUiKTsKICAgICAgICAgICAgR01fZGVsZXRlVmFsdWUoImRlbGF5U2NyaXB0UnVuVGltZXMiKTsKICAgICAgICAgICAgR01fZGVsZXRlVmFsdWUoImRpc3BsYXlMaXZlIik7CiAgICAgICAgICAgIEdNX2RlbGV0ZVZhbHVlKCJkaXNwbGF5U2lnbiIpOwogICAgICAgICAgICBHTV9kZWxldGVWYWx1ZSgiYXV0b0Nsb3NlR3VpZGUiKTsKICAgICAgICAgICAgR01fZGVsZXRlVmFsdWUoInNsZWVwVGltZVdoZW5QYWdlVHVybiIpOwogICAgICAgICAgICBHTV9kZWxldGVWYWx1ZSgicmV2ZXJzZVNsZWVwVGltZSIpOwogICAgICAgICAgICBHTV9kZWxldGVWYWx1ZSgiaG9tZVBhZ2VQcm9jZXNzIik7CiAgICAgICAgICAgIEdNX2RlbGV0ZVZhbHVlKCJob21lUHJvY2VzcyIpOwogICAgICAgICAgICBHTV9kZWxldGVWYWx1ZSgiaXNIZWFkaW1nIik7CiAgICAgICAgICAgIEdNX2RlbGV0ZVZhbHVlKCJncm91cFBhZ2VQcm9jZXNzIik7CiAgICAgICAgICAgIEdNX2RlbGV0ZVZhbHVlKCJub0xvZ2luUHJvY2VzcyIpOwogICAgICAgICAgICBHTV9kZWxldGVWYWx1ZSgicmV2ZXJzZSIpOwogICAgICAgICAgICBHTV9kZWxldGVWYWx1ZSgiY2hlY2tyYXRlIik7CiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQodHJ1ZSk7CiAgICAgICAgfQogICAgfQogICAgLy/lsIboj5zljZXkuK3nmoRib29s5YC86LWL57uZ5Y+Y6YePCiAgICBmdW5jdGlvbiBjb252ZXJ0Qm9vbFZhbHVlKGlkKXsKICAgICAgICB2YXIgaSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiYWNrcnVubmVyX2lfJytpZCk7CiAgICAgICAgaWYgKGkgIT09IG51bGwpewogICAgICAgICAgICBpZiAoaS5jaGVja2VkKXsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgLy/lsIboj5zljZXkuK3nmoTmlbDlgLzotYvnu5nlj5jph48KICAgIGZ1bmN0aW9uIGNvbnZlcnROdW1WYWx1ZShpZCl7CiAgICAgICAgdmFyIGkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmFja3J1bm5lcl9pXycraWQpOwogICAgICAgIGlmIChpICE9PSBudWxsKXsKICAgICAgICAgICAgcmV0dXJuKHBhcnNlRmxvYXQoaS52YWx1ZSkpOwogICAgICAgIH0KICAgIH0KICAgIC8v5o6n5Yi26Z2i5p2/6byg5qCH5LqL5Lu2CiAgICBmdW5jdGlvbiBjcE9uTW91c2VFbnRlcigpewogICAgICAgIHRyeXsKICAgICAgICAgICAgdmFyIGNwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JhY2tydW5uZXJKU1NldHRpbmdfcm9vdCcpOwogICAgICAgICAgICBjcC5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywnZGlzcGxheTpibG9jaztyaWdodDowOycpOwogICAgICAgIH0gY2F0Y2goZSl7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7CiAgICAgICAgfQogICAgfQogICAgZnVuY3Rpb24gY3BPbk1vdXNlTGVhdmUoKXsKICAgICAgICB0cnl7CiAgICAgICAgICAgIHZhciBjcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiYWNrcnVubmVySlNTZXR0aW5nX3Jvb3QnKTsKICAgICAgICAgICAgY3Auc2V0QXR0cmlidXRlKCdzdHlsZScsJ2Rpc3BsYXk6bm9uZTtyaWdodDowJyk7CiAgICAgICAgfSBjYXRjaChlKXsKICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTsKICAgICAgICB9CiAgICB9CgogICAgLy/mm7/mjaLlgqjlrZjnmoTorr7nva4KICAgIGZ1bmN0aW9uIHJlcGxhY2VTdG9yZWRTZXR0aW5ncygpewogICAgICAgIEdNX3NldFZhbHVlKCJwb3N0cHJvY2VzcyIscG9zdHByb2Nlc3MpOwogICAgICAgIEdNX3NldFZhbHVlKCJpc1JlZGlyZWN0Iixpc1JlZGlyZWN0KTsKICAgICAgICBHTV9zZXRWYWx1ZSgic2xlZXBUaW1lIixzbGVlcFRpbWUpOwogICAgICAgIEdNX3NldFZhbHVlKCJkZWxheVNjcmlwdFJ1blRpbWVzIixkZWxheVNjcmlwdFJ1blRpbWVzKTsKICAgICAgICBHTV9zZXRWYWx1ZSgiZGlzcGxheUxpdmUiLGRpc3BsYXlMaXZlKTsKICAgICAgICBHTV9zZXRWYWx1ZSgiZGlzcGxheVNpZ24iLGRpc3BsYXlTaWduKTsKICAgICAgICBHTV9zZXRWYWx1ZSgiYXV0b0Nsb3NlR3VpZGUiLGF1dG9DbG9zZUd1aWRlKTsKICAgICAgICBHTV9zZXRWYWx1ZSgic2xlZXBUaW1lV2hlblBhZ2VUdXJuIixzbGVlcFRpbWVXaGVuUGFnZVR1cm4pOwogICAgICAgIEdNX3NldFZhbHVlKCJyZXZlcnNlU2xlZXBUaW1lIixyZXZlcnNlU2xlZXBUaW1lKTsKICAgICAgICBHTV9zZXRWYWx1ZSgiaG9tZVBhZ2VQcm9jZXNzIixob21lUGFnZVByb2Nlc3MpOwogICAgICAgIEdNX3NldFZhbHVlKCJob21lUHJvY2VzcyIsaG9tZVByb2Nlc3MpOwogICAgICAgIEdNX3NldFZhbHVlKCJpc0hlYWRpbWciLGlzSGVhZGltZyk7CiAgICAgICAgR01fc2V0VmFsdWUoImdyb3VwUGFnZVByb2Nlc3MiLGdyb3VwUGFnZVByb2Nlc3MpOwogICAgICAgIEdNX3NldFZhbHVlKCJub0xvZ2luUHJvY2VzcyIsbm9Mb2dpblByb2Nlc3MpOwogICAgICAgIEdNX3NldFZhbHVlKCJyZXZlcnNlIixyZXZlcnNlKTsKICAgICAgICBHTV9zZXRWYWx1ZSgiY2hlY2tyYXRlIixjaGVja3JhdGUpOwogICAgfQoKICAgIC8v5bqV6YOo5L+h5oGv6L6T5Ye6CiAgICBmdW5jdGlvbiBjcmVhdGVGb290ZXJMYXllcigpewogICAgICAgIHZhciBmb290RGl2OwogICAgICAgIHZhciBpZDsKICAgICAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2JhY2tydW5uZXJKU0Zvb3RlcicpPT09bnVsbCl7CiAgICAgICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24uaHJlZi5pbmRleE9mKCJ0aWViYS5iYWlkdS5jb20vZj8iKSAhPT0gLTEpewogICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgIGZvb3REaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdmcnNfY29udGVudF9mb290ZXJfcGFnZWxldCcpWzBdOwogICAgICAgICAgICAgICAgICAgIGZvb3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgICAgICBpZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgICAgIGZvb3Quc2V0QXR0cmlidXRlKCdjbGFzcycsJ2Zvb3RlcicpOwogICAgICAgICAgICAgICAgICAgIGZvb3Quc2V0QXR0cmlidXRlKCdpZCcsJ2Zvb3RlcicpOwogICAgICAgICAgICAgICAgICAgIGZvb3Quc2V0QXR0cmlidXRlKCdzdHlsZScsJ3BhZGRpbmctdG9wOjBweCAhaW1wb3J0YW50OycpOwogICAgICAgICAgICAgICAgICAgIGlkLnNldEF0dHJpYnV0ZSgnaWQnLCdiYWNrcnVubmVySlNGb290ZXInKTsKICAgICAgICAgICAgICAgICAgICBjcmVhdGVGb290ZXJFbGVtZW50KGZvb3QsIuW3suW6lOeUqOeUsUJhY2tSdW5uZXLliLbkvZznmoTotLTlkKfnsr7nroDohJrmnKwgKCIrIEdNX2luZm8uc2NyaXB0LnZlcnNpb24rIikiLCJodHRwczovL2dyZWFzeWZvcmsub3JnL3poLUNOL3NjcmlwdHMvMjM2ODciLGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICBjcmVhdGVGb290ZXJFbGVtZW50KGZvb3QsIuaNkOi1oOS9nOiAhSjmlK/ku5jlrp3kuoznu7TnoIEpIiwiaHR0cHM6Ly9zbWFsbGZpbGUuYmFja3J1bm5lci50b3AvaW1hZ2VzL2FsaXBheS5qcGciLHRydWUpOwogICAgICAgICAgICAgICAgICAgIGZvb3REaXYuYXBwZW5kQ2hpbGQoZm9vdCk7CiAgICAgICAgICAgICAgICAgICAgZm9vdERpdi5hcHBlbmRDaGlsZChpZCk7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCfotLTlkKfpobXpnaLnsr7nroA6IOW6lemDqOS/oeaBr+a3u+WKoOWujOaIkCcpOwogICAgICAgICAgICAgICAgfSBjYXRjaChlKXsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5ocmVmLmluZGV4T2YoInRpZWJhLmJhaWR1LmNvbS9wLyIpICE9PSAtMSl7CiAgICAgICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICAgICBmb290RGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgncGJfZm9vdGVyJylbMF07CiAgICAgICAgICAgICAgICAgICAgICAgIGZvb3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9vdC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywnZm9vdGVyJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvb3Quc2V0QXR0cmlidXRlKCdpZCcsJ2Zvb3RlcicpOwogICAgICAgICAgICAgICAgICAgICAgICBmb290LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCdwYWRkaW5nLXRvcDowcHggIWltcG9ydGFudDsnKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWQuc2V0QXR0cmlidXRlKCdpZCcsJ2JhY2tydW5uZXJKU0Zvb3RlcicpOwogICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVGb290ZXJFbGVtZW50KGZvb3QsIuW3suW6lOeUqOeUsUJhY2tSdW5uZXLliLbkvZznmoTotLTlkKfnsr7nroDohJrmnKwgKCIrIEdNX2luZm8uc2NyaXB0LnZlcnNpb24rIikiLCJodHRwczovL2dyZWFzeWZvcmsub3JnL3poLUNOL3NjcmlwdHMvMjM2ODciLGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlRm9vdGVyRWxlbWVudChmb290LCLlkJHkvZzogIXmjZDmrL4o5pSv5LuY5a6d5LqM57u056CBKSIsImh0dHBzOi8vc21hbGxmaWxlLmJhY2tydW5uZXIudG9wL2ltYWdlcy9hbGlwYXkuanBnIix0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9vdERpdi5hcHBlbmRDaGlsZChmb290KTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9vdERpdi5hcHBlbmRDaGlsZChpZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2Fybign6LS05ZCn6aG16Z2i57K+566AOiDlupXpg6jkv6Hmga/mt7vliqDlrozmiJAnKTsKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoKGUpewogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnNvbGUud2Fybign6LS05ZCn6aG16Z2i57K+566AOiDlupXpg6jkv6Hmga/lt7LlrZjlnKgnKTsKICAgICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiBhZGRGaW5pc2hUaW1lVG9Gb290ZXIoKXsKICAgICAgICBpZiAoZmluaXNoVGltZSAhPT0gLTEpewogICAgICAgICAgICBhZGRTcGxpdExpbmVUb0Zvb3Rlcihmb290KTsKICAgICAgICAgICAgY3JlYXRlRm9vdGVyRWxlbWVudChmb290LCLpobXpnaLliqDovb3ml7bpl7TvvJoiICsgZmluaXNoVGltZSsibXMiLCJqYXZhc2NyaXB0OjsiLHRydWUpOwogICAgICAgIH0KICAgIH0KICAgIGZ1bmN0aW9uIGFkZFNwbGl0TGluZVRvRm9vdGVyKGZvb3Rlcil7CiAgICAgICAgdHJ5ewogICAgICAgICAgICB2YXIgc3BsaXRMaW5lPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKICAgICAgICAgICAgc3BsaXRMaW5lLmlubmVySFRNTD0ifCI7CiAgICAgICAgICAgIGZvb3Rlci5hcHBlbmRDaGlsZChzcGxpdExpbmUpOwogICAgICAgIH1jYXRjaChlKXsKICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTsKICAgICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiBjcmVhdGVGb290ZXJFbGVtZW50KGZvb3Rlcix0ZXh0LGhyZWYsaXNMYXN0KXsKICAgICAgICB2YXIgc3BsaXRMaW5lPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKICAgICAgICBzcGxpdExpbmUuaW5uZXJIVE1MPSJ8IjsKICAgICAgICB2YXIgY29udGVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgICBjb250ZW50LmlubmVySFRNTD10ZXh0OwogICAgICAgIGNvbnRlbnQuc2V0QXR0cmlidXRlKCdocmVmJyxocmVmKTsKICAgICAgICBjb250ZW50LnNldEF0dHJpYnV0ZSgndGFyZ2V0JywiX2JsYW5rIik7CiAgICAgICAgY29udGVudC5zZXRBdHRyaWJ1dGUoJ3B2X2NvZGUnLCIwIik7CiAgICAgICAgZm9vdGVyLmFwcGVuZENoaWxkKGNvbnRlbnQpOwogICAgICAgIGlmICghaXNMYXN0KXsKICAgICAgICAgICAgZm9vdGVyLmFwcGVuZENoaWxkKHNwbGl0TGluZSk7CiAgICAgICAgfQogICAgfQogICAgLy/lpLTlm77npoHnlKgKICAgIGZ1bmN0aW9uIGRpc2FibGVGb3J1bUNhcmQoKXsKICAgICAgICBpZiAoaXNIZWFkaW1nKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyIGZvcnVtY2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb3J1bS1jYXJkLWJhbm5lcicpOwogICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCfotLTlkKfpobXpnaLnsr7nroA6IOato+WcqOeyvueugOWktOWbvicpOwogICAgICAgICAgICAgICAgaWYgKGZvcnVtY2FyZCAhPT0gbnVsbCl7CiAgICAgICAgICAgICAgICAgICAgaWYgKGZvcnVtY2FyZC5nZXRBdHRyaWJ1dGUoInNyYyIpIT09IiIpewogICAgICAgICAgICAgICAgICAgICAgICBmb3J1bWNhcmQuc2V0QXR0cmlidXRlKCJzcmMiLCIiKTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9ydW1jYXJkLnNldEF0dHJpYnV0ZSgic3R5bGUiLCJoZWlnaHQ6MTgwcHggIWltcG9ydGFudDtiYWNrZ3JvdW5kLWNvbG9yOndoaXRlICFpbXBvcnRhbnQ7Iik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoKGUpewogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIC8v6YeN5a6a5ZCRCiAgICBmdW5jdGlvbiByZWRpcmVjdCgpewogICAgICAgIHZhciB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjsKICAgICAgICAvLz9yZWRfdGFn6YeN5a6a5ZCRCiAgICAgICAgdmFyIGVsZW1lbnRzID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC50b1N0cmluZygpLnNwbGl0KCcmJyk7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7aTxlbGVtZW50cy5sZW5ndGg7aSsrKXsKICAgICAgICAgICAgaWYgKGVsZW1lbnRzW2ldLmluZGV4T2YoJ3JlZF90YWcnKSAhPT0gLTEpewogICAgICAgICAgICAgICAgdXJsID0gdXJsLnJlcGxhY2UoJyYnK2VsZW1lbnRzW2ldLCcnKTsKICAgICAgICAgICAgICAgIHVybCA9IHVybC5yZXBsYWNlKGVsZW1lbnRzW2ldLCcnKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAvL+Wlh+aAquWfn+WQjemHjeWumuWQkQogICAgICAgIGlmICh1cmwuaW5kZXhPZignZHEudGllYmEuY29tJykhPS0xKXsKICAgICAgICAgICAgdXJsID0gdXJsLnJlcGxhY2UoJ2RxLnRpZWJhLmNvbScsJ3RpZWJhLmJhaWR1LmNvbScpOwogICAgICAgIH0KICAgICAgICBpZiAodXJsLmluZGV4T2YoJ2p1bXAuYmRpbWcuY29tJykhPS0xKXsKICAgICAgICAgICAgdXJsID0gdXJsLnJlcGxhY2UoJ2p1bXAyLmJkaW1nLmNvbScsJ3RpZWJhLmJhaWR1LmNvbScpOwogICAgICAgIH0KICAgICAgICBpZiAodXJsLmluZGV4T2YoJ2p1bXAyLmJkaW1nLmNvbScpIT0tMSl7CiAgICAgICAgICAgIHVybCA9IHVybC5yZXBsYWNlKCdqdW1wMi5iZGltZy5jb20nLCd0aWViYS5iYWlkdS5jb20nKTsKICAgICAgICB9CiAgICAgICAgaWYgKHVybC5pbmRleE9mKCc/dHJhY2VpZD0nKSE9LTEpewogICAgICAgICAgICB1cmwgPSB1cmwucmVwbGFjZSgnP3RyYWNlaWQ9JywnJyk7CiAgICAgICAgfQogICAgICAgIGlmICh1cmwgIT09IHdpbmRvdy5sb2NhdGlvbi5ocmVmKXsKICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gdXJsOwogICAgICAgIH0KICAgIH0KICAgIC8v5YCS5bqP55yL5biW5oyJ6ZKu5re75YqgCiAgICBmdW5jdGlvbiByZXZlcnNlb3JkZXIoKXsKICAgICAgICBpZiAocmV2ZXJzZSl7CiAgICAgICAgICAgIC8v5Yik5a6a5b2T5YmN54q25oCBCiAgICAgICAgICAgIHZhciBzdGF0dXMgPSBpbml0aWFsaXplX3ZhcigncmV2ZXJzZV9zdGF0dXMnLGZhbHNlKTsKICAgICAgICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNicl9yZXZlcnNlJykgPT09IG51bGwpewogICAgICAgICAgICAgICAgdmFyIHJpZ2h0YnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY29yZV90aXRsZV9idG5zJylbMF07CiAgICAgICAgICAgICAgICB2YXIgYnRubGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpOwogICAgICAgICAgICAgICAgdmFyIGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgICAgICAgICAgIGNvbnNvbGUud2Fybign6LS05ZCn6aG16Z2i57K+566AOiDmraPlnKjliJvlu7rlgJLluo/mn6XnnIvmjInpkq4nKTsKICAgICAgICAgICAgICAgIC8v5Yik5a6a5piv5ZCm5Li65Y+m5LiA5Liq5biW5a2QCiAgICAgICAgICAgICAgICB2YXIgbGFzdHBhZ2UgPSBpbml0aWFsaXplX3ZhcigncmV2ZXJzZV9sYXN0cGFnZScsJycpOwogICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRocmVmID0gd2luZG93LmxvY2F0aW9uLmhyZWY7CiAgICAgICAgICAgICAgICB2YXIgY3VycmVudHNlYXJjaCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2g7CiAgICAgICAgICAgICAgICB2YXIgY3VycmVudHBhZ2UgPSBjdXJyZW50aHJlZi5yZXBsYWNlKGN1cnJlbnRzZWFyY2gsJycpLnJlcGxhY2UoJ2h0dHBzOi8vdGllYmEuYmFpZHUuY29tL3AvJywnJykucmVwbGFjZSgnaHR0cDovL3RpZWJhLmJhaWR1LmNvbS9wLycsJycpOwogICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRwYWdlIT1sYXN0cGFnZSl7CiAgICAgICAgICAgICAgICAgICAgc3RhdHVzID0gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBHTV9zZXRWYWx1ZSgncmV2ZXJzZV9sYXN0cGFnZScsY3VycmVudHBhZ2UpOwogICAgICAgICAgICAgICAgR01fc2V0VmFsdWUoJ3JldmVyc2Vfc3RhdHVzJyxzdGF0dXMpOwogICAgICAgICAgICAgICAgaWYgKHN0YXR1cyl7CiAgICAgICAgICAgICAgICAgICAgYnRuLmlubmVySFRNTCA9ICfmraPluo/mn6XnnIsnOwogICAgICAgICAgICAgICAgfWVsc2UgewogICAgICAgICAgICAgICAgICAgIGJ0bi5pbm5lckhUTUw9J+WAkuW6j+afpeeciyc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBidG4uc2V0QXR0cmlidXRlKCdpZCcsJ2JyX3JldmVyc2UnKTsKICAgICAgICAgICAgICAgIGJ0bi5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywnYnRuLXN1YiBidG4tc21hbGwnKTsKICAgICAgICAgICAgICAgIGJ0bmxpLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCdicl9yZXZlcnNlX2xpIHF1aWNrX3JlcGx5Jyk7CiAgICAgICAgICAgICAgICBidG5saS5hcHBlbmRDaGlsZChidG4pOwogICAgICAgICAgICAgICAgcmlnaHRidG4uYXBwZW5kQ2hpbGQoYnRubGkpOwogICAgICAgICAgICAgICAgcmlnaHRidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLHJldmVyc2VfY2xpY2spOwogICAgICAgICAgICAgICAgY3VycmVudGhyZWYgPSB3aW5kb3cubG9jYXRpb24uaHJlZjsKICAgICAgICAgICAgICAgIHJldmVyc2VfY29udGVudHMoKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIC8v5YCS5bqP55yL5biW54K55Ye75LqL5Lu2CiAgICBmdW5jdGlvbiByZXZlcnNlX2NsaWNrKCl7CiAgICAgICAgdmFyIHN0YXR1cyA9IGluaXRpYWxpemVfdmFyKCdyZXZlcnNlX3N0YXR1cycsZmFsc2UpOwogICAgICAgIGlmKHN0YXR1cyl7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjbGljaycpOwogICAgICAgICAgICAvL+aBouWkjeato+W6jwogICAgICAgICAgICBHTV9zZXRWYWx1ZSgncmV2ZXJzZV9zdGF0dXMnLGZhbHNlKTsKICAgICAgICAgICAgdmFyIGJ0bnMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdwYl9saXN0X3BhZ2VyJylbMF0uY2hpbGRyZW47CiAgICAgICAgICAgIGlmIChidG5zLmxlbmd0aCA9PT0gMCl7CiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKHRydWUpOwogICAgICAgICAgICB9ZWxzZSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDtpIDwgYnRucy5sZW5ndGg7aSsrKXsKICAgICAgICAgICAgICAgICAgICBpZiAoYnRuc1tpXS5pbm5lckhUTUwgPT0gJzEnKXsKICAgICAgICAgICAgICAgICAgICAgICAgLy/lkJHpppbpobXot7PovawKICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBidG5zW2ldLmhyZWY7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy/lgJLluo8KICAgICAgICAgICAgR01fc2V0VmFsdWUoJ3JldmVyc2Vfc3RhdHVzJyx0cnVlKTsKICAgICAgICAgICAgYnRucyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3BiX2xpc3RfcGFnZXInKVswXS5jaGlsZHJlbjsKICAgICAgICAgICAgaWYgKGJ0bnMubGVuZ3RoID09PSAwKXsKICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQodHJ1ZSk7CiAgICAgICAgICAgIH1lbHNlIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwO2o8YnRucy5sZW5ndGg7aisrKXsKICAgICAgICAgICAgICAgICAgICBpZiAoYnRuc1tqXS5pbm5lckhUTUwgPT0gJ+WwvumhtScpewogICAgICAgICAgICAgICAgICAgICAgICAvL+WQkeWwvumhtei3s+i9rAogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGJ0bnNbal0uaHJlZjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAvL+e/u+i9rOW9k+WJjemhteWGheWuuQogICAgZnVuY3Rpb24gcmV2ZXJzZV9jb250ZW50cygpewogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXsKICAgICAgICAgICAgdmFyIHN0YXR1cyA9IGluaXRpYWxpemVfdmFyKCdyZXZlcnNlX3N0YXR1cycsZmFsc2UpOwogICAgICAgICAgICBpZiAoc3RhdHVzKXsKICAgICAgICAgICAgICAgIGNvbnNvbGUud2Fybign6LS05ZCn6aG16Z2i57K+566AOiDmraPlnKjnv7vovazlvZPliY3pobXlhoXlrrknKTsKCiAgICAgICAgICAgICAgICAvL+iOt+WPluW9k+WJjeeahHBuCiAgICAgICAgICAgICAgICB2YXIgc2VhcmNoID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaDsKICAgICAgICAgICAgICAgIHZhciBzZWFyY2hzID0gc2VhcmNoLnNwbGl0KCcmJyk7CiAgICAgICAgICAgICAgICB2YXIgcG47CiAgICAgICAgICAgICAgICBmb3IgKHZhciBjaGlsZCA9IDA7Y2hpbGQ8c2VhcmNocy5sZW5ndGg7Y2hpbGQrKyl7CiAgICAgICAgICAgICAgICAgICAgaWYgKHNlYXJjaHNbY2hpbGRdLmluZGV4T2YoJ3BuPScpICE9PSAtMSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHBuID0gc2VhcmNoc1tjaGlsZF0ucmVwbGFjZSgnPycsJycpLnJlcGxhY2UoJ3BuPScsJycpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHZhciBsaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2pfcF9wb3N0bGlzdCcpOwogICAgICAgICAgICAgICAgdmFyIGNvbnRlbnRzID0gbGlzdC5jaGlsZHJlbjsKICAgICAgICAgICAgICAgIGNvbnNvbGUud2Fybihjb250ZW50cyk7CiAgICAgICAgICAgICAgICBpZiAoY29udGVudHMubGVuZ3RoID09IDEgJiYgY29udGVudHNbMF0uaWQgPT0gImpfcF9wb3N0bGlzdCIpewogICAgICAgICAgICAgICAgICAgIGxpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdwX3Bvc3RsaXN0JylbMV07CiAgICAgICAgICAgICAgICAgICAgY29udGVudHMgPSBsaXN0LmNoaWxkcmVuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGNvbnRlbnRzKTsKICAgICAgICAgICAgICAgIC8v5YCS5bqPCiAgICAgICAgICAgICAgICBmb3IodmFyIGkgPSBjb250ZW50cy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgICAgICAgICAgICAgIGxpc3QuYXBwZW5kQ2hpbGQoY29udGVudHNbaV0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSxyZXZlcnNlU2xlZXBUaW1lKTsKICAgIH0KICAgIC8v6Ieq5Yqo5pS26LW35oyH5byVCiAgICB2YXIgaXNBdXRvQ2xvc2VHdWlkZVNldCA9IGZhbHNlOwogICAgZnVuY3Rpb24gY2xvc2VHdWlkZSgpewogICAgICAgIGlmIChhdXRvQ2xvc2VHdWlkZSAmJiAhaXNBdXRvQ2xvc2VHdWlkZVNldCl7CiAgICAgICAgICAgIHZhciB0b3BDb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgidG9wX2NvbnRlbnQiKTsKICAgICAgICAgICAgdmFyIHRvcENvbnRlbnRNYWluID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgidG9wX2NvbnRfbWFpbiIpOwogICAgICAgICAgICBpZiAodG9wQ29udGVudC5sZW5ndGg+MCAmJiB0b3BDb250ZW50TWFpbi5sZW5ndGg+MCl7CiAgICAgICAgICAgICAgICB0b3BDb250ZW50WzBdLnNldEF0dHJpYnV0ZSgiY2xhc3MiLCJ0b3BfY29udGVudCB0b3BfY29udGVudF9jbG9zZWQiKTsKICAgICAgICAgICAgICAgIHRvcENvbnRlbnRNYWluWzBdLnNldEF0dHJpYnV0ZSgic3R5bGUiLCJkaXNwbGF5Om5vbmU7Iik7CiAgICAgICAgICAgICAgICBpc0F1dG9DbG9zZUd1aWRlU2V0ID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIC8v54mI5pys5pu05paw5Yig6Zmk5bqf5byD5Y+Y6YePCiAgICBmdW5jdGlvbiBkZWxldGVUcmFzaFZhbHVlKCl7CiAgICAgICAgdmFyIHRyYXNoTGlzdCA9IHt9OwogICAgICAgIGZvciAodmFyIGkgPSAwO2k8dHJhc2hMaXN0Lmxlbmd0aDtpKyspewogICAgICAgICAgICBHTV9kZWxldGVWYWx1ZSgidHJhc2hMaXN0W2ldIik7CiAgICAgICAgfQogICAgICAgIGNvbnNvbGUud2Fybign6LS05ZCn6aG16Z2i57K+566AOiDniYjmnKzmm7TmlrDvvIzlt7LliKDpmaTlup/lvIPlj5jph48nKTsKICAgIH0KICAgIC8v5omT5oqY5Y2h562J5by55qGG5bGP6JS9CiAgICBmdW5jdGlvbiByZW1vdmVQb3B1cE1vZGFsKCl7CiAgICAgICAgdmFyIGRpYWxvZyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2RpYWxvZ0onKTsKICAgICAgICB2YXIgZGlhbG9nbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdkaWFsb2dKbW9kYWwnKTsKICAgICAgICBmb3IgKHZhciBpID0gMDtpPGRpYWxvZy5sZW5ndGg7aSsrKXsKICAgICAgICAgICAgZGlhbG9nW2ldLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZGlhbG9nW2ldKTsKICAgICAgICAgICAgaWYgKGRpYWxvZ1tpXS5pbm5lckhUTUwuaW5kZXhPZign56Gu5a6a5LiN5YaN5YWz5rOoJyAhPSAtMSkpewogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZm9yIChpID0gMDtpPGRpYWxvZ21vZGFsLmxlbmd0aDtpKyspewogICAgICAgICAgICBkaWFsb2dtb2RhbFtpXS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGRpYWxvZ21vZGFsW2ldKTsKICAgICAgICB9CiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpewogICAgICAgICAgICB2YXIgZGlhbG9nID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZGlhbG9nSicpOwogICAgICAgICAgICB2YXIgZGlhbG9nbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdkaWFsb2dKbW9kYWwnKTsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7aTxkaWFsb2cubGVuZ3RoO2krKyl7CiAgICAgICAgICAgICAgICBkaWFsb2dbaV0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChkaWFsb2dbaV0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAoaSA9IDA7aTxkaWFsb2dtb2RhbC5sZW5ndGg7aSsrKXsKICAgICAgICAgICAgICAgIGRpYWxvZ21vZGFsW2ldLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZGlhbG9nbW9kYWxbaV0pOwogICAgICAgICAgICB9CiAgICAgICAgfSw1MDAwKTsKICAgIH0KICAgIC8v5riF55CG6aaW6aG15Yqo5oCB5YaF55qE5bm/5ZGKICoyMDE4MTAyMgogICAgdmFyIGluZGV4QURFdmVudF9hID0gZmFsc2U7CiAgICB2YXIgaW5kZXhBREV2ZW50X3Njcm9sbCA9IGZhbHNlOwogICAgdmFyIGluZGV4QURFdmVudF90YWdfaG90ID0gZmFsc2U7CiAgICB2YXIgaW5kZXhBREV2ZW50X3RhZ19wZXJzb25hbCA9IGZhbHNlOwogICAgdmFyIHdpbmRvd1RlbXBTY3JvbGxUb3AgPSAwOwogICAgZnVuY3Rpb24gYmluZENsZWFuSW5kZXhBREV2ZW50KCl7CiAgICAgICAgdmFyIGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG5fbW9yZScpOwogICAgICAgIHZhciBhID0gYnRuLmNoaWxkcmVuWzBdOwogICAgICAgIGlmICghaW5kZXhBREV2ZW50X2EpewogICAgICAgICAgICBjb25zb2xlLmxvZygi6LS05ZCn6aG16Z2i57K+566AOiDlt7Lnu5HlrprpppbpobXliqjmgIHlub/lkYrmuIXnkIbnmoTmjInpkq7ngrnlh7vkuovku7YiKTsKICAgICAgICAgICAgYS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgICAgICBjbGVhbkFEaW5JbmRleCgpOwogICAgICAgICAgICAgICAgfSxzbGVlcFRpbWUpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgaW5kZXhBREV2ZW50X2EgPSB0cnVlOwogICAgICAgIH0KICAgICAgICBpZiAoIWluZGV4QURFdmVudF9zY3JvbGwpewogICAgICAgICAgICBjb25zb2xlLmxvZygi6LS05ZCn6aG16Z2i57K+566AOiDlt7Lnu5HlrprpppbpobXliqjmgIHlub/lkYrmuIXnkIbnmoTmu5rliqjkuovku7YiKTsKICAgICAgICAgICAgZG9jdW1lbnQub25zY3JvbGwgPSBmdW5jdGlvbigpewogICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgLSB3aW5kb3dUZW1wU2Nyb2xsVG9wID4gMzAwKXsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygi6LS05ZCn6aG16Z2i57K+566AOiDmu5rliqjop6blj5HvvIzmraPlnKjmuIXnkIbliqjmgIHlhoXnmoTlub/lkYoiKTsKICAgICAgICAgICAgICAgICAgICBjbGVhbkFEaW5JbmRleCgpOwogICAgICAgICAgICAgICAgICAgIHdpbmRvd1RlbXBTY3JvbGxUb3AgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGluZGV4QURFdmVudF9zY3JvbGwgPSB0cnVlOwogICAgICAgIH0KICAgICAgICBpZiAoIWluZGV4QURFdmVudF90YWdfaG90KXsKICAgICAgICAgICAgdmFyIHRhZ19ob3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnal9yZW1lbl9uYXYnKTsKICAgICAgICAgICAgdGFnX2hvdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgIGNsZWFyU2Nyb2xsVG9wVGVtcCgpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgaW5kZXhBREV2ZW50X3RhZ19ob3QgPSB0cnVlOwogICAgICAgIH0KICAgICAgICBpZiAoIWluZGV4QURFdmVudF90YWdfcGVyc29uYWwpewogICAgICAgICAgICB2YXIgdGFnX3BlcnNvbmFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hdi1wZXJzb25hbCcpOwogICAgICAgICAgICB0YWdfcGVyc29uYWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICBjbGVhclNjcm9sbFRvcFRlbXAoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGluZGV4QURFdmVudF90YWdfaG90ID0gdHJ1ZTsKICAgICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiBjbGVhclNjcm9sbFRvcFRlbXAoKXsKICAgICAgICBjb25zb2xlLmxvZygi6LS05ZCn6aG16Z2i57K+566AOiDmuIXnkIbmu5rliqjpq5jluqbnvJPlrZgiKTsKICAgICAgICB3aW5kb3dUZW1wU2Nyb2xsVG9wID0gMDsKICAgIH0KICAgIGZ1bmN0aW9uIGNsZWFuQURpbkluZGV4KCl7CiAgICAgICAgdmFyIGFkcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2hvbWUtcGxhY2UtaXRlbScpOwogICAgICAgIHZhciBjb3VudCA9IDA7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7aTxhZHMubGVuZ3RoO2krKyl7CiAgICAgICAgICAgIHZhciBleHRpbmZvID0gYWRzW2ldLmdldEF0dHJpYnV0ZSgnZGF0YS1leHRfaW5mbycpOwogICAgICAgICAgICBpZiAodHlwZW9mIGV4dGluZm8gIT0gJ3VuZGVmaW5lZCcpewogICAgICAgICAgICAgICAgYWRzW2ldLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYWRzW2ldKTsKICAgICAgICAgICAgICAgIGNvdW50Kys7CiAgICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAgIGNvbnNvbGUubG9nKCLotLTlkKfpobXpnaLnsr7nroA6IOa4heeQhuS6hiIrY291bnQrIuadoeWKqOaAgeWGheeahOW5v+WRiiIpOwogICAgfQogICAgLy8g5L+u5aSN5YWz5rOo5oyJ6ZKuCiAgICBmdW5jdGlvbiBmaXhGb2N1c0J1dHRvbigpewogICAgICAgICQoZG9jdW1lbnQpLm9uKCdtb3VzZWRvd24nLCAnLmlzbGlrZV9mb2N1cycgLGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYScpOwogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgICAgICAgICAgIH0sIDEwMCk7CiAgICAgICAgfSk7CiAgICB9Cn0pKCk7","requires":[{"meta":{"name":"jquery.min.js","url":"https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js","ts":1733530083228,"mimetype":"text/javascript"},"source":"LyohIGpRdWVyeSB2My40LjEgfCAoYykgSlMgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzIHwganF1ZXJ5Lm9yZy9saWNlbnNlICovCiFmdW5jdGlvbihlLHQpeyJ1c2Ugc3RyaWN0Ijsib2JqZWN0Ij09dHlwZW9mIG1vZHVsZSYmIm9iamVjdCI9PXR5cGVvZiBtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1lLmRvY3VtZW50P3QoZSwhMCk6ZnVuY3Rpb24oZSl7aWYoIWUuZG9jdW1lbnQpdGhyb3cgbmV3IEVycm9yKCJqUXVlcnkgcmVxdWlyZXMgYSB3aW5kb3cgd2l0aCBhIGRvY3VtZW50Iik7cmV0dXJuIHQoZSl9OnQoZSl9KCJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93P3dpbmRvdzp0aGlzLGZ1bmN0aW9uKEMsZSl7InVzZSBzdHJpY3QiO3ZhciB0PVtdLEU9Qy5kb2N1bWVudCxyPU9iamVjdC5nZXRQcm90b3R5cGVPZixzPXQuc2xpY2UsZz10LmNvbmNhdCx1PXQucHVzaCxpPXQuaW5kZXhPZixuPXt9LG89bi50b1N0cmluZyx2PW4uaGFzT3duUHJvcGVydHksYT12LnRvU3RyaW5nLGw9YS5jYWxsKE9iamVjdCkseT17fSxtPWZ1bmN0aW9uKGUpe3JldHVybiJmdW5jdGlvbiI9PXR5cGVvZiBlJiYibnVtYmVyIiE9dHlwZW9mIGUubm9kZVR5cGV9LHg9ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGwhPWUmJmU9PT1lLndpbmRvd30sYz17dHlwZTohMCxzcmM6ITAsbm9uY2U6ITAsbm9Nb2R1bGU6ITB9O2Z1bmN0aW9uIGIoZSx0LG4pe3ZhciByLGksbz0obj1ufHxFKS5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTtpZihvLnRleHQ9ZSx0KWZvcihyIGluIGMpKGk9dFtyXXx8dC5nZXRBdHRyaWJ1dGUmJnQuZ2V0QXR0cmlidXRlKHIpKSYmby5zZXRBdHRyaWJ1dGUocixpKTtuLmhlYWQuYXBwZW5kQ2hpbGQobykucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChvKX1mdW5jdGlvbiB3KGUpe3JldHVybiBudWxsPT1lP2UrIiI6Im9iamVjdCI9PXR5cGVvZiBlfHwiZnVuY3Rpb24iPT10eXBlb2YgZT9uW28uY2FsbChlKV18fCJvYmplY3QiOnR5cGVvZiBlfXZhciBmPSIzLjQuMSIsaz1mdW5jdGlvbihlLHQpe3JldHVybiBuZXcgay5mbi5pbml0KGUsdCl9LHA9L15bXHNcdUZFRkZceEEwXSt8W1xzXHVGRUZGXHhBMF0rJC9nO2Z1bmN0aW9uIGQoZSl7dmFyIHQ9ISFlJiYibGVuZ3RoImluIGUmJmUubGVuZ3RoLG49dyhlKTtyZXR1cm4hbShlKSYmIXgoZSkmJigiYXJyYXkiPT09bnx8MD09PXR8fCJudW1iZXIiPT10eXBlb2YgdCYmMDx0JiZ0LTEgaW4gZSl9ay5mbj1rLnByb3RvdHlwZT17anF1ZXJ5OmYsY29uc3RydWN0b3I6ayxsZW5ndGg6MCx0b0FycmF5OmZ1bmN0aW9uKCl7cmV0dXJuIHMuY2FsbCh0aGlzKX0sZ2V0OmZ1bmN0aW9uKGUpe3JldHVybiBudWxsPT1lP3MuY2FsbCh0aGlzKTplPDA/dGhpc1tlK3RoaXMubGVuZ3RoXTp0aGlzW2VdfSxwdXNoU3RhY2s6ZnVuY3Rpb24oZSl7dmFyIHQ9ay5tZXJnZSh0aGlzLmNvbnN0cnVjdG9yKCksZSk7cmV0dXJuIHQucHJldk9iamVjdD10aGlzLHR9LGVhY2g6ZnVuY3Rpb24oZSl7cmV0dXJuIGsuZWFjaCh0aGlzLGUpfSxtYXA6ZnVuY3Rpb24obil7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGsubWFwKHRoaXMsZnVuY3Rpb24oZSx0KXtyZXR1cm4gbi5jYWxsKGUsdCxlKX0pKX0sc2xpY2U6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2socy5hcHBseSh0aGlzLGFyZ3VtZW50cykpfSxmaXJzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVxKDApfSxsYXN0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXEoLTEpfSxlcTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmxlbmd0aCxuPStlKyhlPDA/dDowKTtyZXR1cm4gdGhpcy5wdXNoU3RhY2soMDw9biYmbjx0P1t0aGlzW25dXTpbXSl9LGVuZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnByZXZPYmplY3R8fHRoaXMuY29uc3RydWN0b3IoKX0scHVzaDp1LHNvcnQ6dC5zb3J0LHNwbGljZTp0LnNwbGljZX0say5leHRlbmQ9ay5mbi5leHRlbmQ9ZnVuY3Rpb24oKXt2YXIgZSx0LG4scixpLG8sYT1hcmd1bWVudHNbMF18fHt9LHM9MSx1PWFyZ3VtZW50cy5sZW5ndGgsbD0hMTtmb3IoImJvb2xlYW4iPT10eXBlb2YgYSYmKGw9YSxhPWFyZ3VtZW50c1tzXXx8e30scysrKSwib2JqZWN0Ij09dHlwZW9mIGF8fG0oYSl8fChhPXt9KSxzPT09dSYmKGE9dGhpcyxzLS0pO3M8dTtzKyspaWYobnVsbCE9KGU9YXJndW1lbnRzW3NdKSlmb3IodCBpbiBlKXI9ZVt0XSwiX19wcm90b19fIiE9PXQmJmEhPT1yJiYobCYmciYmKGsuaXNQbGFpbk9iamVjdChyKXx8KGk9QXJyYXkuaXNBcnJheShyKSkpPyhuPWFbdF0sbz1pJiYhQXJyYXkuaXNBcnJheShuKT9bXTppfHxrLmlzUGxhaW5PYmplY3Qobik/bjp7fSxpPSExLGFbdF09ay5leHRlbmQobCxvLHIpKTp2b2lkIDAhPT1yJiYoYVt0XT1yKSk7cmV0dXJuIGF9LGsuZXh0ZW5kKHtleHBhbmRvOiJqUXVlcnkiKyhmK01hdGgucmFuZG9tKCkpLnJlcGxhY2UoL1xEL2csIiIpLGlzUmVhZHk6ITAsZXJyb3I6ZnVuY3Rpb24oZSl7dGhyb3cgbmV3IEVycm9yKGUpfSxub29wOmZ1bmN0aW9uKCl7fSxpc1BsYWluT2JqZWN0OmZ1bmN0aW9uKGUpe3ZhciB0LG47cmV0dXJuISghZXx8IltvYmplY3QgT2JqZWN0XSIhPT1vLmNhbGwoZSkpJiYoISh0PXIoZSkpfHwiZnVuY3Rpb24iPT10eXBlb2Yobj12LmNhbGwodCwiY29uc3RydWN0b3IiKSYmdC5jb25zdHJ1Y3RvcikmJmEuY2FsbChuKT09PWwpfSxpc0VtcHR5T2JqZWN0OmZ1bmN0aW9uKGUpe3ZhciB0O2Zvcih0IGluIGUpcmV0dXJuITE7cmV0dXJuITB9LGdsb2JhbEV2YWw6ZnVuY3Rpb24oZSx0KXtiKGUse25vbmNlOnQmJnQubm9uY2V9KX0sZWFjaDpmdW5jdGlvbihlLHQpe3ZhciBuLHI9MDtpZihkKGUpKXtmb3Iobj1lLmxlbmd0aDtyPG47cisrKWlmKCExPT09dC5jYWxsKGVbcl0scixlW3JdKSlicmVha31lbHNlIGZvcihyIGluIGUpaWYoITE9PT10LmNhbGwoZVtyXSxyLGVbcl0pKWJyZWFrO3JldHVybiBlfSx0cmltOmZ1bmN0aW9uKGUpe3JldHVybiBudWxsPT1lPyIiOihlKyIiKS5yZXBsYWNlKHAsIiIpfSxtYWtlQXJyYXk6ZnVuY3Rpb24oZSx0KXt2YXIgbj10fHxbXTtyZXR1cm4gbnVsbCE9ZSYmKGQoT2JqZWN0KGUpKT9rLm1lcmdlKG4sInN0cmluZyI9PXR5cGVvZiBlP1tlXTplKTp1LmNhbGwobixlKSksbn0saW5BcnJheTpmdW5jdGlvbihlLHQsbil7cmV0dXJuIG51bGw9PXQ/LTE6aS5jYWxsKHQsZSxuKX0sbWVyZ2U6ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49K3QubGVuZ3RoLHI9MCxpPWUubGVuZ3RoO3I8bjtyKyspZVtpKytdPXRbcl07cmV0dXJuIGUubGVuZ3RoPWksZX0sZ3JlcDpmdW5jdGlvbihlLHQsbil7Zm9yKHZhciByPVtdLGk9MCxvPWUubGVuZ3RoLGE9IW47aTxvO2krKykhdChlW2ldLGkpIT09YSYmci5wdXNoKGVbaV0pO3JldHVybiByfSxtYXA6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbz0wLGE9W107aWYoZChlKSlmb3Iocj1lLmxlbmd0aDtvPHI7bysrKW51bGwhPShpPXQoZVtvXSxvLG4pKSYmYS5wdXNoKGkpO2Vsc2UgZm9yKG8gaW4gZSludWxsIT0oaT10KGVbb10sbyxuKSkmJmEucHVzaChpKTtyZXR1cm4gZy5hcHBseShbXSxhKX0sZ3VpZDoxLHN1cHBvcnQ6eX0pLCJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJihrLmZuW1N5bWJvbC5pdGVyYXRvcl09dFtTeW1ib2wuaXRlcmF0b3JdKSxrLmVhY2goIkJvb2xlYW4gTnVtYmVyIFN0cmluZyBGdW5jdGlvbiBBcnJheSBEYXRlIFJlZ0V4cCBPYmplY3QgRXJyb3IgU3ltYm9sIi5zcGxpdCgiICIpLGZ1bmN0aW9uKGUsdCl7blsiW29iamVjdCAiK3QrIl0iXT10LnRvTG93ZXJDYXNlKCl9KTt2YXIgaD1mdW5jdGlvbihuKXt2YXIgZSxkLGIsbyxpLGgsZixnLHcsdSxsLFQsQyxhLEUsdixzLGMseSxrPSJzaXp6bGUiKzEqbmV3IERhdGUsbT1uLmRvY3VtZW50LFM9MCxyPTAscD11ZSgpLHg9dWUoKSxOPXVlKCksQT11ZSgpLEQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZT09PXQmJihsPSEwKSwwfSxqPXt9Lmhhc093blByb3BlcnR5LHQ9W10scT10LnBvcCxMPXQucHVzaCxIPXQucHVzaCxPPXQuc2xpY2UsUD1mdW5jdGlvbihlLHQpe2Zvcih2YXIgbj0wLHI9ZS5sZW5ndGg7bjxyO24rKylpZihlW25dPT09dClyZXR1cm4gbjtyZXR1cm4tMX0sUj0iY2hlY2tlZHxzZWxlY3RlZHxhc3luY3xhdXRvZm9jdXN8YXV0b3BsYXl8Y29udHJvbHN8ZGVmZXJ8ZGlzYWJsZWR8aGlkZGVufGlzbWFwfGxvb3B8bXVsdGlwbGV8b3BlbnxyZWFkb25seXxyZXF1aXJlZHxzY29wZWQiLE09IltcXHgyMFxcdFxcclxcblxcZl0iLEk9Iig/OlxcXFwufFtcXHctXXxbXlwwLVxceGEwXSkrIixXPSJcXFsiK00rIiooIitJKyIpKD86IitNKyIqKFsqXiR8IX5dPz0pIitNKyIqKD86JygoPzpcXFxcLnxbXlxcXFwnXSkqKSd8XCIoKD86XFxcXC58W15cXFxcXCJdKSopXCJ8KCIrSSsiKSl8KSIrTSsiKlxcXSIsJD0iOigiK0krIikoPzpcXCgoKCcoKD86XFxcXC58W15cXFxcJ10pKiknfFwiKCg/OlxcXFwufFteXFxcXFwiXSkqKVwiKXwoKD86XFxcXC58W15cXFxcKClbXFxdXXwiK1crIikqKXwuKilcXCl8KSIsRj1uZXcgUmVnRXhwKE0rIisiLCJnIiksQj1uZXcgUmVnRXhwKCJeIitNKyIrfCgoPzpefFteXFxcXF0pKD86XFxcXC4pKikiK00rIiskIiwiZyIpLF89bmV3IFJlZ0V4cCgiXiIrTSsiKiwiK00rIioiKSx6PW5ldyBSZWdFeHAoIl4iK00rIiooWz4rfl18IitNKyIpIitNKyIqIiksVT1uZXcgUmVnRXhwKE0rInw+IiksWD1uZXcgUmVnRXhwKCQpLFY9bmV3IFJlZ0V4cCgiXiIrSSsiJCIpLEc9e0lEOm5ldyBSZWdFeHAoIl4jKCIrSSsiKSIpLENMQVNTOm5ldyBSZWdFeHAoIl5cXC4oIitJKyIpIiksVEFHOm5ldyBSZWdFeHAoIl4oIitJKyJ8WypdKSIpLEFUVFI6bmV3IFJlZ0V4cCgiXiIrVyksUFNFVURPOm5ldyBSZWdFeHAoIl4iKyQpLENISUxEOm5ldyBSZWdFeHAoIl46KG9ubHl8Zmlyc3R8bGFzdHxudGh8bnRoLWxhc3QpLShjaGlsZHxvZi10eXBlKSg/OlxcKCIrTSsiKihldmVufG9kZHwoKFsrLV18KShcXGQqKW58KSIrTSsiKig/OihbKy1dfCkiK00rIiooXFxkKyl8KSkiK00rIipcXCl8KSIsImkiKSxib29sOm5ldyBSZWdFeHAoIl4oPzoiK1IrIikkIiwiaSIpLG5lZWRzQ29udGV4dDpuZXcgUmVnRXhwKCJeIitNKyIqWz4rfl18OihldmVufG9kZHxlcXxndHxsdHxudGh8Zmlyc3R8bGFzdCkoPzpcXCgiK00rIiooKD86LVxcZCk/XFxkKikiK00rIipcXCl8KSg/PVteLV18JCkiLCJpIil9LFk9L0hUTUwkL2ksUT0vXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24pJC9pLEo9L15oXGQkL2ksSz0vXltee10rXHtccypcW25hdGl2ZSBcdy8sWj0vXig/OiMoW1x3LV0rKXwoXHcrKXxcLihbXHctXSspKSQvLGVlPS9bK35dLyx0ZT1uZXcgUmVnRXhwKCJcXFxcKFtcXGRhLWZdezEsNn0iK00rIj98KCIrTSsiKXwuKSIsImlnIiksbmU9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPSIweCIrdC02NTUzNjtyZXR1cm4gciE9cnx8bj90OnI8MD9TdHJpbmcuZnJvbUNoYXJDb2RlKHIrNjU1MzYpOlN0cmluZy5mcm9tQ2hhckNvZGUocj4+MTB8NTUyOTYsMTAyMyZyfDU2MzIwKX0scmU9LyhbXDAtXHgxZlx4N2ZdfF4tP1xkKXxeLSR8W15cMC1ceDFmXHg3Zi1cdUZGRkZcdy1dL2csaWU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdD8iXDAiPT09ZT8iXHVmZmZkIjplLnNsaWNlKDAsLTEpKyJcXCIrZS5jaGFyQ29kZUF0KGUubGVuZ3RoLTEpLnRvU3RyaW5nKDE2KSsiICI6IlxcIitlfSxvZT1mdW5jdGlvbigpe1QoKX0sYWU9YmUoZnVuY3Rpb24oZSl7cmV0dXJuITA9PT1lLmRpc2FibGVkJiYiZmllbGRzZXQiPT09ZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpfSx7ZGlyOiJwYXJlbnROb2RlIixuZXh0OiJsZWdlbmQifSk7dHJ5e0guYXBwbHkodD1PLmNhbGwobS5jaGlsZE5vZGVzKSxtLmNoaWxkTm9kZXMpLHRbbS5jaGlsZE5vZGVzLmxlbmd0aF0ubm9kZVR5cGV9Y2F0Y2goZSl7SD17YXBwbHk6dC5sZW5ndGg/ZnVuY3Rpb24oZSx0KXtMLmFwcGx5KGUsTy5jYWxsKHQpKX06ZnVuY3Rpb24oZSx0KXt2YXIgbj1lLmxlbmd0aCxyPTA7d2hpbGUoZVtuKytdPXRbcisrXSk7ZS5sZW5ndGg9bi0xfX19ZnVuY3Rpb24gc2UodCxlLG4scil7dmFyIGksbyxhLHMsdSxsLGMsZj1lJiZlLm93bmVyRG9jdW1lbnQscD1lP2Uubm9kZVR5cGU6OTtpZihuPW58fFtdLCJzdHJpbmciIT10eXBlb2YgdHx8IXR8fDEhPT1wJiY5IT09cCYmMTEhPT1wKXJldHVybiBuO2lmKCFyJiYoKGU/ZS5vd25lckRvY3VtZW50fHxlOm0pIT09QyYmVChlKSxlPWV8fEMsRSkpe2lmKDExIT09cCYmKHU9Wi5leGVjKHQpKSlpZihpPXVbMV0pe2lmKDk9PT1wKXtpZighKGE9ZS5nZXRFbGVtZW50QnlJZChpKSkpcmV0dXJuIG47aWYoYS5pZD09PWkpcmV0dXJuIG4ucHVzaChhKSxufWVsc2UgaWYoZiYmKGE9Zi5nZXRFbGVtZW50QnlJZChpKSkmJnkoZSxhKSYmYS5pZD09PWkpcmV0dXJuIG4ucHVzaChhKSxufWVsc2V7aWYodVsyXSlyZXR1cm4gSC5hcHBseShuLGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUodCkpLG47aWYoKGk9dVszXSkmJmQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSYmZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKXJldHVybiBILmFwcGx5KG4sZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGkpKSxufWlmKGQucXNhJiYhQVt0KyIgIl0mJighdnx8IXYudGVzdCh0KSkmJigxIT09cHx8Im9iamVjdCIhPT1lLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpKXtpZihjPXQsZj1lLDE9PT1wJiZVLnRlc3QodCkpeyhzPWUuZ2V0QXR0cmlidXRlKCJpZCIpKT9zPXMucmVwbGFjZShyZSxpZSk6ZS5zZXRBdHRyaWJ1dGUoImlkIixzPWspLG89KGw9aCh0KSkubGVuZ3RoO3doaWxlKG8tLSlsW29dPSIjIitzKyIgIit4ZShsW29dKTtjPWwuam9pbigiLCIpLGY9ZWUudGVzdCh0KSYmeWUoZS5wYXJlbnROb2RlKXx8ZX10cnl7cmV0dXJuIEguYXBwbHkobixmLnF1ZXJ5U2VsZWN0b3JBbGwoYykpLG59Y2F0Y2goZSl7QSh0LCEwKX1maW5hbGx5e3M9PT1rJiZlLnJlbW92ZUF0dHJpYnV0ZSgiaWQiKX19fXJldHVybiBnKHQucmVwbGFjZShCLCIkMSIpLGUsbixyKX1mdW5jdGlvbiB1ZSgpe3ZhciByPVtdO3JldHVybiBmdW5jdGlvbiBlKHQsbil7cmV0dXJuIHIucHVzaCh0KyIgIik+Yi5jYWNoZUxlbmd0aCYmZGVsZXRlIGVbci5zaGlmdCgpXSxlW3QrIiAiXT1ufX1mdW5jdGlvbiBsZShlKXtyZXR1cm4gZVtrXT0hMCxlfWZ1bmN0aW9uIGNlKGUpe3ZhciB0PUMuY3JlYXRlRWxlbWVudCgiZmllbGRzZXQiKTt0cnl7cmV0dXJuISFlKHQpfWNhdGNoKGUpe3JldHVybiExfWZpbmFsbHl7dC5wYXJlbnROb2RlJiZ0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodCksdD1udWxsfX1mdW5jdGlvbiBmZShlLHQpe3ZhciBuPWUuc3BsaXQoInwiKSxyPW4ubGVuZ3RoO3doaWxlKHItLSliLmF0dHJIYW5kbGVbbltyXV09dH1mdW5jdGlvbiBwZShlLHQpe3ZhciBuPXQmJmUscj1uJiYxPT09ZS5ub2RlVHlwZSYmMT09PXQubm9kZVR5cGUmJmUuc291cmNlSW5kZXgtdC5zb3VyY2VJbmRleDtpZihyKXJldHVybiByO2lmKG4pd2hpbGUobj1uLm5leHRTaWJsaW5nKWlmKG49PT10KXJldHVybi0xO3JldHVybiBlPzE6LTF9ZnVuY3Rpb24gZGUodCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiJpbnB1dCI9PT1lLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkmJmUudHlwZT09PXR9fWZ1bmN0aW9uIGhlKG4pe3JldHVybiBmdW5jdGlvbihlKXt2YXIgdD1lLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuKCJpbnB1dCI9PT10fHwiYnV0dG9uIj09PXQpJiZlLnR5cGU9PT1ufX1mdW5jdGlvbiBnZSh0KXtyZXR1cm4gZnVuY3Rpb24oZSl7cmV0dXJuImZvcm0iaW4gZT9lLnBhcmVudE5vZGUmJiExPT09ZS5kaXNhYmxlZD8ibGFiZWwiaW4gZT8ibGFiZWwiaW4gZS5wYXJlbnROb2RlP2UucGFyZW50Tm9kZS5kaXNhYmxlZD09PXQ6ZS5kaXNhYmxlZD09PXQ6ZS5pc0Rpc2FibGVkPT09dHx8ZS5pc0Rpc2FibGVkIT09IXQmJmFlKGUpPT09dDplLmRpc2FibGVkPT09dDoibGFiZWwiaW4gZSYmZS5kaXNhYmxlZD09PXR9fWZ1bmN0aW9uIHZlKGEpe3JldHVybiBsZShmdW5jdGlvbihvKXtyZXR1cm4gbz0rbyxsZShmdW5jdGlvbihlLHQpe3ZhciBuLHI9YShbXSxlLmxlbmd0aCxvKSxpPXIubGVuZ3RoO3doaWxlKGktLSllW249cltpXV0mJihlW25dPSEodFtuXT1lW25dKSl9KX0pfWZ1bmN0aW9uIHllKGUpe3JldHVybiBlJiYidW5kZWZpbmVkIiE9dHlwZW9mIGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUmJmV9Zm9yKGUgaW4gZD1zZS5zdXBwb3J0PXt9LGk9c2UuaXNYTUw9ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5uYW1lc3BhY2VVUkksbj0oZS5vd25lckRvY3VtZW50fHxlKS5kb2N1bWVudEVsZW1lbnQ7cmV0dXJuIVkudGVzdCh0fHxuJiZuLm5vZGVOYW1lfHwiSFRNTCIpfSxUPXNlLnNldERvY3VtZW50PWZ1bmN0aW9uKGUpe3ZhciB0LG4scj1lP2Uub3duZXJEb2N1bWVudHx8ZTptO3JldHVybiByIT09QyYmOT09PXIubm9kZVR5cGUmJnIuZG9jdW1lbnRFbGVtZW50JiYoYT0oQz1yKS5kb2N1bWVudEVsZW1lbnQsRT0haShDKSxtIT09QyYmKG49Qy5kZWZhdWx0VmlldykmJm4udG9wIT09biYmKG4uYWRkRXZlbnRMaXN0ZW5lcj9uLmFkZEV2ZW50TGlzdGVuZXIoInVubG9hZCIsb2UsITEpOm4uYXR0YWNoRXZlbnQmJm4uYXR0YWNoRXZlbnQoIm9udW5sb2FkIixvZSkpLGQuYXR0cmlidXRlcz1jZShmdW5jdGlvbihlKXtyZXR1cm4gZS5jbGFzc05hbWU9ImkiLCFlLmdldEF0dHJpYnV0ZSgiY2xhc3NOYW1lIil9KSxkLmdldEVsZW1lbnRzQnlUYWdOYW1lPWNlKGZ1bmN0aW9uKGUpe3JldHVybiBlLmFwcGVuZENoaWxkKEMuY3JlYXRlQ29tbWVudCgiIikpLCFlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikubGVuZ3RofSksZC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lPUsudGVzdChDLmdldEVsZW1lbnRzQnlDbGFzc05hbWUpLGQuZ2V0QnlJZD1jZShmdW5jdGlvbihlKXtyZXR1cm4gYS5hcHBlbmRDaGlsZChlKS5pZD1rLCFDLmdldEVsZW1lbnRzQnlOYW1lfHwhQy5nZXRFbGVtZW50c0J5TmFtZShrKS5sZW5ndGh9KSxkLmdldEJ5SWQ/KGIuZmlsdGVyLklEPWZ1bmN0aW9uKGUpe3ZhciB0PWUucmVwbGFjZSh0ZSxuZSk7cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiBlLmdldEF0dHJpYnV0ZSgiaWQiKT09PXR9fSxiLmZpbmQuSUQ9ZnVuY3Rpb24oZSx0KXtpZigidW5kZWZpbmVkIiE9dHlwZW9mIHQuZ2V0RWxlbWVudEJ5SWQmJkUpe3ZhciBuPXQuZ2V0RWxlbWVudEJ5SWQoZSk7cmV0dXJuIG4/W25dOltdfX0pOihiLmZpbHRlci5JRD1mdW5jdGlvbihlKXt2YXIgbj1lLnJlcGxhY2UodGUsbmUpO3JldHVybiBmdW5jdGlvbihlKXt2YXIgdD0idW5kZWZpbmVkIiE9dHlwZW9mIGUuZ2V0QXR0cmlidXRlTm9kZSYmZS5nZXRBdHRyaWJ1dGVOb2RlKCJpZCIpO3JldHVybiB0JiZ0LnZhbHVlPT09bn19LGIuZmluZC5JRD1mdW5jdGlvbihlLHQpe2lmKCJ1bmRlZmluZWQiIT10eXBlb2YgdC5nZXRFbGVtZW50QnlJZCYmRSl7dmFyIG4scixpLG89dC5nZXRFbGVtZW50QnlJZChlKTtpZihvKXtpZigobj1vLmdldEF0dHJpYnV0ZU5vZGUoImlkIikpJiZuLnZhbHVlPT09ZSlyZXR1cm5bb107aT10LmdldEVsZW1lbnRzQnlOYW1lKGUpLHI9MDt3aGlsZShvPWlbcisrXSlpZigobj1vLmdldEF0dHJpYnV0ZU5vZGUoImlkIikpJiZuLnZhbHVlPT09ZSlyZXR1cm5bb119cmV0dXJuW119fSksYi5maW5kLlRBRz1kLmdldEVsZW1lbnRzQnlUYWdOYW1lP2Z1bmN0aW9uKGUsdCl7cmV0dXJuInVuZGVmaW5lZCIhPXR5cGVvZiB0LmdldEVsZW1lbnRzQnlUYWdOYW1lP3QuZ2V0RWxlbWVudHNCeVRhZ05hbWUoZSk6ZC5xc2E/dC5xdWVyeVNlbGVjdG9yQWxsKGUpOnZvaWQgMH06ZnVuY3Rpb24oZSx0KXt2YXIgbixyPVtdLGk9MCxvPXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoZSk7aWYoIioiPT09ZSl7d2hpbGUobj1vW2krK10pMT09PW4ubm9kZVR5cGUmJnIucHVzaChuKTtyZXR1cm4gcn1yZXR1cm4gb30sYi5maW5kLkNMQVNTPWQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSYmZnVuY3Rpb24oZSx0KXtpZigidW5kZWZpbmVkIiE9dHlwZW9mIHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSYmRSlyZXR1cm4gdC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGUpfSxzPVtdLHY9W10sKGQucXNhPUsudGVzdChDLnF1ZXJ5U2VsZWN0b3JBbGwpKSYmKGNlKGZ1bmN0aW9uKGUpe2EuYXBwZW5kQ2hpbGQoZSkuaW5uZXJIVE1MPSI8YSBpZD0nIitrKyInPjwvYT48c2VsZWN0IGlkPSciK2srIi1cclxcJyBtc2FsbG93Y2FwdHVyZT0nJz48b3B0aW9uIHNlbGVjdGVkPScnPjwvb3B0aW9uPjwvc2VsZWN0PiIsZS5xdWVyeVNlbGVjdG9yQWxsKCJbbXNhbGxvd2NhcHR1cmVePScnXSIpLmxlbmd0aCYmdi5wdXNoKCJbKl4kXT0iK00rIiooPzonJ3xcIlwiKSIpLGUucXVlcnlTZWxlY3RvckFsbCgiW3NlbGVjdGVkXSIpLmxlbmd0aHx8di5wdXNoKCJcXFsiK00rIiooPzp2YWx1ZXwiK1IrIikiKSxlLnF1ZXJ5U2VsZWN0b3JBbGwoIltpZH49IitrKyItXSIpLmxlbmd0aHx8di5wdXNoKCJ+PSIpLGUucXVlcnlTZWxlY3RvckFsbCgiOmNoZWNrZWQiKS5sZW5ndGh8fHYucHVzaCgiOmNoZWNrZWQiKSxlLnF1ZXJ5U2VsZWN0b3JBbGwoImEjIitrKyIrKiIpLmxlbmd0aHx8di5wdXNoKCIuIy4rWyt+XSIpfSksY2UoZnVuY3Rpb24oZSl7ZS5pbm5lckhUTUw9IjxhIGhyZWY9JycgZGlzYWJsZWQ9J2Rpc2FibGVkJz48L2E+PHNlbGVjdCBkaXNhYmxlZD0nZGlzYWJsZWQnPjxvcHRpb24vPjwvc2VsZWN0PiI7dmFyIHQ9Qy5jcmVhdGVFbGVtZW50KCJpbnB1dCIpO3Quc2V0QXR0cmlidXRlKCJ0eXBlIiwiaGlkZGVuIiksZS5hcHBlbmRDaGlsZCh0KS5zZXRBdHRyaWJ1dGUoIm5hbWUiLCJEIiksZS5xdWVyeVNlbGVjdG9yQWxsKCJbbmFtZT1kXSIpLmxlbmd0aCYmdi5wdXNoKCJuYW1lIitNKyIqWypeJHwhfl0/PSIpLDIhPT1lLnF1ZXJ5U2VsZWN0b3JBbGwoIjplbmFibGVkIikubGVuZ3RoJiZ2LnB1c2goIjplbmFibGVkIiwiOmRpc2FibGVkIiksYS5hcHBlbmRDaGlsZChlKS5kaXNhYmxlZD0hMCwyIT09ZS5xdWVyeVNlbGVjdG9yQWxsKCI6ZGlzYWJsZWQiKS5sZW5ndGgmJnYucHVzaCgiOmVuYWJsZWQiLCI6ZGlzYWJsZWQiKSxlLnF1ZXJ5U2VsZWN0b3JBbGwoIiosOngiKSx2LnB1c2goIiwuKjoiKX0pKSwoZC5tYXRjaGVzU2VsZWN0b3I9Sy50ZXN0KGM9YS5tYXRjaGVzfHxhLndlYmtpdE1hdGNoZXNTZWxlY3Rvcnx8YS5tb3pNYXRjaGVzU2VsZWN0b3J8fGEub01hdGNoZXNTZWxlY3Rvcnx8YS5tc01hdGNoZXNTZWxlY3RvcikpJiZjZShmdW5jdGlvbihlKXtkLmRpc2Nvbm5lY3RlZE1hdGNoPWMuY2FsbChlLCIqIiksYy5jYWxsKGUsIltzIT0nJ106eCIpLHMucHVzaCgiIT0iLCQpfSksdj12Lmxlbmd0aCYmbmV3IFJlZ0V4cCh2LmpvaW4oInwiKSkscz1zLmxlbmd0aCYmbmV3IFJlZ0V4cChzLmpvaW4oInwiKSksdD1LLnRlc3QoYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbikseT10fHxLLnRlc3QoYS5jb250YWlucyk/ZnVuY3Rpb24oZSx0KXt2YXIgbj05PT09ZS5ub2RlVHlwZT9lLmRvY3VtZW50RWxlbWVudDplLHI9dCYmdC5wYXJlbnROb2RlO3JldHVybiBlPT09cnx8ISghcnx8MSE9PXIubm9kZVR5cGV8fCEobi5jb250YWlucz9uLmNvbnRhaW5zKHIpOmUuY29tcGFyZURvY3VtZW50UG9zaXRpb24mJjE2JmUuY29tcGFyZURvY3VtZW50UG9zaXRpb24ocikpKX06ZnVuY3Rpb24oZSx0KXtpZih0KXdoaWxlKHQ9dC5wYXJlbnROb2RlKWlmKHQ9PT1lKXJldHVybiEwO3JldHVybiExfSxEPXQ/ZnVuY3Rpb24oZSx0KXtpZihlPT09dClyZXR1cm4gbD0hMCwwO3ZhciBuPSFlLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uLSF0LmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uO3JldHVybiBufHwoMSYobj0oZS5vd25lckRvY3VtZW50fHxlKT09PSh0Lm93bmVyRG9jdW1lbnR8fHQpP2UuY29tcGFyZURvY3VtZW50UG9zaXRpb24odCk6MSl8fCFkLnNvcnREZXRhY2hlZCYmdC5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihlKT09PW4/ZT09PUN8fGUub3duZXJEb2N1bWVudD09PW0mJnkobSxlKT8tMTp0PT09Q3x8dC5vd25lckRvY3VtZW50PT09bSYmeShtLHQpPzE6dT9QKHUsZSktUCh1LHQpOjA6NCZuPy0xOjEpfTpmdW5jdGlvbihlLHQpe2lmKGU9PT10KXJldHVybiBsPSEwLDA7dmFyIG4scj0wLGk9ZS5wYXJlbnROb2RlLG89dC5wYXJlbnROb2RlLGE9W2VdLHM9W3RdO2lmKCFpfHwhbylyZXR1cm4gZT09PUM/LTE6dD09PUM/MTppPy0xOm8/MTp1P1AodSxlKS1QKHUsdCk6MDtpZihpPT09bylyZXR1cm4gcGUoZSx0KTtuPWU7d2hpbGUobj1uLnBhcmVudE5vZGUpYS51bnNoaWZ0KG4pO249dDt3aGlsZShuPW4ucGFyZW50Tm9kZSlzLnVuc2hpZnQobik7d2hpbGUoYVtyXT09PXNbcl0pcisrO3JldHVybiByP3BlKGFbcl0sc1tyXSk6YVtyXT09PW0/LTE6c1tyXT09PW0/MTowfSksQ30sc2UubWF0Y2hlcz1mdW5jdGlvbihlLHQpe3JldHVybiBzZShlLG51bGwsbnVsbCx0KX0sc2UubWF0Y2hlc1NlbGVjdG9yPWZ1bmN0aW9uKGUsdCl7aWYoKGUub3duZXJEb2N1bWVudHx8ZSkhPT1DJiZUKGUpLGQubWF0Y2hlc1NlbGVjdG9yJiZFJiYhQVt0KyIgIl0mJighc3x8IXMudGVzdCh0KSkmJighdnx8IXYudGVzdCh0KSkpdHJ5e3ZhciBuPWMuY2FsbChlLHQpO2lmKG58fGQuZGlzY29ubmVjdGVkTWF0Y2h8fGUuZG9jdW1lbnQmJjExIT09ZS5kb2N1bWVudC5ub2RlVHlwZSlyZXR1cm4gbn1jYXRjaChlKXtBKHQsITApfXJldHVybiAwPHNlKHQsQyxudWxsLFtlXSkubGVuZ3RofSxzZS5jb250YWlucz1mdW5jdGlvbihlLHQpe3JldHVybihlLm93bmVyRG9jdW1lbnR8fGUpIT09QyYmVChlKSx5KGUsdCl9LHNlLmF0dHI9ZnVuY3Rpb24oZSx0KXsoZS5vd25lckRvY3VtZW50fHxlKSE9PUMmJlQoZSk7dmFyIG49Yi5hdHRySGFuZGxlW3QudG9Mb3dlckNhc2UoKV0scj1uJiZqLmNhbGwoYi5hdHRySGFuZGxlLHQudG9Mb3dlckNhc2UoKSk/bihlLHQsIUUpOnZvaWQgMDtyZXR1cm4gdm9pZCAwIT09cj9yOmQuYXR0cmlidXRlc3x8IUU/ZS5nZXRBdHRyaWJ1dGUodCk6KHI9ZS5nZXRBdHRyaWJ1dGVOb2RlKHQpKSYmci5zcGVjaWZpZWQ/ci52YWx1ZTpudWxsfSxzZS5lc2NhcGU9ZnVuY3Rpb24oZSl7cmV0dXJuKGUrIiIpLnJlcGxhY2UocmUsaWUpfSxzZS5lcnJvcj1mdW5jdGlvbihlKXt0aHJvdyBuZXcgRXJyb3IoIlN5bnRheCBlcnJvciwgdW5yZWNvZ25pemVkIGV4cHJlc3Npb246ICIrZSl9LHNlLnVuaXF1ZVNvcnQ9ZnVuY3Rpb24oZSl7dmFyIHQsbj1bXSxyPTAsaT0wO2lmKGw9IWQuZGV0ZWN0RHVwbGljYXRlcyx1PSFkLnNvcnRTdGFibGUmJmUuc2xpY2UoMCksZS5zb3J0KEQpLGwpe3doaWxlKHQ9ZVtpKytdKXQ9PT1lW2ldJiYocj1uLnB1c2goaSkpO3doaWxlKHItLSllLnNwbGljZShuW3JdLDEpfXJldHVybiB1PW51bGwsZX0sbz1zZS5nZXRUZXh0PWZ1bmN0aW9uKGUpe3ZhciB0LG49IiIscj0wLGk9ZS5ub2RlVHlwZTtpZihpKXtpZigxPT09aXx8OT09PWl8fDExPT09aSl7aWYoInN0cmluZyI9PXR5cGVvZiBlLnRleHRDb250ZW50KXJldHVybiBlLnRleHRDb250ZW50O2ZvcihlPWUuZmlyc3RDaGlsZDtlO2U9ZS5uZXh0U2libGluZyluKz1vKGUpfWVsc2UgaWYoMz09PWl8fDQ9PT1pKXJldHVybiBlLm5vZGVWYWx1ZX1lbHNlIHdoaWxlKHQ9ZVtyKytdKW4rPW8odCk7cmV0dXJuIG59LChiPXNlLnNlbGVjdG9ycz17Y2FjaGVMZW5ndGg6NTAsY3JlYXRlUHNldWRvOmxlLG1hdGNoOkcsYXR0ckhhbmRsZTp7fSxmaW5kOnt9LHJlbGF0aXZlOnsiPiI6e2RpcjoicGFyZW50Tm9kZSIsZmlyc3Q6ITB9LCIgIjp7ZGlyOiJwYXJlbnROb2RlIn0sIisiOntkaXI6InByZXZpb3VzU2libGluZyIsZmlyc3Q6ITB9LCJ+Ijp7ZGlyOiJwcmV2aW91c1NpYmxpbmcifX0scHJlRmlsdGVyOntBVFRSOmZ1bmN0aW9uKGUpe3JldHVybiBlWzFdPWVbMV0ucmVwbGFjZSh0ZSxuZSksZVszXT0oZVszXXx8ZVs0XXx8ZVs1XXx8IiIpLnJlcGxhY2UodGUsbmUpLCJ+PSI9PT1lWzJdJiYoZVszXT0iICIrZVszXSsiICIpLGUuc2xpY2UoMCw0KX0sQ0hJTEQ6ZnVuY3Rpb24oZSl7cmV0dXJuIGVbMV09ZVsxXS50b0xvd2VyQ2FzZSgpLCJudGgiPT09ZVsxXS5zbGljZSgwLDMpPyhlWzNdfHxzZS5lcnJvcihlWzBdKSxlWzRdPSsoZVs0XT9lWzVdKyhlWzZdfHwxKToyKigiZXZlbiI9PT1lWzNdfHwib2RkIj09PWVbM10pKSxlWzVdPSsoZVs3XStlWzhdfHwib2RkIj09PWVbM10pKTplWzNdJiZzZS5lcnJvcihlWzBdKSxlfSxQU0VVRE86ZnVuY3Rpb24oZSl7dmFyIHQsbj0hZVs2XSYmZVsyXTtyZXR1cm4gRy5DSElMRC50ZXN0KGVbMF0pP251bGw6KGVbM10/ZVsyXT1lWzRdfHxlWzVdfHwiIjpuJiZYLnRlc3QobikmJih0PWgobiwhMCkpJiYodD1uLmluZGV4T2YoIikiLG4ubGVuZ3RoLXQpLW4ubGVuZ3RoKSYmKGVbMF09ZVswXS5zbGljZSgwLHQpLGVbMl09bi5zbGljZSgwLHQpKSxlLnNsaWNlKDAsMykpfX0sZmlsdGVyOntUQUc6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5yZXBsYWNlKHRlLG5lKS50b0xvd2VyQ2FzZSgpO3JldHVybiIqIj09PWU/ZnVuY3Rpb24oKXtyZXR1cm4hMH06ZnVuY3Rpb24oZSl7cmV0dXJuIGUubm9kZU5hbWUmJmUubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PXR9fSxDTEFTUzpmdW5jdGlvbihlKXt2YXIgdD1wW2UrIiAiXTtyZXR1cm4gdHx8KHQ9bmV3IFJlZ0V4cCgiKF58IitNKyIpIitlKyIoIitNKyJ8JCkiKSkmJnAoZSxmdW5jdGlvbihlKXtyZXR1cm4gdC50ZXN0KCJzdHJpbmciPT10eXBlb2YgZS5jbGFzc05hbWUmJmUuY2xhc3NOYW1lfHwidW5kZWZpbmVkIiE9dHlwZW9mIGUuZ2V0QXR0cmlidXRlJiZlLmdldEF0dHJpYnV0ZSgiY2xhc3MiKXx8IiIpfSl9LEFUVFI6ZnVuY3Rpb24obixyLGkpe3JldHVybiBmdW5jdGlvbihlKXt2YXIgdD1zZS5hdHRyKGUsbik7cmV0dXJuIG51bGw9PXQ/IiE9Ij09PXI6IXJ8fCh0Kz0iIiwiPSI9PT1yP3Q9PT1pOiIhPSI9PT1yP3QhPT1pOiJePSI9PT1yP2kmJjA9PT10LmluZGV4T2YoaSk6Iio9Ij09PXI/aSYmLTE8dC5pbmRleE9mKGkpOiIkPSI9PT1yP2kmJnQuc2xpY2UoLWkubGVuZ3RoKT09PWk6In49Ij09PXI/LTE8KCIgIit0LnJlcGxhY2UoRiwiICIpKyIgIikuaW5kZXhPZihpKToifD0iPT09ciYmKHQ9PT1pfHx0LnNsaWNlKDAsaS5sZW5ndGgrMSk9PT1pKyItIikpfX0sQ0hJTEQ6ZnVuY3Rpb24oaCxlLHQsZyx2KXt2YXIgeT0ibnRoIiE9PWguc2xpY2UoMCwzKSxtPSJsYXN0IiE9PWguc2xpY2UoLTQpLHg9Im9mLXR5cGUiPT09ZTtyZXR1cm4gMT09PWcmJjA9PT12P2Z1bmN0aW9uKGUpe3JldHVybiEhZS5wYXJlbnROb2RlfTpmdW5jdGlvbihlLHQsbil7dmFyIHIsaSxvLGEscyx1LGw9eSE9PW0/Im5leHRTaWJsaW5nIjoicHJldmlvdXNTaWJsaW5nIixjPWUucGFyZW50Tm9kZSxmPXgmJmUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxwPSFuJiYheCxkPSExO2lmKGMpe2lmKHkpe3doaWxlKGwpe2E9ZTt3aGlsZShhPWFbbF0paWYoeD9hLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT1mOjE9PT1hLm5vZGVUeXBlKXJldHVybiExO3U9bD0ib25seSI9PT1oJiYhdSYmIm5leHRTaWJsaW5nIn1yZXR1cm4hMH1pZih1PVttP2MuZmlyc3RDaGlsZDpjLmxhc3RDaGlsZF0sbSYmcCl7ZD0ocz0ocj0oaT0obz0oYT1jKVtrXXx8KGFba109e30pKVthLnVuaXF1ZUlEXXx8KG9bYS51bmlxdWVJRF09e30pKVtoXXx8W10pWzBdPT09UyYmclsxXSkmJnJbMl0sYT1zJiZjLmNoaWxkTm9kZXNbc107d2hpbGUoYT0rK3MmJmEmJmFbbF18fChkPXM9MCl8fHUucG9wKCkpaWYoMT09PWEubm9kZVR5cGUmJisrZCYmYT09PWUpe2lbaF09W1MscyxkXTticmVha319ZWxzZSBpZihwJiYoZD1zPShyPShpPShvPShhPWUpW2tdfHwoYVtrXT17fSkpW2EudW5pcXVlSURdfHwob1thLnVuaXF1ZUlEXT17fSkpW2hdfHxbXSlbMF09PT1TJiZyWzFdKSwhMT09PWQpd2hpbGUoYT0rK3MmJmEmJmFbbF18fChkPXM9MCl8fHUucG9wKCkpaWYoKHg/YS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09ZjoxPT09YS5ub2RlVHlwZSkmJisrZCYmKHAmJigoaT0obz1hW2tdfHwoYVtrXT17fSkpW2EudW5pcXVlSURdfHwob1thLnVuaXF1ZUlEXT17fSkpW2hdPVtTLGRdKSxhPT09ZSkpYnJlYWs7cmV0dXJuKGQtPXYpPT09Z3x8ZCVnPT0wJiYwPD1kL2d9fX0sUFNFVURPOmZ1bmN0aW9uKGUsbyl7dmFyIHQsYT1iLnBzZXVkb3NbZV18fGIuc2V0RmlsdGVyc1tlLnRvTG93ZXJDYXNlKCldfHxzZS5lcnJvcigidW5zdXBwb3J0ZWQgcHNldWRvOiAiK2UpO3JldHVybiBhW2tdP2Eobyk6MTxhLmxlbmd0aD8odD1bZSxlLCIiLG9dLGIuc2V0RmlsdGVycy5oYXNPd25Qcm9wZXJ0eShlLnRvTG93ZXJDYXNlKCkpP2xlKGZ1bmN0aW9uKGUsdCl7dmFyIG4scj1hKGUsbyksaT1yLmxlbmd0aDt3aGlsZShpLS0pZVtuPVAoZSxyW2ldKV09ISh0W25dPXJbaV0pfSk6ZnVuY3Rpb24oZSl7cmV0dXJuIGEoZSwwLHQpfSk6YX19LHBzZXVkb3M6e25vdDpsZShmdW5jdGlvbihlKXt2YXIgcj1bXSxpPVtdLHM9ZihlLnJlcGxhY2UoQiwiJDEiKSk7cmV0dXJuIHNba10/bGUoZnVuY3Rpb24oZSx0LG4scil7dmFyIGksbz1zKGUsbnVsbCxyLFtdKSxhPWUubGVuZ3RoO3doaWxlKGEtLSkoaT1vW2FdKSYmKGVbYV09ISh0W2FdPWkpKX0pOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gclswXT1lLHMocixudWxsLG4saSksclswXT1udWxsLCFpLnBvcCgpfX0pLGhhczpsZShmdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSl7cmV0dXJuIDA8c2UodCxlKS5sZW5ndGh9fSksY29udGFpbnM6bGUoZnVuY3Rpb24odCl7cmV0dXJuIHQ9dC5yZXBsYWNlKHRlLG5lKSxmdW5jdGlvbihlKXtyZXR1cm4tMTwoZS50ZXh0Q29udGVudHx8byhlKSkuaW5kZXhPZih0KX19KSxsYW5nOmxlKGZ1bmN0aW9uKG4pe3JldHVybiBWLnRlc3Qobnx8IiIpfHxzZS5lcnJvcigidW5zdXBwb3J0ZWQgbGFuZzogIituKSxuPW4ucmVwbGFjZSh0ZSxuZSkudG9Mb3dlckNhc2UoKSxmdW5jdGlvbihlKXt2YXIgdDtkb3tpZih0PUU/ZS5sYW5nOmUuZ2V0QXR0cmlidXRlKCJ4bWw6bGFuZyIpfHxlLmdldEF0dHJpYnV0ZSgibGFuZyIpKXJldHVybih0PXQudG9Mb3dlckNhc2UoKSk9PT1ufHwwPT09dC5pbmRleE9mKG4rIi0iKX13aGlsZSgoZT1lLnBhcmVudE5vZGUpJiYxPT09ZS5ub2RlVHlwZSk7cmV0dXJuITF9fSksdGFyZ2V0OmZ1bmN0aW9uKGUpe3ZhciB0PW4ubG9jYXRpb24mJm4ubG9jYXRpb24uaGFzaDtyZXR1cm4gdCYmdC5zbGljZSgxKT09PWUuaWR9LHJvb3Q6ZnVuY3Rpb24oZSl7cmV0dXJuIGU9PT1hfSxmb2N1czpmdW5jdGlvbihlKXtyZXR1cm4gZT09PUMuYWN0aXZlRWxlbWVudCYmKCFDLmhhc0ZvY3VzfHxDLmhhc0ZvY3VzKCkpJiYhIShlLnR5cGV8fGUuaHJlZnx8fmUudGFiSW5kZXgpfSxlbmFibGVkOmdlKCExKSxkaXNhYmxlZDpnZSghMCksY2hlY2tlZDpmdW5jdGlvbihlKXt2YXIgdD1lLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuImlucHV0Ij09PXQmJiEhZS5jaGVja2VkfHwib3B0aW9uIj09PXQmJiEhZS5zZWxlY3RlZH0sc2VsZWN0ZWQ6ZnVuY3Rpb24oZSl7cmV0dXJuIGUucGFyZW50Tm9kZSYmZS5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXgsITA9PT1lLnNlbGVjdGVkfSxlbXB0eTpmdW5jdGlvbihlKXtmb3IoZT1lLmZpcnN0Q2hpbGQ7ZTtlPWUubmV4dFNpYmxpbmcpaWYoZS5ub2RlVHlwZTw2KXJldHVybiExO3JldHVybiEwfSxwYXJlbnQ6ZnVuY3Rpb24oZSl7cmV0dXJuIWIucHNldWRvcy5lbXB0eShlKX0saGVhZGVyOmZ1bmN0aW9uKGUpe3JldHVybiBKLnRlc3QoZS5ub2RlTmFtZSl9LGlucHV0OmZ1bmN0aW9uKGUpe3JldHVybiBRLnRlc3QoZS5ub2RlTmFtZSl9LGJ1dHRvbjpmdW5jdGlvbihlKXt2YXIgdD1lLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuImlucHV0Ij09PXQmJiJidXR0b24iPT09ZS50eXBlfHwiYnV0dG9uIj09PXR9LHRleHQ6ZnVuY3Rpb24oZSl7dmFyIHQ7cmV0dXJuImlucHV0Ij09PWUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSYmInRleHQiPT09ZS50eXBlJiYobnVsbD09KHQ9ZS5nZXRBdHRyaWJ1dGUoInR5cGUiKSl8fCJ0ZXh0Ij09PXQudG9Mb3dlckNhc2UoKSl9LGZpcnN0OnZlKGZ1bmN0aW9uKCl7cmV0dXJuWzBdfSksbGFzdDp2ZShmdW5jdGlvbihlLHQpe3JldHVyblt0LTFdfSksZXE6dmUoZnVuY3Rpb24oZSx0LG4pe3JldHVybltuPDA/bit0Om5dfSksZXZlbjp2ZShmdW5jdGlvbihlLHQpe2Zvcih2YXIgbj0wO248dDtuKz0yKWUucHVzaChuKTtyZXR1cm4gZX0pLG9kZDp2ZShmdW5jdGlvbihlLHQpe2Zvcih2YXIgbj0xO248dDtuKz0yKWUucHVzaChuKTtyZXR1cm4gZX0pLGx0OnZlKGZ1bmN0aW9uKGUsdCxuKXtmb3IodmFyIHI9bjwwP24rdDp0PG4/dDpuOzA8PS0tcjspZS5wdXNoKHIpO3JldHVybiBlfSksZ3Q6dmUoZnVuY3Rpb24oZSx0LG4pe2Zvcih2YXIgcj1uPDA/bit0Om47KytyPHQ7KWUucHVzaChyKTtyZXR1cm4gZX0pfX0pLnBzZXVkb3MubnRoPWIucHNldWRvcy5lcSx7cmFkaW86ITAsY2hlY2tib3g6ITAsZmlsZTohMCxwYXNzd29yZDohMCxpbWFnZTohMH0pYi5wc2V1ZG9zW2VdPWRlKGUpO2ZvcihlIGlue3N1Ym1pdDohMCxyZXNldDohMH0pYi5wc2V1ZG9zW2VdPWhlKGUpO2Z1bmN0aW9uIG1lKCl7fWZ1bmN0aW9uIHhlKGUpe2Zvcih2YXIgdD0wLG49ZS5sZW5ndGgscj0iIjt0PG47dCsrKXIrPWVbdF0udmFsdWU7cmV0dXJuIHJ9ZnVuY3Rpb24gYmUocyxlLHQpe3ZhciB1PWUuZGlyLGw9ZS5uZXh0LGM9bHx8dSxmPXQmJiJwYXJlbnROb2RlIj09PWMscD1yKys7cmV0dXJuIGUuZmlyc3Q/ZnVuY3Rpb24oZSx0LG4pe3doaWxlKGU9ZVt1XSlpZigxPT09ZS5ub2RlVHlwZXx8ZilyZXR1cm4gcyhlLHQsbik7cmV0dXJuITF9OmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG8sYT1bUyxwXTtpZihuKXt3aGlsZShlPWVbdV0paWYoKDE9PT1lLm5vZGVUeXBlfHxmKSYmcyhlLHQsbikpcmV0dXJuITB9ZWxzZSB3aGlsZShlPWVbdV0paWYoMT09PWUubm9kZVR5cGV8fGYpaWYoaT0obz1lW2tdfHwoZVtrXT17fSkpW2UudW5pcXVlSURdfHwob1tlLnVuaXF1ZUlEXT17fSksbCYmbD09PWUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSllPWVbdV18fGU7ZWxzZXtpZigocj1pW2NdKSYmclswXT09PVMmJnJbMV09PT1wKXJldHVybiBhWzJdPXJbMl07aWYoKGlbY109YSlbMl09cyhlLHQsbikpcmV0dXJuITB9cmV0dXJuITF9fWZ1bmN0aW9uIHdlKGkpe3JldHVybiAxPGkubGVuZ3RoP2Z1bmN0aW9uKGUsdCxuKXt2YXIgcj1pLmxlbmd0aDt3aGlsZShyLS0paWYoIWlbcl0oZSx0LG4pKXJldHVybiExO3JldHVybiEwfTppWzBdfWZ1bmN0aW9uIFRlKGUsdCxuLHIsaSl7Zm9yKHZhciBvLGE9W10scz0wLHU9ZS5sZW5ndGgsbD1udWxsIT10O3M8dTtzKyspKG89ZVtzXSkmJihuJiYhbihvLHIsaSl8fChhLnB1c2gobyksbCYmdC5wdXNoKHMpKSk7cmV0dXJuIGF9ZnVuY3Rpb24gQ2UoZCxoLGcsdix5LGUpe3JldHVybiB2JiYhdltrXSYmKHY9Q2UodikpLHkmJiF5W2tdJiYoeT1DZSh5LGUpKSxsZShmdW5jdGlvbihlLHQsbixyKXt2YXIgaSxvLGEscz1bXSx1PVtdLGw9dC5sZW5ndGgsYz1lfHxmdW5jdGlvbihlLHQsbil7Zm9yKHZhciByPTAsaT10Lmxlbmd0aDtyPGk7cisrKXNlKGUsdFtyXSxuKTtyZXR1cm4gbn0oaHx8IioiLG4ubm9kZVR5cGU/W25dOm4sW10pLGY9IWR8fCFlJiZoP2M6VGUoYyxzLGQsbixyKSxwPWc/eXx8KGU/ZDpsfHx2KT9bXTp0OmY7aWYoZyYmZyhmLHAsbixyKSx2KXtpPVRlKHAsdSksdihpLFtdLG4sciksbz1pLmxlbmd0aDt3aGlsZShvLS0pKGE9aVtvXSkmJihwW3Vbb11dPSEoZlt1W29dXT1hKSl9aWYoZSl7aWYoeXx8ZCl7aWYoeSl7aT1bXSxvPXAubGVuZ3RoO3doaWxlKG8tLSkoYT1wW29dKSYmaS5wdXNoKGZbb109YSk7eShudWxsLHA9W10saSxyKX1vPXAubGVuZ3RoO3doaWxlKG8tLSkoYT1wW29dKSYmLTE8KGk9eT9QKGUsYSk6c1tvXSkmJihlW2ldPSEodFtpXT1hKSl9fWVsc2UgcD1UZShwPT09dD9wLnNwbGljZShsLHAubGVuZ3RoKTpwKSx5P3kobnVsbCx0LHAscik6SC5hcHBseSh0LHApfSl9ZnVuY3Rpb24gRWUoZSl7Zm9yKHZhciBpLHQsbixyPWUubGVuZ3RoLG89Yi5yZWxhdGl2ZVtlWzBdLnR5cGVdLGE9b3x8Yi5yZWxhdGl2ZVsiICJdLHM9bz8xOjAsdT1iZShmdW5jdGlvbihlKXtyZXR1cm4gZT09PWl9LGEsITApLGw9YmUoZnVuY3Rpb24oZSl7cmV0dXJuLTE8UChpLGUpfSxhLCEwKSxjPVtmdW5jdGlvbihlLHQsbil7dmFyIHI9IW8mJihufHx0IT09dyl8fCgoaT10KS5ub2RlVHlwZT91KGUsdCxuKTpsKGUsdCxuKSk7cmV0dXJuIGk9bnVsbCxyfV07czxyO3MrKylpZih0PWIucmVsYXRpdmVbZVtzXS50eXBlXSljPVtiZSh3ZShjKSx0KV07ZWxzZXtpZigodD1iLmZpbHRlcltlW3NdLnR5cGVdLmFwcGx5KG51bGwsZVtzXS5tYXRjaGVzKSlba10pe2ZvcihuPSsrcztuPHI7bisrKWlmKGIucmVsYXRpdmVbZVtuXS50eXBlXSlicmVhaztyZXR1cm4gQ2UoMTxzJiZ3ZShjKSwxPHMmJnhlKGUuc2xpY2UoMCxzLTEpLmNvbmNhdCh7dmFsdWU6IiAiPT09ZVtzLTJdLnR5cGU/IioiOiIifSkpLnJlcGxhY2UoQiwiJDEiKSx0LHM8biYmRWUoZS5zbGljZShzLG4pKSxuPHImJkVlKGU9ZS5zbGljZShuKSksbjxyJiZ4ZShlKSl9Yy5wdXNoKHQpfXJldHVybiB3ZShjKX1yZXR1cm4gbWUucHJvdG90eXBlPWIuZmlsdGVycz1iLnBzZXVkb3MsYi5zZXRGaWx0ZXJzPW5ldyBtZSxoPXNlLnRva2VuaXplPWZ1bmN0aW9uKGUsdCl7dmFyIG4scixpLG8sYSxzLHUsbD14W2UrIiAiXTtpZihsKXJldHVybiB0PzA6bC5zbGljZSgwKTthPWUscz1bXSx1PWIucHJlRmlsdGVyO3doaWxlKGEpe2ZvcihvIGluIG4mJiEocj1fLmV4ZWMoYSkpfHwociYmKGE9YS5zbGljZShyWzBdLmxlbmd0aCl8fGEpLHMucHVzaChpPVtdKSksbj0hMSwocj16LmV4ZWMoYSkpJiYobj1yLnNoaWZ0KCksaS5wdXNoKHt2YWx1ZTpuLHR5cGU6clswXS5yZXBsYWNlKEIsIiAiKX0pLGE9YS5zbGljZShuLmxlbmd0aCkpLGIuZmlsdGVyKSEocj1HW29dLmV4ZWMoYSkpfHx1W29dJiYhKHI9dVtvXShyKSl8fChuPXIuc2hpZnQoKSxpLnB1c2goe3ZhbHVlOm4sdHlwZTpvLG1hdGNoZXM6cn0pLGE9YS5zbGljZShuLmxlbmd0aCkpO2lmKCFuKWJyZWFrfXJldHVybiB0P2EubGVuZ3RoOmE/c2UuZXJyb3IoZSk6eChlLHMpLnNsaWNlKDApfSxmPXNlLmNvbXBpbGU9ZnVuY3Rpb24oZSx0KXt2YXIgbix2LHksbSx4LHIsaT1bXSxvPVtdLGE9TltlKyIgIl07aWYoIWEpe3R8fCh0PWgoZSkpLG49dC5sZW5ndGg7d2hpbGUobi0tKShhPUVlKHRbbl0pKVtrXT9pLnB1c2goYSk6by5wdXNoKGEpOyhhPU4oZSwodj1vLG09MDwoeT1pKS5sZW5ndGgseD0wPHYubGVuZ3RoLHI9ZnVuY3Rpb24oZSx0LG4scixpKXt2YXIgbyxhLHMsdT0wLGw9IjAiLGM9ZSYmW10sZj1bXSxwPXcsZD1lfHx4JiZiLmZpbmQuVEFHKCIqIixpKSxoPVMrPW51bGw9PXA/MTpNYXRoLnJhbmRvbSgpfHwuMSxnPWQubGVuZ3RoO2ZvcihpJiYodz10PT09Q3x8dHx8aSk7bCE9PWcmJm51bGwhPShvPWRbbF0pO2wrKyl7aWYoeCYmbyl7YT0wLHR8fG8ub3duZXJEb2N1bWVudD09PUN8fChUKG8pLG49IUUpO3doaWxlKHM9dlthKytdKWlmKHMobyx0fHxDLG4pKXtyLnB1c2gobyk7YnJlYWt9aSYmKFM9aCl9bSYmKChvPSFzJiZvKSYmdS0tLGUmJmMucHVzaChvKSl9aWYodSs9bCxtJiZsIT09dSl7YT0wO3doaWxlKHM9eVthKytdKXMoYyxmLHQsbik7aWYoZSl7aWYoMDx1KXdoaWxlKGwtLSljW2xdfHxmW2xdfHwoZltsXT1xLmNhbGwocikpO2Y9VGUoZil9SC5hcHBseShyLGYpLGkmJiFlJiYwPGYubGVuZ3RoJiYxPHUreS5sZW5ndGgmJnNlLnVuaXF1ZVNvcnQocil9cmV0dXJuIGkmJihTPWgsdz1wKSxjfSxtP2xlKHIpOnIpKSkuc2VsZWN0b3I9ZX1yZXR1cm4gYX0sZz1zZS5zZWxlY3Q9ZnVuY3Rpb24oZSx0LG4scil7dmFyIGksbyxhLHMsdSxsPSJmdW5jdGlvbiI9PXR5cGVvZiBlJiZlLGM9IXImJmgoZT1sLnNlbGVjdG9yfHxlKTtpZihuPW58fFtdLDE9PT1jLmxlbmd0aCl7aWYoMjwobz1jWzBdPWNbMF0uc2xpY2UoMCkpLmxlbmd0aCYmIklEIj09PShhPW9bMF0pLnR5cGUmJjk9PT10Lm5vZGVUeXBlJiZFJiZiLnJlbGF0aXZlW29bMV0udHlwZV0pe2lmKCEodD0oYi5maW5kLklEKGEubWF0Y2hlc1swXS5yZXBsYWNlKHRlLG5lKSx0KXx8W10pWzBdKSlyZXR1cm4gbjtsJiYodD10LnBhcmVudE5vZGUpLGU9ZS5zbGljZShvLnNoaWZ0KCkudmFsdWUubGVuZ3RoKX1pPUcubmVlZHNDb250ZXh0LnRlc3QoZSk/MDpvLmxlbmd0aDt3aGlsZShpLS0pe2lmKGE9b1tpXSxiLnJlbGF0aXZlW3M9YS50eXBlXSlicmVhaztpZigodT1iLmZpbmRbc10pJiYocj11KGEubWF0Y2hlc1swXS5yZXBsYWNlKHRlLG5lKSxlZS50ZXN0KG9bMF0udHlwZSkmJnllKHQucGFyZW50Tm9kZSl8fHQpKSl7aWYoby5zcGxpY2UoaSwxKSwhKGU9ci5sZW5ndGgmJnhlKG8pKSlyZXR1cm4gSC5hcHBseShuLHIpLG47YnJlYWt9fX1yZXR1cm4obHx8ZihlLGMpKShyLHQsIUUsbiwhdHx8ZWUudGVzdChlKSYmeWUodC5wYXJlbnROb2RlKXx8dCksbn0sZC5zb3J0U3RhYmxlPWsuc3BsaXQoIiIpLnNvcnQoRCkuam9pbigiIik9PT1rLGQuZGV0ZWN0RHVwbGljYXRlcz0hIWwsVCgpLGQuc29ydERldGFjaGVkPWNlKGZ1bmN0aW9uKGUpe3JldHVybiAxJmUuY29tcGFyZURvY3VtZW50UG9zaXRpb24oQy5jcmVhdGVFbGVtZW50KCJmaWVsZHNldCIpKX0pLGNlKGZ1bmN0aW9uKGUpe3JldHVybiBlLmlubmVySFRNTD0iPGEgaHJlZj0nIyc+PC9hPiIsIiMiPT09ZS5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSgiaHJlZiIpfSl8fGZlKCJ0eXBlfGhyZWZ8aGVpZ2h0fHdpZHRoIixmdW5jdGlvbihlLHQsbil7aWYoIW4pcmV0dXJuIGUuZ2V0QXR0cmlidXRlKHQsInR5cGUiPT09dC50b0xvd2VyQ2FzZSgpPzE6Mil9KSxkLmF0dHJpYnV0ZXMmJmNlKGZ1bmN0aW9uKGUpe3JldHVybiBlLmlubmVySFRNTD0iPGlucHV0Lz4iLGUuZmlyc3RDaGlsZC5zZXRBdHRyaWJ1dGUoInZhbHVlIiwiIiksIiI9PT1lLmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKCJ2YWx1ZSIpfSl8fGZlKCJ2YWx1ZSIsZnVuY3Rpb24oZSx0LG4pe2lmKCFuJiYiaW5wdXQiPT09ZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpKXJldHVybiBlLmRlZmF1bHRWYWx1ZX0pLGNlKGZ1bmN0aW9uKGUpe3JldHVybiBudWxsPT1lLmdldEF0dHJpYnV0ZSgiZGlzYWJsZWQiKX0pfHxmZShSLGZ1bmN0aW9uKGUsdCxuKXt2YXIgcjtpZighbilyZXR1cm4hMD09PWVbdF0/dC50b0xvd2VyQ2FzZSgpOihyPWUuZ2V0QXR0cmlidXRlTm9kZSh0KSkmJnIuc3BlY2lmaWVkP3IudmFsdWU6bnVsbH0pLHNlfShDKTtrLmZpbmQ9aCxrLmV4cHI9aC5zZWxlY3RvcnMsay5leHByWyI6Il09ay5leHByLnBzZXVkb3Msay51bmlxdWVTb3J0PWsudW5pcXVlPWgudW5pcXVlU29ydCxrLnRleHQ9aC5nZXRUZXh0LGsuaXNYTUxEb2M9aC5pc1hNTCxrLmNvbnRhaW5zPWguY29udGFpbnMsay5lc2NhcGVTZWxlY3Rvcj1oLmVzY2FwZTt2YXIgVD1mdW5jdGlvbihlLHQsbil7dmFyIHI9W10saT12b2lkIDAhPT1uO3doaWxlKChlPWVbdF0pJiY5IT09ZS5ub2RlVHlwZSlpZigxPT09ZS5ub2RlVHlwZSl7aWYoaSYmayhlKS5pcyhuKSlicmVhaztyLnB1c2goZSl9cmV0dXJuIHJ9LFM9ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49W107ZTtlPWUubmV4dFNpYmxpbmcpMT09PWUubm9kZVR5cGUmJmUhPT10JiZuLnB1c2goZSk7cmV0dXJuIG59LE49ay5leHByLm1hdGNoLm5lZWRzQ29udGV4dDtmdW5jdGlvbiBBKGUsdCl7cmV0dXJuIGUubm9kZU5hbWUmJmUubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PXQudG9Mb3dlckNhc2UoKX12YXIgRD0vXjwoW2Etel1bXlwvXDA+Olx4MjBcdFxyXG5cZl0qKVtceDIwXHRcclxuXGZdKlwvPz4oPzo8XC9cMT58KSQvaTtmdW5jdGlvbiBqKGUsbixyKXtyZXR1cm4gbShuKT9rLmdyZXAoZSxmdW5jdGlvbihlLHQpe3JldHVybiEhbi5jYWxsKGUsdCxlKSE9PXJ9KTpuLm5vZGVUeXBlP2suZ3JlcChlLGZ1bmN0aW9uKGUpe3JldHVybiBlPT09biE9PXJ9KToic3RyaW5nIiE9dHlwZW9mIG4/ay5ncmVwKGUsZnVuY3Rpb24oZSl7cmV0dXJuLTE8aS5jYWxsKG4sZSkhPT1yfSk6ay5maWx0ZXIobixlLHIpfWsuZmlsdGVyPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcj10WzBdO3JldHVybiBuJiYoZT0iOm5vdCgiK2UrIikiKSwxPT09dC5sZW5ndGgmJjE9PT1yLm5vZGVUeXBlP2suZmluZC5tYXRjaGVzU2VsZWN0b3IocixlKT9bcl06W106ay5maW5kLm1hdGNoZXMoZSxrLmdyZXAodCxmdW5jdGlvbihlKXtyZXR1cm4gMT09PWUubm9kZVR5cGV9KSl9LGsuZm4uZXh0ZW5kKHtmaW5kOmZ1bmN0aW9uKGUpe3ZhciB0LG4scj10aGlzLmxlbmd0aCxpPXRoaXM7aWYoInN0cmluZyIhPXR5cGVvZiBlKXJldHVybiB0aGlzLnB1c2hTdGFjayhrKGUpLmZpbHRlcihmdW5jdGlvbigpe2Zvcih0PTA7dDxyO3QrKylpZihrLmNvbnRhaW5zKGlbdF0sdGhpcykpcmV0dXJuITB9KSk7Zm9yKG49dGhpcy5wdXNoU3RhY2soW10pLHQ9MDt0PHI7dCsrKWsuZmluZChlLGlbdF0sbik7cmV0dXJuIDE8cj9rLnVuaXF1ZVNvcnQobik6bn0sZmlsdGVyOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnB1c2hTdGFjayhqKHRoaXMsZXx8W10sITEpKX0sbm90OmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnB1c2hTdGFjayhqKHRoaXMsZXx8W10sITApKX0saXM6ZnVuY3Rpb24oZSl7cmV0dXJuISFqKHRoaXMsInN0cmluZyI9PXR5cGVvZiBlJiZOLnRlc3QoZSk/ayhlKTplfHxbXSwhMSkubGVuZ3RofX0pO3ZhciBxLEw9L14oPzpccyooPFtcd1xXXSs+KVtePl0qfCMoW1x3LV0rKSkkLzsoay5mbi5pbml0PWZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpO2lmKCFlKXJldHVybiB0aGlzO2lmKG49bnx8cSwic3RyaW5nIj09dHlwZW9mIGUpe2lmKCEocj0iPCI9PT1lWzBdJiYiPiI9PT1lW2UubGVuZ3RoLTFdJiYzPD1lLmxlbmd0aD9bbnVsbCxlLG51bGxdOkwuZXhlYyhlKSl8fCFyWzFdJiZ0KXJldHVybiF0fHx0LmpxdWVyeT8odHx8bikuZmluZChlKTp0aGlzLmNvbnN0cnVjdG9yKHQpLmZpbmQoZSk7aWYoclsxXSl7aWYodD10IGluc3RhbmNlb2Ygaz90WzBdOnQsay5tZXJnZSh0aGlzLGsucGFyc2VIVE1MKHJbMV0sdCYmdC5ub2RlVHlwZT90Lm93bmVyRG9jdW1lbnR8fHQ6RSwhMCkpLEQudGVzdChyWzFdKSYmay5pc1BsYWluT2JqZWN0KHQpKWZvcihyIGluIHQpbSh0aGlzW3JdKT90aGlzW3JdKHRbcl0pOnRoaXMuYXR0cihyLHRbcl0pO3JldHVybiB0aGlzfXJldHVybihpPUUuZ2V0RWxlbWVudEJ5SWQoclsyXSkpJiYodGhpc1swXT1pLHRoaXMubGVuZ3RoPTEpLHRoaXN9cmV0dXJuIGUubm9kZVR5cGU/KHRoaXNbMF09ZSx0aGlzLmxlbmd0aD0xLHRoaXMpOm0oZSk/dm9pZCAwIT09bi5yZWFkeT9uLnJlYWR5KGUpOmUoayk6ay5tYWtlQXJyYXkoZSx0aGlzKX0pLnByb3RvdHlwZT1rLmZuLHE9ayhFKTt2YXIgSD0vXig/OnBhcmVudHN8cHJldig/OlVudGlsfEFsbCkpLyxPPXtjaGlsZHJlbjohMCxjb250ZW50czohMCxuZXh0OiEwLHByZXY6ITB9O2Z1bmN0aW9uIFAoZSx0KXt3aGlsZSgoZT1lW3RdKSYmMSE9PWUubm9kZVR5cGUpO3JldHVybiBlfWsuZm4uZXh0ZW5kKHtoYXM6ZnVuY3Rpb24oZSl7dmFyIHQ9ayhlLHRoaXMpLG49dC5sZW5ndGg7cmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9uKCl7Zm9yKHZhciBlPTA7ZTxuO2UrKylpZihrLmNvbnRhaW5zKHRoaXMsdFtlXSkpcmV0dXJuITB9KX0sY2xvc2VzdDpmdW5jdGlvbihlLHQpe3ZhciBuLHI9MCxpPXRoaXMubGVuZ3RoLG89W10sYT0ic3RyaW5nIiE9dHlwZW9mIGUmJmsoZSk7aWYoIU4udGVzdChlKSlmb3IoO3I8aTtyKyspZm9yKG49dGhpc1tyXTtuJiZuIT09dDtuPW4ucGFyZW50Tm9kZSlpZihuLm5vZGVUeXBlPDExJiYoYT8tMTxhLmluZGV4KG4pOjE9PT1uLm5vZGVUeXBlJiZrLmZpbmQubWF0Y2hlc1NlbGVjdG9yKG4sZSkpKXtvLnB1c2gobik7YnJlYWt9cmV0dXJuIHRoaXMucHVzaFN0YWNrKDE8by5sZW5ndGg/ay51bmlxdWVTb3J0KG8pOm8pfSxpbmRleDpmdW5jdGlvbihlKXtyZXR1cm4gZT8ic3RyaW5nIj09dHlwZW9mIGU/aS5jYWxsKGsoZSksdGhpc1swXSk6aS5jYWxsKHRoaXMsZS5qcXVlcnk/ZVswXTplKTp0aGlzWzBdJiZ0aGlzWzBdLnBhcmVudE5vZGU/dGhpcy5maXJzdCgpLnByZXZBbGwoKS5sZW5ndGg6LTF9LGFkZDpmdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLnB1c2hTdGFjayhrLnVuaXF1ZVNvcnQoay5tZXJnZSh0aGlzLmdldCgpLGsoZSx0KSkpKX0sYWRkQmFjazpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5hZGQobnVsbD09ZT90aGlzLnByZXZPYmplY3Q6dGhpcy5wcmV2T2JqZWN0LmZpbHRlcihlKSl9fSksay5lYWNoKHtwYXJlbnQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wYXJlbnROb2RlO3JldHVybiB0JiYxMSE9PXQubm9kZVR5cGU/dDpudWxsfSxwYXJlbnRzOmZ1bmN0aW9uKGUpe3JldHVybiBUKGUsInBhcmVudE5vZGUiKX0scGFyZW50c1VudGlsOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gVChlLCJwYXJlbnROb2RlIixuKX0sbmV4dDpmdW5jdGlvbihlKXtyZXR1cm4gUChlLCJuZXh0U2libGluZyIpfSxwcmV2OmZ1bmN0aW9uKGUpe3JldHVybiBQKGUsInByZXZpb3VzU2libGluZyIpfSxuZXh0QWxsOmZ1bmN0aW9uKGUpe3JldHVybiBUKGUsIm5leHRTaWJsaW5nIil9LHByZXZBbGw6ZnVuY3Rpb24oZSl7cmV0dXJuIFQoZSwicHJldmlvdXNTaWJsaW5nIil9LG5leHRVbnRpbDpmdW5jdGlvbihlLHQsbil7cmV0dXJuIFQoZSwibmV4dFNpYmxpbmciLG4pfSxwcmV2VW50aWw6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBUKGUsInByZXZpb3VzU2libGluZyIsbil9LHNpYmxpbmdzOmZ1bmN0aW9uKGUpe3JldHVybiBTKChlLnBhcmVudE5vZGV8fHt9KS5maXJzdENoaWxkLGUpfSxjaGlsZHJlbjpmdW5jdGlvbihlKXtyZXR1cm4gUyhlLmZpcnN0Q2hpbGQpfSxjb250ZW50czpmdW5jdGlvbihlKXtyZXR1cm4idW5kZWZpbmVkIiE9dHlwZW9mIGUuY29udGVudERvY3VtZW50P2UuY29udGVudERvY3VtZW50OihBKGUsInRlbXBsYXRlIikmJihlPWUuY29udGVudHx8ZSksay5tZXJnZShbXSxlLmNoaWxkTm9kZXMpKX19LGZ1bmN0aW9uKHIsaSl7ay5mbltyXT1mdW5jdGlvbihlLHQpe3ZhciBuPWsubWFwKHRoaXMsaSxlKTtyZXR1cm4iVW50aWwiIT09ci5zbGljZSgtNSkmJih0PWUpLHQmJiJzdHJpbmciPT10eXBlb2YgdCYmKG49ay5maWx0ZXIodCxuKSksMTx0aGlzLmxlbmd0aCYmKE9bcl18fGsudW5pcXVlU29ydChuKSxILnRlc3QocikmJm4ucmV2ZXJzZSgpKSx0aGlzLnB1c2hTdGFjayhuKX19KTt2YXIgUj0vW15ceDIwXHRcclxuXGZdKy9nO2Z1bmN0aW9uIE0oZSl7cmV0dXJuIGV9ZnVuY3Rpb24gSShlKXt0aHJvdyBlfWZ1bmN0aW9uIFcoZSx0LG4scil7dmFyIGk7dHJ5e2UmJm0oaT1lLnByb21pc2UpP2kuY2FsbChlKS5kb25lKHQpLmZhaWwobik6ZSYmbShpPWUudGhlbik/aS5jYWxsKGUsdCxuKTp0LmFwcGx5KHZvaWQgMCxbZV0uc2xpY2UocikpfWNhdGNoKGUpe24uYXBwbHkodm9pZCAwLFtlXSl9fWsuQ2FsbGJhY2tzPWZ1bmN0aW9uKHIpe3ZhciBlLG47cj0ic3RyaW5nIj09dHlwZW9mIHI/KGU9cixuPXt9LGsuZWFjaChlLm1hdGNoKFIpfHxbXSxmdW5jdGlvbihlLHQpe25bdF09ITB9KSxuKTprLmV4dGVuZCh7fSxyKTt2YXIgaSx0LG8sYSxzPVtdLHU9W10sbD0tMSxjPWZ1bmN0aW9uKCl7Zm9yKGE9YXx8ci5vbmNlLG89aT0hMDt1Lmxlbmd0aDtsPS0xKXt0PXUuc2hpZnQoKTt3aGlsZSgrK2w8cy5sZW5ndGgpITE9PT1zW2xdLmFwcGx5KHRbMF0sdFsxXSkmJnIuc3RvcE9uRmFsc2UmJihsPXMubGVuZ3RoLHQ9ITEpfXIubWVtb3J5fHwodD0hMSksaT0hMSxhJiYocz10P1tdOiIiKX0sZj17YWRkOmZ1bmN0aW9uKCl7cmV0dXJuIHMmJih0JiYhaSYmKGw9cy5sZW5ndGgtMSx1LnB1c2godCkpLGZ1bmN0aW9uIG4oZSl7ay5lYWNoKGUsZnVuY3Rpb24oZSx0KXttKHQpP3IudW5pcXVlJiZmLmhhcyh0KXx8cy5wdXNoKHQpOnQmJnQubGVuZ3RoJiYic3RyaW5nIiE9PXcodCkmJm4odCl9KX0oYXJndW1lbnRzKSx0JiYhaSYmYygpKSx0aGlzfSxyZW1vdmU6ZnVuY3Rpb24oKXtyZXR1cm4gay5lYWNoKGFyZ3VtZW50cyxmdW5jdGlvbihlLHQpe3ZhciBuO3doaWxlKC0xPChuPWsuaW5BcnJheSh0LHMsbikpKXMuc3BsaWNlKG4sMSksbjw9bCYmbC0tfSksdGhpc30saGFzOmZ1bmN0aW9uKGUpe3JldHVybiBlPy0xPGsuaW5BcnJheShlLHMpOjA8cy5sZW5ndGh9LGVtcHR5OmZ1bmN0aW9uKCl7cmV0dXJuIHMmJihzPVtdKSx0aGlzfSxkaXNhYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIGE9dT1bXSxzPXQ9IiIsdGhpc30sZGlzYWJsZWQ6ZnVuY3Rpb24oKXtyZXR1cm4hc30sbG9jazpmdW5jdGlvbigpe3JldHVybiBhPXU9W10sdHx8aXx8KHM9dD0iIiksdGhpc30sbG9ja2VkOmZ1bmN0aW9uKCl7cmV0dXJuISFhfSxmaXJlV2l0aDpmdW5jdGlvbihlLHQpe3JldHVybiBhfHwodD1bZSwodD10fHxbXSkuc2xpY2U/dC5zbGljZSgpOnRdLHUucHVzaCh0KSxpfHxjKCkpLHRoaXN9LGZpcmU6ZnVuY3Rpb24oKXtyZXR1cm4gZi5maXJlV2l0aCh0aGlzLGFyZ3VtZW50cyksdGhpc30sZmlyZWQ6ZnVuY3Rpb24oKXtyZXR1cm4hIW99fTtyZXR1cm4gZn0say5leHRlbmQoe0RlZmVycmVkOmZ1bmN0aW9uKGUpe3ZhciBvPVtbIm5vdGlmeSIsInByb2dyZXNzIixrLkNhbGxiYWNrcygibWVtb3J5Iiksay5DYWxsYmFja3MoIm1lbW9yeSIpLDJdLFsicmVzb2x2ZSIsImRvbmUiLGsuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLGsuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLDAsInJlc29sdmVkIl0sWyJyZWplY3QiLCJmYWlsIixrLkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSxrLkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwxLCJyZWplY3RlZCJdXSxpPSJwZW5kaW5nIixhPXtzdGF0ZTpmdW5jdGlvbigpe3JldHVybiBpfSxhbHdheXM6ZnVuY3Rpb24oKXtyZXR1cm4gcy5kb25lKGFyZ3VtZW50cykuZmFpbChhcmd1bWVudHMpLHRoaXN9LCJjYXRjaCI6ZnVuY3Rpb24oZSl7cmV0dXJuIGEudGhlbihudWxsLGUpfSxwaXBlOmZ1bmN0aW9uKCl7dmFyIGk9YXJndW1lbnRzO3JldHVybiBrLkRlZmVycmVkKGZ1bmN0aW9uKHIpe2suZWFjaChvLGZ1bmN0aW9uKGUsdCl7dmFyIG49bShpW3RbNF1dKSYmaVt0WzRdXTtzW3RbMV1dKGZ1bmN0aW9uKCl7dmFyIGU9biYmbi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7ZSYmbShlLnByb21pc2UpP2UucHJvbWlzZSgpLnByb2dyZXNzKHIubm90aWZ5KS5kb25lKHIucmVzb2x2ZSkuZmFpbChyLnJlamVjdCk6clt0WzBdKyJXaXRoIl0odGhpcyxuP1tlXTphcmd1bWVudHMpfSl9KSxpPW51bGx9KS5wcm9taXNlKCl9LHRoZW46ZnVuY3Rpb24odCxuLHIpe3ZhciB1PTA7ZnVuY3Rpb24gbChpLG8sYSxzKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgbj10aGlzLHI9YXJndW1lbnRzLGU9ZnVuY3Rpb24oKXt2YXIgZSx0O2lmKCEoaTx1KSl7aWYoKGU9YS5hcHBseShuLHIpKT09PW8ucHJvbWlzZSgpKXRocm93IG5ldyBUeXBlRXJyb3IoIlRoZW5hYmxlIHNlbGYtcmVzb2x1dGlvbiIpO3Q9ZSYmKCJvYmplY3QiPT10eXBlb2YgZXx8ImZ1bmN0aW9uIj09dHlwZW9mIGUpJiZlLnRoZW4sbSh0KT9zP3QuY2FsbChlLGwodSxvLE0scyksbCh1LG8sSSxzKSk6KHUrKyx0LmNhbGwoZSxsKHUsbyxNLHMpLGwodSxvLEkscyksbCh1LG8sTSxvLm5vdGlmeVdpdGgpKSk6KGEhPT1NJiYobj12b2lkIDAscj1bZV0pLChzfHxvLnJlc29sdmVXaXRoKShuLHIpKX19LHQ9cz9lOmZ1bmN0aW9uKCl7dHJ5e2UoKX1jYXRjaChlKXtrLkRlZmVycmVkLmV4Y2VwdGlvbkhvb2smJmsuRGVmZXJyZWQuZXhjZXB0aW9uSG9vayhlLHQuc3RhY2tUcmFjZSksdTw9aSsxJiYoYSE9PUkmJihuPXZvaWQgMCxyPVtlXSksby5yZWplY3RXaXRoKG4scikpfX07aT90KCk6KGsuRGVmZXJyZWQuZ2V0U3RhY2tIb29rJiYodC5zdGFja1RyYWNlPWsuRGVmZXJyZWQuZ2V0U3RhY2tIb29rKCkpLEMuc2V0VGltZW91dCh0KSl9fXJldHVybiBrLkRlZmVycmVkKGZ1bmN0aW9uKGUpe29bMF1bM10uYWRkKGwoMCxlLG0ocik/cjpNLGUubm90aWZ5V2l0aCkpLG9bMV1bM10uYWRkKGwoMCxlLG0odCk/dDpNKSksb1syXVszXS5hZGQobCgwLGUsbShuKT9uOkkpKX0pLnByb21pc2UoKX0scHJvbWlzZTpmdW5jdGlvbihlKXtyZXR1cm4gbnVsbCE9ZT9rLmV4dGVuZChlLGEpOmF9fSxzPXt9O3JldHVybiBrLmVhY2gobyxmdW5jdGlvbihlLHQpe3ZhciBuPXRbMl0scj10WzVdO2FbdFsxXV09bi5hZGQsciYmbi5hZGQoZnVuY3Rpb24oKXtpPXJ9LG9bMy1lXVsyXS5kaXNhYmxlLG9bMy1lXVszXS5kaXNhYmxlLG9bMF1bMl0ubG9jayxvWzBdWzNdLmxvY2spLG4uYWRkKHRbM10uZmlyZSksc1t0WzBdXT1mdW5jdGlvbigpe3JldHVybiBzW3RbMF0rIldpdGgiXSh0aGlzPT09cz92b2lkIDA6dGhpcyxhcmd1bWVudHMpLHRoaXN9LHNbdFswXSsiV2l0aCJdPW4uZmlyZVdpdGh9KSxhLnByb21pc2UocyksZSYmZS5jYWxsKHMscyksc30sd2hlbjpmdW5jdGlvbihlKXt2YXIgbj1hcmd1bWVudHMubGVuZ3RoLHQ9bixyPUFycmF5KHQpLGk9cy5jYWxsKGFyZ3VtZW50cyksbz1rLkRlZmVycmVkKCksYT1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSl7clt0XT10aGlzLGlbdF09MTxhcmd1bWVudHMubGVuZ3RoP3MuY2FsbChhcmd1bWVudHMpOmUsLS1ufHxvLnJlc29sdmVXaXRoKHIsaSl9fTtpZihuPD0xJiYoVyhlLG8uZG9uZShhKHQpKS5yZXNvbHZlLG8ucmVqZWN0LCFuKSwicGVuZGluZyI9PT1vLnN0YXRlKCl8fG0oaVt0XSYmaVt0XS50aGVuKSkpcmV0dXJuIG8udGhlbigpO3doaWxlKHQtLSlXKGlbdF0sYSh0KSxvLnJlamVjdCk7cmV0dXJuIG8ucHJvbWlzZSgpfX0pO3ZhciAkPS9eKEV2YWx8SW50ZXJuYWx8UmFuZ2V8UmVmZXJlbmNlfFN5bnRheHxUeXBlfFVSSSlFcnJvciQvO2suRGVmZXJyZWQuZXhjZXB0aW9uSG9vaz1mdW5jdGlvbihlLHQpe0MuY29uc29sZSYmQy5jb25zb2xlLndhcm4mJmUmJiQudGVzdChlLm5hbWUpJiZDLmNvbnNvbGUud2FybigialF1ZXJ5LkRlZmVycmVkIGV4Y2VwdGlvbjogIitlLm1lc3NhZ2UsZS5zdGFjayx0KX0say5yZWFkeUV4Y2VwdGlvbj1mdW5jdGlvbihlKXtDLnNldFRpbWVvdXQoZnVuY3Rpb24oKXt0aHJvdyBlfSl9O3ZhciBGPWsuRGVmZXJyZWQoKTtmdW5jdGlvbiBCKCl7RS5yZW1vdmVFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIixCKSxDLnJlbW92ZUV2ZW50TGlzdGVuZXIoImxvYWQiLEIpLGsucmVhZHkoKX1rLmZuLnJlYWR5PWZ1bmN0aW9uKGUpe3JldHVybiBGLnRoZW4oZSlbImNhdGNoIl0oZnVuY3Rpb24oZSl7ay5yZWFkeUV4Y2VwdGlvbihlKX0pLHRoaXN9LGsuZXh0ZW5kKHtpc1JlYWR5OiExLHJlYWR5V2FpdDoxLHJlYWR5OmZ1bmN0aW9uKGUpeyghMD09PWU/LS1rLnJlYWR5V2FpdDprLmlzUmVhZHkpfHwoay5pc1JlYWR5PSEwKSE9PWUmJjA8LS1rLnJlYWR5V2FpdHx8Ri5yZXNvbHZlV2l0aChFLFtrXSl9fSksay5yZWFkeS50aGVuPUYudGhlbiwiY29tcGxldGUiPT09RS5yZWFkeVN0YXRlfHwibG9hZGluZyIhPT1FLnJlYWR5U3RhdGUmJiFFLmRvY3VtZW50RWxlbWVudC5kb1Njcm9sbD9DLnNldFRpbWVvdXQoay5yZWFkeSk6KEUuYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsQiksQy5hZGRFdmVudExpc3RlbmVyKCJsb2FkIixCKSk7dmFyIF89ZnVuY3Rpb24oZSx0LG4scixpLG8sYSl7dmFyIHM9MCx1PWUubGVuZ3RoLGw9bnVsbD09bjtpZigib2JqZWN0Ij09PXcobikpZm9yKHMgaW4gaT0hMCxuKV8oZSx0LHMsbltzXSwhMCxvLGEpO2Vsc2UgaWYodm9pZCAwIT09ciYmKGk9ITAsbShyKXx8KGE9ITApLGwmJihhPyh0LmNhbGwoZSxyKSx0PW51bGwpOihsPXQsdD1mdW5jdGlvbihlLHQsbil7cmV0dXJuIGwuY2FsbChrKGUpLG4pfSkpLHQpKWZvcig7czx1O3MrKyl0KGVbc10sbixhP3I6ci5jYWxsKGVbc10scyx0KGVbc10sbikpKTtyZXR1cm4gaT9lOmw/dC5jYWxsKGUpOnU/dChlWzBdLG4pOm99LHo9L14tbXMtLyxVPS8tKFthLXpdKS9nO2Z1bmN0aW9uIFgoZSx0KXtyZXR1cm4gdC50b1VwcGVyQ2FzZSgpfWZ1bmN0aW9uIFYoZSl7cmV0dXJuIGUucmVwbGFjZSh6LCJtcy0iKS5yZXBsYWNlKFUsWCl9dmFyIEc9ZnVuY3Rpb24oZSl7cmV0dXJuIDE9PT1lLm5vZGVUeXBlfHw5PT09ZS5ub2RlVHlwZXx8IStlLm5vZGVUeXBlfTtmdW5jdGlvbiBZKCl7dGhpcy5leHBhbmRvPWsuZXhwYW5kbytZLnVpZCsrfVkudWlkPTEsWS5wcm90b3R5cGU9e2NhY2hlOmZ1bmN0aW9uKGUpe3ZhciB0PWVbdGhpcy5leHBhbmRvXTtyZXR1cm4gdHx8KHQ9e30sRyhlKSYmKGUubm9kZVR5cGU/ZVt0aGlzLmV4cGFuZG9dPXQ6T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdGhpcy5leHBhbmRvLHt2YWx1ZTp0LGNvbmZpZ3VyYWJsZTohMH0pKSksdH0sc2V0OmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpPXRoaXMuY2FjaGUoZSk7aWYoInN0cmluZyI9PXR5cGVvZiB0KWlbVih0KV09bjtlbHNlIGZvcihyIGluIHQpaVtWKHIpXT10W3JdO3JldHVybiBpfSxnZXQ6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdm9pZCAwPT09dD90aGlzLmNhY2hlKGUpOmVbdGhpcy5leHBhbmRvXSYmZVt0aGlzLmV4cGFuZG9dW1YodCldfSxhY2Nlc3M6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiB2b2lkIDA9PT10fHx0JiYic3RyaW5nIj09dHlwZW9mIHQmJnZvaWQgMD09PW4/dGhpcy5nZXQoZSx0KToodGhpcy5zZXQoZSx0LG4pLHZvaWQgMCE9PW4/bjp0KX0scmVtb3ZlOmZ1bmN0aW9uKGUsdCl7dmFyIG4scj1lW3RoaXMuZXhwYW5kb107aWYodm9pZCAwIT09cil7aWYodm9pZCAwIT09dCl7bj0odD1BcnJheS5pc0FycmF5KHQpP3QubWFwKFYpOih0PVYodCkpaW4gcj9bdF06dC5tYXRjaChSKXx8W10pLmxlbmd0aDt3aGlsZShuLS0pZGVsZXRlIHJbdFtuXV19KHZvaWQgMD09PXR8fGsuaXNFbXB0eU9iamVjdChyKSkmJihlLm5vZGVUeXBlP2VbdGhpcy5leHBhbmRvXT12b2lkIDA6ZGVsZXRlIGVbdGhpcy5leHBhbmRvXSl9fSxoYXNEYXRhOmZ1bmN0aW9uKGUpe3ZhciB0PWVbdGhpcy5leHBhbmRvXTtyZXR1cm4gdm9pZCAwIT09dCYmIWsuaXNFbXB0eU9iamVjdCh0KX19O3ZhciBRPW5ldyBZLEo9bmV3IFksSz0vXig/Olx7W1x3XFddKlx9fFxbW1x3XFddKlxdKSQvLFo9L1tBLVpdL2c7ZnVuY3Rpb24gZWUoZSx0LG4pe3ZhciByLGk7aWYodm9pZCAwPT09biYmMT09PWUubm9kZVR5cGUpaWYocj0iZGF0YS0iK3QucmVwbGFjZShaLCItJCYiKS50b0xvd2VyQ2FzZSgpLCJzdHJpbmciPT10eXBlb2Yobj1lLmdldEF0dHJpYnV0ZShyKSkpe3RyeXtuPSJ0cnVlIj09PShpPW4pfHwiZmFsc2UiIT09aSYmKCJudWxsIj09PWk/bnVsbDppPT09K2krIiI/K2k6Sy50ZXN0KGkpP0pTT04ucGFyc2UoaSk6aSl9Y2F0Y2goZSl7fUouc2V0KGUsdCxuKX1lbHNlIG49dm9pZCAwO3JldHVybiBufWsuZXh0ZW5kKHtoYXNEYXRhOmZ1bmN0aW9uKGUpe3JldHVybiBKLmhhc0RhdGEoZSl8fFEuaGFzRGF0YShlKX0sZGF0YTpmdW5jdGlvbihlLHQsbil7cmV0dXJuIEouYWNjZXNzKGUsdCxuKX0scmVtb3ZlRGF0YTpmdW5jdGlvbihlLHQpe0oucmVtb3ZlKGUsdCl9LF9kYXRhOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gUS5hY2Nlc3MoZSx0LG4pfSxfcmVtb3ZlRGF0YTpmdW5jdGlvbihlLHQpe1EucmVtb3ZlKGUsdCl9fSksay5mbi5leHRlbmQoe2RhdGE6ZnVuY3Rpb24obixlKXt2YXIgdCxyLGksbz10aGlzWzBdLGE9byYmby5hdHRyaWJ1dGVzO2lmKHZvaWQgMD09PW4pe2lmKHRoaXMubGVuZ3RoJiYoaT1KLmdldChvKSwxPT09by5ub2RlVHlwZSYmIVEuZ2V0KG8sImhhc0RhdGFBdHRycyIpKSl7dD1hLmxlbmd0aDt3aGlsZSh0LS0pYVt0XSYmMD09PShyPWFbdF0ubmFtZSkuaW5kZXhPZigiZGF0YS0iKSYmKHI9VihyLnNsaWNlKDUpKSxlZShvLHIsaVtyXSkpO1Euc2V0KG8sImhhc0RhdGFBdHRycyIsITApfXJldHVybiBpfXJldHVybiJvYmplY3QiPT10eXBlb2Ygbj90aGlzLmVhY2goZnVuY3Rpb24oKXtKLnNldCh0aGlzLG4pfSk6Xyh0aGlzLGZ1bmN0aW9uKGUpe3ZhciB0O2lmKG8mJnZvaWQgMD09PWUpcmV0dXJuIHZvaWQgMCE9PSh0PUouZ2V0KG8sbikpP3Q6dm9pZCAwIT09KHQ9ZWUobyxuKSk/dDp2b2lkIDA7dGhpcy5lYWNoKGZ1bmN0aW9uKCl7Si5zZXQodGhpcyxuLGUpfSl9LG51bGwsZSwxPGFyZ3VtZW50cy5sZW5ndGgsbnVsbCwhMCl9LHJlbW92ZURhdGE6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe0oucmVtb3ZlKHRoaXMsZSl9KX19KSxrLmV4dGVuZCh7cXVldWU6ZnVuY3Rpb24oZSx0LG4pe3ZhciByO2lmKGUpcmV0dXJuIHQ9KHR8fCJmeCIpKyJxdWV1ZSIscj1RLmdldChlLHQpLG4mJighcnx8QXJyYXkuaXNBcnJheShuKT9yPVEuYWNjZXNzKGUsdCxrLm1ha2VBcnJheShuKSk6ci5wdXNoKG4pKSxyfHxbXX0sZGVxdWV1ZTpmdW5jdGlvbihlLHQpe3Q9dHx8ImZ4Ijt2YXIgbj1rLnF1ZXVlKGUsdCkscj1uLmxlbmd0aCxpPW4uc2hpZnQoKSxvPWsuX3F1ZXVlSG9va3MoZSx0KTsiaW5wcm9ncmVzcyI9PT1pJiYoaT1uLnNoaWZ0KCksci0tKSxpJiYoImZ4Ij09PXQmJm4udW5zaGlmdCgiaW5wcm9ncmVzcyIpLGRlbGV0ZSBvLnN0b3AsaS5jYWxsKGUsZnVuY3Rpb24oKXtrLmRlcXVldWUoZSx0KX0sbykpLCFyJiZvJiZvLmVtcHR5LmZpcmUoKX0sX3F1ZXVlSG9va3M6ZnVuY3Rpb24oZSx0KXt2YXIgbj10KyJxdWV1ZUhvb2tzIjtyZXR1cm4gUS5nZXQoZSxuKXx8US5hY2Nlc3MoZSxuLHtlbXB0eTprLkNhbGxiYWNrcygib25jZSBtZW1vcnkiKS5hZGQoZnVuY3Rpb24oKXtRLnJlbW92ZShlLFt0KyJxdWV1ZSIsbl0pfSl9KX19KSxrLmZuLmV4dGVuZCh7cXVldWU6ZnVuY3Rpb24odCxuKXt2YXIgZT0yO3JldHVybiJzdHJpbmciIT10eXBlb2YgdCYmKG49dCx0PSJmeCIsZS0tKSxhcmd1bWVudHMubGVuZ3RoPGU/ay5xdWV1ZSh0aGlzWzBdLHQpOnZvaWQgMD09PW4/dGhpczp0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgZT1rLnF1ZXVlKHRoaXMsdCxuKTtrLl9xdWV1ZUhvb2tzKHRoaXMsdCksImZ4Ij09PXQmJiJpbnByb2dyZXNzIiE9PWVbMF0mJmsuZGVxdWV1ZSh0aGlzLHQpfSl9LGRlcXVldWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2suZGVxdWV1ZSh0aGlzLGUpfSl9LGNsZWFyUXVldWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMucXVldWUoZXx8ImZ4IixbXSl9LHByb21pc2U6ZnVuY3Rpb24oZSx0KXt2YXIgbixyPTEsaT1rLkRlZmVycmVkKCksbz10aGlzLGE9dGhpcy5sZW5ndGgscz1mdW5jdGlvbigpey0tcnx8aS5yZXNvbHZlV2l0aChvLFtvXSl9OyJzdHJpbmciIT10eXBlb2YgZSYmKHQ9ZSxlPXZvaWQgMCksZT1lfHwiZngiO3doaWxlKGEtLSkobj1RLmdldChvW2FdLGUrInF1ZXVlSG9va3MiKSkmJm4uZW1wdHkmJihyKyssbi5lbXB0eS5hZGQocykpO3JldHVybiBzKCksaS5wcm9taXNlKHQpfX0pO3ZhciB0ZT0vWystXT8oPzpcZCpcLnwpXGQrKD86W2VFXVsrLV0/XGQrfCkvLnNvdXJjZSxuZT1uZXcgUmVnRXhwKCJeKD86KFsrLV0pPXwpKCIrdGUrIikoW2EteiVdKikkIiwiaSIpLHJlPVsiVG9wIiwiUmlnaHQiLCJCb3R0b20iLCJMZWZ0Il0saWU9RS5kb2N1bWVudEVsZW1lbnQsb2U9ZnVuY3Rpb24oZSl7cmV0dXJuIGsuY29udGFpbnMoZS5vd25lckRvY3VtZW50LGUpfSxhZT17Y29tcG9zZWQ6ITB9O2llLmdldFJvb3ROb2RlJiYob2U9ZnVuY3Rpb24oZSl7cmV0dXJuIGsuY29udGFpbnMoZS5vd25lckRvY3VtZW50LGUpfHxlLmdldFJvb3ROb2RlKGFlKT09PWUub3duZXJEb2N1bWVudH0pO3ZhciBzZT1mdW5jdGlvbihlLHQpe3JldHVybiJub25lIj09PShlPXR8fGUpLnN0eWxlLmRpc3BsYXl8fCIiPT09ZS5zdHlsZS5kaXNwbGF5JiZvZShlKSYmIm5vbmUiPT09ay5jc3MoZSwiZGlzcGxheSIpfSx1ZT1mdW5jdGlvbihlLHQsbixyKXt2YXIgaSxvLGE9e307Zm9yKG8gaW4gdClhW29dPWUuc3R5bGVbb10sZS5zdHlsZVtvXT10W29dO2ZvcihvIGluIGk9bi5hcHBseShlLHJ8fFtdKSx0KWUuc3R5bGVbb109YVtvXTtyZXR1cm4gaX07ZnVuY3Rpb24gbGUoZSx0LG4scil7dmFyIGksbyxhPTIwLHM9cj9mdW5jdGlvbigpe3JldHVybiByLmN1cigpfTpmdW5jdGlvbigpe3JldHVybiBrLmNzcyhlLHQsIiIpfSx1PXMoKSxsPW4mJm5bM118fChrLmNzc051bWJlclt0XT8iIjoicHgiKSxjPWUubm9kZVR5cGUmJihrLmNzc051bWJlclt0XXx8InB4IiE9PWwmJit1KSYmbmUuZXhlYyhrLmNzcyhlLHQpKTtpZihjJiZjWzNdIT09bCl7dS89MixsPWx8fGNbM10sYz0rdXx8MTt3aGlsZShhLS0pay5zdHlsZShlLHQsYytsKSwoMS1vKSooMS0obz1zKCkvdXx8LjUpKTw9MCYmKGE9MCksYy89bztjKj0yLGsuc3R5bGUoZSx0LGMrbCksbj1ufHxbXX1yZXR1cm4gbiYmKGM9K2N8fCt1fHwwLGk9blsxXT9jKyhuWzFdKzEpKm5bMl06K25bMl0sciYmKHIudW5pdD1sLHIuc3RhcnQ9YyxyLmVuZD1pKSksaX12YXIgY2U9e307ZnVuY3Rpb24gZmUoZSx0KXtmb3IodmFyIG4scixpLG8sYSxzLHUsbD1bXSxjPTAsZj1lLmxlbmd0aDtjPGY7YysrKShyPWVbY10pLnN0eWxlJiYobj1yLnN0eWxlLmRpc3BsYXksdD8oIm5vbmUiPT09biYmKGxbY109US5nZXQociwiZGlzcGxheSIpfHxudWxsLGxbY118fChyLnN0eWxlLmRpc3BsYXk9IiIpKSwiIj09PXIuc3R5bGUuZGlzcGxheSYmc2UocikmJihsW2NdPSh1PWE9bz12b2lkIDAsYT0oaT1yKS5vd25lckRvY3VtZW50LHM9aS5ub2RlTmFtZSwodT1jZVtzXSl8fChvPWEuYm9keS5hcHBlbmRDaGlsZChhLmNyZWF0ZUVsZW1lbnQocykpLHU9ay5jc3MobywiZGlzcGxheSIpLG8ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChvKSwibm9uZSI9PT11JiYodT0iYmxvY2siKSxjZVtzXT11KSkpKToibm9uZSIhPT1uJiYobFtjXT0ibm9uZSIsUS5zZXQociwiZGlzcGxheSIsbikpKTtmb3IoYz0wO2M8ZjtjKyspbnVsbCE9bFtjXSYmKGVbY10uc3R5bGUuZGlzcGxheT1sW2NdKTtyZXR1cm4gZX1rLmZuLmV4dGVuZCh7c2hvdzpmdW5jdGlvbigpe3JldHVybiBmZSh0aGlzLCEwKX0saGlkZTpmdW5jdGlvbigpe3JldHVybiBmZSh0aGlzKX0sdG9nZ2xlOmZ1bmN0aW9uKGUpe3JldHVybiJib29sZWFuIj09dHlwZW9mIGU/ZT90aGlzLnNob3coKTp0aGlzLmhpZGUoKTp0aGlzLmVhY2goZnVuY3Rpb24oKXtzZSh0aGlzKT9rKHRoaXMpLnNob3coKTprKHRoaXMpLmhpZGUoKX0pfX0pO3ZhciBwZT0vXig/OmNoZWNrYm94fHJhZGlvKSQvaSxkZT0vPChbYS16XVteXC9cMD5ceDIwXHRcclxuXGZdKikvaSxoZT0vXiR8Xm1vZHVsZSR8XC8oPzpqYXZhfGVjbWEpc2NyaXB0L2ksZ2U9e29wdGlvbjpbMSwiPHNlbGVjdCBtdWx0aXBsZT0nbXVsdGlwbGUnPiIsIjwvc2VsZWN0PiJdLHRoZWFkOlsxLCI8dGFibGU+IiwiPC90YWJsZT4iXSxjb2w6WzIsIjx0YWJsZT48Y29sZ3JvdXA+IiwiPC9jb2xncm91cD48L3RhYmxlPiJdLHRyOlsyLCI8dGFibGU+PHRib2R5PiIsIjwvdGJvZHk+PC90YWJsZT4iXSx0ZDpbMywiPHRhYmxlPjx0Ym9keT48dHI+IiwiPC90cj48L3Rib2R5PjwvdGFibGU+Il0sX2RlZmF1bHQ6WzAsIiIsIiJdfTtmdW5jdGlvbiB2ZShlLHQpe3ZhciBuO3JldHVybiBuPSJ1bmRlZmluZWQiIT10eXBlb2YgZS5nZXRFbGVtZW50c0J5VGFnTmFtZT9lLmdldEVsZW1lbnRzQnlUYWdOYW1lKHR8fCIqIik6InVuZGVmaW5lZCIhPXR5cGVvZiBlLnF1ZXJ5U2VsZWN0b3JBbGw/ZS5xdWVyeVNlbGVjdG9yQWxsKHR8fCIqIik6W10sdm9pZCAwPT09dHx8dCYmQShlLHQpP2subWVyZ2UoW2VdLG4pOm59ZnVuY3Rpb24geWUoZSx0KXtmb3IodmFyIG49MCxyPWUubGVuZ3RoO248cjtuKyspUS5zZXQoZVtuXSwiZ2xvYmFsRXZhbCIsIXR8fFEuZ2V0KHRbbl0sImdsb2JhbEV2YWwiKSl9Z2Uub3B0Z3JvdXA9Z2Uub3B0aW9uLGdlLnRib2R5PWdlLnRmb290PWdlLmNvbGdyb3VwPWdlLmNhcHRpb249Z2UudGhlYWQsZ2UudGg9Z2UudGQ7dmFyIG1lLHhlLGJlPS88fCYjP1x3KzsvO2Z1bmN0aW9uIHdlKGUsdCxuLHIsaSl7Zm9yKHZhciBvLGEscyx1LGwsYyxmPXQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLHA9W10sZD0wLGg9ZS5sZW5ndGg7ZDxoO2QrKylpZigobz1lW2RdKXx8MD09PW8paWYoIm9iamVjdCI9PT13KG8pKWsubWVyZ2UocCxvLm5vZGVUeXBlP1tvXTpvKTtlbHNlIGlmKGJlLnRlc3Qobykpe2E9YXx8Zi5hcHBlbmRDaGlsZCh0LmNyZWF0ZUVsZW1lbnQoImRpdiIpKSxzPShkZS5leGVjKG8pfHxbIiIsIiJdKVsxXS50b0xvd2VyQ2FzZSgpLHU9Z2Vbc118fGdlLl9kZWZhdWx0LGEuaW5uZXJIVE1MPXVbMV0ray5odG1sUHJlZmlsdGVyKG8pK3VbMl0sYz11WzBdO3doaWxlKGMtLSlhPWEubGFzdENoaWxkO2subWVyZ2UocCxhLmNoaWxkTm9kZXMpLChhPWYuZmlyc3RDaGlsZCkudGV4dENvbnRlbnQ9IiJ9ZWxzZSBwLnB1c2godC5jcmVhdGVUZXh0Tm9kZShvKSk7Zi50ZXh0Q29udGVudD0iIixkPTA7d2hpbGUobz1wW2QrK10paWYociYmLTE8ay5pbkFycmF5KG8scikpaSYmaS5wdXNoKG8pO2Vsc2UgaWYobD1vZShvKSxhPXZlKGYuYXBwZW5kQ2hpbGQobyksInNjcmlwdCIpLGwmJnllKGEpLG4pe2M9MDt3aGlsZShvPWFbYysrXSloZS50ZXN0KG8udHlwZXx8IiIpJiZuLnB1c2gobyl9cmV0dXJuIGZ9bWU9RS5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCkuYXBwZW5kQ2hpbGQoRS5jcmVhdGVFbGVtZW50KCJkaXYiKSksKHhlPUUuY3JlYXRlRWxlbWVudCgiaW5wdXQiKSkuc2V0QXR0cmlidXRlKCJ0eXBlIiwicmFkaW8iKSx4ZS5zZXRBdHRyaWJ1dGUoImNoZWNrZWQiLCJjaGVja2VkIikseGUuc2V0QXR0cmlidXRlKCJuYW1lIiwidCIpLG1lLmFwcGVuZENoaWxkKHhlKSx5LmNoZWNrQ2xvbmU9bWUuY2xvbmVOb2RlKCEwKS5jbG9uZU5vZGUoITApLmxhc3RDaGlsZC5jaGVja2VkLG1lLmlubmVySFRNTD0iPHRleHRhcmVhPng8L3RleHRhcmVhPiIseS5ub0Nsb25lQ2hlY2tlZD0hIW1lLmNsb25lTm9kZSghMCkubGFzdENoaWxkLmRlZmF1bHRWYWx1ZTt2YXIgVGU9L15rZXkvLENlPS9eKD86bW91c2V8cG9pbnRlcnxjb250ZXh0bWVudXxkcmFnfGRyb3ApfGNsaWNrLyxFZT0vXihbXi5dKikoPzpcLiguKyl8KS87ZnVuY3Rpb24ga2UoKXtyZXR1cm4hMH1mdW5jdGlvbiBTZSgpe3JldHVybiExfWZ1bmN0aW9uIE5lKGUsdCl7cmV0dXJuIGU9PT1mdW5jdGlvbigpe3RyeXtyZXR1cm4gRS5hY3RpdmVFbGVtZW50fWNhdGNoKGUpe319KCk9PSgiZm9jdXMiPT09dCl9ZnVuY3Rpb24gQWUoZSx0LG4scixpLG8pe3ZhciBhLHM7aWYoIm9iamVjdCI9PXR5cGVvZiB0KXtmb3IocyBpbiJzdHJpbmciIT10eXBlb2YgbiYmKHI9cnx8bixuPXZvaWQgMCksdClBZShlLHMsbixyLHRbc10sbyk7cmV0dXJuIGV9aWYobnVsbD09ciYmbnVsbD09aT8oaT1uLHI9bj12b2lkIDApOm51bGw9PWkmJigic3RyaW5nIj09dHlwZW9mIG4/KGk9cixyPXZvaWQgMCk6KGk9cixyPW4sbj12b2lkIDApKSwhMT09PWkpaT1TZTtlbHNlIGlmKCFpKXJldHVybiBlO3JldHVybiAxPT09byYmKGE9aSwoaT1mdW5jdGlvbihlKXtyZXR1cm4gaygpLm9mZihlKSxhLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pLmd1aWQ9YS5ndWlkfHwoYS5ndWlkPWsuZ3VpZCsrKSksZS5lYWNoKGZ1bmN0aW9uKCl7ay5ldmVudC5hZGQodGhpcyx0LGkscixuKX0pfWZ1bmN0aW9uIERlKGUsaSxvKXtvPyhRLnNldChlLGksITEpLGsuZXZlbnQuYWRkKGUsaSx7bmFtZXNwYWNlOiExLGhhbmRsZXI6ZnVuY3Rpb24oZSl7dmFyIHQsbixyPVEuZ2V0KHRoaXMsaSk7aWYoMSZlLmlzVHJpZ2dlciYmdGhpc1tpXSl7aWYoci5sZW5ndGgpKGsuZXZlbnQuc3BlY2lhbFtpXXx8e30pLmRlbGVnYXRlVHlwZSYmZS5zdG9wUHJvcGFnYXRpb24oKTtlbHNlIGlmKHI9cy5jYWxsKGFyZ3VtZW50cyksUS5zZXQodGhpcyxpLHIpLHQ9byh0aGlzLGkpLHRoaXNbaV0oKSxyIT09KG49US5nZXQodGhpcyxpKSl8fHQ/US5zZXQodGhpcyxpLCExKTpuPXt9LHIhPT1uKXJldHVybiBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLGUucHJldmVudERlZmF1bHQoKSxuLnZhbHVlfWVsc2Ugci5sZW5ndGgmJihRLnNldCh0aGlzLGkse3ZhbHVlOmsuZXZlbnQudHJpZ2dlcihrLmV4dGVuZChyWzBdLGsuRXZlbnQucHJvdG90eXBlKSxyLnNsaWNlKDEpLHRoaXMpfSksZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSl9fSkpOnZvaWQgMD09PVEuZ2V0KGUsaSkmJmsuZXZlbnQuYWRkKGUsaSxrZSl9ay5ldmVudD17Z2xvYmFsOnt9LGFkZDpmdW5jdGlvbih0LGUsbixyLGkpe3ZhciBvLGEscyx1LGwsYyxmLHAsZCxoLGcsdj1RLmdldCh0KTtpZih2KXtuLmhhbmRsZXImJihuPShvPW4pLmhhbmRsZXIsaT1vLnNlbGVjdG9yKSxpJiZrLmZpbmQubWF0Y2hlc1NlbGVjdG9yKGllLGkpLG4uZ3VpZHx8KG4uZ3VpZD1rLmd1aWQrKyksKHU9di5ldmVudHMpfHwodT12LmV2ZW50cz17fSksKGE9di5oYW5kbGUpfHwoYT12LmhhbmRsZT1mdW5jdGlvbihlKXtyZXR1cm4idW5kZWZpbmVkIiE9dHlwZW9mIGsmJmsuZXZlbnQudHJpZ2dlcmVkIT09ZS50eXBlP2suZXZlbnQuZGlzcGF0Y2guYXBwbHkodCxhcmd1bWVudHMpOnZvaWQgMH0pLGw9KGU9KGV8fCIiKS5tYXRjaChSKXx8WyIiXSkubGVuZ3RoO3doaWxlKGwtLSlkPWc9KHM9RWUuZXhlYyhlW2xdKXx8W10pWzFdLGg9KHNbMl18fCIiKS5zcGxpdCgiLiIpLnNvcnQoKSxkJiYoZj1rLmV2ZW50LnNwZWNpYWxbZF18fHt9LGQ9KGk/Zi5kZWxlZ2F0ZVR5cGU6Zi5iaW5kVHlwZSl8fGQsZj1rLmV2ZW50LnNwZWNpYWxbZF18fHt9LGM9ay5leHRlbmQoe3R5cGU6ZCxvcmlnVHlwZTpnLGRhdGE6cixoYW5kbGVyOm4sZ3VpZDpuLmd1aWQsc2VsZWN0b3I6aSxuZWVkc0NvbnRleHQ6aSYmay5leHByLm1hdGNoLm5lZWRzQ29udGV4dC50ZXN0KGkpLG5hbWVzcGFjZTpoLmpvaW4oIi4iKX0sbyksKHA9dVtkXSl8fCgocD11W2RdPVtdKS5kZWxlZ2F0ZUNvdW50PTAsZi5zZXR1cCYmITEhPT1mLnNldHVwLmNhbGwodCxyLGgsYSl8fHQuYWRkRXZlbnRMaXN0ZW5lciYmdC5hZGRFdmVudExpc3RlbmVyKGQsYSkpLGYuYWRkJiYoZi5hZGQuY2FsbCh0LGMpLGMuaGFuZGxlci5ndWlkfHwoYy5oYW5kbGVyLmd1aWQ9bi5ndWlkKSksaT9wLnNwbGljZShwLmRlbGVnYXRlQ291bnQrKywwLGMpOnAucHVzaChjKSxrLmV2ZW50Lmdsb2JhbFtkXT0hMCl9fSxyZW1vdmU6ZnVuY3Rpb24oZSx0LG4scixpKXt2YXIgbyxhLHMsdSxsLGMsZixwLGQsaCxnLHY9US5oYXNEYXRhKGUpJiZRLmdldChlKTtpZih2JiYodT12LmV2ZW50cykpe2w9KHQ9KHR8fCIiKS5tYXRjaChSKXx8WyIiXSkubGVuZ3RoO3doaWxlKGwtLSlpZihkPWc9KHM9RWUuZXhlYyh0W2xdKXx8W10pWzFdLGg9KHNbMl18fCIiKS5zcGxpdCgiLiIpLnNvcnQoKSxkKXtmPWsuZXZlbnQuc3BlY2lhbFtkXXx8e30scD11W2Q9KHI/Zi5kZWxlZ2F0ZVR5cGU6Zi5iaW5kVHlwZSl8fGRdfHxbXSxzPXNbMl0mJm5ldyBSZWdFeHAoIihefFxcLikiK2guam9pbigiXFwuKD86LipcXC58KSIpKyIoXFwufCQpIiksYT1vPXAubGVuZ3RoO3doaWxlKG8tLSljPXBbb10sIWkmJmchPT1jLm9yaWdUeXBlfHxuJiZuLmd1aWQhPT1jLmd1aWR8fHMmJiFzLnRlc3QoYy5uYW1lc3BhY2UpfHxyJiZyIT09Yy5zZWxlY3RvciYmKCIqKiIhPT1yfHwhYy5zZWxlY3Rvcil8fChwLnNwbGljZShvLDEpLGMuc2VsZWN0b3ImJnAuZGVsZWdhdGVDb3VudC0tLGYucmVtb3ZlJiZmLnJlbW92ZS5jYWxsKGUsYykpO2EmJiFwLmxlbmd0aCYmKGYudGVhcmRvd24mJiExIT09Zi50ZWFyZG93bi5jYWxsKGUsaCx2LmhhbmRsZSl8fGsucmVtb3ZlRXZlbnQoZSxkLHYuaGFuZGxlKSxkZWxldGUgdVtkXSl9ZWxzZSBmb3IoZCBpbiB1KWsuZXZlbnQucmVtb3ZlKGUsZCt0W2xdLG4sciwhMCk7ay5pc0VtcHR5T2JqZWN0KHUpJiZRLnJlbW92ZShlLCJoYW5kbGUgZXZlbnRzIil9fSxkaXNwYXRjaDpmdW5jdGlvbihlKXt2YXIgdCxuLHIsaSxvLGEscz1rLmV2ZW50LmZpeChlKSx1PW5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoKSxsPShRLmdldCh0aGlzLCJldmVudHMiKXx8e30pW3MudHlwZV18fFtdLGM9ay5ldmVudC5zcGVjaWFsW3MudHlwZV18fHt9O2Zvcih1WzBdPXMsdD0xO3Q8YXJndW1lbnRzLmxlbmd0aDt0KyspdVt0XT1hcmd1bWVudHNbdF07aWYocy5kZWxlZ2F0ZVRhcmdldD10aGlzLCFjLnByZURpc3BhdGNofHwhMSE9PWMucHJlRGlzcGF0Y2guY2FsbCh0aGlzLHMpKXthPWsuZXZlbnQuaGFuZGxlcnMuY2FsbCh0aGlzLHMsbCksdD0wO3doaWxlKChpPWFbdCsrXSkmJiFzLmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpe3MuY3VycmVudFRhcmdldD1pLmVsZW0sbj0wO3doaWxlKChvPWkuaGFuZGxlcnNbbisrXSkmJiFzLmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCkpcy5ybmFtZXNwYWNlJiYhMSE9PW8ubmFtZXNwYWNlJiYhcy5ybmFtZXNwYWNlLnRlc3Qoby5uYW1lc3BhY2UpfHwocy5oYW5kbGVPYmo9byxzLmRhdGE9by5kYXRhLHZvaWQgMCE9PShyPSgoay5ldmVudC5zcGVjaWFsW28ub3JpZ1R5cGVdfHx7fSkuaGFuZGxlfHxvLmhhbmRsZXIpLmFwcGx5KGkuZWxlbSx1KSkmJiExPT09KHMucmVzdWx0PXIpJiYocy5wcmV2ZW50RGVmYXVsdCgpLHMuc3RvcFByb3BhZ2F0aW9uKCkpKX1yZXR1cm4gYy5wb3N0RGlzcGF0Y2gmJmMucG9zdERpc3BhdGNoLmNhbGwodGhpcyxzKSxzLnJlc3VsdH19LGhhbmRsZXJzOmZ1bmN0aW9uKGUsdCl7dmFyIG4scixpLG8sYSxzPVtdLHU9dC5kZWxlZ2F0ZUNvdW50LGw9ZS50YXJnZXQ7aWYodSYmbC5ub2RlVHlwZSYmISgiY2xpY2siPT09ZS50eXBlJiYxPD1lLmJ1dHRvbikpZm9yKDtsIT09dGhpcztsPWwucGFyZW50Tm9kZXx8dGhpcylpZigxPT09bC5ub2RlVHlwZSYmKCJjbGljayIhPT1lLnR5cGV8fCEwIT09bC5kaXNhYmxlZCkpe2ZvcihvPVtdLGE9e30sbj0wO248dTtuKyspdm9pZCAwPT09YVtpPShyPXRbbl0pLnNlbGVjdG9yKyIgIl0mJihhW2ldPXIubmVlZHNDb250ZXh0Py0xPGsoaSx0aGlzKS5pbmRleChsKTprLmZpbmQoaSx0aGlzLG51bGwsW2xdKS5sZW5ndGgpLGFbaV0mJm8ucHVzaChyKTtvLmxlbmd0aCYmcy5wdXNoKHtlbGVtOmwsaGFuZGxlcnM6b30pfXJldHVybiBsPXRoaXMsdTx0Lmxlbmd0aCYmcy5wdXNoKHtlbGVtOmwsaGFuZGxlcnM6dC5zbGljZSh1KX0pLHN9LGFkZFByb3A6ZnVuY3Rpb24odCxlKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoay5FdmVudC5wcm90b3R5cGUsdCx7ZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsZ2V0Om0oZSk/ZnVuY3Rpb24oKXtpZih0aGlzLm9yaWdpbmFsRXZlbnQpcmV0dXJuIGUodGhpcy5vcmlnaW5hbEV2ZW50KX06ZnVuY3Rpb24oKXtpZih0aGlzLm9yaWdpbmFsRXZlbnQpcmV0dXJuIHRoaXMub3JpZ2luYWxFdmVudFt0XX0sc2V0OmZ1bmN0aW9uKGUpe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLHQse2VudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwLHZhbHVlOmV9KX19KX0sZml4OmZ1bmN0aW9uKGUpe3JldHVybiBlW2suZXhwYW5kb10/ZTpuZXcgay5FdmVudChlKX0sc3BlY2lhbDp7bG9hZDp7bm9CdWJibGU6ITB9LGNsaWNrOntzZXR1cDpmdW5jdGlvbihlKXt2YXIgdD10aGlzfHxlO3JldHVybiBwZS50ZXN0KHQudHlwZSkmJnQuY2xpY2smJkEodCwiaW5wdXQiKSYmRGUodCwiY2xpY2siLGtlKSwhMX0sdHJpZ2dlcjpmdW5jdGlvbihlKXt2YXIgdD10aGlzfHxlO3JldHVybiBwZS50ZXN0KHQudHlwZSkmJnQuY2xpY2smJkEodCwiaW5wdXQiKSYmRGUodCwiY2xpY2siKSwhMH0sX2RlZmF1bHQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS50YXJnZXQ7cmV0dXJuIHBlLnRlc3QodC50eXBlKSYmdC5jbGljayYmQSh0LCJpbnB1dCIpJiZRLmdldCh0LCJjbGljayIpfHxBKHQsImEiKX19LGJlZm9yZXVubG9hZDp7cG9zdERpc3BhdGNoOmZ1bmN0aW9uKGUpe3ZvaWQgMCE9PWUucmVzdWx0JiZlLm9yaWdpbmFsRXZlbnQmJihlLm9yaWdpbmFsRXZlbnQucmV0dXJuVmFsdWU9ZS5yZXN1bHQpfX19fSxrLnJlbW92ZUV2ZW50PWZ1bmN0aW9uKGUsdCxuKXtlLnJlbW92ZUV2ZW50TGlzdGVuZXImJmUucmVtb3ZlRXZlbnRMaXN0ZW5lcih0LG4pfSxrLkV2ZW50PWZ1bmN0aW9uKGUsdCl7aWYoISh0aGlzIGluc3RhbmNlb2Ygay5FdmVudCkpcmV0dXJuIG5ldyBrLkV2ZW50KGUsdCk7ZSYmZS50eXBlPyh0aGlzLm9yaWdpbmFsRXZlbnQ9ZSx0aGlzLnR5cGU9ZS50eXBlLHRoaXMuaXNEZWZhdWx0UHJldmVudGVkPWUuZGVmYXVsdFByZXZlbnRlZHx8dm9pZCAwPT09ZS5kZWZhdWx0UHJldmVudGVkJiYhMT09PWUucmV0dXJuVmFsdWU/a2U6U2UsdGhpcy50YXJnZXQ9ZS50YXJnZXQmJjM9PT1lLnRhcmdldC5ub2RlVHlwZT9lLnRhcmdldC5wYXJlbnROb2RlOmUudGFyZ2V0LHRoaXMuY3VycmVudFRhcmdldD1lLmN1cnJlbnRUYXJnZXQsdGhpcy5yZWxhdGVkVGFyZ2V0PWUucmVsYXRlZFRhcmdldCk6dGhpcy50eXBlPWUsdCYmay5leHRlbmQodGhpcyx0KSx0aGlzLnRpbWVTdGFtcD1lJiZlLnRpbWVTdGFtcHx8RGF0ZS5ub3coKSx0aGlzW2suZXhwYW5kb109ITB9LGsuRXZlbnQucHJvdG90eXBlPXtjb25zdHJ1Y3RvcjprLkV2ZW50LGlzRGVmYXVsdFByZXZlbnRlZDpTZSxpc1Byb3BhZ2F0aW9uU3RvcHBlZDpTZSxpc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZDpTZSxpc1NpbXVsYXRlZDohMSxwcmV2ZW50RGVmYXVsdDpmdW5jdGlvbigpe3ZhciBlPXRoaXMub3JpZ2luYWxFdmVudDt0aGlzLmlzRGVmYXVsdFByZXZlbnRlZD1rZSxlJiYhdGhpcy5pc1NpbXVsYXRlZCYmZS5wcmV2ZW50RGVmYXVsdCgpfSxzdG9wUHJvcGFnYXRpb246ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm9yaWdpbmFsRXZlbnQ7dGhpcy5pc1Byb3BhZ2F0aW9uU3RvcHBlZD1rZSxlJiYhdGhpcy5pc1NpbXVsYXRlZCYmZS5zdG9wUHJvcGFnYXRpb24oKX0sc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vcmlnaW5hbEV2ZW50O3RoaXMuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ9a2UsZSYmIXRoaXMuaXNTaW11bGF0ZWQmJmUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksdGhpcy5zdG9wUHJvcGFnYXRpb24oKX19LGsuZWFjaCh7YWx0S2V5OiEwLGJ1YmJsZXM6ITAsY2FuY2VsYWJsZTohMCxjaGFuZ2VkVG91Y2hlczohMCxjdHJsS2V5OiEwLGRldGFpbDohMCxldmVudFBoYXNlOiEwLG1ldGFLZXk6ITAscGFnZVg6ITAscGFnZVk6ITAsc2hpZnRLZXk6ITAsdmlldzohMCwiY2hhciI6ITAsY29kZTohMCxjaGFyQ29kZTohMCxrZXk6ITAsa2V5Q29kZTohMCxidXR0b246ITAsYnV0dG9uczohMCxjbGllbnRYOiEwLGNsaWVudFk6ITAsb2Zmc2V0WDohMCxvZmZzZXRZOiEwLHBvaW50ZXJJZDohMCxwb2ludGVyVHlwZTohMCxzY3JlZW5YOiEwLHNjcmVlblk6ITAsdGFyZ2V0VG91Y2hlczohMCx0b0VsZW1lbnQ6ITAsdG91Y2hlczohMCx3aGljaDpmdW5jdGlvbihlKXt2YXIgdD1lLmJ1dHRvbjtyZXR1cm4gbnVsbD09ZS53aGljaCYmVGUudGVzdChlLnR5cGUpP251bGwhPWUuY2hhckNvZGU/ZS5jaGFyQ29kZTplLmtleUNvZGU6IWUud2hpY2gmJnZvaWQgMCE9PXQmJkNlLnRlc3QoZS50eXBlKT8xJnQ/MToyJnQ/Mzo0JnQ/MjowOmUud2hpY2h9fSxrLmV2ZW50LmFkZFByb3ApLGsuZWFjaCh7Zm9jdXM6ImZvY3VzaW4iLGJsdXI6ImZvY3Vzb3V0In0sZnVuY3Rpb24oZSx0KXtrLmV2ZW50LnNwZWNpYWxbZV09e3NldHVwOmZ1bmN0aW9uKCl7cmV0dXJuIERlKHRoaXMsZSxOZSksITF9LHRyaWdnZXI6ZnVuY3Rpb24oKXtyZXR1cm4gRGUodGhpcyxlKSwhMH0sZGVsZWdhdGVUeXBlOnR9fSksay5lYWNoKHttb3VzZWVudGVyOiJtb3VzZW92ZXIiLG1vdXNlbGVhdmU6Im1vdXNlb3V0Iixwb2ludGVyZW50ZXI6InBvaW50ZXJvdmVyIixwb2ludGVybGVhdmU6InBvaW50ZXJvdXQifSxmdW5jdGlvbihlLGkpe2suZXZlbnQuc3BlY2lhbFtlXT17ZGVsZWdhdGVUeXBlOmksYmluZFR5cGU6aSxoYW5kbGU6ZnVuY3Rpb24oZSl7dmFyIHQsbj1lLnJlbGF0ZWRUYXJnZXQscj1lLmhhbmRsZU9iajtyZXR1cm4gbiYmKG49PT10aGlzfHxrLmNvbnRhaW5zKHRoaXMsbikpfHwoZS50eXBlPXIub3JpZ1R5cGUsdD1yLmhhbmRsZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLGUudHlwZT1pKSx0fX19KSxrLmZuLmV4dGVuZCh7b246ZnVuY3Rpb24oZSx0LG4scil7cmV0dXJuIEFlKHRoaXMsZSx0LG4scil9LG9uZTpmdW5jdGlvbihlLHQsbixyKXtyZXR1cm4gQWUodGhpcyxlLHQsbixyLDEpfSxvZmY6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGk7aWYoZSYmZS5wcmV2ZW50RGVmYXVsdCYmZS5oYW5kbGVPYmopcmV0dXJuIHI9ZS5oYW5kbGVPYmosayhlLmRlbGVnYXRlVGFyZ2V0KS5vZmYoci5uYW1lc3BhY2U/ci5vcmlnVHlwZSsiLiIrci5uYW1lc3BhY2U6ci5vcmlnVHlwZSxyLnNlbGVjdG9yLHIuaGFuZGxlciksdGhpcztpZigib2JqZWN0Ij09dHlwZW9mIGUpe2ZvcihpIGluIGUpdGhpcy5vZmYoaSx0LGVbaV0pO3JldHVybiB0aGlzfXJldHVybiExIT09dCYmImZ1bmN0aW9uIiE9dHlwZW9mIHR8fChuPXQsdD12b2lkIDApLCExPT09biYmKG49U2UpLHRoaXMuZWFjaChmdW5jdGlvbigpe2suZXZlbnQucmVtb3ZlKHRoaXMsZSxuLHQpfSl9fSk7dmFyIGplPS88KD8hYXJlYXxicnxjb2x8ZW1iZWR8aHJ8aW1nfGlucHV0fGxpbmt8bWV0YXxwYXJhbSkoKFthLXpdW15cL1wwPlx4MjBcdFxyXG5cZl0qKVtePl0qKVwvPi9naSxxZT0vPHNjcmlwdHw8c3R5bGV8PGxpbmsvaSxMZT0vY2hlY2tlZFxzKig/OltePV18PVxzKi5jaGVja2VkLikvaSxIZT0vXlxzKjwhKD86XFtDREFUQVxbfC0tKXwoPzpcXVxdfC0tKT5ccyokL2c7ZnVuY3Rpb24gT2UoZSx0KXtyZXR1cm4gQShlLCJ0YWJsZSIpJiZBKDExIT09dC5ub2RlVHlwZT90OnQuZmlyc3RDaGlsZCwidHIiKSYmayhlKS5jaGlsZHJlbigidGJvZHkiKVswXXx8ZX1mdW5jdGlvbiBQZShlKXtyZXR1cm4gZS50eXBlPShudWxsIT09ZS5nZXRBdHRyaWJ1dGUoInR5cGUiKSkrIi8iK2UudHlwZSxlfWZ1bmN0aW9uIFJlKGUpe3JldHVybiJ0cnVlLyI9PT0oZS50eXBlfHwiIikuc2xpY2UoMCw1KT9lLnR5cGU9ZS50eXBlLnNsaWNlKDUpOmUucmVtb3ZlQXR0cmlidXRlKCJ0eXBlIiksZX1mdW5jdGlvbiBNZShlLHQpe3ZhciBuLHIsaSxvLGEscyx1LGw7aWYoMT09PXQubm9kZVR5cGUpe2lmKFEuaGFzRGF0YShlKSYmKG89US5hY2Nlc3MoZSksYT1RLnNldCh0LG8pLGw9by5ldmVudHMpKWZvcihpIGluIGRlbGV0ZSBhLmhhbmRsZSxhLmV2ZW50cz17fSxsKWZvcihuPTAscj1sW2ldLmxlbmd0aDtuPHI7bisrKWsuZXZlbnQuYWRkKHQsaSxsW2ldW25dKTtKLmhhc0RhdGEoZSkmJihzPUouYWNjZXNzKGUpLHU9ay5leHRlbmQoe30scyksSi5zZXQodCx1KSl9fWZ1bmN0aW9uIEllKG4scixpLG8pe3I9Zy5hcHBseShbXSxyKTt2YXIgZSx0LGEscyx1LGwsYz0wLGY9bi5sZW5ndGgscD1mLTEsZD1yWzBdLGg9bShkKTtpZihofHwxPGYmJiJzdHJpbmciPT10eXBlb2YgZCYmIXkuY2hlY2tDbG9uZSYmTGUudGVzdChkKSlyZXR1cm4gbi5lYWNoKGZ1bmN0aW9uKGUpe3ZhciB0PW4uZXEoZSk7aCYmKHJbMF09ZC5jYWxsKHRoaXMsZSx0Lmh0bWwoKSkpLEllKHQscixpLG8pfSk7aWYoZiYmKHQ9KGU9d2UocixuWzBdLm93bmVyRG9jdW1lbnQsITEsbixvKSkuZmlyc3RDaGlsZCwxPT09ZS5jaGlsZE5vZGVzLmxlbmd0aCYmKGU9dCksdHx8bykpe2ZvcihzPShhPWsubWFwKHZlKGUsInNjcmlwdCIpLFBlKSkubGVuZ3RoO2M8ZjtjKyspdT1lLGMhPT1wJiYodT1rLmNsb25lKHUsITAsITApLHMmJmsubWVyZ2UoYSx2ZSh1LCJzY3JpcHQiKSkpLGkuY2FsbChuW2NdLHUsYyk7aWYocylmb3IobD1hW2EubGVuZ3RoLTFdLm93bmVyRG9jdW1lbnQsay5tYXAoYSxSZSksYz0wO2M8cztjKyspdT1hW2NdLGhlLnRlc3QodS50eXBlfHwiIikmJiFRLmFjY2Vzcyh1LCJnbG9iYWxFdmFsIikmJmsuY29udGFpbnMobCx1KSYmKHUuc3JjJiYibW9kdWxlIiE9PSh1LnR5cGV8fCIiKS50b0xvd2VyQ2FzZSgpP2suX2V2YWxVcmwmJiF1Lm5vTW9kdWxlJiZrLl9ldmFsVXJsKHUuc3JjLHtub25jZTp1Lm5vbmNlfHx1LmdldEF0dHJpYnV0ZSgibm9uY2UiKX0pOmIodS50ZXh0Q29udGVudC5yZXBsYWNlKEhlLCIiKSx1LGwpKX1yZXR1cm4gbn1mdW5jdGlvbiBXZShlLHQsbil7Zm9yKHZhciByLGk9dD9rLmZpbHRlcih0LGUpOmUsbz0wO251bGwhPShyPWlbb10pO28rKylufHwxIT09ci5ub2RlVHlwZXx8ay5jbGVhbkRhdGEodmUocikpLHIucGFyZW50Tm9kZSYmKG4mJm9lKHIpJiZ5ZSh2ZShyLCJzY3JpcHQiKSksci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHIpKTtyZXR1cm4gZX1rLmV4dGVuZCh7aHRtbFByZWZpbHRlcjpmdW5jdGlvbihlKXtyZXR1cm4gZS5yZXBsYWNlKGplLCI8JDE+PC8kMj4iKX0sY2xvbmU6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbyxhLHMsdSxsLGM9ZS5jbG9uZU5vZGUoITApLGY9b2UoZSk7aWYoISh5Lm5vQ2xvbmVDaGVja2VkfHwxIT09ZS5ub2RlVHlwZSYmMTEhPT1lLm5vZGVUeXBlfHxrLmlzWE1MRG9jKGUpKSlmb3IoYT12ZShjKSxyPTAsaT0obz12ZShlKSkubGVuZ3RoO3I8aTtyKyspcz1vW3JdLHU9YVtyXSx2b2lkIDAsImlucHV0Ij09PShsPXUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSkmJnBlLnRlc3Qocy50eXBlKT91LmNoZWNrZWQ9cy5jaGVja2VkOiJpbnB1dCIhPT1sJiYidGV4dGFyZWEiIT09bHx8KHUuZGVmYXVsdFZhbHVlPXMuZGVmYXVsdFZhbHVlKTtpZih0KWlmKG4pZm9yKG89b3x8dmUoZSksYT1hfHx2ZShjKSxyPTAsaT1vLmxlbmd0aDtyPGk7cisrKU1lKG9bcl0sYVtyXSk7ZWxzZSBNZShlLGMpO3JldHVybiAwPChhPXZlKGMsInNjcmlwdCIpKS5sZW5ndGgmJnllKGEsIWYmJnZlKGUsInNjcmlwdCIpKSxjfSxjbGVhbkRhdGE6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0LG4scixpPWsuZXZlbnQuc3BlY2lhbCxvPTA7dm9pZCAwIT09KG49ZVtvXSk7bysrKWlmKEcobikpe2lmKHQ9bltRLmV4cGFuZG9dKXtpZih0LmV2ZW50cylmb3IociBpbiB0LmV2ZW50cylpW3JdP2suZXZlbnQucmVtb3ZlKG4scik6ay5yZW1vdmVFdmVudChuLHIsdC5oYW5kbGUpO25bUS5leHBhbmRvXT12b2lkIDB9bltKLmV4cGFuZG9dJiYobltKLmV4cGFuZG9dPXZvaWQgMCl9fX0pLGsuZm4uZXh0ZW5kKHtkZXRhY2g6ZnVuY3Rpb24oZSl7cmV0dXJuIFdlKHRoaXMsZSwhMCl9LHJlbW92ZTpmdW5jdGlvbihlKXtyZXR1cm4gV2UodGhpcyxlKX0sdGV4dDpmdW5jdGlvbihlKXtyZXR1cm4gXyh0aGlzLGZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDA9PT1lP2sudGV4dCh0aGlzKTp0aGlzLmVtcHR5KCkuZWFjaChmdW5jdGlvbigpezEhPT10aGlzLm5vZGVUeXBlJiYxMSE9PXRoaXMubm9kZVR5cGUmJjkhPT10aGlzLm5vZGVUeXBlfHwodGhpcy50ZXh0Q29udGVudD1lKX0pfSxudWxsLGUsYXJndW1lbnRzLmxlbmd0aCl9LGFwcGVuZDpmdW5jdGlvbigpe3JldHVybiBJZSh0aGlzLGFyZ3VtZW50cyxmdW5jdGlvbihlKXsxIT09dGhpcy5ub2RlVHlwZSYmMTEhPT10aGlzLm5vZGVUeXBlJiY5IT09dGhpcy5ub2RlVHlwZXx8T2UodGhpcyxlKS5hcHBlbmRDaGlsZChlKX0pfSxwcmVwZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIEllKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGUpe2lmKDE9PT10aGlzLm5vZGVUeXBlfHwxMT09PXRoaXMubm9kZVR5cGV8fDk9PT10aGlzLm5vZGVUeXBlKXt2YXIgdD1PZSh0aGlzLGUpO3QuaW5zZXJ0QmVmb3JlKGUsdC5maXJzdENoaWxkKX19KX0sYmVmb3JlOmZ1bmN0aW9uKCl7cmV0dXJuIEllKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGUpe3RoaXMucGFyZW50Tm9kZSYmdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlLHRoaXMpfSl9LGFmdGVyOmZ1bmN0aW9uKCl7cmV0dXJuIEllKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGUpe3RoaXMucGFyZW50Tm9kZSYmdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlLHRoaXMubmV4dFNpYmxpbmcpfSl9LGVtcHR5OmZ1bmN0aW9uKCl7Zm9yKHZhciBlLHQ9MDtudWxsIT0oZT10aGlzW3RdKTt0KyspMT09PWUubm9kZVR5cGUmJihrLmNsZWFuRGF0YSh2ZShlLCExKSksZS50ZXh0Q29udGVudD0iIik7cmV0dXJuIHRoaXN9LGNsb25lOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIGU9bnVsbCE9ZSYmZSx0PW51bGw9PXQ/ZTp0LHRoaXMubWFwKGZ1bmN0aW9uKCl7cmV0dXJuIGsuY2xvbmUodGhpcyxlLHQpfSl9LGh0bWw6ZnVuY3Rpb24oZSl7cmV0dXJuIF8odGhpcyxmdW5jdGlvbihlKXt2YXIgdD10aGlzWzBdfHx7fSxuPTAscj10aGlzLmxlbmd0aDtpZih2b2lkIDA9PT1lJiYxPT09dC5ub2RlVHlwZSlyZXR1cm4gdC5pbm5lckhUTUw7aWYoInN0cmluZyI9PXR5cGVvZiBlJiYhcWUudGVzdChlKSYmIWdlWyhkZS5leGVjKGUpfHxbIiIsIiJdKVsxXS50b0xvd2VyQ2FzZSgpXSl7ZT1rLmh0bWxQcmVmaWx0ZXIoZSk7dHJ5e2Zvcig7bjxyO24rKykxPT09KHQ9dGhpc1tuXXx8e30pLm5vZGVUeXBlJiYoay5jbGVhbkRhdGEodmUodCwhMSkpLHQuaW5uZXJIVE1MPWUpO3Q9MH1jYXRjaChlKXt9fXQmJnRoaXMuZW1wdHkoKS5hcHBlbmQoZSl9LG51bGwsZSxhcmd1bWVudHMubGVuZ3RoKX0scmVwbGFjZVdpdGg6ZnVuY3Rpb24oKXt2YXIgbj1bXTtyZXR1cm4gSWUodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5wYXJlbnROb2RlO2suaW5BcnJheSh0aGlzLG4pPDAmJihrLmNsZWFuRGF0YSh2ZSh0aGlzKSksdCYmdC5yZXBsYWNlQ2hpbGQoZSx0aGlzKSl9LG4pfX0pLGsuZWFjaCh7YXBwZW5kVG86ImFwcGVuZCIscHJlcGVuZFRvOiJwcmVwZW5kIixpbnNlcnRCZWZvcmU6ImJlZm9yZSIsaW5zZXJ0QWZ0ZXI6ImFmdGVyIixyZXBsYWNlQWxsOiJyZXBsYWNlV2l0aCJ9LGZ1bmN0aW9uKGUsYSl7ay5mbltlXT1mdW5jdGlvbihlKXtmb3IodmFyIHQsbj1bXSxyPWsoZSksaT1yLmxlbmd0aC0xLG89MDtvPD1pO28rKyl0PW89PT1pP3RoaXM6dGhpcy5jbG9uZSghMCksayhyW29dKVthXSh0KSx1LmFwcGx5KG4sdC5nZXQoKSk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKG4pfX0pO3ZhciAkZT1uZXcgUmVnRXhwKCJeKCIrdGUrIikoPyFweClbYS16JV0rJCIsImkiKSxGZT1mdW5jdGlvbihlKXt2YXIgdD1lLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXc7cmV0dXJuIHQmJnQub3BlbmVyfHwodD1DKSx0LmdldENvbXB1dGVkU3R5bGUoZSl9LEJlPW5ldyBSZWdFeHAocmUuam9pbigifCIpLCJpIik7ZnVuY3Rpb24gX2UoZSx0LG4pe3ZhciByLGksbyxhLHM9ZS5zdHlsZTtyZXR1cm4obj1ufHxGZShlKSkmJigiIiE9PShhPW4uZ2V0UHJvcGVydHlWYWx1ZSh0KXx8blt0XSl8fG9lKGUpfHwoYT1rLnN0eWxlKGUsdCkpLCF5LnBpeGVsQm94U3R5bGVzKCkmJiRlLnRlc3QoYSkmJkJlLnRlc3QodCkmJihyPXMud2lkdGgsaT1zLm1pbldpZHRoLG89cy5tYXhXaWR0aCxzLm1pbldpZHRoPXMubWF4V2lkdGg9cy53aWR0aD1hLGE9bi53aWR0aCxzLndpZHRoPXIscy5taW5XaWR0aD1pLHMubWF4V2lkdGg9bykpLHZvaWQgMCE9PWE/YSsiIjphfWZ1bmN0aW9uIHplKGUsdCl7cmV0dXJue2dldDpmdW5jdGlvbigpe2lmKCFlKCkpcmV0dXJuKHRoaXMuZ2V0PXQpLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtkZWxldGUgdGhpcy5nZXR9fX0hZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7aWYodSl7cy5zdHlsZS5jc3NUZXh0PSJwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0Oi0xMTExMXB4O3dpZHRoOjYwcHg7bWFyZ2luLXRvcDoxcHg7cGFkZGluZzowO2JvcmRlcjowIix1LnN0eWxlLmNzc1RleHQ9InBvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6YmxvY2s7Ym94LXNpemluZzpib3JkZXItYm94O292ZXJmbG93OnNjcm9sbDttYXJnaW46YXV0bztib3JkZXI6MXB4O3BhZGRpbmc6MXB4O3dpZHRoOjYwJTt0b3A6MSUiLGllLmFwcGVuZENoaWxkKHMpLmFwcGVuZENoaWxkKHUpO3ZhciBlPUMuZ2V0Q29tcHV0ZWRTdHlsZSh1KTtuPSIxJSIhPT1lLnRvcCxhPTEyPT09dChlLm1hcmdpbkxlZnQpLHUuc3R5bGUucmlnaHQ9IjYwJSIsbz0zNj09PXQoZS5yaWdodCkscj0zNj09PXQoZS53aWR0aCksdS5zdHlsZS5wb3NpdGlvbj0iYWJzb2x1dGUiLGk9MTI9PT10KHUub2Zmc2V0V2lkdGgvMyksaWUucmVtb3ZlQ2hpbGQocyksdT1udWxsfX1mdW5jdGlvbiB0KGUpe3JldHVybiBNYXRoLnJvdW5kKHBhcnNlRmxvYXQoZSkpfXZhciBuLHIsaSxvLGEscz1FLmNyZWF0ZUVsZW1lbnQoImRpdiIpLHU9RS5jcmVhdGVFbGVtZW50KCJkaXYiKTt1LnN0eWxlJiYodS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcD0iY29udGVudC1ib3giLHUuY2xvbmVOb2RlKCEwKS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcD0iIix5LmNsZWFyQ2xvbmVTdHlsZT0iY29udGVudC1ib3giPT09dS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCxrLmV4dGVuZCh5LHtib3hTaXppbmdSZWxpYWJsZTpmdW5jdGlvbigpe3JldHVybiBlKCkscn0scGl4ZWxCb3hTdHlsZXM6ZnVuY3Rpb24oKXtyZXR1cm4gZSgpLG99LHBpeGVsUG9zaXRpb246ZnVuY3Rpb24oKXtyZXR1cm4gZSgpLG59LHJlbGlhYmxlTWFyZ2luTGVmdDpmdW5jdGlvbigpe3JldHVybiBlKCksYX0sc2Nyb2xsYm94U2l6ZTpmdW5jdGlvbigpe3JldHVybiBlKCksaX19KSl9KCk7dmFyIFVlPVsiV2Via2l0IiwiTW96IiwibXMiXSxYZT1FLmNyZWF0ZUVsZW1lbnQoImRpdiIpLnN0eWxlLFZlPXt9O2Z1bmN0aW9uIEdlKGUpe3ZhciB0PWsuY3NzUHJvcHNbZV18fFZlW2VdO3JldHVybiB0fHwoZSBpbiBYZT9lOlZlW2VdPWZ1bmN0aW9uKGUpe3ZhciB0PWVbMF0udG9VcHBlckNhc2UoKStlLnNsaWNlKDEpLG49VWUubGVuZ3RoO3doaWxlKG4tLSlpZigoZT1VZVtuXSt0KWluIFhlKXJldHVybiBlfShlKXx8ZSl9dmFyIFllPS9eKG5vbmV8dGFibGUoPyEtY1tlYV0pLispLyxRZT0vXi0tLyxKZT17cG9zaXRpb246ImFic29sdXRlIix2aXNpYmlsaXR5OiJoaWRkZW4iLGRpc3BsYXk6ImJsb2NrIn0sS2U9e2xldHRlclNwYWNpbmc6IjAiLGZvbnRXZWlnaHQ6IjQwMCJ9O2Z1bmN0aW9uIFplKGUsdCxuKXt2YXIgcj1uZS5leGVjKHQpO3JldHVybiByP01hdGgubWF4KDAsclsyXS0obnx8MCkpKyhyWzNdfHwicHgiKTp0fWZ1bmN0aW9uIGV0KGUsdCxuLHIsaSxvKXt2YXIgYT0id2lkdGgiPT09dD8xOjAscz0wLHU9MDtpZihuPT09KHI/ImJvcmRlciI6ImNvbnRlbnQiKSlyZXR1cm4gMDtmb3IoO2E8NDthKz0yKSJtYXJnaW4iPT09biYmKHUrPWsuY3NzKGUsbityZVthXSwhMCxpKSkscj8oImNvbnRlbnQiPT09biYmKHUtPWsuY3NzKGUsInBhZGRpbmciK3JlW2FdLCEwLGkpKSwibWFyZ2luIiE9PW4mJih1LT1rLmNzcyhlLCJib3JkZXIiK3JlW2FdKyJXaWR0aCIsITAsaSkpKToodSs9ay5jc3MoZSwicGFkZGluZyIrcmVbYV0sITAsaSksInBhZGRpbmciIT09bj91Kz1rLmNzcyhlLCJib3JkZXIiK3JlW2FdKyJXaWR0aCIsITAsaSk6cys9ay5jc3MoZSwiYm9yZGVyIityZVthXSsiV2lkdGgiLCEwLGkpKTtyZXR1cm4hciYmMDw9byYmKHUrPU1hdGgubWF4KDAsTWF0aC5jZWlsKGVbIm9mZnNldCIrdFswXS50b1VwcGVyQ2FzZSgpK3Quc2xpY2UoMSldLW8tdS1zLS41KSl8fDApLHV9ZnVuY3Rpb24gdHQoZSx0LG4pe3ZhciByPUZlKGUpLGk9KCF5LmJveFNpemluZ1JlbGlhYmxlKCl8fG4pJiYiYm9yZGVyLWJveCI9PT1rLmNzcyhlLCJib3hTaXppbmciLCExLHIpLG89aSxhPV9lKGUsdCxyKSxzPSJvZmZzZXQiK3RbMF0udG9VcHBlckNhc2UoKSt0LnNsaWNlKDEpO2lmKCRlLnRlc3QoYSkpe2lmKCFuKXJldHVybiBhO2E9ImF1dG8ifXJldHVybigheS5ib3hTaXppbmdSZWxpYWJsZSgpJiZpfHwiYXV0byI9PT1hfHwhcGFyc2VGbG9hdChhKSYmImlubGluZSI9PT1rLmNzcyhlLCJkaXNwbGF5IiwhMSxyKSkmJmUuZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGgmJihpPSJib3JkZXItYm94Ij09PWsuY3NzKGUsImJveFNpemluZyIsITEsciksKG89cyBpbiBlKSYmKGE9ZVtzXSkpLChhPXBhcnNlRmxvYXQoYSl8fDApK2V0KGUsdCxufHwoaT8iYm9yZGVyIjoiY29udGVudCIpLG8scixhKSsicHgifWZ1bmN0aW9uIG50KGUsdCxuLHIsaSl7cmV0dXJuIG5ldyBudC5wcm90b3R5cGUuaW5pdChlLHQsbixyLGkpfWsuZXh0ZW5kKHtjc3NIb29rczp7b3BhY2l0eTp7Z2V0OmZ1bmN0aW9uKGUsdCl7aWYodCl7dmFyIG49X2UoZSwib3BhY2l0eSIpO3JldHVybiIiPT09bj8iMSI6bn19fX0sY3NzTnVtYmVyOnthbmltYXRpb25JdGVyYXRpb25Db3VudDohMCxjb2x1bW5Db3VudDohMCxmaWxsT3BhY2l0eTohMCxmbGV4R3JvdzohMCxmbGV4U2hyaW5rOiEwLGZvbnRXZWlnaHQ6ITAsZ3JpZEFyZWE6ITAsZ3JpZENvbHVtbjohMCxncmlkQ29sdW1uRW5kOiEwLGdyaWRDb2x1bW5TdGFydDohMCxncmlkUm93OiEwLGdyaWRSb3dFbmQ6ITAsZ3JpZFJvd1N0YXJ0OiEwLGxpbmVIZWlnaHQ6ITAsb3BhY2l0eTohMCxvcmRlcjohMCxvcnBoYW5zOiEwLHdpZG93czohMCx6SW5kZXg6ITAsem9vbTohMH0sY3NzUHJvcHM6e30sc3R5bGU6ZnVuY3Rpb24oZSx0LG4scil7aWYoZSYmMyE9PWUubm9kZVR5cGUmJjghPT1lLm5vZGVUeXBlJiZlLnN0eWxlKXt2YXIgaSxvLGEscz1WKHQpLHU9UWUudGVzdCh0KSxsPWUuc3R5bGU7aWYodXx8KHQ9R2UocykpLGE9ay5jc3NIb29rc1t0XXx8ay5jc3NIb29rc1tzXSx2b2lkIDA9PT1uKXJldHVybiBhJiYiZ2V0ImluIGEmJnZvaWQgMCE9PShpPWEuZ2V0KGUsITEscikpP2k6bFt0XTsic3RyaW5nIj09PShvPXR5cGVvZiBuKSYmKGk9bmUuZXhlYyhuKSkmJmlbMV0mJihuPWxlKGUsdCxpKSxvPSJudW1iZXIiKSxudWxsIT1uJiZuPT1uJiYoIm51bWJlciIhPT1vfHx1fHwobis9aSYmaVszXXx8KGsuY3NzTnVtYmVyW3NdPyIiOiJweCIpKSx5LmNsZWFyQ2xvbmVTdHlsZXx8IiIhPT1ufHwwIT09dC5pbmRleE9mKCJiYWNrZ3JvdW5kIil8fChsW3RdPSJpbmhlcml0IiksYSYmInNldCJpbiBhJiZ2b2lkIDA9PT0obj1hLnNldChlLG4scikpfHwodT9sLnNldFByb3BlcnR5KHQsbik6bFt0XT1uKSl9fSxjc3M6ZnVuY3Rpb24oZSx0LG4scil7dmFyIGksbyxhLHM9Vih0KTtyZXR1cm4gUWUudGVzdCh0KXx8KHQ9R2UocykpLChhPWsuY3NzSG9va3NbdF18fGsuY3NzSG9va3Nbc10pJiYiZ2V0ImluIGEmJihpPWEuZ2V0KGUsITAsbikpLHZvaWQgMD09PWkmJihpPV9lKGUsdCxyKSksIm5vcm1hbCI9PT1pJiZ0IGluIEtlJiYoaT1LZVt0XSksIiI9PT1ufHxuPyhvPXBhcnNlRmxvYXQoaSksITA9PT1ufHxpc0Zpbml0ZShvKT9vfHwwOmkpOml9fSksay5lYWNoKFsiaGVpZ2h0Iiwid2lkdGgiXSxmdW5jdGlvbihlLHUpe2suY3NzSG9va3NbdV09e2dldDpmdW5jdGlvbihlLHQsbil7aWYodClyZXR1cm4hWWUudGVzdChrLmNzcyhlLCJkaXNwbGF5IikpfHxlLmdldENsaWVudFJlY3RzKCkubGVuZ3RoJiZlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoP3R0KGUsdSxuKTp1ZShlLEplLGZ1bmN0aW9uKCl7cmV0dXJuIHR0KGUsdSxuKX0pfSxzZXQ6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGk9RmUoZSksbz0heS5zY3JvbGxib3hTaXplKCkmJiJhYnNvbHV0ZSI9PT1pLnBvc2l0aW9uLGE9KG98fG4pJiYiYm9yZGVyLWJveCI9PT1rLmNzcyhlLCJib3hTaXppbmciLCExLGkpLHM9bj9ldChlLHUsbixhLGkpOjA7cmV0dXJuIGEmJm8mJihzLT1NYXRoLmNlaWwoZVsib2Zmc2V0Iit1WzBdLnRvVXBwZXJDYXNlKCkrdS5zbGljZSgxKV0tcGFyc2VGbG9hdChpW3VdKS1ldChlLHUsImJvcmRlciIsITEsaSktLjUpKSxzJiYocj1uZS5leGVjKHQpKSYmInB4IiE9PShyWzNdfHwicHgiKSYmKGUuc3R5bGVbdV09dCx0PWsuY3NzKGUsdSkpLFplKDAsdCxzKX19fSksay5jc3NIb29rcy5tYXJnaW5MZWZ0PXplKHkucmVsaWFibGVNYXJnaW5MZWZ0LGZ1bmN0aW9uKGUsdCl7aWYodClyZXR1cm4ocGFyc2VGbG9hdChfZShlLCJtYXJnaW5MZWZ0IikpfHxlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQtdWUoZSx7bWFyZ2luTGVmdDowfSxmdW5jdGlvbigpe3JldHVybiBlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnR9KSkrInB4In0pLGsuZWFjaCh7bWFyZ2luOiIiLHBhZGRpbmc6IiIsYm9yZGVyOiJXaWR0aCJ9LGZ1bmN0aW9uKGksbyl7ay5jc3NIb29rc1tpK29dPXtleHBhbmQ6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTAsbj17fSxyPSJzdHJpbmciPT10eXBlb2YgZT9lLnNwbGl0KCIgIik6W2VdO3Q8NDt0KyspbltpK3JlW3RdK29dPXJbdF18fHJbdC0yXXx8clswXTtyZXR1cm4gbn19LCJtYXJnaW4iIT09aSYmKGsuY3NzSG9va3NbaStvXS5zZXQ9WmUpfSksay5mbi5leHRlbmQoe2NzczpmdW5jdGlvbihlLHQpe3JldHVybiBfKHRoaXMsZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbz17fSxhPTA7aWYoQXJyYXkuaXNBcnJheSh0KSl7Zm9yKHI9RmUoZSksaT10Lmxlbmd0aDthPGk7YSsrKW9bdFthXV09ay5jc3MoZSx0W2FdLCExLHIpO3JldHVybiBvfXJldHVybiB2b2lkIDAhPT1uP2suc3R5bGUoZSx0LG4pOmsuY3NzKGUsdCl9LGUsdCwxPGFyZ3VtZW50cy5sZW5ndGgpfX0pLCgoay5Ud2Vlbj1udCkucHJvdG90eXBlPXtjb25zdHJ1Y3RvcjpudCxpbml0OmZ1bmN0aW9uKGUsdCxuLHIsaSxvKXt0aGlzLmVsZW09ZSx0aGlzLnByb3A9bix0aGlzLmVhc2luZz1pfHxrLmVhc2luZy5fZGVmYXVsdCx0aGlzLm9wdGlvbnM9dCx0aGlzLnN0YXJ0PXRoaXMubm93PXRoaXMuY3VyKCksdGhpcy5lbmQ9cix0aGlzLnVuaXQ9b3x8KGsuY3NzTnVtYmVyW25dPyIiOiJweCIpfSxjdXI6ZnVuY3Rpb24oKXt2YXIgZT1udC5wcm9wSG9va3NbdGhpcy5wcm9wXTtyZXR1cm4gZSYmZS5nZXQ/ZS5nZXQodGhpcyk6bnQucHJvcEhvb2tzLl9kZWZhdWx0LmdldCh0aGlzKX0scnVuOmZ1bmN0aW9uKGUpe3ZhciB0LG49bnQucHJvcEhvb2tzW3RoaXMucHJvcF07cmV0dXJuIHRoaXMub3B0aW9ucy5kdXJhdGlvbj90aGlzLnBvcz10PWsuZWFzaW5nW3RoaXMuZWFzaW5nXShlLHRoaXMub3B0aW9ucy5kdXJhdGlvbiplLDAsMSx0aGlzLm9wdGlvbnMuZHVyYXRpb24pOnRoaXMucG9zPXQ9ZSx0aGlzLm5vdz0odGhpcy5lbmQtdGhpcy5zdGFydCkqdCt0aGlzLnN0YXJ0LHRoaXMub3B0aW9ucy5zdGVwJiZ0aGlzLm9wdGlvbnMuc3RlcC5jYWxsKHRoaXMuZWxlbSx0aGlzLm5vdyx0aGlzKSxuJiZuLnNldD9uLnNldCh0aGlzKTpudC5wcm9wSG9va3MuX2RlZmF1bHQuc2V0KHRoaXMpLHRoaXN9fSkuaW5pdC5wcm90b3R5cGU9bnQucHJvdG90eXBlLChudC5wcm9wSG9va3M9e19kZWZhdWx0OntnZXQ6ZnVuY3Rpb24oZSl7dmFyIHQ7cmV0dXJuIDEhPT1lLmVsZW0ubm9kZVR5cGV8fG51bGwhPWUuZWxlbVtlLnByb3BdJiZudWxsPT1lLmVsZW0uc3R5bGVbZS5wcm9wXT9lLmVsZW1bZS5wcm9wXToodD1rLmNzcyhlLmVsZW0sZS5wcm9wLCIiKSkmJiJhdXRvIiE9PXQ/dDowfSxzZXQ6ZnVuY3Rpb24oZSl7ay5meC5zdGVwW2UucHJvcF0/ay5meC5zdGVwW2UucHJvcF0oZSk6MSE9PWUuZWxlbS5ub2RlVHlwZXx8IWsuY3NzSG9va3NbZS5wcm9wXSYmbnVsbD09ZS5lbGVtLnN0eWxlW0dlKGUucHJvcCldP2UuZWxlbVtlLnByb3BdPWUubm93Omsuc3R5bGUoZS5lbGVtLGUucHJvcCxlLm5vdytlLnVuaXQpfX19KS5zY3JvbGxUb3A9bnQucHJvcEhvb2tzLnNjcm9sbExlZnQ9e3NldDpmdW5jdGlvbihlKXtlLmVsZW0ubm9kZVR5cGUmJmUuZWxlbS5wYXJlbnROb2RlJiYoZS5lbGVtW2UucHJvcF09ZS5ub3cpfX0say5lYXNpbmc9e2xpbmVhcjpmdW5jdGlvbihlKXtyZXR1cm4gZX0sc3dpbmc6ZnVuY3Rpb24oZSl7cmV0dXJuLjUtTWF0aC5jb3MoZSpNYXRoLlBJKS8yfSxfZGVmYXVsdDoic3dpbmcifSxrLmZ4PW50LnByb3RvdHlwZS5pbml0LGsuZnguc3RlcD17fTt2YXIgcnQsaXQsb3QsYXQsc3Q9L14oPzp0b2dnbGV8c2hvd3xoaWRlKSQvLHV0PS9xdWV1ZUhvb2tzJC87ZnVuY3Rpb24gbHQoKXtpdCYmKCExPT09RS5oaWRkZW4mJkMucmVxdWVzdEFuaW1hdGlvbkZyYW1lP0MucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGx0KTpDLnNldFRpbWVvdXQobHQsay5meC5pbnRlcnZhbCksay5meC50aWNrKCkpfWZ1bmN0aW9uIGN0KCl7cmV0dXJuIEMuc2V0VGltZW91dChmdW5jdGlvbigpe3J0PXZvaWQgMH0pLHJ0PURhdGUubm93KCl9ZnVuY3Rpb24gZnQoZSx0KXt2YXIgbixyPTAsaT17aGVpZ2h0OmV9O2Zvcih0PXQ/MTowO3I8NDtyKz0yLXQpaVsibWFyZ2luIisobj1yZVtyXSldPWlbInBhZGRpbmciK25dPWU7cmV0dXJuIHQmJihpLm9wYWNpdHk9aS53aWR0aD1lKSxpfWZ1bmN0aW9uIHB0KGUsdCxuKXtmb3IodmFyIHIsaT0oZHQudHdlZW5lcnNbdF18fFtdKS5jb25jYXQoZHQudHdlZW5lcnNbIioiXSksbz0wLGE9aS5sZW5ndGg7bzxhO28rKylpZihyPWlbb10uY2FsbChuLHQsZSkpcmV0dXJuIHJ9ZnVuY3Rpb24gZHQobyxlLHQpe3ZhciBuLGEscj0wLGk9ZHQucHJlZmlsdGVycy5sZW5ndGgscz1rLkRlZmVycmVkKCkuYWx3YXlzKGZ1bmN0aW9uKCl7ZGVsZXRlIHUuZWxlbX0pLHU9ZnVuY3Rpb24oKXtpZihhKXJldHVybiExO2Zvcih2YXIgZT1ydHx8Y3QoKSx0PU1hdGgubWF4KDAsbC5zdGFydFRpbWUrbC5kdXJhdGlvbi1lKSxuPTEtKHQvbC5kdXJhdGlvbnx8MCkscj0wLGk9bC50d2VlbnMubGVuZ3RoO3I8aTtyKyspbC50d2VlbnNbcl0ucnVuKG4pO3JldHVybiBzLm5vdGlmeVdpdGgobyxbbCxuLHRdKSxuPDEmJmk/dDooaXx8cy5ub3RpZnlXaXRoKG8sW2wsMSwwXSkscy5yZXNvbHZlV2l0aChvLFtsXSksITEpfSxsPXMucHJvbWlzZSh7ZWxlbTpvLHByb3BzOmsuZXh0ZW5kKHt9LGUpLG9wdHM6ay5leHRlbmQoITAse3NwZWNpYWxFYXNpbmc6e30sZWFzaW5nOmsuZWFzaW5nLl9kZWZhdWx0fSx0KSxvcmlnaW5hbFByb3BlcnRpZXM6ZSxvcmlnaW5hbE9wdGlvbnM6dCxzdGFydFRpbWU6cnR8fGN0KCksZHVyYXRpb246dC5kdXJhdGlvbix0d2VlbnM6W10sY3JlYXRlVHdlZW46ZnVuY3Rpb24oZSx0KXt2YXIgbj1rLlR3ZWVuKG8sbC5vcHRzLGUsdCxsLm9wdHMuc3BlY2lhbEVhc2luZ1tlXXx8bC5vcHRzLmVhc2luZyk7cmV0dXJuIGwudHdlZW5zLnB1c2gobiksbn0sc3RvcDpmdW5jdGlvbihlKXt2YXIgdD0wLG49ZT9sLnR3ZWVucy5sZW5ndGg6MDtpZihhKXJldHVybiB0aGlzO2ZvcihhPSEwO3Q8bjt0KyspbC50d2VlbnNbdF0ucnVuKDEpO3JldHVybiBlPyhzLm5vdGlmeVdpdGgobyxbbCwxLDBdKSxzLnJlc29sdmVXaXRoKG8sW2wsZV0pKTpzLnJlamVjdFdpdGgobyxbbCxlXSksdGhpc319KSxjPWwucHJvcHM7Zm9yKCFmdW5jdGlvbihlLHQpe3ZhciBuLHIsaSxvLGE7Zm9yKG4gaW4gZSlpZihpPXRbcj1WKG4pXSxvPWVbbl0sQXJyYXkuaXNBcnJheShvKSYmKGk9b1sxXSxvPWVbbl09b1swXSksbiE9PXImJihlW3JdPW8sZGVsZXRlIGVbbl0pLChhPWsuY3NzSG9va3Nbcl0pJiYiZXhwYW5kImluIGEpZm9yKG4gaW4gbz1hLmV4cGFuZChvKSxkZWxldGUgZVtyXSxvKW4gaW4gZXx8KGVbbl09b1tuXSx0W25dPWkpO2Vsc2UgdFtyXT1pfShjLGwub3B0cy5zcGVjaWFsRWFzaW5nKTtyPGk7cisrKWlmKG49ZHQucHJlZmlsdGVyc1tyXS5jYWxsKGwsbyxjLGwub3B0cykpcmV0dXJuIG0obi5zdG9wKSYmKGsuX3F1ZXVlSG9va3MobC5lbGVtLGwub3B0cy5xdWV1ZSkuc3RvcD1uLnN0b3AuYmluZChuKSksbjtyZXR1cm4gay5tYXAoYyxwdCxsKSxtKGwub3B0cy5zdGFydCkmJmwub3B0cy5zdGFydC5jYWxsKG8sbCksbC5wcm9ncmVzcyhsLm9wdHMucHJvZ3Jlc3MpLmRvbmUobC5vcHRzLmRvbmUsbC5vcHRzLmNvbXBsZXRlKS5mYWlsKGwub3B0cy5mYWlsKS5hbHdheXMobC5vcHRzLmFsd2F5cyksay5meC50aW1lcihrLmV4dGVuZCh1LHtlbGVtOm8sYW5pbTpsLHF1ZXVlOmwub3B0cy5xdWV1ZX0pKSxsfWsuQW5pbWF0aW9uPWsuZXh0ZW5kKGR0LHt0d2VlbmVyczp7IioiOltmdW5jdGlvbihlLHQpe3ZhciBuPXRoaXMuY3JlYXRlVHdlZW4oZSx0KTtyZXR1cm4gbGUobi5lbGVtLGUsbmUuZXhlYyh0KSxuKSxufV19LHR3ZWVuZXI6ZnVuY3Rpb24oZSx0KXttKGUpPyh0PWUsZT1bIioiXSk6ZT1lLm1hdGNoKFIpO2Zvcih2YXIgbixyPTAsaT1lLmxlbmd0aDtyPGk7cisrKW49ZVtyXSxkdC50d2VlbmVyc1tuXT1kdC50d2VlbmVyc1tuXXx8W10sZHQudHdlZW5lcnNbbl0udW5zaGlmdCh0KX0scHJlZmlsdGVyczpbZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbyxhLHMsdSxsLGMsZj0id2lkdGgiaW4gdHx8ImhlaWdodCJpbiB0LHA9dGhpcyxkPXt9LGg9ZS5zdHlsZSxnPWUubm9kZVR5cGUmJnNlKGUpLHY9US5nZXQoZSwiZnhzaG93Iik7Zm9yKHIgaW4gbi5xdWV1ZXx8KG51bGw9PShhPWsuX3F1ZXVlSG9va3MoZSwiZngiKSkudW5xdWV1ZWQmJihhLnVucXVldWVkPTAscz1hLmVtcHR5LmZpcmUsYS5lbXB0eS5maXJlPWZ1bmN0aW9uKCl7YS51bnF1ZXVlZHx8cygpfSksYS51bnF1ZXVlZCsrLHAuYWx3YXlzKGZ1bmN0aW9uKCl7cC5hbHdheXMoZnVuY3Rpb24oKXthLnVucXVldWVkLS0say5xdWV1ZShlLCJmeCIpLmxlbmd0aHx8YS5lbXB0eS5maXJlKCl9KX0pKSx0KWlmKGk9dFtyXSxzdC50ZXN0KGkpKXtpZihkZWxldGUgdFtyXSxvPW98fCJ0b2dnbGUiPT09aSxpPT09KGc/ImhpZGUiOiJzaG93Iikpe2lmKCJzaG93IiE9PWl8fCF2fHx2b2lkIDA9PT12W3JdKWNvbnRpbnVlO2c9ITB9ZFtyXT12JiZ2W3JdfHxrLnN0eWxlKGUscil9aWYoKHU9IWsuaXNFbXB0eU9iamVjdCh0KSl8fCFrLmlzRW1wdHlPYmplY3QoZCkpZm9yKHIgaW4gZiYmMT09PWUubm9kZVR5cGUmJihuLm92ZXJmbG93PVtoLm92ZXJmbG93LGgub3ZlcmZsb3dYLGgub3ZlcmZsb3dZXSxudWxsPT0obD12JiZ2LmRpc3BsYXkpJiYobD1RLmdldChlLCJkaXNwbGF5IikpLCJub25lIj09PShjPWsuY3NzKGUsImRpc3BsYXkiKSkmJihsP2M9bDooZmUoW2VdLCEwKSxsPWUuc3R5bGUuZGlzcGxheXx8bCxjPWsuY3NzKGUsImRpc3BsYXkiKSxmZShbZV0pKSksKCJpbmxpbmUiPT09Y3x8ImlubGluZS1ibG9jayI9PT1jJiZudWxsIT1sKSYmIm5vbmUiPT09ay5jc3MoZSwiZmxvYXQiKSYmKHV8fChwLmRvbmUoZnVuY3Rpb24oKXtoLmRpc3BsYXk9bH0pLG51bGw9PWwmJihjPWguZGlzcGxheSxsPSJub25lIj09PWM/IiI6YykpLGguZGlzcGxheT0iaW5saW5lLWJsb2NrIikpLG4ub3ZlcmZsb3cmJihoLm92ZXJmbG93PSJoaWRkZW4iLHAuYWx3YXlzKGZ1bmN0aW9uKCl7aC5vdmVyZmxvdz1uLm92ZXJmbG93WzBdLGgub3ZlcmZsb3dYPW4ub3ZlcmZsb3dbMV0saC5vdmVyZmxvd1k9bi5vdmVyZmxvd1syXX0pKSx1PSExLGQpdXx8KHY/ImhpZGRlbiJpbiB2JiYoZz12LmhpZGRlbik6dj1RLmFjY2VzcyhlLCJmeHNob3ciLHtkaXNwbGF5Omx9KSxvJiYodi5oaWRkZW49IWcpLGcmJmZlKFtlXSwhMCkscC5kb25lKGZ1bmN0aW9uKCl7Zm9yKHIgaW4gZ3x8ZmUoW2VdKSxRLnJlbW92ZShlLCJmeHNob3ciKSxkKWsuc3R5bGUoZSxyLGRbcl0pfSkpLHU9cHQoZz92W3JdOjAscixwKSxyIGluIHZ8fCh2W3JdPXUuc3RhcnQsZyYmKHUuZW5kPXUuc3RhcnQsdS5zdGFydD0wKSl9XSxwcmVmaWx0ZXI6ZnVuY3Rpb24oZSx0KXt0P2R0LnByZWZpbHRlcnMudW5zaGlmdChlKTpkdC5wcmVmaWx0ZXJzLnB1c2goZSl9fSksay5zcGVlZD1mdW5jdGlvbihlLHQsbil7dmFyIHI9ZSYmIm9iamVjdCI9PXR5cGVvZiBlP2suZXh0ZW5kKHt9LGUpOntjb21wbGV0ZTpufHwhbiYmdHx8bShlKSYmZSxkdXJhdGlvbjplLGVhc2luZzpuJiZ0fHx0JiYhbSh0KSYmdH07cmV0dXJuIGsuZngub2ZmP3IuZHVyYXRpb249MDoibnVtYmVyIiE9dHlwZW9mIHIuZHVyYXRpb24mJihyLmR1cmF0aW9uIGluIGsuZnguc3BlZWRzP3IuZHVyYXRpb249ay5meC5zcGVlZHNbci5kdXJhdGlvbl06ci5kdXJhdGlvbj1rLmZ4LnNwZWVkcy5fZGVmYXVsdCksbnVsbCE9ci5xdWV1ZSYmITAhPT1yLnF1ZXVlfHwoci5xdWV1ZT0iZngiKSxyLm9sZD1yLmNvbXBsZXRlLHIuY29tcGxldGU9ZnVuY3Rpb24oKXttKHIub2xkKSYmci5vbGQuY2FsbCh0aGlzKSxyLnF1ZXVlJiZrLmRlcXVldWUodGhpcyxyLnF1ZXVlKX0scn0say5mbi5leHRlbmQoe2ZhZGVUbzpmdW5jdGlvbihlLHQsbixyKXtyZXR1cm4gdGhpcy5maWx0ZXIoc2UpLmNzcygib3BhY2l0eSIsMCkuc2hvdygpLmVuZCgpLmFuaW1hdGUoe29wYWNpdHk6dH0sZSxuLHIpfSxhbmltYXRlOmZ1bmN0aW9uKHQsZSxuLHIpe3ZhciBpPWsuaXNFbXB0eU9iamVjdCh0KSxvPWsuc3BlZWQoZSxuLHIpLGE9ZnVuY3Rpb24oKXt2YXIgZT1kdCh0aGlzLGsuZXh0ZW5kKHt9LHQpLG8pOyhpfHxRLmdldCh0aGlzLCJmaW5pc2giKSkmJmUuc3RvcCghMCl9O3JldHVybiBhLmZpbmlzaD1hLGl8fCExPT09by5xdWV1ZT90aGlzLmVhY2goYSk6dGhpcy5xdWV1ZShvLnF1ZXVlLGEpfSxzdG9wOmZ1bmN0aW9uKGksZSxvKXt2YXIgYT1mdW5jdGlvbihlKXt2YXIgdD1lLnN0b3A7ZGVsZXRlIGUuc3RvcCx0KG8pfTtyZXR1cm4ic3RyaW5nIiE9dHlwZW9mIGkmJihvPWUsZT1pLGk9dm9pZCAwKSxlJiYhMSE9PWkmJnRoaXMucXVldWUoaXx8ImZ4IixbXSksdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGU9ITAsdD1udWxsIT1pJiZpKyJxdWV1ZUhvb2tzIixuPWsudGltZXJzLHI9US5nZXQodGhpcyk7aWYodClyW3RdJiZyW3RdLnN0b3AmJmEoclt0XSk7ZWxzZSBmb3IodCBpbiByKXJbdF0mJnJbdF0uc3RvcCYmdXQudGVzdCh0KSYmYShyW3RdKTtmb3IodD1uLmxlbmd0aDt0LS07KW5bdF0uZWxlbSE9PXRoaXN8fG51bGwhPWkmJm5bdF0ucXVldWUhPT1pfHwoblt0XS5hbmltLnN0b3AobyksZT0hMSxuLnNwbGljZSh0LDEpKTshZSYmb3x8ay5kZXF1ZXVlKHRoaXMsaSl9KX0sZmluaXNoOmZ1bmN0aW9uKGEpe3JldHVybiExIT09YSYmKGE9YXx8ImZ4IiksdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGUsdD1RLmdldCh0aGlzKSxuPXRbYSsicXVldWUiXSxyPXRbYSsicXVldWVIb29rcyJdLGk9ay50aW1lcnMsbz1uP24ubGVuZ3RoOjA7Zm9yKHQuZmluaXNoPSEwLGsucXVldWUodGhpcyxhLFtdKSxyJiZyLnN0b3AmJnIuc3RvcC5jYWxsKHRoaXMsITApLGU9aS5sZW5ndGg7ZS0tOylpW2VdLmVsZW09PT10aGlzJiZpW2VdLnF1ZXVlPT09YSYmKGlbZV0uYW5pbS5zdG9wKCEwKSxpLnNwbGljZShlLDEpKTtmb3IoZT0wO2U8bztlKyspbltlXSYmbltlXS5maW5pc2gmJm5bZV0uZmluaXNoLmNhbGwodGhpcyk7ZGVsZXRlIHQuZmluaXNofSl9fSksay5lYWNoKFsidG9nZ2xlIiwic2hvdyIsImhpZGUiXSxmdW5jdGlvbihlLHIpe3ZhciBpPWsuZm5bcl07ay5mbltyXT1mdW5jdGlvbihlLHQsbil7cmV0dXJuIG51bGw9PWV8fCJib29sZWFuIj09dHlwZW9mIGU/aS5hcHBseSh0aGlzLGFyZ3VtZW50cyk6dGhpcy5hbmltYXRlKGZ0KHIsITApLGUsdCxuKX19KSxrLmVhY2goe3NsaWRlRG93bjpmdCgic2hvdyIpLHNsaWRlVXA6ZnQoImhpZGUiKSxzbGlkZVRvZ2dsZTpmdCgidG9nZ2xlIiksZmFkZUluOntvcGFjaXR5OiJzaG93In0sZmFkZU91dDp7b3BhY2l0eToiaGlkZSJ9LGZhZGVUb2dnbGU6e29wYWNpdHk6InRvZ2dsZSJ9fSxmdW5jdGlvbihlLHIpe2suZm5bZV09ZnVuY3Rpb24oZSx0LG4pe3JldHVybiB0aGlzLmFuaW1hdGUocixlLHQsbil9fSksay50aW1lcnM9W10say5meC50aWNrPWZ1bmN0aW9uKCl7dmFyIGUsdD0wLG49ay50aW1lcnM7Zm9yKHJ0PURhdGUubm93KCk7dDxuLmxlbmd0aDt0KyspKGU9blt0XSkoKXx8blt0XSE9PWV8fG4uc3BsaWNlKHQtLSwxKTtuLmxlbmd0aHx8ay5meC5zdG9wKCkscnQ9dm9pZCAwfSxrLmZ4LnRpbWVyPWZ1bmN0aW9uKGUpe2sudGltZXJzLnB1c2goZSksay5meC5zdGFydCgpfSxrLmZ4LmludGVydmFsPTEzLGsuZnguc3RhcnQ9ZnVuY3Rpb24oKXtpdHx8KGl0PSEwLGx0KCkpfSxrLmZ4LnN0b3A9ZnVuY3Rpb24oKXtpdD1udWxsfSxrLmZ4LnNwZWVkcz17c2xvdzo2MDAsZmFzdDoyMDAsX2RlZmF1bHQ6NDAwfSxrLmZuLmRlbGF5PWZ1bmN0aW9uKHIsZSl7cmV0dXJuIHI9ay5meCYmay5meC5zcGVlZHNbcl18fHIsZT1lfHwiZngiLHRoaXMucXVldWUoZSxmdW5jdGlvbihlLHQpe3ZhciBuPUMuc2V0VGltZW91dChlLHIpO3Quc3RvcD1mdW5jdGlvbigpe0MuY2xlYXJUaW1lb3V0KG4pfX0pfSxvdD1FLmNyZWF0ZUVsZW1lbnQoImlucHV0IiksYXQ9RS5jcmVhdGVFbGVtZW50KCJzZWxlY3QiKS5hcHBlbmRDaGlsZChFLmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpKSxvdC50eXBlPSJjaGVja2JveCIseS5jaGVja09uPSIiIT09b3QudmFsdWUseS5vcHRTZWxlY3RlZD1hdC5zZWxlY3RlZCwob3Q9RS5jcmVhdGVFbGVtZW50KCJpbnB1dCIpKS52YWx1ZT0idCIsb3QudHlwZT0icmFkaW8iLHkucmFkaW9WYWx1ZT0idCI9PT1vdC52YWx1ZTt2YXIgaHQsZ3Q9ay5leHByLmF0dHJIYW5kbGU7ay5mbi5leHRlbmQoe2F0dHI6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gXyh0aGlzLGsuYXR0cixlLHQsMTxhcmd1bWVudHMubGVuZ3RoKX0scmVtb3ZlQXR0cjpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7ay5yZW1vdmVBdHRyKHRoaXMsZSl9KX19KSxrLmV4dGVuZCh7YXR0cjpmdW5jdGlvbihlLHQsbil7dmFyIHIsaSxvPWUubm9kZVR5cGU7aWYoMyE9PW8mJjghPT1vJiYyIT09bylyZXR1cm4idW5kZWZpbmVkIj09dHlwZW9mIGUuZ2V0QXR0cmlidXRlP2sucHJvcChlLHQsbik6KDE9PT1vJiZrLmlzWE1MRG9jKGUpfHwoaT1rLmF0dHJIb29rc1t0LnRvTG93ZXJDYXNlKCldfHwoay5leHByLm1hdGNoLmJvb2wudGVzdCh0KT9odDp2b2lkIDApKSx2b2lkIDAhPT1uP251bGw9PT1uP3ZvaWQgay5yZW1vdmVBdHRyKGUsdCk6aSYmInNldCJpbiBpJiZ2b2lkIDAhPT0ocj1pLnNldChlLG4sdCkpP3I6KGUuc2V0QXR0cmlidXRlKHQsbisiIiksbik6aSYmImdldCJpbiBpJiZudWxsIT09KHI9aS5nZXQoZSx0KSk/cjpudWxsPT0ocj1rLmZpbmQuYXR0cihlLHQpKT92b2lkIDA6cil9LGF0dHJIb29rczp7dHlwZTp7c2V0OmZ1bmN0aW9uKGUsdCl7aWYoIXkucmFkaW9WYWx1ZSYmInJhZGlvIj09PXQmJkEoZSwiaW5wdXQiKSl7dmFyIG49ZS52YWx1ZTtyZXR1cm4gZS5zZXRBdHRyaWJ1dGUoInR5cGUiLHQpLG4mJihlLnZhbHVlPW4pLHR9fX19LHJlbW92ZUF0dHI6ZnVuY3Rpb24oZSx0KXt2YXIgbixyPTAsaT10JiZ0Lm1hdGNoKFIpO2lmKGkmJjE9PT1lLm5vZGVUeXBlKXdoaWxlKG49aVtyKytdKWUucmVtb3ZlQXR0cmlidXRlKG4pfX0pLGh0PXtzZXQ6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiExPT09dD9rLnJlbW92ZUF0dHIoZSxuKTplLnNldEF0dHJpYnV0ZShuLG4pLG59fSxrLmVhY2goay5leHByLm1hdGNoLmJvb2wuc291cmNlLm1hdGNoKC9cdysvZyksZnVuY3Rpb24oZSx0KXt2YXIgYT1ndFt0XXx8ay5maW5kLmF0dHI7Z3RbdF09ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbz10LnRvTG93ZXJDYXNlKCk7cmV0dXJuIG58fChpPWd0W29dLGd0W29dPXIscj1udWxsIT1hKGUsdCxuKT9vOm51bGwsZ3Rbb109aSkscn19KTt2YXIgdnQ9L14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8YnV0dG9uKSQvaSx5dD0vXig/OmF8YXJlYSkkL2k7ZnVuY3Rpb24gbXQoZSl7cmV0dXJuKGUubWF0Y2goUil8fFtdKS5qb2luKCIgIil9ZnVuY3Rpb24geHQoZSl7cmV0dXJuIGUuZ2V0QXR0cmlidXRlJiZlLmdldEF0dHJpYnV0ZSgiY2xhc3MiKXx8IiJ9ZnVuY3Rpb24gYnQoZSl7cmV0dXJuIEFycmF5LmlzQXJyYXkoZSk/ZToic3RyaW5nIj09dHlwZW9mIGUmJmUubWF0Y2goUil8fFtdfWsuZm4uZXh0ZW5kKHtwcm9wOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIF8odGhpcyxrLnByb3AsZSx0LDE8YXJndW1lbnRzLmxlbmd0aCl9LHJlbW92ZVByb3A6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2RlbGV0ZSB0aGlzW2sucHJvcEZpeFtlXXx8ZV19KX19KSxrLmV4dGVuZCh7cHJvcDpmdW5jdGlvbihlLHQsbil7dmFyIHIsaSxvPWUubm9kZVR5cGU7aWYoMyE9PW8mJjghPT1vJiYyIT09bylyZXR1cm4gMT09PW8mJmsuaXNYTUxEb2MoZSl8fCh0PWsucHJvcEZpeFt0XXx8dCxpPWsucHJvcEhvb2tzW3RdKSx2b2lkIDAhPT1uP2kmJiJzZXQiaW4gaSYmdm9pZCAwIT09KHI9aS5zZXQoZSxuLHQpKT9yOmVbdF09bjppJiYiZ2V0ImluIGkmJm51bGwhPT0ocj1pLmdldChlLHQpKT9yOmVbdF19LHByb3BIb29rczp7dGFiSW5kZXg6e2dldDpmdW5jdGlvbihlKXt2YXIgdD1rLmZpbmQuYXR0cihlLCJ0YWJpbmRleCIpO3JldHVybiB0P3BhcnNlSW50KHQsMTApOnZ0LnRlc3QoZS5ub2RlTmFtZSl8fHl0LnRlc3QoZS5ub2RlTmFtZSkmJmUuaHJlZj8wOi0xfX19LHByb3BGaXg6eyJmb3IiOiJodG1sRm9yIiwiY2xhc3MiOiJjbGFzc05hbWUifX0pLHkub3B0U2VsZWN0ZWR8fChrLnByb3BIb29rcy5zZWxlY3RlZD17Z2V0OmZ1bmN0aW9uKGUpe3ZhciB0PWUucGFyZW50Tm9kZTtyZXR1cm4gdCYmdC5wYXJlbnROb2RlJiZ0LnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleCxudWxsfSxzZXQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wYXJlbnROb2RlO3QmJih0LnNlbGVjdGVkSW5kZXgsdC5wYXJlbnROb2RlJiZ0LnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleCl9fSksay5lYWNoKFsidGFiSW5kZXgiLCJyZWFkT25seSIsIm1heExlbmd0aCIsImNlbGxTcGFjaW5nIiwiY2VsbFBhZGRpbmciLCJyb3dTcGFuIiwiY29sU3BhbiIsInVzZU1hcCIsImZyYW1lQm9yZGVyIiwiY29udGVudEVkaXRhYmxlIl0sZnVuY3Rpb24oKXtrLnByb3BGaXhbdGhpcy50b0xvd2VyQ2FzZSgpXT10aGlzfSksay5mbi5leHRlbmQoe2FkZENsYXNzOmZ1bmN0aW9uKHQpe3ZhciBlLG4scixpLG8sYSxzLHU9MDtpZihtKHQpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oZSl7ayh0aGlzKS5hZGRDbGFzcyh0LmNhbGwodGhpcyxlLHh0KHRoaXMpKSl9KTtpZigoZT1idCh0KSkubGVuZ3RoKXdoaWxlKG49dGhpc1t1KytdKWlmKGk9eHQobikscj0xPT09bi5ub2RlVHlwZSYmIiAiK210KGkpKyIgIil7YT0wO3doaWxlKG89ZVthKytdKXIuaW5kZXhPZigiICIrbysiICIpPDAmJihyKz1vKyIgIik7aSE9PShzPW10KHIpKSYmbi5zZXRBdHRyaWJ1dGUoImNsYXNzIixzKX1yZXR1cm4gdGhpc30scmVtb3ZlQ2xhc3M6ZnVuY3Rpb24odCl7dmFyIGUsbixyLGksbyxhLHMsdT0wO2lmKG0odCkpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihlKXtrKHRoaXMpLnJlbW92ZUNsYXNzKHQuY2FsbCh0aGlzLGUseHQodGhpcykpKX0pO2lmKCFhcmd1bWVudHMubGVuZ3RoKXJldHVybiB0aGlzLmF0dHIoImNsYXNzIiwiIik7aWYoKGU9YnQodCkpLmxlbmd0aCl3aGlsZShuPXRoaXNbdSsrXSlpZihpPXh0KG4pLHI9MT09PW4ubm9kZVR5cGUmJiIgIittdChpKSsiICIpe2E9MDt3aGlsZShvPWVbYSsrXSl3aGlsZSgtMTxyLmluZGV4T2YoIiAiK28rIiAiKSlyPXIucmVwbGFjZSgiICIrbysiICIsIiAiKTtpIT09KHM9bXQocikpJiZuLnNldEF0dHJpYnV0ZSgiY2xhc3MiLHMpfXJldHVybiB0aGlzfSx0b2dnbGVDbGFzczpmdW5jdGlvbihpLHQpe3ZhciBvPXR5cGVvZiBpLGE9InN0cmluZyI9PT1vfHxBcnJheS5pc0FycmF5KGkpO3JldHVybiJib29sZWFuIj09dHlwZW9mIHQmJmE/dD90aGlzLmFkZENsYXNzKGkpOnRoaXMucmVtb3ZlQ2xhc3MoaSk6bShpKT90aGlzLmVhY2goZnVuY3Rpb24oZSl7ayh0aGlzKS50b2dnbGVDbGFzcyhpLmNhbGwodGhpcyxlLHh0KHRoaXMpLHQpLHQpfSk6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGUsdCxuLHI7aWYoYSl7dD0wLG49ayh0aGlzKSxyPWJ0KGkpO3doaWxlKGU9clt0KytdKW4uaGFzQ2xhc3MoZSk/bi5yZW1vdmVDbGFzcyhlKTpuLmFkZENsYXNzKGUpfWVsc2Ugdm9pZCAwIT09aSYmImJvb2xlYW4iIT09b3x8KChlPXh0KHRoaXMpKSYmUS5zZXQodGhpcywiX19jbGFzc05hbWVfXyIsZSksdGhpcy5zZXRBdHRyaWJ1dGUmJnRoaXMuc2V0QXR0cmlidXRlKCJjbGFzcyIsZXx8ITE9PT1pPyIiOlEuZ2V0KHRoaXMsIl9fY2xhc3NOYW1lX18iKXx8IiIpKX0pfSxoYXNDbGFzczpmdW5jdGlvbihlKXt2YXIgdCxuLHI9MDt0PSIgIitlKyIgIjt3aGlsZShuPXRoaXNbcisrXSlpZigxPT09bi5ub2RlVHlwZSYmLTE8KCIgIittdCh4dChuKSkrIiAiKS5pbmRleE9mKHQpKXJldHVybiEwO3JldHVybiExfX0pO3ZhciB3dD0vXHIvZztrLmZuLmV4dGVuZCh7dmFsOmZ1bmN0aW9uKG4pe3ZhciByLGUsaSx0PXRoaXNbMF07cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGk9bShuKSx0aGlzLmVhY2goZnVuY3Rpb24oZSl7dmFyIHQ7MT09PXRoaXMubm9kZVR5cGUmJihudWxsPT0odD1pP24uY2FsbCh0aGlzLGUsayh0aGlzKS52YWwoKSk6bik/dD0iIjoibnVtYmVyIj09dHlwZW9mIHQ/dCs9IiI6QXJyYXkuaXNBcnJheSh0KSYmKHQ9ay5tYXAodCxmdW5jdGlvbihlKXtyZXR1cm4gbnVsbD09ZT8iIjplKyIifSkpLChyPWsudmFsSG9va3NbdGhpcy50eXBlXXx8ay52YWxIb29rc1t0aGlzLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldKSYmInNldCJpbiByJiZ2b2lkIDAhPT1yLnNldCh0aGlzLHQsInZhbHVlIil8fCh0aGlzLnZhbHVlPXQpKX0pKTp0PyhyPWsudmFsSG9va3NbdC50eXBlXXx8ay52YWxIb29rc1t0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldKSYmImdldCJpbiByJiZ2b2lkIDAhPT0oZT1yLmdldCh0LCJ2YWx1ZSIpKT9lOiJzdHJpbmciPT10eXBlb2YoZT10LnZhbHVlKT9lLnJlcGxhY2Uod3QsIiIpOm51bGw9PWU/IiI6ZTp2b2lkIDB9fSksay5leHRlbmQoe3ZhbEhvb2tzOntvcHRpb246e2dldDpmdW5jdGlvbihlKXt2YXIgdD1rLmZpbmQuYXR0cihlLCJ2YWx1ZSIpO3JldHVybiBudWxsIT10P3Q6bXQoay50ZXh0KGUpKX19LHNlbGVjdDp7Z2V0OmZ1bmN0aW9uKGUpe3ZhciB0LG4scixpPWUub3B0aW9ucyxvPWUuc2VsZWN0ZWRJbmRleCxhPSJzZWxlY3Qtb25lIj09PWUudHlwZSxzPWE/bnVsbDpbXSx1PWE/bysxOmkubGVuZ3RoO2ZvcihyPW88MD91OmE/bzowO3I8dTtyKyspaWYoKChuPWlbcl0pLnNlbGVjdGVkfHxyPT09bykmJiFuLmRpc2FibGVkJiYoIW4ucGFyZW50Tm9kZS5kaXNhYmxlZHx8IUEobi5wYXJlbnROb2RlLCJvcHRncm91cCIpKSl7aWYodD1rKG4pLnZhbCgpLGEpcmV0dXJuIHQ7cy5wdXNoKHQpfXJldHVybiBzfSxzZXQ6ZnVuY3Rpb24oZSx0KXt2YXIgbixyLGk9ZS5vcHRpb25zLG89ay5tYWtlQXJyYXkodCksYT1pLmxlbmd0aDt3aGlsZShhLS0pKChyPWlbYV0pLnNlbGVjdGVkPS0xPGsuaW5BcnJheShrLnZhbEhvb2tzLm9wdGlvbi5nZXQociksbykpJiYobj0hMCk7cmV0dXJuIG58fChlLnNlbGVjdGVkSW5kZXg9LTEpLG99fX19KSxrLmVhY2goWyJyYWRpbyIsImNoZWNrYm94Il0sZnVuY3Rpb24oKXtrLnZhbEhvb2tzW3RoaXNdPXtzZXQ6ZnVuY3Rpb24oZSx0KXtpZihBcnJheS5pc0FycmF5KHQpKXJldHVybiBlLmNoZWNrZWQ9LTE8ay5pbkFycmF5KGsoZSkudmFsKCksdCl9fSx5LmNoZWNrT258fChrLnZhbEhvb2tzW3RoaXNdLmdldD1mdW5jdGlvbihlKXtyZXR1cm4gbnVsbD09PWUuZ2V0QXR0cmlidXRlKCJ2YWx1ZSIpPyJvbiI6ZS52YWx1ZX0pfSkseS5mb2N1c2luPSJvbmZvY3VzaW4iaW4gQzt2YXIgVHQ9L14oPzpmb2N1c2luZm9jdXN8Zm9jdXNvdXRibHVyKSQvLEN0PWZ1bmN0aW9uKGUpe2Uuc3RvcFByb3BhZ2F0aW9uKCl9O2suZXh0ZW5kKGsuZXZlbnQse3RyaWdnZXI6ZnVuY3Rpb24oZSx0LG4scil7dmFyIGksbyxhLHMsdSxsLGMsZixwPVtufHxFXSxkPXYuY2FsbChlLCJ0eXBlIik/ZS50eXBlOmUsaD12LmNhbGwoZSwibmFtZXNwYWNlIik/ZS5uYW1lc3BhY2Uuc3BsaXQoIi4iKTpbXTtpZihvPWY9YT1uPW58fEUsMyE9PW4ubm9kZVR5cGUmJjghPT1uLm5vZGVUeXBlJiYhVHQudGVzdChkK2suZXZlbnQudHJpZ2dlcmVkKSYmKC0xPGQuaW5kZXhPZigiLiIpJiYoZD0oaD1kLnNwbGl0KCIuIikpLnNoaWZ0KCksaC5zb3J0KCkpLHU9ZC5pbmRleE9mKCI6Iik8MCYmIm9uIitkLChlPWVbay5leHBhbmRvXT9lOm5ldyBrLkV2ZW50KGQsIm9iamVjdCI9PXR5cGVvZiBlJiZlKSkuaXNUcmlnZ2VyPXI/MjozLGUubmFtZXNwYWNlPWguam9pbigiLiIpLGUucm5hbWVzcGFjZT1lLm5hbWVzcGFjZT9uZXcgUmVnRXhwKCIoXnxcXC4pIitoLmpvaW4oIlxcLig/Oi4qXFwufCkiKSsiKFxcLnwkKSIpOm51bGwsZS5yZXN1bHQ9dm9pZCAwLGUudGFyZ2V0fHwoZS50YXJnZXQ9biksdD1udWxsPT10P1tlXTprLm1ha2VBcnJheSh0LFtlXSksYz1rLmV2ZW50LnNwZWNpYWxbZF18fHt9LHJ8fCFjLnRyaWdnZXJ8fCExIT09Yy50cmlnZ2VyLmFwcGx5KG4sdCkpKXtpZighciYmIWMubm9CdWJibGUmJiF4KG4pKXtmb3Iocz1jLmRlbGVnYXRlVHlwZXx8ZCxUdC50ZXN0KHMrZCl8fChvPW8ucGFyZW50Tm9kZSk7bztvPW8ucGFyZW50Tm9kZSlwLnB1c2gobyksYT1vO2E9PT0obi5vd25lckRvY3VtZW50fHxFKSYmcC5wdXNoKGEuZGVmYXVsdFZpZXd8fGEucGFyZW50V2luZG93fHxDKX1pPTA7d2hpbGUoKG89cFtpKytdKSYmIWUuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSlmPW8sZS50eXBlPTE8aT9zOmMuYmluZFR5cGV8fGQsKGw9KFEuZ2V0KG8sImV2ZW50cyIpfHx7fSlbZS50eXBlXSYmUS5nZXQobywiaGFuZGxlIikpJiZsLmFwcGx5KG8sdCksKGw9dSYmb1t1XSkmJmwuYXBwbHkmJkcobykmJihlLnJlc3VsdD1sLmFwcGx5KG8sdCksITE9PT1lLnJlc3VsdCYmZS5wcmV2ZW50RGVmYXVsdCgpKTtyZXR1cm4gZS50eXBlPWQscnx8ZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKXx8Yy5fZGVmYXVsdCYmITEhPT1jLl9kZWZhdWx0LmFwcGx5KHAucG9wKCksdCl8fCFHKG4pfHx1JiZtKG5bZF0pJiYheChuKSYmKChhPW5bdV0pJiYoblt1XT1udWxsKSxrLmV2ZW50LnRyaWdnZXJlZD1kLGUuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSYmZi5hZGRFdmVudExpc3RlbmVyKGQsQ3QpLG5bZF0oKSxlLmlzUHJvcGFnYXRpb25TdG9wcGVkKCkmJmYucmVtb3ZlRXZlbnRMaXN0ZW5lcihkLEN0KSxrLmV2ZW50LnRyaWdnZXJlZD12b2lkIDAsYSYmKG5bdV09YSkpLGUucmVzdWx0fX0sc2ltdWxhdGU6ZnVuY3Rpb24oZSx0LG4pe3ZhciByPWsuZXh0ZW5kKG5ldyBrLkV2ZW50LG4se3R5cGU6ZSxpc1NpbXVsYXRlZDohMH0pO2suZXZlbnQudHJpZ2dlcihyLG51bGwsdCl9fSksay5mbi5leHRlbmQoe3RyaWdnZXI6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7ay5ldmVudC50cmlnZ2VyKGUsdCx0aGlzKX0pfSx0cmlnZ2VySGFuZGxlcjpmdW5jdGlvbihlLHQpe3ZhciBuPXRoaXNbMF07aWYobilyZXR1cm4gay5ldmVudC50cmlnZ2VyKGUsdCxuLCEwKX19KSx5LmZvY3VzaW58fGsuZWFjaCh7Zm9jdXM6ImZvY3VzaW4iLGJsdXI6ImZvY3Vzb3V0In0sZnVuY3Rpb24obixyKXt2YXIgaT1mdW5jdGlvbihlKXtrLmV2ZW50LnNpbXVsYXRlKHIsZS50YXJnZXQsay5ldmVudC5maXgoZSkpfTtrLmV2ZW50LnNwZWNpYWxbcl09e3NldHVwOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vd25lckRvY3VtZW50fHx0aGlzLHQ9US5hY2Nlc3MoZSxyKTt0fHxlLmFkZEV2ZW50TGlzdGVuZXIobixpLCEwKSxRLmFjY2VzcyhlLHIsKHR8fDApKzEpfSx0ZWFyZG93bjpmdW5jdGlvbigpe3ZhciBlPXRoaXMub3duZXJEb2N1bWVudHx8dGhpcyx0PVEuYWNjZXNzKGUsciktMTt0P1EuYWNjZXNzKGUscix0KTooZS5yZW1vdmVFdmVudExpc3RlbmVyKG4saSwhMCksUS5yZW1vdmUoZSxyKSl9fX0pO3ZhciBFdD1DLmxvY2F0aW9uLGt0PURhdGUubm93KCksU3Q9L1w/LztrLnBhcnNlWE1MPWZ1bmN0aW9uKGUpe3ZhciB0O2lmKCFlfHwic3RyaW5nIiE9dHlwZW9mIGUpcmV0dXJuIG51bGw7dHJ5e3Q9KG5ldyBDLkRPTVBhcnNlcikucGFyc2VGcm9tU3RyaW5nKGUsInRleHQveG1sIil9Y2F0Y2goZSl7dD12b2lkIDB9cmV0dXJuIHQmJiF0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJwYXJzZXJlcnJvciIpLmxlbmd0aHx8ay5lcnJvcigiSW52YWxpZCBYTUw6ICIrZSksdH07dmFyIE50PS9cW1xdJC8sQXQ9L1xyP1xuL2csRHQ9L14oPzpzdWJtaXR8YnV0dG9ufGltYWdlfHJlc2V0fGZpbGUpJC9pLGp0PS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGtleWdlbikvaTtmdW5jdGlvbiBxdChuLGUscixpKXt2YXIgdDtpZihBcnJheS5pc0FycmF5KGUpKWsuZWFjaChlLGZ1bmN0aW9uKGUsdCl7cnx8TnQudGVzdChuKT9pKG4sdCk6cXQobisiWyIrKCJvYmplY3QiPT10eXBlb2YgdCYmbnVsbCE9dD9lOiIiKSsiXSIsdCxyLGkpfSk7ZWxzZSBpZihyfHwib2JqZWN0IiE9PXcoZSkpaShuLGUpO2Vsc2UgZm9yKHQgaW4gZSlxdChuKyJbIit0KyJdIixlW3RdLHIsaSl9ay5wYXJhbT1mdW5jdGlvbihlLHQpe3ZhciBuLHI9W10saT1mdW5jdGlvbihlLHQpe3ZhciBuPW0odCk/dCgpOnQ7cltyLmxlbmd0aF09ZW5jb2RlVVJJQ29tcG9uZW50KGUpKyI9IitlbmNvZGVVUklDb21wb25lbnQobnVsbD09bj8iIjpuKX07aWYobnVsbD09ZSlyZXR1cm4iIjtpZihBcnJheS5pc0FycmF5KGUpfHxlLmpxdWVyeSYmIWsuaXNQbGFpbk9iamVjdChlKSlrLmVhY2goZSxmdW5jdGlvbigpe2kodGhpcy5uYW1lLHRoaXMudmFsdWUpfSk7ZWxzZSBmb3IobiBpbiBlKXF0KG4sZVtuXSx0LGkpO3JldHVybiByLmpvaW4oIiYiKX0say5mbi5leHRlbmQoe3NlcmlhbGl6ZTpmdW5jdGlvbigpe3JldHVybiBrLnBhcmFtKHRoaXMuc2VyaWFsaXplQXJyYXkoKSl9LHNlcmlhbGl6ZUFycmF5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCl7dmFyIGU9ay5wcm9wKHRoaXMsImVsZW1lbnRzIik7cmV0dXJuIGU/ay5tYWtlQXJyYXkoZSk6dGhpc30pLmZpbHRlcihmdW5jdGlvbigpe3ZhciBlPXRoaXMudHlwZTtyZXR1cm4gdGhpcy5uYW1lJiYhayh0aGlzKS5pcygiOmRpc2FibGVkIikmJmp0LnRlc3QodGhpcy5ub2RlTmFtZSkmJiFEdC50ZXN0KGUpJiYodGhpcy5jaGVja2VkfHwhcGUudGVzdChlKSl9KS5tYXAoZnVuY3Rpb24oZSx0KXt2YXIgbj1rKHRoaXMpLnZhbCgpO3JldHVybiBudWxsPT1uP251bGw6QXJyYXkuaXNBcnJheShuKT9rLm1hcChuLGZ1bmN0aW9uKGUpe3JldHVybntuYW1lOnQubmFtZSx2YWx1ZTplLnJlcGxhY2UoQXQsIlxyXG4iKX19KTp7bmFtZTp0Lm5hbWUsdmFsdWU6bi5yZXBsYWNlKEF0LCJcclxuIil9fSkuZ2V0KCl9fSk7dmFyIEx0PS8lMjAvZyxIdD0vIy4qJC8sT3Q9LyhbPyZdKV89W14mXSovLFB0PS9eKC4qPyk6WyBcdF0qKFteXHJcbl0qKSQvZ20sUnQ9L14oPzpHRVR8SEVBRCkkLyxNdD0vXlwvXC8vLEl0PXt9LFd0PXt9LCR0PSIqLyIuY29uY2F0KCIqIiksRnQ9RS5jcmVhdGVFbGVtZW50KCJhIik7ZnVuY3Rpb24gQnQobyl7cmV0dXJuIGZ1bmN0aW9uKGUsdCl7InN0cmluZyIhPXR5cGVvZiBlJiYodD1lLGU9IioiKTt2YXIgbixyPTAsaT1lLnRvTG93ZXJDYXNlKCkubWF0Y2goUil8fFtdO2lmKG0odCkpd2hpbGUobj1pW3IrK10pIisiPT09blswXT8obj1uLnNsaWNlKDEpfHwiKiIsKG9bbl09b1tuXXx8W10pLnVuc2hpZnQodCkpOihvW25dPW9bbl18fFtdKS5wdXNoKHQpfX1mdW5jdGlvbiBfdCh0LGksbyxhKXt2YXIgcz17fSx1PXQ9PT1XdDtmdW5jdGlvbiBsKGUpe3ZhciByO3JldHVybiBzW2VdPSEwLGsuZWFjaCh0W2VdfHxbXSxmdW5jdGlvbihlLHQpe3ZhciBuPXQoaSxvLGEpO3JldHVybiJzdHJpbmciIT10eXBlb2Ygbnx8dXx8c1tuXT91PyEocj1uKTp2b2lkIDA6KGkuZGF0YVR5cGVzLnVuc2hpZnQobiksbChuKSwhMSl9KSxyfXJldHVybiBsKGkuZGF0YVR5cGVzWzBdKXx8IXNbIioiXSYmbCgiKiIpfWZ1bmN0aW9uIHp0KGUsdCl7dmFyIG4scixpPWsuYWpheFNldHRpbmdzLmZsYXRPcHRpb25zfHx7fTtmb3IobiBpbiB0KXZvaWQgMCE9PXRbbl0mJigoaVtuXT9lOnJ8fChyPXt9KSlbbl09dFtuXSk7cmV0dXJuIHImJmsuZXh0ZW5kKCEwLGUsciksZX1GdC5ocmVmPUV0LmhyZWYsay5leHRlbmQoe2FjdGl2ZTowLGxhc3RNb2RpZmllZDp7fSxldGFnOnt9LGFqYXhTZXR0aW5nczp7dXJsOkV0LmhyZWYsdHlwZToiR0VUIixpc0xvY2FsOi9eKD86YWJvdXR8YXBwfGFwcC1zdG9yYWdlfC4rLWV4dGVuc2lvbnxmaWxlfHJlc3x3aWRnZXQpOiQvLnRlc3QoRXQucHJvdG9jb2wpLGdsb2JhbDohMCxwcm9jZXNzRGF0YTohMCxhc3luYzohMCxjb250ZW50VHlwZToiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04IixhY2NlcHRzOnsiKiI6JHQsdGV4dDoidGV4dC9wbGFpbiIsaHRtbDoidGV4dC9odG1sIix4bWw6ImFwcGxpY2F0aW9uL3htbCwgdGV4dC94bWwiLGpzb246ImFwcGxpY2F0aW9uL2pzb24sIHRleHQvamF2YXNjcmlwdCJ9LGNvbnRlbnRzOnt4bWw6L1xieG1sXGIvLGh0bWw6L1xiaHRtbC8sanNvbjovXGJqc29uXGIvfSxyZXNwb25zZUZpZWxkczp7eG1sOiJyZXNwb25zZVhNTCIsdGV4dDoicmVzcG9uc2VUZXh0Iixqc29uOiJyZXNwb25zZUpTT04ifSxjb252ZXJ0ZXJzOnsiKiB0ZXh0IjpTdHJpbmcsInRleHQgaHRtbCI6ITAsInRleHQganNvbiI6SlNPTi5wYXJzZSwidGV4dCB4bWwiOmsucGFyc2VYTUx9LGZsYXRPcHRpb25zOnt1cmw6ITAsY29udGV4dDohMH19LGFqYXhTZXR1cDpmdW5jdGlvbihlLHQpe3JldHVybiB0P3p0KHp0KGUsay5hamF4U2V0dGluZ3MpLHQpOnp0KGsuYWpheFNldHRpbmdzLGUpfSxhamF4UHJlZmlsdGVyOkJ0KEl0KSxhamF4VHJhbnNwb3J0OkJ0KFd0KSxhamF4OmZ1bmN0aW9uKGUsdCl7Im9iamVjdCI9PXR5cGVvZiBlJiYodD1lLGU9dm9pZCAwKSx0PXR8fHt9O3ZhciBjLGYscCxuLGQscixoLGcsaSxvLHY9ay5hamF4U2V0dXAoe30sdCkseT12LmNvbnRleHR8fHYsbT12LmNvbnRleHQmJih5Lm5vZGVUeXBlfHx5LmpxdWVyeSk/ayh5KTprLmV2ZW50LHg9ay5EZWZlcnJlZCgpLGI9ay5DYWxsYmFja3MoIm9uY2UgbWVtb3J5Iiksdz12LnN0YXR1c0NvZGV8fHt9LGE9e30scz17fSx1PSJjYW5jZWxlZCIsVD17cmVhZHlTdGF0ZTowLGdldFJlc3BvbnNlSGVhZGVyOmZ1bmN0aW9uKGUpe3ZhciB0O2lmKGgpe2lmKCFuKXtuPXt9O3doaWxlKHQ9UHQuZXhlYyhwKSluW3RbMV0udG9Mb3dlckNhc2UoKSsiICJdPShuW3RbMV0udG9Mb3dlckNhc2UoKSsiICJdfHxbXSkuY29uY2F0KHRbMl0pfXQ9bltlLnRvTG93ZXJDYXNlKCkrIiAiXX1yZXR1cm4gbnVsbD09dD9udWxsOnQuam9pbigiLCAiKX0sZ2V0QWxsUmVzcG9uc2VIZWFkZXJzOmZ1bmN0aW9uKCl7cmV0dXJuIGg/cDpudWxsfSxzZXRSZXF1ZXN0SGVhZGVyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIG51bGw9PWgmJihlPXNbZS50b0xvd2VyQ2FzZSgpXT1zW2UudG9Mb3dlckNhc2UoKV18fGUsYVtlXT10KSx0aGlzfSxvdmVycmlkZU1pbWVUeXBlOmZ1bmN0aW9uKGUpe3JldHVybiBudWxsPT1oJiYodi5taW1lVHlwZT1lKSx0aGlzfSxzdGF0dXNDb2RlOmZ1bmN0aW9uKGUpe3ZhciB0O2lmKGUpaWYoaClULmFsd2F5cyhlW1Quc3RhdHVzXSk7ZWxzZSBmb3IodCBpbiBlKXdbdF09W3dbdF0sZVt0XV07cmV0dXJuIHRoaXN9LGFib3J0OmZ1bmN0aW9uKGUpe3ZhciB0PWV8fHU7cmV0dXJuIGMmJmMuYWJvcnQodCksbCgwLHQpLHRoaXN9fTtpZih4LnByb21pc2UoVCksdi51cmw9KChlfHx2LnVybHx8RXQuaHJlZikrIiIpLnJlcGxhY2UoTXQsRXQucHJvdG9jb2wrIi8vIiksdi50eXBlPXQubWV0aG9kfHx0LnR5cGV8fHYubWV0aG9kfHx2LnR5cGUsdi5kYXRhVHlwZXM9KHYuZGF0YVR5cGV8fCIqIikudG9Mb3dlckNhc2UoKS5tYXRjaChSKXx8WyIiXSxudWxsPT12LmNyb3NzRG9tYWluKXtyPUUuY3JlYXRlRWxlbWVudCgiYSIpO3RyeXtyLmhyZWY9di51cmwsci5ocmVmPXIuaHJlZix2LmNyb3NzRG9tYWluPUZ0LnByb3RvY29sKyIvLyIrRnQuaG9zdCE9ci5wcm90b2NvbCsiLy8iK3IuaG9zdH1jYXRjaChlKXt2LmNyb3NzRG9tYWluPSEwfX1pZih2LmRhdGEmJnYucHJvY2Vzc0RhdGEmJiJzdHJpbmciIT10eXBlb2Ygdi5kYXRhJiYodi5kYXRhPWsucGFyYW0odi5kYXRhLHYudHJhZGl0aW9uYWwpKSxfdChJdCx2LHQsVCksaClyZXR1cm4gVDtmb3IoaSBpbihnPWsuZXZlbnQmJnYuZ2xvYmFsKSYmMD09ay5hY3RpdmUrKyYmay5ldmVudC50cmlnZ2VyKCJhamF4U3RhcnQiKSx2LnR5cGU9di50eXBlLnRvVXBwZXJDYXNlKCksdi5oYXNDb250ZW50PSFSdC50ZXN0KHYudHlwZSksZj12LnVybC5yZXBsYWNlKEh0LCIiKSx2Lmhhc0NvbnRlbnQ/di5kYXRhJiZ2LnByb2Nlc3NEYXRhJiYwPT09KHYuY29udGVudFR5cGV8fCIiKS5pbmRleE9mKCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKSYmKHYuZGF0YT12LmRhdGEucmVwbGFjZShMdCwiKyIpKToobz12LnVybC5zbGljZShmLmxlbmd0aCksdi5kYXRhJiYodi5wcm9jZXNzRGF0YXx8InN0cmluZyI9PXR5cGVvZiB2LmRhdGEpJiYoZis9KFN0LnRlc3QoZik/IiYiOiI/Iikrdi5kYXRhLGRlbGV0ZSB2LmRhdGEpLCExPT09di5jYWNoZSYmKGY9Zi5yZXBsYWNlKE90LCIkMSIpLG89KFN0LnRlc3QoZik/IiYiOiI/IikrIl89IitrdCsrK28pLHYudXJsPWYrbyksdi5pZk1vZGlmaWVkJiYoay5sYXN0TW9kaWZpZWRbZl0mJlQuc2V0UmVxdWVzdEhlYWRlcigiSWYtTW9kaWZpZWQtU2luY2UiLGsubGFzdE1vZGlmaWVkW2ZdKSxrLmV0YWdbZl0mJlQuc2V0UmVxdWVzdEhlYWRlcigiSWYtTm9uZS1NYXRjaCIsay5ldGFnW2ZdKSksKHYuZGF0YSYmdi5oYXNDb250ZW50JiYhMSE9PXYuY29udGVudFR5cGV8fHQuY29udGVudFR5cGUpJiZULnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsdi5jb250ZW50VHlwZSksVC5zZXRSZXF1ZXN0SGVhZGVyKCJBY2NlcHQiLHYuZGF0YVR5cGVzWzBdJiZ2LmFjY2VwdHNbdi5kYXRhVHlwZXNbMF1dP3YuYWNjZXB0c1t2LmRhdGFUeXBlc1swXV0rKCIqIiE9PXYuZGF0YVR5cGVzWzBdPyIsICIrJHQrIjsgcT0wLjAxIjoiIik6di5hY2NlcHRzWyIqIl0pLHYuaGVhZGVycylULnNldFJlcXVlc3RIZWFkZXIoaSx2LmhlYWRlcnNbaV0pO2lmKHYuYmVmb3JlU2VuZCYmKCExPT09di5iZWZvcmVTZW5kLmNhbGwoeSxULHYpfHxoKSlyZXR1cm4gVC5hYm9ydCgpO2lmKHU9ImFib3J0IixiLmFkZCh2LmNvbXBsZXRlKSxULmRvbmUodi5zdWNjZXNzKSxULmZhaWwodi5lcnJvciksYz1fdChXdCx2LHQsVCkpe2lmKFQucmVhZHlTdGF0ZT0xLGcmJm0udHJpZ2dlcigiYWpheFNlbmQiLFtULHZdKSxoKXJldHVybiBUO3YuYXN5bmMmJjA8di50aW1lb3V0JiYoZD1DLnNldFRpbWVvdXQoZnVuY3Rpb24oKXtULmFib3J0KCJ0aW1lb3V0Iil9LHYudGltZW91dCkpO3RyeXtoPSExLGMuc2VuZChhLGwpfWNhdGNoKGUpe2lmKGgpdGhyb3cgZTtsKC0xLGUpfX1lbHNlIGwoLTEsIk5vIFRyYW5zcG9ydCIpO2Z1bmN0aW9uIGwoZSx0LG4scil7dmFyIGksbyxhLHMsdSxsPXQ7aHx8KGg9ITAsZCYmQy5jbGVhclRpbWVvdXQoZCksYz12b2lkIDAscD1yfHwiIixULnJlYWR5U3RhdGU9MDxlPzQ6MCxpPTIwMDw9ZSYmZTwzMDB8fDMwND09PWUsbiYmKHM9ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbyxhLHM9ZS5jb250ZW50cyx1PWUuZGF0YVR5cGVzO3doaWxlKCIqIj09PXVbMF0pdS5zaGlmdCgpLHZvaWQgMD09PXImJihyPWUubWltZVR5cGV8fHQuZ2V0UmVzcG9uc2VIZWFkZXIoIkNvbnRlbnQtVHlwZSIpKTtpZihyKWZvcihpIGluIHMpaWYoc1tpXSYmc1tpXS50ZXN0KHIpKXt1LnVuc2hpZnQoaSk7YnJlYWt9aWYodVswXWluIG4pbz11WzBdO2Vsc2V7Zm9yKGkgaW4gbil7aWYoIXVbMF18fGUuY29udmVydGVyc1tpKyIgIit1WzBdXSl7bz1pO2JyZWFrfWF8fChhPWkpfW89b3x8YX1pZihvKXJldHVybiBvIT09dVswXSYmdS51bnNoaWZ0KG8pLG5bb119KHYsVCxuKSkscz1mdW5jdGlvbihlLHQsbixyKXt2YXIgaSxvLGEscyx1LGw9e30sYz1lLmRhdGFUeXBlcy5zbGljZSgpO2lmKGNbMV0pZm9yKGEgaW4gZS5jb252ZXJ0ZXJzKWxbYS50b0xvd2VyQ2FzZSgpXT1lLmNvbnZlcnRlcnNbYV07bz1jLnNoaWZ0KCk7d2hpbGUobylpZihlLnJlc3BvbnNlRmllbGRzW29dJiYobltlLnJlc3BvbnNlRmllbGRzW29dXT10KSwhdSYmciYmZS5kYXRhRmlsdGVyJiYodD1lLmRhdGFGaWx0ZXIodCxlLmRhdGFUeXBlKSksdT1vLG89Yy5zaGlmdCgpKWlmKCIqIj09PW8pbz11O2Vsc2UgaWYoIioiIT09dSYmdSE9PW8pe2lmKCEoYT1sW3UrIiAiK29dfHxsWyIqICIrb10pKWZvcihpIGluIGwpaWYoKHM9aS5zcGxpdCgiICIpKVsxXT09PW8mJihhPWxbdSsiICIrc1swXV18fGxbIiogIitzWzBdXSkpeyEwPT09YT9hPWxbaV06ITAhPT1sW2ldJiYobz1zWzBdLGMudW5zaGlmdChzWzFdKSk7YnJlYWt9aWYoITAhPT1hKWlmKGEmJmVbInRocm93cyJdKXQ9YSh0KTtlbHNlIHRyeXt0PWEodCl9Y2F0Y2goZSl7cmV0dXJue3N0YXRlOiJwYXJzZXJlcnJvciIsZXJyb3I6YT9lOiJObyBjb252ZXJzaW9uIGZyb20gIit1KyIgdG8gIitvfX19cmV0dXJue3N0YXRlOiJzdWNjZXNzIixkYXRhOnR9fSh2LHMsVCxpKSxpPyh2LmlmTW9kaWZpZWQmJigodT1ULmdldFJlc3BvbnNlSGVhZGVyKCJMYXN0LU1vZGlmaWVkIikpJiYoay5sYXN0TW9kaWZpZWRbZl09dSksKHU9VC5nZXRSZXNwb25zZUhlYWRlcigiZXRhZyIpKSYmKGsuZXRhZ1tmXT11KSksMjA0PT09ZXx8IkhFQUQiPT09di50eXBlP2w9Im5vY29udGVudCI6MzA0PT09ZT9sPSJub3Rtb2RpZmllZCI6KGw9cy5zdGF0ZSxvPXMuZGF0YSxpPSEoYT1zLmVycm9yKSkpOihhPWwsIWUmJmx8fChsPSJlcnJvciIsZTwwJiYoZT0wKSkpLFQuc3RhdHVzPWUsVC5zdGF0dXNUZXh0PSh0fHxsKSsiIixpP3gucmVzb2x2ZVdpdGgoeSxbbyxsLFRdKTp4LnJlamVjdFdpdGgoeSxbVCxsLGFdKSxULnN0YXR1c0NvZGUodyksdz12b2lkIDAsZyYmbS50cmlnZ2VyKGk/ImFqYXhTdWNjZXNzIjoiYWpheEVycm9yIixbVCx2LGk/bzphXSksYi5maXJlV2l0aCh5LFtULGxdKSxnJiYobS50cmlnZ2VyKCJhamF4Q29tcGxldGUiLFtULHZdKSwtLWsuYWN0aXZlfHxrLmV2ZW50LnRyaWdnZXIoImFqYXhTdG9wIikpKX1yZXR1cm4gVH0sZ2V0SlNPTjpmdW5jdGlvbihlLHQsbil7cmV0dXJuIGsuZ2V0KGUsdCxuLCJqc29uIil9LGdldFNjcmlwdDpmdW5jdGlvbihlLHQpe3JldHVybiBrLmdldChlLHZvaWQgMCx0LCJzY3JpcHQiKX19KSxrLmVhY2goWyJnZXQiLCJwb3N0Il0sZnVuY3Rpb24oZSxpKXtrW2ldPWZ1bmN0aW9uKGUsdCxuLHIpe3JldHVybiBtKHQpJiYocj1yfHxuLG49dCx0PXZvaWQgMCksay5hamF4KGsuZXh0ZW5kKHt1cmw6ZSx0eXBlOmksZGF0YVR5cGU6cixkYXRhOnQsc3VjY2VzczpufSxrLmlzUGxhaW5PYmplY3QoZSkmJmUpKX19KSxrLl9ldmFsVXJsPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGsuYWpheCh7dXJsOmUsdHlwZToiR0VUIixkYXRhVHlwZToic2NyaXB0IixjYWNoZTohMCxhc3luYzohMSxnbG9iYWw6ITEsY29udmVydGVyczp7InRleHQgc2NyaXB0IjpmdW5jdGlvbigpe319LGRhdGFGaWx0ZXI6ZnVuY3Rpb24oZSl7ay5nbG9iYWxFdmFsKGUsdCl9fSl9LGsuZm4uZXh0ZW5kKHt3cmFwQWxsOmZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiB0aGlzWzBdJiYobShlKSYmKGU9ZS5jYWxsKHRoaXNbMF0pKSx0PWsoZSx0aGlzWzBdLm93bmVyRG9jdW1lbnQpLmVxKDApLmNsb25lKCEwKSx0aGlzWzBdLnBhcmVudE5vZGUmJnQuaW5zZXJ0QmVmb3JlKHRoaXNbMF0pLHQubWFwKGZ1bmN0aW9uKCl7dmFyIGU9dGhpczt3aGlsZShlLmZpcnN0RWxlbWVudENoaWxkKWU9ZS5maXJzdEVsZW1lbnRDaGlsZDtyZXR1cm4gZX0pLmFwcGVuZCh0aGlzKSksdGhpc30sd3JhcElubmVyOmZ1bmN0aW9uKG4pe3JldHVybiBtKG4pP3RoaXMuZWFjaChmdW5jdGlvbihlKXtrKHRoaXMpLndyYXBJbm5lcihuLmNhbGwodGhpcyxlKSl9KTp0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgZT1rKHRoaXMpLHQ9ZS5jb250ZW50cygpO3QubGVuZ3RoP3Qud3JhcEFsbChuKTplLmFwcGVuZChuKX0pfSx3cmFwOmZ1bmN0aW9uKHQpe3ZhciBuPW0odCk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihlKXtrKHRoaXMpLndyYXBBbGwobj90LmNhbGwodGhpcyxlKTp0KX0pfSx1bndyYXA6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMucGFyZW50KGUpLm5vdCgiYm9keSIpLmVhY2goZnVuY3Rpb24oKXtrKHRoaXMpLnJlcGxhY2VXaXRoKHRoaXMuY2hpbGROb2Rlcyl9KSx0aGlzfX0pLGsuZXhwci5wc2V1ZG9zLmhpZGRlbj1mdW5jdGlvbihlKXtyZXR1cm4hay5leHByLnBzZXVkb3MudmlzaWJsZShlKX0say5leHByLnBzZXVkb3MudmlzaWJsZT1mdW5jdGlvbihlKXtyZXR1cm4hIShlLm9mZnNldFdpZHRofHxlLm9mZnNldEhlaWdodHx8ZS5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCl9LGsuYWpheFNldHRpbmdzLnhocj1mdW5jdGlvbigpe3RyeXtyZXR1cm4gbmV3IEMuWE1MSHR0cFJlcXVlc3R9Y2F0Y2goZSl7fX07dmFyIFV0PXswOjIwMCwxMjIzOjIwNH0sWHQ9ay5hamF4U2V0dGluZ3MueGhyKCk7eS5jb3JzPSEhWHQmJiJ3aXRoQ3JlZGVudGlhbHMiaW4gWHQseS5hamF4PVh0PSEhWHQsay5hamF4VHJhbnNwb3J0KGZ1bmN0aW9uKGkpe3ZhciBvLGE7aWYoeS5jb3JzfHxYdCYmIWkuY3Jvc3NEb21haW4pcmV0dXJue3NlbmQ6ZnVuY3Rpb24oZSx0KXt2YXIgbixyPWkueGhyKCk7aWYoci5vcGVuKGkudHlwZSxpLnVybCxpLmFzeW5jLGkudXNlcm5hbWUsaS5wYXNzd29yZCksaS54aHJGaWVsZHMpZm9yKG4gaW4gaS54aHJGaWVsZHMpcltuXT1pLnhockZpZWxkc1tuXTtmb3IobiBpbiBpLm1pbWVUeXBlJiZyLm92ZXJyaWRlTWltZVR5cGUmJnIub3ZlcnJpZGVNaW1lVHlwZShpLm1pbWVUeXBlKSxpLmNyb3NzRG9tYWlufHxlWyJYLVJlcXVlc3RlZC1XaXRoIl18fChlWyJYLVJlcXVlc3RlZC1XaXRoIl09IlhNTEh0dHBSZXF1ZXN0IiksZSlyLnNldFJlcXVlc3RIZWFkZXIobixlW25dKTtvPWZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbigpe28mJihvPWE9ci5vbmxvYWQ9ci5vbmVycm9yPXIub25hYm9ydD1yLm9udGltZW91dD1yLm9ucmVhZHlzdGF0ZWNoYW5nZT1udWxsLCJhYm9ydCI9PT1lP3IuYWJvcnQoKToiZXJyb3IiPT09ZT8ibnVtYmVyIiE9dHlwZW9mIHIuc3RhdHVzP3QoMCwiZXJyb3IiKTp0KHIuc3RhdHVzLHIuc3RhdHVzVGV4dCk6dChVdFtyLnN0YXR1c118fHIuc3RhdHVzLHIuc3RhdHVzVGV4dCwidGV4dCIhPT0oci5yZXNwb25zZVR5cGV8fCJ0ZXh0Iil8fCJzdHJpbmciIT10eXBlb2Ygci5yZXNwb25zZVRleHQ/e2JpbmFyeTpyLnJlc3BvbnNlfTp7dGV4dDpyLnJlc3BvbnNlVGV4dH0sci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSkpfX0sci5vbmxvYWQ9bygpLGE9ci5vbmVycm9yPXIub250aW1lb3V0PW8oImVycm9yIiksdm9pZCAwIT09ci5vbmFib3J0P3Iub25hYm9ydD1hOnIub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7ND09PXIucmVhZHlTdGF0ZSYmQy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7byYmYSgpfSl9LG89bygiYWJvcnQiKTt0cnl7ci5zZW5kKGkuaGFzQ29udGVudCYmaS5kYXRhfHxudWxsKX1jYXRjaChlKXtpZihvKXRocm93IGV9fSxhYm9ydDpmdW5jdGlvbigpe28mJm8oKX19fSksay5hamF4UHJlZmlsdGVyKGZ1bmN0aW9uKGUpe2UuY3Jvc3NEb21haW4mJihlLmNvbnRlbnRzLnNjcmlwdD0hMSl9KSxrLmFqYXhTZXR1cCh7YWNjZXB0czp7c2NyaXB0OiJ0ZXh0L2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2VjbWFzY3JpcHQsIGFwcGxpY2F0aW9uL3gtZWNtYXNjcmlwdCJ9LGNvbnRlbnRzOntzY3JpcHQ6L1xiKD86amF2YXxlY21hKXNjcmlwdFxiL30sY29udmVydGVyczp7InRleHQgc2NyaXB0IjpmdW5jdGlvbihlKXtyZXR1cm4gay5nbG9iYWxFdmFsKGUpLGV9fX0pLGsuYWpheFByZWZpbHRlcigic2NyaXB0IixmdW5jdGlvbihlKXt2b2lkIDA9PT1lLmNhY2hlJiYoZS5jYWNoZT0hMSksZS5jcm9zc0RvbWFpbiYmKGUudHlwZT0iR0VUIil9KSxrLmFqYXhUcmFuc3BvcnQoInNjcmlwdCIsZnVuY3Rpb24obil7dmFyIHIsaTtpZihuLmNyb3NzRG9tYWlufHxuLnNjcmlwdEF0dHJzKXJldHVybntzZW5kOmZ1bmN0aW9uKGUsdCl7cj1rKCI8c2NyaXB0PiIpLmF0dHIobi5zY3JpcHRBdHRyc3x8e30pLnByb3Aoe2NoYXJzZXQ6bi5zY3JpcHRDaGFyc2V0LHNyYzpuLnVybH0pLm9uKCJsb2FkIGVycm9yIixpPWZ1bmN0aW9uKGUpe3IucmVtb3ZlKCksaT1udWxsLGUmJnQoImVycm9yIj09PWUudHlwZT80MDQ6MjAwLGUudHlwZSl9KSxFLmhlYWQuYXBwZW5kQ2hpbGQoclswXSl9LGFib3J0OmZ1bmN0aW9uKCl7aSYmaSgpfX19KTt2YXIgVnQsR3Q9W10sWXQ9Lyg9KVw/KD89JnwkKXxcP1w/LztrLmFqYXhTZXR1cCh7anNvbnA6ImNhbGxiYWNrIixqc29ucENhbGxiYWNrOmZ1bmN0aW9uKCl7dmFyIGU9R3QucG9wKCl8fGsuZXhwYW5kbysiXyIra3QrKztyZXR1cm4gdGhpc1tlXT0hMCxlfX0pLGsuYWpheFByZWZpbHRlcigianNvbiBqc29ucCIsZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbyxhPSExIT09ZS5qc29ucCYmKFl0LnRlc3QoZS51cmwpPyJ1cmwiOiJzdHJpbmciPT10eXBlb2YgZS5kYXRhJiYwPT09KGUuY29udGVudFR5cGV8fCIiKS5pbmRleE9mKCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKSYmWXQudGVzdChlLmRhdGEpJiYiZGF0YSIpO2lmKGF8fCJqc29ucCI9PT1lLmRhdGFUeXBlc1swXSlyZXR1cm4gcj1lLmpzb25wQ2FsbGJhY2s9bShlLmpzb25wQ2FsbGJhY2spP2UuanNvbnBDYWxsYmFjaygpOmUuanNvbnBDYWxsYmFjayxhP2VbYV09ZVthXS5yZXBsYWNlKFl0LCIkMSIrcik6ITEhPT1lLmpzb25wJiYoZS51cmwrPShTdC50ZXN0KGUudXJsKT8iJiI6Ij8iKStlLmpzb25wKyI9IityKSxlLmNvbnZlcnRlcnNbInNjcmlwdCBqc29uIl09ZnVuY3Rpb24oKXtyZXR1cm4gb3x8ay5lcnJvcihyKyIgd2FzIG5vdCBjYWxsZWQiKSxvWzBdfSxlLmRhdGFUeXBlc1swXT0ianNvbiIsaT1DW3JdLENbcl09ZnVuY3Rpb24oKXtvPWFyZ3VtZW50c30sbi5hbHdheXMoZnVuY3Rpb24oKXt2b2lkIDA9PT1pP2soQykucmVtb3ZlUHJvcChyKTpDW3JdPWksZVtyXSYmKGUuanNvbnBDYWxsYmFjaz10Lmpzb25wQ2FsbGJhY2ssR3QucHVzaChyKSksbyYmbShpKSYmaShvWzBdKSxvPWk9dm9pZCAwfSksInNjcmlwdCJ9KSx5LmNyZWF0ZUhUTUxEb2N1bWVudD0oKFZ0PUUuaW1wbGVtZW50YXRpb24uY3JlYXRlSFRNTERvY3VtZW50KCIiKS5ib2R5KS5pbm5lckhUTUw9Ijxmb3JtPjwvZm9ybT48Zm9ybT48L2Zvcm0+IiwyPT09VnQuY2hpbGROb2Rlcy5sZW5ndGgpLGsucGFyc2VIVE1MPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4ic3RyaW5nIiE9dHlwZW9mIGU/W106KCJib29sZWFuIj09dHlwZW9mIHQmJihuPXQsdD0hMSksdHx8KHkuY3JlYXRlSFRNTERvY3VtZW50Pygocj0odD1FLmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudCgiIikpLmNyZWF0ZUVsZW1lbnQoImJhc2UiKSkuaHJlZj1FLmxvY2F0aW9uLmhyZWYsdC5oZWFkLmFwcGVuZENoaWxkKHIpKTp0PUUpLG89IW4mJltdLChpPUQuZXhlYyhlKSk/W3QuY3JlYXRlRWxlbWVudChpWzFdKV06KGk9d2UoW2VdLHQsbyksbyYmby5sZW5ndGgmJmsobykucmVtb3ZlKCksay5tZXJnZShbXSxpLmNoaWxkTm9kZXMpKSk7dmFyIHIsaSxvfSxrLmZuLmxvYWQ9ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbyxhPXRoaXMscz1lLmluZGV4T2YoIiAiKTtyZXR1cm4tMTxzJiYocj1tdChlLnNsaWNlKHMpKSxlPWUuc2xpY2UoMCxzKSksbSh0KT8obj10LHQ9dm9pZCAwKTp0JiYib2JqZWN0Ij09dHlwZW9mIHQmJihpPSJQT1NUIiksMDxhLmxlbmd0aCYmay5hamF4KHt1cmw6ZSx0eXBlOml8fCJHRVQiLGRhdGFUeXBlOiJodG1sIixkYXRhOnR9KS5kb25lKGZ1bmN0aW9uKGUpe289YXJndW1lbnRzLGEuaHRtbChyP2soIjxkaXY+IikuYXBwZW5kKGsucGFyc2VIVE1MKGUpKS5maW5kKHIpOmUpfSkuYWx3YXlzKG4mJmZ1bmN0aW9uKGUsdCl7YS5lYWNoKGZ1bmN0aW9uKCl7bi5hcHBseSh0aGlzLG98fFtlLnJlc3BvbnNlVGV4dCx0LGVdKX0pfSksdGhpc30say5lYWNoKFsiYWpheFN0YXJ0IiwiYWpheFN0b3AiLCJhamF4Q29tcGxldGUiLCJhamF4RXJyb3IiLCJhamF4U3VjY2VzcyIsImFqYXhTZW5kIl0sZnVuY3Rpb24oZSx0KXtrLmZuW3RdPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLm9uKHQsZSl9fSksay5leHByLnBzZXVkb3MuYW5pbWF0ZWQ9ZnVuY3Rpb24odCl7cmV0dXJuIGsuZ3JlcChrLnRpbWVycyxmdW5jdGlvbihlKXtyZXR1cm4gdD09PWUuZWxlbX0pLmxlbmd0aH0say5vZmZzZXQ9e3NldE9mZnNldDpmdW5jdGlvbihlLHQsbil7dmFyIHIsaSxvLGEscyx1LGw9ay5jc3MoZSwicG9zaXRpb24iKSxjPWsoZSksZj17fTsic3RhdGljIj09PWwmJihlLnN0eWxlLnBvc2l0aW9uPSJyZWxhdGl2ZSIpLHM9Yy5vZmZzZXQoKSxvPWsuY3NzKGUsInRvcCIpLHU9ay5jc3MoZSwibGVmdCIpLCgiYWJzb2x1dGUiPT09bHx8ImZpeGVkIj09PWwpJiYtMTwobyt1KS5pbmRleE9mKCJhdXRvIik/KGE9KHI9Yy5wb3NpdGlvbigpKS50b3AsaT1yLmxlZnQpOihhPXBhcnNlRmxvYXQobyl8fDAsaT1wYXJzZUZsb2F0KHUpfHwwKSxtKHQpJiYodD10LmNhbGwoZSxuLGsuZXh0ZW5kKHt9LHMpKSksbnVsbCE9dC50b3AmJihmLnRvcD10LnRvcC1zLnRvcCthKSxudWxsIT10LmxlZnQmJihmLmxlZnQ9dC5sZWZ0LXMubGVmdCtpKSwidXNpbmciaW4gdD90LnVzaW5nLmNhbGwoZSxmKTpjLmNzcyhmKX19LGsuZm4uZXh0ZW5kKHtvZmZzZXQ6ZnVuY3Rpb24odCl7aWYoYXJndW1lbnRzLmxlbmd0aClyZXR1cm4gdm9pZCAwPT09dD90aGlzOnRoaXMuZWFjaChmdW5jdGlvbihlKXtrLm9mZnNldC5zZXRPZmZzZXQodGhpcyx0LGUpfSk7dmFyIGUsbixyPXRoaXNbMF07cmV0dXJuIHI/ci5nZXRDbGllbnRSZWN0cygpLmxlbmd0aD8oZT1yLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLG49ci5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3LHt0b3A6ZS50b3Arbi5wYWdlWU9mZnNldCxsZWZ0OmUubGVmdCtuLnBhZ2VYT2Zmc2V0fSk6e3RvcDowLGxlZnQ6MH06dm9pZCAwfSxwb3NpdGlvbjpmdW5jdGlvbigpe2lmKHRoaXNbMF0pe3ZhciBlLHQsbixyPXRoaXNbMF0saT17dG9wOjAsbGVmdDowfTtpZigiZml4ZWQiPT09ay5jc3MociwicG9zaXRpb24iKSl0PXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7ZWxzZXt0PXRoaXMub2Zmc2V0KCksbj1yLm93bmVyRG9jdW1lbnQsZT1yLm9mZnNldFBhcmVudHx8bi5kb2N1bWVudEVsZW1lbnQ7d2hpbGUoZSYmKGU9PT1uLmJvZHl8fGU9PT1uLmRvY3VtZW50RWxlbWVudCkmJiJzdGF0aWMiPT09ay5jc3MoZSwicG9zaXRpb24iKSllPWUucGFyZW50Tm9kZTtlJiZlIT09ciYmMT09PWUubm9kZVR5cGUmJigoaT1rKGUpLm9mZnNldCgpKS50b3ArPWsuY3NzKGUsImJvcmRlclRvcFdpZHRoIiwhMCksaS5sZWZ0Kz1rLmNzcyhlLCJib3JkZXJMZWZ0V2lkdGgiLCEwKSl9cmV0dXJue3RvcDp0LnRvcC1pLnRvcC1rLmNzcyhyLCJtYXJnaW5Ub3AiLCEwKSxsZWZ0OnQubGVmdC1pLmxlZnQtay5jc3MociwibWFyZ2luTGVmdCIsITApfX19LG9mZnNldFBhcmVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbigpe3ZhciBlPXRoaXMub2Zmc2V0UGFyZW50O3doaWxlKGUmJiJzdGF0aWMiPT09ay5jc3MoZSwicG9zaXRpb24iKSllPWUub2Zmc2V0UGFyZW50O3JldHVybiBlfHxpZX0pfX0pLGsuZWFjaCh7c2Nyb2xsTGVmdDoicGFnZVhPZmZzZXQiLHNjcm9sbFRvcDoicGFnZVlPZmZzZXQifSxmdW5jdGlvbih0LGkpe3ZhciBvPSJwYWdlWU9mZnNldCI9PT1pO2suZm5bdF09ZnVuY3Rpb24oZSl7cmV0dXJuIF8odGhpcyxmdW5jdGlvbihlLHQsbil7dmFyIHI7aWYoeChlKT9yPWU6OT09PWUubm9kZVR5cGUmJihyPWUuZGVmYXVsdFZpZXcpLHZvaWQgMD09PW4pcmV0dXJuIHI/cltpXTplW3RdO3I/ci5zY3JvbGxUbyhvP3IucGFnZVhPZmZzZXQ6bixvP246ci5wYWdlWU9mZnNldCk6ZVt0XT1ufSx0LGUsYXJndW1lbnRzLmxlbmd0aCl9fSksay5lYWNoKFsidG9wIiwibGVmdCJdLGZ1bmN0aW9uKGUsbil7ay5jc3NIb29rc1tuXT16ZSh5LnBpeGVsUG9zaXRpb24sZnVuY3Rpb24oZSx0KXtpZih0KXJldHVybiB0PV9lKGUsbiksJGUudGVzdCh0KT9rKGUpLnBvc2l0aW9uKClbbl0rInB4Ijp0fSl9KSxrLmVhY2goe0hlaWdodDoiaGVpZ2h0IixXaWR0aDoid2lkdGgifSxmdW5jdGlvbihhLHMpe2suZWFjaCh7cGFkZGluZzoiaW5uZXIiK2EsY29udGVudDpzLCIiOiJvdXRlciIrYX0sZnVuY3Rpb24ocixvKXtrLmZuW29dPWZ1bmN0aW9uKGUsdCl7dmFyIG49YXJndW1lbnRzLmxlbmd0aCYmKHJ8fCJib29sZWFuIiE9dHlwZW9mIGUpLGk9cnx8KCEwPT09ZXx8ITA9PT10PyJtYXJnaW4iOiJib3JkZXIiKTtyZXR1cm4gXyh0aGlzLGZ1bmN0aW9uKGUsdCxuKXt2YXIgcjtyZXR1cm4geChlKT8wPT09by5pbmRleE9mKCJvdXRlciIpP2VbImlubmVyIithXTplLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudFsiY2xpZW50IithXTo5PT09ZS5ub2RlVHlwZT8ocj1lLmRvY3VtZW50RWxlbWVudCxNYXRoLm1heChlLmJvZHlbInNjcm9sbCIrYV0sclsic2Nyb2xsIithXSxlLmJvZHlbIm9mZnNldCIrYV0sclsib2Zmc2V0IithXSxyWyJjbGllbnQiK2FdKSk6dm9pZCAwPT09bj9rLmNzcyhlLHQsaSk6ay5zdHlsZShlLHQsbixpKX0scyxuP2U6dm9pZCAwLG4pfX0pfSksay5lYWNoKCJibHVyIGZvY3VzIGZvY3VzaW4gZm9jdXNvdXQgcmVzaXplIHNjcm9sbCBjbGljayBkYmxjbGljayBtb3VzZWRvd24gbW91c2V1cCBtb3VzZW1vdmUgbW91c2VvdmVyIG1vdXNlb3V0IG1vdXNlZW50ZXIgbW91c2VsZWF2ZSBjaGFuZ2Ugc2VsZWN0IHN1Ym1pdCBrZXlkb3duIGtleXByZXNzIGtleXVwIGNvbnRleHRtZW51Ii5zcGxpdCgiICIpLGZ1bmN0aW9uKGUsbil7ay5mbltuXT1mdW5jdGlvbihlLHQpe3JldHVybiAwPGFyZ3VtZW50cy5sZW5ndGg/dGhpcy5vbihuLG51bGwsZSx0KTp0aGlzLnRyaWdnZXIobil9fSksay5mbi5leHRlbmQoe2hvdmVyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMubW91c2VlbnRlcihlKS5tb3VzZWxlYXZlKHR8fGUpfX0pLGsuZm4uZXh0ZW5kKHtiaW5kOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gdGhpcy5vbihlLG51bGwsdCxuKX0sdW5iaW5kOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMub2ZmKGUsbnVsbCx0KX0sZGVsZWdhdGU6ZnVuY3Rpb24oZSx0LG4scil7cmV0dXJuIHRoaXMub24odCxlLG4scil9LHVuZGVsZWdhdGU6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiAxPT09YXJndW1lbnRzLmxlbmd0aD90aGlzLm9mZihlLCIqKiIpOnRoaXMub2ZmKHQsZXx8IioqIixuKX19KSxrLnByb3h5PWZ1bmN0aW9uKGUsdCl7dmFyIG4scixpO2lmKCJzdHJpbmciPT10eXBlb2YgdCYmKG49ZVt0XSx0PWUsZT1uKSxtKGUpKXJldHVybiByPXMuY2FsbChhcmd1bWVudHMsMiksKGk9ZnVuY3Rpb24oKXtyZXR1cm4gZS5hcHBseSh0fHx0aGlzLHIuY29uY2F0KHMuY2FsbChhcmd1bWVudHMpKSl9KS5ndWlkPWUuZ3VpZD1lLmd1aWR8fGsuZ3VpZCsrLGl9LGsuaG9sZFJlYWR5PWZ1bmN0aW9uKGUpe2U/ay5yZWFkeVdhaXQrKzprLnJlYWR5KCEwKX0say5pc0FycmF5PUFycmF5LmlzQXJyYXksay5wYXJzZUpTT049SlNPTi5wYXJzZSxrLm5vZGVOYW1lPUEsay5pc0Z1bmN0aW9uPW0say5pc1dpbmRvdz14LGsuY2FtZWxDYXNlPVYsay50eXBlPXcsay5ub3c9RGF0ZS5ub3csay5pc051bWVyaWM9ZnVuY3Rpb24oZSl7dmFyIHQ9ay50eXBlKGUpO3JldHVybigibnVtYmVyIj09PXR8fCJzdHJpbmciPT09dCkmJiFpc05hTihlLXBhcnNlRmxvYXQoZSkpfSwiZnVuY3Rpb24iPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kJiZkZWZpbmUoImpxdWVyeSIsW10sZnVuY3Rpb24oKXtyZXR1cm4ga30pO3ZhciBRdD1DLmpRdWVyeSxKdD1DLiQ7cmV0dXJuIGsubm9Db25mbGljdD1mdW5jdGlvbihlKXtyZXR1cm4gQy4kPT09ayYmKEMuJD1KdCksZSYmQy5qUXVlcnk9PT1rJiYoQy5qUXVlcnk9UXQpLGt9LGV8fChDLmpRdWVyeT1DLiQ9ayksa30pOwo="}]},{"name":"","options":{"check_for_updates":true,"user_modified":null,"comment":null,"compatopts_for_requires":true,"compat_wrappedjsobject":false,"compat_metadata":false,"compat_foreach":false,"compat_powerful_this":null,"sandbox":null,"noframes":null,"unwrap":null,"run_at":null,"run_in":null,"tags":[],"override":{"use_includes":[],"orig_includes":[],"merge_includes":true,"use_matches":[],"orig_matches":["*://pan.baidu.com/disk/home*","*://yun.baidu.com/disk/home*","*://pan.baidu.com/disk/main*","*://yun.baidu.com/disk/main*","*://pan.baidu.com/s/*","*://yun.baidu.com/s/*","*://pan.baidu.com/share/*","*://yun.baidu.com/share/*","*://openapi.baidu.com/*","*://www.aliyundrive.com/s/*","*://www.aliyundrive.com/drive*","*://www.alipan.com/s/*","*://www.alipan.com/drive*","*://cloud.189.cn/web/*","*://pan.xunlei.com/*","*://pan.quark.cn/*","*://yun.139.com/*","*://caiyun.139.com/*"],"merge_matches":true,"use_excludes":[],"orig_excludes":[],"merge_excludes":true,"use_connects":[],"orig_connects":["baidu.com","baidupcs.com","aliyundrive.com","alipan.com","189.cn","xunlei.com","quark.cn","youxiaohou.com","yun.139.com","caiyun.139.com","localhost","*"],"merge_connects":true,"use_blockers":[],"orig_run_at":"document-idle","orig_run_in":[],"orig_noframes":null,"orig_tags":[]}},"storage":{"ts":1747729144347,"data":{"setting_rpc_domain":"shttp://localhost","setting_rpc_port":"s16800","setting_rpc_path":"s/jsonrpc","setting_rpc_token":"s","setting_rpc_dir":"sD:","setting_terminal_type":"swc","setting_theme_color":"s#09AAFF","setting_init_code":"s865746","license":"sAGPL3","baidu_access_token":"s123.6fd85ed5b131394e4b6fd6a485fcc911.YDLJ98aEcavUFck7gloZ79iKpSNu52RA_qrwbkT.c92aZA"}},"enabled":true,"position":6,"file_url":"https://www.youxiaohou.com/panlinker.user.js","uuid":"23e52944-ef9f-4bfb-a986-1135623b5fa3","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICAgICAgIOe9keebmOebtOmTvuS4i+i9veWKqeaJiwovLyBAbmFtZXNwYWNlICAgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL3N5aHl6MTk5MC9iYWlkdXl1bgovLyBAdmVyc2lvbiAgICAgICAgICAgNi4yLjcKLy8gQGF1dGhvciAgICAgICAgICAgIFlvdVhpYW9Ib3UKLy8gQGRlc2NyaXB0aW9uICAgICAgIPCfkYbwn5GG8J+RhvCfkYbwn5GG8J+RhvCfkYYgLSDmlK/mjIHmibnph4/ojrflj5Yg4pyF55m+5bqm572R55uYIOKchemYv+mHjOS6keebmCDinIXlpKnnv7zkupHnm5gg4pyF6L+F6Zu35LqR55uYIOKcheWkuOWFi+e9keebmCDinIXnp7vliqjkupHnm5gg5YWt5aSn572R55uY55qE55u06ZO+5LiL6L295Zyw5Z2A77yM6YWN5ZCIIElETe+8jFhkb3du77yMQXJpYTLvvIxDdXJs77yM5q+U54m55b2X5pif562J5bel5YW36auY5pWI8J+agPCfmoDwn5qA5LiL6L2977yM5a6M576O6YCC6YWNIENocm9tZe+8jEVkZ2XvvIxGaXJlRm9477yMMzYw77yMUVHvvIzmkJzni5fvvIznmb7liIbvvIzpgajmuLjvvIzmmJ/mhL/vvIxPcGVyYe+8jOeMjuixue+8jFZpdmFsZGnvvIxZYW5kZXjvvIxLaXdpIOetiSAxOCDnp43mtY/op4jlmajjgILlj6/lnKjml6Dms5Xlronoo4XlrqLmiLfnq6/nmoTnjq/looPkuIvkvb/nlKjvvIzliqnmiYvlhY3otLnlvIDmupDjgILwn5iOCi8vIEBsaWNlbnNlICAgICAgICAgICBBR1BMLTMuMC1vci1sYXRlcgovLyBAaG9tZXBhZ2UgICAgICAgICAgaHR0cHM6Ly93d3cueW91eGlhb2hvdS5jb20vaW5zdGFsbC5odG1sCi8vIEBzdXBwb3J0VVJMICAgICAgICBodHRwczovL2dpdGh1Yi5jb20vc3loeXoxOTkwL2JhaWR1eXVuCi8vIEB1cGRhdGVVUkwgICAgICAgICBodHRwczovL3d3dy55b3V4aWFvaG91LmNvbS9wYW5saW5rZXIudXNlci5qcwovLyBAZG93bmxvYWRVUkwgICAgICAgaHR0cHM6Ly93d3cueW91eGlhb2hvdS5jb20vcGFubGlua2VyLnVzZXIuanMKLy8gQG1hdGNoICAgICAgICAgICAgICo6Ly9wYW4uYmFpZHUuY29tL2Rpc2svaG9tZSoKLy8gQG1hdGNoICAgICAgICAgICAgICo6Ly95dW4uYmFpZHUuY29tL2Rpc2svaG9tZSoKLy8gQG1hdGNoICAgICAgICAgICAgICo6Ly9wYW4uYmFpZHUuY29tL2Rpc2svbWFpbioKLy8gQG1hdGNoICAgICAgICAgICAgICo6Ly95dW4uYmFpZHUuY29tL2Rpc2svbWFpbioKLy8gQG1hdGNoICAgICAgICAgICAgICo6Ly9wYW4uYmFpZHUuY29tL3MvKgovLyBAbWF0Y2ggICAgICAgICAgICAgKjovL3l1bi5iYWlkdS5jb20vcy8qCi8vIEBtYXRjaCAgICAgICAgICAgICAqOi8vcGFuLmJhaWR1LmNvbS9zaGFyZS8qCi8vIEBtYXRjaCAgICAgICAgICAgICAqOi8veXVuLmJhaWR1LmNvbS9zaGFyZS8qCi8vIEBtYXRjaCAgICAgICAgICAgICAqOi8vb3BlbmFwaS5iYWlkdS5jb20vKgovLyBAbWF0Y2ggICAgICAgICAgICAgKjovL3d3dy5hbGl5dW5kcml2ZS5jb20vcy8qCi8vIEBtYXRjaCAgICAgICAgICAgICAqOi8vd3d3LmFsaXl1bmRyaXZlLmNvbS9kcml2ZSoKLy8gQG1hdGNoICAgICAgICAgICAgICo6Ly93d3cuYWxpcGFuLmNvbS9zLyoKLy8gQG1hdGNoICAgICAgICAgICAgICo6Ly93d3cuYWxpcGFuLmNvbS9kcml2ZSoKLy8gQG1hdGNoICAgICAgICAgICAgICo6Ly9jbG91ZC4xODkuY24vd2ViLyoKLy8gQG1hdGNoICAgICAgICAgICAgICo6Ly9wYW4ueHVubGVpLmNvbS8qCi8vIEBtYXRjaCAgICAgICAgICAgICAqOi8vcGFuLnF1YXJrLmNuLyoKLy8gQG1hdGNoICAgICAgICAgICAgICo6Ly95dW4uMTM5LmNvbS8qCi8vIEBtYXRjaCAgICAgICAgICAgICAqOi8vY2FpeXVuLjEzOS5jb20vKgovLyBAcmVxdWlyZSAgICAgICAgICAgaHR0cHM6Ly91bnBrZy5jb20vanF1ZXJ5QDMuNy4wL2Rpc3QvanF1ZXJ5Lm1pbi5qcwovLyBAcmVxdWlyZSAgICAgICAgICAgaHR0cHM6Ly91bnBrZy5jb20vc3dlZXRhbGVydDJAMTAuMTYuNi9kaXN0L3N3ZWV0YWxlcnQyLmFsbC5taW4uanMKLy8gQHJlcXVpcmUgICAgICAgICAgIGh0dHBzOi8vdW5wa2cuY29tL2pzLW1kNUAwLjcuMy9idWlsZC9tZDUubWluLmpzCi8vIEBjb25uZWN0ICAgICAgICAgICBiYWlkdS5jb20KLy8gQGNvbm5lY3QgICAgICAgICAgIGJhaWR1cGNzLmNvbQovLyBAY29ubmVjdCAgICAgICAgICAgYWxpeXVuZHJpdmUuY29tCi8vIEBjb25uZWN0ICAgICAgICAgICBhbGlwYW4uY29tCi8vIEBjb25uZWN0ICAgICAgICAgICAxODkuY24KLy8gQGNvbm5lY3QgICAgICAgICAgIHh1bmxlaS5jb20KLy8gQGNvbm5lY3QgICAgICAgICAgIHF1YXJrLmNuCi8vIEBjb25uZWN0ICAgICAgICAgICB5b3V4aWFvaG91LmNvbQovLyBAY29ubmVjdCAgICAgICAgICAgeXVuLjEzOS5jb20KLy8gQGNvbm5lY3QgICAgICAgICAgIGNhaXl1bi4xMzkuY29tCi8vIEBjb25uZWN0ICAgICAgICAgICBsb2NhbGhvc3QKLy8gQGNvbm5lY3QgICAgICAgICAgICoKLy8gQHJ1bi1hdCAgICAgICAgICAgIGRvY3VtZW50LWlkbGUKLy8gQGdyYW50ICAgICAgICAgICAgIHVuc2FmZVdpbmRvdwovLyBAZ3JhbnQgICAgICAgICAgICAgR01feG1saHR0cFJlcXVlc3QKLy8gQGdyYW50ICAgICAgICAgICAgIEdNX3NldENsaXBib2FyZAovLyBAZ3JhbnQgICAgICAgICAgICAgR01fc2V0VmFsdWUKLy8gQGdyYW50ICAgICAgICAgICAgIEdNX2dldFZhbHVlCi8vIEBncmFudCAgICAgICAgICAgICBHTV9kZWxldGVWYWx1ZQovLyBAZ3JhbnQgICAgICAgICAgICAgR01fb3BlbkluVGFiCi8vIEBncmFudCAgICAgICAgICAgICBHTV9pbmZvCi8vIEBncmFudCAgICAgICAgICAgICBHTV9yZWdpc3Rlck1lbnVDb21tYW5kCi8vIEBncmFudCAgICAgICAgICAgICBHTV9jb29raWUKLy8gQGdyYW50ICAgICAgICAgICAgIHdpbmRvdy5jbG9zZQovLyBAaWNvbiAgICAgICAgICAgICAgZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhacFpYZENiM2c5SWpBZ01DQXhNamdnTVRJNElqNDhjR0YwYUNCa1BTSk5NVEF6TGpZZ01UQTNMalJqTXk0MUxUSXVNaUE0TGprdE5pNHhJREV6TGpndE1USXVOWE0zTGpNdE1USXVOU0E0TGpVdE1UWXVOV011TlMweExqY2dNaTR5TFRjdU5TQXlMakl0TVRRdU55QXdMVEV3TGpFdE15NHpMVEkxTGpFdE1UVXVOQzB6Tmk0NExURTBMalV0TVRRdE16SXVNUzB4TkM0ekxUTTFMamN0TVRRdU15MDRJREF0TVRVdU55QXhMamt0TWpJdU5pQTFMakpETkRRZ01qTWdNelV1TnlBek1TNDBJRE13TGpnZ05ERXVOMk10TVM0eklESXVPQzAwSURRdU55MDNMakVnTlMwMElDNHpMVGN1TlNBMExqUXRPQzQ1SURrdU5pMHVOU0F4TGprdE1TNDJJRE11TlMwekxqRWdOQzQzUXpRdU5DQTJOaTQ0SURBZ056VXVOeUF3SURnMVl6QWdOaTQ0SURJdU15QXhNeTR4SURZdU1TQXhPQzR5SURVdU5TQTNMalFnTVRRdU1pQXhNaTR5SURJMElERXlMakpvTkRjdU1XTTBMalFnTUNBeE1TMHVOU0F4T0M0ekxUTXVOU0F6TGpJdE1TNDBJRFV1T1MweklEZ3VNUzAwTGpWNklpQm1hV3hzUFNJak5EUTBJaTgrUEhCaGRHZ2daRDBpVFRFeE9TNDRJRFkwTGpOakxqRXRNVGN1TVMweE1DNDBMVEk0TFRFeUxqVXRNekF1TVVNNU5TQXlNaTR4SURjNUxqa2dNakV1T0NBM05pNDVJREl4TGpoakxURTNMallnTUMwek15NHpJREV3TGpVdE16a3VPU0F5Tmk0M0xTNDJJREV1TXkweExqZ2dNaTR6TFRNdU5DQXlMak5vTFM0MFl5MDFMamdnTUMweE1DNDJJRFF1T0MweE1DNDJJREV3TGpkMkxqVmpNQ0F4TGpRdExqZ2dNaTQyTFRFdU9TQXpMak5ETVRNdU5DQTJPU0E0TGpnZ056WXVPQ0E0TGpnZ09EVmpNQ0F4TWk0eUlEa3VPU0F5TWk0eklESXlMaklnTWpJdU0yZzBOUzR5WXpNdU5pMHVNU0F4Tnk0MkxTNDVJREk1TGpZdE1USWdNaTQ1TFRJdU9DQXhNeTQ1TFRFekxqY2dNVFF0TXpGNklpQm1hV3hzUFNJak1UTTVOMlE0SWk4K1BIQmhkR2dnWkQwaVRURXhNQzQ0SURVM0xqUnNMaklnTXk0ell6QWdNUzR6TFRFdU1TQXlMalF0TWk0eklESXVOQzB4TGpNZ01DMHlMak10TVM0eExUSXVNeTB5TGpSc0xTNHhMVEl1T0hZdExqTmpNQzB4TGpJdU9TMHlMaklnTWk0eExUSXVNMmd1TTJNdU55QXdJREV1TXk0eklERXVOeTQzTFM0eUxqRXVNeTQxTGpRZ01TNDBlbTB0TXk0ekxURXdMak5qTUNBeExqSXRNU0F5TGpNdE1pNHlJREl1TTJndExqRmpMUzQ0SURBdE1TNDJMUzQxTFRJdE1TNHlMVFF1TmkwNExqTXRNVE11TXkweE15NDFMVEl5TGpndE1UTXVOUzB4TGpJZ01DMHlMak10TVMweUxqTXRNaTR5ZGkwdU1XTXdMVEV1TWlBeExUSXVNeUF5TGpJdE1pNHphQzR4WVRNd0xqTTNJRE13TGpNM0lEQWdNQ0F4SURFMUxqZ2dOQzQwWXpRdU5pQXlMamdnT0M0MElEWXVPQ0F4TVM0eElERXhMalV1TVM0ekxqSXVOeTR5SURFdU1YcE5PRGd1TXlBM015NDRURGN6TGpVZ09UTXVNbU10TVM0MUlERXVPUzB6TGpVZ015NHhMVFV1TnlBekxqVm9MUzR5WXkwdU5DNHhMUzQ0TGpFdE1TNHlMakV0TGpZZ01DMHhMakV0TGpFdE1TNDJMUzR5TFRJdU1pMHVOQzAwTGpJdE1TNDNMVFV1TmkwekxqVk1ORFF1TXlBM015NDVZeTB5TFRJdU5pMHlMalV0TlM0MExURXVOQzAzTGpjdU1TMHVNUzR4TFM0eUxqSXRMaklnTVM0eUxUSWdNeTQxTFRNdU1pQTJMalF0TXk0eWFEWXVObll0TlM0M1l6QXROaTQ0SURRdU55MHhNaUF4TUM0NUxURXlJRFF1T0NBd0lEZ3VOU0F5TGpZZ01UQXVNeUEzTGpJdU5TQXhMak10TGpJZ01pNDNMVEV1TlNBekxqSnpMVEl1T0MwdU1TMHpMak10TVM0MFl5MHhMakV0TWk0M0xUSXVPUzAwTFRVdU5TMDBMVE11TlNBd0xUWWdNeTAySURkMk9DNHhZekFnTGpVdExqSWdNUzB1TmlBeExqUXRMall1TnkweExqY2dNUzR4TFRJdU5pQXhMakZvTFRndU5HTXRNUzR6SURBdE1pQXVOQzB5TGpFdU55MHVNaTQwSURBZ01TNHpMamtnTWk0MFREWXpMakVnT1RCakxqa2dNUzR5SURJdU1TQXhMamdnTXk0eklERXVPSE15TGpNdExqWWdNeTR4TFRFdU4yd3hOQzQ0TFRFNUxqTmpMamt0TVM0eElERXVNUzB5SUM0NUxUSXVOQzB1TWkwdU15MHVPUzB1TnkweUxqRXRMamRvTFRjdU5tTXRMamtnTUMweExqY3RMalV0TWk0eExURXVNaTB1TXkwdU5DMHVOQzB1T0MwdU5DMHhMak1nTUMweExqUWdNUzR4TFRJdU5TQXlMalV0TWk0MWFEY3VObU16TGpFZ01DQTFMalVnTVM0eklEWXVOaUF6TGpWc0xqTXVOMk11TnlBeUxqRXVNU0EwTGpZdE1TNDNJRFl1T1hvaUlHWnBiR3c5SWlNME5EUWlMejQ4TDNOMlp6ND0KLy8gPT0vVXNlclNjcmlwdD09CgooZnVuY3Rpb24gKCkgewogICAgJ3VzZSBzdHJpY3QnOwoKICAgIGxldCBwdCA9ICcnLCBzZWxlY3RMaXN0ID0gW10sIHBhcmFtcyA9IHt9LCBtb2RlID0gJycsIHdpZHRoID0gODAwLCBwYW4gPSB7fSwgY29sb3IgPSAnJywKICAgICAgICBkb2MgPSAkKGRvY3VtZW50KSwgcHJvZ3Jlc3MgPSB7fSwgcmVxdWVzdCA9IHt9LCBpbnMgPSB7fSwgaWRtID0ge307CiAgICBjb25zdCBzY3JpcHRJbmZvID0gR01faW5mby5zY3JpcHQ7CiAgICBjb25zdCB2ZXJzaW9uID0gc2NyaXB0SW5mby52ZXJzaW9uOwogICAgY29uc3QgYXV0aG9yID0gc2NyaXB0SW5mby5hdXRob3I7CiAgICBjb25zdCBuYW1lID0gc2NyaXB0SW5mby5uYW1lOwogICAgY29uc3QgbWFuYWdlSGFuZGxlciA9IEdNX2luZm8uc2NyaXB0SGFuZGxlcjsKICAgIGNvbnN0IG1hbmFnZVZlcnNpb24gPSBHTV9pbmZvLnZlcnNpb247CiAgICBjb25zdCBjdXN0b21DbGFzcyA9IHsKICAgICAgICBwb3B1cDogJ3BsLXBvcHVwJywKICAgICAgICBoZWFkZXI6ICdwbC1oZWFkZXInLAogICAgICAgIHRpdGxlOiAncGwtdGl0bGUnLAogICAgICAgIGNsb3NlQnV0dG9uOiAncGwtY2xvc2UnLAogICAgICAgIGNvbnRlbnQ6ICdwbC1jb250ZW50JywKICAgICAgICBpbnB1dDogJ3BsLWlucHV0JywKICAgICAgICBmb290ZXI6ICdwbC1mb290ZXInCiAgICB9OwoKICAgIGNvbnN0IHRlcm1pbmFsVHlwZSA9IHsKICAgICAgICB3YzogIldpbmRvd3MgQ01EIiwKICAgICAgICB3cDogIldpbmRvd3MgUG93ZXJTaGVsbCIsCiAgICAgICAgbHQ6ICJMaW51eCDnu4jnq68iLAogICAgICAgIGxzOiAiTGludXggU2hlbGwiLAogICAgICAgIG10OiAiTWFjT1Mg57uI56uvIiwKICAgIH07CgogICAgbGV0IHRvYXN0ID0gU3dhbC5taXhpbih7CiAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgcG9zaXRpb246ICd0b3AnLAogICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICB0aW1lcjogMzUwMCwKICAgICAgICB0aW1lclByb2dyZXNzQmFyOiBmYWxzZSwKICAgICAgICBkaWRPcGVuOiAodG9hc3QpID0+IHsKICAgICAgICAgICAgdG9hc3QuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIFN3YWwuc3RvcFRpbWVyKTsKICAgICAgICAgICAgdG9hc3QuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIFN3YWwucmVzdW1lVGltZXIpOwogICAgICAgIH0KICAgIH0pOwoKICAgIGNvbnN0IG1lc3NhZ2UgPSB7CiAgICAgICAgc3VjY2VzczogKHRleHQpID0+IHsKICAgICAgICAgICAgdG9hc3QuZmlyZSh7dGl0bGU6IHRleHQsIGljb246ICdzdWNjZXNzJ30pOwogICAgICAgIH0sCiAgICAgICAgZXJyb3I6ICh0ZXh0KSA9PiB7CiAgICAgICAgICAgIHRvYXN0LmZpcmUoe3RpdGxlOiB0ZXh0LCBpY29uOiAnZXJyb3InfSk7CiAgICAgICAgfSwKICAgICAgICB3YXJuaW5nOiAodGV4dCkgPT4gewogICAgICAgICAgICB0b2FzdC5maXJlKHt0aXRsZTogdGV4dCwgaWNvbjogJ3dhcm5pbmcnfSk7CiAgICAgICAgfSwKICAgICAgICBpbmZvOiAodGV4dCkgPT4gewogICAgICAgICAgICB0b2FzdC5maXJlKHt0aXRsZTogdGV4dCwgaWNvbjogJ2luZm8nfSk7CiAgICAgICAgfSwKICAgICAgICBxdWVzdGlvbjogKHRleHQpID0+IHsKICAgICAgICAgICAgdG9hc3QuZmlyZSh7dGl0bGU6IHRleHQsIGljb246ICdxdWVzdGlvbid9KTsKICAgICAgICB9CiAgICB9OwoKICAgIGxldCBiYXNlID0gewoKICAgICAgICBnZXRDb29raWUobmFtZSkgewogICAgICAgICAgICBsZXQgY25hbWUgPSBuYW1lICsgIj0iOwogICAgICAgICAgICBsZXQgY2EgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoJzsnKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjYS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgbGV0IGMgPSBjYVtpXS50cmltKCk7CiAgICAgICAgICAgICAgICBpZiAoYy5pbmRleE9mKGNuYW1lKSA9PSAwKSByZXR1cm4gYy5zdWJzdHJpbmcoY25hbWUubGVuZ3RoLCBjLmxlbmd0aCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuICIiOwogICAgICAgIH0sCgogICAgICAgIGlzVHlwZShvYmopIHsKICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvYmopLnJlcGxhY2UoL15cW29iamVjdCAoLispXF0kLywgJyQxJykudG9Mb3dlckNhc2UoKTsKICAgICAgICB9LAoKICAgICAgICBnZXRWYWx1ZShuYW1lKSB7CiAgICAgICAgICAgIHJldHVybiBHTV9nZXRWYWx1ZShuYW1lKTsKICAgICAgICB9LAoKICAgICAgICBzZXRWYWx1ZShuYW1lLCB2YWx1ZSkgewogICAgICAgICAgICBHTV9zZXRWYWx1ZShuYW1lLCB2YWx1ZSk7CiAgICAgICAgfSwKCiAgICAgICAgZGVsZXRlVmFsdWUobmFtZSkgewogICAgICAgICAgICBHTV9kZWxldGVWYWx1ZShuYW1lKTsKICAgICAgICB9LAoKICAgICAgICBnZXRTdG9yYWdlKGtleSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgc2V0U3RvcmFnZShrZXksIHZhbHVlKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmlzVHlwZSh2YWx1ZSkgPT09ICdvYmplY3QnIHx8IHRoaXMuaXNUeXBlKHZhbHVlKSA9PT0gJ2FycmF5JykgewogICAgICAgICAgICAgICAgcmV0dXJuIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgSlNPTi5zdHJpbmdpZnkodmFsdWUpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCB2YWx1ZSk7CiAgICAgICAgfSwKCiAgICAgICAgc2V0Q2xpcGJvYXJkKHRleHQpIHsKICAgICAgICAgICAgR01fc2V0Q2xpcGJvYXJkKHRleHQsICd0ZXh0Jyk7CiAgICAgICAgfSwKCiAgICAgICAgZShzdHIpIHsKICAgICAgICAgICAgcmV0dXJuIGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHN0cikpKTsKICAgICAgICB9LAoKICAgICAgICBkKHN0cikgewogICAgICAgICAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGVzY2FwZShhdG9iKHN0cikpKTsKICAgICAgICB9LAoKICAgICAgICBnZXRFeHRlbnNpb24obmFtZSkgewogICAgICAgICAgICBjb25zdCByZWcgPSAvKD8hXC4pXHcrJC87CiAgICAgICAgICAgIGlmIChyZWcudGVzdChuYW1lKSkgewogICAgICAgICAgICAgICAgbGV0IG1hdGNoID0gbmFtZS5tYXRjaChyZWcpOwogICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoWzBdLnRvVXBwZXJDYXNlKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0sCgogICAgICAgIHNpemVGb3JtYXQodmFsdWUpIHsKICAgICAgICAgICAgaWYgKHZhbHVlID09PSArdmFsdWUpIHsKICAgICAgICAgICAgICAgIGxldCB1bml0ID0gWyJCIiwgIktCIiwgIk1CIiwgIkdCIiwgIlRCIiwgIlBCIiwgIkVCIiwgIlpCIiwgIllCIl07CiAgICAgICAgICAgICAgICBsZXQgaW5kZXggPSBNYXRoLmZsb29yKE1hdGgubG9nKHZhbHVlKSAvIE1hdGgubG9nKDEwMjQpKTsKICAgICAgICAgICAgICAgIGxldCBzaXplID0gdmFsdWUgLyBNYXRoLnBvdygxMDI0LCBpbmRleCk7CiAgICAgICAgICAgICAgICBzaXplID0gc2l6ZS50b0ZpeGVkKDEpOwogICAgICAgICAgICAgICAgcmV0dXJuIHNpemUgKyB1bml0W2luZGV4XTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gJyc7CiAgICAgICAgfSwKCiAgICAgICAgc29ydEJ5TmFtZShhcnIpIHsKICAgICAgICAgICAgY29uc3QgaGFuZGxlID0gKCkgPT4gewogICAgICAgICAgICAgICAgcmV0dXJuIChhLCBiKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcDEgPSBhLmZpbGVuYW1lID8gYS5maWxlbmFtZSA6IGEuc2VydmVyX2ZpbGVuYW1lOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHAyID0gYi5maWxlbmFtZSA/IGIuZmlsZW5hbWUgOiBiLnNlcnZlcl9maWxlbmFtZTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcDEubG9jYWxlQ29tcGFyZShwMiwgInpoLUNOIik7CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9OwogICAgICAgICAgICBhcnIuc29ydChoYW5kbGUoKSk7CiAgICAgICAgfSwKCiAgICAgICAgZml4RmlsZW5hbWUobmFtZSkgewogICAgICAgICAgICByZXR1cm4gbmFtZS5yZXBsYWNlKC9bIT8mfGAiJypcLzo8PlxcXS9nLCAnXycpOwogICAgICAgIH0sCgogICAgICAgIGJsb2JEb3dubG9hZChibG9iLCBmaWxlbmFtZSkgewogICAgICAgICAgICBpZiAoYmxvYiBpbnN0YW5jZW9mIEJsb2IpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7CiAgICAgICAgICAgICAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgICAgICAgICAgICAgYS5ocmVmID0gdXJsOwogICAgICAgICAgICAgICAgYS5kb3dubG9hZCA9IGZpbGVuYW1lOwogICAgICAgICAgICAgICAgYS5jbGljaygpOwogICAgICAgICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTCh1cmwpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgcG9zdCh1cmwsIGRhdGEsIGhlYWRlcnMsIHR5cGUpIHsKICAgICAgICAgICAgaWYgKHRoaXMuaXNUeXBlKGRhdGEpID09PSAnb2JqZWN0JykgewogICAgICAgICAgICAgICAgZGF0YSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgICAgICAgICAgICBHTV94bWxodHRwUmVxdWVzdCh7CiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAiUE9TVCIsIHVybCwgaGVhZGVycywgZGF0YSwKICAgICAgICAgICAgICAgICAgICByZXNwb25zZVR5cGU6IHR5cGUgfHwgJ2pzb24nLAogICAgICAgICAgICAgICAgICAgIG9ubG9hZDogKHJlcykgPT4gewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlID09PSAnYmxvYicgPyByZXNvbHZlKHJlcykgOiByZXNvbHZlKHJlcy5yZXNwb25zZSB8fCByZXMucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIG9uZXJyb3I6IChlcnIpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICBnZXQodXJsLCBoZWFkZXJzLCB0eXBlLCBleHRyYSkgewogICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICAgICAgICAgICAgbGV0IHJlcXVlc3RPYmogPSBHTV94bWxodHRwUmVxdWVzdCh7CiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAiR0VUIiwgdXJsLCBoZWFkZXJzLAogICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlVHlwZTogdHlwZSB8fCAnanNvbicsCiAgICAgICAgICAgICAgICAgICAgb25sb2FkOiAocmVzKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMuc3RhdHVzID09PSAyMDQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RPYmouYWJvcnQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkbVtleHRyYS5pbmRleF0gPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSAnYmxvYicpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5zdGF0dXMgPT09IDIwMCAmJiBiYXNlLmJsb2JEb3dubG9hZChyZXMucmVzcG9uc2UsIGV4dHJhLmZpbGVuYW1lKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzLnJlc3BvbnNlIHx8IHJlcy5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBvbnByb2dyZXNzOiAocmVzKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHRyYSAmJiBleHRyYS5maWxlbmFtZSAmJiBleHRyYS5pbmRleCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnRvdGFsID4gMCA/IHByb2dyZXNzW2V4dHJhLmluZGV4XSA9IChyZXMubG9hZGVkICogMTAwIC8gcmVzLnRvdGFsKS50b0ZpeGVkKDIpIDogcHJvZ3Jlc3NbZXh0cmEuaW5kZXhdID0gMC4wMDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgb25sb2Fkc3RhcnQoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhICYmIGV4dHJhLmZpbGVuYW1lICYmIGV4dHJhLmluZGV4ICYmIChyZXF1ZXN0W2V4dHJhLmluZGV4XSA9IHJlcXVlc3RPYmopOwogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgb25lcnJvcjogKGVycikgPT4gewogICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTsKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIGdldEZpbmFsVXJsKHVybCwgaGVhZGVycykgewogICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICAgICAgICAgICAgbGV0IHJlcXVlc3RPYmogPSBHTV94bWxodHRwUmVxdWVzdCh7CiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAiR0VUIiwgdXJsLCBoZWFkZXJzLAogICAgICAgICAgICAgICAgICAgIG9ubG9hZDogKHJlcykgPT4gewogICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlcy5maW5hbFVybCkKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIG9uZXJyb3I6IChlcnIpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIHN0cmluZ2lmeShvYmopIHsKICAgICAgICAgICAgbGV0IHN0ciA9ICcnOwogICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgICAgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KGtleSkpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBvYmpba2V5XTsKICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YWx1ZS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9IGVuY29kZVVSSUNvbXBvbmVudChrZXkpICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlW2ldKSArICcmJzsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSBlbmNvZGVVUklDb21wb25lbnQoa2V5KSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkgKyAnJic7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBzdHIuc2xpY2UoMCwgLTEpOyAvLyDljrvmjonmnKvlsL7nmoQgIiYiCiAgICAgICAgfSwKCiAgICAgICAgYWRkU3R5bGUoaWQsIHRhZywgY3NzKSB7CiAgICAgICAgICAgIHRhZyA9IHRhZyB8fCAnc3R5bGUnOwogICAgICAgICAgICBsZXQgZG9jID0gZG9jdW1lbnQsIHN0eWxlRG9tID0gZG9jLmdldEVsZW1lbnRCeUlkKGlkKTsKICAgICAgICAgICAgaWYgKHN0eWxlRG9tKSByZXR1cm47CiAgICAgICAgICAgIGxldCBzdHlsZSA9IGRvYy5jcmVhdGVFbGVtZW50KHRhZyk7CiAgICAgICAgICAgIHN0eWxlLnJlbCA9ICdzdHlsZXNoZWV0JzsKICAgICAgICAgICAgc3R5bGUuaWQgPSBpZDsKICAgICAgICAgICAgdGFnID09PSAnc3R5bGUnID8gc3R5bGUuaW5uZXJIVE1MID0gY3NzIDogc3R5bGUuaHJlZiA9IGNzczsKICAgICAgICAgICAgZG9jLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0uYXBwZW5kQ2hpbGQoc3R5bGUpOwogICAgICAgIH0sCgogICAgICAgIHNsZWVwKHRpbWUpIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCB0aW1lKSk7CiAgICAgICAgfSwKCiAgICAgICAgZ2V0TWFqb3JWZXJzaW9uKHZlcnNpb24pIHsKICAgICAgICAgICAgY29uc3QgW21ham9yXSA9ICh2ZXJzaW9uIHx8ICcnKS5zcGxpdCgnLicpOwogICAgICAgICAgICByZXR1cm4gL15cZCskLy50ZXN0KG1ham9yKSA/IG1ham9yIDogbnVsbDsKICAgICAgICB9LAoKICAgICAgICBmaW5kUmVhY3QoZG9tLCB0cmF2ZXJzZVVwID0gMCkgewogICAgICAgICAgICBjb25zdCBrZXkgPSBPYmplY3Qua2V5cyhkb20pLmZpbmQoa2V5ID0+IHsKICAgICAgICAgICAgICAgIHJldHVybiBrZXkuc3RhcnRzV2l0aCgiX19yZWFjdEZpYmVyJCIpCiAgICAgICAgICAgICAgICAgICAgfHwga2V5LnN0YXJ0c1dpdGgoIl9fcmVhY3RJbnRlcm5hbEluc3RhbmNlJCIpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgY29uc3QgZG9tRmliZXIgPSBkb21ba2V5XTsKICAgICAgICAgICAgaWYgKGRvbUZpYmVyID09IG51bGwpIHJldHVybiBudWxsOwoKICAgICAgICAgICAgaWYgKGRvbUZpYmVyLl9jdXJyZW50RWxlbWVudCkgewogICAgICAgICAgICAgICAgbGV0IGNvbXBGaWJlciA9IGRvbUZpYmVyLl9jdXJyZW50RWxlbWVudC5fb3duZXI7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRyYXZlcnNlVXA7IGkrKykgewogICAgICAgICAgICAgICAgICAgIGNvbXBGaWJlciA9IGNvbXBGaWJlci5fY3VycmVudEVsZW1lbnQuX293bmVyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBGaWJlci5faW5zdGFuY2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IEdldENvbXBGaWJlciA9IGZpYmVyID0+IHsKICAgICAgICAgICAgICAgIGxldCBwYXJlbnRGaWJlciA9IGZpYmVyLnJldHVybjsKICAgICAgICAgICAgICAgIHdoaWxlICh0eXBlb2YgcGFyZW50RmliZXIudHlwZSA9PSAic3RyaW5nIikgewogICAgICAgICAgICAgICAgICAgIHBhcmVudEZpYmVyID0gcGFyZW50RmliZXIucmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHBhcmVudEZpYmVyOwogICAgICAgICAgICB9OwogICAgICAgICAgICBsZXQgY29tcEZpYmVyID0gR2V0Q29tcEZpYmVyKGRvbUZpYmVyKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmF2ZXJzZVVwOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvbXBGaWJlciA9IEdldENvbXBGaWJlcihjb21wRmliZXIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBjb21wRmliZXIuc3RhdGVOb2RlIHx8IGNvbXBGaWJlcjsKICAgICAgICB9LAoKICAgICAgICBpbml0RGVmYXVsdENvbmZpZygpIHsKICAgICAgICAgICAgbGV0IHZhbHVlID0gW3sKICAgICAgICAgICAgICAgIG5hbWU6ICdzZXR0aW5nX3JwY19kb21haW4nLAogICAgICAgICAgICAgICAgdmFsdWU6ICdodHRwOi8vbG9jYWxob3N0JwogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICBuYW1lOiAnc2V0dGluZ19ycGNfcG9ydCcsCiAgICAgICAgICAgICAgICB2YWx1ZTogJzE2ODAwJwogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICBuYW1lOiAnc2V0dGluZ19ycGNfcGF0aCcsCiAgICAgICAgICAgICAgICB2YWx1ZTogJy9qc29ucnBjJwogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICBuYW1lOiAnc2V0dGluZ19ycGNfdG9rZW4nLAogICAgICAgICAgICAgICAgdmFsdWU6ICcnCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIG5hbWU6ICdzZXR0aW5nX3JwY19kaXInLAogICAgICAgICAgICAgICAgdmFsdWU6ICdEOicKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgbmFtZTogJ3NldHRpbmdfdGVybWluYWxfdHlwZScsCiAgICAgICAgICAgICAgICB2YWx1ZTogJ3djJwogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICBuYW1lOiAnc2V0dGluZ190aGVtZV9jb2xvcicsCiAgICAgICAgICAgICAgICB2YWx1ZTogJyMwOUFBRkYnCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIG5hbWU6ICdzZXR0aW5nX2luaXRfY29kZScsCiAgICAgICAgICAgICAgICB2YWx1ZTogJycKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgbmFtZTogJ2xpY2Vuc2UnLAogICAgICAgICAgICAgICAgdmFsdWU6ICcnCiAgICAgICAgICAgIH1dOwoKICAgICAgICAgICAgdmFsdWUuZm9yRWFjaCgodikgPT4gewogICAgICAgICAgICAgICAgYmFzZS5nZXRWYWx1ZSh2Lm5hbWUpID09PSB1bmRlZmluZWQgJiYgYmFzZS5zZXRWYWx1ZSh2Lm5hbWUsIHYudmFsdWUpOwogICAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICBzaG93U2V0dGluZygpIHsKICAgICAgICAgICAgbGV0IGRvbSA9ICcnLCBidG4gPSAnJywKICAgICAgICAgICAgICAgIGNvbG9yTGlzdCA9IFsnIzA5QUFGRicsICcjY2MzMjM1JywgJyM1MjZlZmEnLCAnIzUxOGMxNycsICcjZWQ5NDRiJywgJyNmOTY5YTUnLCAnI2JjYTI4MCddOwogICAgICAgICAgICBkb20gKz0gYDxsYWJlbCBjbGFzcz0icGwtc2V0dGluZy1sYWJlbCI+PGRpdiBjbGFzcz0icGwtbGFiZWwiPlJQQ+S4u+acujwvZGl2PjxpbnB1dCB0eXBlPSJ0ZXh0IiAgcGxhY2Vob2xkZXI9IuS4u+acuuWcsOWdgO+8jOmcgOW4puS4imh0dHAocyk6Ly8iIGNsYXNzPSJwbC1pbnB1dCBsaXN0ZW5lci1kb21haW4iIHZhbHVlPSIke2Jhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX2RvbWFpbicpfSI+PC9sYWJlbD5gOwogICAgICAgICAgICBkb20gKz0gYDxsYWJlbCBjbGFzcz0icGwtc2V0dGluZy1sYWJlbCI+PGRpdiBjbGFzcz0icGwtbGFiZWwiPlJQQ+err+WPozwvZGl2PjxpbnB1dCB0eXBlPSJ0ZXh0IiBwbGFjZWhvbGRlcj0i56uv5Y+j5Y+377yM5L6L5aaC77yaTW90cml45Li6MTY4MDAiIGNsYXNzPSJwbC1pbnB1dCBsaXN0ZW5lci1wb3J0IiB2YWx1ZT0iJHtiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wb3J0Jyl9Ij48L2xhYmVsPmA7CiAgICAgICAgICAgIGRvbSArPSBgPGxhYmVsIGNsYXNzPSJwbC1zZXR0aW5nLWxhYmVsIj48ZGl2IGNsYXNzPSJwbC1sYWJlbCI+UlBD6Lev5b6EPC9kaXY+PGlucHV0IHR5cGU9InRleHQiIHBsYWNlaG9sZGVyPSLot6/lvoTvvIzpu5jorqTkuLovanNvbnJwYyIgY2xhc3M9InBsLWlucHV0IGxpc3RlbmVyLXBhdGgiIHZhbHVlPSIke2Jhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BhdGgnKX0iPjwvbGFiZWw+YDsKICAgICAgICAgICAgZG9tICs9IGA8bGFiZWwgY2xhc3M9InBsLXNldHRpbmctbGFiZWwiPjxkaXYgY2xhc3M9InBsLWxhYmVsIj5SUEPlr4bpkqU8L2Rpdj48aW5wdXQgdHlwZT0idGV4dCIgcGxhY2Vob2xkZXI9IuaXoOWvhumSpeaXoOmcgOWhq+WGmSIgY2xhc3M9InBsLWlucHV0IGxpc3RlbmVyLXRva2VuIiB2YWx1ZT0iJHtiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY190b2tlbicpfSI+PC9sYWJlbD5gOwogICAgICAgICAgICBkb20gKz0gYDxsYWJlbCBjbGFzcz0icGwtc2V0dGluZy1sYWJlbCI+PGRpdiBjbGFzcz0icGwtbGFiZWwiPuS/neWtmOi3r+W+hDwvZGl2PjxpbnB1dCB0eXBlPSJ0ZXh0IiBwbGFjZWhvbGRlcj0i5paH5Lu25LiL6L295ZCO5L+d5a2Y6Lev5b6E77yM5L6L5aaC77yaRDoiIGNsYXNzPSJwbC1pbnB1dCBsaXN0ZW5lci1kaXIiIHZhbHVlPSIke2Jhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX2RpcicpfSI+PC9sYWJlbD5gOwoKICAgICAgICAgICAgY29sb3JMaXN0LmZvckVhY2goKHYpID0+IHsKICAgICAgICAgICAgICAgIGJ0biArPSBgPGRpdiBkYXRhLWNvbG9yPSIke3Z9IiBzdHlsZT0iYmFja2dyb3VuZDogJHt2fTtib3JkZXI6IDFweCBzb2xpZCAke3Z9IiBjbGFzcz0icGwtY29sb3ItYm94IGxpc3RlbmVyLWNvbG9yICR7diA9PT0gYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ190aGVtZV9jb2xvcicpID8gJ2NoZWNrZWQnIDogJyd9Ij48L2Rpdj5gOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9tICs9IGA8bGFiZWwgY2xhc3M9InBsLXNldHRpbmctbGFiZWwiPjxkaXYgY2xhc3M9InBsLWxhYmVsIj7nu4jnq6/nsbvlnos8L2Rpdj48c2VsZWN0IGNsYXNzPSJwbC1pbnB1dCBsaXN0ZW5lci10ZXJtaW5hbCI+YDsKICAgICAgICAgICAgT2JqZWN0LmtleXModGVybWluYWxUeXBlKS5mb3JFYWNoKGsgPT4gewogICAgICAgICAgICAgICAgZG9tICs9IGA8b3B0aW9uIHZhbHVlPSIke2t9IiAke2Jhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfdGVybWluYWxfdHlwZScpID09PSBrID8gJ3NlbGVjdGVkJyA6ICcnfT4ke3Rlcm1pbmFsVHlwZVtrXX08L29wdGlvbj5gOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9tICs9IGA8L3NlbGVjdD48L2xhYmVsPmA7CiAgICAgICAgICAgIGRvbSArPSBgPGxhYmVsIGNsYXNzPSJwbC1zZXR0aW5nLWxhYmVsIj48ZGl2IGNsYXNzPSJwbC1sYWJlbCI+5Li76aKY6aKc6ImyPC9kaXY+IDxkaXYgY2xhc3M9InBsLWNvbG9yIj4ke2J0bn08ZGl2PjwvbGFiZWw+YDsKICAgICAgICAgICAgZG9tID0gJzxkaXY+JyArIGRvbSArICc8L2Rpdj4nOwoKICAgICAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgICAgICAgIHRpdGxlOiAn5Yqp5omL6YWN572uJywKICAgICAgICAgICAgICAgIGh0bWw6IGRvbSwKICAgICAgICAgICAgICAgIGljb246ICdpbmZvJywKICAgICAgICAgICAgICAgIHNob3dDbG9zZUJ1dHRvbjogdHJ1ZSwKICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIGZvb3RlcjogcGFuLmZvb3RlciwKICAgICAgICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgICBtZXNzYWdlLnN1Y2Nlc3MoJ+iuvue9ruaIkOWKn++8gScpOwogICAgICAgICAgICAgICAgaGlzdG9yeS5nbygwKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1jb2xvcicsIGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBiYXNlLnNldFZhbHVlKCdzZXR0aW5nX3RoZW1lX2NvbG9yJywgZS50YXJnZXQuZGF0YXNldC5jb2xvcik7CiAgICAgICAgICAgICAgICBtZXNzYWdlLnN1Y2Nlc3MoJ+iuvue9ruaIkOWKn++8gScpOwogICAgICAgICAgICAgICAgaGlzdG9yeS5nbygwKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignaW5wdXQnLCAnLmxpc3RlbmVyLWRvbWFpbicsIGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBiYXNlLnNldFZhbHVlKCdzZXR0aW5nX3JwY19kb21haW4nLCBlLnRhcmdldC52YWx1ZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2lucHV0JywgJy5saXN0ZW5lci1wb3J0JywgYXN5bmMgKGUpID0+IHsKICAgICAgICAgICAgICAgIGJhc2Uuc2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BvcnQnLCBlLnRhcmdldC52YWx1ZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2lucHV0JywgJy5saXN0ZW5lci1wYXRoJywgYXN5bmMgKGUpID0+IHsKICAgICAgICAgICAgICAgIGJhc2Uuc2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BhdGgnLCBlLnRhcmdldC52YWx1ZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2lucHV0JywgJy5saXN0ZW5lci10b2tlbicsIGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBiYXNlLnNldFZhbHVlKCdzZXR0aW5nX3JwY190b2tlbicsIGUudGFyZ2V0LnZhbHVlKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignaW5wdXQnLCAnLmxpc3RlbmVyLWRpcicsIGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBiYXNlLnNldFZhbHVlKCdzZXR0aW5nX3JwY19kaXInLCBlLnRhcmdldC52YWx1ZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NoYW5nZScsICcubGlzdGVuZXItdGVybWluYWwnLCBhc3luYyAoZSkgPT4gewogICAgICAgICAgICAgICAgYmFzZS5zZXRWYWx1ZSgnc2V0dGluZ190ZXJtaW5hbF90eXBlJywgZS50YXJnZXQudmFsdWUpOwogICAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICByZWdpc3Rlck1lbnVDb21tYW5kKCkgewogICAgICAgICAgICBHTV9yZWdpc3Rlck1lbnVDb21tYW5kKCfimpnvuI8g6K6+572uJywgKCkgPT4gewogICAgICAgICAgICAgICAgdGhpcy5zaG93U2V0dGluZygpOwogICAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICBjcmVhdGVUaXAoKSB7CiAgICAgICAgICAgICQoJ2JvZHknKS5hcHBlbmQoJzxkaXYgY2xhc3M9InBsLXRvb2x0aXAiPjwvZGl2PicpOwoKICAgICAgICAgICAgZG9jLm9uKCdtb3VzZWVudGVyIG1vdXNlbGVhdmUnLCAnLmxpc3RlbmVyLXRpcCcsIChlKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoZS50eXBlID09PSAnbW91c2VlbnRlcicpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgZmlsZW5hbWUgPSBlLmN1cnJlbnRUYXJnZXQuaW5uZXJUZXh0OwogICAgICAgICAgICAgICAgICAgIGxldCBzaXplID0gZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuc2l6ZTsKICAgICAgICAgICAgICAgICAgICBsZXQgdGlwID0gYCR7ZmlsZW5hbWV9PHNwYW4gc3R5bGU9Im1hcmdpbi1sZWZ0OiAxMHB4O2NvbG9yOiAjZjU2YzZjOyI+JHtzaXplfTwvc3Bhbj5gOwogICAgICAgICAgICAgICAgICAgICQoZS5jdXJyZW50VGFyZ2V0KS5jc3Moe29wYWNpdHk6ICcwLjUnfSk7CiAgICAgICAgICAgICAgICAgICAgJCgnLnBsLXRvb2x0aXAnKS5odG1sKHRpcCkuY3NzKHsKICAgICAgICAgICAgICAgICAgICAgICAgJ2xlZnQnOiBlLnBhZ2VYICsgMTAgKyAncHgnLAogICAgICAgICAgICAgICAgICAgICAgICAndG9wJzogZS5wYWdlWSAtIGUuY3VycmVudFRhcmdldC5vZmZzZXRUb3AgPiAxNCA/IGUucGFnZVkgKyAncHgnIDogZS5wYWdlWSArIDIwICsgJ3B4JwogICAgICAgICAgICAgICAgICAgIH0pLnNob3coKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJChlLmN1cnJlbnRUYXJnZXQpLmNzcyh7b3BhY2l0eTogJzEnfSk7CiAgICAgICAgICAgICAgICAgICAgJCgnLnBsLXRvb2x0aXAnKS5oaWRlKDApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICBjcmVhdGVMb2FkaW5nKCkgewogICAgICAgICAgICByZXR1cm4gJCgnPGRpdiBjbGFzcz0icGwtbG9hZGluZyI+PGRpdiBjbGFzcz0icGwtbG9hZGluZy1ib3giPjxkaXY+PGRpdj48L2Rpdj48ZGl2PjwvZGl2PjwvZGl2PjwvZGl2PjwvZGl2PicpOwogICAgICAgIH0sCgogICAgICAgIGNyZWF0ZURvd25sb2FkSWZyYW1lKCkgewogICAgICAgICAgICBsZXQgJGRpdiA9ICQoJzxkaXYgc3R5bGU9InBhZGRpbmc6MDttYXJnaW46MDtkaXNwbGF5OmJsb2NrIj48L2Rpdj4nKTsKICAgICAgICAgICAgbGV0ICRpZnJhbWUgPSAkKCc8aWZyYW1lIHNyYz0iamF2YXNjcmlwdDo7IiBpZD0iZG93bmxvYWRJZnJhbWUiIHN0eWxlPSJkaXNwbGF5Om5vbmUiPjwvaWZyYW1lPicpOwogICAgICAgICAgICAkZGl2LmFwcGVuZCgkaWZyYW1lKTsKICAgICAgICAgICAgJCgnYm9keScpLmFwcGVuZCgkZGl2KTsKICAgICAgICB9LAoKICAgICAgICBnZXRNaXJyb3JMaXN0KGxpbmssIG1pcnJvciwgdGhyZWFkID0gMikgewogICAgICAgICAgICBsZXQgaG9zdCA9IG5ldyBVUkwobGluaykuaG9zdDsKICAgICAgICAgICAgbGV0IG1pcnJvcnMgPSBbXTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtaXJyb3IubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhyZWFkOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbSA9IGxpbmsucmVwbGFjZShob3N0LCBtaXJyb3JbaV0pICsgJyYnLnJlcGVhdChqKTsKICAgICAgICAgICAgICAgICAgICBtaXJyb3JzLnB1c2goaXRlbSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIG1pcnJvcnMuam9pbignXG4nKTsKICAgICAgICB9LAoKICAgICAgICBsaXN0ZW5FbGVtZW50KGVsZW1lbnQsIGNhbGxiYWNrKSB7CiAgICAgICAgICAgIGNvbnN0IGNoZWNrSW50ZXJ2YWwgPSA1MDA7IC8vIOajgOafpeWFg+e0oOeahOmXtOmalOaXtumXtO+8iOavq+enku+8iQogICAgICAgICAgICBsZXQgd2FzRWxlbWVudEZvdW5kID0gZmFsc2U7IC8vIOeUqOS6jui3n+i4quWFg+e0oOaYr+WQpuS5i+WJjeW3sue7j+aJvuWIsAoKICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2tFbGVtZW50KCkgewogICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZWxlbWVudCkpIHsKICAgICAgICAgICAgICAgICAgICB3YXNFbGVtZW50Rm91bmQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHdhc0VsZW1lbnRGb3VuZCkgewogICAgICAgICAgICAgICAgICAgIHdhc0VsZW1lbnRGb3VuZCA9IGZhbHNlOyAvLyDlhYPntKDmtojlpLHlkI7ph43nva7moIflv5cKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGNoZWNrRWxlbWVudCwgY2hlY2tJbnRlcnZhbCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNoZWNrRWxlbWVudCgpOwogICAgICAgIH0sCgogICAgICAgIGFkZFBhbkxpbmtlclN0eWxlKCkgewogICAgICAgICAgICBjb2xvciA9IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfdGhlbWVfY29sb3InKTsKICAgICAgICAgICAgbGV0IGNzcyA9IGAKICAgICAgICAgICAgYm9keTo6LXdlYmtpdC1zY3JvbGxiYXIgeyBkaXNwbGF5OiBub25lIH0KICAgICAgICAgICAgOjotd2Via2l0LXNjcm9sbGJhciB7IHdpZHRoOiA2cHg7IGhlaWdodDogMTBweCB9CiAgICAgICAgICAgIDo6LXdlYmtpdC1zY3JvbGxiYXItdHJhY2sgeyBib3JkZXItcmFkaXVzOiAwOyBiYWNrZ3JvdW5kOiBub25lIH0KICAgICAgICAgICAgOjotd2Via2l0LXNjcm9sbGJhci10aHVtYiB7IGJhY2tncm91bmQtY29sb3I6IHJnYmEoODUsODUsODUsLjQpIH0KICAgICAgICAgICAgOjotd2Via2l0LXNjcm9sbGJhci10aHVtYiw6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvdmVyIHsgYm9yZGVyLXJhZGl1czogNXB4OyAtd2Via2l0LWJveC1zaGFkb3c6IGluc2V0IDAgMCA2cHggcmdiYSgwLDAsMCwuMikgfQogICAgICAgICAgICA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjogcmdiYSg4NSw4NSw4NSwuMykgfQogICAgICAgICAgICAuc3dhbDItcG9wdXAgeyBmb250LXNpemU6IDE2cHggIWltcG9ydGFudDsgfQogICAgICAgICAgICAucGwtcG9wdXAgeyBmb250LXNpemU6IDEycHggIWltcG9ydGFudDsgfQogICAgICAgICAgICAucGwtcG9wdXAgYSB7IGNvbG9yOiAke2NvbG9yfSAhaW1wb3J0YW50OyB9CiAgICAgICAgICAgIC5wbC1oZWFkZXIgeyBwYWRkaW5nOiAwIWltcG9ydGFudDthbGlnbi1pdGVtczogZmxleC1zdGFydCFpbXBvcnRhbnQ7IGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZWVlIWltcG9ydGFudDsgbWFyZ2luOiAwIDAgMTBweCFpbXBvcnRhbnQ7IHBhZGRpbmc6IDAgMCA1cHghaW1wb3J0YW50OyB9CiAgICAgICAgICAgIC5wbC10aXRsZSB7IGZvbnQtc2l6ZTogMTZweCFpbXBvcnRhbnQ7IGxpbmUtaGVpZ2h0OiAxIWltcG9ydGFudDt3aGl0ZS1zcGFjZTogbm93cmFwIWltcG9ydGFudDsgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXMhaW1wb3J0YW50O30KICAgICAgICAgICAgLnBsLWNvbnRlbnQgeyBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7IGZvbnQtc2l6ZTogMTJweCFpbXBvcnRhbnQ7IH0KICAgICAgICAgICAgLnBsLW1haW4geyBtYXgtaGVpZ2h0OiA0MDBweDtvdmVyZmxvdy15OnNjcm9sbDsgfQogICAgICAgICAgICAucGwtZm9vdGVyIHtmb250LXNpemU6IDEycHghaW1wb3J0YW50O2p1c3RpZnktY29udGVudDogZmxleC1zdGFydCFpbXBvcnRhbnQ7IG1hcmdpbjogMTBweCAwIDAhaW1wb3J0YW50OyBwYWRkaW5nOiA1cHggMCAwIWltcG9ydGFudDsgY29sb3I6ICNmNTZjNmMhaW1wb3J0YW50OyB9CiAgICAgICAgICAgIC5wbC1pdGVtIHsgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgbGluZS1oZWlnaHQ6IDIycHg7IH0KICAgICAgICAgICAgLnBsLWl0ZW0tbmFtZSB7IGZsZXg6IDAgMCAxNTBweDsgdGV4dC1hbGlnbjogbGVmdDttYXJnaW4tcmlnaHQ6IDEwcHg7IG92ZXJmbG93OiBoaWRkZW47IHdoaXRlLXNwYWNlOiBub3dyYXA7IHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOyBjdXJzb3I6ZGVmYXVsdDsgfQogICAgICAgICAgICAucGwtaXRlbS1saW5rIHsgZmxleDogMTsgb3ZlcmZsb3c6IGhpZGRlbjsgdGV4dC1hbGlnbjogbGVmdDsgd2hpdGUtc3BhY2U6IG5vd3JhcDsgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7Y3Vyc29yOnBvaW50ZXIgfQogICAgICAgICAgICAucGwtaXRlbS1idG4geyBiYWNrZ3JvdW5kOiAke2NvbG9yfTsgcGFkZGluZzogNHB4IDVweDsgYm9yZGVyLXJhZGl1czogM3B4OyBsaW5lLWhlaWdodDogMTsgY3Vyc29yOiBwb2ludGVyOyBjb2xvcjogI2ZmZjsgfQogICAgICAgICAgICAucGwtaXRlbS10aXAgeyBkaXNwbGF5OiBmbGV4OyBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47ZmxleDogMTsgfQogICAgICAgICAgICAucGwtYmFjayB7IHdpZHRoOiA3MHB4OyBiYWNrZ3JvdW5kOiAjZGRkOyBib3JkZXItcmFkaXVzOiAzcHg7IGN1cnNvcjpwb2ludGVyOyBtYXJnaW46MXB4IDA7IH0KICAgICAgICAgICAgLnBsLWV4dCB7IGRpc3BsYXk6IGlubGluZS1ibG9jazsgd2lkdGg6IDQ0cHg7IGJhY2tncm91bmQ6ICM5OTk7IGNvbG9yOiAjZmZmOyBoZWlnaHQ6IDE2cHg7IGxpbmUtaGVpZ2h0OiAxNnB4OyBmb250LXNpemU6IDEycHg7IGJvcmRlci1yYWRpdXM6IDNweDt9CiAgICAgICAgICAgIC5wbC1yZXRyeSB7cGFkZGluZzogM3B4IDEwcHg7IGJhY2tncm91bmQ6ICNjYzMyMzU7IGNvbG9yOiAjZmZmOyBib3JkZXItcmFkaXVzOiAzcHg7IGN1cnNvcjogcG9pbnRlcjt9CiAgICAgICAgICAgIC5wbC1icm93c2VyZG93bmxvYWQgeyBwYWRkaW5nOiAzcHggMTBweDsgYmFja2dyb3VuZDogJHtjb2xvcn07IGNvbG9yOiAjZmZmOyBib3JkZXItcmFkaXVzOiAzcHg7IGN1cnNvcjogcG9pbnRlcjt9CiAgICAgICAgICAgIC5wbC1pdGVtLXByb2dyZXNzIHsgZGlzcGxheTpmbGV4O2ZsZXg6IDE7YWxpZ24taXRlbXM6Y2VudGVyfQogICAgICAgICAgICAucGwtcHJvZ3Jlc3MgeyBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7dmVydGljYWwtYWxpZ246IG1pZGRsZTt3aWR0aDogMTAwJTsgYm94LXNpemluZzogYm9yZGVyLWJveDtsaW5lLWhlaWdodDogMTtwb3NpdGlvbjogcmVsYXRpdmU7aGVpZ2h0OjE1cHg7IGZsZXg6IDF9CiAgICAgICAgICAgIC5wbC1wcm9ncmVzcy1vdXRlciB7IGhlaWdodDogMTVweDtib3JkZXItcmFkaXVzOiAxMDBweDtiYWNrZ3JvdW5kLWNvbG9yOiAjZWJlZWY1O292ZXJmbG93OiBoaWRkZW47cG9zaXRpb246IHJlbGF0aXZlO3ZlcnRpY2FsLWFsaWduOiBtaWRkbGU7fQogICAgICAgICAgICAucGwtcHJvZ3Jlc3MtaW5uZXJ7IHBvc2l0aW9uOiBhYnNvbHV0ZTtsZWZ0OiAwO3RvcDogMDtiYWNrZ3JvdW5kLWNvbG9yOiAjNDA5ZWZmO3RleHQtYWxpZ246IHJpZ2h0O2JvcmRlci1yYWRpdXM6IDEwMHB4O2xpbmUtaGVpZ2h0OiAxO3doaXRlLXNwYWNlOiBub3dyYXA7dHJhbnNpdGlvbjogd2lkdGggLjZzIGVhc2U7fQogICAgICAgICAgICAucGwtcHJvZ3Jlc3MtaW5uZXItdGV4dCB7IGRpc3BsYXk6IGlubGluZS1ibG9jazt2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO2NvbG9yOiAjZDFkMWQxO2ZvbnQtc2l6ZTogMTJweDttYXJnaW46IDAgNXB4O2hlaWdodDogMTVweH0KICAgICAgICAgICAgLnBsLXByb2dyZXNzLXRpcHsgZmxleDoxO3RleHQtYWxpZ246cmlnaHR9CiAgICAgICAgICAgIC5wbC1wcm9ncmVzcy1ob3d7IGZsZXg6IDAgMCA5MHB4OyBiYWNrZ3JvdW5kOiAjZGRkOyBib3JkZXItcmFkaXVzOiAzcHg7IG1hcmdpbi1sZWZ0OiAxMHB4OyBjdXJzb3I6IHBvaW50ZXI7IHRleHQtYWxpZ246IGNlbnRlcjt9CiAgICAgICAgICAgIC5wbC1wcm9ncmVzcy1zdG9weyBmbGV4OiAwIDAgNTBweDsgcGFkZGluZzogMCAxMHB4OyBiYWNrZ3JvdW5kOiAjY2MzMjM1OyBjb2xvcjogI2ZmZjsgYm9yZGVyLXJhZGl1czogM3B4OyBjdXJzb3I6IHBvaW50ZXI7bWFyZ2luLWxlZnQ6MTBweDtoZWlnaHQ6MjBweH0KICAgICAgICAgICAgLnBsLXByb2dyZXNzLWlubmVyLXRleHQ6YWZ0ZXIgeyBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7Y29udGVudDogIiI7aGVpZ2h0OiAxMDAlO3ZlcnRpY2FsLWFsaWduOiBtaWRkbGU7fQogICAgICAgICAgICAucGwtYnRuLXByaW1hcnkgeyBiYWNrZ3JvdW5kOiAke2NvbG9yfTsgYm9yZGVyOiAwOyBib3JkZXItcmFkaXVzOiA0cHg7IGNvbG9yOiAjZmZmZmZmOyBjdXJzb3I6IHBvaW50ZXI7IGZvbnQtc2l6ZTogMTJweDsgb3V0bGluZTogbm9uZTsgZGlzcGxheTpmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsgbWFyZ2luOiAycHggMDsgcGFkZGluZzogNnB4IDA7dHJhbnNpdGlvbjogMC4zcyBvcGFjaXR5OyB9CiAgICAgICAgICAgIC5wbC1idG4tcHJpbWFyeTpob3ZlciB7IG9wYWNpdHk6IDAuOTt0cmFuc2l0aW9uOiAwLjNzIG9wYWNpdHk7IH0KICAgICAgICAgICAgLnBsLWJ0bi1zdWNjZXNzIHsgYmFja2dyb3VuZDogIzU1YWYyODsgYW5pbWF0aW9uOiBlYXNlT3BhY2l0eSAxLjJzIDI7IGFuaW1hdGlvbi1maWxsLW1vZGU6Zm9yd2FyZHMgfQogICAgICAgICAgICAucGwtYnRuLWluZm8geyBiYWNrZ3JvdW5kOiAjNjA2MjY2OyB9CiAgICAgICAgICAgIC5wbC1idG4td2FybmluZyB7IGJhY2tncm91bmQ6ICNkYTkzMjg7IH0KICAgICAgICAgICAgLnBsLWJ0bi13YXJuaW5nIHsgYmFja2dyb3VuZDogI2RhOTMyODsgfQogICAgICAgICAgICAucGwtYnRuLWRhbmdlciB7IGJhY2tncm91bmQ6ICNjYzMyMzU7IH0KICAgICAgICAgICAgLmFsaS1idXR0b24ge2Rpc3BsYXk6IGlubGluZS1mbGV4O2FsaWduLWl0ZW1zOiBjZW50ZXI7anVzdGlmeS1jb250ZW50OiBjZW50ZXI7Ym9yZGVyOiAwIHNvbGlkIHRyYW5zcGFyZW50O2JvcmRlci1yYWRpdXM6IDVweDtib3gtc2hhZG93OiAwIDAgMCAwIHRyYW5zcGFyZW50O3dpZHRoOiBmaXQtY29udGVudDt3aGl0ZS1zcGFjZTogbm93cmFwO2ZsZXgtc2hyaW5rOiAwO2ZvbnQtc2l6ZTogMTRweDtsaW5lLWhlaWdodDogMS41O291dGxpbmU6IDA7dG91Y2gtYWN0aW9uOiBtYW5pcHVsYXRpb247dHJhbnNpdGlvbjogYmFja2dyb3VuZCAuM3MgZWFzZSxjb2xvciAuM3MgZWFzZSxib3JkZXIgLjNzIGVhc2UsYm94LXNoYWRvdyAuM3MgZWFzZTtjb2xvcjogI2ZmZjtiYWNrZ3JvdW5kOiByZ2IoOTkgMTI1IDI1NSk7bWFyZ2luLWxlZnQ6IDIwcHg7cGFkZGluZzogMXB4IDEycHg7cG9zaXRpb246IHJlbGF0aXZlOyBjdXJzb3I6cG9pbnRlcjsgaGVpZ2h0OiAzMnB4O30KICAgICAgICAgICAgLmFsaS1idXR0b246aG92ZXIge2JhY2tncm91bmQ6IHJnYigxMjIsIDE0NCwgMjU1KX0KICAgICAgICAgICAgLnRpYW55aS1idXR0b24ge21hcmdpbi1yaWdodDogMjBweDsgcGFkZGluZzogNHB4IDEycHg7IGJvcmRlci1yYWRpdXM6IDRweDsgY29sb3I6ICNmZmY7IGZvbnQtc2l6ZTogMTJweDsgYm9yZGVyOiAxcHggc29saWQgIzAwNzNlMzsgYmFja2dyb3VuZDogIzJiODllYTsgY3Vyc29yOiBwb2ludGVyOyBwb3NpdGlvbjogcmVsYXRpdmU7fQogICAgICAgICAgICAudGlhbnlpLWJ1dHRvbjpob3ZlciB7Ym9yZGVyLWNvbG9yOiAjMTg3NGQzOyBiYWNrZ3JvdW5kOiAjMzY5OWZmO30KICAgICAgICAgICAgLnlpZG9uZy1idXR0b24ge2Zsb2F0OiBsZWZ0OyBwb3NpdGlvbjogcmVsYXRpdmU7IG1hcmdpbjogMjBweCAyNHB4IDIwcHggMDsgd2lkdGg6IDk4cHg7IGhlaWdodDogMzZweDsgYmFja2dyb3VuZDogIzMxODFmOTsgYm9yZGVyLXJhZGl1czogMnB4OyBmb250LXNpemU6IDE0cHg7IGNvbG9yOiAjZmZmOyBsaW5lLWhlaWdodDogMzlweDsgdGV4dC1hbGlnbjogY2VudGVyOyBjdXJzb3I6IHBvaW50ZXI7fQogICAgICAgICAgICAueWlkb25nLXNoYXJlLWJ1dHRvbiB7ZGlzcGxheTogaW5saW5lLWJsb2NrOyBwb3NpdGlvbjogcmVsYXRpdmU7IGZvbnQtc2l6ZTogMTRweDsgbGluZS1oZWlnaHQ6IDM2cHg7IGhlaWdodDogMzZweDsgdGV4dC1hbGlnbjogY2VudGVyOyBjb2xvcjogI2ZmZjsgYm9yZGVyOiAxcHggc29saWQgIzVhOWFmYTsgYm9yZGVyLXJhZGl1czogMnB4OyBwYWRkaW5nOiAwIDI0cHg7IG1hcmdpbi1sZWZ0OiAyNHB4OyBiYWNrZ3JvdW5kOiAjMzE4MWY5OyBjdXJzb3I6IHBvaW50ZXI7fQogICAgICAgICAgICAueWlkb25nLWJ1dHRvbjpob3ZlciB7YmFja2dyb3VuZDogIzJkNzZlNTt9CiAgICAgICAgICAgIC54dW5sZWktYnV0dG9uIHtkaXNwbGF5OiBpbmxpbmUtZmxleDthbGlnbi1pdGVtczogY2VudGVyO2p1c3RpZnktY29udGVudDogY2VudGVyO2JvcmRlcjogMCBzb2xpZCB0cmFuc3BhcmVudDtib3JkZXItcmFkaXVzOiA1cHg7Ym94LXNoYWRvdzogMCAwIDAgMCB0cmFuc3BhcmVudDt3aWR0aDogZml0LWNvbnRlbnQ7d2hpdGUtc3BhY2U6IG5vd3JhcDtmbGV4LXNocmluazogMDtmb250LXNpemU6IDE0cHg7bGluZS1oZWlnaHQ6IDEuNTtvdXRsaW5lOiAwO3RvdWNoLWFjdGlvbjogbWFuaXB1bGF0aW9uO3RyYW5zaXRpb246IGJhY2tncm91bmQgLjNzIGVhc2UsY29sb3IgLjNzIGVhc2UsYm9yZGVyIC4zcyBlYXNlLGJveC1zaGFkb3cgLjNzIGVhc2U7Y29sb3I6ICNmZmY7YmFja2dyb3VuZDogIzNmODVmZjttYXJnaW4tbGVmdDogMTJweDtwYWRkaW5nOiAwcHggMTJweDtwb3NpdGlvbjogcmVsYXRpdmU7IGN1cnNvcjpwb2ludGVyOyBoZWlnaHQ6IDM2cHg7fQogICAgICAgICAgICAueHVubGVpLWJ1dHRvbjpob3ZlciB7YmFja2dyb3VuZDogIzYxOWJmZn0KICAgICAgICAgICAgLnF1YXJrLWJ1dHRvbiB7ZGlzcGxheTogaW5saW5lLWZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGp1c3RpZnktY29udGVudDogY2VudGVyOyBib3JkZXI6IDFweCBzb2xpZCAjZGRkOyBib3JkZXItcmFkaXVzOiA4cHg7IHdoaXRlLXNwYWNlOiBub3dyYXA7IGZsZXgtc2hyaW5rOiAwOyBmb250LXNpemU6IDE0cHg7IGxpbmUtaGVpZ2h0OiAxLjU7IG91dGxpbmU6IDA7IGNvbG9yOiAjMzMzOyBiYWNrZ3JvdW5kOiAjZmZmOyBtYXJnaW4tcmlnaHQ6IDEwcHg7IHBhZGRpbmc6IDBweCAxNHB4OyBwb3NpdGlvbjogcmVsYXRpdmU7IGN1cnNvcjogcG9pbnRlcjsgaGVpZ2h0OiAzNnB4O30KICAgICAgICAgICAgLnF1YXJrLWJ1dHRvbjpob3ZlciB7IGJhY2tncm91bmQ6I2Y2ZjZmNiB9CiAgICAgICAgICAgIC5wbC1kcm9wZG93bi1tZW51IHtwb3NpdGlvbjogYWJzb2x1dGU7cmlnaHQ6IDA7dG9wOiAzMHB4O3BhZGRpbmc6IDVweCAwO2NvbG9yOiByZ2IoMzcsIDM4LCA0Myk7YmFja2dyb3VuZDogI2ZmZjt6LWluZGV4OiA5OTk7d2lkdGg6IDEwMnB4O2JvcmRlcjogMXB4IHNvbGlkICNkZGQ7Ym9yZGVyLXJhZGl1czogMTBweDsgYm94LXNoYWRvdzogMCAwIDFweCAxcHggcmdiKDI4IDI4IDMyIC8gNSUpLCAwIDhweCAyNHB4IHJnYigyOCAyOCAzMiAvIDEyJSk7fQogICAgICAgICAgICAucGwtZHJvcGRvd24tbWVudS1pdGVtIHsgaGVpZ2h0OiAzMHB4O2Rpc3BsYXk6IGZsZXg7YWxpZ24taXRlbXM6IGNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtjdXJzb3I6cG9pbnRlciB9CiAgICAgICAgICAgIC5wbC1kcm9wZG93bi1tZW51LWl0ZW06aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDEzMiwxMzMsMTQxLDAuMDgpO30KICAgICAgICAgICAgLnBsLWJ1dHRvbiAucGwtZHJvcGRvd24tbWVudSB7IGRpc3BsYXk6IG5vbmU7IH0KICAgICAgICAgICAgLnBsLWJ1dHRvbjpob3ZlciAucGwtZHJvcGRvd24tbWVudSB7IGRpc3BsYXk6IGJsb2NrIWltcG9ydGFudDsgfQogICAgICAgICAgICAucGwtYnV0dG9uLWluaXQgeyBvcGFjaXR5OiAwLjU7IGFuaW1hdGlvbjogZWFzZUluaXRPcGFjaXR5IDEuMnMgMzsgYW5pbWF0aW9uLWZpbGwtbW9kZTpmb3J3YXJkcyB9CiAgICAgICAgICAgICBAa2V5ZnJhbWVzIGVhc2VJbml0T3BhY2l0eSB7IGZyb20geyBvcGFjaXR5OiAwLjU7IH0gNTAlIHsgb3BhY2l0eTogMSB9IHRvIHsgb3BhY2l0eTogMC41OyB9IH0KICAgICAgICAgICAgIEBrZXlmcmFtZXMgZWFzZU9wYWNpdHkgeyBmcm9tIHsgb3BhY2l0eTogMTsgfSA1MCUgeyBvcGFjaXR5OiAwLjM1IH0gdG8geyBvcGFjaXR5OiAxOyB9IH0KICAgICAgICAgICAgLmVsZW1lbnQtY2xpY2tlZCB7IG9wYWNpdHk6IDAuNTsgfQogICAgICAgICAgICAucGwtZXh0cmEgeyBtYXJnaW4tdG9wOiAxMHB4O2Rpc3BsYXk6ZmxleH0KICAgICAgICAgICAgLnBsLWV4dHJhIGJ1dHRvbiB7IGZsZXg6IDF9CiAgICAgICAgICAgIC5wb2ludGVyIHsgY3Vyc29yOnBvaW50ZXIgfQogICAgICAgICAgICAucGwtc2V0dGluZy1sYWJlbCB7IGRpc3BsYXk6IGZsZXg7YWxpZ24taXRlbXM6IGNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47cGFkZGluZy10b3A6IDEwcHg7IH0KICAgICAgICAgICAgLnBsLWxhYmVsIHsgZmxleDogMCAwIDEwMHB4O3RleHQtYWxpZ246bGVmdDsgfQogICAgICAgICAgICAucGwtaW5wdXQgeyBmbGV4OiAxOyBwYWRkaW5nOiA4cHggMTBweDsgYm9yZGVyOiAxcHggc29saWQgI2MyYzJjMjsgYm9yZGVyLXJhZGl1czogNXB4OyBmb250LXNpemU6IDE0cHggfQogICAgICAgICAgICAucGwtY29sb3IgeyBmbGV4OiAxO2Rpc3BsYXk6IGZsZXg7ZmxleC13cmFwOiB3cmFwOyBtYXJnaW4tcmlnaHQ6IC0xMHB4O30KICAgICAgICAgICAgLnBsLWNvbG9yLWJveCB7IHdpZHRoOiAzNXB4O2hlaWdodDogMzVweDttYXJnaW46MTBweCAxMHB4IDAgMDs7IGJveC1zaXppbmc6IGJvcmRlci1ib3g7Ym9yZGVyOjFweCBzb2xpZCAjZmZmO2N1cnNvcjpwb2ludGVyIH0KICAgICAgICAgICAgLnBsLWNvbG9yLWJveC5jaGVja2VkIHsgYm9yZGVyOjNweCBkYXNoZWQgIzExMSFpbXBvcnRhbnQgfQogICAgICAgICAgICAucGwtY2xvc2U6Zm9jdXMgeyBvdXRsaW5lOiAwOyBib3gtc2hhZG93OiBub25lOyB9CiAgICAgICAgICAgIC50YWctZGFuZ2VyIHtjb2xvcjojY2MzMjM1O21hcmdpbjogMCA1cHg7fQogICAgICAgICAgICAucGwtdG9vbHRpcCB7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgY29sb3I6ICNmZmZmZmY7IG1heC13aWR0aDogNjAwcHg7IGZvbnQtc2l6ZTogMTJweDsgcGFkZGluZzogNXB4IDEwcHg7IGJhY2tncm91bmQ6ICMzMzM7IGJvcmRlci1yYWRpdXM6IDVweDsgei1pbmRleDogMTEwMDAwOyBsaW5lLWhlaWdodDogMS4zOyBkaXNwbGF5Om5vbmU7IHdvcmQtYnJlYWs6IGJyZWFrLWFsbDt9CiAgICAgICAgICAgICBAa2V5ZnJhbWVzIGxvYWQgeyAwJSB7IHRyYW5zZm9ybTogcm90YXRlKDBkZWcpIH0gMTAwJSB7IHRyYW5zZm9ybTogcm90YXRlKDM2MGRlZykgfSB9CiAgICAgICAgICAgIC5wbC1sb2FkaW5nLWJveCA+IGRpdiA+IGRpdiB7IHBvc2l0aW9uOiBhYnNvbHV0ZTtib3JkZXItcmFkaXVzOiA1MCU7fQogICAgICAgICAgICAucGwtbG9hZGluZy1ib3ggPiBkaXYgPiBkaXY6bnRoLWNoaWxkKDEpIHsgdG9wOiA5cHg7bGVmdDogOXB4O3dpZHRoOiA4MnB4O2hlaWdodDogODJweDtiYWNrZ3JvdW5kOiAjZmZmZmZmO30KICAgICAgICAgICAgLnBsLWxvYWRpbmctYm94ID4gZGl2ID4gZGl2Om50aC1jaGlsZCgyKSB7IHRvcDogMTRweDtsZWZ0OiAzOHB4O3dpZHRoOiAyNXB4O2hlaWdodDogMjVweDtiYWNrZ3JvdW5kOiAjNjY2NjY2O2FuaW1hdGlvbjogbG9hZCAxcyBsaW5lYXIgaW5maW5pdGU7dHJhbnNmb3JtLW9yaWdpbjogMTJweCAzNnB4O30KICAgICAgICAgICAgLnBsLWxvYWRpbmcgeyB3aWR0aDogMTZweDtoZWlnaHQ6IDE2cHg7ZGlzcGxheTogaW5saW5lLWJsb2NrO292ZXJmbG93OiBoaWRkZW47YmFja2dyb3VuZDogbm9uZTt9CiAgICAgICAgICAgIC5wbC1sb2FkaW5nLWJveCB7IHdpZHRoOiAxMDAlO2hlaWdodDogMTAwJTtwb3NpdGlvbjogcmVsYXRpdmU7dHJhbnNmb3JtOiB0cmFuc2xhdGVaKDApIHNjYWxlKDAuMTYpO2JhY2tmYWNlLXZpc2liaWxpdHk6IGhpZGRlbjt0cmFuc2Zvcm0tb3JpZ2luOiAwIDA7fQogICAgICAgICAgICAucGwtbG9hZGluZy1ib3ggZGl2IHsgYm94LXNpemluZzogY29udGVudC1ib3g7IH0KICAgICAgICAgICAgLnN3YWwyLWNvbnRhaW5lciB7IHotaW5kZXg6MTAwMDAwIWltcG9ydGFudDsgfQogICAgICAgICAgICBib2R5LnN3YWwyLWhlaWdodC1hdXRvIHsgaGVpZ2h0OiBpbmhlcml0IWltcG9ydGFudDsgfQogICAgICAgICAgICAuYnRuLW9wZXJhdGUgLmJ0bi1tYWluIHsgZGlzcGxheTpmbGV4OyBhbGlnbi1pdGVtczpjZW50ZXI7IH0KICAgICAgICAgICAgYDsKICAgICAgICAgICAgdGhpcy5hZGRTdHlsZSgncGFubGlua2VyLXN0eWxlJywgJ3N0eWxlJywgY3NzKTsKICAgICAgICB9LAoKICAgICAgICBhc3luYyBpbml0RGlhbG9nKCkgewogICAgICAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgU3dhbC5maXJlKHsKICAgICAgICAgICAgICAgIHRpdGxlOiBwYW4uaW5pdFswXSwKICAgICAgICAgICAgICAgIGh0bWw6IGA8ZGl2PjxpbWcgc3R5bGU9IndpZHRoOiAyNTBweDttYXJnaW4tYm90dG9tOiAxMHB4OyIgc3JjPSIke3Bhbi5pbWd9IiBhbHQ9IiR7cGFuLmltZ30iPjxpbnB1dCBjbGFzcz0ic3dhbDItaW5wdXQiIGlkPSJpbml0IiB0eXBlPSJ0ZXh0IiBwbGFjZWhvbGRlcj0iJHtwYW4uaW5pdFsxXX0iPjwvZGl2PmAsCiAgICAgICAgICAgICAgICBhbGxvd091dHNpZGVDbGljazogZmFsc2UsCiAgICAgICAgICAgICAgICBzaG93Q2xvc2VCdXR0b246IHRydWUsCiAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmIChyZXN1bHQuaXNEaXNtaXNzZWQgJiYgcmVzdWx0LmRpc21pc3MgPT09ICdjbG9zZScpIHJldHVybjsKICAgICAgICAgICAgaWYgKHBhbi5udW0gPT09ICQoJyNpbml0JykudmFsKCkgfHwgcGFuLmxpY2Vuc2UgPT09ICQoJyNpbml0JykudmFsKCkpIHsKICAgICAgICAgICAgICAgIGJhc2Uuc2V0VmFsdWUoJ3NldHRpbmdfaW5pdF9jb2RlJywgcGFuLm51bSk7CiAgICAgICAgICAgICAgICBiYXNlLnNldFZhbHVlKCdsaWNlbnNlJywgcGFuLmxpY2Vuc2UpOwogICAgICAgICAgICAgICAgbWVzc2FnZS5zdWNjZXNzKHBhbi5pbml0WzJdKTsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIGhpc3RvcnkuZ28oMCk7CiAgICAgICAgICAgICAgICB9LCAxNTAwKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGF3YWl0IFN3YWwuZmlyZSh7CiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHBhbi5pbml0WzNdLAogICAgICAgICAgICAgICAgICAgIHRleHQ6IHBhbi5pbml0WzRdLAogICAgICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn6YeN5paw6L6T5YWlJywKICAgICAgICAgICAgICAgICAgICBpbWFnZVVybDogcGFuLmltZywKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5pbml0RGlhbG9nKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgfTsKCiAgICBsZXQgYmFpZHUgPSB7CgogICAgICAgIF9nZXRFeHRyYSgpIHsKICAgICAgICAgICAgbGV0IHNlS2V5ID0gZGVjb2RlVVJJQ29tcG9uZW50KGJhc2UuZ2V0Q29va2llKCdCRENMTkQnKSk7CiAgICAgICAgICAgIHJldHVybiAneycgKyAnInNla2V5IjoiJyArIHNlS2V5ICsgJyInICsgIn0iOwogICAgICAgIH0sCgogICAgICAgIF9nZXRTdXJsKCkgewogICAgICAgICAgICBsZXQgcmVnID0gLyg/PD1zXC98c3VybD0pKFthLXpBLVowLTlfLV0rKS9nOwogICAgICAgICAgICBpZiAocmVnLnRlc3QobG9jYXRpb24uaHJlZikpIHsKICAgICAgICAgICAgICAgIHJldHVybiBsb2NhdGlvbi5ocmVmLm1hdGNoKHJlZylbMF07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0sCgogICAgICAgIF9nZXRGaWRMaXN0KCkgewogICAgICAgICAgICBsZXQgZmlkbGlzdCA9IFtdOwogICAgICAgICAgICBzZWxlY3RMaXN0LmZvckVhY2godiA9PiB7CiAgICAgICAgICAgICAgICBpZiAoK3YuaXNkaXIgPT09IDEpIHJldHVybjsKICAgICAgICAgICAgICAgIGZpZGxpc3QucHVzaCh2LmZzX2lkKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybiAnWycgKyBmaWRsaXN0ICsgJ10nOwogICAgICAgIH0sCgogICAgICAgIF9yZXNldERhdGEoKSB7CiAgICAgICAgICAgIHByb2dyZXNzID0ge307CiAgICAgICAgICAgICQuZWFjaChyZXF1ZXN0LCAoa2V5KSA9PiB7CiAgICAgICAgICAgICAgICAocmVxdWVzdFtrZXldKS5hYm9ydCgpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgJC5lYWNoKGlucywgKGtleSkgPT4gewogICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChpbnNba2V5XSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBpZG0gPSB7fTsKICAgICAgICAgICAgaW5zID0ge307CiAgICAgICAgICAgIHJlcXVlc3QgPSB7fTsKICAgICAgICB9LAoKICAgICAgICBzZXRCRFVTUygpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIEdNX2Nvb2tpZSAmJiBHTV9jb29raWUoJ2xpc3QnLCB7bmFtZTogJ0JEVVNTJ30sIChjb29raWVzLCBlcnJvcikgPT4gewogICAgICAgICAgICAgICAgICAgIGlmICghZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IEJEVVNTID0gY29va2llcz8uWzBdPy52YWx1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEJEVVNTKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlLnNldFN0b3JhZ2UoImJhaWR1eXVuUGx1Z2luX0JEVVNTIiwge0JEVVNTfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgZ2V0QkRVU1MoKSB7CiAgICAgICAgICAgIGxldCBiYWlkdXl1blBsdWdpbl9CRFVTUyA9IGJhc2UuZ2V0U3RvcmFnZSgnYmFpZHV5dW5QbHVnaW5fQkRVU1MnKSA/IGJhc2UuZ2V0U3RvcmFnZSgnYmFpZHV5dW5QbHVnaW5fQkRVU1MnKSA6ICd7ImJhaWR1eXVuUGx1Z2luX0JEVVNTIjoiIn0nOwogICAgICAgICAgICByZXR1cm4gYmFpZHV5dW5QbHVnaW5fQkRVU1MuQkRVU1MgfHwgJyc7CiAgICAgICAgfSwKCiAgICAgICAgY29udmVydExpbmtUb0FyaWEobGluaywgZmlsZW5hbWUsIHVhKSB7CiAgICAgICAgICAgIGxldCBCRFVTUyA9IHRoaXMuZ2V0QkRVU1MoKTsKICAgICAgICAgICAgaWYgKCEhQkRVU1MpIHsKICAgICAgICAgICAgICAgIGZpbGVuYW1lID0gYmFzZS5maXhGaWxlbmFtZShmaWxlbmFtZSk7CiAgICAgICAgICAgICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGBhcmlhMmMgIiR7bGlua30iIC0tb3V0ICIke2ZpbGVuYW1lfSIgLS1oZWFkZXIgIlVzZXItQWdlbnQ6ICR7dWF9IiAtLWhlYWRlciAiQ29va2llOiBCRFVTUz0ke0JEVVNTfSJgKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgbGluazogcGFuLmFzc2lzdGFudCwKICAgICAgICAgICAgICAgIHRleHQ6IHBhbi5pbml0WzVdCiAgICAgICAgICAgIH07CiAgICAgICAgfSwKCiAgICAgICAgY29udmVydExpbmtUb0JDKGxpbmssIGZpbGVuYW1lLCB1YSkgewogICAgICAgICAgICBsZXQgQkRVU1MgPSB0aGlzLmdldEJEVVNTKCk7CiAgICAgICAgICAgIGlmICghIUJEVVNTKSB7CiAgICAgICAgICAgICAgICBsZXQgY29va2llID0gYEJEVVNTPSR7QkRVU1N9YDsKICAgICAgICAgICAgICAgIGxldCBiYyA9IGBBQS8ke2VuY29kZVVSSUNvbXBvbmVudChmaWxlbmFtZSl9Lz91cmw9JHtlbmNvZGVVUklDb21wb25lbnQobGluayl9JmNvb2tpZT0ke2VuY29kZVVSSUNvbXBvbmVudChjb29raWUpfSZ1c2VyX2FnZW50PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHVhKX1aWmA7CiAgICAgICAgICAgICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGBiYzovL2h0dHAvJHtiYXNlLmUoYmMpfWApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBsaW5rOiBwYW4uYXNzaXN0YW50LAogICAgICAgICAgICAgICAgdGV4dDogcGFuLmluaXRbNV0KICAgICAgICAgICAgfTsKICAgICAgICB9LAoKICAgICAgICBjb252ZXJ0TGlua1RvQ3VybChsaW5rLCBmaWxlbmFtZSwgdWEpIHsKICAgICAgICAgICAgbGV0IEJEVVNTID0gdGhpcy5nZXRCRFVTUygpOwogICAgICAgICAgICBpZiAoISFCRFVTUykgewogICAgICAgICAgICAgICAgbGV0IHRlcm1pbmFsID0gYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ190ZXJtaW5hbF90eXBlJyk7CiAgICAgICAgICAgICAgICBmaWxlbmFtZSA9IGJhc2UuZml4RmlsZW5hbWUoZmlsZW5hbWUpOwogICAgICAgICAgICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChgJHt0ZXJtaW5hbCAhPT0gJ3dwJyA/ICdjdXJsJyA6ICdjdXJsLmV4ZSd9IC1MIC1DIC0gIiR7bGlua30iIC1vICIke2ZpbGVuYW1lfSIgLUEgIiR7dWF9IiAtYiAiQkRVU1M9JHtCRFVTU30iYCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIGxpbms6IHBhbi5hc3Npc3RhbnQsCiAgICAgICAgICAgICAgICB0ZXh0OiBwYW4uaW5pdFs1XQogICAgICAgICAgICB9OwogICAgICAgIH0sCgogICAgICAgIGFkZFBhZ2VMaXN0ZW5lcigpIHsKICAgICAgICAgICAgZnVuY3Rpb24gX2ZhY3RvcnkoZSkgewogICAgICAgICAgICAgICAgbGV0IHRhcmdldCA9ICQoZS50YXJnZXQpOwogICAgICAgICAgICAgICAgbGV0IGl0ZW0gPSB0YXJnZXQucGFyZW50cygnLnBsLWl0ZW0nKTsKICAgICAgICAgICAgICAgIGxldCBsaW5rID0gaXRlbS5maW5kKCcucGwtaXRlbS1saW5rJyk7CiAgICAgICAgICAgICAgICBsZXQgcHJvZ3Jlc3MgPSBpdGVtLmZpbmQoJy5wbC1pdGVtLXByb2dyZXNzJyk7CiAgICAgICAgICAgICAgICBsZXQgdGlwID0gaXRlbS5maW5kKCcucGwtaXRlbS10aXAnKTsKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgaXRlbSwgbGluaywgcHJvZ3Jlc3MsIHRpcCwgdGFyZ2V0LAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gX3Jlc2V0KGkpIHsKICAgICAgICAgICAgICAgIGluc1tpXSAmJiBjbGVhckludGVydmFsKGluc1tpXSk7CiAgICAgICAgICAgICAgICByZXF1ZXN0W2ldICYmIHJlcXVlc3RbaV0uYWJvcnQoKTsKICAgICAgICAgICAgICAgIHByb2dyZXNzW2ldID0gMDsKICAgICAgICAgICAgICAgIGlkbVtpXSA9IGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBkb2Mub24oJ21vdXNlZW50ZXIgbW91c2VsZWF2ZSBjbGljaycsICcucGwtYnV0dG9uLmctZHJvcGRvd24tYnV0dG9uJywgKGUpID0+IHsKICAgICAgICAgICAgICAgIGlmIChlLnR5cGUgPT09ICdtb3VzZWxlYXZlJykgewogICAgICAgICAgICAgICAgICAgICQoZS5jdXJyZW50VGFyZ2V0KS5yZW1vdmVDbGFzcygnYnV0dG9uLW9wZW4nKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJChlLmN1cnJlbnRUYXJnZXQpLmFkZENsYXNzKCdidXR0b24tb3BlbicpOwogICAgICAgICAgICAgICAgICAgICQoZS5jdXJyZW50VGFyZ2V0KS5maW5kKCcucGwtZHJvcGRvd24tbWVudScpLnNob3coKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignbW91c2VsZWF2ZScsICcucGwtYnV0dG9uLmctZHJvcGRvd24tYnV0dG9uIC5wbC1kcm9wZG93bi1tZW51JywgKGUpID0+IHsKICAgICAgICAgICAgICAgICQoZS5jdXJyZW50VGFyZ2V0KS5oaWRlKCk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcucGwtYnV0dG9uLW1vZGUnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgbW9kZSA9IGUudGFyZ2V0LmRhdGFzZXQubW9kZTsKICAgICAgICAgICAgICAgIFN3YWwuc2hvd0xvYWRpbmcoKTsKICAgICAgICAgICAgICAgIHRoaXMuZ2V0UENTTGluaygpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItbGluay1hcGknLCBhc3luYyAoZSkgPT4gewogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgbGV0IG8gPSBfZmFjdG9yeShlKTsKICAgICAgICAgICAgICAgIGxldCAkd2lkdGggPSBvLml0ZW0uZmluZCgnLnBsLXByb2dyZXNzLWlubmVyJyk7CiAgICAgICAgICAgICAgICBsZXQgJHRleHQgPSBvLml0ZW0uZmluZCgnLnBsLXByb2dyZXNzLWlubmVyLXRleHQnKTsKICAgICAgICAgICAgICAgIGxldCBmaWxlbmFtZSA9IG8ubGlua1swXS5kYXRhc2V0LmZpbGVuYW1lOwogICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gby5saW5rWzBdLmRhdGFzZXQuaW5kZXg7CiAgICAgICAgICAgICAgICBfcmVzZXQoaW5kZXgpOwogICAgICAgICAgICAgICAgYmFzZS5nZXQoby5saW5rWzBdLmRhdGFzZXQubGluaywgeyJVc2VyLUFnZW50IjogcGFuLnVhfSwgJ2Jsb2InLCB7ZmlsZW5hbWUsIGluZGV4fSk7CiAgICAgICAgICAgICAgICBpbnNbaW5kZXhdID0gc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIGxldCBwcm9nID0gK3Byb2dyZXNzW2luZGV4XSB8fCAwOwogICAgICAgICAgICAgICAgICAgIGxldCBpc0lETSA9IGlkbVtpbmRleF0gfHwgZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgaWYgKGlzSURNKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG8udGlwLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgby5wcm9ncmVzcy5oaWRlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIG8ubGluay50ZXh0KCflt7LmiJDlip/llKTotbdJRE3vvIzor7fmn6XnnItJRE3kuIvovb3moYbvvIEnKS5hbmltYXRlKHtvcGFjaXR5OiAnMC41J30sICJzbG93Iikuc2hvdygpOwogICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGluc1tpbmRleF0pOwogICAgICAgICAgICAgICAgICAgICAgICBpZG1baW5kZXhdID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgby5saW5rLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgby50aXAuaGlkZSgpOwogICAgICAgICAgICAgICAgICAgICAgICBvLnByb2dyZXNzLnNob3coKTsKICAgICAgICAgICAgICAgICAgICAgICAgJHdpZHRoLmNzcygnd2lkdGgnLCBwcm9nICsgJyUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgJHRleHQudGV4dChwcm9nICsgJyUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByb2cgPT09IDEwMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChpbnNbaW5kZXhdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2dyZXNzW2luZGV4XSA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLml0ZW0uZmluZCgnLnBsLXByb2dyZXNzLXN0b3AnKS5oaWRlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLml0ZW0uZmluZCgnLnBsLXByb2dyZXNzLXRpcCcpLmh0bWwoJ+S4i+i9veWujOaIkO+8jOato+WcqOW8ueWHuua1j+iniOWZqOS4i+i9veahhu+8gScpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwgNTAwKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLXJldHJ5JywgYXN5bmMgKGUpID0+IHsKICAgICAgICAgICAgICAgIGxldCBvID0gX2ZhY3RvcnkoZSk7CiAgICAgICAgICAgICAgICBvLnRpcC5oaWRlKCk7CiAgICAgICAgICAgICAgICBvLmxpbmsuc2hvdygpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItaG93JywgYXN5bmMgKGUpID0+IHsKICAgICAgICAgICAgICAgIGxldCBvID0gX2ZhY3RvcnkoZSk7CiAgICAgICAgICAgICAgICBsZXQgaW5kZXggPSBvLmxpbmtbMF0uZGF0YXNldC5pbmRleDsKICAgICAgICAgICAgICAgIGlmIChyZXF1ZXN0W2luZGV4XSkgewogICAgICAgICAgICAgICAgICAgIHJlcXVlc3RbaW5kZXhdLmFib3J0KCk7CiAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChpbnNbaW5kZXhdKTsKICAgICAgICAgICAgICAgICAgICBvLnByb2dyZXNzLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICBvLnRpcC5zaG93KCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItc3RvcCcsIGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgbyA9IF9mYWN0b3J5KGUpOwogICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gby5saW5rWzBdLmRhdGFzZXQuaW5kZXg7CiAgICAgICAgICAgICAgICBpZiAocmVxdWVzdFtpbmRleF0pIHsKICAgICAgICAgICAgICAgICAgICByZXF1ZXN0W2luZGV4XS5hYm9ydCgpOwogICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW5zW2luZGV4XSk7CiAgICAgICAgICAgICAgICAgICAgby50aXAuaGlkZSgpOwogICAgICAgICAgICAgICAgICAgIG8ucHJvZ3Jlc3MuaGlkZSgpOwogICAgICAgICAgICAgICAgICAgIG8ubGluay5zaG93KDApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItYmFjaycsIGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgbyA9IF9mYWN0b3J5KGUpOwogICAgICAgICAgICAgICAgby50aXAuaGlkZSgpOwogICAgICAgICAgICAgICAgby5saW5rLnNob3coKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLWxpbmstYXJpYSwgLmxpc3RlbmVyLWNvcHktYWxsJywgKGUpID0+IHsKICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgIGlmICghZS50YXJnZXQuZGF0YXNldC5saW5rKSB7CiAgICAgICAgICAgICAgICAgICAgJChlLnRhcmdldCkucmVtb3ZlQ2xhc3MoJ2xpc3RlbmVyLWNvcHktYWxsJykuYWRkQ2xhc3MoJ3BsLWJ0bi1kYW5nZXInKS5odG1sKGAke3Bhbi5pbml0WzVdffCfkYk8YSBocmVmPSIke3Bhbi5hc3Npc3RhbnR9IiB0YXJnZXQ9Il9ibGFuayIgY2xhc3M9InBsLWEiPueCueWHu+atpOWkhOWuieijhTwvYT7wn5GIYCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGJhc2Uuc2V0Q2xpcGJvYXJkKGRlY29kZVVSSUNvbXBvbmVudChlLnRhcmdldC5kYXRhc2V0LmxpbmspKTsKICAgICAgICAgICAgICAgICAgICAkKGUudGFyZ2V0KS50ZXh0KCflpI3liLbmiJDlip/vvIzlv6vljrvnspjotLTlkKfvvIEnKS5hbmltYXRlKHtvcGFjaXR5OiAnMC41J30sICJzbG93Iik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1saW5rLXJwYycsIGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgdGFyZ2V0ID0gJChlLmN1cnJlbnRUYXJnZXQpOwogICAgICAgICAgICAgICAgdGFyZ2V0LmZpbmQoJy5pY29uJykucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICB0YXJnZXQuZmluZCgnLnBsLWxvYWRpbmcnKS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIHRhcmdldC5wcmVwZW5kKGJhc2UuY3JlYXRlTG9hZGluZygpKTsKICAgICAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCB0aGlzLnNlbmRMaW5rVG9SUEMoZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuZmlsZW5hbWUsIGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmxpbmspOwogICAgICAgICAgICAgICAgaWYgKHJlcyA9PT0gJ3N1Y2Nlc3MnKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnLmxpc3RlbmVyLXJwYy10YXNrJykuc2hvdygpOwogICAgICAgICAgICAgICAgICAgIHRhcmdldC5yZW1vdmVDbGFzcygncGwtYnRuLWRhbmdlcicpLmh0bWwoJ+WPkemAgeaIkOWKn++8jOW/q+WOu+eci+eci+WQp++8gScpLmFuaW1hdGUoe29wYWNpdHk6ICcwLjUnfSwgInNsb3ciKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzID09PSAnYXNzaXN0YW50JykgewogICAgICAgICAgICAgICAgICAgIHRhcmdldC5hZGRDbGFzcygncGwtYnRuLWRhbmdlcicpLmh0bWwoYCR7cGFuLmluaXRbNV198J+RiTxhIGhyZWY9IiR7cGFuLmFzc2lzdGFudH0iIHRhcmdldD0iX2JsYW5rIiBjbGFzcz0icGwtYSI+54K55Ye75q2k5aSE5a6J6KOFPC9hPvCfkYhgKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmFkZENsYXNzKCdwbC1idG4tZGFuZ2VyJykudGV4dCgn5Y+R6YCB5aSx6LSl77yM6K+35qOA5p+l5oKo55qEUlBD6YWN572u5L+h5oGv77yBJykuYW5pbWF0ZSh7b3BhY2l0eTogJzAuNSd9LCAic2xvdyIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItc2VuZC1ycGMnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgJCgnLmxpc3RlbmVyLWxpbmstcnBjJykuY2xpY2soKTsKICAgICAgICAgICAgICAgICQoZS50YXJnZXQpLnRleHQoJ+WPkemAgeWujOaIkO+8jOWPkemAgee7k+aenOingeS4iuaWueaMiemSru+8gScpLmFuaW1hdGUoe29wYWNpdHk6ICcwLjUnfSwgInNsb3ciKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLW9wZW4tc2V0dGluZycsICgpID0+IHsKICAgICAgICAgICAgICAgIGJhc2Uuc2hvd1NldHRpbmcoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLXJwYy10YXNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgbGV0IHJwYyA9IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgICAgICBkb21haW46IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX2RvbWFpbicpLAogICAgICAgICAgICAgICAgICAgIHBvcnQ6IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BvcnQnKSwKICAgICAgICAgICAgICAgIH0pLCB1cmwgPSBgJHtwYW4uZH0vP3JwYz0ke2Jhc2UuZShycGMpfSMke2Jhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3Rva2VuJyl9YDsKICAgICAgICAgICAgICAgIEdNX29wZW5JblRhYih1cmwsIHthY3RpdmU6IHRydWV9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgKGUpID0+IHsKICAgICAgICAgICAgICAgIGlmIChlLnRhcmdldC5ub2RlTmFtZSA9PT0gJ0EnICYmIH5lLnRhcmdldC5jbGFzc05hbWUuaW5kZXhPZigncGwtYScpKSB7CiAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgdHJ1ZSk7CiAgICAgICAgfSwKCiAgICAgICAgYWRkQnV0dG9uKCkgewogICAgICAgICAgICBpZiAoIXB0KSByZXR1cm47CiAgICAgICAgICAgIGxldCAkdG9vbFdyYXA7CiAgICAgICAgICAgIGxldCAkYnV0dG9uID0gJChgPGRpdiBjbGFzcz0iZy1kcm9wZG93bi1idXR0b24gcG9pbnRlciBwbC1idXR0b24iPjxkaXYgc3R5bGU9ImNvbG9yOiNmZmY7YmFja2dyb3VuZDogJHtjb2xvcn07Ym9yZGVyLWNvbG9yOiR7Y29sb3J9IiBjbGFzcz0iZy1idXR0b24gZy1idXR0b24tYmx1ZSI+PHNwYW4gY2xhc3M9ImctYnV0dG9uLXJpZ2h0Ij48ZW0gY2xhc3M9Imljb24gaWNvbi1kb3dubG9hZCI+PC9lbT48c3BhbiBjbGFzcz0idGV4dCIgc3R5bGU9IndpZHRoOiA2MHB4OyI+5LiL6L295Yqp5omLPC9zcGFuPjwvc3Bhbj48L2Rpdj48ZGl2IGNsYXNzPSJtZW51IiBzdHlsZT0id2lkdGg6YXV0bzt6LWluZGV4OjQxO2JvcmRlci1jb2xvcjoke2NvbG9yfSI+PGRpdiBzdHlsZT0iY29sb3I6JHtjb2xvcn0iIGNsYXNzPSJnLWJ1dHRvbi1tZW51IHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImFwaSI+QVBJ5LiL6L29PC9kaXY+PGRpdiBzdHlsZT0iY29sb3I6JHtjb2xvcn0iIGNsYXNzPSJnLWJ1dHRvbi1tZW51IHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImFyaWEiPkFyaWHkuIvovb08L2Rpdj48ZGl2IHN0eWxlPSJjb2xvcjoke2NvbG9yfSIgY2xhc3M9ImctYnV0dG9uLW1lbnUgcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0icnBjIj5SUEPkuIvovb08L2Rpdj48ZGl2IHN0eWxlPSJjb2xvcjoke2NvbG9yfSIgY2xhc3M9ImctYnV0dG9uLW1lbnUgcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0iY3VybCI+Y1VSTOS4i+i9vTwvZGl2PjxkaXYgc3R5bGU9ImNvbG9yOiR7Y29sb3J9IiBjbGFzcz0iZy1idXR0b24tbWVudSBwbC1idXR0b24tbW9kZSIgZGF0YS1tb2RlPSJiYyI+QkPkuIvovb08L2Rpdj48bGkgY2xhc3M9ImctYnV0dG9uLW1lbnUgcGwtYnV0dG9uLW1vZGUgbGlzdGVuZXItb3Blbi1zZXR0aW5nIj7liqnmiYvorr7nva48L2xpPiR7cGFuLmNvZGUgPT0gMjAwICYmIHZlcnNpb24gPCBwYW4udmVyc2lvbiA/IHBhbi5uZXcgOiAnJ308L2Rpdj48L2Rpdj5gKTsKICAgICAgICAgICAgaWYgKHB0ID09PSAnaG9tZScpICR0b29sV3JhcCA9ICQocGFuLmJ0bi5ob21lKTsKICAgICAgICAgICAgaWYgKHB0ID09PSAnbWFpbicpIHsKICAgICAgICAgICAgICAgICR0b29sV3JhcCA9ICQocGFuLmJ0bi5tYWluKTsKICAgICAgICAgICAgICAgICRidXR0b24gPSAkKGA8ZGl2IGNsYXNzPSJwbC1idXR0b24iIHN0eWxlPSJwb3NpdGlvbjogcmVsYXRpdmU7IGRpc3BsYXk6IGlubGluZS1ibG9jazsgbWFyZ2luLXJpZ2h0OiA4cHg7Ij48YnV0dG9uIGNsYXNzPSJ1LWJ1dHRvbiB1LWJ1dHRvbi0tcHJpbWFyeSB1LWJ1dHRvbi0tc21hbGwgaXMtcm91bmQgaXMtaGFzLWljb24iIHN0eWxlPSJiYWNrZ3JvdW5kOiAke2NvbG9yfTtib3JkZXItY29sb3I6ICR7Y29sb3J9O2ZvbnQtc2l6ZTogMTRweDsgcGFkZGluZzogOHB4IDE2cHg7IGJvcmRlcjogbm9uZTsiPjxpIGNsYXNzPSJ1LWljb24gdS1pY29uLWRvd25sb2FkIj48L2k+PHNwYW4+5LiL6L295Yqp5omLPC9zcGFuPjwvYnV0dG9uPjx1bCBjbGFzcz0iZHJvcGRvd24tbGlzdCBuZC1jb21tb24tZmxvYXQtbWVudSBwbC1kcm9wZG93bi1tZW51Ij48bGkgY2xhc3M9InN1YiBjdXJzb3ItcCBwbC1idXR0b24tbW9kZSIgZGF0YS1tb2RlPSJhcGkiPkFQSeS4i+i9vTwvbGk+PGxpIGNsYXNzPSJzdWIgY3Vyc29yLXAgcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0iYXJpYSI+QXJpYeS4i+i9vTwvbGk+PGxpIGNsYXNzPSJzdWIgY3Vyc29yLXAgcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0icnBjIj5SUEPkuIvovb08L2xpPjxsaSBjbGFzcz0ic3ViIGN1cnNvci1wIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImN1cmwiPmNVUkzkuIvovb08L2xpPjxsaSBjbGFzcz0ic3ViIGN1cnNvci1wIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImJjIiA+QkPkuIvovb08L2xpPjxsaSBjbGFzcz0ic3ViIGN1cnNvci1wIHBsLWJ1dHRvbi1tb2RlIGxpc3RlbmVyLW9wZW4tc2V0dGluZyI+5Yqp5omL6K6+572uPC9saT4ke3Bhbi5jb2RlID09IDIwMCAmJiB2ZXJzaW9uIDwgcGFuLnZlcnNpb24gPyBwYW4ubmV3WCA6ICcnfTwvdWw+PC9kaXY+YCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHB0ID09PSAnc2hhcmUnKSAkdG9vbFdyYXAgPSAkKHBhbi5idG4uc2hhcmUpOwogICAgICAgICAgICAkdG9vbFdyYXAucHJlcGVuZCgkYnV0dG9uKTsKICAgICAgICAgICAgdGhpcy5zZXRCRFVTUygpOwogICAgICAgICAgICB0aGlzLmFkZFBhZ2VMaXN0ZW5lcigpOwogICAgICAgIH0sCgogICAgICAgIGFkZEluaXRCdXR0b24oKSB7CiAgICAgICAgICAgIGlmICghcHQpIHJldHVybjsKICAgICAgICAgICAgbGV0ICR0b29sV3JhcDsKICAgICAgICAgICAgbGV0ICRidXR0b24gPSAkKGA8ZGl2IGNsYXNzPSJnLWRyb3Bkb3duLWJ1dHRvbiBwb2ludGVyIHBsLWJ1dHRvbi1pbml0IiBzdHlsZT0ib3BhY2l0eTouNSI+PGRpdiBzdHlsZT0iY29sb3I6I2ZmZjtiYWNrZ3JvdW5kOiAke2NvbG9yfTtib3JkZXItY29sb3I6JHtjb2xvcn0iIGNsYXNzPSJnLWJ1dHRvbiBnLWJ1dHRvbi1ibHVlIj48c3BhbiBjbGFzcz0iZy1idXR0b24tcmlnaHQiPjxlbSBjbGFzcz0iaWNvbiBpY29uLWRvd25sb2FkIj48L2VtPjxzcGFuIGNsYXNzPSJ0ZXh0IiBzdHlsZT0id2lkdGg6IDYwcHg7Ij7kuIvovb3liqnmiYs8L3NwYW4+PC9zcGFuPjwvZGl2PjwvZGl2PmApOwogICAgICAgICAgICBpZiAocHQgPT09ICdob21lJykgJHRvb2xXcmFwID0gJChwYW4uYnRuLmhvbWUpOwogICAgICAgICAgICBpZiAocHQgPT09ICdtYWluJykgewogICAgICAgICAgICAgICAgJHRvb2xXcmFwID0gJChwYW4uYnRuLm1haW4pOwogICAgICAgICAgICAgICAgJGJ1dHRvbiA9ICQoYDxkaXYgY2xhc3M9InBsLWJ1dHRvbi1pbml0IiBzdHlsZT0ib3BhY2l0eTouNTsgZGlzcGxheTogaW5saW5lLWJsb2NrOyBtYXJnaW4tcmlnaHQ6IDhweDsiPjxidXR0b24gY2xhc3M9InUtYnV0dG9uIHUtYnV0dG9uLS1wcmltYXJ5IHUtYnV0dG9uLS1zbWFsbCBpcy1yb3VuZCBpcy1oYXMtaWNvbiIgc3R5bGU9ImJhY2tncm91bmQ6ICR7Y29sb3J9O2JvcmRlci1jb2xvcjogJHtjb2xvcn07Zm9udC1zaXplOiAxNHB4OyBwYWRkaW5nOiA4cHggMTZweDsgYm9yZGVyOiBub25lOyI+PGkgY2xhc3M9InUtaWNvbiB1LWljb24tZG93bmxvYWQiPjwvaT48c3Bhbj7kuIvovb3liqnmiYs8L3NwYW4+PC9idXR0b24+PC9kaXY+YCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHB0ID09PSAnc2hhcmUnKSAkdG9vbFdyYXAgPSAkKHBhbi5idG4uc2hhcmUpOwogICAgICAgICAgICAkdG9vbFdyYXAucHJlcGVuZCgkYnV0dG9uKTsKICAgICAgICAgICAgJGJ1dHRvbi5jbGljaygoKSA9PiBiYXNlLmluaXREaWFsb2coKSk7CiAgICAgICAgfSwKCiAgICAgICAgYXN5bmMgZ2V0VG9rZW4oKSB7CiAgICAgICAgICAgIGNvbnN0IG9wZW5UYWIgPSAoKSA9PiB7CiAgICAgICAgICAgICAgICBHTV9vcGVuSW5UYWIocGFuLnBjc1szXSwge2FjdGl2ZTogZmFsc2UsIGluc2VydDogdHJ1ZSwgc2V0UGFyZW50OiB0cnVlfSk7CiAgICAgICAgICAgICAgICBiYXNlLmRlbGV0ZVZhbHVlKCdiYWlkdV9hY2Nlc3NfdG9rZW4nKTsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGNvbnN0IHdhaXRGb3JUb2tlbiA9ICgpID0+IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgYXR0ZW1wdHMgPSAwOwogICAgICAgICAgICAgICAgY29uc3QgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9rZW4gPSBiYXNlLmdldFZhbHVlKCdiYWlkdV9hY2Nlc3NfdG9rZW4nKTsKICAgICAgICAgICAgICAgICAgICBpZiAodG9rZW4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUodG9rZW4pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBhdHRlbXB0cysrOwogICAgICAgICAgICAgICAgICAgIGlmIChhdHRlbXB0cyA+IDYwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpOwogICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCcnKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBpZiAobWFuYWdlSGFuZGxlciA9PT0gJ1RhbXBlcm1vbmtleScgJiYgYmFzZS5nZXRNYWpvclZlcnNpb24obWFuYWdlVmVyc2lvbikgPj0gNSkgewogICAgICAgICAgICAgICAgb3BlblRhYigpOwogICAgICAgICAgICAgICAgcmV0dXJuIHdhaXRGb3JUb2tlbigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCBiYXNlLmdldEZpbmFsVXJsKHBhbi5wY3NbM10pOwoKICAgICAgICAgICAgaWYgKCFyZXMuaW5jbHVkZXMoJ2F1dGhvcml6ZScpICYmICFyZXMuaW5jbHVkZXMoJ2FjY2Vzc190b2tlbj0nKSkgewogICAgICAgICAgICAgICAgb3BlblRhYigpOwogICAgICAgICAgICAgICAgcmV0dXJuIHdhaXRGb3JUb2tlbigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChyZXMuaW5jbHVkZXMoJ2F1dGhvcml6ZScpKSB7CiAgICAgICAgICAgICAgICBsZXQgaHRtbCA9IGF3YWl0IGJhc2UuZ2V0KHBhbi5wY3NbM10sIHt9LCAndGV4dCcpOwogICAgICAgICAgICAgICAgbGV0IGJkc3Rva2VuID0gaHRtbC5tYXRjaCgvbmFtZT0iYmRzdG9rZW4iXHMrdmFsdWU9IihbXiJdKykiLyk/LlsxXTsKICAgICAgICAgICAgICAgIGxldCBjbGllbnRfaWQgPSBodG1sLm1hdGNoKC9uYW1lPSJjbGllbnRfaWQiXHMrdmFsdWU9IihbXiJdKykiLyk/LlsxXTsKICAgICAgICAgICAgICAgIGxldCBkYXRhID0gewogICAgICAgICAgICAgICAgICAgIGdyYW50X3Blcm1pc3Npb25zX2FycjogJ25ldGRpc2snLAogICAgICAgICAgICAgICAgICAgIGJkc3Rva2VuOiBiZHN0b2tlbiwKICAgICAgICAgICAgICAgICAgICBjbGllbnRfaWQ6IGNsaWVudF9pZCwKICAgICAgICAgICAgICAgICAgICByZXNwb25zZV90eXBlOiAidG9rZW4iLAogICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6ICJwYWdlIiwKICAgICAgICAgICAgICAgICAgICBncmFudF9wZXJtaXNzaW9uczogImJhc2ljLG5ldGRpc2siCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgYXdhaXQgYmFzZS5wb3N0KHBhbi5wY3NbM10sIGJhc2Uuc3RyaW5naWZ5KGRhdGEpLCB7CiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBsZXQgcmVzMiA9IGF3YWl0IGJhc2UuZ2V0RmluYWxVcmwocGFuLnBjc1szXSk7CiAgICAgICAgICAgICAgICBsZXQgYWNjZXNzVG9rZW4gPSByZXMyLm1hdGNoKC9hY2Nlc3NfdG9rZW49KFteJl0rKS8pPy5bMV07CiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiAmJiBiYXNlLnNldFZhbHVlKCdiYWlkdV9hY2Nlc3NfdG9rZW4nLCBhY2Nlc3NUb2tlbik7CiAgICAgICAgICAgICAgICByZXR1cm4gYWNjZXNzVG9rZW47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IGFjY2Vzc1Rva2VuID0gcmVzLm1hdGNoKC9hY2Nlc3NfdG9rZW49KFteJl0rKS8pPy5bMV07CiAgICAgICAgICAgIGFjY2Vzc1Rva2VuICYmIGJhc2Uuc2V0VmFsdWUoJ2JhaWR1X2FjY2Vzc190b2tlbicsIGFjY2Vzc1Rva2VuKTsKICAgICAgICAgICAgcmV0dXJuIGFjY2Vzc1Rva2VuOwogICAgICAgIH0sCgogICAgICAgIGFzeW5jIGdldFBDU0xpbmsobWF4UmVxdWVzdFRpbWUgPSAxKSB7CiAgICAgICAgICAgIHNlbGVjdExpc3QgPSB0aGlzLmdldFNlbGVjdGVkTGlzdCgpOwogICAgICAgICAgICBsZXQgZmlkTGlzdCA9IHRoaXMuX2dldEZpZExpc3QoKSwgdXJsLCByZXM7CgogICAgICAgICAgICBpZiAocHQgPT09ICdob21lJyB8fCBwdCA9PT0gJ21haW4nKSB7CiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0TGlzdC5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZS5lcnJvcign5o+Q56S677ya6K+35YWI5Yu+6YCJ6KaB5LiL6L2955qE5paH5Lu277yBJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoZmlkTGlzdC5sZW5ndGggPT09IDIpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZS5lcnJvcign5o+Q56S677ya6K+35omT5byA5paH5Lu25aS55ZCO5Yu+6YCJ5paH5Lu277yBJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBmaWRMaXN0ID0gZW5jb2RlVVJJQ29tcG9uZW50KGZpZExpc3QpOwogICAgICAgICAgICAgICAgbGV0IGFjY2Vzc1Rva2VuID0gYmFzZS5nZXRWYWx1ZSgnYmFpZHVfYWNjZXNzX3Rva2VuJykgfHwgYXdhaXQgdGhpcy5nZXRUb2tlbigpOwogICAgICAgICAgICAgICAgdXJsID0gYCR7cGFuLnBjc1swXX0mZnNpZHM9JHtmaWRMaXN0fSZhY2Nlc3NfdG9rZW49JHthY2Nlc3NUb2tlbn1gOwogICAgICAgICAgICAgICAgcmVzID0gYXdhaXQgYmFzZS5nZXQodXJsLCB7IlVzZXItQWdlbnQiOiBwYW4udWF9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocHQgPT09ICdzaGFyZScpIHsKICAgICAgICAgICAgICAgIHRoaXMuZ2V0U2hhcmVEYXRhKCk7CiAgICAgICAgICAgICAgICBpZiAoIXBhcmFtcy5iZHN0b2tlbikgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlLmVycm9yKCfmj5DnpLrvvJror7flhYjnmbvlvZXnvZHnm5jvvIEnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChzZWxlY3RMaXN0Lmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlLmVycm9yKCfmj5DnpLrvvJror7flhYjli77pgInopoHkuIvovb3nmoTmlofku7bvvIEnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChmaWRMaXN0Lmxlbmd0aCA9PT0gMikgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlLmVycm9yKCfmj5DnpLrvvJror7fmiZPlvIDmlofku7blpLnlkI7li77pgInmlofku7bvvIEnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxldCBkaWFsb2cgPSBhd2FpdCBTd2FsLmZpcmUoewogICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvJywKICAgICAgICAgICAgICAgICAgICB0aXRsZTogYOaPkOekuu+8muivt+WwhuaWh+S7tjxzcGFuIGNsYXNzPSJ0YWctZGFuZ2VyIj5b5L+d5a2Y5Yiw572R55uYXTwvc3Bhbj7wn5GJ5YmN5b6APHNwYW4gY2xhc3M9InRhZy1kYW5nZXIiPlvmiJHnmoTnvZHnm5hdPC9zcGFuPuS4reS4i+i9ve+8gWAsCiAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IHRydWUsCiAgICAgICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfngrnlh7vkv53lrZgnLAogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wJywKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgaWYgKGRpYWxvZy5pc0NvbmZpcm1lZCkgewogICAgICAgICAgICAgICAgICAgICQoJy50b29scy1zaGFyZS1zYXZlLWhiJylbMF0uY2xpY2soKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocmVzLmVycm5vID09PSAwKSB7CiAgICAgICAgICAgICAgICBsZXQgaHRtbCA9IHRoaXMuZ2VuZXJhdGVEb20ocmVzLmxpc3QpOwogICAgICAgICAgICAgICAgdGhpcy5zaG93TWFpbkRpYWxvZyhwYW5bbW9kZV1bMF0sIGh0bWwsIHBhblttb2RlXVsxXSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmVycm5vID09PSAxMTIpIHsKICAgICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlLmVycm9yKCfmj5DnpLrvvJrpobXpnaLov4fmnJ/vvIzor7fliLfmlrDph43or5XvvIEnKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChyZXMuZXJybm8gPT09IDkwMTkpIHsKICAgICAgICAgICAgICAgIG1heFJlcXVlc3RUaW1lLS07CiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmdldFRva2VuKCk7CiAgICAgICAgICAgICAgICBpZiAobWF4UmVxdWVzdFRpbWUgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5nZXRQQ1NMaW5rKG1heFJlcXVlc3RUaW1lKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZS5lcnJvcign5o+Q56S677ya6I635Y+W5LiL6L296ZO+5o6l5aSx6LSl77yB6K+35Yi35paw572R6aG15ZCO6YeN6K+V77yBJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBiYXNlLmRlbGV0ZVZhbHVlKCdiYWlkdV9hY2Nlc3NfdG9rZW4nKTsKICAgICAgICAgICAgICAgIG1lc3NhZ2UuZXJyb3IoJ+aPkOekuu+8muiOt+WPluS4i+i9vemTvuaOpeWksei0pe+8geivt+WIt+aWsOe9kemhteWQjumHjeivle+8gScpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgZ2VuZXJhdGVEb20obGlzdCkgewogICAgICAgICAgICBsZXQgY29udGVudCA9ICc8ZGl2IGNsYXNzPSJwbC1tYWluIj4nOwogICAgICAgICAgICBsZXQgYWxpbmtBbGxUZXh0ID0gJyc7CiAgICAgICAgICAgIGJhc2Uuc29ydEJ5TmFtZShsaXN0KTsKICAgICAgICAgICAgbGlzdC5mb3JFYWNoKCh2LCBpKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAodi5pc2RpciA9PT0gMSkgcmV0dXJuOwogICAgICAgICAgICAgICAgbGV0IGZpbGVuYW1lID0gdi5zZXJ2ZXJfZmlsZW5hbWUgfHwgdi5maWxlbmFtZTsKICAgICAgICAgICAgICAgIGxldCBleHQgPSBiYXNlLmdldEV4dGVuc2lvbihmaWxlbmFtZSk7CiAgICAgICAgICAgICAgICBsZXQgc2l6ZSA9IGJhc2Uuc2l6ZUZvcm1hdCh2LnNpemUpOwogICAgICAgICAgICAgICAgbGV0IGRsaW5rID0gdi5kbGluayArICcmYWNjZXNzX3Rva2VuPScgKyBiYXNlLmdldFZhbHVlKCdiYWlkdV9hY2Nlc3NfdG9rZW4nKTsKICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAnYXBpJykgewogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz0icGwtaXRlbS1saW5rIHBsLWEgbGlzdGVuZXItbGluay1hcGkiIGhyZWY9IiR7ZGxpbmt9IiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2RsaW5rfSIgZGF0YS1pbmRleD0iJHtpfSI+JHtkbGlua308L2E+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS10aXAiIHN0eWxlPSJkaXNwbGF5OiBub25lIj48c3Bhbj7oi6XmsqHmnInlvLnlh7pJRE3kuIvovb3moYbvvIzmib7liLBJRE0gPGI+6YCJ6aG5PC9iPiAtPiA8Yj7mlofku7bnsbvlnos8L2I+IC0+IDxiPuesrOS4gOS4quahhjwvYj4g5Lit5re75Yqg5ZCO57yAIDxzcGFuIGNsYXNzPSJwbC1leHQiPiR7ZXh0fTwvc3Bhbj7vvIw8YSBocmVmPSIke3Bhbi5pZG19IiB0YXJnZXQ9Il9ibGFuayIgY2xhc3M9InBsLWEiPuivpuingeatpOWkhDwvYT48L3NwYW4+IDxzcGFuIGNsYXNzPSJwbC1iYWNrIGxpc3RlbmVyLWJhY2siPui/lOWbnjwvc3Bhbj48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLXByb2dyZXNzIiBzdHlsZT0iZGlzcGxheTogbm9uZSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLXByb2dyZXNzIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLXByb2dyZXNzLW91dGVyIj48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLXByb2dyZXNzLWlubmVyIiBzdHlsZT0id2lkdGg6NSUiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1wcm9ncmVzcy1pbm5lci10ZXh0Ij4wJTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0icGwtcHJvZ3Jlc3Mtc3RvcCBsaXN0ZW5lci1zdG9wIj7lj5bmtojkuIvovb08L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJwbC1wcm9ncmVzcy10aXAiPuacquWPkeeOsElETe+8jOS9v+eUqOiHquW4pua1j+iniOWZqOS4i+i9vTwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InBsLXByb2dyZXNzLWhvdyBsaXN0ZW5lci1ob3ciPuWmguS9leWUpOi1t0lETe+8nzwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj48L2Rpdj5gOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdhcmlhJykgewogICAgICAgICAgICAgICAgICAgIGxldCBhbGluayA9IHRoaXMuY29udmVydExpbmtUb0FyaWEoZGxpbmssIGZpbGVuYW1lLCBwYW4udWEpOwogICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgKGFsaW5rKSA9PT0gJ29iamVjdCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJwbC1pdGVtLWxpbmsgcGwtYSIgdGFyZ2V0PSJfYmxhbmsiIGhyZWY9IiR7YWxpbmsubGlua30iIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7YWxpbmsubGlua30iPiR7ZGVjb2RlVVJJQ29tcG9uZW50KGFsaW5rLnRleHQpfTwvYT4gPC9kaXY+YDsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBhbGlua0FsbFRleHQgKz0gYWxpbmsgKyAnXHJcbic7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz0icGwtaXRlbS1saW5rIHBsLWEgbGlzdGVuZXItbGluay1hcmlhIiBocmVmPSIke2FsaW5rfSIgdGl0bGU9IueCueWHu+WkjeWItmFyaWEyY+mTvuaOpSIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHthbGlua30iPiR7ZGVjb2RlVVJJQ29tcG9uZW50KGFsaW5rKX08L2E+IDwvZGl2PmA7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdycGMnKSB7CiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9InBsLWl0ZW0tbGluayBsaXN0ZW5lci1saW5rLXJwYyBwbC1idG4tcHJpbWFyeSBwbC1idG4taW5mbyIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHtkbGlua30iPjxlbSBjbGFzcz0iaWNvbiBpY29uLWRldmljZSI+PC9lbT48c3BhbiBzdHlsZT0ibWFyZ2luLWxlZnQ6IDVweDsiPuaOqOmAgeWIsCBSUEMg5LiL6L295ZmoPC9zcGFuPjwvYnV0dG9uPjwvZGl2PmA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2N1cmwnKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGFsaW5rID0gdGhpcy5jb252ZXJ0TGlua1RvQ3VybChkbGluaywgZmlsZW5hbWUsIHBhbi51YSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiAoYWxpbmspID09PSAnb2JqZWN0JykgewogICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9InBsLWl0ZW0tbGluayBwbC1hIiB0YXJnZXQ9Il9ibGFuayIgaHJlZj0iJHthbGluay5saW5rfSIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHthbGluay5saW5rfSI+JHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmsudGV4dCl9PC9hPiA8L2Rpdj5gOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFsaW5rQWxsVGV4dCArPSBhbGluayArICdcclxuJzsKICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJwbC1pdGVtLWxpbmsgcGwtYSBsaXN0ZW5lci1saW5rLWFyaWEiIGhyZWY9IiR7YWxpbmt9IiB0aXRsZT0i54K55Ye75aSN5Yi2Y3VybOmTvuaOpSIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHthbGlua30iPiR7ZGVjb2RlVVJJQ29tcG9uZW50KGFsaW5rKX08L2E+IDwvZGl2PmA7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdiYycpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgYWxpbmsgPSB0aGlzLmNvbnZlcnRMaW5rVG9CQyhkbGluaywgZmlsZW5hbWUsIHBhbi51YSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiAoYWxpbmspID09PSAnb2JqZWN0JykgewogICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9InBsLWl0ZW0tbGluayBwbC1hIiB0YXJnZXQ9Il9ibGFuayIgaHJlZj0iJHthbGluay5saW5rfSIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHthbGluay5saW5rfSI+JHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmsudGV4dCl9PC9hPiA8L2Rpdj5gOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz0icGwtaXRlbS1saW5rIHBsLWEiIGhyZWY9IiR7ZGVjb2RlVVJJQ29tcG9uZW50KGFsaW5rKX0iIHRpdGxlPSLngrnlh7vnlKjmr5TnibnlvZfmmJ/kuIvovb0iIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7YWxpbmt9Ij4ke2RlY29kZVVSSUNvbXBvbmVudChhbGluayl9PC9hPiA8L2Rpdj5gOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjb250ZW50ICs9ICc8L2Rpdj4nOwogICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2FyaWEnKQogICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtZXh0cmEiPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IGxpc3RlbmVyLWNvcHktYWxsIiBkYXRhLWxpbms9IiR7YWxpbmtBbGxUZXh0fSI+5aSN5Yi25YWo6YOo6ZO+5o6lPC9idXR0b24+PC9kaXY+YDsKICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdycGMnKSB7CiAgICAgICAgICAgICAgICBsZXQgcnBjID0gYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfZG9tYWluJykgKyAnOicgKyBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wb3J0JykgKyBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wYXRoJyk7CiAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1leHRyYSI+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgbGlzdGVuZXItc2VuZC1ycGMiPuWPkemAgeWFqOmDqOmTvuaOpTwvYnV0dG9uPjxidXR0b24gdGl0bGU9IiR7cnBjfSIgY2xhc3M9InBsLWJ0bi1wcmltYXJ5IHBsLWJ0bi13YXJuaW5nIGxpc3RlbmVyLW9wZW4tc2V0dGluZyIgc3R5bGU9Im1hcmdpbi1sZWZ0OiAxMHB4Ij7orr7nva4gUlBDIOWPguaVsO+8iOW9k+WJjeS4uu+8miR7cnBjfe+8iTwvYnV0dG9uPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IHBsLWJ0bi1zdWNjZXNzIGxpc3RlbmVyLXJwYy10YXNrIiBzdHlsZT0ibWFyZ2luLWxlZnQ6IDEwcHg7ZGlzcGxheTogbm9uZSI+5p+l55yL5LiL6L295Lu75YqhPC9idXR0b24+PC9kaXY+YDsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2N1cmwnKQogICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtZXh0cmEiPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IGxpc3RlbmVyLWNvcHktYWxsIiBkYXRhLWxpbms9IiR7YWxpbmtBbGxUZXh0fSI+5aSN5Yi25YWo6YOo6ZO+5o6lPC9idXR0b24+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgcGwtYnRuLXdhcm5pbmcgbGlzdGVuZXItb3Blbi1zZXR0aW5nIiBzdHlsZT0ibWFyZ2luLWxlZnQ6IDEwcHg7Ij7orr7nva7nu4jnq6/nsbvlnovvvIjlvZPliY3kuLrvvJoke3Rlcm1pbmFsVHlwZVtiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3Rlcm1pbmFsX3R5cGUnKV1977yJPC9idXR0b24+PC9kaXY+YDsKICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnQ7CiAgICAgICAgfSwKCiAgICAgICAgYXN5bmMgc2VuZExpbmtUb1JQQyhmaWxlbmFtZSwgbGluaykgewogICAgICAgICAgICBsZXQgcnBjID0gewogICAgICAgICAgICAgICAgZG9tYWluOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19kb21haW4nKSwKICAgICAgICAgICAgICAgIHBvcnQ6IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BvcnQnKSwKICAgICAgICAgICAgICAgIHBhdGg6IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BhdGgnKSwKICAgICAgICAgICAgICAgIHRva2VuOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY190b2tlbicpLAogICAgICAgICAgICAgICAgZGlyOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19kaXInKSwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgbGV0IEJEVVNTID0gdGhpcy5nZXRCRFVTUygpOwogICAgICAgICAgICBpZiAoIUJEVVNTKSByZXR1cm4gJ2Fzc2lzdGFudCc7CgogICAgICAgICAgICBsZXQgdXJsID0gYCR7cnBjLmRvbWFpbn06JHtycGMucG9ydH0ke3JwYy5wYXRofWA7CiAgICAgICAgICAgIGxldCBycGNEYXRhID0gewogICAgICAgICAgICAgICAgaWQ6IG5ldyBEYXRlKCkuZ2V0VGltZSgpLAogICAgICAgICAgICAgICAganNvbnJwYzogJzIuMCcsCiAgICAgICAgICAgICAgICBtZXRob2Q6ICdhcmlhMi5hZGRVcmknLAogICAgICAgICAgICAgICAgcGFyYW1zOiBbYHRva2VuOiR7cnBjLnRva2VufWAsIFtsaW5rXSwgewogICAgICAgICAgICAgICAgICAgIGRpcjogcnBjLmRpciwKICAgICAgICAgICAgICAgICAgICBvdXQ6IGZpbGVuYW1lLAogICAgICAgICAgICAgICAgICAgIGhlYWRlcjogW2BVc2VyLUFnZW50OiAke3Bhbi51YX1gLCBgQ29va2llOiBCRFVTUz0ke0JEVVNTfWBdCiAgICAgICAgICAgICAgICB9XQogICAgICAgICAgICB9OwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgbGV0IHJlcyA9IGF3YWl0IGJhc2UucG9zdCh1cmwsIHJwY0RhdGEsIHsiVXNlci1BZ2VudCI6IHBhbi51YX0sICcnKTsKICAgICAgICAgICAgICAgIGlmIChyZXMucmVzdWx0KSByZXR1cm4gJ3N1Y2Nlc3MnOwogICAgICAgICAgICAgICAgcmV0dXJuICdmYWlsJzsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgcmV0dXJuICdmYWlsJzsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGdldFNlbGVjdGVkTGlzdCgpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJldHVybiByZXF1aXJlKCdzeXN0ZW0tY29yZTpjb250ZXh0L2NvbnRleHQuanMnKS5pbnN0YW5jZUZvclN5c3RlbS5saXN0LmdldFNlbGVjdGVkKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud3Atcy1jb3JlLXBhbicpLl9fdnVlX18uc2VsZWN0ZWRMaXN0OwogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgZ2V0TG9naWQoKSB7CiAgICAgICAgICAgIGxldCB1dCA9IHJlcXVpcmUoInN5c3RlbS1jb3JlOmNvbnRleHQvY29udGV4dC5qcyIpLmluc3RhbmNlRm9yU3lzdGVtLnRvb2xzLmJhc2VTZXJ2aWNlOwogICAgICAgICAgICByZXR1cm4gdXQuYmFzZTY0RW5jb2RlKGJhc2UuZ2V0Q29va2llKCJCQUlEVUlEIikpOwogICAgICAgIH0sCgogICAgICAgIGdldFNoYXJlRGF0YSgpIHsKICAgICAgICAgICAgbGV0IHJlcyA9IGxvY2Fscy5kdW1wKCk7CiAgICAgICAgICAgIHBhcmFtcy5zaGFyZVR5cGUgPSAnc2VjcmV0JzsKICAgICAgICAgICAgcGFyYW1zLnNpZ24gPSAnJzsKICAgICAgICAgICAgcGFyYW1zLnRpbWVzdGFtcCA9ICcnOwogICAgICAgICAgICBwYXJhbXMuYmRzdG9rZW4gPSByZXMuYmRzdG9rZW4udmFsdWU7CiAgICAgICAgICAgIHBhcmFtcy5jaGFubmVsID0gJ2NodW5sZWknOwogICAgICAgICAgICBwYXJhbXMuY2xpZW50dHlwZSA9IDA7CiAgICAgICAgICAgIHBhcmFtcy53ZWIgPSAxOwogICAgICAgICAgICBwYXJhbXMuYXBwX2lkID0gMjUwNTI4OwogICAgICAgICAgICBwYXJhbXMuZW5jcnlwdCA9IDA7CiAgICAgICAgICAgIHBhcmFtcy5wcm9kdWN0ID0gJ3NoYXJlJzsKICAgICAgICAgICAgcGFyYW1zLmxvZ2lkID0gdGhpcy5nZXRMb2dpZCgpOwogICAgICAgICAgICBwYXJhbXMucHJpbWFyeWlkID0gcmVzLnNoYXJlaWQudmFsdWU7CiAgICAgICAgICAgIHBhcmFtcy51ayA9IHJlcy5zaGFyZV91ay52YWx1ZTsKICAgICAgICAgICAgcGFyYW1zLnNoYXJlVHlwZSA9PT0gJ3NlY3JldCcgJiYgKHBhcmFtcy5leHRyYSA9IHRoaXMuX2dldEV4dHJhKCkpOwogICAgICAgICAgICBwYXJhbXMuc3VybCA9IHRoaXMuX2dldFN1cmwoKTsKICAgICAgICB9LAoKICAgICAgICBkZXRlY3RQYWdlKCkgewogICAgICAgICAgICBsZXQgcGF0aCA9IGxvY2F0aW9uLnBhdGhuYW1lOwogICAgICAgICAgICBpZiAoL15cL2Rpc2tcL2hvbWUvLnRlc3QocGF0aCkpIHJldHVybiAnaG9tZSc7CiAgICAgICAgICAgIGlmICgvXlwvZGlza1wvbWFpbi8udGVzdChwYXRoKSkgcmV0dXJuICdtYWluJzsKICAgICAgICAgICAgaWYgKC9eXC8oc3xzaGFyZSlcLy8udGVzdChwYXRoKSkgcmV0dXJuICdzaGFyZSc7CiAgICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0sCgogICAgICAgIHNob3dNYWluRGlhbG9nKHRpdGxlLCBodG1sLCBmb290ZXIpIHsKICAgICAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgICAgICAgIHRpdGxlLAogICAgICAgICAgICAgICAgaHRtbCwKICAgICAgICAgICAgICAgIGZvb3RlciwKICAgICAgICAgICAgICAgIGFsbG93T3V0c2lkZUNsaWNrOiBmYWxzZSwKICAgICAgICAgICAgICAgIHNob3dDbG9zZUJ1dHRvbjogdHJ1ZSwKICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wJywKICAgICAgICAgICAgICAgIHdpZHRoLAogICAgICAgICAgICAgICAgcGFkZGluZzogJzE1cHggMjBweCA1cHgnLAogICAgICAgICAgICAgICAgY3VzdG9tQ2xhc3MsCiAgICAgICAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgICAgdGhpcy5fcmVzZXREYXRhKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIGFzeW5jIGluaXRQYW5MaW5rZXIoKSB7CiAgICAgICAgICAgIGJhc2UuaW5pdERlZmF1bHRDb25maWcoKTsKICAgICAgICAgICAgYmFzZS5hZGRQYW5MaW5rZXJTdHlsZSgpOwogICAgICAgICAgICBwdCA9IHRoaXMuZGV0ZWN0UGFnZSgpOwogICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgYmFzZS5wb3N0CiAgICAgICAgICAgIChgaHR0cHM6Ly9hcGkueW91eGlhb2hvdS5jb20vY29uZmlnL3YyP3Zlcj0ke3ZlcnNpb259JmE9JHthdXRob3J9YCwge30sIHt9LCAndGV4dCcpOwogICAgICAgICAgICBwYW4gPSBKU09OLnBhcnNlKGJhc2UuZChyZXMpKTsKICAgICAgICAgICAgT2JqZWN0LmZyZWV6ZSAmJiBPYmplY3QuZnJlZXplKHBhbik7CiAgICAgICAgICAgIHBhbi5udW0gPT09IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfaW5pdF9jb2RlJykgfHwKICAgICAgICAgICAgcGFuLmxpY2Vuc2UgPT09IGJhc2UuZ2V0VmFsdWUoJ2xpY2Vuc2UnKSA/IHRoaXMuYWRkQnV0dG9uKCkgOiB0aGlzLmFkZEluaXRCdXR0b24oKTsKICAgICAgICAgICAgYmFzZS5jcmVhdGVUaXAoKTsKICAgICAgICAgICAgYmFzZS5yZWdpc3Rlck1lbnVDb21tYW5kKCk7CiAgICAgICAgfSwKCiAgICAgICAgYXN5bmMgaW5pdEF1dGhvcml6ZSgpIHsKICAgICAgICAgICAgbGV0IGlucyA9IHNldEludGVydmFsKCgpID0+IHsKICAgICAgICAgICAgICAgIGlmICgvb3BlbmFwaS5iYWlkdS5jb21cL29hdXRoXC8yLjBcL2F1dGhvcml6ZS8udGVzdChsb2NhdGlvbi5ocmVmKSkgewogICAgICAgICAgICAgICAgICAgIGxldCBjb25maXJtQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2F1dGgtYWxsb3cnKTsKICAgICAgICAgICAgICAgICAgICBpZiAoY29uZmlybUJ1dHRvbikgewogICAgICAgICAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uLmNsaWNrKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoL29wZW5hcGkuYmFpZHUuY29tXC9vYXV0aFwvMi4wXC9sb2dpbl9zdWNjZXNzLy50ZXN0KGxvY2F0aW9uLmhyZWYpKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uLmhyZWYuaW5jbHVkZXMoJ2FjY2Vzc190b2tlbicpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0b2tlbiA9IGxvY2F0aW9uLmhyZWYubWF0Y2goL2FjY2Vzc190b2tlbj0oLio/KSYvKVsxXTsKICAgICAgICAgICAgICAgICAgICAgICAgYmFzZS5zZXRWYWx1ZSgnYmFpZHVfYWNjZXNzX3Rva2VuJywgdG9rZW4pOwogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY2xvc2UoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgMjAwKQogICAgICAgIH0KICAgIH07CgogICAgbGV0IGFsaSA9IHsKCiAgICAgICAgY29udmVydExpbmtUb0FyaWEobGluaywgZmlsZW5hbWUsIHVhKSB7CiAgICAgICAgICAgIGZpbGVuYW1lID0gYmFzZS5maXhGaWxlbmFtZShmaWxlbmFtZSk7CiAgICAgICAgICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoYGFyaWEyYyAiJHtsaW5rfSIgLS1vdXQgIiR7ZmlsZW5hbWV9IiAtLWhlYWRlciAiUmVmZXJlcjogaHR0cHM6Ly93d3cuYWxpeXVuZHJpdmUuY29tLyJgKTsKICAgICAgICB9LAoKICAgICAgICBjb252ZXJ0TGlua1RvQkMobGluaywgZmlsZW5hbWUsIHVhKSB7CiAgICAgICAgICAgIGxldCBiYyA9IGBBQS8ke2VuY29kZVVSSUNvbXBvbmVudChmaWxlbmFtZSl9Lz91cmw9JHtlbmNvZGVVUklDb21wb25lbnQobGluayl9JnJlZmVyPSR7ZW5jb2RlVVJJQ29tcG9uZW50KCdodHRwczovL3d3dy5hbGl5dW5kcml2ZS5jb20vJyl9WlpgOwogICAgICAgICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGBiYzovL2h0dHAvJHtiYXNlLmUoYmMpfWApOwogICAgICAgIH0sCgogICAgICAgIGNvbnZlcnRMaW5rVG9DdXJsKGxpbmssIGZpbGVuYW1lLCB1YSkgewogICAgICAgICAgICBsZXQgdGVybWluYWwgPSBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3Rlcm1pbmFsX3R5cGUnKTsKICAgICAgICAgICAgZmlsZW5hbWUgPSBiYXNlLmZpeEZpbGVuYW1lKGZpbGVuYW1lKTsKICAgICAgICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChgJHt0ZXJtaW5hbCAhPT0gJ3dwJyA/ICdjdXJsJyA6ICdjdXJsLmV4ZSd9IC1MIC1DIC0gIiR7bGlua30iIC1vICIke2ZpbGVuYW1lfSIgLWUgImh0dHBzOi8vd3d3LmFsaXl1bmRyaXZlLmNvbS8iYCk7CiAgICAgICAgfSwKCiAgICAgICAgYWRkUGFnZUxpc3RlbmVyKCkgewogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5wbC1idXR0b24tbW9kZScsIChlKSA9PiB7CiAgICAgICAgICAgICAgICBtb2RlID0gZS50YXJnZXQuZGF0YXNldC5tb2RlOwogICAgICAgICAgICAgICAgU3dhbC5zaG93TG9hZGluZygpOwogICAgICAgICAgICAgICAgdGhpcy5nZXRQQ1NMaW5rKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1saW5rLWFwaScsIGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICBsZXQgZGF0YXNldCA9IGUuY3VycmVudFRhcmdldC5kYXRhc2V0OwogICAgICAgICAgICAgICAgbGV0IGhyZWYgPSBkYXRhc2V0Lmxpbms7CiAgICAgICAgICAgICAgICAvLyBsZXQgdXJsID0gYXdhaXQgdGhpcy5nZXRSZWFsTGluayhkYXRhc2V0LmRpZCwgZGF0YXNldC5maWQpOwogICAgICAgICAgICAgICAgLy8gaWYgKHVybCkgaHJlZiA9IHVybDsKICAgICAgICAgICAgICAgICQoJyNkb3dubG9hZElmcmFtZScpLmF0dHIoJ3NyYycsIGhyZWYpOwogICAgICAgICAgICAgICAgLy8gbGV0IGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICAgICAgICAgICAgICAvLyBkLmRvd25sb2FkID0gZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuZmlsZW5hbWU7CiAgICAgICAgICAgICAgICAvLyBkLnJlbCA9ICJub29wZW5lciI7CiAgICAgICAgICAgICAgICAvLyBkLmhyZWYgPSBocmVmOwogICAgICAgICAgICAgICAgLy8gZC5kaXNwYXRjaEV2ZW50KG5ldyBNb3VzZUV2ZW50KCJjbGljayIpKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLWxpbmstYXBpLWJ0bicsIGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBiYXNlLnNldENsaXBib2FyZChlLnRhcmdldC5kYXRhc2V0LmZpbGVuYW1lKTsKICAgICAgICAgICAgICAgICQoZS50YXJnZXQpLnRleHQoJ+WkjeWItuaIkOWKnycpLmFuaW1hdGUoe29wYWNpdHk6ICcwLjUnfSwgInNsb3ciKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLWxpbmstYXJpYSwgLmxpc3RlbmVyLWNvcHktYWxsJywgKGUpID0+IHsKICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgIGJhc2Uuc2V0Q2xpcGJvYXJkKGRlY29kZVVSSUNvbXBvbmVudChlLnRhcmdldC5kYXRhc2V0LmxpbmspKTsKICAgICAgICAgICAgICAgICQoZS50YXJnZXQpLnRleHQoJ+WkjeWItuaIkOWKn++8jOW/q+WOu+eymOi0tOWQp++8gScpLmFuaW1hdGUoe29wYWNpdHk6ICcwLjUnfSwgInNsb3ciKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLWxpbmstcnBjJywgYXN5bmMgKGUpID0+IHsKICAgICAgICAgICAgICAgIGxldCB0YXJnZXQgPSAkKGUuY3VycmVudFRhcmdldCk7CiAgICAgICAgICAgICAgICB0YXJnZXQuZmluZCgnLmljb24nKS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIHRhcmdldC5maW5kKCcucGwtbG9hZGluZycpLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgdGFyZ2V0LnByZXBlbmQoYmFzZS5jcmVhdGVMb2FkaW5nKCkpOwogICAgICAgICAgICAgICAgbGV0IHJlcyA9IGF3YWl0IHRoaXMuc2VuZExpbmtUb1JQQyhlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5maWxlbmFtZSwgZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQubGluayk7CiAgICAgICAgICAgICAgICBpZiAocmVzID09PSAnc3VjY2VzcycpIHsKICAgICAgICAgICAgICAgICAgICAkKCcubGlzdGVuZXItcnBjLXRhc2snKS5zaG93KCk7CiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LnJlbW92ZUNsYXNzKCdwbC1idG4tZGFuZ2VyJykuaHRtbCgn5Y+R6YCB5oiQ5Yqf77yM5b+r5Y6755yL55yL5ZCn77yBJykuYW5pbWF0ZSh7b3BhY2l0eTogJzAuNSd9LCAic2xvdyIpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0YXJnZXQuYWRkQ2xhc3MoJ3BsLWJ0bi1kYW5nZXInKS50ZXh0KCflj5HpgIHlpLHotKXvvIzor7fmo4Dmn6XmgqjnmoRSUEPphY3nva7kv6Hmga/vvIEnKS5hbmltYXRlKHtvcGFjaXR5OiAnMC41J30sICJzbG93Iik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1zZW5kLXJwYycsIChlKSA9PiB7CiAgICAgICAgICAgICAgICAkKCcubGlzdGVuZXItbGluay1ycGMnKS5jbGljaygpOwogICAgICAgICAgICAgICAgJChlLnRhcmdldCkudGV4dCgn5Y+R6YCB5a6M5oiQ77yM5Y+R6YCB57uT5p6c6KeB5LiK5pa55oyJ6ZKu77yBJykuYW5pbWF0ZSh7b3BhY2l0eTogJzAuNSd9LCAic2xvdyIpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItb3Blbi1zZXR0aW5nJywgKCkgPT4gewogICAgICAgICAgICAgICAgYmFzZS5zaG93U2V0dGluZygpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItcnBjLXRhc2snLCAoKSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgcnBjID0gSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgICAgIGRvbWFpbjogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfZG9tYWluJyksCiAgICAgICAgICAgICAgICAgICAgcG9ydDogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfcG9ydCcpLAogICAgICAgICAgICAgICAgfSksIHVybCA9IGAke3Bhbi5kfS8/cnBjPSR7YmFzZS5lKHJwYyl9IyR7YmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfdG9rZW4nKX1gOwogICAgICAgICAgICAgICAgR01fb3BlbkluVGFiKHVybCwge2FjdGl2ZTogdHJ1ZX0pOwogICAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICBhc3luYyBnZXRSZWFsTGluayhkLCBmKSB7CiAgICAgICAgICAgIGxldCBhdXRob3JpemF0aW9uID0gYCR7YmFzZS5nZXRTdG9yYWdlKCd0b2tlbicpLnRva2VuX3R5cGV9ICR7YmFzZS5nZXRTdG9yYWdlKCd0b2tlbicpLmFjY2Vzc190b2tlbn1gOwogICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgYmFzZS5wb3N0KHBhbi5wY3NbMV0sIHsKICAgICAgICAgICAgICAgIGRyaXZlX2lkOiBkLAogICAgICAgICAgICAgICAgZmlsZV9pZDogZgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICBhdXRob3JpemF0aW9uLAogICAgICAgICAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLTgiLAogICAgICAgICAgICAgICAgInJlZmVyZXIiOiAiaHR0cHM6Ly93d3cuYWxpeXVuZHJpdmUuY29tLyIsCiAgICAgICAgICAgICAgICAieC1jYW5hcnkiOiAiY2xpZW50PXdpbmRvd3MsYXBwPWFkcml2ZSx2ZXJzaW9uPXY2LjAuMCIKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmIChyZXMuY29kZSA9PT0gJ0FjY2Vzc1Rva2VuSW52YWxpZCcpIHsKICAgICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlLmVycm9yKCfmj5DnpLrvvJpUb2tlbui/h+acn++8jOivt+WIt+aWsOe9kemhteWQjumHjeivle+8gScpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChyZXMudXJsKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnVybDsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gJyc7CiAgICAgICAgfSwKCiAgICAgICAgYWRkQnV0dG9uKCkgewogICAgICAgICAgICBpZiAoIXB0KSByZXR1cm47CiAgICAgICAgICAgIGxldCAkdG9vbFdyYXA7CiAgICAgICAgICAgIGxldCAkYnV0dG9uID0gJChgPGRpdiBjbGFzcz0iYWxpLWJ1dHRvbiBwbC1idXR0b24iPjxzdmcgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik04NTMuMzMzIDkzOC42NjdIMTcwLjY2N2E4NS4zMzMgODUuMzMzIDAgMCAxLTg1LjMzNC04NS4zMzR2LTM4NEE4NS4zMzMgODUuMzMzIDAgMCAxIDE3MC42NjcgMzg0SDI4OGEzMiAzMiAwIDAgMSAwIDY0SDE3MC42NjdhMjEuMzMzIDIxLjMzMyAwIDAgMC0yMS4zMzQgMjEuMzMzdjM4NGEyMS4zMzMgMjEuMzMzIDAgMCAwIDIxLjMzNCAyMS4zMzRoNjgyLjY2NmEyMS4zMzMgMjEuMzMzIDAgMCAwIDIxLjMzNC0yMS4zMzR2LTM4NEEyMS4zMzMgMjEuMzMzIDAgMCAwIDg1My4zMzMgNDQ4SDczNmEzMiAzMiAwIDAgMSAwLTY0aDExNy4zMzNhODUuMzMzIDg1LjMzMyAwIDAgMSA4NS4zMzQgODUuMzMzdjM4NGE4NS4zMzMgODUuMzMzIDAgMCAxLTg1LjMzNCA4NS4zMzR6IiBmaWxsPSIjZmZmIi8+PHBhdGggZD0iTTcxNS4wMyA1NDMuNTUyYTMyLjgxIDMyLjgxIDAgMCAwLTQ2LjI1MSAwTDU1NC4wMDUgNjU3LjgxM3YtNTQwLjQ4YTMyIDMyIDAgMCAwLTY0IDB2NTM5LjczNEwzNzUuODkzIDU0My40ODhhMzIuNzkgMzIuNzkgMCAwIDAtNDYuMjI5IDAgMzIuNDI3IDMyLjQyNyAwIDAgMCAwIDQ2LjAzN2wxNjkuNTU3IDE2OC44MTFhMzIuODEgMzIuODEgMCAwIDAgNDYuMjUxIDBsMTY5LjU1Ny0xNjguODFhMzIuNDcgMzIuNDcgMCAwIDAgMC00NS45NzR6IiBmaWxsPSIjRkY5QzAwIi8+PC9zdmc+PHNwYW4+5LiL6L295Yqp5omLPC9zcGFuPjx1bCBjbGFzcz0icGwtZHJvcGRvd24tbWVudSI+PGxpIGNsYXNzPSJwbC1kcm9wZG93bi1tZW51LWl0ZW0gcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0iYXBpIj5BUEnkuIvovb08L2xpPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImFyaWEiID5Bcmlh5LiL6L29PC9saT48bGkgY2xhc3M9InBsLWRyb3Bkb3duLW1lbnUtaXRlbSBwbC1idXR0b24tbW9kZSIgZGF0YS1tb2RlPSJycGMiPlJQQ+S4i+i9vTwvbGk+PGxpIGNsYXNzPSJwbC1kcm9wZG93bi1tZW51LWl0ZW0gcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0iY3VybCI+Y1VSTOS4i+i9vTwvbGk+PGxpIGNsYXNzPSJwbC1kcm9wZG93bi1tZW51LWl0ZW0gcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0iYmMiID5CQ+S4i+i9vTwvbGk+PGxpIGNsYXNzPSJwbC1kcm9wZG93bi1tZW51LWl0ZW0gcGwtYnV0dG9uLW1vZGUgbGlzdGVuZXItb3Blbi1zZXR0aW5nIj7liqnmiYvorr7nva48L2xpPiR7cGFuLmNvZGUgPT0gMjAwICYmIHZlcnNpb24gPCBwYW4udmVyc2lvbiA/IHBhbi5uZXcgOiAnJ308L3VsPjwvZGl2PmApOwogICAgICAgICAgICBpZiAocHQgPT09ICdob21lJykgewogICAgICAgICAgICAgICAgYmFzZS5saXN0ZW5FbGVtZW50KHBhbi5idG4uaG9tZSwgKCkgPT4gewogICAgICAgICAgICAgICAgICAgICR0b29sV3JhcCA9ICQocGFuLmJ0bi5ob21lKTsKICAgICAgICAgICAgICAgICAgICAkKCcucGwtYnV0dG9uJykubGVuZ3RoID09PSAwICYmICR0b29sV3JhcC5hcHBlbmQoJGJ1dHRvbik7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChwdCA9PT0gJ3NoYXJlJykgewogICAgICAgICAgICAgICAgJGJ1dHRvbi5jc3MoeydtYXJnaW4tcmlnaHQnOiAnMTBweCd9KTsKICAgICAgICAgICAgICAgIGJhc2UubGlzdGVuRWxlbWVudChwYW4uYnRuLnNoYXJlLCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgJHRvb2xXcmFwID0gJChwYW4uYnRuLnNoYXJlKTsKICAgICAgICAgICAgICAgICAgICAkKCcucGwtYnV0dG9uJykubGVuZ3RoID09PSAwICYmICR0b29sV3JhcC5wcmVwZW5kKCRidXR0b24pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgICAgICBiYXNlLmNyZWF0ZURvd25sb2FkSWZyYW1lKCk7CiAgICAgICAgICAgIHRoaXMuYWRkUGFnZUxpc3RlbmVyKCk7CiAgICAgICAgfSwKCiAgICAgICAgYWRkSW5pdEJ1dHRvbigpIHsKICAgICAgICAgICAgaWYgKCFwdCkgcmV0dXJuOwogICAgICAgICAgICBsZXQgJHRvb2xXcmFwOwogICAgICAgICAgICBsZXQgJGJ1dHRvbiA9ICQoYDxkaXYgY2xhc3M9ImFsaS1idXR0b24gcGwtYnV0dG9uLWluaXQiPjxzdmcgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik04NTMuMzMzIDkzOC42NjdIMTcwLjY2N2E4NS4zMzMgODUuMzMzIDAgMCAxLTg1LjMzNC04NS4zMzR2LTM4NEE4NS4zMzMgODUuMzMzIDAgMCAxIDE3MC42NjcgMzg0SDI4OGEzMiAzMiAwIDAgMSAwIDY0SDE3MC42NjdhMjEuMzMzIDIxLjMzMyAwIDAgMC0yMS4zMzQgMjEuMzMzdjM4NGEyMS4zMzMgMjEuMzMzIDAgMCAwIDIxLjMzNCAyMS4zMzRoNjgyLjY2NmEyMS4zMzMgMjEuMzMzIDAgMCAwIDIxLjMzNC0yMS4zMzR2LTM4NEEyMS4zMzMgMjEuMzMzIDAgMCAwIDg1My4zMzMgNDQ4SDczNmEzMiAzMiAwIDAgMSAwLTY0aDExNy4zMzNhODUuMzMzIDg1LjMzMyAwIDAgMSA4NS4zMzQgODUuMzMzdjM4NGE4NS4zMzMgODUuMzMzIDAgMCAxLTg1LjMzNCA4NS4zMzR6IiBmaWxsPSIjZmZmIi8+PHBhdGggZD0iTTcxNS4wMyA1NDMuNTUyYTMyLjgxIDMyLjgxIDAgMCAwLTQ2LjI1MSAwTDU1NC4wMDUgNjU3LjgxM3YtNTQwLjQ4YTMyIDMyIDAgMCAwLTY0IDB2NTM5LjczNEwzNzUuODkzIDU0My40ODhhMzIuNzkgMzIuNzkgMCAwIDAtNDYuMjI5IDAgMzIuNDI3IDMyLjQyNyAwIDAgMCAwIDQ2LjAzN2wxNjkuNTU3IDE2OC44MTFhMzIuODEgMzIuODEgMCAwIDAgNDYuMjUxIDBsMTY5LjU1Ny0xNjguODFhMzIuNDcgMzIuNDcgMCAwIDAgMC00NS45NzR6IiBmaWxsPSIjRkY5QzAwIi8+PC9zdmc+PHNwYW4+5LiL6L295Yqp5omLPC9zcGFuPjwvZGl2PmApOwogICAgICAgICAgICBpZiAocHQgPT09ICdob21lJykgewogICAgICAgICAgICAgICAgYmFzZS5saXN0ZW5FbGVtZW50KHBhbi5idG4uaG9tZSwgKCkgPT4gewogICAgICAgICAgICAgICAgICAgICR0b29sV3JhcCA9ICQocGFuLmJ0bi5ob21lKTsKICAgICAgICAgICAgICAgICAgICAkKCcucGwtYnV0dG9uLWluaXQnKS5sZW5ndGggPT09IDAgJiYgJHRvb2xXcmFwLmFwcGVuZCgkYnV0dG9uKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHB0ID09PSAnc2hhcmUnKSB7CiAgICAgICAgICAgICAgICAkYnV0dG9uLmNzcyh7J21hcmdpbi1yaWdodCc6ICcxMHB4J30pOwogICAgICAgICAgICAgICAgYmFzZS5saXN0ZW5FbGVtZW50KHBhbi5idG4uc2hhcmUsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAkdG9vbFdyYXAgPSAkKHBhbi5idG4uc2hhcmUpOwogICAgICAgICAgICAgICAgICAgICQoJy5wbC1idXR0by1pbml0JykubGVuZ3RoID09PSAwICYmICR0b29sV3JhcC5wcmVwZW5kKCRidXR0b24pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgICAgICAkYnV0dG9uLmNsaWNrKCgpID0+IGJhc2UuaW5pdERpYWxvZygpKTsKICAgICAgICB9LAoKICAgICAgICBhc3luYyBnZXRQQ1NMaW5rKCkgewogICAgICAgICAgICBsZXQgcmVhY3REb21HcmlkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihwYW4uZG9tLmdyaWQpOwogICAgICAgICAgICBpZiAocmVhY3REb21HcmlkKSB7CiAgICAgICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgU3dhbC5maXJlKHsKICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ+aPkOekuicsCiAgICAgICAgICAgICAgICAgICAgaHRtbDogJzxkaXYgc3R5bGU9ImRpc3BsYXk6IGZsZXg7YWxpZ24taXRlbXM6IGNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsiPuivt+WFiOWIh+aNouWIsCA8Yj7liJfooajop4blm748L2I+77yIPHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0xMzIgOTI4Yy0zMi44IDAtNTkuMi0yNi40LTU5LjItNTkuMnMyNi40LTU5LjIgNTkuMi01OS4yaDc2MGMzMi44IDAgNTkuMiAyNi40IDU5LjIgNTkuMlM5MjQuOCA5MjggODkyIDkyOEgxMzJ6bTAtMzU2LjhjLTMyLjggMC01OS4yLTI2LjQtNTkuMi01OS4yczI2LjQtNTkuMiA1OS4yLTU5LjJoNzYwYzMyLjggMCA1OS4yIDI2LjQgNTkuMiA1OS4ycy0yNi40IDU5LjItNTkuMiA1OS4ySDEzMnptMC0zNTZjLTMyLjggMC01OS4yLTI2LjQtNTkuMi01OS4yUzk5LjIgOTYuOCAxMzIgOTYuOGg3NjBjMzIuOCAwIDU5LjIgMjYuNCA1OS4yIDU5LjJzLTI2LjQgNTkuMi01OS4yIDU5LjJIMTMyeiIvPjwvc3ZnPu+8ieWQjuiOt+WPlu+8gTwvZGl2PicsCiAgICAgICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfngrnlh7vliIfmjaInCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGlmIChyZXMpIHsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBhbi5kb20uc3dpdGNoKS5jbGljaygpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlLnN1Y2Nlc3MoJ+WIh+aNouaIkOWKn++8jOivt+mHjeaWsOiOt+WPluS4i+i9vemTvuaOpe+8gScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNlbGVjdExpc3QgPSB0aGlzLmdldFNlbGVjdGVkTGlzdCgpOwogICAgICAgICAgICBpZiAoc2VsZWN0TGlzdC5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlLmVycm9yKCfmj5DnpLrvvJror7flhYjli77pgInopoHkuIvovb3nmoTmlofku7bvvIEnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAodGhpcy5pc09ubHlGb2xkZXIoKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UuZXJyb3IoJ+aPkOekuu+8muivt+aJk+W8gOaWh+S7tuWkueWQjuWLvumAieaWh+S7tu+8gScpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChwdCA9PT0gJ3NoYXJlJykgewogICAgICAgICAgICAgICAgaWYgKHNlbGVjdExpc3QubGVuZ3RoID4gMjApIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZS5lcnJvcign5o+Q56S677ya5Y2V5qyh5pyA5aSa5Y+v5Yu+6YCJIDIwIOS4quaWh+S7tu+8gScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBsZXQgYXV0aG9yaXphdGlvbiA9IGAke2Jhc2UuZ2V0U3RvcmFnZSgndG9rZW4nKS50b2tlbl90eXBlfSAke2Jhc2UuZ2V0U3RvcmFnZSgndG9rZW4nKS5hY2Nlc3NfdG9rZW59YDsKICAgICAgICAgICAgICAgICAgICBsZXQgeFNoYXJlVG9rZW4gPSBiYXNlLmdldFN0b3JhZ2UoJ3NoYXJlVG9rZW4nKS5zaGFyZV90b2tlbjsKCiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3RMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCBiYXNlLnBvc3QocGFuLnBjc1swXSwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwaXJlX3NlYzogNjAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZV9pZDogc2VsZWN0TGlzdFtpXS5maWxlSWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZV9pZDogc2VsZWN0TGlzdFtpXS5zaGFyZUlkCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcml6YXRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtOCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAieC1zaGFyZS10b2tlbiI6IHhTaGFyZVRva2VuCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRvd25sb2FkX3VybCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TGlzdFtpXS5kb3dubG9hZFVybCA9IHJlcy5kb3dubG9hZF91cmw7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UuZXJyb3IoJ+aPkOekuu+8muivt+WFiOeZu+W9lee9keebmO+8gScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaWYgKHNlbGVjdExpc3QubGVuZ3RoID4gMjApIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZS5lcnJvcign5o+Q56S677ya5Y2V5qyh5pyA5aSa5Y+v5Yu+6YCJIDIwIOS4quaWh+S7tu+8gScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGV0IG5vVXJsU2VsZWN0TGlzdCA9IHNlbGVjdExpc3QuZmlsdGVyKHYgPT4gIUJvb2xlYW4odi51cmwpKQogICAgICAgICAgICAgICAgbGV0IHF1ZXVlID0gW107CiAgICAgICAgICAgICAgICBub1VybFNlbGVjdExpc3QuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHsKICAgICAgICAgICAgICAgICAgICBxdWV1ZS5wdXNoKHRoaXMuZ2V0UmVhbExpbmsoaXRlbS5kcml2ZUlkLCBpdGVtLmZpbGVJZCkpOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgUHJvbWlzZS5hbGwocXVldWUpOwogICAgICAgICAgICAgICAgcmVzLmZvckVhY2goKHZhbCwgaW5kZXgpID0+IHsKICAgICAgICAgICAgICAgICAgICBub1VybFNlbGVjdExpc3RbaW5kZXhdLnVybCA9IHZhbDsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgfQogICAgICAgICAgICBsZXQgaHRtbCA9IHRoaXMuZ2VuZXJhdGVEb20oc2VsZWN0TGlzdCk7CiAgICAgICAgICAgIHRoaXMuc2hvd01haW5EaWFsb2cocGFuW21vZGVdWzBdLCBodG1sLCBwYW5bbW9kZV1bMV0pOwogICAgICAgIH0sCgogICAgICAgIGdlbmVyYXRlRG9tKGxpc3QpIHsKICAgICAgICAgICAgbGV0IGNvbnRlbnQgPSAnPGRpdiBjbGFzcz0icGwtbWFpbiI+JzsKICAgICAgICAgICAgbGV0IGFsaW5rQWxsVGV4dCA9ICcnOwogICAgICAgICAgICBsaXN0LmZvckVhY2goKHYsIGkpID0+IHsKICAgICAgICAgICAgICAgIGlmICh2LnR5cGUgPT09ICdmb2xkZXInKSByZXR1cm47CiAgICAgICAgICAgICAgICBsZXQgZmlsZW5hbWUgPSB2Lm5hbWU7CiAgICAgICAgICAgICAgICBsZXQgZmlkID0gdi5maWxlSWQ7CiAgICAgICAgICAgICAgICBsZXQgZGlkID0gdi5kcml2ZUlkOwogICAgICAgICAgICAgICAgbGV0IHNpemUgPSBiYXNlLnNpemVGb3JtYXQodi5zaXplKTsKICAgICAgICAgICAgICAgIGxldCBkbGluayA9IHYuZG93bmxvYWRVcmwgfHwgdi51cmw7CiAgICAgICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2FwaScpIHsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9InBsLWl0ZW0tbGluayBsaXN0ZW5lci1saW5rLWFwaSIgZGF0YS1kaWQ9IiR7ZGlkfSIgZGF0YS1maWQ9IiR7ZmlkfSIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHtkbGlua30iIGRhdGEtaW5kZXg9IiR7aX0iPiR7ZGxpbmt9PC9hPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tYnRuIGxpc3RlbmVyLWxpbmstYXBpLWJ0biIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iPuWkjeWItuaWh+S7tuWQjTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PmA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2FyaWEnKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGFsaW5rID0gdGhpcy5jb252ZXJ0TGlua1RvQXJpYShkbGluaywgZmlsZW5hbWUsIG5hdmlnYXRvci51c2VyQWdlbnQpOwogICAgICAgICAgICAgICAgICAgIGFsaW5rQWxsVGV4dCArPSBhbGluayArICdcclxuJzsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9InBsLWl0ZW0tbGluayBsaXN0ZW5lci1saW5rLWFyaWEiIGhyZWY9IiR7YWxpbmt9IiB0aXRsZT0i54K55Ye75aSN5Yi2YXJpYTJj6ZO+5o6lIiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2FsaW5rfSI+JHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmspfTwvYT4gPC9kaXY+YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAncnBjJykgewogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJwbC1pdGVtLWxpbmsgbGlzdGVuZXItbGluay1ycGMgcGwtYnRuLXByaW1hcnkgcGwtYnRuLWluZm8iIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7ZGxpbmt9Ij48ZW0gY2xhc3M9Imljb24gaWNvbi1kZXZpY2UiPjwvZW0+PHNwYW4gc3R5bGU9Im1hcmdpbi1sZWZ0OiA1cHg7Ij7mjqjpgIHliLAgUlBDIOS4i+i9veWZqDwvc3Bhbj48L2J1dHRvbj48L2Rpdj5gOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdjdXJsJykgewogICAgICAgICAgICAgICAgICAgIGxldCBhbGluayA9IHRoaXMuY29udmVydExpbmtUb0N1cmwoZGxpbmssIGZpbGVuYW1lLCBuYXZpZ2F0b3IudXNlckFnZW50KTsKICAgICAgICAgICAgICAgICAgICBhbGlua0FsbFRleHQgKz0gYWxpbmsgKyAnXHJcbic7CiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJwbC1pdGVtLWxpbmsgbGlzdGVuZXItbGluay1hcmlhIiBocmVmPSIke2FsaW5rfSIgdGl0bGU9IueCueWHu+WkjeWItmN1cmzpk77mjqUiIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7YWxpbmt9Ij4ke2RlY29kZVVSSUNvbXBvbmVudChhbGluayl9PC9hPiA8L2Rpdj5gOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdiYycpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgYWxpbmsgPSB0aGlzLmNvbnZlcnRMaW5rVG9CQyhkbGluaywgZmlsZW5hbWUsIG5hdmlnYXRvci51c2VyQWdlbnQpOwogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz0icGwtaXRlbS1saW5rIiBocmVmPSIke2RlY29kZVVSSUNvbXBvbmVudChhbGluayl9IiB0aXRsZT0i54K55Ye755So5q+U54m55b2X5pif5LiL6L29IiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2FsaW5rfSI+JHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmspfTwvYT4gPC9kaXY+YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNvbnRlbnQgKz0gJzwvZGl2Pic7CiAgICAgICAgICAgIGlmIChtb2RlID09PSAnYXJpYScpCiAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1leHRyYSI+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgbGlzdGVuZXItY29weS1hbGwiIGRhdGEtbGluaz0iJHthbGlua0FsbFRleHR9Ij7lpI3liLblhajpg6jpk77mjqU8L2J1dHRvbj48L2Rpdj5gOwogICAgICAgICAgICBpZiAobW9kZSA9PT0gJ3JwYycpIHsKICAgICAgICAgICAgICAgIGxldCBycGMgPSBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19kb21haW4nKSArICc6JyArIGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BvcnQnKSArIGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BhdGgnKTsKICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWV4dHJhIj48YnV0dG9uIGNsYXNzPSJwbC1idG4tcHJpbWFyeSBsaXN0ZW5lci1zZW5kLXJwYyI+5Y+R6YCB5YWo6YOo6ZO+5o6lPC9idXR0b24+PGJ1dHRvbiB0aXRsZT0iJHtycGN9IiBjbGFzcz0icGwtYnRuLXByaW1hcnkgcGwtYnRuLXdhcm5pbmcgbGlzdGVuZXItb3Blbi1zZXR0aW5nIiBzdHlsZT0ibWFyZ2luLWxlZnQ6IDEwcHgiPuiuvue9riBSUEMg5Y+C5pWw77yI5b2T5YmN5Li677yaJHtycGN977yJPC9idXR0b24+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgcGwtYnRuLXN1Y2Nlc3MgbGlzdGVuZXItcnBjLXRhc2siIHN0eWxlPSJtYXJnaW4tbGVmdDogMTBweDtkaXNwbGF5OiBub25lIj7mn6XnnIvkuIvovb3ku7vliqE8L2J1dHRvbj48L2Rpdj5gOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChtb2RlID09PSAnY3VybCcpCiAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1leHRyYSI+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgbGlzdGVuZXItY29weS1hbGwiIGRhdGEtbGluaz0iJHthbGlua0FsbFRleHR9Ij7lpI3liLblhajpg6jpk77mjqU8L2J1dHRvbj48YnV0dG9uIGNsYXNzPSJwbC1idG4tcHJpbWFyeSBwbC1idG4td2FybmluZyBsaXN0ZW5lci1vcGVuLXNldHRpbmciIHN0eWxlPSJtYXJnaW4tbGVmdDogMTBweDsiPuiuvue9rue7iOerr+exu+Wei++8iOW9k+WJjeS4uu+8miR7dGVybWluYWxUeXBlW2Jhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfdGVybWluYWxfdHlwZScpXX3vvIk8L2J1dHRvbj48L2Rpdj5gOwogICAgICAgICAgICByZXR1cm4gY29udGVudDsKICAgICAgICB9LAoKICAgICAgICBhc3luYyBzZW5kTGlua1RvUlBDKGZpbGVuYW1lLCBsaW5rKSB7CiAgICAgICAgICAgIGxldCBycGMgPSB7CiAgICAgICAgICAgICAgICBkb21haW46IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX2RvbWFpbicpLAogICAgICAgICAgICAgICAgcG9ydDogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfcG9ydCcpLAogICAgICAgICAgICAgICAgcGF0aDogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfcGF0aCcpLAogICAgICAgICAgICAgICAgdG9rZW46IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3Rva2VuJyksCiAgICAgICAgICAgICAgICBkaXI6IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX2RpcicpLAogICAgICAgICAgICB9OwoKICAgICAgICAgICAgbGV0IHVybCA9IGAke3JwYy5kb21haW59OiR7cnBjLnBvcnR9JHtycGMucGF0aH1gOwogICAgICAgICAgICBsZXQgcnBjRGF0YSA9IHsKICAgICAgICAgICAgICAgIGlkOiBuZXcgRGF0ZSgpLmdldFRpbWUoKSwKICAgICAgICAgICAgICAgIGpzb25ycGM6ICcyLjAnLAogICAgICAgICAgICAgICAgbWV0aG9kOiAnYXJpYTIuYWRkVXJpJywKICAgICAgICAgICAgICAgIHBhcmFtczogW2B0b2tlbjoke3JwYy50b2tlbn1gLCBbbGlua10sIHsKICAgICAgICAgICAgICAgICAgICBkaXI6IHJwYy5kaXIsCiAgICAgICAgICAgICAgICAgICAgb3V0OiBmaWxlbmFtZSwKICAgICAgICAgICAgICAgICAgICBoZWFkZXI6IFtgUmVmZXJlcjogaHR0cHM6Ly93d3cuYWxpeXVuZHJpdmUuY29tL2BdCiAgICAgICAgICAgICAgICB9XQogICAgICAgICAgICB9OwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgbGV0IHJlcyA9IGF3YWl0IGJhc2UucG9zdCh1cmwsIHJwY0RhdGEsIHsiUmVmZXJlciI6ICJodHRwczovL3d3dy5hbGl5dW5kcml2ZS5jb20vIn0sICcnKTsKICAgICAgICAgICAgICAgIGlmIChyZXMucmVzdWx0KSByZXR1cm4gJ3N1Y2Nlc3MnOwogICAgICAgICAgICAgICAgcmV0dXJuICdmYWlsJzsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgcmV0dXJuICdmYWlsJzsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGdldFNlbGVjdGVkTGlzdCgpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGxldCBzZWxlY3RlZExpc3QgPSBbXTsKICAgICAgICAgICAgICAgIGxldCByZWFjdERvbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocGFuLmRvbS5saXN0KTsKICAgICAgICAgICAgICAgIGxldCByZWFjdE9iaiA9IGJhc2UuZmluZFJlYWN0KHJlYWN0RG9tLCAxKTsKICAgICAgICAgICAgICAgIGxldCBwcm9wcyA9IHJlYWN0T2JqLnBlbmRpbmdQcm9wczsKICAgICAgICAgICAgICAgIGlmIChwcm9wcykgewogICAgICAgICAgICAgICAgICAgIGxldCBmaWxlTGlzdCA9IHByb3BzLmRhdGFTb3VyY2UgfHwgW107CiAgICAgICAgICAgICAgICAgICAgbGV0IHNlbGVjdGVkS2V5cyA9IHByb3BzLnNlbGVjdGVkS2V5cy5zcGxpdCgnLCcpOwogICAgICAgICAgICAgICAgICAgIGZpbGVMaXN0LmZvckVhY2goKHZhbCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRLZXlzLmluY2x1ZGVzKHZhbC5maWxlSWQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZExpc3QucHVzaCh2YWwpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWRMaXN0OwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gW107CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBkZXRlY3RQYWdlKCkgewogICAgICAgICAgICBsZXQgcGF0aCA9IGxvY2F0aW9uLnBhdGhuYW1lOwogICAgICAgICAgICBpZiAoL15cLyhkcml2ZSkvLnRlc3QocGF0aCkpIHJldHVybiAnaG9tZSc7CiAgICAgICAgICAgIGlmICgvXlwvKHN8c2hhcmUpXC8vLnRlc3QocGF0aCkpIHJldHVybiAnc2hhcmUnOwogICAgICAgICAgICByZXR1cm4gJyc7CiAgICAgICAgfSwKCiAgICAgICAgaXNPbmx5Rm9sZGVyKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlbGVjdExpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGlmIChzZWxlY3RMaXN0W2ldLnR5cGUgPT09ICdmaWxlJykgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0sCgogICAgICAgIHNob3dNYWluRGlhbG9nKHRpdGxlLCBodG1sLCBmb290ZXIpIHsKICAgICAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgICAgICAgIHRpdGxlLAogICAgICAgICAgICAgICAgaHRtbCwKICAgICAgICAgICAgICAgIGZvb3RlciwKICAgICAgICAgICAgICAgIGFsbG93T3V0c2lkZUNsaWNrOiBmYWxzZSwKICAgICAgICAgICAgICAgIHNob3dDbG9zZUJ1dHRvbjogdHJ1ZSwKICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wJywKICAgICAgICAgICAgICAgIHdpZHRoLAogICAgICAgICAgICAgICAgcGFkZGluZzogJzE1cHggMjBweCA1cHgnLAogICAgICAgICAgICAgICAgY3VzdG9tQ2xhc3MsCiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIGFzeW5jIGluaXRQYW5MaW5rZXIoKSB7CiAgICAgICAgICAgIGJhc2UuaW5pdERlZmF1bHRDb25maWcoKTsKICAgICAgICAgICAgYmFzZS5hZGRQYW5MaW5rZXJTdHlsZSgpOwogICAgICAgICAgICBwdCA9IHRoaXMuZGV0ZWN0UGFnZSgpOwogICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgYmFzZS5wb3N0CiAgICAgICAgICAgIChgaHR0cHM6Ly9hcGkueW91eGlhb2hvdS5jb20vY29uZmlnL3YyL2FsaT92ZXI9JHt2ZXJzaW9ufSZhPSR7YXV0aG9yfWAsIHt9LCB7fSwgJ3RleHQnKTsKICAgICAgICAgICAgcGFuID0gSlNPTi5wYXJzZShiYXNlLmQocmVzKSk7CiAgICAgICAgICAgIE9iamVjdC5mcmVlemUgJiYgT2JqZWN0LmZyZWV6ZShwYW4pOwogICAgICAgICAgICBwYW4ubnVtID09PSBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX2luaXRfY29kZScpIHx8CiAgICAgICAgICAgIHBhbi5saWNlbnNlID09PSBiYXNlLmdldFZhbHVlKCdsaWNlbnNlJykgPyB0aGlzLmFkZEJ1dHRvbigpIDogdGhpcy5hZGRJbml0QnV0dG9uKCk7CiAgICAgICAgICAgIGJhc2UuY3JlYXRlVGlwKCk7CiAgICAgICAgICAgIGJhc2UucmVnaXN0ZXJNZW51Q29tbWFuZCgpOwogICAgICAgIH0KICAgIH07CgogICAgbGV0IHRpYW55aSA9IHsKCiAgICAgICAgY29udmVydExpbmtUb0FyaWEobGluaywgZmlsZW5hbWUsIHVhKSB7CiAgICAgICAgICAgIGZpbGVuYW1lID0gYmFzZS5maXhGaWxlbmFtZShmaWxlbmFtZSk7CiAgICAgICAgICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoYGFyaWEyYyAiJHtsaW5rfSIgLS1vdXQgIiR7ZmlsZW5hbWV9ImApOwogICAgICAgIH0sCgogICAgICAgIGNvbnZlcnRMaW5rVG9CQyhsaW5rLCBmaWxlbmFtZSwgdWEpIHsKICAgICAgICAgICAgbGV0IGJjID0gYEFBLyR7ZW5jb2RlVVJJQ29tcG9uZW50KGZpbGVuYW1lKX0vP3VybD0ke2VuY29kZVVSSUNvbXBvbmVudChsaW5rKX1aWmA7CiAgICAgICAgICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoYGJjOi8vaHR0cC8ke2Jhc2UuZShiYyl9YCk7CiAgICAgICAgfSwKCiAgICAgICAgY29udmVydExpbmtUb0N1cmwobGluaywgZmlsZW5hbWUsIHVhKSB7CiAgICAgICAgICAgIGxldCB0ZXJtaW5hbCA9IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfdGVybWluYWxfdHlwZScpOwogICAgICAgICAgICBmaWxlbmFtZSA9IGJhc2UuZml4RmlsZW5hbWUoZmlsZW5hbWUpOwogICAgICAgICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGAke3Rlcm1pbmFsICE9PSAnd3AnID8gJ2N1cmwnIDogJ2N1cmwuZXhlJ30gLUwgLUMgLSAiJHtsaW5rfSIgLW8gIiR7ZmlsZW5hbWV9ImApOwogICAgICAgIH0sCgogICAgICAgIGFkZFBhZ2VMaXN0ZW5lcigpIHsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcucGwtYnV0dG9uLW1vZGUnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgbW9kZSA9IGUudGFyZ2V0LmRhdGFzZXQubW9kZTsKICAgICAgICAgICAgICAgIFN3YWwuc2hvd0xvYWRpbmcoKTsKICAgICAgICAgICAgICAgIHRoaXMuZ2V0UENTTGluaygpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItbGluay1hcGknLCBhc3luYyAoZSkgPT4gewogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgJCgnI2Rvd25sb2FkSWZyYW1lJykuYXR0cignc3JjJywgZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQubGluayk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1saW5rLWFyaWEsIC5saXN0ZW5lci1jb3B5LWFsbCcsIChlKSA9PiB7CiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICBiYXNlLnNldENsaXBib2FyZChkZWNvZGVVUklDb21wb25lbnQoZS50YXJnZXQuZGF0YXNldC5saW5rKSk7CiAgICAgICAgICAgICAgICAkKGUudGFyZ2V0KS50ZXh0KCflpI3liLbmiJDlip/vvIzlv6vljrvnspjotLTlkKfvvIEnKS5hbmltYXRlKHtvcGFjaXR5OiAnMC41J30sICJzbG93Iik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1saW5rLXJwYycsIGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgdGFyZ2V0ID0gJChlLmN1cnJlbnRUYXJnZXQpOwogICAgICAgICAgICAgICAgdGFyZ2V0LmZpbmQoJy5pY29uJykucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICB0YXJnZXQuZmluZCgnLnBsLWxvYWRpbmcnKS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIHRhcmdldC5wcmVwZW5kKGJhc2UuY3JlYXRlTG9hZGluZygpKTsKICAgICAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCB0aGlzLnNlbmRMaW5rVG9SUEMoZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuZmlsZW5hbWUsIGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmxpbmspOwogICAgICAgICAgICAgICAgaWYgKHJlcyA9PT0gJ3N1Y2Nlc3MnKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnLmxpc3RlbmVyLXJwYy10YXNrJykuc2hvdygpOwogICAgICAgICAgICAgICAgICAgIHRhcmdldC5yZW1vdmVDbGFzcygncGwtYnRuLWRhbmdlcicpLmh0bWwoJ+WPkemAgeaIkOWKn++8jOW/q+WOu+eci+eci+WQp++8gScpLmFuaW1hdGUoe29wYWNpdHk6ICcwLjUnfSwgInNsb3ciKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmFkZENsYXNzKCdwbC1idG4tZGFuZ2VyJykudGV4dCgn5Y+R6YCB5aSx6LSl77yM6K+35qOA5p+l5oKo55qEUlBD6YWN572u5L+h5oGv77yBJykuYW5pbWF0ZSh7b3BhY2l0eTogJzAuNSd9LCAic2xvdyIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItc2VuZC1ycGMnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgJCgnLmxpc3RlbmVyLWxpbmstcnBjJykuY2xpY2soKTsKICAgICAgICAgICAgICAgICQoZS50YXJnZXQpLnRleHQoJ+WPkemAgeWujOaIkO+8jOWPkemAgee7k+aenOingeS4iuaWueaMiemSru+8gScpLmFuaW1hdGUoe29wYWNpdHk6ICcwLjUnfSwgInNsb3ciKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLW9wZW4tc2V0dGluZycsICgpID0+IHsKICAgICAgICAgICAgICAgIGJhc2Uuc2hvd1NldHRpbmcoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLXJwYy10YXNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgbGV0IHJwYyA9IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgICAgICBkb21haW46IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX2RvbWFpbicpLAogICAgICAgICAgICAgICAgICAgIHBvcnQ6IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BvcnQnKSwKICAgICAgICAgICAgICAgIH0pLCB1cmwgPSBgJHtwYW4uZH0vP3JwYz0ke2Jhc2UuZShycGMpfSMke2Jhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3Rva2VuJyl9YDsKICAgICAgICAgICAgICAgIEdNX29wZW5JblRhYih1cmwsIHthY3RpdmU6IHRydWV9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKCiAgICAgICAgYWRkQnV0dG9uKCkgewogICAgICAgICAgICBpZiAoIXB0KSByZXR1cm47CiAgICAgICAgICAgIGxldCAkdG9vbFdyYXA7CiAgICAgICAgICAgIGxldCAkYnV0dG9uID0gJChgPGRpdiBjbGFzcz0idGlhbnlpLWJ1dHRvbiBwbC1idXR0b24iPuS4i+i9veWKqeaJizx1bCBjbGFzcz0icGwtZHJvcGRvd24tbWVudSIgc3R5bGU9InRvcDogMjZweDsiPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImFwaSI+QVBJ5LiL6L29PC9saT48bGkgY2xhc3M9InBsLWRyb3Bkb3duLW1lbnUtaXRlbSBwbC1idXR0b24tbW9kZSIgZGF0YS1tb2RlPSJhcmlhIiA+QXJpYeS4i+i9vTwvbGk+PGxpIGNsYXNzPSJwbC1kcm9wZG93bi1tZW51LWl0ZW0gcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0icnBjIj5SUEPkuIvovb08L2xpPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImN1cmwiPmNVUkzkuIvovb08L2xpPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImJjIiA+QkPkuIvovb08L2xpPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIGxpc3RlbmVyLW9wZW4tc2V0dGluZyI+5Yqp5omL6K6+572uPC9saT4ke3Bhbi5jb2RlID09IDIwMCAmJiB2ZXJzaW9uIDwgcGFuLnZlcnNpb24gPyBwYW4ubmV3IDogJyd9PC91bD48L2Rpdj5gKTsKICAgICAgICAgICAgaWYgKHB0ID09PSAnaG9tZScpIHsKICAgICAgICAgICAgICAgIGJhc2UubGlzdGVuRWxlbWVudChwYW4uYnRuLmhvbWUsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAkdG9vbFdyYXAgPSAkKHBhbi5idG4uaG9tZSk7CiAgICAgICAgICAgICAgICAgICAgJCgnLnBsLWJ1dHRvbicpLmxlbmd0aCA9PT0gMCAmJiAkdG9vbFdyYXAucHJlcGVuZCgkYnV0dG9uKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHB0ID09PSAnc2hhcmUnKSB7CiAgICAgICAgICAgICAgICBiYXNlLmxpc3RlbkVsZW1lbnQocGFuLmJ0bi5zaGFyZSwgKCkgPT4gewogICAgICAgICAgICAgICAgICAgICR0b29sV3JhcCA9ICQocGFuLmJ0bi5zaGFyZSk7CiAgICAgICAgICAgICAgICAgICAgJCgnLnBsLWJ1dHRvbicpLmxlbmd0aCA9PT0gMCAmJiAkdG9vbFdyYXAucHJlcGVuZCgkYnV0dG9uKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgYmFzZS5jcmVhdGVEb3dubG9hZElmcmFtZSgpOwogICAgICAgICAgICB0aGlzLmFkZFBhZ2VMaXN0ZW5lcigpOwogICAgICAgIH0sCgogICAgICAgIGFkZEluaXRCdXR0b24oKSB7CiAgICAgICAgICAgIGlmICghcHQpIHJldHVybjsKICAgICAgICAgICAgbGV0ICR0b29sV3JhcDsKICAgICAgICAgICAgbGV0ICRidXR0b24gPSAkKGA8ZGl2IGNsYXNzPSJ0aWFueWktYnV0dG9uIHBsLWJ1dHRvbi1pbml0Ij7kuIvovb3liqnmiYs8L2Rpdj5gKTsKICAgICAgICAgICAgaWYgKHB0ID09PSAnaG9tZScpIHsKICAgICAgICAgICAgICAgIGJhc2UubGlzdGVuRWxlbWVudChwYW4uYnRuLmhvbWUsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAkdG9vbFdyYXAgPSAkKHBhbi5idG4uaG9tZSk7CiAgICAgICAgICAgICAgICAgICAgJCgnLnBsLWJ1dHRvbi1pbml0JykubGVuZ3RoID09PSAwICYmICR0b29sV3JhcC5wcmVwZW5kKCRidXR0b24pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocHQgPT09ICdzaGFyZScpIHsKICAgICAgICAgICAgICAgICRidXR0b24uY3NzKHsnbWFyZ2luLXJpZ2h0JzogJzEwcHgnfSk7CiAgICAgICAgICAgICAgICBiYXNlLmxpc3RlbkVsZW1lbnQocGFuLmJ0bi5zaGFyZSwgKCkgPT4gewogICAgICAgICAgICAgICAgICAgICR0b29sV3JhcCA9ICQocGFuLmJ0bi5zaGFyZSk7CiAgICAgICAgICAgICAgICAgICAgJCgnLnBsLWJ1dHRvbi1pbml0JykubGVuZ3RoID09PSAwICYmICR0b29sV3JhcC5wcmVwZW5kKCRidXR0b24pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgICAgICAkYnV0dG9uLmNsaWNrKCgpID0+IGJhc2UuaW5pdERpYWxvZygpKTsKICAgICAgICB9LAoKICAgICAgICBhc3luYyBnZXRUb2tlbigpIHsKICAgICAgICAgICAgbGV0IHJlcyA9IGF3YWl0IGJhc2UuZ2V0RmluYWxVcmwocGFuLnBjc1sxXSwge30pOwogICAgICAgICAgICBsZXQgYWNjZXNzVG9rZW4gPSByZXMubWF0Y2goL2FjY2Vzc1Rva2VuPShcdyspLyk/LlsxXTsKICAgICAgICAgICAgYWNjZXNzVG9rZW4gJiYgYmFzZS5zZXRTdG9yYWdlKCdhY2Nlc3NUb2tlbicsIGFjY2Vzc1Rva2VuKTsKICAgICAgICAgICAgcmV0dXJuIGFjY2Vzc1Rva2VuOwogICAgICAgIH0sCgogICAgICAgIGFzeW5jIGdldEZpbGVVcmxCeU9uY2UoaXRlbSwgaW5kZXgsIHRva2VuKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAoaXRlbS5kb3dubG9hZFVybCkgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICBpbmRleCwKICAgICAgICAgICAgICAgICAgICBkb3dubG9hZFVybDogaXRlbS5kb3dubG9hZFVybAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGxldCB0aW1lID0gRGF0ZS5ub3coKSwKICAgICAgICAgICAgICAgICAgICBmaWxlSWQgPSBpdGVtLmZpbGVJZCwKICAgICAgICAgICAgICAgICAgICBvID0gIkFjY2Vzc1Rva2VuPSIgKyB0b2tlbiArICImVGltZXN0YW1wPSIgKyB0aW1lICsgIiZmaWxlSWQ9IiArIGZpbGVJZCwKICAgICAgICAgICAgICAgICAgICB1cmwgPSBwYW4ucGNzWzJdICsgJz9maWxlSWQ9JyArIGZpbGVJZDsKICAgICAgICAgICAgICAgIGlmIChpdGVtLnNoYXJlSWQpIHsKICAgICAgICAgICAgICAgICAgICBvID0gIkFjY2Vzc1Rva2VuPSIgKyB0b2tlbiArICImVGltZXN0YW1wPSIgKyB0aW1lICsgIiZkdD0xJmZpbGVJZD0iICsgZmlsZUlkICsgIiZzaGFyZUlkPSIgKyBpdGVtLnNoYXJlSWQ7CiAgICAgICAgICAgICAgICAgICAgdXJsICs9ICcmZHQ9MSZzaGFyZUlkPScgKyBpdGVtLnNoYXJlSWQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBsZXQgc2lnbiA9IG1kNShvKS50b1N0cmluZygpOwogICAgICAgICAgICAgICAgbGV0IHJlcyA9IGF3YWl0IGJhc2UuZ2V0KHVybCwgewogICAgICAgICAgICAgICAgICAgICJhY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbjtjaGFyc2V0PVVURi04IiwKICAgICAgICAgICAgICAgICAgICAic2lnbi10eXBlIjogMSwKICAgICAgICAgICAgICAgICAgICAiYWNjZXNzdG9rZW4iOiB0b2tlbiwKICAgICAgICAgICAgICAgICAgICAidGltZXN0YW1wIjogdGltZSwKICAgICAgICAgICAgICAgICAgICAic2lnbmF0dXJlIjogc2lnbgogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBpZiAocmVzLnJlc19jb2RlID09PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXgsCiAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkVXJsOiByZXMuZmlsZURvd25sb2FkVXJsCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmVycm9yQ29kZSA9PT0gJ0ludmFsaWRTZXNzaW9uS2V5JykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4LAogICAgICAgICAgICAgICAgICAgICAgICBkb3dubG9hZFVybDogJ+aPkOekuu+8muivt+WFiOeZu+W9lee9keebmO+8gScKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXMucmVzX2NvZGUgPT09ICdTaGFyZU5vdEZvdW5kRmxhdERpcicpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICBpbmRleCwKICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRVcmw6ICfmj5DnpLrvvJror7flhYhb6L2s5a2YXeaWh+S7tu+8jPCfkYnliY3lvoBb5oiR55qE572R55uYXeS4reS4i+i9ve+8gScKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICBpbmRleCwKICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRVcmw6ICfojrflj5bkuIvovb3lnLDlnYDlpLHotKXvvIzor7fliLfmlrDph43or5XvvIEnCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICBpbmRleCwKICAgICAgICAgICAgICAgICAgICBkb3dubG9hZFVybDogJ+iOt+WPluS4i+i9veWcsOWdgOWksei0pe+8jOivt+WIt+aWsOmHjeivle+8gScKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBhc3luYyBnZXRQQ1NMaW5rKCkgewogICAgICAgICAgICBzZWxlY3RMaXN0ID0gdGhpcy5nZXRTZWxlY3RlZExpc3QoKTsKICAgICAgICAgICAgaWYgKHNlbGVjdExpc3QubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZS5lcnJvcign5o+Q56S677ya6K+35YWI5Yu+6YCJ6KaB5LiL6L2955qE5paH5Lu277yBJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHRoaXMuaXNPbmx5Rm9sZGVyKCkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlLmVycm9yKCfmj5DnpLrvvJror7fmiZPlvIDmlofku7blpLnlkI7li77pgInmlofku7bvvIEnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBsZXQgdG9rZW4gPSBiYXNlLmdldFN0b3JhZ2UoJ2FjY2Vzc1Rva2VuJykgfHwgYXdhaXQgdGhpcy5nZXRUb2tlbigpOwogICAgICAgICAgICBpZiAoIXRva2VuKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZS5lcnJvcign5o+Q56S677ya6K+35YWI55m75b2V572R55uY77yBJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IHF1ZXVlID0gW107CiAgICAgICAgICAgIHNlbGVjdExpc3QuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHsKICAgICAgICAgICAgICAgIHF1ZXVlLnB1c2godGhpcy5nZXRGaWxlVXJsQnlPbmNlKGl0ZW0sIGluZGV4LCB0b2tlbikpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IFByb21pc2UuYWxsKHF1ZXVlKTsKICAgICAgICAgICAgcmVzLmZvckVhY2godmFsID0+IHsKICAgICAgICAgICAgICAgIHNlbGVjdExpc3RbdmFsLmluZGV4XS5kb3dubG9hZFVybCA9IHZhbC5kb3dubG9hZFVybDsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBsZXQgaHRtbCA9IHRoaXMuZ2VuZXJhdGVEb20oc2VsZWN0TGlzdCk7CiAgICAgICAgICAgIHRoaXMuc2hvd01haW5EaWFsb2cocGFuW21vZGVdWzBdLCBodG1sLCBwYW5bbW9kZV1bMV0pOwogICAgICAgIH0sCgogICAgICAgIGdlbmVyYXRlRG9tKGxpc3QpIHsKICAgICAgICAgICAgbGV0IGNvbnRlbnQgPSAnPGRpdiBjbGFzcz0icGwtbWFpbiI+JzsKICAgICAgICAgICAgbGV0IGFsaW5rQWxsVGV4dCA9ICcnOwogICAgICAgICAgICBsaXN0LmZvckVhY2goKHYsIGkpID0+IHsKICAgICAgICAgICAgICAgIGlmICh2LmlzRm9sZGVyKSByZXR1cm47CiAgICAgICAgICAgICAgICBsZXQgZmlsZW5hbWUgPSB2LmZpbGVOYW1lOwogICAgICAgICAgICAgICAgbGV0IHNpemUgPSBiYXNlLnNpemVGb3JtYXQodi5zaXplKTsKICAgICAgICAgICAgICAgIGxldCBkbGluayA9IHYuZG93bmxvYWRVcmw7CiAgICAgICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2FwaScpIHsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9InBsLWl0ZW0tbGluayBsaXN0ZW5lci1saW5rLWFwaSIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHtkbGlua30iIGRhdGEtaW5kZXg9IiR7aX0iPiR7ZGxpbmt9PC9hPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PmA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2FyaWEnKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGFsaW5rID0gdGhpcy5jb252ZXJ0TGlua1RvQXJpYShkbGluaywgZmlsZW5hbWUsIG5hdmlnYXRvci51c2VyQWdlbnQpOwogICAgICAgICAgICAgICAgICAgIGFsaW5rQWxsVGV4dCArPSBhbGluayArICdcclxuJzsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9InBsLWl0ZW0tbGluayBsaXN0ZW5lci1saW5rLWFyaWEiIGhyZWY9IiR7YWxpbmt9IiB0aXRsZT0i54K55Ye75aSN5Yi2YXJpYTJj6ZO+5o6lIiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2FsaW5rfSI+JHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmspfTwvYT4gPC9kaXY+YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAncnBjJykgewogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJwbC1pdGVtLWxpbmsgbGlzdGVuZXItbGluay1ycGMgcGwtYnRuLXByaW1hcnkgcGwtYnRuLWluZm8iIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7ZGxpbmt9Ij48ZW0gY2xhc3M9Imljb24gaWNvbi1kZXZpY2UiPjwvZW0+PHNwYW4gc3R5bGU9Im1hcmdpbi1sZWZ0OiA1cHg7Ij7mjqjpgIHliLAgUlBDIOS4i+i9veWZqDwvc3Bhbj48L2J1dHRvbj48L2Rpdj5gOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdjdXJsJykgewogICAgICAgICAgICAgICAgICAgIGxldCBhbGluayA9IHRoaXMuY29udmVydExpbmtUb0N1cmwoZGxpbmssIGZpbGVuYW1lLCBuYXZpZ2F0b3IudXNlckFnZW50KTsKICAgICAgICAgICAgICAgICAgICBhbGlua0FsbFRleHQgKz0gYWxpbmsgKyAnXHJcbic7CiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJwbC1pdGVtLWxpbmsgbGlzdGVuZXItbGluay1hcmlhIiBocmVmPSIke2FsaW5rfSIgdGl0bGU9IueCueWHu+WkjeWItmN1cmzpk77mjqUiIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7YWxpbmt9Ij4ke2RlY29kZVVSSUNvbXBvbmVudChhbGluayl9PC9hPiA8L2Rpdj5gOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdiYycpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgYWxpbmsgPSB0aGlzLmNvbnZlcnRMaW5rVG9CQyhkbGluaywgZmlsZW5hbWUsIG5hdmlnYXRvci51c2VyQWdlbnQpOwogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz0icGwtaXRlbS1saW5rIiBocmVmPSIke2RlY29kZVVSSUNvbXBvbmVudChhbGluayl9IiB0aXRsZT0i54K55Ye755So5q+U54m55b2X5pif5LiL6L29IiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2FsaW5rfSI+JHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmspfTwvYT4gPC9kaXY+YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNvbnRlbnQgKz0gJzwvZGl2Pic7CiAgICAgICAgICAgIGlmIChtb2RlID09PSAnYXJpYScpCiAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1leHRyYSI+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgbGlzdGVuZXItY29weS1hbGwiIGRhdGEtbGluaz0iJHthbGlua0FsbFRleHR9Ij7lpI3liLblhajpg6jpk77mjqU8L2J1dHRvbj48L2Rpdj5gOwogICAgICAgICAgICBpZiAobW9kZSA9PT0gJ3JwYycpIHsKICAgICAgICAgICAgICAgIGxldCBycGMgPSBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19kb21haW4nKSArICc6JyArIGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BvcnQnKSArIGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BhdGgnKTsKICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWV4dHJhIj48YnV0dG9uIGNsYXNzPSJwbC1idG4tcHJpbWFyeSBsaXN0ZW5lci1zZW5kLXJwYyI+5Y+R6YCB5YWo6YOo6ZO+5o6lPC9idXR0b24+PGJ1dHRvbiB0aXRsZT0iJHtycGN9IiBjbGFzcz0icGwtYnRuLXByaW1hcnkgcGwtYnRuLXdhcm5pbmcgbGlzdGVuZXItb3Blbi1zZXR0aW5nIiBzdHlsZT0ibWFyZ2luLWxlZnQ6IDEwcHgiPuiuvue9riBSUEMg5Y+C5pWw77yI5b2T5YmN5Li677yaJHtycGN977yJPC9idXR0b24+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgcGwtYnRuLXN1Y2Nlc3MgbGlzdGVuZXItcnBjLXRhc2siIHN0eWxlPSJtYXJnaW4tbGVmdDogMTBweDtkaXNwbGF5OiBub25lIj7mn6XnnIvkuIvovb3ku7vliqE8L2J1dHRvbj48L2Rpdj5gOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChtb2RlID09PSAnY3VybCcpCiAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1leHRyYSI+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgbGlzdGVuZXItY29weS1hbGwiIGRhdGEtbGluaz0iJHthbGlua0FsbFRleHR9Ij7lpI3liLblhajpg6jpk77mjqU8L2J1dHRvbj48YnV0dG9uIGNsYXNzPSJwbC1idG4tcHJpbWFyeSBwbC1idG4td2FybmluZyBsaXN0ZW5lci1vcGVuLXNldHRpbmciIHN0eWxlPSJtYXJnaW4tbGVmdDogMTBweDsiPuiuvue9rue7iOerr+exu+Wei++8iOW9k+WJjeS4uu+8miR7dGVybWluYWxUeXBlW2Jhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfdGVybWluYWxfdHlwZScpXX3vvIk8L2J1dHRvbj48L2Rpdj5gOwogICAgICAgICAgICByZXR1cm4gY29udGVudDsKICAgICAgICB9LAoKICAgICAgICBhc3luYyBzZW5kTGlua1RvUlBDKGZpbGVuYW1lLCBsaW5rKSB7CiAgICAgICAgICAgIGxldCBycGMgPSB7CiAgICAgICAgICAgICAgICBkb21haW46IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX2RvbWFpbicpLAogICAgICAgICAgICAgICAgcG9ydDogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfcG9ydCcpLAogICAgICAgICAgICAgICAgcGF0aDogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfcGF0aCcpLAogICAgICAgICAgICAgICAgdG9rZW46IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3Rva2VuJyksCiAgICAgICAgICAgICAgICBkaXI6IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX2RpcicpLAogICAgICAgICAgICB9OwoKICAgICAgICAgICAgbGV0IHVybCA9IGAke3JwYy5kb21haW59OiR7cnBjLnBvcnR9JHtycGMucGF0aH1gOwogICAgICAgICAgICBsZXQgcnBjRGF0YSA9IHsKICAgICAgICAgICAgICAgIGlkOiBuZXcgRGF0ZSgpLmdldFRpbWUoKSwKICAgICAgICAgICAgICAgIGpzb25ycGM6ICcyLjAnLAogICAgICAgICAgICAgICAgbWV0aG9kOiAnYXJpYTIuYWRkVXJpJywKICAgICAgICAgICAgICAgIHBhcmFtczogW2B0b2tlbjoke3JwYy50b2tlbn1gLCBbbGlua10sIHsKICAgICAgICAgICAgICAgICAgICBkaXI6IHJwYy5kaXIsCiAgICAgICAgICAgICAgICAgICAgb3V0OiBmaWxlbmFtZSwKICAgICAgICAgICAgICAgICAgICBoZWFkZXI6IFtdCiAgICAgICAgICAgICAgICB9XQogICAgICAgICAgICB9OwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgbGV0IHJlcyA9IGF3YWl0IGJhc2UucG9zdCh1cmwsIHJwY0RhdGEsIHt9LCAnJyk7CiAgICAgICAgICAgICAgICBpZiAocmVzLnJlc3VsdCkgcmV0dXJuICdzdWNjZXNzJzsKICAgICAgICAgICAgICAgIHJldHVybiAnZmFpbCc7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiAnZmFpbCc7CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBnZXRTZWxlY3RlZExpc3QoKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmMtZmlsZS1saXN0IikuX192dWVfXy5zZWxlY3RlZExpc3Q7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBbZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmluZm8tZGV0YWlsIikuX192dWVfXy5maWxlRGV0YWlsXTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGRldGVjdFBhZ2UoKSB7CiAgICAgICAgICAgIGxldCBwYXRoID0gbG9jYXRpb24ucGF0aG5hbWU7CiAgICAgICAgICAgIGlmICgvXlwvd2ViXC9tYWluLy50ZXN0KHBhdGgpKSByZXR1cm4gJ2hvbWUnOwogICAgICAgICAgICBpZiAoL15cL3dlYlwvc2hhcmUvLnRlc3QocGF0aCkpIHJldHVybiAnc2hhcmUnOwogICAgICAgICAgICByZXR1cm4gJyc7CiAgICAgICAgfSwKCiAgICAgICAgaXNPbmx5Rm9sZGVyKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlbGVjdExpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGlmICghc2VsZWN0TGlzdFtpXS5pc0ZvbGRlcikgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0sCgogICAgICAgIHNob3dNYWluRGlhbG9nKHRpdGxlLCBodG1sLCBmb290ZXIpIHsKICAgICAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgICAgICAgIHRpdGxlLAogICAgICAgICAgICAgICAgaHRtbCwKICAgICAgICAgICAgICAgIGZvb3RlciwKICAgICAgICAgICAgICAgIGFsbG93T3V0c2lkZUNsaWNrOiBmYWxzZSwKICAgICAgICAgICAgICAgIHNob3dDbG9zZUJ1dHRvbjogdHJ1ZSwKICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wJywKICAgICAgICAgICAgICAgIHdpZHRoLAogICAgICAgICAgICAgICAgcGFkZGluZzogJzE1cHggMjBweCA1cHgnLAogICAgICAgICAgICAgICAgY3VzdG9tQ2xhc3MsCiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIGFzeW5jIGluaXRQYW5MaW5rZXIoKSB7CiAgICAgICAgICAgIGJhc2UuaW5pdERlZmF1bHRDb25maWcoKTsKICAgICAgICAgICAgYmFzZS5hZGRQYW5MaW5rZXJTdHlsZSgpOwogICAgICAgICAgICBwdCA9IHRoaXMuZGV0ZWN0UGFnZSgpOwogICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgYmFzZS5wb3N0CiAgICAgICAgICAgIChgaHR0cHM6Ly9hcGkueW91eGlhb2hvdS5jb20vY29uZmlnL3YyL3RpYW55aT92ZXI9JHt2ZXJzaW9ufSZhPSR7YXV0aG9yfWAsIHt9LCB7fSwgJ3RleHQnKTsKICAgICAgICAgICAgcGFuID0gSlNPTi5wYXJzZShiYXNlLmQocmVzKSk7CiAgICAgICAgICAgIE9iamVjdC5mcmVlemUgJiYgT2JqZWN0LmZyZWV6ZShwYW4pOwogICAgICAgICAgICBwYW4ubnVtID09PSBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX2luaXRfY29kZScpIHx8CiAgICAgICAgICAgIHBhbi5saWNlbnNlID09PSBiYXNlLmdldFZhbHVlKCdsaWNlbnNlJykgPyB0aGlzLmFkZEJ1dHRvbigpIDogdGhpcy5hZGRJbml0QnV0dG9uKCk7CiAgICAgICAgICAgIHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgICAgICAgYmFzZS5jcmVhdGVUaXAoKTsKICAgICAgICAgICAgYmFzZS5yZWdpc3Rlck1lbnVDb21tYW5kKCk7CiAgICAgICAgfQogICAgfTsKCiAgICBsZXQgeHVubGVpID0gewoKICAgICAgICBjb252ZXJ0TGlua1RvQXJpYShsaW5rLCBmaWxlbmFtZSwgdWEpIHsKICAgICAgICAgICAgZmlsZW5hbWUgPSBiYXNlLmZpeEZpbGVuYW1lKGZpbGVuYW1lKTsKICAgICAgICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChgYXJpYTJjICIke2xpbmt9IiAtLW91dCAiJHtmaWxlbmFtZX0iYCk7CiAgICAgICAgfSwKCiAgICAgICAgY29udmVydExpbmtUb0JDKGxpbmssIGZpbGVuYW1lLCB1YSkgewogICAgICAgICAgICBsZXQgYmMgPSBgQUEvJHtlbmNvZGVVUklDb21wb25lbnQoZmlsZW5hbWUpfS8/dXJsPSR7ZW5jb2RlVVJJQ29tcG9uZW50KGxpbmspfVpaYDsKICAgICAgICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChgYmM6Ly9odHRwLyR7YmFzZS5lKGJjKX1gKTsKICAgICAgICB9LAoKICAgICAgICBjb252ZXJ0TGlua1RvQ3VybChsaW5rLCBmaWxlbmFtZSwgdWEpIHsKICAgICAgICAgICAgbGV0IHRlcm1pbmFsID0gYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ190ZXJtaW5hbF90eXBlJyk7CiAgICAgICAgICAgIGZpbGVuYW1lID0gYmFzZS5maXhGaWxlbmFtZShmaWxlbmFtZSk7CiAgICAgICAgICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoYCR7dGVybWluYWwgIT09ICd3cCcgPyAnY3VybCcgOiAnY3VybC5leGUnfSAtTCAtQyAtICIke2xpbmt9IiAtbyAiJHtmaWxlbmFtZX0iYCk7CiAgICAgICAgfSwKCiAgICAgICAgYWRkUGFnZUxpc3RlbmVyKCkgewogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5wbC1idXR0b24tbW9kZScsIChlKSA9PiB7CiAgICAgICAgICAgICAgICBtb2RlID0gZS50YXJnZXQuZGF0YXNldC5tb2RlOwogICAgICAgICAgICAgICAgU3dhbC5zaG93TG9hZGluZygpOwogICAgICAgICAgICAgICAgdGhpcy5nZXRQQ1NMaW5rKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1saW5rLWFwaScsIGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICAkKCcjZG93bmxvYWRJZnJhbWUnKS5hdHRyKCdzcmMnLCBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5saW5rKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLWxpbmstYXBpLWJ0bicsIGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBiYXNlLnNldENsaXBib2FyZChlLnRhcmdldC5kYXRhc2V0LmZpbGVuYW1lKTsKICAgICAgICAgICAgICAgICQoZS50YXJnZXQpLnRleHQoJ+WkjeWItuaIkOWKnycpLmFuaW1hdGUoe29wYWNpdHk6ICcwLjUnfSwgInNsb3ciKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLWxpbmstYmMtYnRuJywgYXN5bmMgKGUpID0+IHsKICAgICAgICAgICAgICAgIGxldCBtaXJyb3IgPSBiYXNlLmdldE1pcnJvckxpc3QoZS50YXJnZXQuZGF0YXNldC5kbGluaywgcGFuLm1pcnJvcik7CiAgICAgICAgICAgICAgICBiYXNlLnNldENsaXBib2FyZChtaXJyb3IpOwogICAgICAgICAgICAgICAgJChlLnRhcmdldCkudGV4dCgn5aSN5Yi25oiQ5YqfJykuYW5pbWF0ZSh7b3BhY2l0eTogJzAuNSd9LCAic2xvdyIpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItbGluay1hcmlhLCAubGlzdGVuZXItY29weS1hbGwnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgYmFzZS5zZXRDbGlwYm9hcmQoZGVjb2RlVVJJQ29tcG9uZW50KGUudGFyZ2V0LmRhdGFzZXQubGluaykpOwogICAgICAgICAgICAgICAgJChlLnRhcmdldCkudGV4dCgn5aSN5Yi25oiQ5Yqf77yM5b+r5Y6757KY6LS05ZCn77yBJykuYW5pbWF0ZSh7b3BhY2l0eTogJzAuNSd9LCAic2xvdyIpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItbGluay1ycGMnLCBhc3luYyAoZSkgPT4gewogICAgICAgICAgICAgICAgbGV0IHRhcmdldCA9ICQoZS5jdXJyZW50VGFyZ2V0KTsKICAgICAgICAgICAgICAgIHRhcmdldC5maW5kKCcuaWNvbicpLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgdGFyZ2V0LmZpbmQoJy5wbC1sb2FkaW5nJykucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICB0YXJnZXQucHJlcGVuZChiYXNlLmNyZWF0ZUxvYWRpbmcoKSk7CiAgICAgICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgdGhpcy5zZW5kTGlua1RvUlBDKGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmZpbGVuYW1lLCBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5saW5rKTsKICAgICAgICAgICAgICAgIGlmIChyZXMgPT09ICdzdWNjZXNzJykgewogICAgICAgICAgICAgICAgICAgICQoJy5saXN0ZW5lci1ycGMtdGFzaycpLnNob3coKTsKICAgICAgICAgICAgICAgICAgICB0YXJnZXQucmVtb3ZlQ2xhc3MoJ3BsLWJ0bi1kYW5nZXInKS5odG1sKCflj5HpgIHmiJDlip/vvIzlv6vljrvnnIvnnIvlkKfvvIEnKS5hbmltYXRlKHtvcGFjaXR5OiAnMC41J30sICJzbG93Iik7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRhcmdldC5hZGRDbGFzcygncGwtYnRuLWRhbmdlcicpLnRleHQoJ+WPkemAgeWksei0pe+8jOivt+ajgOafpeaCqOeahFJQQ+mFjee9ruS/oeaBr++8gScpLmFuaW1hdGUoe29wYWNpdHk6ICcwLjUnfSwgInNsb3ciKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLXNlbmQtcnBjJywgKGUpID0+IHsKICAgICAgICAgICAgICAgICQoJy5saXN0ZW5lci1saW5rLXJwYycpLmNsaWNrKCk7CiAgICAgICAgICAgICAgICAkKGUudGFyZ2V0KS50ZXh0KCflj5HpgIHlrozmiJDvvIzlj5HpgIHnu5Pmnpzop4HkuIrmlrnmjInpkq7vvIEnKS5hbmltYXRlKHtvcGFjaXR5OiAnMC41J30sICJzbG93Iik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1vcGVuLXNldHRpbmcnLCAoKSA9PiB7CiAgICAgICAgICAgICAgICBiYXNlLnNob3dTZXR0aW5nKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1ycGMtdGFzaycsICgpID0+IHsKICAgICAgICAgICAgICAgIGxldCBycGMgPSBKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICAgICAgZG9tYWluOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19kb21haW4nKSwKICAgICAgICAgICAgICAgICAgICBwb3J0OiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wb3J0JyksCiAgICAgICAgICAgICAgICB9KSwgdXJsID0gYCR7cGFuLmR9Lz9ycGM9JHtiYXNlLmUocnBjKX0jJHtiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY190b2tlbicpfWA7CiAgICAgICAgICAgICAgICBHTV9vcGVuSW5UYWIodXJsLCB7YWN0aXZlOiB0cnVlfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIGFkZEJ1dHRvbigpIHsKICAgICAgICAgICAgaWYgKCFwdCkgcmV0dXJuOwogICAgICAgICAgICBsZXQgJHRvb2xXcmFwOwogICAgICAgICAgICBsZXQgJGJ1dHRvbiA9ICQoYDxkaXYgY2xhc3M9Inh1bmxlaS1idXR0b24gcGwtYnV0dG9uIj48aSBjbGFzcz0ieGxwZm9udCB4bHAtZG93bmxvYWQiPjwvaT48c3BhbiBzdHlsZT0iZm9udC1zaXplOiAxM3B4O21hcmdpbi1sZWZ0OiA2cHg7Ij7kuIvovb3liqnmiYs8L3NwYW4+PHVsIGNsYXNzPSJwbC1kcm9wZG93bi1tZW51IiBzdHlsZT0idG9wOiAzNHB4OyI+PGxpIGNsYXNzPSJwbC1kcm9wZG93bi1tZW51LWl0ZW0gcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0iYXBpIj5BUEnkuIvovb08L2xpPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImFyaWEiID5Bcmlh5LiL6L29PC9saT48bGkgY2xhc3M9InBsLWRyb3Bkb3duLW1lbnUtaXRlbSBwbC1idXR0b24tbW9kZSIgZGF0YS1tb2RlPSJycGMiPlJQQ+S4i+i9vTwvbGk+PGxpIGNsYXNzPSJwbC1kcm9wZG93bi1tZW51LWl0ZW0gcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0iY3VybCI+Y1VSTOS4i+i9vTwvbGk+PGxpIGNsYXNzPSJwbC1kcm9wZG93bi1tZW51LWl0ZW0gcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0iYmMiID5CQ+S4i+i9vTwvbGk+PGxpIGNsYXNzPSJwbC1kcm9wZG93bi1tZW51LWl0ZW0gcGwtYnV0dG9uLW1vZGUgbGlzdGVuZXItb3Blbi1zZXR0aW5nIj7liqnmiYvorr7nva48L2xpPiR7cGFuLmNvZGUgPT0gMjAwICYmIHZlcnNpb24gPCBwYW4udmVyc2lvbiA/IHBhbi5uZXcgOiAnJ308L3VsPjwvZGl2PmApOwogICAgICAgICAgICBpZiAocHQgPT09ICdob21lJykgewogICAgICAgICAgICAgICAgYmFzZS5saXN0ZW5FbGVtZW50KHBhbi5idG4uaG9tZSwgKCkgPT4gewogICAgICAgICAgICAgICAgICAgICR0b29sV3JhcCA9ICQocGFuLmJ0bi5ob21lKTsKICAgICAgICAgICAgICAgICAgICAkKCcucGwtYnV0dG9uJykubGVuZ3RoID09PSAwICYmICR0b29sV3JhcC5wcmVwZW5kKCRidXR0b24pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocHQgPT09ICdzaGFyZScpIHsKICAgICAgICAgICAgICAgICRidXR0b24uY3NzKHsnbWFyZ2luLXJpZ2h0JzogJzEwcHgnfSk7CiAgICAgICAgICAgICAgICBiYXNlLmxpc3RlbkVsZW1lbnQocGFuLmJ0bi5zaGFyZSwgKCkgPT4gewogICAgICAgICAgICAgICAgICAgICR0b29sV3JhcCA9ICQocGFuLmJ0bi5zaGFyZSk7CiAgICAgICAgICAgICAgICAgICAgJCgnLnBsLWJ1dHRvbicpLmxlbmd0aCA9PT0gMCAmJiAkdG9vbFdyYXAucHJlcGVuZCgkYnV0dG9uKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgYmFzZS5jcmVhdGVEb3dubG9hZElmcmFtZSgpOwogICAgICAgICAgICB0aGlzLmFkZFBhZ2VMaXN0ZW5lcigpOwogICAgICAgIH0sCgogICAgICAgIGFkZEluaXRCdXR0b24oKSB7CiAgICAgICAgICAgIGlmICghcHQpIHJldHVybjsKICAgICAgICAgICAgbGV0ICR0b29sV3JhcDsKICAgICAgICAgICAgbGV0ICRidXR0b24gPSAkKGA8ZGl2IGNsYXNzPSJ4dW5sZWktYnV0dG9uIHBsLWJ1dHRvbi1pbml0Ij48aSBjbGFzcz0ieGxwZm9udCB4bHAtZG93bmxvYWQiPjwvaT48c3BhbiBzdHlsZT0iZm9udC1zaXplOiAxM3B4O21hcmdpbi1sZWZ0OiA2cHg7Ij7kuIvovb3liqnmiYs8L3NwYW4+PC9kaXY+YCk7CiAgICAgICAgICAgIGlmIChwdCA9PT0gJ2hvbWUnKSB7CiAgICAgICAgICAgICAgICBiYXNlLmxpc3RlbkVsZW1lbnQocGFuLmJ0bi5ob21lLCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgJHRvb2xXcmFwID0gJChwYW4uYnRuLmhvbWUpOwogICAgICAgICAgICAgICAgICAgICQoJy5wbC1idXR0b24taW5pdCcpLmxlbmd0aCA9PT0gMCAmJiAkdG9vbFdyYXAucHJlcGVuZCgkYnV0dG9uKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHB0ID09PSAnc2hhcmUnKSB7CiAgICAgICAgICAgICAgICAkYnV0dG9uLmNzcyh7J21hcmdpbi1yaWdodCc6ICcxMHB4J30pOwogICAgICAgICAgICAgICAgYmFzZS5saXN0ZW5FbGVtZW50KHBhbi5idG4uc2hhcmUsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAkdG9vbFdyYXAgPSAkKHBhbi5idG4uc2hhcmUpOwogICAgICAgICAgICAgICAgICAgICQoJy5wbC1idXR0b24taW5pdCcpLmxlbmd0aCA9PT0gMCAmJiAkdG9vbFdyYXAucHJlcGVuZCgkYnV0dG9uKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgJGJ1dHRvbi5jbGljaygoKSA9PiBiYXNlLmluaXREaWFsb2coKSk7CiAgICAgICAgfSwKCiAgICAgICAgZ2V0VG9rZW4oKSB7CiAgICAgICAgICAgIGxldCBjcmVkZW50aWFscyA9IHt9LCBjYXB0Y2hhID0ge307CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbG9jYWxTdG9yYWdlLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoL15jcmVkZW50aWFsc18vLnRlc3QobG9jYWxTdG9yYWdlLmtleShpKSkpIHsKICAgICAgICAgICAgICAgICAgICBjcmVkZW50aWFscyA9IGJhc2UuZ2V0U3RvcmFnZShsb2NhbFN0b3JhZ2Uua2V5KGkpKTsKICAgICAgICAgICAgICAgICAgICBiYXNlLnNldFN0b3JhZ2UoJycpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKC9eY2FwdGNoYV9bXHddezE2fS8udGVzdChsb2NhbFN0b3JhZ2Uua2V5KGkpKSkgewogICAgICAgICAgICAgICAgICAgIGNhcHRjaGEgPSBiYXNlLmdldFN0b3JhZ2UobG9jYWxTdG9yYWdlLmtleShpKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IGRldmljZWlkID0gLyhcd3szMn0pLy5leGVjKGJhc2UuZ2V0U3RvcmFnZSgnZGV2aWNlaWQnKS5zcGxpdCgnLCcpKVswXTsKICAgICAgICAgICAgbGV0IHRva2VuID0gewogICAgICAgICAgICAgICAgY3JlZGVudGlhbHMsCiAgICAgICAgICAgICAgICBjYXB0Y2hhLAogICAgICAgICAgICAgICAgZGV2aWNlaWQKICAgICAgICAgICAgfTsKICAgICAgICAgICAgcmV0dXJuIHRva2VuOwogICAgICAgIH0sCgogICAgICAgIGFzeW5jIGdldEZpbGVVcmxCeU9uY2UoaXRlbSwgaW5kZXgsIHRva2VuKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAoaXRlbS5kb3dubG9hZFVybCkgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICBpbmRleCwKICAgICAgICAgICAgICAgICAgICBkb3dubG9hZFVybDogaXRlbS5kb3dubG9hZFVybAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCBiYXNlLmdldChwYW4ucGNzWzBdICsgaXRlbS5pZCwgewogICAgICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYCR7dG9rZW4uY3JlZGVudGlhbHMudG9rZW5fdHlwZX0gJHt0b2tlbi5jcmVkZW50aWFscy5hY2Nlc3NfdG9rZW59YCwKICAgICAgICAgICAgICAgICAgICAnY29udGVudC10eXBlJzogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICAgICAgICAgICd4LWNhcHRjaGEtdG9rZW4nOiB0b2tlbi5jYXB0Y2hhLnRva2VuLAogICAgICAgICAgICAgICAgICAgICd4LWRldmljZS1pZCc6IHRva2VuLmRldmljZWlkLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBpZiAocmVzLndlYl9jb250ZW50X2xpbmspIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICBpbmRleCwKICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRVcmw6IHJlcy53ZWJfY29udGVudF9saW5rCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXgsCiAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkVXJsOiAn6I635Y+W5LiL6L295Zyw5Z2A5aSx6LSl77yM6K+35Yi35paw6YeN6K+V77yBJwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlLmVycm9yKCfmj5DnpLrvvJror7flhYjnmbvlvZXnvZHnm5jlkI7liLfmlrDpobXpnaLvvIEnKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGFzeW5jIGdldFBDU0xpbmsoKSB7CiAgICAgICAgICAgIHNlbGVjdExpc3QgPSB0aGlzLmdldFNlbGVjdGVkTGlzdCgpOwogICAgICAgICAgICBpZiAoc2VsZWN0TGlzdC5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlLmVycm9yKCfmj5DnpLrvvJror7flhYjli77pgInopoHkuIvovb3nmoTmlofku7bvvIEnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAodGhpcy5pc09ubHlGb2xkZXIoKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UuZXJyb3IoJ+aPkOekuu+8muivt+aJk+W8gOaWh+S7tuWkueWQjuWLvumAieaWh+S7tu+8gScpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChwdCA9PT0gJ2hvbWUnKSB7CiAgICAgICAgICAgICAgICBsZXQgcXVldWUgPSBbXTsKICAgICAgICAgICAgICAgIGxldCB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgICAgICAgICAgIHNlbGVjdExpc3QuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHsKICAgICAgICAgICAgICAgICAgICBxdWV1ZS5wdXNoKHRoaXMuZ2V0RmlsZVVybEJ5T25jZShpdGVtLCBpbmRleCwgdG9rZW4pKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgUHJvbWlzZS5hbGwocXVldWUpOwogICAgICAgICAgICAgICAgcmVzLmZvckVhY2godmFsID0+IHsKICAgICAgICAgICAgICAgICAgICBzZWxlY3RMaXN0W3ZhbC5pbmRleF0uZG93bmxvYWRVcmwgPSB2YWwuZG93bmxvYWRVcmw7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGxldCBkaWFsb2cgPSBhd2FpdCBTd2FsLmZpcmUoewogICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvJywKICAgICAgICAgICAgICAgICAgICB0aXRsZTogYOaPkOekuu+8muivt+WwhuaWh+S7tjxzcGFuIGNsYXNzPSJ0YWctZGFuZ2VyIj5b5L+d5a2Y5Yiw572R55uYXTwvc3Bhbj7wn5GJ5YmN5b6APHNwYW4gY2xhc3M9InRhZy1kYW5nZXIiPlvmiJHnmoTnvZHnm5hdPC9zcGFuPuS4reS4i+i9ve+8gWAsCiAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IHRydWUsCiAgICAgICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfngrnlh7vkv53lrZgnLAogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wJywKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgaWYgKGRpYWxvZy5pc0NvbmZpcm1lZCkgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zYXZlVG9DbG91ZCcpLmNsaWNrKCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGxldCBodG1sID0gdGhpcy5nZW5lcmF0ZURvbShzZWxlY3RMaXN0KTsKICAgICAgICAgICAgdGhpcy5zaG93TWFpbkRpYWxvZyhwYW5bbW9kZV1bMF0sIGh0bWwsIHBhblttb2RlXVsxXSk7CgogICAgICAgIH0sCgogICAgICAgIGdlbmVyYXRlRG9tKGxpc3QpIHsKICAgICAgICAgICAgbGV0IGNvbnRlbnQgPSAnPGRpdiBjbGFzcz0icGwtbWFpbiI+JzsKICAgICAgICAgICAgbGV0IGFsaW5rQWxsVGV4dCA9ICcnOwogICAgICAgICAgICBsaXN0LmZvckVhY2goKHYsIGkpID0+IHsKICAgICAgICAgICAgICAgIGlmICh2LmtpbmQgPT09ICdkcml2ZSNmb2xkZXInKSByZXR1cm47CiAgICAgICAgICAgICAgICBsZXQgZmlsZW5hbWUgPSB2Lm5hbWU7CiAgICAgICAgICAgICAgICBsZXQgc2l6ZSA9IGJhc2Uuc2l6ZUZvcm1hdCgrdi5zaXplKTsKICAgICAgICAgICAgICAgIGxldCBkbGluayA9IHYuZG93bmxvYWRVcmw7CiAgICAgICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2FwaScpIHsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9InBsLWl0ZW0tbGluayBsaXN0ZW5lci1saW5rLWFwaSIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHtkbGlua30iIGRhdGEtaW5kZXg9IiR7aX0iPiR7ZGxpbmt9PC9hPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tYnRuIGxpc3RlbmVyLWxpbmstYXBpLWJ0biIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iPuWkjeWItuaWh+S7tuWQjTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PmA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2FyaWEnKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGFsaW5rID0gdGhpcy5jb252ZXJ0TGlua1RvQXJpYShkbGluaywgZmlsZW5hbWUsIG5hdmlnYXRvci51c2VyQWdlbnQpOwogICAgICAgICAgICAgICAgICAgIGFsaW5rQWxsVGV4dCArPSBhbGluayArICdcclxuJzsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9InBsLWl0ZW0tbGluayBsaXN0ZW5lci1saW5rLWFyaWEiIGhyZWY9IiR7YWxpbmt9IiB0aXRsZT0i54K55Ye75aSN5Yi2YXJpYTJj6ZO+5o6lIiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2FsaW5rfSI+JHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmspfTwvYT4gPC9kaXY+YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAncnBjJykgewogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJwbC1pdGVtLWxpbmsgbGlzdGVuZXItbGluay1ycGMgcGwtYnRuLXByaW1hcnkgcGwtYnRuLWluZm8iIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7ZGxpbmt9Ij48ZW0gY2xhc3M9Imljb24gaWNvbi1kZXZpY2UiPjwvZW0+PHNwYW4gc3R5bGU9Im1hcmdpbi1sZWZ0OiA1cHg7Ij7mjqjpgIHliLAgUlBDIOS4i+i9veWZqDwvc3Bhbj48L2J1dHRvbj48L2Rpdj5gOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdjdXJsJykgewogICAgICAgICAgICAgICAgICAgIGxldCBhbGluayA9IHRoaXMuY29udmVydExpbmtUb0N1cmwoZGxpbmssIGZpbGVuYW1lLCBuYXZpZ2F0b3IudXNlckFnZW50KTsKICAgICAgICAgICAgICAgICAgICBhbGlua0FsbFRleHQgKz0gYWxpbmsgKyAnXHJcbic7CiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJwbC1pdGVtLWxpbmsgbGlzdGVuZXItbGluay1hcmlhIiBocmVmPSIke2FsaW5rfSIgdGl0bGU9IueCueWHu+WkjeWItmN1cmzpk77mjqUiIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7YWxpbmt9Ij4ke2RlY29kZVVSSUNvbXBvbmVudChhbGluayl9PC9hPiA8L2Rpdj5gOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdiYycpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgYWxpbmsgPSB0aGlzLmNvbnZlcnRMaW5rVG9CQyhkbGluaywgZmlsZW5hbWUsIG5hdmlnYXRvci51c2VyQWdlbnQpOwogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz0icGwtaXRlbS1saW5rIiBocmVmPSIke2RlY29kZVVSSUNvbXBvbmVudChhbGluayl9IiB0aXRsZT0i54K55Ye755So5q+U54m55b2X5pif5LiL6L29IiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2FsaW5rfSI+JHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmspfTwvYT4gCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1idG4gbGlzdGVuZXItbGluay1iYy1idG4iIGRhdGEtZGxpbms9IiR7ZGxpbmt9Ij7lpI3liLbplZzlg4/lnLDlnYA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgY29udGVudCArPSAnPC9kaXY+JzsKICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdhcmlhJykKICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWV4dHJhIj48YnV0dG9uIGNsYXNzPSJwbC1idG4tcHJpbWFyeSBsaXN0ZW5lci1jb3B5LWFsbCIgZGF0YS1saW5rPSIke2FsaW5rQWxsVGV4dH0iPuWkjeWItuWFqOmDqOmTvuaOpTwvYnV0dG9uPjwvZGl2PmA7CiAgICAgICAgICAgIGlmIChtb2RlID09PSAncnBjJykgewogICAgICAgICAgICAgICAgbGV0IHJwYyA9IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX2RvbWFpbicpICsgJzonICsgYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfcG9ydCcpICsgYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfcGF0aCcpOwogICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtZXh0cmEiPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IGxpc3RlbmVyLXNlbmQtcnBjIj7lj5HpgIHlhajpg6jpk77mjqU8L2J1dHRvbj48YnV0dG9uIHRpdGxlPSIke3JwY30iIGNsYXNzPSJwbC1idG4tcHJpbWFyeSBwbC1idG4td2FybmluZyBsaXN0ZW5lci1vcGVuLXNldHRpbmciIHN0eWxlPSJtYXJnaW4tbGVmdDogMTBweCI+6K6+572uIFJQQyDlj4LmlbDvvIjlvZPliY3kuLrvvJoke3JwY33vvIk8L2J1dHRvbj48YnV0dG9uIGNsYXNzPSJwbC1idG4tcHJpbWFyeSBwbC1idG4tc3VjY2VzcyBsaXN0ZW5lci1ycGMtdGFzayIgc3R5bGU9Im1hcmdpbi1sZWZ0OiAxMHB4O2Rpc3BsYXk6IG5vbmUiPuafpeeci+S4i+i9veS7u+WKoTwvYnV0dG9uPjwvZGl2PmA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdjdXJsJykKICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWV4dHJhIj48YnV0dG9uIGNsYXNzPSJwbC1idG4tcHJpbWFyeSBsaXN0ZW5lci1jb3B5LWFsbCIgZGF0YS1saW5rPSIke2FsaW5rQWxsVGV4dH0iPuWkjeWItuWFqOmDqOmTvuaOpTwvYnV0dG9uPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IHBsLWJ0bi13YXJuaW5nIGxpc3RlbmVyLW9wZW4tc2V0dGluZyIgc3R5bGU9Im1hcmdpbi1sZWZ0OiAxMHB4OyI+6K6+572u57uI56uv57G75Z6L77yI5b2T5YmN5Li677yaJHt0ZXJtaW5hbFR5cGVbYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ190ZXJtaW5hbF90eXBlJyldfe+8iTwvYnV0dG9uPjwvZGl2PmA7CiAgICAgICAgICAgIHJldHVybiBjb250ZW50OwogICAgICAgIH0sCgogICAgICAgIGFzeW5jIHNlbmRMaW5rVG9SUEMoZmlsZW5hbWUsIGxpbmspIHsKICAgICAgICAgICAgbGV0IHJwYyA9IHsKICAgICAgICAgICAgICAgIGRvbWFpbjogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfZG9tYWluJyksCiAgICAgICAgICAgICAgICBwb3J0OiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wb3J0JyksCiAgICAgICAgICAgICAgICBwYXRoOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wYXRoJyksCiAgICAgICAgICAgICAgICB0b2tlbjogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfdG9rZW4nKSwKICAgICAgICAgICAgICAgIGRpcjogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfZGlyJyksCiAgICAgICAgICAgIH07CgogICAgICAgICAgICBsZXQgdXJsID0gYCR7cnBjLmRvbWFpbn06JHtycGMucG9ydH0ke3JwYy5wYXRofWA7CiAgICAgICAgICAgIGxldCBycGNEYXRhID0gewogICAgICAgICAgICAgICAgaWQ6IG5ldyBEYXRlKCkuZ2V0VGltZSgpLAogICAgICAgICAgICAgICAganNvbnJwYzogJzIuMCcsCiAgICAgICAgICAgICAgICBtZXRob2Q6ICdhcmlhMi5hZGRVcmknLAogICAgICAgICAgICAgICAgcGFyYW1zOiBbYHRva2VuOiR7cnBjLnRva2VufWAsIFtsaW5rXSwgewogICAgICAgICAgICAgICAgICAgIGRpcjogcnBjLmRpciwKICAgICAgICAgICAgICAgICAgICBvdXQ6IGZpbGVuYW1lLAogICAgICAgICAgICAgICAgICAgIGhlYWRlcjogW10KICAgICAgICAgICAgICAgIH1dCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgYmFzZS5wb3N0KHVybCwgcnBjRGF0YSwge30sICcnKTsKICAgICAgICAgICAgICAgIGlmIChyZXMucmVzdWx0KSByZXR1cm4gJ3N1Y2Nlc3MnOwogICAgICAgICAgICAgICAgcmV0dXJuICdmYWlsJzsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgcmV0dXJuICdmYWlsJzsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGdldFNlbGVjdGVkTGlzdCgpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGxldCBkb21zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLlNvdXJjZUxpc3RJdGVtX19pdGVtLS1YeHBPQycpOwogICAgICAgICAgICAgICAgbGV0IHNlbGVjdGVkTGlzdCA9IFtdOwogICAgICAgICAgICAgICAgZm9yIChsZXQgZG9tIG9mIGRvbXMpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgZG9tVnVlID0gZG9tLl9fdnVlX187CiAgICAgICAgICAgICAgICAgICAgaWYgKGRvbVZ1ZS5zZWxlY3RlZC5pbmNsdWRlcyhkb21WdWUuaW5mby5pZCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRMaXN0LnB1c2goZG9tVnVlLmluZm8pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBzZWxlY3RlZExpc3Q7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBbXTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGRldGVjdFBhZ2UoKSB7CiAgICAgICAgICAgIGxldCBwYXRoID0gbG9jYXRpb24ucGF0aG5hbWU7CiAgICAgICAgICAgIGlmICgvXlwvJC8udGVzdChwYXRoKSkgcmV0dXJuICdob21lJzsKICAgICAgICAgICAgaWYgKC9eXC8oc3xzaGFyZSlcLy8udGVzdChwYXRoKSkgcmV0dXJuICdzaGFyZSc7CiAgICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICB9LAoKICAgICAgICBpc09ubHlGb2xkZXIoKSB7CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0TGlzdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgaWYgKHNlbGVjdExpc3RbaV0ua2luZCA9PT0gJ2RyaXZlI2ZpbGUnKSByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSwKCiAgICAgICAgc2hvd01haW5EaWFsb2codGl0bGUsIGh0bWwsIGZvb3RlcikgewogICAgICAgICAgICBTd2FsLmZpcmUoewogICAgICAgICAgICAgICAgdGl0bGUsCiAgICAgICAgICAgICAgICBodG1sLAogICAgICAgICAgICAgICAgZm9vdGVyLAogICAgICAgICAgICAgICAgYWxsb3dPdXRzaWRlQ2xpY2s6IGZhbHNlLAogICAgICAgICAgICAgICAgc2hvd0Nsb3NlQnV0dG9uOiB0cnVlLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgcG9zaXRpb246ICd0b3AnLAogICAgICAgICAgICAgICAgd2lkdGgsCiAgICAgICAgICAgICAgICBwYWRkaW5nOiAnMTVweCAyMHB4IDVweCcsCiAgICAgICAgICAgICAgICBjdXN0b21DbGFzcywKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKCiAgICAgICAgYXN5bmMgaW5pdFBhbkxpbmtlcigpIHsKICAgICAgICAgICAgYmFzZS5pbml0RGVmYXVsdENvbmZpZygpOwogICAgICAgICAgICBiYXNlLmFkZFBhbkxpbmtlclN0eWxlKCk7CiAgICAgICAgICAgIHB0ID0gdGhpcy5kZXRlY3RQYWdlKCk7CiAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCBiYXNlLnBvc3QKICAgICAgICAgICAgKGBodHRwczovL2FwaS55b3V4aWFvaG91LmNvbS9jb25maWcvdjIveHVubGVpP3Zlcj0ke3ZlcnNpb259JmE9JHthdXRob3J9YCwge30sIHt9LCAndGV4dCcpOwogICAgICAgICAgICBwYW4gPSBKU09OLnBhcnNlKGJhc2UuZChyZXMpKTsKICAgICAgICAgICAgT2JqZWN0LmZyZWV6ZSAmJiBPYmplY3QuZnJlZXplKHBhbik7CiAgICAgICAgICAgIHBhbi5udW0gPT09IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfaW5pdF9jb2RlJykgfHwKICAgICAgICAgICAgcGFuLmxpY2Vuc2UgPT09IGJhc2UuZ2V0VmFsdWUoJ2xpY2Vuc2UnKSA/IHRoaXMuYWRkQnV0dG9uKCkgOiB0aGlzLmFkZEluaXRCdXR0b24oKTsKICAgICAgICAgICAgYmFzZS5jcmVhdGVUaXAoKTsKICAgICAgICAgICAgYmFzZS5yZWdpc3Rlck1lbnVDb21tYW5kKCk7CiAgICAgICAgfQogICAgfTsKCiAgICBsZXQgcXVhcmsgPSB7CgogICAgICAgIGNvbnZlcnRMaW5rVG9BcmlhKGxpbmssIGZpbGVuYW1lLCB1YSkgewogICAgICAgICAgICBmaWxlbmFtZSA9IGJhc2UuZml4RmlsZW5hbWUoZmlsZW5hbWUpOwogICAgICAgICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGBhcmlhMmMgIiR7bGlua30iIC0tb3V0ICIke2ZpbGVuYW1lfSIgLS1oZWFkZXIgIkNvb2tpZTogJHtkb2N1bWVudC5jb29raWV9ImApOwogICAgICAgIH0sCgogICAgICAgIGNvbnZlcnRMaW5rVG9CQyhsaW5rLCBmaWxlbmFtZSwgdWEpIHsKICAgICAgICAgICAgbGV0IGJjID0gYEFBLyR7ZW5jb2RlVVJJQ29tcG9uZW50KGZpbGVuYW1lKX0vP3VybD0ke2VuY29kZVVSSUNvbXBvbmVudChsaW5rKX0mY29va2llPSR7ZW5jb2RlVVJJQ29tcG9uZW50KGRvY3VtZW50LmNvb2tpZSl9WlpgOwogICAgICAgICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGBiYzovL2h0dHAvJHtiYXNlLmUoYmMpfWApOwogICAgICAgIH0sCgogICAgICAgIGNvbnZlcnRMaW5rVG9DdXJsKGxpbmssIGZpbGVuYW1lLCB1YSkgewogICAgICAgICAgICBsZXQgdGVybWluYWwgPSBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3Rlcm1pbmFsX3R5cGUnKTsKICAgICAgICAgICAgZmlsZW5hbWUgPSBiYXNlLmZpeEZpbGVuYW1lKGZpbGVuYW1lKTsKICAgICAgICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChgJHt0ZXJtaW5hbCAhPT0gJ3dwJyA/ICdjdXJsJyA6ICdjdXJsLmV4ZSd9IC1MIC1DIC0gIiR7bGlua30iIC1vICIke2ZpbGVuYW1lfSIgLWIgIiR7ZG9jdW1lbnQuY29va2llfSJgKTsKICAgICAgICB9LAoKICAgICAgICBhZGRQYWdlTGlzdGVuZXIoKSB7CiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdoYXNoY2hhbmdlJywgYXN5bmMgKGUpID0+IHsKICAgICAgICAgICAgICAgIGxldCBob21lID0gJ2h0dHBzOi8vcGFuLnF1YXJrLmNuL2xpc3QjLycsIGFsbCA9ICdodHRwczovL3Bhbi5xdWFyay5jbi9saXN0Iy9saXN0L2FsbCc7CiAgICAgICAgICAgICAgICBpZiAoZS5vbGRVUkwgPT09IGhvbWUgJiYgZS5uZXdVUkwgPT09IGFsbCkgcmV0dXJuOwogICAgICAgICAgICAgICAgYXdhaXQgYmFzZS5zbGVlcCgxNTApOwogICAgICAgICAgICAgICAgaWYgKCQoJy5xdWFyay1idXR0b24nKS5sZW5ndGggPiAwKSByZXR1cm47CiAgICAgICAgICAgICAgICBwYW4ubnVtID09PSBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX2luaXRfY29kZScpIHx8CiAgICAgICAgICAgICAgICBwYW4ubGljZW5zZSA9PT0gYmFzZS5nZXRWYWx1ZSgnbGljZW5zZScpID8gdGhpcy5hZGRCdXR0b24oKSA6IHRoaXMuYWRkSW5pdEJ1dHRvbigpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcucGwtYnV0dG9uLW1vZGUnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgbW9kZSA9IGUudGFyZ2V0LmRhdGFzZXQubW9kZTsKICAgICAgICAgICAgICAgIFN3YWwuc2hvd0xvYWRpbmcoKTsKICAgICAgICAgICAgICAgIHRoaXMuZ2V0UENTTGluaygpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItbGluay1hcGknLCBhc3luYyAoZSkgPT4gewogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgJCgnI2Rvd25sb2FkSWZyYW1lJykuYXR0cignc3JjJywgZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQubGluayk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1saW5rLWFyaWEsIC5saXN0ZW5lci1jb3B5LWFsbCcsIChlKSA9PiB7CiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICBiYXNlLnNldENsaXBib2FyZChkZWNvZGVVUklDb21wb25lbnQoZS50YXJnZXQuZGF0YXNldC5saW5rKSk7CiAgICAgICAgICAgICAgICAkKGUudGFyZ2V0KS50ZXh0KCflpI3liLbmiJDlip/vvIzlv6vljrvnspjotLTlkKfvvIEnKS5hbmltYXRlKHtvcGFjaXR5OiAnMC41J30sICJzbG93Iik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1saW5rLXJwYycsIGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgdGFyZ2V0ID0gJChlLmN1cnJlbnRUYXJnZXQpOwogICAgICAgICAgICAgICAgdGFyZ2V0LmZpbmQoJy5pY29uJykucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICB0YXJnZXQuZmluZCgnLnBsLWxvYWRpbmcnKS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIHRhcmdldC5wcmVwZW5kKGJhc2UuY3JlYXRlTG9hZGluZygpKTsKICAgICAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCB0aGlzLnNlbmRMaW5rVG9SUEMoZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuZmlsZW5hbWUsIGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmxpbmspOwogICAgICAgICAgICAgICAgaWYgKHJlcyA9PT0gJ3N1Y2Nlc3MnKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnLmxpc3RlbmVyLXJwYy10YXNrJykuc2hvdygpOwogICAgICAgICAgICAgICAgICAgIHRhcmdldC5yZW1vdmVDbGFzcygncGwtYnRuLWRhbmdlcicpLmh0bWwoJ+WPkemAgeaIkOWKn++8jOW/q+WOu+eci+eci+WQp++8gScpLmFuaW1hdGUoe29wYWNpdHk6ICcwLjUnfSwgInNsb3ciKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmFkZENsYXNzKCdwbC1idG4tZGFuZ2VyJykudGV4dCgn5Y+R6YCB5aSx6LSl77yM6K+35qOA5p+l5oKo55qEUlBD6YWN572u5L+h5oGv77yBJykuYW5pbWF0ZSh7b3BhY2l0eTogJzAuNSd9LCAic2xvdyIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItc2VuZC1ycGMnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgJCgnLmxpc3RlbmVyLWxpbmstcnBjJykuY2xpY2soKTsKICAgICAgICAgICAgICAgICQoZS50YXJnZXQpLnRleHQoJ+WPkemAgeWujOaIkO+8jOWPkemAgee7k+aenOingeS4iuaWueaMiemSru+8gScpLmFuaW1hdGUoe29wYWNpdHk6ICcwLjUnfSwgInNsb3ciKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLW9wZW4tc2V0dGluZycsICgpID0+IHsKICAgICAgICAgICAgICAgIGJhc2Uuc2hvd1NldHRpbmcoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLXJwYy10YXNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgbGV0IHJwYyA9IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgICAgICBkb21haW46IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX2RvbWFpbicpLAogICAgICAgICAgICAgICAgICAgIHBvcnQ6IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BvcnQnKSwKICAgICAgICAgICAgICAgIH0pLCB1cmwgPSBgJHtwYW4uZH0vP3JwYz0ke2Jhc2UuZShycGMpfSMke2Jhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3Rva2VuJyl9YDsKICAgICAgICAgICAgICAgIEdNX29wZW5JblRhYih1cmwsIHthY3RpdmU6IHRydWV9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKCiAgICAgICAgYWRkQnV0dG9uKCkgewogICAgICAgICAgICBpZiAoIXB0KSByZXR1cm47CiAgICAgICAgICAgIGxldCAkdG9vbFdyYXA7CiAgICAgICAgICAgIGxldCAkYnV0dG9uID0gJChgPGRpdiBjbGFzcz0icXVhcmstYnV0dG9uIHBsLWJ1dHRvbiI+PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiM1NTUiIHN0cm9rZS13aWR0aD0iMiI+PHBhdGggc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBkPSJNOSAxMmwyIDIgMi0yeiIvPjxwYXRoIGQ9Ik0xNCA4aDEuNTUzYy44NSAwIDEuMTYuMDkzIDEuNDcuMjY3LjMxMS4xNzQuNTU2LjQzLjcyMi43NTYuMTY2LjMyNi4yNTUuNjUuMjU1IDEuNTR2NC44NzNjMCAuODkyLS4wODkgMS4yMTUtLjI1NSAxLjU0LS4xNjYuMzI3LS40MS41ODMtLjcyMi43NTctLjMxLjE3NC0uNjIuMjY3LTEuNDcuMjY3SDYuNDQ3Yy0uODUgMC0xLjE2LS4wOTMtMS40Ny0uMjY3YTEuNzc4IDEuNzc4IDAgMDEtLjcyMi0uNzU2Yy0uMTY2LS4zMjYtLjI1NS0uNjUtLjI1NS0xLjU0di00Ljg3M2MwLS44OTIuMDg5LTEuMjE1LjI1NS0xLjU0LjE2Ni0uMzI3LjQxLS41ODMuNzIyLS43NTcuMzEtLjE3NC42Mi0uMjY3IDEuNDctLjI2N0gxMSIvPjxwYXRoIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0iTTExIDN2MTAiLz48L2c+PC9zdmc+PGI+5LiL6L295Yqp5omLPC9iPjx1bCBjbGFzcz0icGwtZHJvcGRvd24tbWVudSI+PGxpIGNsYXNzPSJwbC1kcm9wZG93bi1tZW51LWl0ZW0gcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0iYXBpIj5BUEnkuIvovb08L2xpPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImFyaWEiID5Bcmlh5LiL6L29PC9saT48bGkgY2xhc3M9InBsLWRyb3Bkb3duLW1lbnUtaXRlbSBwbC1idXR0b24tbW9kZSIgZGF0YS1tb2RlPSJycGMiPlJQQ+S4i+i9vTwvbGk+PGxpIGNsYXNzPSJwbC1kcm9wZG93bi1tZW51LWl0ZW0gcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0iY3VybCI+Y1VSTOS4i+i9vTwvbGk+PGxpIGNsYXNzPSJwbC1kcm9wZG93bi1tZW51LWl0ZW0gcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0iYmMiID5CQ+S4i+i9vTwvbGk+PGxpIGNsYXNzPSJwbC1kcm9wZG93bi1tZW51LWl0ZW0gcGwtYnV0dG9uLW1vZGUgbGlzdGVuZXItb3Blbi1zZXR0aW5nIj7liqnmiYvorr7nva48L2xpPiR7cGFuLmNvZGUgPT0gMjAwICYmIHZlcnNpb24gPCBwYW4udmVyc2lvbiA/IHBhbi5uZXcgOiAnJ308L3VsPjwvZGl2PmApOwogICAgICAgICAgICBpZiAocHQgPT09ICdob21lJykgewogICAgICAgICAgICAgICAgYmFzZS5saXN0ZW5FbGVtZW50KHBhbi5idG4uaG9tZSwgKCkgPT4gewogICAgICAgICAgICAgICAgICAgICR0b29sV3JhcCA9ICQocGFuLmJ0bi5ob21lKTsKICAgICAgICAgICAgICAgICAgICAkKCcucGwtYnV0dG9uJykubGVuZ3RoID09PSAwICYmICR0b29sV3JhcC5wcmVwZW5kKCRidXR0b24pOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHB0ID09PSAnc2hhcmUnKSB7CiAgICAgICAgICAgICAgICAkYnV0dG9uLmNzcyh7J21hcmdpbi1yaWdodCc6ICcxMHB4J30pOwogICAgICAgICAgICAgICAgYmFzZS5saXN0ZW5FbGVtZW50KHBhbi5idG4uc2hhcmUsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAkdG9vbFdyYXAgPSAkKHBhbi5idG4uc2hhcmUpOwogICAgICAgICAgICAgICAgICAgICQoJy5wbC1idXR0b24nKS5sZW5ndGggPT09IDAgJiYgJHRvb2xXcmFwLnByZXBlbmQoJGJ1dHRvbik7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGFkZEluaXRCdXR0b24oKSB7CiAgICAgICAgICAgIGlmICghcHQpIHJldHVybjsKICAgICAgICAgICAgbGV0ICR0b29sV3JhcDsKICAgICAgICAgICAgbGV0ICRidXR0b24gPSAkKGA8ZGl2IGNsYXNzPSJxdWFyay1idXR0b24gcGwtYnV0dG9uLWluaXQiPjxzdmcgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlPSIjNTU1IiBzdHJva2Utd2lkdGg9IjIiPjxwYXRoIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0iTTkgMTJsMiAyIDItMnoiLz48cGF0aCBkPSJNMTQgOGgxLjU1M2MuODUgMCAxLjE2LjA5MyAxLjQ3LjI2Ny4zMTEuMTc0LjU1Ni40My43MjIuNzU2LjE2Ni4zMjYuMjU1LjY1LjI1NSAxLjU0djQuODczYzAgLjg5Mi0uMDg5IDEuMjE1LS4yNTUgMS41NC0uMTY2LjMyNy0uNDEuNTgzLS43MjIuNzU3LS4zMS4xNzQtLjYyLjI2Ny0xLjQ3LjI2N0g2LjQ0N2MtLjg1IDAtMS4xNi0uMDkzLTEuNDctLjI2N2ExLjc3OCAxLjc3OCAwIDAxLS43MjItLjc1NmMtLjE2Ni0uMzI2LS4yNTUtLjY1LS4yNTUtMS41NHYtNC44NzNjMC0uODkyLjA4OS0xLjIxNS4yNTUtMS41NC4xNjYtLjMyNy40MS0uNTgzLjcyMi0uNzU3LjMxLS4xNzQuNjItLjI2NyAxLjQ3LS4yNjdIMTEiLz48cGF0aCBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGQ9Ik0xMSAzdjEwIi8+PC9nPjwvc3ZnPjxiPuS4i+i9veWKqeaJizwvYj48L2Rpdj5gKTsKICAgICAgICAgICAgaWYgKHB0ID09PSAnaG9tZScpIHsKICAgICAgICAgICAgICAgIGJhc2UubGlzdGVuRWxlbWVudChwYW4uYnRuLmhvbWUsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAkdG9vbFdyYXAgPSAkKHBhbi5idG4uaG9tZSk7CiAgICAgICAgICAgICAgICAgICAgJCgnLnBsLWJ1dHRvbi1pbml0JykubGVuZ3RoID09PSAwICYmICR0b29sV3JhcC5wcmVwZW5kKCRidXR0b24pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocHQgPT09ICdzaGFyZScpIHsKICAgICAgICAgICAgICAgICRidXR0b24uY3NzKHsnbWFyZ2luLXJpZ2h0JzogJzEwcHgnfSk7CiAgICAgICAgICAgICAgICBiYXNlLmxpc3RlbkVsZW1lbnQocGFuLmJ0bi5zaGFyZSwgKCkgPT4gewogICAgICAgICAgICAgICAgICAgICR0b29sV3JhcCA9ICQocGFuLmJ0bi5zaGFyZSk7CiAgICAgICAgICAgICAgICAgICAgJCgnLnBsLWJ1dHRvbi1pbml0JykubGVuZ3RoID09PSAwICYmICR0b29sV3JhcC5wcmVwZW5kKCRidXR0b24pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgICAgICAkYnV0dG9uLmNsaWNrKCgpID0+IGJhc2UuaW5pdERpYWxvZygpKTsKICAgICAgICB9LAoKICAgICAgICBhc3luYyBnZXRQQ1NMaW5rKCkgewogICAgICAgICAgICBzZWxlY3RMaXN0ID0gdGhpcy5nZXRTZWxlY3RlZExpc3QoKTsKICAgICAgICAgICAgaWYgKHNlbGVjdExpc3QubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZS5lcnJvcign5o+Q56S677ya6K+35YWI5Yu+6YCJ6KaB5LiL6L2955qE5paH5Lu277yBJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHRoaXMuaXNPbmx5Rm9sZGVyKCkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlLmVycm9yKCfmj5DnpLrvvJror7fmiZPlvIDmlofku7blpLnlkI7li77pgInmlofku7bvvIEnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBsZXQgZmlkcyA9IFtdOwogICAgICAgICAgICBzZWxlY3RMaXN0LmZvckVhY2godmFsID0+IHsKICAgICAgICAgICAgICAgIGZpZHMucHVzaCh2YWwuZmlkKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmIChwdCA9PT0gJ2hvbWUnKSB7CiAgICAgICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgYmFzZS5wb3N0KHBhbi5wY3NbMF0sIHsKICAgICAgICAgICAgICAgICAgICAiZmlkcyI6IGZpZHMKICAgICAgICAgICAgICAgIH0sIHsiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtOCIsICJ1c2VyLWFnZW50IjogcGFuLnVhfSk7CiAgICAgICAgICAgICAgICBpZiAocmVzLmNvZGUgPT09IDMxMDAxKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UuZXJyb3IoJ+aPkOekuu+8muivt+WFiOeZu+W9lee9keebmO+8gScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKHJlcy5jb2RlICE9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UuZXJyb3IoJ+aPkOekuu+8muiOt+WPlumTvuaOpeWksei0pe+8gScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGV0IGh0bWwgPSB0aGlzLmdlbmVyYXRlRG9tKHJlcy5kYXRhKTsKICAgICAgICAgICAgICAgIHRoaXMuc2hvd01haW5EaWFsb2cocGFuW21vZGVdWzBdLCBodG1sLCBwYW5bbW9kZV1bMV0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbGV0IGRpYWxvZyA9IGF3YWl0IFN3YWwuZmlyZSh7CiAgICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8nLAogICAgICAgICAgICAgICAgICAgIHRpdGxlOiBg5o+Q56S677ya6K+35bCG5paH5Lu2PHNwYW4gY2xhc3M9InRhZy1kYW5nZXIiPlvkv53lrZjliLDnvZHnm5hdPC9zcGFuPvCfkYnliY3lvoA8c3BhbiBjbGFzcz0idGFnLWRhbmdlciI+W+aIkeeahOe9keebmF08L3NwYW4+5Lit5LiL6L2977yBYCwKICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+eCueWHu+S/neWtmCcsCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICd0b3AnLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBpZiAoZGlhbG9nLmlzQ29uZmlybWVkKSB7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZpbGUtaW5mb19yJykuY2xpY2soKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBnZW5lcmF0ZURvbShsaXN0KSB7CiAgICAgICAgICAgIGxldCBjb250ZW50ID0gJzxkaXYgY2xhc3M9InBsLW1haW4iPic7CiAgICAgICAgICAgIGxldCBhbGlua0FsbFRleHQgPSAnJzsKICAgICAgICAgICAgbGlzdC5mb3JFYWNoKCh2LCBpKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAodi5maWxlID09PSBmYWxzZSkgcmV0dXJuOwogICAgICAgICAgICAgICAgbGV0IGZpbGVuYW1lID0gdi5maWxlX25hbWU7CiAgICAgICAgICAgICAgICBsZXQgZmlkID0gdi5maWQ7CiAgICAgICAgICAgICAgICBsZXQgc2l6ZSA9IGJhc2Uuc2l6ZUZvcm1hdCh2LnNpemUpOwogICAgICAgICAgICAgICAgbGV0IGRsaW5rID0gdi5kb3dubG9hZF91cmw7CiAgICAgICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2FwaScpIHsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9InBsLWl0ZW0tbGluayBsaXN0ZW5lci1saW5rLWFwaSIgZGF0YS1maWQ9IiR7ZmlkfSIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHtkbGlua30iIGRhdGEtaW5kZXg9IiR7aX0iPiR7ZGxpbmt9PC9hPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PmA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2FyaWEnKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGFsaW5rID0gdGhpcy5jb252ZXJ0TGlua1RvQXJpYShkbGluaywgZmlsZW5hbWUsIG5hdmlnYXRvci51c2VyQWdlbnQpOwogICAgICAgICAgICAgICAgICAgIGFsaW5rQWxsVGV4dCArPSBhbGluayArICdcclxuJzsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9InBsLWl0ZW0tbGluayBsaXN0ZW5lci1saW5rLWFyaWEiIGhyZWY9IiR7YWxpbmt9IiB0aXRsZT0i54K55Ye75aSN5Yi2YXJpYTJj6ZO+5o6lIiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2FsaW5rfSI+JHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmspfTwvYT4gPC9kaXY+YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAncnBjJykgewogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJwbC1pdGVtLWxpbmsgbGlzdGVuZXItbGluay1ycGMgcGwtYnRuLXByaW1hcnkgcGwtYnRuLWluZm8iIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7ZGxpbmt9Ij48ZW0gY2xhc3M9Imljb24gaWNvbi1kZXZpY2UiPjwvZW0+PHNwYW4gc3R5bGU9Im1hcmdpbi1sZWZ0OiA1cHg7Ij7mjqjpgIHliLAgUlBDIOS4i+i9veWZqDwvc3Bhbj48L2J1dHRvbj48L2Rpdj5gOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdjdXJsJykgewogICAgICAgICAgICAgICAgICAgIGxldCBhbGluayA9IHRoaXMuY29udmVydExpbmtUb0N1cmwoZGxpbmssIGZpbGVuYW1lLCBuYXZpZ2F0b3IudXNlckFnZW50KTsKICAgICAgICAgICAgICAgICAgICBhbGlua0FsbFRleHQgKz0gYWxpbmsgKyAnXHJcbic7CiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJwbC1pdGVtLWxpbmsgbGlzdGVuZXItbGluay1hcmlhIiBocmVmPSIke2FsaW5rfSIgdGl0bGU9IueCueWHu+WkjeWItmN1cmzpk77mjqUiIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7YWxpbmt9Ij4ke2RlY29kZVVSSUNvbXBvbmVudChhbGluayl9PC9hPiA8L2Rpdj5gOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdiYycpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgYWxpbmsgPSB0aGlzLmNvbnZlcnRMaW5rVG9CQyhkbGluaywgZmlsZW5hbWUsIG5hdmlnYXRvci51c2VyQWdlbnQpOwogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz0icGwtaXRlbS1saW5rIiBocmVmPSIke2RlY29kZVVSSUNvbXBvbmVudChhbGluayl9IiB0aXRsZT0i54K55Ye755So5q+U54m55b2X5pif5LiL6L29IiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2FsaW5rfSI+JHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmspfTwvYT4gPC9kaXY+YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNvbnRlbnQgKz0gJzwvZGl2Pic7CiAgICAgICAgICAgIGlmIChtb2RlID09PSAnYXJpYScpCiAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1leHRyYSI+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgbGlzdGVuZXItY29weS1hbGwiIGRhdGEtbGluaz0iJHthbGlua0FsbFRleHR9Ij7lpI3liLblhajpg6jpk77mjqU8L2J1dHRvbj48L2Rpdj5gOwogICAgICAgICAgICBpZiAobW9kZSA9PT0gJ3JwYycpIHsKICAgICAgICAgICAgICAgIGxldCBycGMgPSBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19kb21haW4nKSArICc6JyArIGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BvcnQnKSArIGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BhdGgnKTsKICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWV4dHJhIj48YnV0dG9uIGNsYXNzPSJwbC1idG4tcHJpbWFyeSBsaXN0ZW5lci1zZW5kLXJwYyI+5Y+R6YCB5YWo6YOo6ZO+5o6lPC9idXR0b24+PGJ1dHRvbiB0aXRsZT0iJHtycGN9IiBjbGFzcz0icGwtYnRuLXByaW1hcnkgcGwtYnRuLXdhcm5pbmcgbGlzdGVuZXItb3Blbi1zZXR0aW5nIiBzdHlsZT0ibWFyZ2luLWxlZnQ6IDEwcHgiPuiuvue9riBSUEMg5Y+C5pWw77yI5b2T5YmN5Li677yaJHtycGN977yJPC9idXR0b24+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgcGwtYnRuLXN1Y2Nlc3MgbGlzdGVuZXItcnBjLXRhc2siIHN0eWxlPSJtYXJnaW4tbGVmdDogMTBweDtkaXNwbGF5OiBub25lIj7mn6XnnIvkuIvovb3ku7vliqE8L2J1dHRvbj48L2Rpdj5gOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChtb2RlID09PSAnY3VybCcpCiAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1leHRyYSI+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgbGlzdGVuZXItY29weS1hbGwiIGRhdGEtbGluaz0iJHthbGlua0FsbFRleHR9Ij7lpI3liLblhajpg6jpk77mjqU8L2J1dHRvbj48YnV0dG9uIGNsYXNzPSJwbC1idG4tcHJpbWFyeSBwbC1idG4td2FybmluZyBsaXN0ZW5lci1vcGVuLXNldHRpbmciIHN0eWxlPSJtYXJnaW4tbGVmdDogMTBweDsiPuiuvue9rue7iOerr+exu+Wei++8iOW9k+WJjeS4uu+8miR7dGVybWluYWxUeXBlW2Jhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfdGVybWluYWxfdHlwZScpXX3vvIk8L2J1dHRvbj48L2Rpdj5gOwogICAgICAgICAgICByZXR1cm4gY29udGVudDsKICAgICAgICB9LAoKICAgICAgICBhc3luYyBzZW5kTGlua1RvUlBDKGZpbGVuYW1lLCBsaW5rKSB7CiAgICAgICAgICAgIGxldCBycGMgPSB7CiAgICAgICAgICAgICAgICBkb21haW46IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX2RvbWFpbicpLAogICAgICAgICAgICAgICAgcG9ydDogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfcG9ydCcpLAogICAgICAgICAgICAgICAgcGF0aDogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfcGF0aCcpLAogICAgICAgICAgICAgICAgdG9rZW46IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3Rva2VuJyksCiAgICAgICAgICAgICAgICBkaXI6IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX2RpcicpLAogICAgICAgICAgICB9OwoKICAgICAgICAgICAgbGV0IHVybCA9IGAke3JwYy5kb21haW59OiR7cnBjLnBvcnR9JHtycGMucGF0aH1gOwogICAgICAgICAgICBsZXQgcnBjRGF0YSA9IHsKICAgICAgICAgICAgICAgIGlkOiBuZXcgRGF0ZSgpLmdldFRpbWUoKSwKICAgICAgICAgICAgICAgIGpzb25ycGM6ICcyLjAnLAogICAgICAgICAgICAgICAgbWV0aG9kOiAnYXJpYTIuYWRkVXJpJywKICAgICAgICAgICAgICAgIHBhcmFtczogW2B0b2tlbjoke3JwYy50b2tlbn1gLCBbbGlua10sIHsKICAgICAgICAgICAgICAgICAgICBkaXI6IHJwYy5kaXIsCiAgICAgICAgICAgICAgICAgICAgb3V0OiBmaWxlbmFtZSwKICAgICAgICAgICAgICAgICAgICBoZWFkZXI6IFtgQ29va2llOiAke2RvY3VtZW50LmNvb2tpZX1gXQogICAgICAgICAgICAgICAgfV0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCBiYXNlLnBvc3QodXJsLCBycGNEYXRhLCB7IkNvb2tpZSI6IGRvY3VtZW50LmNvb2tpZX0sICcnKTsKICAgICAgICAgICAgICAgIGlmIChyZXMucmVzdWx0KSByZXR1cm4gJ3N1Y2Nlc3MnOwogICAgICAgICAgICAgICAgcmV0dXJuICdmYWlsJzsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgcmV0dXJuICdmYWlsJzsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGdldFNlbGVjdGVkTGlzdCgpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGxldCBzZWxlY3RlZExpc3QgPSBbXTsKICAgICAgICAgICAgICAgIGxldCByZWFjdERvbSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2ZpbGUtbGlzdCcpWzBdOwogICAgICAgICAgICAgICAgbGV0IHJlYWN0T2JqID0gYmFzZS5maW5kUmVhY3QocmVhY3REb20pOwogICAgICAgICAgICAgICAgbGV0IHByb3BzID0gcmVhY3RPYmoucHJvcHM7CiAgICAgICAgICAgICAgICBpZiAocHJvcHMpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgZmlsZUxpc3QgPSBwcm9wcy5saXN0IHx8IFtdOwogICAgICAgICAgICAgICAgICAgIGxldCBzZWxlY3RlZEtleXMgPSBwcm9wcy5zZWxlY3RlZFJvd0tleXMgfHwgW107CiAgICAgICAgICAgICAgICAgICAgZmlsZUxpc3QuZm9yRWFjaCgodmFsKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZEtleXMuaW5jbHVkZXModmFsLmZpZCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkTGlzdC5wdXNoKHZhbCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBzZWxlY3RlZExpc3Q7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBbXTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGRldGVjdFBhZ2UoKSB7CiAgICAgICAgICAgIGxldCBwYXRoID0gbG9jYXRpb24ucGF0aG5hbWU7CiAgICAgICAgICAgIGlmICgvXlwvKGxpc3QpLy50ZXN0KHBhdGgpKSByZXR1cm4gJ2hvbWUnOwogICAgICAgICAgICBpZiAoL15cLyhzfHNoYXJlKVwvLy50ZXN0KHBhdGgpKSByZXR1cm4gJ3NoYXJlJzsKICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0sCgogICAgICAgIGlzT25seUZvbGRlcigpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3RMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0TGlzdFtpXS5maWxlKSByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSwKCiAgICAgICAgc2hvd01haW5EaWFsb2codGl0bGUsIGh0bWwsIGZvb3RlcikgewogICAgICAgICAgICBTd2FsLmZpcmUoewogICAgICAgICAgICAgICAgdGl0bGUsCiAgICAgICAgICAgICAgICBodG1sLAogICAgICAgICAgICAgICAgZm9vdGVyLAogICAgICAgICAgICAgICAgYWxsb3dPdXRzaWRlQ2xpY2s6IGZhbHNlLAogICAgICAgICAgICAgICAgc2hvd0Nsb3NlQnV0dG9uOiB0cnVlLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgcG9zaXRpb246ICd0b3AnLAogICAgICAgICAgICAgICAgd2lkdGgsCiAgICAgICAgICAgICAgICBwYWRkaW5nOiAnMTVweCAyMHB4IDVweCcsCiAgICAgICAgICAgICAgICBjdXN0b21DbGFzcywKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKCiAgICAgICAgYXN5bmMgaW5pdFBhbkxpbmtlcigpIHsKICAgICAgICAgICAgYmFzZS5pbml0RGVmYXVsdENvbmZpZygpOwogICAgICAgICAgICBiYXNlLmFkZFBhbkxpbmtlclN0eWxlKCk7CiAgICAgICAgICAgIHB0ID0gdGhpcy5kZXRlY3RQYWdlKCk7CiAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCBiYXNlLnBvc3QKICAgICAgICAgICAgKGBodHRwczovL2FwaS55b3V4aWFvaG91LmNvbS9jb25maWcvdjIvcXVhcms/dmVyPSR7dmVyc2lvbn0mYT0ke2F1dGhvcn1gLCB7fSwge30sICd0ZXh0Jyk7CiAgICAgICAgICAgIHBhbiA9IEpTT04ucGFyc2UoYmFzZS5kKHJlcykpOwogICAgICAgICAgICBPYmplY3QuZnJlZXplICYmIE9iamVjdC5mcmVlemUocGFuKTsKICAgICAgICAgICAgcGFuLm51bSA9PT0gYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19pbml0X2NvZGUnKSB8fAogICAgICAgICAgICBwYW4ubGljZW5zZSA9PT0gYmFzZS5nZXRWYWx1ZSgnbGljZW5zZScpID8gdGhpcy5hZGRCdXR0b24oKSA6IHRoaXMuYWRkSW5pdEJ1dHRvbigpOwogICAgICAgICAgICB0aGlzLmFkZFBhZ2VMaXN0ZW5lcigpOwogICAgICAgICAgICBiYXNlLmNyZWF0ZVRpcCgpOwogICAgICAgICAgICBiYXNlLmNyZWF0ZURvd25sb2FkSWZyYW1lKCk7CiAgICAgICAgICAgIGJhc2UucmVnaXN0ZXJNZW51Q29tbWFuZCgpOwogICAgICAgIH0KICAgIH07CgogICAgbGV0IHlpZG9uZyA9IHsKCiAgICAgICAgY29udmVydExpbmtUb0FyaWEobGluaywgZmlsZW5hbWUsIHVhKSB7CiAgICAgICAgICAgIGZpbGVuYW1lID0gYmFzZS5maXhGaWxlbmFtZShmaWxlbmFtZSk7CiAgICAgICAgICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoYGFyaWEyYyAiJHtsaW5rfSIgLS1vdXQgIiR7ZmlsZW5hbWV9ImApOwogICAgICAgIH0sCgogICAgICAgIGNvbnZlcnRMaW5rVG9CQyhsaW5rLCBmaWxlbmFtZSwgdWEpIHsKICAgICAgICAgICAgbGV0IGJjID0gYEFBLyR7ZW5jb2RlVVJJQ29tcG9uZW50KGZpbGVuYW1lKX0vP3VybD0ke2VuY29kZVVSSUNvbXBvbmVudChsaW5rKX1aWmA7CiAgICAgICAgICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoYGJjOi8vaHR0cC8ke2Jhc2UuZShiYyl9YCk7CiAgICAgICAgfSwKCiAgICAgICAgY29udmVydExpbmtUb0N1cmwobGluaywgZmlsZW5hbWUsIHVhKSB7CiAgICAgICAgICAgIGxldCB0ZXJtaW5hbCA9IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfdGVybWluYWxfdHlwZScpOwogICAgICAgICAgICBmaWxlbmFtZSA9IGJhc2UuZml4RmlsZW5hbWUoZmlsZW5hbWUpOwogICAgICAgICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGAke3Rlcm1pbmFsICE9PSAnd3AnID8gJ2N1cmwnIDogJ2N1cmwuZXhlJ30gLUwgLUMgLSAiJHtsaW5rfSIgLW8gIiR7ZmlsZW5hbWV9ImApOwogICAgICAgIH0sCgogICAgICAgIGFkZFBhZ2VMaXN0ZW5lcigpIHsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcucGwtYnV0dG9uLW1vZGUnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgbW9kZSA9IGUudGFyZ2V0LmRhdGFzZXQubW9kZTsKICAgICAgICAgICAgICAgIFN3YWwuc2hvd0xvYWRpbmcoKTsKICAgICAgICAgICAgICAgIHRoaXMuZ2V0UENTTGluaygpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItbGluay1hcGknLCBhc3luYyAoZSkgPT4gewogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgJCgnI2Rvd25sb2FkSWZyYW1lJykuYXR0cignc3JjJywgZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQubGluayk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1saW5rLWFyaWEsIC5saXN0ZW5lci1jb3B5LWFsbCcsIChlKSA9PiB7CiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICBiYXNlLnNldENsaXBib2FyZChkZWNvZGVVUklDb21wb25lbnQoZS50YXJnZXQuZGF0YXNldC5saW5rKSk7CiAgICAgICAgICAgICAgICAkKGUudGFyZ2V0KS50ZXh0KCflpI3liLbmiJDlip/vvIzlv6vljrvnspjotLTlkKfvvIEnKS5hbmltYXRlKHtvcGFjaXR5OiAnMC41J30sICJzbG93Iik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1saW5rLXJwYycsIGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgdGFyZ2V0ID0gJChlLmN1cnJlbnRUYXJnZXQpOwogICAgICAgICAgICAgICAgdGFyZ2V0LmZpbmQoJy5pY29uJykucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICB0YXJnZXQuZmluZCgnLnBsLWxvYWRpbmcnKS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIHRhcmdldC5wcmVwZW5kKGJhc2UuY3JlYXRlTG9hZGluZygpKTsKICAgICAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCB0aGlzLnNlbmRMaW5rVG9SUEMoZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuZmlsZW5hbWUsIGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmxpbmspOwogICAgICAgICAgICAgICAgaWYgKHJlcyA9PT0gJ3N1Y2Nlc3MnKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnLmxpc3RlbmVyLXJwYy10YXNrJykuc2hvdygpOwogICAgICAgICAgICAgICAgICAgIHRhcmdldC5yZW1vdmVDbGFzcygncGwtYnRuLWRhbmdlcicpLmh0bWwoJ+WPkemAgeaIkOWKn++8jOW/q+WOu+eci+eci+WQp++8gScpLmFuaW1hdGUoe29wYWNpdHk6ICcwLjUnfSwgInNsb3ciKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmFkZENsYXNzKCdwbC1idG4tZGFuZ2VyJykudGV4dCgn5Y+R6YCB5aSx6LSl77yM6K+35qOA5p+l5oKo55qEUlBD6YWN572u5L+h5oGv77yBJykuYW5pbWF0ZSh7b3BhY2l0eTogJzAuNSd9LCAic2xvdyIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItc2VuZC1ycGMnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgJCgnLmxpc3RlbmVyLWxpbmstcnBjJykuY2xpY2soKTsKICAgICAgICAgICAgICAgICQoZS50YXJnZXQpLnRleHQoJ+WPkemAgeWujOaIkO+8jOWPkemAgee7k+aenOingeS4iuaWueaMiemSru+8gScpLmFuaW1hdGUoe29wYWNpdHk6ICcwLjUnfSwgInNsb3ciKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLW9wZW4tc2V0dGluZycsICgpID0+IHsKICAgICAgICAgICAgICAgIGJhc2Uuc2hvd1NldHRpbmcoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLXJwYy10YXNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgbGV0IHJwYyA9IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgICAgICBkb21haW46IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX2RvbWFpbicpLAogICAgICAgICAgICAgICAgICAgIHBvcnQ6IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BvcnQnKSwKICAgICAgICAgICAgICAgIH0pLCB1cmwgPSBgJHtwYW4uZH0vP3JwYz0ke2Jhc2UuZShycGMpfSMke2Jhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3Rva2VuJyl9YDsKICAgICAgICAgICAgICAgIEdNX29wZW5JblRhYih1cmwsIHthY3RpdmU6IHRydWV9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKCiAgICAgICAgYWRkQnV0dG9uKCkgewogICAgICAgICAgICBpZiAoIXB0KSByZXR1cm47CiAgICAgICAgICAgIGxldCAkdG9vbFdyYXA7CiAgICAgICAgICAgIGxldCAkYnV0dG9uID0gJChgPGRpdiBjbGFzcz0ieWlkb25nLWJ1dHRvbiBwbC1idXR0b24iPuS4i+i9veWKqeaJizx1bCBjbGFzcz0icGwtZHJvcGRvd24tbWVudSIgc3R5bGU9InRvcDogMzZweDsiPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImFwaSI+QVBJ5LiL6L29PC9saT48bGkgY2xhc3M9InBsLWRyb3Bkb3duLW1lbnUtaXRlbSBwbC1idXR0b24tbW9kZSIgZGF0YS1tb2RlPSJhcmlhIiA+QXJpYeS4i+i9vTwvbGk+PGxpIGNsYXNzPSJwbC1kcm9wZG93bi1tZW51LWl0ZW0gcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0icnBjIj5SUEPkuIvovb08L2xpPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImN1cmwiPmNVUkzkuIvovb08L2xpPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImJjIiA+QkPkuIvovb08L2xpPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIGxpc3RlbmVyLW9wZW4tc2V0dGluZyI+5Yqp5omL6K6+572uPC9saT4ke3Bhbi5jb2RlID09IDIwMCAmJiB2ZXJzaW9uIDwgcGFuLnZlcnNpb24gPyBwYW4ubmV3IDogJyd9PC91bD48L2Rpdj5gKTsKICAgICAgICAgICAgaWYgKHB0ID09PSAnaG9tZScpIHsKICAgICAgICAgICAgICAgIGJhc2UubGlzdGVuRWxlbWVudChwYW4uYnRuLmhvbWUsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAkdG9vbFdyYXAgPSAkKHBhbi5idG4uaG9tZSk7CiAgICAgICAgICAgICAgICAgICAgJCgnLnBsLWJ1dHRvbicpLmxlbmd0aCA9PT0gMCAmJiAkdG9vbFdyYXAucHJlcGVuZCgkYnV0dG9uKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHB0ID09PSAnc2hhcmUnKSB7CiAgICAgICAgICAgICAgICAkYnV0dG9uLnJlbW92ZUNsYXNzKCd5aWRvbmctYnV0dG9uJykuYWRkQ2xhc3MoJ3lpZG9uZy1zaGFyZS1idXR0b24nKTsKICAgICAgICAgICAgICAgIGJhc2UubGlzdGVuRWxlbWVudChwYW4uYnRuLnNoYXJlLCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgJHRvb2xXcmFwID0gJChwYW4uYnRuLnNoYXJlKTsKICAgICAgICAgICAgICAgICAgICAkKCcucGwtYnV0dG9uJykubGVuZ3RoID09PSAwICYmICR0b29sV3JhcC5wcmVwZW5kKCRidXR0b24pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgICAgICBiYXNlLmNyZWF0ZURvd25sb2FkSWZyYW1lKCk7CiAgICAgICAgICAgIHRoaXMuYWRkUGFnZUxpc3RlbmVyKCk7CiAgICAgICAgfSwKCiAgICAgICAgYWRkSW5pdEJ1dHRvbigpIHsKICAgICAgICAgICAgaWYgKCFwdCkgcmV0dXJuOwogICAgICAgICAgICBsZXQgJHRvb2xXcmFwOwogICAgICAgICAgICBsZXQgJGJ1dHRvbiA9ICQoYDxkaXYgY2xhc3M9InlpZG9uZy1idXR0b24gcGwtYnV0dG9uLWluaXQiPuS4i+i9veWKqeaJizwvZGl2PmApOwogICAgICAgICAgICBpZiAocHQgPT09ICdob21lJykgewogICAgICAgICAgICAgICAgYmFzZS5saXN0ZW5FbGVtZW50KHBhbi5idG4uaG9tZSwgKCkgPT4gewogICAgICAgICAgICAgICAgICAgICR0b29sV3JhcCA9ICQocGFuLmJ0bi5ob21lKTsKICAgICAgICAgICAgICAgICAgICAkKCcucGwtYnV0dG9uLWluaXQnKS5sZW5ndGggPT09IDAgJiYgJHRvb2xXcmFwLnByZXBlbmQoJGJ1dHRvbik7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChwdCA9PT0gJ3NoYXJlJykgewogICAgICAgICAgICAgICAgJGJ1dHRvbi5yZW1vdmVDbGFzcygneWlkb25nLWJ1dHRvbicpLmFkZENsYXNzKCd5aWRvbmctc2hhcmUtYnV0dG9uJyk7CiAgICAgICAgICAgICAgICBiYXNlLmxpc3RlbkVsZW1lbnQocGFuLmJ0bi5zaGFyZSwgKCkgPT4gewogICAgICAgICAgICAgICAgICAgICR0b29sV3JhcCA9ICQocGFuLmJ0bi5zaGFyZSk7CiAgICAgICAgICAgICAgICAgICAgJCgnLnBsLWJ1dHRvbi1pbml0JykubGVuZ3RoID09PSAwICYmICR0b29sV3JhcC5wcmVwZW5kKCRidXR0b24pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgICAgICAkYnV0dG9uLmNsaWNrKCgpID0+IGJhc2UuaW5pdERpYWxvZygpKTsKICAgICAgICB9LAoKICAgICAgICBnZXRSYW5kb21TdHJpbmcobGVuKSB7CiAgICAgICAgICAgIGxlbiA9IGxlbiB8fCAxNjsKICAgICAgICAgICAgbGV0ICRjaGFycyA9ICdBQkNERUZHSEpLTU5QUVJTVFdYWVphYmNkZWZoaWprbW5wcnN0d3h5ejIzNDU2NzgnOwogICAgICAgICAgICBsZXQgbWF4UG9zID0gJGNoYXJzLmxlbmd0aDsKICAgICAgICAgICAgbGV0IHB3ZCA9ICcnOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgICAgICAgICBwd2QgKz0gJGNoYXJzLmNoYXJBdChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBtYXhQb3MpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gcHdkOwogICAgICAgIH0sCgogICAgICAgIHV0b2Ioc3RyKSB7CiAgICAgICAgICAgIGNvbnN0IHUgPSBTdHJpbmcuZnJvbUNoYXJDb2RlOwogICAgICAgICAgICByZXR1cm4gc3RyLnJlcGxhY2UoL1tcdUQ4MDAtXHVEQkZGXVtcdURDMDAtXHVERkZGRl18W15ceDAwLVx4N0ZdL2csICh0KSA9PiB7CiAgICAgICAgICAgICAgICBpZiAodC5sZW5ndGggPCAyKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGUgPSB0LmNoYXJDb2RlQXQoMCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUgPCAxMjggPyB0IDogZSA8IDIwNDggPyB1KDE5MiB8IGUgPj4+IDYpICsgdSgxMjggfCA2MyAmIGUpIDogdSgyMjQgfCBlID4+PiAxMiAmIDE1KSArIHUoMTI4IHwgZSA+Pj4gNiAmIDYzKSArIHUoMTI4IHwgNjMgJiBlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGUgPSA2NTUzNiArIDEwMjQgKiAodC5jaGFyQ29kZUF0KDApIC0gNTUyOTYpICsgKHQuY2hhckNvZGVBdCgxKSAtIDU2MzIwKTsKICAgICAgICAgICAgICAgIHJldHVybiB1KDI0MCB8IGUgPj4+IDE4ICYgNykgKyB1KDEyOCB8IGUgPj4+IDEyICYgNjMpICsgdSgxMjggfCBlID4+PiA2ICYgNjMpICsgdSgxMjggfCA2MyAmIGUpOwogICAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICBnZXRTaWduKGUsIHQsIGEsIG4pIHsKICAgICAgICAgICAgbGV0IHIgPSAiIiwKICAgICAgICAgICAgICAgIGkgPSAiIjsKICAgICAgICAgICAgaWYgKHQpIHsKICAgICAgICAgICAgICAgIGxldCBzID0gT2JqZWN0LmFzc2lnbih7fSwgdCk7CiAgICAgICAgICAgICAgICBpID0gSlNPTi5zdHJpbmdpZnkocyksCiAgICAgICAgICAgICAgICAgICAgaSA9IGkucmVwbGFjZSgvXHMqL2csICIiKSwKICAgICAgICAgICAgICAgICAgICBpID0gZW5jb2RlVVJJQ29tcG9uZW50KGkpOwogICAgICAgICAgICAgICAgbGV0IGMgPSBpLnNwbGl0KCIiKSwKICAgICAgICAgICAgICAgICAgICB1ID0gYy5zb3J0KCk7CiAgICAgICAgICAgICAgICBpID0gdS5qb2luKCIiKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBsZXQgQSA9IG1kNShiYXNlLmUodGhpcy51dG9iKGkpKSk7CiAgICAgICAgICAgIGxldCBsID0gbWQ1KGEgKyAiOiIgKyBuKTsKICAgICAgICAgICAgcmV0dXJuIG1kNShBICsgbCkudG9VcHBlckNhc2UoKTsKICAgICAgICB9LAoKICAgICAgICBhc3luYyBnZXRGaWxlVXJsQnlPbmNlKGl0ZW0sIGluZGV4KSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAoaXRlbS5kb3dubG9hZFVybCkgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICBpbmRleCwKICAgICAgICAgICAgICAgICAgICBkb3dubG9hZFVybDogaXRlbS5kb3dubG9hZFVybAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLmRldGVjdFBhZ2UoKSA9PT0gJ2hvbWUnKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGJvZHkgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICJjb250ZW50SUQiOiBpdGVtLmNvbnRlbnRJRCwKICAgICAgICAgICAgICAgICAgICAgICAgImNvbW1vbkFjY291bnRJbmZvIjogeyJhY2NvdW50IjogaXRlbS5vd25lciwgImFjY291bnRUeXBlIjogMX0sCiAgICAgICAgICAgICAgICAgICAgICAgICJvcGVyYXRpb24iOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJpbmxpbmUiOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJleHRJbmZvIjogeyJpc1JldHVybkNkbkRvd25sb2FkVXJsIjogIjEifQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgbGV0IHRpbWUgPSBuZXcgRGF0ZSgrbmV3IERhdGUoKSArIDggKiAzNjAwICogMTAwMCkudG9KU09OKCkuc3Vic3RyKDAsIDE5KS5yZXBsYWNlKCdUJywgJyAnKTsKICAgICAgICAgICAgICAgICAgICBsZXQga2V5ID0gdGhpcy5nZXRSYW5kb21TdHJpbmcoMTYpOwogICAgICAgICAgICAgICAgICAgIGxldCBzaWduID0gdGhpcy5nZXRTaWduKHVuZGVmaW5lZCwgYm9keSwgdGltZSwga2V5KTsKCiAgICAgICAgICAgICAgICAgICAgbGV0IHJlcyA9IGF3YWl0IGJhc2UucG9zdChwYW4ucGNzWzBdLCBib2R5LCB7CiAgICAgICAgICAgICAgICAgICAgICAgICdhdXRob3JpemF0aW9uJzogYmFzZS5nZXRDb29raWUoJ2F1dGhvcml6YXRpb24nKSwKICAgICAgICAgICAgICAgICAgICAgICAgJ3gtaHVhd2VpLWNoYW5uZWxTcmMnOiAnMTAwMDAwMzQnLAogICAgICAgICAgICAgICAgICAgICAgICAneC1pbm5lci1udHdrJzogJzInLAogICAgICAgICAgICAgICAgICAgICAgICAnbWNsb3VkLWNoYW5uZWwnOiAnMTAwMDEwMScsCiAgICAgICAgICAgICAgICAgICAgICAgICdtY2xvdWQtY2xpZW50JzogJzEwNzAxJywKICAgICAgICAgICAgICAgICAgICAgICAgJ21jbG91ZC1zaWduJzogdGltZSArICIsIiArIGtleSArICIsIiArIHNpZ24sCiAgICAgICAgICAgICAgICAgICAgICAgICdjb250ZW50LXR5cGUnOiAiYXBwbGljYXRpb24vanNvbjtjaGFyc2V0PVVURi04IiwKICAgICAgICAgICAgICAgICAgICAgICAgJ2NhbGxlcic6ICd3ZWInLAogICAgICAgICAgICAgICAgICAgICAgICAnQ01TLURFVklDRSc6ICdkZWZhdWx0JywKICAgICAgICAgICAgICAgICAgICAgICAgJ3gtRGV2aWNlSW5mbyc6ICd8fDl8Ny4xMi4wfGNocm9tZXwxMTguMC4wLjB8fHdpbmRvd3MgMTB8fHpoLUNOfHx8JywKICAgICAgICAgICAgICAgICAgICAgICAgJ3gtU3ZjVHlwZSc6ICcxJywKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRVcmw6IHJlcy5kYXRhLmRvd25sb2FkVVJMCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRVcmw6ICfojrflj5bkuIvovb3lnLDlnYDlpLHotKXvvIzor7fliLfmlrDph43or5XvvIEnCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKHRoaXMuZGV0ZWN0UGFnZSgpID09PSAnc2hhcmUnKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHZ1ZURvbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5tYWluX2ZpbGVfbGlzdCIpLl9fdnVlX187CgogICAgICAgICAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCBiYXNlLnBvc3QocGFuLnBjc1sxXSwgYGxpbmtJZD0ke3Z1ZURvbS5saW5rSUR9JmNvbnRlbnRJZHM9JHtpdGVtLnBhdGh9JmNhdGFsb2dJZHM9YCwgewogICAgICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcsCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5jb2RlID09PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkVXJsOiByZXMuZGF0YS5yZWRyVXJsCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRVcmw6ICfojrflj5bkuIvovb3lnLDlnYDlpLHotKXvvIzor7fliLfmlrDph43or5XvvIEnCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgIGluZGV4LAogICAgICAgICAgICAgICAgICAgIGRvd25sb2FkVXJsOiAn6I635Y+W5LiL6L295Zyw5Z2A5aSx6LSl77yM6K+35Yi35paw6YeN6K+V77yBJwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGFzeW5jIGdldFBDU0xpbmsoKSB7CiAgICAgICAgICAgIHNlbGVjdExpc3QgPSB0aGlzLmdldFNlbGVjdGVkTGlzdCgpOwogICAgICAgICAgICBpZiAoc2VsZWN0TGlzdC5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlLmVycm9yKCfmj5DnpLrvvJror7flhYjli77pgInopoHkuIvovb3nmoTmlofku7bvvIEnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAodGhpcy5pc09ubHlGb2xkZXIoKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UuZXJyb3IoJ+aPkOekuu+8muivt+aJk+W8gOaWh+S7tuWkueWQjuWLvumAieaWh+S7tu+8gScpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBsZXQgcXVldWUgPSBbXTsKICAgICAgICAgICAgc2VsZWN0TGlzdC5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4gewogICAgICAgICAgICAgICAgcXVldWUucHVzaCh0aGlzLmdldEZpbGVVcmxCeU9uY2UoaXRlbSwgaW5kZXgpKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBQcm9taXNlLmFsbChxdWV1ZSk7CiAgICAgICAgICAgIHJlcy5mb3JFYWNoKHZhbCA9PiB7CiAgICAgICAgICAgICAgICBzZWxlY3RMaXN0W3ZhbC5pbmRleF0uZG93bmxvYWRVcmwgPSB2YWwuZG93bmxvYWRVcmw7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgbGV0IGh0bWwgPSB0aGlzLmdlbmVyYXRlRG9tKHNlbGVjdExpc3QpOwogICAgICAgICAgICB0aGlzLnNob3dNYWluRGlhbG9nKHBhblttb2RlXVswXSwgaHRtbCwgcGFuW21vZGVdWzFdKTsKICAgICAgICB9LAoKICAgICAgICBnZW5lcmF0ZURvbShsaXN0KSB7CiAgICAgICAgICAgIGxldCBjb250ZW50ID0gJzxkaXYgY2xhc3M9InBsLW1haW4iPic7CiAgICAgICAgICAgIGxldCBhbGlua0FsbFRleHQgPSAnJzsKICAgICAgICAgICAgbGlzdC5mb3JFYWNoKCh2LCBpKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAodi5kaXJFdGFnIHx8IHYuY2FOYW1lKSByZXR1cm47CiAgICAgICAgICAgICAgICBsZXQgZmlsZW5hbWUgPSB2LmNvbnRlbnROYW1lIHx8IHYuY29OYW1lOwogICAgICAgICAgICAgICAgbGV0IHNpemUgPSBiYXNlLnNpemVGb3JtYXQodi5jb250ZW50U2l6ZSB8fCB2LmNvU2l6ZSk7CiAgICAgICAgICAgICAgICBsZXQgZGxpbmsgPSB2LmRvd25sb2FkVXJsOwogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdhcGknKSB7CiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJwbC1pdGVtLWxpbmsgbGlzdGVuZXItbGluay1hcGkiIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7ZGxpbmt9IiBkYXRhLWluZGV4PSIke2l9Ij4ke2RsaW5rfTwvYT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdhcmlhJykgewogICAgICAgICAgICAgICAgICAgIGxldCBhbGluayA9IHRoaXMuY29udmVydExpbmtUb0FyaWEoZGxpbmssIGZpbGVuYW1lLCBuYXZpZ2F0b3IudXNlckFnZW50KTsKICAgICAgICAgICAgICAgICAgICBhbGlua0FsbFRleHQgKz0gYWxpbmsgKyAnXHJcbic7CiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJwbC1pdGVtLWxpbmsgbGlzdGVuZXItbGluay1hcmlhIiBocmVmPSIke2FsaW5rfSIgdGl0bGU9IueCueWHu+WkjeWItmFyaWEyY+mTvuaOpSIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHthbGlua30iPiR7ZGVjb2RlVVJJQ29tcG9uZW50KGFsaW5rKX08L2E+IDwvZGl2PmA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAobW9kZSA9PT0gJ3JwYycpIHsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0icGwtaXRlbS1saW5rIGxpc3RlbmVyLWxpbmstcnBjIHBsLWJ0bi1wcmltYXJ5IHBsLWJ0bi1pbmZvIiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2RsaW5rfSI+PGVtIGNsYXNzPSJpY29uIGljb24tZGV2aWNlIj48L2VtPjxzcGFuIHN0eWxlPSJtYXJnaW4tbGVmdDogNXB4OyI+5o6o6YCB5YiwIFJQQyDkuIvovb3lmag8L3NwYW4+PC9idXR0b24+PC9kaXY+YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAnY3VybCcpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgYWxpbmsgPSB0aGlzLmNvbnZlcnRMaW5rVG9DdXJsKGRsaW5rLCBmaWxlbmFtZSwgbmF2aWdhdG9yLnVzZXJBZ2VudCk7CiAgICAgICAgICAgICAgICAgICAgYWxpbmtBbGxUZXh0ICs9IGFsaW5rICsgJ1xyXG4nOwogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz0icGwtaXRlbS1saW5rIGxpc3RlbmVyLWxpbmstYXJpYSIgaHJlZj0iJHthbGlua30iIHRpdGxlPSLngrnlh7vlpI3liLZjdXJs6ZO+5o6lIiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2FsaW5rfSI+JHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmspfTwvYT4gPC9kaXY+YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAnYmMnKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGFsaW5rID0gdGhpcy5jb252ZXJ0TGlua1RvQkMoZGxpbmssIGZpbGVuYW1lLCBuYXZpZ2F0b3IudXNlckFnZW50KTsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9InBsLWl0ZW0tbGluayIgaHJlZj0iJHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmspfSIgdGl0bGU9IueCueWHu+eUqOavlOeJueW9l+aYn+S4i+i9vSIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHthbGlua30iPiR7ZGVjb2RlVVJJQ29tcG9uZW50KGFsaW5rKX08L2E+IDwvZGl2PmA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjb250ZW50ICs9ICc8L2Rpdj4nOwogICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2FyaWEnKQogICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtZXh0cmEiPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IGxpc3RlbmVyLWNvcHktYWxsIiBkYXRhLWxpbms9IiR7YWxpbmtBbGxUZXh0fSI+5aSN5Yi25YWo6YOo6ZO+5o6lPC9idXR0b24+PC9kaXY+YDsKICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdycGMnKSB7CiAgICAgICAgICAgICAgICBsZXQgcnBjID0gYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfZG9tYWluJykgKyAnOicgKyBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wb3J0JykgKyBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wYXRoJyk7CiAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1leHRyYSI+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgbGlzdGVuZXItc2VuZC1ycGMiPuWPkemAgeWFqOmDqOmTvuaOpTwvYnV0dG9uPjxidXR0b24gdGl0bGU9IiR7cnBjfSIgY2xhc3M9InBsLWJ0bi1wcmltYXJ5IHBsLWJ0bi13YXJuaW5nIGxpc3RlbmVyLW9wZW4tc2V0dGluZyIgc3R5bGU9Im1hcmdpbi1sZWZ0OiAxMHB4Ij7orr7nva4gUlBDIOWPguaVsO+8iOW9k+WJjeS4uu+8miR7cnBjfe+8iTwvYnV0dG9uPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IHBsLWJ0bi1zdWNjZXNzIGxpc3RlbmVyLXJwYy10YXNrIiBzdHlsZT0ibWFyZ2luLWxlZnQ6IDEwcHg7ZGlzcGxheTogbm9uZSI+5p+l55yL5LiL6L295Lu75YqhPC9idXR0b24+PC9kaXY+YDsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2N1cmwnKQogICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtZXh0cmEiPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IGxpc3RlbmVyLWNvcHktYWxsIiBkYXRhLWxpbms9IiR7YWxpbmtBbGxUZXh0fSI+5aSN5Yi25YWo6YOo6ZO+5o6lPC9idXR0b24+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgcGwtYnRuLXdhcm5pbmcgbGlzdGVuZXItb3Blbi1zZXR0aW5nIiBzdHlsZT0ibWFyZ2luLWxlZnQ6IDEwcHg7Ij7orr7nva7nu4jnq6/nsbvlnovvvIjlvZPliY3kuLrvvJoke3Rlcm1pbmFsVHlwZVtiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3Rlcm1pbmFsX3R5cGUnKV1977yJPC9idXR0b24+PC9kaXY+YDsKICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnQ7CiAgICAgICAgfSwKCiAgICAgICAgYXN5bmMgc2VuZExpbmtUb1JQQyhmaWxlbmFtZSwgbGluaykgewogICAgICAgICAgICBsZXQgcnBjID0gewogICAgICAgICAgICAgICAgZG9tYWluOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19kb21haW4nKSwKICAgICAgICAgICAgICAgIHBvcnQ6IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BvcnQnKSwKICAgICAgICAgICAgICAgIHBhdGg6IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BhdGgnKSwKICAgICAgICAgICAgICAgIHRva2VuOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY190b2tlbicpLAogICAgICAgICAgICAgICAgZGlyOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19kaXInKSwKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGxldCB1cmwgPSBgJHtycGMuZG9tYWlufToke3JwYy5wb3J0fSR7cnBjLnBhdGh9YDsKICAgICAgICAgICAgbGV0IHJwY0RhdGEgPSB7CiAgICAgICAgICAgICAgICBpZDogbmV3IERhdGUoKS5nZXRUaW1lKCksCiAgICAgICAgICAgICAgICBqc29ucnBjOiAnMi4wJywKICAgICAgICAgICAgICAgIG1ldGhvZDogJ2FyaWEyLmFkZFVyaScsCiAgICAgICAgICAgICAgICBwYXJhbXM6IFtgdG9rZW46JHtycGMudG9rZW59YCwgW2xpbmtdLCB7CiAgICAgICAgICAgICAgICAgICAgZGlyOiBycGMuZGlyLAogICAgICAgICAgICAgICAgICAgIG91dDogZmlsZW5hbWUsCiAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiBbXQogICAgICAgICAgICAgICAgfV0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCBiYXNlLnBvc3QodXJsLCBycGNEYXRhLCB7fSwgJycpOwogICAgICAgICAgICAgICAgaWYgKHJlcy5yZXN1bHQpIHJldHVybiAnc3VjY2Vzcyc7CiAgICAgICAgICAgICAgICByZXR1cm4gJ2ZhaWwnOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gJ2ZhaWwnOwogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgZ2V0U2VsZWN0ZWRMaXN0KCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5tYWluX2ZpbGVfbGlzdCIpLl9fdnVlX18uc2VsZWN0TGlzdC5tYXAodmFsID0+IHZhbC5pdGVtKTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgbGV0IHZ1ZURvbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5ob21lLXBhZ2UiKS5fX3Z1ZV9fOwogICAgICAgICAgICAgICAgbGV0IGZpbGVMaXN0ID0gdnVlRG9tLl9jb21wdXRlZFdhdGNoZXJzLmZpbGVMaXN0LnZhbHVlOwogICAgICAgICAgICAgICAgbGV0IGRpckxpc3QgPSB2dWVEb20uX2NvbXB1dGVkV2F0Y2hlcnMuZGlyTGlzdC52YWx1ZTsKICAgICAgICAgICAgICAgIGxldCBzZWxlY3RlZEZpbGVJbmRleCA9IHZ1ZURvbS5zZWxlY3RlZEZpbGU7CiAgICAgICAgICAgICAgICBsZXQgc2VsZWN0ZWREaXJJbmRleCA9IHZ1ZURvbS5zZWxlY3RlZERpcjsKICAgICAgICAgICAgICAgIGxldCBzZWxlY3RGaWxlTGlzdCA9IGZpbGVMaXN0LmZpbHRlcigodiwgaSkgPT4gewogICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxlY3RlZEZpbGVJbmRleC5pbmNsdWRlcyhpKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbGV0IHNlbGVjdERpckxpc3QgPSBkaXJMaXN0LmZpbHRlcigodiwgaSkgPT4gewogICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxlY3RlZERpckluZGV4LmluY2x1ZGVzKGkpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm4gWy4uLnNlbGVjdEZpbGVMaXN0LCAuLi5zZWxlY3REaXJMaXN0XTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGRldGVjdFBhZ2UoKSB7CiAgICAgICAgICAgIGxldCBwYXRoID0gbG9jYXRpb24ucGF0aG5hbWU7CiAgICAgICAgICAgIGlmICgvXlwvdy8udGVzdChwYXRoKSkgcmV0dXJuICdob21lJzsKICAgICAgICAgICAgaWYgKC9eXC9saW5rfHNoYXJld2ViLy50ZXN0KHBhdGgpKSByZXR1cm4gJ3NoYXJlJzsKICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0sCgogICAgICAgIGlzT25seUZvbGRlcigpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3RMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0TGlzdFtpXS5maWxlRXRhZyB8fCBzZWxlY3RMaXN0W2ldLmNvTmFtZSkgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0sCgogICAgICAgIHNob3dNYWluRGlhbG9nKHRpdGxlLCBodG1sLCBmb290ZXIpIHsKICAgICAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgICAgICAgIHRpdGxlLAogICAgICAgICAgICAgICAgaHRtbCwKICAgICAgICAgICAgICAgIGZvb3RlciwKICAgICAgICAgICAgICAgIGFsbG93T3V0c2lkZUNsaWNrOiBmYWxzZSwKICAgICAgICAgICAgICAgIHNob3dDbG9zZUJ1dHRvbjogdHJ1ZSwKICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wJywKICAgICAgICAgICAgICAgIHdpZHRoLAogICAgICAgICAgICAgICAgcGFkZGluZzogJzE1cHggMjBweCA1cHgnLAogICAgICAgICAgICAgICAgY3VzdG9tQ2xhc3MsCiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIGFzeW5jIGluaXRQYW5MaW5rZXIoKSB7CiAgICAgICAgICAgIGJhc2UuaW5pdERlZmF1bHRDb25maWcoKTsKICAgICAgICAgICAgYmFzZS5hZGRQYW5MaW5rZXJTdHlsZSgpOwogICAgICAgICAgICBwdCA9IHRoaXMuZGV0ZWN0UGFnZSgpOwogICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgYmFzZS5wb3N0CiAgICAgICAgICAgIChgaHR0cHM6Ly9hcGkueW91eGlhb2hvdS5jb20vY29uZmlnL3YyL3lpZG9uZz92ZXI9JHt2ZXJzaW9ufSZhPSR7YXV0aG9yfWAsIHt9LCB7fSwgJ3RleHQnKTsKICAgICAgICAgICAgcGFuID0gSlNPTi5wYXJzZShiYXNlLmQocmVzKSk7CiAgICAgICAgICAgIE9iamVjdC5mcmVlemUgJiYgT2JqZWN0LmZyZWV6ZShwYW4pOwogICAgICAgICAgICBwYW4ubnVtID09PSBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX2luaXRfY29kZScpIHx8CiAgICAgICAgICAgIHBhbi5saWNlbnNlID09PSBiYXNlLmdldFZhbHVlKCdsaWNlbnNlJykgPyB0aGlzLmFkZEJ1dHRvbigpIDogdGhpcy5hZGRJbml0QnV0dG9uKCk7CiAgICAgICAgICAgIGJhc2UuY3JlYXRlVGlwKCk7CiAgICAgICAgICAgIGJhc2UucmVnaXN0ZXJNZW51Q29tbWFuZCgpOwogICAgICAgIH0KICAgIH07CgogICAgbGV0IG1haW4gPSB7CiAgICAgICAgaW5pdCgpIHsKICAgICAgICAgICAgaWYgKC8ocGFufHl1bikuYmFpZHUuY29tLy50ZXN0KGxvY2F0aW9uLmhvc3QpKSB7CiAgICAgICAgICAgICAgICBiYWlkdS5pbml0UGFuTGlua2VyKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKC9vcGVuYXBpLmJhaWR1LmNvbVwvb2F1dGgvLnRlc3QobG9jYXRpb24uaHJlZikpIHsKICAgICAgICAgICAgICAgIGJhaWR1LmluaXRBdXRob3JpemUoKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICgvd3d3LihhbGl5dW5kcml2ZXxhbGlwYW4pLmNvbS8udGVzdChsb2NhdGlvbi5ob3N0KSkgewogICAgICAgICAgICAgICAgYWxpLmluaXRQYW5MaW5rZXIoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoL2Nsb3VkLjE4OS5jbi8udGVzdChsb2NhdGlvbi5ob3N0KSkgewogICAgICAgICAgICAgICAgdGlhbnlpLmluaXRQYW5MaW5rZXIoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoL3Bhbi54dW5sZWkuY29tLy50ZXN0KGxvY2F0aW9uLmhvc3QpKSB7CiAgICAgICAgICAgICAgICB4dW5sZWkuaW5pdFBhbkxpbmtlcigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICgvcGFuLnF1YXJrLmNuLy50ZXN0KGxvY2F0aW9uLmhvc3QpKSB7CiAgICAgICAgICAgICAgICBxdWFyay5pbml0UGFuTGlua2VyKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKC8oeXVufGNhaXl1bikuMTM5LmNvbS8udGVzdChsb2NhdGlvbi5ob3N0KSkgewogICAgICAgICAgICAgICAgeWlkb25nLmluaXRQYW5MaW5rZXIoKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH07CgogICAgbWFpbi5pbml0KCk7Cn0pKCk7Cg==","requires":[{"meta":{"name":"jquery.min.js","url":"https://unpkg.com/jquery@3.7.0/dist/jquery.min.js","ts":1734258410921,"mimetype":"text/javascript"},"source":"LyohIGpRdWVyeSB2My43LjAgfCAoYykgT3BlbkpTIEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycyB8IGpxdWVyeS5vcmcvbGljZW5zZSAqLwohZnVuY3Rpb24oZSx0KXsidXNlIHN0cmljdCI7Im9iamVjdCI9PXR5cGVvZiBtb2R1bGUmJiJvYmplY3QiPT10eXBlb2YgbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9ZS5kb2N1bWVudD90KGUsITApOmZ1bmN0aW9uKGUpe2lmKCFlLmRvY3VtZW50KXRocm93IG5ldyBFcnJvcigialF1ZXJ5IHJlcXVpcmVzIGEgd2luZG93IHdpdGggYSBkb2N1bWVudCIpO3JldHVybiB0KGUpfTp0KGUpfSgidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6dGhpcyxmdW5jdGlvbihpZSxlKXsidXNlIHN0cmljdCI7dmFyIG9lPVtdLHI9T2JqZWN0LmdldFByb3RvdHlwZU9mLGFlPW9lLnNsaWNlLGc9b2UuZmxhdD9mdW5jdGlvbihlKXtyZXR1cm4gb2UuZmxhdC5jYWxsKGUpfTpmdW5jdGlvbihlKXtyZXR1cm4gb2UuY29uY2F0LmFwcGx5KFtdLGUpfSxzPW9lLnB1c2gsc2U9b2UuaW5kZXhPZixuPXt9LGk9bi50b1N0cmluZyx1ZT1uLmhhc093blByb3BlcnR5LG89dWUudG9TdHJpbmcsYT1vLmNhbGwoT2JqZWN0KSxsZT17fSx2PWZ1bmN0aW9uKGUpe3JldHVybiJmdW5jdGlvbiI9PXR5cGVvZiBlJiYibnVtYmVyIiE9dHlwZW9mIGUubm9kZVR5cGUmJiJmdW5jdGlvbiIhPXR5cGVvZiBlLml0ZW19LHk9ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGwhPWUmJmU9PT1lLndpbmRvd30sQz1pZS5kb2N1bWVudCx1PXt0eXBlOiEwLHNyYzohMCxub25jZTohMCxub01vZHVsZTohMH07ZnVuY3Rpb24gbShlLHQsbil7dmFyIHIsaSxvPShuPW58fEMpLmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpO2lmKG8udGV4dD1lLHQpZm9yKHIgaW4gdSkoaT10W3JdfHx0LmdldEF0dHJpYnV0ZSYmdC5nZXRBdHRyaWJ1dGUocikpJiZvLnNldEF0dHJpYnV0ZShyLGkpO24uaGVhZC5hcHBlbmRDaGlsZChvKS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG8pfWZ1bmN0aW9uIHgoZSl7cmV0dXJuIG51bGw9PWU/ZSsiIjoib2JqZWN0Ij09dHlwZW9mIGV8fCJmdW5jdGlvbiI9PXR5cGVvZiBlP25baS5jYWxsKGUpXXx8Im9iamVjdCI6dHlwZW9mIGV9dmFyIHQ9IjMuNy4wIixsPS9IVE1MJC9pLGNlPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIG5ldyBjZS5mbi5pbml0KGUsdCl9O2Z1bmN0aW9uIGMoZSl7dmFyIHQ9ISFlJiYibGVuZ3RoImluIGUmJmUubGVuZ3RoLG49eChlKTtyZXR1cm4hdihlKSYmIXkoZSkmJigiYXJyYXkiPT09bnx8MD09PXR8fCJudW1iZXIiPT10eXBlb2YgdCYmMDx0JiZ0LTEgaW4gZSl9ZnVuY3Rpb24gZmUoZSx0KXtyZXR1cm4gZS5ub2RlTmFtZSYmZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09dC50b0xvd2VyQ2FzZSgpfWNlLmZuPWNlLnByb3RvdHlwZT17anF1ZXJ5OnQsY29uc3RydWN0b3I6Y2UsbGVuZ3RoOjAsdG9BcnJheTpmdW5jdGlvbigpe3JldHVybiBhZS5jYWxsKHRoaXMpfSxnZXQ6ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGw9PWU/YWUuY2FsbCh0aGlzKTplPDA/dGhpc1tlK3RoaXMubGVuZ3RoXTp0aGlzW2VdfSxwdXNoU3RhY2s6ZnVuY3Rpb24oZSl7dmFyIHQ9Y2UubWVyZ2UodGhpcy5jb25zdHJ1Y3RvcigpLGUpO3JldHVybiB0LnByZXZPYmplY3Q9dGhpcyx0fSxlYWNoOmZ1bmN0aW9uKGUpe3JldHVybiBjZS5lYWNoKHRoaXMsZSl9LG1hcDpmdW5jdGlvbihuKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soY2UubWFwKHRoaXMsZnVuY3Rpb24oZSx0KXtyZXR1cm4gbi5jYWxsKGUsdCxlKX0pKX0sc2xpY2U6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soYWUuYXBwbHkodGhpcyxhcmd1bWVudHMpKX0sZmlyc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lcSgwKX0sbGFzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVxKC0xKX0sZXZlbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLnB1c2hTdGFjayhjZS5ncmVwKHRoaXMsZnVuY3Rpb24oZSx0KXtyZXR1cm4odCsxKSUyfSkpfSxvZGQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soY2UuZ3JlcCh0aGlzLGZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQlMn0pKX0sZXE6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5sZW5ndGgsbj0rZSsoZTwwP3Q6MCk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKDA8PW4mJm48dD9bdGhpc1tuXV06W10pfSxlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcmV2T2JqZWN0fHx0aGlzLmNvbnN0cnVjdG9yKCl9LHB1c2g6cyxzb3J0Om9lLnNvcnQsc3BsaWNlOm9lLnNwbGljZX0sY2UuZXh0ZW5kPWNlLmZuLmV4dGVuZD1mdW5jdGlvbigpe3ZhciBlLHQsbixyLGksbyxhPWFyZ3VtZW50c1swXXx8e30scz0xLHU9YXJndW1lbnRzLmxlbmd0aCxsPSExO2ZvcigiYm9vbGVhbiI9PXR5cGVvZiBhJiYobD1hLGE9YXJndW1lbnRzW3NdfHx7fSxzKyspLCJvYmplY3QiPT10eXBlb2YgYXx8dihhKXx8KGE9e30pLHM9PT11JiYoYT10aGlzLHMtLSk7czx1O3MrKylpZihudWxsIT0oZT1hcmd1bWVudHNbc10pKWZvcih0IGluIGUpcj1lW3RdLCJfX3Byb3RvX18iIT09dCYmYSE9PXImJihsJiZyJiYoY2UuaXNQbGFpbk9iamVjdChyKXx8KGk9QXJyYXkuaXNBcnJheShyKSkpPyhuPWFbdF0sbz1pJiYhQXJyYXkuaXNBcnJheShuKT9bXTppfHxjZS5pc1BsYWluT2JqZWN0KG4pP246e30saT0hMSxhW3RdPWNlLmV4dGVuZChsLG8scikpOnZvaWQgMCE9PXImJihhW3RdPXIpKTtyZXR1cm4gYX0sY2UuZXh0ZW5kKHtleHBhbmRvOiJqUXVlcnkiKyh0K01hdGgucmFuZG9tKCkpLnJlcGxhY2UoL1xEL2csIiIpLGlzUmVhZHk6ITAsZXJyb3I6ZnVuY3Rpb24oZSl7dGhyb3cgbmV3IEVycm9yKGUpfSxub29wOmZ1bmN0aW9uKCl7fSxpc1BsYWluT2JqZWN0OmZ1bmN0aW9uKGUpe3ZhciB0LG47cmV0dXJuISghZXx8IltvYmplY3QgT2JqZWN0XSIhPT1pLmNhbGwoZSkpJiYoISh0PXIoZSkpfHwiZnVuY3Rpb24iPT10eXBlb2Yobj11ZS5jYWxsKHQsImNvbnN0cnVjdG9yIikmJnQuY29uc3RydWN0b3IpJiZvLmNhbGwobik9PT1hKX0saXNFbXB0eU9iamVjdDpmdW5jdGlvbihlKXt2YXIgdDtmb3IodCBpbiBlKXJldHVybiExO3JldHVybiEwfSxnbG9iYWxFdmFsOmZ1bmN0aW9uKGUsdCxuKXttKGUse25vbmNlOnQmJnQubm9uY2V9LG4pfSxlYWNoOmZ1bmN0aW9uKGUsdCl7dmFyIG4scj0wO2lmKGMoZSkpe2ZvcihuPWUubGVuZ3RoO3I8bjtyKyspaWYoITE9PT10LmNhbGwoZVtyXSxyLGVbcl0pKWJyZWFrfWVsc2UgZm9yKHIgaW4gZSlpZighMT09PXQuY2FsbChlW3JdLHIsZVtyXSkpYnJlYWs7cmV0dXJuIGV9LHRleHQ6ZnVuY3Rpb24oZSl7dmFyIHQsbj0iIixyPTAsaT1lLm5vZGVUeXBlO2lmKGkpe2lmKDE9PT1pfHw5PT09aXx8MTE9PT1pKXJldHVybiBlLnRleHRDb250ZW50O2lmKDM9PT1pfHw0PT09aSlyZXR1cm4gZS5ub2RlVmFsdWV9ZWxzZSB3aGlsZSh0PWVbcisrXSluKz1jZS50ZXh0KHQpO3JldHVybiBufSxtYWtlQXJyYXk6ZnVuY3Rpb24oZSx0KXt2YXIgbj10fHxbXTtyZXR1cm4gbnVsbCE9ZSYmKGMoT2JqZWN0KGUpKT9jZS5tZXJnZShuLCJzdHJpbmciPT10eXBlb2YgZT9bZV06ZSk6cy5jYWxsKG4sZSkpLG59LGluQXJyYXk6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBudWxsPT10Py0xOnNlLmNhbGwodCxlLG4pfSxpc1hNTERvYzpmdW5jdGlvbihlKXt2YXIgdD1lJiZlLm5hbWVzcGFjZVVSSSxuPWUmJihlLm93bmVyRG9jdW1lbnR8fGUpLmRvY3VtZW50RWxlbWVudDtyZXR1cm4hbC50ZXN0KHR8fG4mJm4ubm9kZU5hbWV8fCJIVE1MIil9LG1lcmdlOmZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPSt0Lmxlbmd0aCxyPTAsaT1lLmxlbmd0aDtyPG47cisrKWVbaSsrXT10W3JdO3JldHVybiBlLmxlbmd0aD1pLGV9LGdyZXA6ZnVuY3Rpb24oZSx0LG4pe2Zvcih2YXIgcj1bXSxpPTAsbz1lLmxlbmd0aCxhPSFuO2k8bztpKyspIXQoZVtpXSxpKSE9PWEmJnIucHVzaChlW2ldKTtyZXR1cm4gcn0sbWFwOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG89MCxhPVtdO2lmKGMoZSkpZm9yKHI9ZS5sZW5ndGg7bzxyO28rKyludWxsIT0oaT10KGVbb10sbyxuKSkmJmEucHVzaChpKTtlbHNlIGZvcihvIGluIGUpbnVsbCE9KGk9dChlW29dLG8sbikpJiZhLnB1c2goaSk7cmV0dXJuIGcoYSl9LGd1aWQ6MSxzdXBwb3J0OmxlfSksImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmKGNlLmZuW1N5bWJvbC5pdGVyYXRvcl09b2VbU3ltYm9sLml0ZXJhdG9yXSksY2UuZWFjaCgiQm9vbGVhbiBOdW1iZXIgU3RyaW5nIEZ1bmN0aW9uIEFycmF5IERhdGUgUmVnRXhwIE9iamVjdCBFcnJvciBTeW1ib2wiLnNwbGl0KCIgIiksZnVuY3Rpb24oZSx0KXtuWyJbb2JqZWN0ICIrdCsiXSJdPXQudG9Mb3dlckNhc2UoKX0pO3ZhciBwZT1vZS5wb3AsZGU9b2Uuc29ydCxoZT1vZS5zcGxpY2UsZ2U9IltcXHgyMFxcdFxcclxcblxcZl0iLHZlPW5ldyBSZWdFeHAoIl4iK2dlKyIrfCgoPzpefFteXFxcXF0pKD86XFxcXC4pKikiK2dlKyIrJCIsImciKTtjZS5jb250YWlucz1mdW5jdGlvbihlLHQpe3ZhciBuPXQmJnQucGFyZW50Tm9kZTtyZXR1cm4gZT09PW58fCEoIW58fDEhPT1uLm5vZGVUeXBlfHwhKGUuY29udGFpbnM/ZS5jb250YWlucyhuKTplLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uJiYxNiZlLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKG4pKSl9O3ZhciBmPS8oW1wwLVx4MWZceDdmXXxeLT9cZCl8Xi0kfFteXHg4MC1cdUZGRkZcdy1dL2c7ZnVuY3Rpb24gcChlLHQpe3JldHVybiB0PyJcMCI9PT1lPyJcdWZmZmQiOmUuc2xpY2UoMCwtMSkrIlxcIitlLmNoYXJDb2RlQXQoZS5sZW5ndGgtMSkudG9TdHJpbmcoMTYpKyIgIjoiXFwiK2V9Y2UuZXNjYXBlU2VsZWN0b3I9ZnVuY3Rpb24oZSl7cmV0dXJuKGUrIiIpLnJlcGxhY2UoZixwKX07dmFyIHllPUMsbWU9czshZnVuY3Rpb24oKXt2YXIgZSxiLHcsbyxhLFQscixDLGQsaSxrPW1lLFM9Y2UuZXhwYW5kbyxFPTAsbj0wLHM9VygpLGM9VygpLHU9VygpLGg9VygpLGw9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZT09PXQmJihhPSEwKSwwfSxmPSJjaGVja2VkfHNlbGVjdGVkfGFzeW5jfGF1dG9mb2N1c3xhdXRvcGxheXxjb250cm9sc3xkZWZlcnxkaXNhYmxlZHxoaWRkZW58aXNtYXB8bG9vcHxtdWx0aXBsZXxvcGVufHJlYWRvbmx5fHJlcXVpcmVkfHNjb3BlZCIsdD0iKD86XFxcXFtcXGRhLWZBLUZdezEsNn0iK2dlKyI/fFxcXFxbXlxcclxcblxcZl18W1xcdy1dfFteXDAtXFx4N2ZdKSsiLHA9IlxcWyIrZ2UrIiooIit0KyIpKD86IitnZSsiKihbKl4kfCF+XT89KSIrZ2UrIiooPzonKCg/OlxcXFwufFteXFxcXCddKSopJ3xcIigoPzpcXFxcLnxbXlxcXFxcIl0pKilcInwoIit0KyIpKXwpIitnZSsiKlxcXSIsZz0iOigiK3QrIikoPzpcXCgoKCcoKD86XFxcXC58W15cXFxcJ10pKiknfFwiKCg/OlxcXFwufFteXFxcXFwiXSkqKVwiKXwoKD86XFxcXC58W15cXFxcKClbXFxdXXwiK3ArIikqKXwuKilcXCl8KSIsdj1uZXcgUmVnRXhwKGdlKyIrIiwiZyIpLHk9bmV3IFJlZ0V4cCgiXiIrZ2UrIiosIitnZSsiKiIpLG09bmV3IFJlZ0V4cCgiXiIrZ2UrIiooWz4rfl18IitnZSsiKSIrZ2UrIioiKSx4PW5ldyBSZWdFeHAoZ2UrInw+Iiksaj1uZXcgUmVnRXhwKGcpLEE9bmV3IFJlZ0V4cCgiXiIrdCsiJCIpLEQ9e0lEOm5ldyBSZWdFeHAoIl4jKCIrdCsiKSIpLENMQVNTOm5ldyBSZWdFeHAoIl5cXC4oIit0KyIpIiksVEFHOm5ldyBSZWdFeHAoIl4oIit0KyJ8WypdKSIpLEFUVFI6bmV3IFJlZ0V4cCgiXiIrcCksUFNFVURPOm5ldyBSZWdFeHAoIl4iK2cpLENISUxEOm5ldyBSZWdFeHAoIl46KG9ubHl8Zmlyc3R8bGFzdHxudGh8bnRoLWxhc3QpLShjaGlsZHxvZi10eXBlKSg/OlxcKCIrZ2UrIiooZXZlbnxvZGR8KChbKy1dfCkoXFxkKilufCkiK2dlKyIqKD86KFsrLV18KSIrZ2UrIiooXFxkKyl8KSkiK2dlKyIqXFwpfCkiLCJpIiksYm9vbDpuZXcgUmVnRXhwKCJeKD86IitmKyIpJCIsImkiKSxuZWVkc0NvbnRleHQ6bmV3IFJlZ0V4cCgiXiIrZ2UrIipbPit+XXw6KGV2ZW58b2RkfGVxfGd0fGx0fG50aHxmaXJzdHxsYXN0KSg/OlxcKCIrZ2UrIiooKD86LVxcZCk/XFxkKikiK2dlKyIqXFwpfCkoPz1bXi1dfCQpIiwiaSIpfSxOPS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2kscT0vXmhcZCQvaSxMPS9eKD86IyhbXHctXSspfChcdyspfFwuKFtcdy1dKykpJC8sSD0vWyt+XS8sTz1uZXcgUmVnRXhwKCJcXFxcW1xcZGEtZkEtRl17MSw2fSIrZ2UrIj98XFxcXChbXlxcclxcblxcZl0pIiwiZyIpLFA9ZnVuY3Rpb24oZSx0KXt2YXIgbj0iMHgiK2Uuc2xpY2UoMSktNjU1MzY7cmV0dXJuIHR8fChuPDA/U3RyaW5nLmZyb21DaGFyQ29kZShuKzY1NTM2KTpTdHJpbmcuZnJvbUNoYXJDb2RlKG4+PjEwfDU1Mjk2LDEwMjMmbnw1NjMyMCkpfSxSPWZ1bmN0aW9uKCl7VigpfSxNPUooZnVuY3Rpb24oZSl7cmV0dXJuITA9PT1lLmRpc2FibGVkJiZmZShlLCJmaWVsZHNldCIpfSx7ZGlyOiJwYXJlbnROb2RlIixuZXh0OiJsZWdlbmQifSk7dHJ5e2suYXBwbHkob2U9YWUuY2FsbCh5ZS5jaGlsZE5vZGVzKSx5ZS5jaGlsZE5vZGVzKSxvZVt5ZS5jaGlsZE5vZGVzLmxlbmd0aF0ubm9kZVR5cGV9Y2F0Y2goZSl7az17YXBwbHk6ZnVuY3Rpb24oZSx0KXttZS5hcHBseShlLGFlLmNhbGwodCkpfSxjYWxsOmZ1bmN0aW9uKGUpe21lLmFwcGx5KGUsYWUuY2FsbChhcmd1bWVudHMsMSkpfX19ZnVuY3Rpb24gSSh0LGUsbixyKXt2YXIgaSxvLGEscyx1LGwsYyxmPWUmJmUub3duZXJEb2N1bWVudCxwPWU/ZS5ub2RlVHlwZTo5O2lmKG49bnx8W10sInN0cmluZyIhPXR5cGVvZiB0fHwhdHx8MSE9PXAmJjkhPT1wJiYxMSE9PXApcmV0dXJuIG47aWYoIXImJihWKGUpLGU9ZXx8VCxDKSl7aWYoMTEhPT1wJiYodT1MLmV4ZWModCkpKWlmKGk9dVsxXSl7aWYoOT09PXApe2lmKCEoYT1lLmdldEVsZW1lbnRCeUlkKGkpKSlyZXR1cm4gbjtpZihhLmlkPT09aSlyZXR1cm4gay5jYWxsKG4sYSksbn1lbHNlIGlmKGYmJihhPWYuZ2V0RWxlbWVudEJ5SWQoaSkpJiZJLmNvbnRhaW5zKGUsYSkmJmEuaWQ9PT1pKXJldHVybiBrLmNhbGwobixhKSxufWVsc2V7aWYodVsyXSlyZXR1cm4gay5hcHBseShuLGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUodCkpLG47aWYoKGk9dVszXSkmJmUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSlyZXR1cm4gay5hcHBseShuLGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShpKSksbn1pZighKGhbdCsiICJdfHxkJiZkLnRlc3QodCkpKXtpZihjPXQsZj1lLDE9PT1wJiYoeC50ZXN0KHQpfHxtLnRlc3QodCkpKXsoZj1ILnRlc3QodCkmJnooZS5wYXJlbnROb2RlKXx8ZSk9PWUmJmxlLnNjb3BlfHwoKHM9ZS5nZXRBdHRyaWJ1dGUoImlkIikpP3M9Y2UuZXNjYXBlU2VsZWN0b3Iocyk6ZS5zZXRBdHRyaWJ1dGUoImlkIixzPVMpKSxvPShsPVkodCkpLmxlbmd0aDt3aGlsZShvLS0pbFtvXT0ocz8iIyIrczoiOnNjb3BlIikrIiAiK1EobFtvXSk7Yz1sLmpvaW4oIiwiKX10cnl7cmV0dXJuIGsuYXBwbHkobixmLnF1ZXJ5U2VsZWN0b3JBbGwoYykpLG59Y2F0Y2goZSl7aCh0LCEwKX1maW5hbGx5e3M9PT1TJiZlLnJlbW92ZUF0dHJpYnV0ZSgiaWQiKX19fXJldHVybiByZSh0LnJlcGxhY2UodmUsIiQxIiksZSxuLHIpfWZ1bmN0aW9uIFcoKXt2YXIgcj1bXTtyZXR1cm4gZnVuY3Rpb24gZSh0LG4pe3JldHVybiByLnB1c2godCsiICIpPmIuY2FjaGVMZW5ndGgmJmRlbGV0ZSBlW3Iuc2hpZnQoKV0sZVt0KyIgIl09bn19ZnVuY3Rpb24gRihlKXtyZXR1cm4gZVtTXT0hMCxlfWZ1bmN0aW9uICQoZSl7dmFyIHQ9VC5jcmVhdGVFbGVtZW50KCJmaWVsZHNldCIpO3RyeXtyZXR1cm4hIWUodCl9Y2F0Y2goZSl7cmV0dXJuITF9ZmluYWxseXt0LnBhcmVudE5vZGUmJnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0KSx0PW51bGx9fWZ1bmN0aW9uIEIodCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiBmZShlLCJpbnB1dCIpJiZlLnR5cGU9PT10fX1mdW5jdGlvbiBfKHQpe3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4oZmUoZSwiaW5wdXQiKXx8ZmUoZSwiYnV0dG9uIikpJiZlLnR5cGU9PT10fX1mdW5jdGlvbiBYKHQpe3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4iZm9ybSJpbiBlP2UucGFyZW50Tm9kZSYmITE9PT1lLmRpc2FibGVkPyJsYWJlbCJpbiBlPyJsYWJlbCJpbiBlLnBhcmVudE5vZGU/ZS5wYXJlbnROb2RlLmRpc2FibGVkPT09dDplLmRpc2FibGVkPT09dDplLmlzRGlzYWJsZWQ9PT10fHxlLmlzRGlzYWJsZWQhPT0hdCYmTShlKT09PXQ6ZS5kaXNhYmxlZD09PXQ6ImxhYmVsImluIGUmJmUuZGlzYWJsZWQ9PT10fX1mdW5jdGlvbiBVKGEpe3JldHVybiBGKGZ1bmN0aW9uKG8pe3JldHVybiBvPStvLEYoZnVuY3Rpb24oZSx0KXt2YXIgbixyPWEoW10sZS5sZW5ndGgsbyksaT1yLmxlbmd0aDt3aGlsZShpLS0pZVtuPXJbaV1dJiYoZVtuXT0hKHRbbl09ZVtuXSkpfSl9KX1mdW5jdGlvbiB6KGUpe3JldHVybiBlJiYidW5kZWZpbmVkIiE9dHlwZW9mIGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUmJmV9ZnVuY3Rpb24gVihlKXt2YXIgdCxuPWU/ZS5vd25lckRvY3VtZW50fHxlOnllO3JldHVybiBuIT1UJiY5PT09bi5ub2RlVHlwZSYmbi5kb2N1bWVudEVsZW1lbnQmJihyPShUPW4pLmRvY3VtZW50RWxlbWVudCxDPSFjZS5pc1hNTERvYyhUKSxpPXIubWF0Y2hlc3x8ci53ZWJraXRNYXRjaGVzU2VsZWN0b3J8fHIubXNNYXRjaGVzU2VsZWN0b3IseWUhPVQmJih0PVQuZGVmYXVsdFZpZXcpJiZ0LnRvcCE9PXQmJnQuYWRkRXZlbnRMaXN0ZW5lcigidW5sb2FkIixSKSxsZS5nZXRCeUlkPSQoZnVuY3Rpb24oZSl7cmV0dXJuIHIuYXBwZW5kQ2hpbGQoZSkuaWQ9Y2UuZXhwYW5kbywhVC5nZXRFbGVtZW50c0J5TmFtZXx8IVQuZ2V0RWxlbWVudHNCeU5hbWUoY2UuZXhwYW5kbykubGVuZ3RofSksbGUuZGlzY29ubmVjdGVkTWF0Y2g9JChmdW5jdGlvbihlKXtyZXR1cm4gaS5jYWxsKGUsIioiKX0pLGxlLnNjb3BlPSQoZnVuY3Rpb24oKXtyZXR1cm4gVC5xdWVyeVNlbGVjdG9yQWxsKCI6c2NvcGUiKX0pLGxlLmNzc0hhcz0kKGZ1bmN0aW9uKCl7dHJ5e3JldHVybiBULnF1ZXJ5U2VsZWN0b3IoIjpoYXMoKiw6anFmYWtlKSIpLCExfWNhdGNoKGUpe3JldHVybiEwfX0pLGxlLmdldEJ5SWQ/KGIuZmlsdGVyLklEPWZ1bmN0aW9uKGUpe3ZhciB0PWUucmVwbGFjZShPLFApO3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gZS5nZXRBdHRyaWJ1dGUoImlkIik9PT10fX0sYi5maW5kLklEPWZ1bmN0aW9uKGUsdCl7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiB0LmdldEVsZW1lbnRCeUlkJiZDKXt2YXIgbj10LmdldEVsZW1lbnRCeUlkKGUpO3JldHVybiBuP1tuXTpbXX19KTooYi5maWx0ZXIuSUQ9ZnVuY3Rpb24oZSl7dmFyIG49ZS5yZXBsYWNlKE8sUCk7cmV0dXJuIGZ1bmN0aW9uKGUpe3ZhciB0PSJ1bmRlZmluZWQiIT10eXBlb2YgZS5nZXRBdHRyaWJ1dGVOb2RlJiZlLmdldEF0dHJpYnV0ZU5vZGUoImlkIik7cmV0dXJuIHQmJnQudmFsdWU9PT1ufX0sYi5maW5kLklEPWZ1bmN0aW9uKGUsdCl7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiB0LmdldEVsZW1lbnRCeUlkJiZDKXt2YXIgbixyLGksbz10LmdldEVsZW1lbnRCeUlkKGUpO2lmKG8pe2lmKChuPW8uZ2V0QXR0cmlidXRlTm9kZSgiaWQiKSkmJm4udmFsdWU9PT1lKXJldHVybltvXTtpPXQuZ2V0RWxlbWVudHNCeU5hbWUoZSkscj0wO3doaWxlKG89aVtyKytdKWlmKChuPW8uZ2V0QXR0cmlidXRlTm9kZSgiaWQiKSkmJm4udmFsdWU9PT1lKXJldHVybltvXX1yZXR1cm5bXX19KSxiLmZpbmQuVEFHPWZ1bmN0aW9uKGUsdCl7cmV0dXJuInVuZGVmaW5lZCIhPXR5cGVvZiB0LmdldEVsZW1lbnRzQnlUYWdOYW1lP3QuZ2V0RWxlbWVudHNCeVRhZ05hbWUoZSk6dC5xdWVyeVNlbGVjdG9yQWxsKGUpfSxiLmZpbmQuQ0xBU1M9ZnVuY3Rpb24oZSx0KXtpZigidW5kZWZpbmVkIiE9dHlwZW9mIHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSYmQylyZXR1cm4gdC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGUpfSxkPVtdLCQoZnVuY3Rpb24oZSl7dmFyIHQ7ci5hcHBlbmRDaGlsZChlKS5pbm5lckhUTUw9IjxhIGlkPSciK1MrIicgaHJlZj0nJyBkaXNhYmxlZD0nZGlzYWJsZWQnPjwvYT48c2VsZWN0IGlkPSciK1MrIi1cclxcJyBkaXNhYmxlZD0nZGlzYWJsZWQnPjxvcHRpb24gc2VsZWN0ZWQ9Jyc+PC9vcHRpb24+PC9zZWxlY3Q+IixlLnF1ZXJ5U2VsZWN0b3JBbGwoIltzZWxlY3RlZF0iKS5sZW5ndGh8fGQucHVzaCgiXFxbIitnZSsiKig/OnZhbHVlfCIrZisiKSIpLGUucXVlcnlTZWxlY3RvckFsbCgiW2lkfj0iK1MrIi1dIikubGVuZ3RofHxkLnB1c2goIn49IiksZS5xdWVyeVNlbGVjdG9yQWxsKCJhIyIrUysiKyoiKS5sZW5ndGh8fGQucHVzaCgiLiMuK1srfl0iKSxlLnF1ZXJ5U2VsZWN0b3JBbGwoIjpjaGVja2VkIikubGVuZ3RofHxkLnB1c2goIjpjaGVja2VkIiksKHQ9VC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpKS5zZXRBdHRyaWJ1dGUoInR5cGUiLCJoaWRkZW4iKSxlLmFwcGVuZENoaWxkKHQpLnNldEF0dHJpYnV0ZSgibmFtZSIsIkQiKSxyLmFwcGVuZENoaWxkKGUpLmRpc2FibGVkPSEwLDIhPT1lLnF1ZXJ5U2VsZWN0b3JBbGwoIjpkaXNhYmxlZCIpLmxlbmd0aCYmZC5wdXNoKCI6ZW5hYmxlZCIsIjpkaXNhYmxlZCIpLCh0PVQuY3JlYXRlRWxlbWVudCgiaW5wdXQiKSkuc2V0QXR0cmlidXRlKCJuYW1lIiwiIiksZS5hcHBlbmRDaGlsZCh0KSxlLnF1ZXJ5U2VsZWN0b3JBbGwoIltuYW1lPScnXSIpLmxlbmd0aHx8ZC5wdXNoKCJcXFsiK2dlKyIqbmFtZSIrZ2UrIio9IitnZSsiKig/OicnfFwiXCIpIil9KSxsZS5jc3NIYXN8fGQucHVzaCgiOmhhcyIpLGQ9ZC5sZW5ndGgmJm5ldyBSZWdFeHAoZC5qb2luKCJ8IikpLGw9ZnVuY3Rpb24oZSx0KXtpZihlPT09dClyZXR1cm4gYT0hMCwwO3ZhciBuPSFlLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uLSF0LmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uO3JldHVybiBufHwoMSYobj0oZS5vd25lckRvY3VtZW50fHxlKT09KHQub3duZXJEb2N1bWVudHx8dCk/ZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbih0KToxKXx8IWxlLnNvcnREZXRhY2hlZCYmdC5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihlKT09PW4/ZT09PVR8fGUub3duZXJEb2N1bWVudD09eWUmJkkuY29udGFpbnMoeWUsZSk/LTE6dD09PVR8fHQub3duZXJEb2N1bWVudD09eWUmJkkuY29udGFpbnMoeWUsdCk/MTpvP3NlLmNhbGwobyxlKS1zZS5jYWxsKG8sdCk6MDo0Jm4/LTE6MSl9KSxUfWZvcihlIGluIEkubWF0Y2hlcz1mdW5jdGlvbihlLHQpe3JldHVybiBJKGUsbnVsbCxudWxsLHQpfSxJLm1hdGNoZXNTZWxlY3Rvcj1mdW5jdGlvbihlLHQpe2lmKFYoZSksQyYmIWhbdCsiICJdJiYoIWR8fCFkLnRlc3QodCkpKXRyeXt2YXIgbj1pLmNhbGwoZSx0KTtpZihufHxsZS5kaXNjb25uZWN0ZWRNYXRjaHx8ZS5kb2N1bWVudCYmMTEhPT1lLmRvY3VtZW50Lm5vZGVUeXBlKXJldHVybiBufWNhdGNoKGUpe2godCwhMCl9cmV0dXJuIDA8SSh0LFQsbnVsbCxbZV0pLmxlbmd0aH0sSS5jb250YWlucz1mdW5jdGlvbihlLHQpe3JldHVybihlLm93bmVyRG9jdW1lbnR8fGUpIT1UJiZWKGUpLGNlLmNvbnRhaW5zKGUsdCl9LEkuYXR0cj1mdW5jdGlvbihlLHQpeyhlLm93bmVyRG9jdW1lbnR8fGUpIT1UJiZWKGUpO3ZhciBuPWIuYXR0ckhhbmRsZVt0LnRvTG93ZXJDYXNlKCldLHI9biYmdWUuY2FsbChiLmF0dHJIYW5kbGUsdC50b0xvd2VyQ2FzZSgpKT9uKGUsdCwhQyk6dm9pZCAwO3JldHVybiB2b2lkIDAhPT1yP3I6ZS5nZXRBdHRyaWJ1dGUodCl9LEkuZXJyb3I9ZnVuY3Rpb24oZSl7dGhyb3cgbmV3IEVycm9yKCJTeW50YXggZXJyb3IsIHVucmVjb2duaXplZCBleHByZXNzaW9uOiAiK2UpfSxjZS51bmlxdWVTb3J0PWZ1bmN0aW9uKGUpe3ZhciB0LG49W10scj0wLGk9MDtpZihhPSFsZS5zb3J0U3RhYmxlLG89IWxlLnNvcnRTdGFibGUmJmFlLmNhbGwoZSwwKSxkZS5jYWxsKGUsbCksYSl7d2hpbGUodD1lW2krK10pdD09PWVbaV0mJihyPW4ucHVzaChpKSk7d2hpbGUoci0tKWhlLmNhbGwoZSxuW3JdLDEpfXJldHVybiBvPW51bGwsZX0sY2UuZm4udW5pcXVlU29ydD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB1c2hTdGFjayhjZS51bmlxdWVTb3J0KGFlLmFwcGx5KHRoaXMpKSl9LChiPWNlLmV4cHI9e2NhY2hlTGVuZ3RoOjUwLGNyZWF0ZVBzZXVkbzpGLG1hdGNoOkQsYXR0ckhhbmRsZTp7fSxmaW5kOnt9LHJlbGF0aXZlOnsiPiI6e2RpcjoicGFyZW50Tm9kZSIsZmlyc3Q6ITB9LCIgIjp7ZGlyOiJwYXJlbnROb2RlIn0sIisiOntkaXI6InByZXZpb3VzU2libGluZyIsZmlyc3Q6ITB9LCJ+Ijp7ZGlyOiJwcmV2aW91c1NpYmxpbmcifX0scHJlRmlsdGVyOntBVFRSOmZ1bmN0aW9uKGUpe3JldHVybiBlWzFdPWVbMV0ucmVwbGFjZShPLFApLGVbM109KGVbM118fGVbNF18fGVbNV18fCIiKS5yZXBsYWNlKE8sUCksIn49Ij09PWVbMl0mJihlWzNdPSIgIitlWzNdKyIgIiksZS5zbGljZSgwLDQpfSxDSElMRDpmdW5jdGlvbihlKXtyZXR1cm4gZVsxXT1lWzFdLnRvTG93ZXJDYXNlKCksIm50aCI9PT1lWzFdLnNsaWNlKDAsMyk/KGVbM118fEkuZXJyb3IoZVswXSksZVs0XT0rKGVbNF0/ZVs1XSsoZVs2XXx8MSk6MiooImV2ZW4iPT09ZVszXXx8Im9kZCI9PT1lWzNdKSksZVs1XT0rKGVbN10rZVs4XXx8Im9kZCI9PT1lWzNdKSk6ZVszXSYmSS5lcnJvcihlWzBdKSxlfSxQU0VVRE86ZnVuY3Rpb24oZSl7dmFyIHQsbj0hZVs2XSYmZVsyXTtyZXR1cm4gRC5DSElMRC50ZXN0KGVbMF0pP251bGw6KGVbM10/ZVsyXT1lWzRdfHxlWzVdfHwiIjpuJiZqLnRlc3QobikmJih0PVkobiwhMCkpJiYodD1uLmluZGV4T2YoIikiLG4ubGVuZ3RoLXQpLW4ubGVuZ3RoKSYmKGVbMF09ZVswXS5zbGljZSgwLHQpLGVbMl09bi5zbGljZSgwLHQpKSxlLnNsaWNlKDAsMykpfX0sZmlsdGVyOntUQUc6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5yZXBsYWNlKE8sUCkudG9Mb3dlckNhc2UoKTtyZXR1cm4iKiI9PT1lP2Z1bmN0aW9uKCl7cmV0dXJuITB9OmZ1bmN0aW9uKGUpe3JldHVybiBmZShlLHQpfX0sQ0xBU1M6ZnVuY3Rpb24oZSl7dmFyIHQ9c1tlKyIgIl07cmV0dXJuIHR8fCh0PW5ldyBSZWdFeHAoIihefCIrZ2UrIikiK2UrIigiK2dlKyJ8JCkiKSkmJnMoZSxmdW5jdGlvbihlKXtyZXR1cm4gdC50ZXN0KCJzdHJpbmciPT10eXBlb2YgZS5jbGFzc05hbWUmJmUuY2xhc3NOYW1lfHwidW5kZWZpbmVkIiE9dHlwZW9mIGUuZ2V0QXR0cmlidXRlJiZlLmdldEF0dHJpYnV0ZSgiY2xhc3MiKXx8IiIpfSl9LEFUVFI6ZnVuY3Rpb24obixyLGkpe3JldHVybiBmdW5jdGlvbihlKXt2YXIgdD1JLmF0dHIoZSxuKTtyZXR1cm4gbnVsbD09dD8iIT0iPT09cjohcnx8KHQrPSIiLCI9Ij09PXI/dD09PWk6IiE9Ij09PXI/dCE9PWk6Il49Ij09PXI/aSYmMD09PXQuaW5kZXhPZihpKToiKj0iPT09cj9pJiYtMTx0LmluZGV4T2YoaSk6IiQ9Ij09PXI/aSYmdC5zbGljZSgtaS5sZW5ndGgpPT09aToifj0iPT09cj8tMTwoIiAiK3QucmVwbGFjZSh2LCIgIikrIiAiKS5pbmRleE9mKGkpOiJ8PSI9PT1yJiYodD09PWl8fHQuc2xpY2UoMCxpLmxlbmd0aCsxKT09PWkrIi0iKSl9fSxDSElMRDpmdW5jdGlvbihkLGUsdCxoLGcpe3ZhciB2PSJudGgiIT09ZC5zbGljZSgwLDMpLHk9Imxhc3QiIT09ZC5zbGljZSgtNCksbT0ib2YtdHlwZSI9PT1lO3JldHVybiAxPT09aCYmMD09PWc/ZnVuY3Rpb24oZSl7cmV0dXJuISFlLnBhcmVudE5vZGV9OmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG8sYSxzLHU9diE9PXk/Im5leHRTaWJsaW5nIjoicHJldmlvdXNTaWJsaW5nIixsPWUucGFyZW50Tm9kZSxjPW0mJmUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxmPSFuJiYhbSxwPSExO2lmKGwpe2lmKHYpe3doaWxlKHUpe289ZTt3aGlsZShvPW9bdV0paWYobT9mZShvLGMpOjE9PT1vLm5vZGVUeXBlKXJldHVybiExO3M9dT0ib25seSI9PT1kJiYhcyYmIm5leHRTaWJsaW5nIn1yZXR1cm4hMH1pZihzPVt5P2wuZmlyc3RDaGlsZDpsLmxhc3RDaGlsZF0seSYmZil7cD0oYT0ocj0oaT1sW1NdfHwobFtTXT17fSkpW2RdfHxbXSlbMF09PT1FJiZyWzFdKSYmclsyXSxvPWEmJmwuY2hpbGROb2Rlc1thXTt3aGlsZShvPSsrYSYmbyYmb1t1XXx8KHA9YT0wKXx8cy5wb3AoKSlpZigxPT09by5ub2RlVHlwZSYmKytwJiZvPT09ZSl7aVtkXT1bRSxhLHBdO2JyZWFrfX1lbHNlIGlmKGYmJihwPWE9KHI9KGk9ZVtTXXx8KGVbU109e30pKVtkXXx8W10pWzBdPT09RSYmclsxXSksITE9PT1wKXdoaWxlKG89KythJiZvJiZvW3VdfHwocD1hPTApfHxzLnBvcCgpKWlmKChtP2ZlKG8sYyk6MT09PW8ubm9kZVR5cGUpJiYrK3AmJihmJiYoKGk9b1tTXXx8KG9bU109e30pKVtkXT1bRSxwXSksbz09PWUpKWJyZWFrO3JldHVybihwLT1nKT09PWh8fHAlaD09MCYmMDw9cC9ofX19LFBTRVVETzpmdW5jdGlvbihlLG8pe3ZhciB0LGE9Yi5wc2V1ZG9zW2VdfHxiLnNldEZpbHRlcnNbZS50b0xvd2VyQ2FzZSgpXXx8SS5lcnJvcigidW5zdXBwb3J0ZWQgcHNldWRvOiAiK2UpO3JldHVybiBhW1NdP2Eobyk6MTxhLmxlbmd0aD8odD1bZSxlLCIiLG9dLGIuc2V0RmlsdGVycy5oYXNPd25Qcm9wZXJ0eShlLnRvTG93ZXJDYXNlKCkpP0YoZnVuY3Rpb24oZSx0KXt2YXIgbixyPWEoZSxvKSxpPXIubGVuZ3RoO3doaWxlKGktLSllW249c2UuY2FsbChlLHJbaV0pXT0hKHRbbl09cltpXSl9KTpmdW5jdGlvbihlKXtyZXR1cm4gYShlLDAsdCl9KTphfX0scHNldWRvczp7bm90OkYoZnVuY3Rpb24oZSl7dmFyIHI9W10saT1bXSxzPW5lKGUucmVwbGFjZSh2ZSwiJDEiKSk7cmV0dXJuIHNbU10/RihmdW5jdGlvbihlLHQsbixyKXt2YXIgaSxvPXMoZSxudWxsLHIsW10pLGE9ZS5sZW5ndGg7d2hpbGUoYS0tKShpPW9bYV0pJiYoZVthXT0hKHRbYV09aSkpfSk6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiByWzBdPWUscyhyLG51bGwsbixpKSxyWzBdPW51bGwsIWkucG9wKCl9fSksaGFzOkYoZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiAwPEkodCxlKS5sZW5ndGh9fSksY29udGFpbnM6RihmdW5jdGlvbih0KXtyZXR1cm4gdD10LnJlcGxhY2UoTyxQKSxmdW5jdGlvbihlKXtyZXR1cm4tMTwoZS50ZXh0Q29udGVudHx8Y2UudGV4dChlKSkuaW5kZXhPZih0KX19KSxsYW5nOkYoZnVuY3Rpb24obil7cmV0dXJuIEEudGVzdChufHwiIil8fEkuZXJyb3IoInVuc3VwcG9ydGVkIGxhbmc6ICIrbiksbj1uLnJlcGxhY2UoTyxQKS50b0xvd2VyQ2FzZSgpLGZ1bmN0aW9uKGUpe3ZhciB0O2Rve2lmKHQ9Qz9lLmxhbmc6ZS5nZXRBdHRyaWJ1dGUoInhtbDpsYW5nIil8fGUuZ2V0QXR0cmlidXRlKCJsYW5nIikpcmV0dXJuKHQ9dC50b0xvd2VyQ2FzZSgpKT09PW58fDA9PT10LmluZGV4T2YobisiLSIpfXdoaWxlKChlPWUucGFyZW50Tm9kZSkmJjE9PT1lLm5vZGVUeXBlKTtyZXR1cm4hMX19KSx0YXJnZXQ6ZnVuY3Rpb24oZSl7dmFyIHQ9aWUubG9jYXRpb24mJmllLmxvY2F0aW9uLmhhc2g7cmV0dXJuIHQmJnQuc2xpY2UoMSk9PT1lLmlkfSxyb290OmZ1bmN0aW9uKGUpe3JldHVybiBlPT09cn0sZm9jdXM6ZnVuY3Rpb24oZSl7cmV0dXJuIGU9PT1mdW5jdGlvbigpe3RyeXtyZXR1cm4gVC5hY3RpdmVFbGVtZW50fWNhdGNoKGUpe319KCkmJlQuaGFzRm9jdXMoKSYmISEoZS50eXBlfHxlLmhyZWZ8fH5lLnRhYkluZGV4KX0sZW5hYmxlZDpYKCExKSxkaXNhYmxlZDpYKCEwKSxjaGVja2VkOmZ1bmN0aW9uKGUpe3JldHVybiBmZShlLCJpbnB1dCIpJiYhIWUuY2hlY2tlZHx8ZmUoZSwib3B0aW9uIikmJiEhZS5zZWxlY3RlZH0sc2VsZWN0ZWQ6ZnVuY3Rpb24oZSl7cmV0dXJuIGUucGFyZW50Tm9kZSYmZS5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXgsITA9PT1lLnNlbGVjdGVkfSxlbXB0eTpmdW5jdGlvbihlKXtmb3IoZT1lLmZpcnN0Q2hpbGQ7ZTtlPWUubmV4dFNpYmxpbmcpaWYoZS5ub2RlVHlwZTw2KXJldHVybiExO3JldHVybiEwfSxwYXJlbnQ6ZnVuY3Rpb24oZSl7cmV0dXJuIWIucHNldWRvcy5lbXB0eShlKX0saGVhZGVyOmZ1bmN0aW9uKGUpe3JldHVybiBxLnRlc3QoZS5ub2RlTmFtZSl9LGlucHV0OmZ1bmN0aW9uKGUpe3JldHVybiBOLnRlc3QoZS5ub2RlTmFtZSl9LGJ1dHRvbjpmdW5jdGlvbihlKXtyZXR1cm4gZmUoZSwiaW5wdXQiKSYmImJ1dHRvbiI9PT1lLnR5cGV8fGZlKGUsImJ1dHRvbiIpfSx0ZXh0OmZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiBmZShlLCJpbnB1dCIpJiYidGV4dCI9PT1lLnR5cGUmJihudWxsPT0odD1lLmdldEF0dHJpYnV0ZSgidHlwZSIpKXx8InRleHQiPT09dC50b0xvd2VyQ2FzZSgpKX0sZmlyc3Q6VShmdW5jdGlvbigpe3JldHVyblswXX0pLGxhc3Q6VShmdW5jdGlvbihlLHQpe3JldHVyblt0LTFdfSksZXE6VShmdW5jdGlvbihlLHQsbil7cmV0dXJuW248MD9uK3Q6bl19KSxldmVuOlUoZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49MDtuPHQ7bis9MillLnB1c2gobik7cmV0dXJuIGV9KSxvZGQ6VShmdW5jdGlvbihlLHQpe2Zvcih2YXIgbj0xO248dDtuKz0yKWUucHVzaChuKTtyZXR1cm4gZX0pLGx0OlUoZnVuY3Rpb24oZSx0LG4pe3ZhciByO2ZvcihyPW48MD9uK3Q6dDxuP3Q6bjswPD0tLXI7KWUucHVzaChyKTtyZXR1cm4gZX0pLGd0OlUoZnVuY3Rpb24oZSx0LG4pe2Zvcih2YXIgcj1uPDA/bit0Om47KytyPHQ7KWUucHVzaChyKTtyZXR1cm4gZX0pfX0pLnBzZXVkb3MubnRoPWIucHNldWRvcy5lcSx7cmFkaW86ITAsY2hlY2tib3g6ITAsZmlsZTohMCxwYXNzd29yZDohMCxpbWFnZTohMH0pYi5wc2V1ZG9zW2VdPUIoZSk7Zm9yKGUgaW57c3VibWl0OiEwLHJlc2V0OiEwfSliLnBzZXVkb3NbZV09XyhlKTtmdW5jdGlvbiBHKCl7fWZ1bmN0aW9uIFkoZSx0KXt2YXIgbixyLGksbyxhLHMsdSxsPWNbZSsiICJdO2lmKGwpcmV0dXJuIHQ/MDpsLnNsaWNlKDApO2E9ZSxzPVtdLHU9Yi5wcmVGaWx0ZXI7d2hpbGUoYSl7Zm9yKG8gaW4gbiYmIShyPXkuZXhlYyhhKSl8fChyJiYoYT1hLnNsaWNlKHJbMF0ubGVuZ3RoKXx8YSkscy5wdXNoKGk9W10pKSxuPSExLChyPW0uZXhlYyhhKSkmJihuPXIuc2hpZnQoKSxpLnB1c2goe3ZhbHVlOm4sdHlwZTpyWzBdLnJlcGxhY2UodmUsIiAiKX0pLGE9YS5zbGljZShuLmxlbmd0aCkpLGIuZmlsdGVyKSEocj1EW29dLmV4ZWMoYSkpfHx1W29dJiYhKHI9dVtvXShyKSl8fChuPXIuc2hpZnQoKSxpLnB1c2goe3ZhbHVlOm4sdHlwZTpvLG1hdGNoZXM6cn0pLGE9YS5zbGljZShuLmxlbmd0aCkpO2lmKCFuKWJyZWFrfXJldHVybiB0P2EubGVuZ3RoOmE/SS5lcnJvcihlKTpjKGUscykuc2xpY2UoMCl9ZnVuY3Rpb24gUShlKXtmb3IodmFyIHQ9MCxuPWUubGVuZ3RoLHI9IiI7dDxuO3QrKylyKz1lW3RdLnZhbHVlO3JldHVybiByfWZ1bmN0aW9uIEooYSxlLHQpe3ZhciBzPWUuZGlyLHU9ZS5uZXh0LGw9dXx8cyxjPXQmJiJwYXJlbnROb2RlIj09PWwsZj1uKys7cmV0dXJuIGUuZmlyc3Q/ZnVuY3Rpb24oZSx0LG4pe3doaWxlKGU9ZVtzXSlpZigxPT09ZS5ub2RlVHlwZXx8YylyZXR1cm4gYShlLHQsbik7cmV0dXJuITF9OmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG89W0UsZl07aWYobil7d2hpbGUoZT1lW3NdKWlmKCgxPT09ZS5ub2RlVHlwZXx8YykmJmEoZSx0LG4pKXJldHVybiEwfWVsc2Ugd2hpbGUoZT1lW3NdKWlmKDE9PT1lLm5vZGVUeXBlfHxjKWlmKGk9ZVtTXXx8KGVbU109e30pLHUmJmZlKGUsdSkpZT1lW3NdfHxlO2Vsc2V7aWYoKHI9aVtsXSkmJnJbMF09PT1FJiZyWzFdPT09ZilyZXR1cm4gb1syXT1yWzJdO2lmKChpW2xdPW8pWzJdPWEoZSx0LG4pKXJldHVybiEwfXJldHVybiExfX1mdW5jdGlvbiBLKGkpe3JldHVybiAxPGkubGVuZ3RoP2Z1bmN0aW9uKGUsdCxuKXt2YXIgcj1pLmxlbmd0aDt3aGlsZShyLS0paWYoIWlbcl0oZSx0LG4pKXJldHVybiExO3JldHVybiEwfTppWzBdfWZ1bmN0aW9uIFooZSx0LG4scixpKXtmb3IodmFyIG8sYT1bXSxzPTAsdT1lLmxlbmd0aCxsPW51bGwhPXQ7czx1O3MrKykobz1lW3NdKSYmKG4mJiFuKG8scixpKXx8KGEucHVzaChvKSxsJiZ0LnB1c2gocykpKTtyZXR1cm4gYX1mdW5jdGlvbiBlZShkLGgsZyx2LHksZSl7cmV0dXJuIHYmJiF2W1NdJiYodj1lZSh2KSkseSYmIXlbU10mJih5PWVlKHksZSkpLEYoZnVuY3Rpb24oZSx0LG4scil7dmFyIGksbyxhLHMsdT1bXSxsPVtdLGM9dC5sZW5ndGgsZj1lfHxmdW5jdGlvbihlLHQsbil7Zm9yKHZhciByPTAsaT10Lmxlbmd0aDtyPGk7cisrKUkoZSx0W3JdLG4pO3JldHVybiBufShofHwiKiIsbi5ub2RlVHlwZT9bbl06bixbXSkscD0hZHx8IWUmJmg/ZjpaKGYsdSxkLG4scik7aWYoZz9nKHAscz15fHwoZT9kOmN8fHYpP1tdOnQsbixyKTpzPXAsdil7aT1aKHMsbCksdihpLFtdLG4sciksbz1pLmxlbmd0aDt3aGlsZShvLS0pKGE9aVtvXSkmJihzW2xbb11dPSEocFtsW29dXT1hKSl9aWYoZSl7aWYoeXx8ZCl7aWYoeSl7aT1bXSxvPXMubGVuZ3RoO3doaWxlKG8tLSkoYT1zW29dKSYmaS5wdXNoKHBbb109YSk7eShudWxsLHM9W10saSxyKX1vPXMubGVuZ3RoO3doaWxlKG8tLSkoYT1zW29dKSYmLTE8KGk9eT9zZS5jYWxsKGUsYSk6dVtvXSkmJihlW2ldPSEodFtpXT1hKSl9fWVsc2Ugcz1aKHM9PT10P3Muc3BsaWNlKGMscy5sZW5ndGgpOnMpLHk/eShudWxsLHQscyxyKTprLmFwcGx5KHQscyl9KX1mdW5jdGlvbiB0ZShlKXtmb3IodmFyIGksdCxuLHI9ZS5sZW5ndGgsbz1iLnJlbGF0aXZlW2VbMF0udHlwZV0sYT1vfHxiLnJlbGF0aXZlWyIgIl0scz1vPzE6MCx1PUooZnVuY3Rpb24oZSl7cmV0dXJuIGU9PT1pfSxhLCEwKSxsPUooZnVuY3Rpb24oZSl7cmV0dXJuLTE8c2UuY2FsbChpLGUpfSxhLCEwKSxjPVtmdW5jdGlvbihlLHQsbil7dmFyIHI9IW8mJihufHx0IT13KXx8KChpPXQpLm5vZGVUeXBlP3UoZSx0LG4pOmwoZSx0LG4pKTtyZXR1cm4gaT1udWxsLHJ9XTtzPHI7cysrKWlmKHQ9Yi5yZWxhdGl2ZVtlW3NdLnR5cGVdKWM9W0ooSyhjKSx0KV07ZWxzZXtpZigodD1iLmZpbHRlcltlW3NdLnR5cGVdLmFwcGx5KG51bGwsZVtzXS5tYXRjaGVzKSlbU10pe2ZvcihuPSsrcztuPHI7bisrKWlmKGIucmVsYXRpdmVbZVtuXS50eXBlXSlicmVhaztyZXR1cm4gZWUoMTxzJiZLKGMpLDE8cyYmUShlLnNsaWNlKDAscy0xKS5jb25jYXQoe3ZhbHVlOiIgIj09PWVbcy0yXS50eXBlPyIqIjoiIn0pKS5yZXBsYWNlKHZlLCIkMSIpLHQsczxuJiZ0ZShlLnNsaWNlKHMsbikpLG48ciYmdGUoZT1lLnNsaWNlKG4pKSxuPHImJlEoZSkpfWMucHVzaCh0KX1yZXR1cm4gSyhjKX1mdW5jdGlvbiBuZShlLHQpe3ZhciBuLHYseSxtLHgscixpPVtdLG89W10sYT11W2UrIiAiXTtpZighYSl7dHx8KHQ9WShlKSksbj10Lmxlbmd0aDt3aGlsZShuLS0pKGE9dGUodFtuXSkpW1NdP2kucHVzaChhKTpvLnB1c2goYSk7KGE9dShlLCh2PW8sbT0wPCh5PWkpLmxlbmd0aCx4PTA8di5sZW5ndGgscj1mdW5jdGlvbihlLHQsbixyLGkpe3ZhciBvLGEscyx1PTAsbD0iMCIsYz1lJiZbXSxmPVtdLHA9dyxkPWV8fHgmJmIuZmluZC5UQUcoIioiLGkpLGg9RSs9bnVsbD09cD8xOk1hdGgucmFuZG9tKCl8fC4xLGc9ZC5sZW5ndGg7Zm9yKGkmJih3PXQ9PVR8fHR8fGkpO2whPT1nJiZudWxsIT0obz1kW2xdKTtsKyspe2lmKHgmJm8pe2E9MCx0fHxvLm93bmVyRG9jdW1lbnQ9PVR8fChWKG8pLG49IUMpO3doaWxlKHM9dlthKytdKWlmKHMobyx0fHxULG4pKXtrLmNhbGwocixvKTticmVha31pJiYoRT1oKX1tJiYoKG89IXMmJm8pJiZ1LS0sZSYmYy5wdXNoKG8pKX1pZih1Kz1sLG0mJmwhPT11KXthPTA7d2hpbGUocz15W2ErK10pcyhjLGYsdCxuKTtpZihlKXtpZigwPHUpd2hpbGUobC0tKWNbbF18fGZbbF18fChmW2xdPXBlLmNhbGwocikpO2Y9WihmKX1rLmFwcGx5KHIsZiksaSYmIWUmJjA8Zi5sZW5ndGgmJjE8dSt5Lmxlbmd0aCYmY2UudW5pcXVlU29ydChyKX1yZXR1cm4gaSYmKEU9aCx3PXApLGN9LG0/RihyKTpyKSkpLnNlbGVjdG9yPWV9cmV0dXJuIGF9ZnVuY3Rpb24gcmUoZSx0LG4scil7dmFyIGksbyxhLHMsdSxsPSJmdW5jdGlvbiI9PXR5cGVvZiBlJiZlLGM9IXImJlkoZT1sLnNlbGVjdG9yfHxlKTtpZihuPW58fFtdLDE9PT1jLmxlbmd0aCl7aWYoMjwobz1jWzBdPWNbMF0uc2xpY2UoMCkpLmxlbmd0aCYmIklEIj09PShhPW9bMF0pLnR5cGUmJjk9PT10Lm5vZGVUeXBlJiZDJiZiLnJlbGF0aXZlW29bMV0udHlwZV0pe2lmKCEodD0oYi5maW5kLklEKGEubWF0Y2hlc1swXS5yZXBsYWNlKE8sUCksdCl8fFtdKVswXSkpcmV0dXJuIG47bCYmKHQ9dC5wYXJlbnROb2RlKSxlPWUuc2xpY2Uoby5zaGlmdCgpLnZhbHVlLmxlbmd0aCl9aT1ELm5lZWRzQ29udGV4dC50ZXN0KGUpPzA6by5sZW5ndGg7d2hpbGUoaS0tKXtpZihhPW9baV0sYi5yZWxhdGl2ZVtzPWEudHlwZV0pYnJlYWs7aWYoKHU9Yi5maW5kW3NdKSYmKHI9dShhLm1hdGNoZXNbMF0ucmVwbGFjZShPLFApLEgudGVzdChvWzBdLnR5cGUpJiZ6KHQucGFyZW50Tm9kZSl8fHQpKSl7aWYoby5zcGxpY2UoaSwxKSwhKGU9ci5sZW5ndGgmJlEobykpKXJldHVybiBrLmFwcGx5KG4sciksbjticmVha319fXJldHVybihsfHxuZShlLGMpKShyLHQsIUMsbiwhdHx8SC50ZXN0KGUpJiZ6KHQucGFyZW50Tm9kZSl8fHQpLG59Ry5wcm90b3R5cGU9Yi5maWx0ZXJzPWIucHNldWRvcyxiLnNldEZpbHRlcnM9bmV3IEcsbGUuc29ydFN0YWJsZT1TLnNwbGl0KCIiKS5zb3J0KGwpLmpvaW4oIiIpPT09UyxWKCksbGUuc29ydERldGFjaGVkPSQoZnVuY3Rpb24oZSl7cmV0dXJuIDEmZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihULmNyZWF0ZUVsZW1lbnQoImZpZWxkc2V0IikpfSksY2UuZmluZD1JLGNlLmV4cHJbIjoiXT1jZS5leHByLnBzZXVkb3MsY2UudW5pcXVlPWNlLnVuaXF1ZVNvcnQsSS5jb21waWxlPW5lLEkuc2VsZWN0PXJlLEkuc2V0RG9jdW1lbnQ9VixJLmVzY2FwZT1jZS5lc2NhcGVTZWxlY3RvcixJLmdldFRleHQ9Y2UudGV4dCxJLmlzWE1MPWNlLmlzWE1MRG9jLEkuc2VsZWN0b3JzPWNlLmV4cHIsSS5zdXBwb3J0PWNlLnN1cHBvcnQsSS51bmlxdWVTb3J0PWNlLnVuaXF1ZVNvcnR9KCk7dmFyIGQ9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPVtdLGk9dm9pZCAwIT09bjt3aGlsZSgoZT1lW3RdKSYmOSE9PWUubm9kZVR5cGUpaWYoMT09PWUubm9kZVR5cGUpe2lmKGkmJmNlKGUpLmlzKG4pKWJyZWFrO3IucHVzaChlKX1yZXR1cm4gcn0saD1mdW5jdGlvbihlLHQpe2Zvcih2YXIgbj1bXTtlO2U9ZS5uZXh0U2libGluZykxPT09ZS5ub2RlVHlwZSYmZSE9PXQmJm4ucHVzaChlKTtyZXR1cm4gbn0sYj1jZS5leHByLm1hdGNoLm5lZWRzQ29udGV4dCx3PS9ePChbYS16XVteXC9cMD46XHgyMFx0XHJcblxmXSopW1x4MjBcdFxyXG5cZl0qXC8/Pig/OjxcL1wxPnwpJC9pO2Z1bmN0aW9uIFQoZSxuLHIpe3JldHVybiB2KG4pP2NlLmdyZXAoZSxmdW5jdGlvbihlLHQpe3JldHVybiEhbi5jYWxsKGUsdCxlKSE9PXJ9KTpuLm5vZGVUeXBlP2NlLmdyZXAoZSxmdW5jdGlvbihlKXtyZXR1cm4gZT09PW4hPT1yfSk6InN0cmluZyIhPXR5cGVvZiBuP2NlLmdyZXAoZSxmdW5jdGlvbihlKXtyZXR1cm4tMTxzZS5jYWxsKG4sZSkhPT1yfSk6Y2UuZmlsdGVyKG4sZSxyKX1jZS5maWx0ZXI9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPXRbMF07cmV0dXJuIG4mJihlPSI6bm90KCIrZSsiKSIpLDE9PT10Lmxlbmd0aCYmMT09PXIubm9kZVR5cGU/Y2UuZmluZC5tYXRjaGVzU2VsZWN0b3IocixlKT9bcl06W106Y2UuZmluZC5tYXRjaGVzKGUsY2UuZ3JlcCh0LGZ1bmN0aW9uKGUpe3JldHVybiAxPT09ZS5ub2RlVHlwZX0pKX0sY2UuZm4uZXh0ZW5kKHtmaW5kOmZ1bmN0aW9uKGUpe3ZhciB0LG4scj10aGlzLmxlbmd0aCxpPXRoaXM7aWYoInN0cmluZyIhPXR5cGVvZiBlKXJldHVybiB0aGlzLnB1c2hTdGFjayhjZShlKS5maWx0ZXIoZnVuY3Rpb24oKXtmb3IodD0wO3Q8cjt0KyspaWYoY2UuY29udGFpbnMoaVt0XSx0aGlzKSlyZXR1cm4hMH0pKTtmb3Iobj10aGlzLnB1c2hTdGFjayhbXSksdD0wO3Q8cjt0KyspY2UuZmluZChlLGlbdF0sbik7cmV0dXJuIDE8cj9jZS51bmlxdWVTb3J0KG4pOm59LGZpbHRlcjpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soVCh0aGlzLGV8fFtdLCExKSl9LG5vdDpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soVCh0aGlzLGV8fFtdLCEwKSl9LGlzOmZ1bmN0aW9uKGUpe3JldHVybiEhVCh0aGlzLCJzdHJpbmciPT10eXBlb2YgZSYmYi50ZXN0KGUpP2NlKGUpOmV8fFtdLCExKS5sZW5ndGh9fSk7dmFyIGssUz0vXig/OlxzKig8W1x3XFddKz4pW14+XSp8IyhbXHctXSspKSQvOyhjZS5mbi5pbml0PWZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpO2lmKCFlKXJldHVybiB0aGlzO2lmKG49bnx8aywic3RyaW5nIj09dHlwZW9mIGUpe2lmKCEocj0iPCI9PT1lWzBdJiYiPiI9PT1lW2UubGVuZ3RoLTFdJiYzPD1lLmxlbmd0aD9bbnVsbCxlLG51bGxdOlMuZXhlYyhlKSl8fCFyWzFdJiZ0KXJldHVybiF0fHx0LmpxdWVyeT8odHx8bikuZmluZChlKTp0aGlzLmNvbnN0cnVjdG9yKHQpLmZpbmQoZSk7aWYoclsxXSl7aWYodD10IGluc3RhbmNlb2YgY2U/dFswXTp0LGNlLm1lcmdlKHRoaXMsY2UucGFyc2VIVE1MKHJbMV0sdCYmdC5ub2RlVHlwZT90Lm93bmVyRG9jdW1lbnR8fHQ6QywhMCkpLHcudGVzdChyWzFdKSYmY2UuaXNQbGFpbk9iamVjdCh0KSlmb3IociBpbiB0KXYodGhpc1tyXSk/dGhpc1tyXSh0W3JdKTp0aGlzLmF0dHIocix0W3JdKTtyZXR1cm4gdGhpc31yZXR1cm4oaT1DLmdldEVsZW1lbnRCeUlkKHJbMl0pKSYmKHRoaXNbMF09aSx0aGlzLmxlbmd0aD0xKSx0aGlzfXJldHVybiBlLm5vZGVUeXBlPyh0aGlzWzBdPWUsdGhpcy5sZW5ndGg9MSx0aGlzKTp2KGUpP3ZvaWQgMCE9PW4ucmVhZHk/bi5yZWFkeShlKTplKGNlKTpjZS5tYWtlQXJyYXkoZSx0aGlzKX0pLnByb3RvdHlwZT1jZS5mbixrPWNlKEMpO3ZhciBFPS9eKD86cGFyZW50c3xwcmV2KD86VW50aWx8QWxsKSkvLGo9e2NoaWxkcmVuOiEwLGNvbnRlbnRzOiEwLG5leHQ6ITAscHJldjohMH07ZnVuY3Rpb24gQShlLHQpe3doaWxlKChlPWVbdF0pJiYxIT09ZS5ub2RlVHlwZSk7cmV0dXJuIGV9Y2UuZm4uZXh0ZW5kKHtoYXM6ZnVuY3Rpb24oZSl7dmFyIHQ9Y2UoZSx0aGlzKSxuPXQubGVuZ3RoO3JldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbigpe2Zvcih2YXIgZT0wO2U8bjtlKyspaWYoY2UuY29udGFpbnModGhpcyx0W2VdKSlyZXR1cm4hMH0pfSxjbG9zZXN0OmZ1bmN0aW9uKGUsdCl7dmFyIG4scj0wLGk9dGhpcy5sZW5ndGgsbz1bXSxhPSJzdHJpbmciIT10eXBlb2YgZSYmY2UoZSk7aWYoIWIudGVzdChlKSlmb3IoO3I8aTtyKyspZm9yKG49dGhpc1tyXTtuJiZuIT09dDtuPW4ucGFyZW50Tm9kZSlpZihuLm5vZGVUeXBlPDExJiYoYT8tMTxhLmluZGV4KG4pOjE9PT1uLm5vZGVUeXBlJiZjZS5maW5kLm1hdGNoZXNTZWxlY3RvcihuLGUpKSl7by5wdXNoKG4pO2JyZWFrfXJldHVybiB0aGlzLnB1c2hTdGFjaygxPG8ubGVuZ3RoP2NlLnVuaXF1ZVNvcnQobyk6byl9LGluZGV4OmZ1bmN0aW9uKGUpe3JldHVybiBlPyJzdHJpbmciPT10eXBlb2YgZT9zZS5jYWxsKGNlKGUpLHRoaXNbMF0pOnNlLmNhbGwodGhpcyxlLmpxdWVyeT9lWzBdOmUpOnRoaXNbMF0mJnRoaXNbMF0ucGFyZW50Tm9kZT90aGlzLmZpcnN0KCkucHJldkFsbCgpLmxlbmd0aDotMX0sYWRkOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGNlLnVuaXF1ZVNvcnQoY2UubWVyZ2UodGhpcy5nZXQoKSxjZShlLHQpKSkpfSxhZGRCYWNrOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmFkZChudWxsPT1lP3RoaXMucHJldk9iamVjdDp0aGlzLnByZXZPYmplY3QuZmlsdGVyKGUpKX19KSxjZS5lYWNoKHtwYXJlbnQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wYXJlbnROb2RlO3JldHVybiB0JiYxMSE9PXQubm9kZVR5cGU/dDpudWxsfSxwYXJlbnRzOmZ1bmN0aW9uKGUpe3JldHVybiBkKGUsInBhcmVudE5vZGUiKX0scGFyZW50c1VudGlsOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gZChlLCJwYXJlbnROb2RlIixuKX0sbmV4dDpmdW5jdGlvbihlKXtyZXR1cm4gQShlLCJuZXh0U2libGluZyIpfSxwcmV2OmZ1bmN0aW9uKGUpe3JldHVybiBBKGUsInByZXZpb3VzU2libGluZyIpfSxuZXh0QWxsOmZ1bmN0aW9uKGUpe3JldHVybiBkKGUsIm5leHRTaWJsaW5nIil9LHByZXZBbGw6ZnVuY3Rpb24oZSl7cmV0dXJuIGQoZSwicHJldmlvdXNTaWJsaW5nIil9LG5leHRVbnRpbDpmdW5jdGlvbihlLHQsbil7cmV0dXJuIGQoZSwibmV4dFNpYmxpbmciLG4pfSxwcmV2VW50aWw6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBkKGUsInByZXZpb3VzU2libGluZyIsbil9LHNpYmxpbmdzOmZ1bmN0aW9uKGUpe3JldHVybiBoKChlLnBhcmVudE5vZGV8fHt9KS5maXJzdENoaWxkLGUpfSxjaGlsZHJlbjpmdW5jdGlvbihlKXtyZXR1cm4gaChlLmZpcnN0Q2hpbGQpfSxjb250ZW50czpmdW5jdGlvbihlKXtyZXR1cm4gbnVsbCE9ZS5jb250ZW50RG9jdW1lbnQmJnIoZS5jb250ZW50RG9jdW1lbnQpP2UuY29udGVudERvY3VtZW50OihmZShlLCJ0ZW1wbGF0ZSIpJiYoZT1lLmNvbnRlbnR8fGUpLGNlLm1lcmdlKFtdLGUuY2hpbGROb2RlcykpfX0sZnVuY3Rpb24ocixpKXtjZS5mbltyXT1mdW5jdGlvbihlLHQpe3ZhciBuPWNlLm1hcCh0aGlzLGksZSk7cmV0dXJuIlVudGlsIiE9PXIuc2xpY2UoLTUpJiYodD1lKSx0JiYic3RyaW5nIj09dHlwZW9mIHQmJihuPWNlLmZpbHRlcih0LG4pKSwxPHRoaXMubGVuZ3RoJiYoaltyXXx8Y2UudW5pcXVlU29ydChuKSxFLnRlc3QocikmJm4ucmV2ZXJzZSgpKSx0aGlzLnB1c2hTdGFjayhuKX19KTt2YXIgRD0vW15ceDIwXHRcclxuXGZdKy9nO2Z1bmN0aW9uIE4oZSl7cmV0dXJuIGV9ZnVuY3Rpb24gcShlKXt0aHJvdyBlfWZ1bmN0aW9uIEwoZSx0LG4scil7dmFyIGk7dHJ5e2UmJnYoaT1lLnByb21pc2UpP2kuY2FsbChlKS5kb25lKHQpLmZhaWwobik6ZSYmdihpPWUudGhlbik/aS5jYWxsKGUsdCxuKTp0LmFwcGx5KHZvaWQgMCxbZV0uc2xpY2UocikpfWNhdGNoKGUpe24uYXBwbHkodm9pZCAwLFtlXSl9fWNlLkNhbGxiYWNrcz1mdW5jdGlvbihyKXt2YXIgZSxuO3I9InN0cmluZyI9PXR5cGVvZiByPyhlPXIsbj17fSxjZS5lYWNoKGUubWF0Y2goRCl8fFtdLGZ1bmN0aW9uKGUsdCl7blt0XT0hMH0pLG4pOmNlLmV4dGVuZCh7fSxyKTt2YXIgaSx0LG8sYSxzPVtdLHU9W10sbD0tMSxjPWZ1bmN0aW9uKCl7Zm9yKGE9YXx8ci5vbmNlLG89aT0hMDt1Lmxlbmd0aDtsPS0xKXt0PXUuc2hpZnQoKTt3aGlsZSgrK2w8cy5sZW5ndGgpITE9PT1zW2xdLmFwcGx5KHRbMF0sdFsxXSkmJnIuc3RvcE9uRmFsc2UmJihsPXMubGVuZ3RoLHQ9ITEpfXIubWVtb3J5fHwodD0hMSksaT0hMSxhJiYocz10P1tdOiIiKX0sZj17YWRkOmZ1bmN0aW9uKCl7cmV0dXJuIHMmJih0JiYhaSYmKGw9cy5sZW5ndGgtMSx1LnB1c2godCkpLGZ1bmN0aW9uIG4oZSl7Y2UuZWFjaChlLGZ1bmN0aW9uKGUsdCl7dih0KT9yLnVuaXF1ZSYmZi5oYXModCl8fHMucHVzaCh0KTp0JiZ0Lmxlbmd0aCYmInN0cmluZyIhPT14KHQpJiZuKHQpfSl9KGFyZ3VtZW50cyksdCYmIWkmJmMoKSksdGhpc30scmVtb3ZlOmZ1bmN0aW9uKCl7cmV0dXJuIGNlLmVhY2goYXJndW1lbnRzLGZ1bmN0aW9uKGUsdCl7dmFyIG47d2hpbGUoLTE8KG49Y2UuaW5BcnJheSh0LHMsbikpKXMuc3BsaWNlKG4sMSksbjw9bCYmbC0tfSksdGhpc30saGFzOmZ1bmN0aW9uKGUpe3JldHVybiBlPy0xPGNlLmluQXJyYXkoZSxzKTowPHMubGVuZ3RofSxlbXB0eTpmdW5jdGlvbigpe3JldHVybiBzJiYocz1bXSksdGhpc30sZGlzYWJsZTpmdW5jdGlvbigpe3JldHVybiBhPXU9W10scz10PSIiLHRoaXN9LGRpc2FibGVkOmZ1bmN0aW9uKCl7cmV0dXJuIXN9LGxvY2s6ZnVuY3Rpb24oKXtyZXR1cm4gYT11PVtdLHR8fGl8fChzPXQ9IiIpLHRoaXN9LGxvY2tlZDpmdW5jdGlvbigpe3JldHVybiEhYX0sZmlyZVdpdGg6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gYXx8KHQ9W2UsKHQ9dHx8W10pLnNsaWNlP3Quc2xpY2UoKTp0XSx1LnB1c2godCksaXx8YygpKSx0aGlzfSxmaXJlOmZ1bmN0aW9uKCl7cmV0dXJuIGYuZmlyZVdpdGgodGhpcyxhcmd1bWVudHMpLHRoaXN9LGZpcmVkOmZ1bmN0aW9uKCl7cmV0dXJuISFvfX07cmV0dXJuIGZ9LGNlLmV4dGVuZCh7RGVmZXJyZWQ6ZnVuY3Rpb24oZSl7dmFyIG89W1sibm90aWZ5IiwicHJvZ3Jlc3MiLGNlLkNhbGxiYWNrcygibWVtb3J5IiksY2UuQ2FsbGJhY2tzKCJtZW1vcnkiKSwyXSxbInJlc29sdmUiLCJkb25lIixjZS5DYWxsYmFja3MoIm9uY2UgbWVtb3J5IiksY2UuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLDAsInJlc29sdmVkIl0sWyJyZWplY3QiLCJmYWlsIixjZS5DYWxsYmFja3MoIm9uY2UgbWVtb3J5IiksY2UuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLDEsInJlamVjdGVkIl1dLGk9InBlbmRpbmciLGE9e3N0YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIGl9LGFsd2F5czpmdW5jdGlvbigpe3JldHVybiBzLmRvbmUoYXJndW1lbnRzKS5mYWlsKGFyZ3VtZW50cyksdGhpc30sImNhdGNoIjpmdW5jdGlvbihlKXtyZXR1cm4gYS50aGVuKG51bGwsZSl9LHBpcGU6ZnVuY3Rpb24oKXt2YXIgaT1hcmd1bWVudHM7cmV0dXJuIGNlLkRlZmVycmVkKGZ1bmN0aW9uKHIpe2NlLmVhY2gobyxmdW5jdGlvbihlLHQpe3ZhciBuPXYoaVt0WzRdXSkmJmlbdFs0XV07c1t0WzFdXShmdW5jdGlvbigpe3ZhciBlPW4mJm4uYXBwbHkodGhpcyxhcmd1bWVudHMpO2UmJnYoZS5wcm9taXNlKT9lLnByb21pc2UoKS5wcm9ncmVzcyhyLm5vdGlmeSkuZG9uZShyLnJlc29sdmUpLmZhaWwoci5yZWplY3QpOnJbdFswXSsiV2l0aCJdKHRoaXMsbj9bZV06YXJndW1lbnRzKX0pfSksaT1udWxsfSkucHJvbWlzZSgpfSx0aGVuOmZ1bmN0aW9uKHQsbixyKXt2YXIgdT0wO2Z1bmN0aW9uIGwoaSxvLGEscyl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIG49dGhpcyxyPWFyZ3VtZW50cyxlPWZ1bmN0aW9uKCl7dmFyIGUsdDtpZighKGk8dSkpe2lmKChlPWEuYXBwbHkobixyKSk9PT1vLnByb21pc2UoKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJUaGVuYWJsZSBzZWxmLXJlc29sdXRpb24iKTt0PWUmJigib2JqZWN0Ij09dHlwZW9mIGV8fCJmdW5jdGlvbiI9PXR5cGVvZiBlKSYmZS50aGVuLHYodCk/cz90LmNhbGwoZSxsKHUsbyxOLHMpLGwodSxvLHEscykpOih1KyssdC5jYWxsKGUsbCh1LG8sTixzKSxsKHUsbyxxLHMpLGwodSxvLE4sby5ub3RpZnlXaXRoKSkpOihhIT09TiYmKG49dm9pZCAwLHI9W2VdKSwoc3x8by5yZXNvbHZlV2l0aCkobixyKSl9fSx0PXM/ZTpmdW5jdGlvbigpe3RyeXtlKCl9Y2F0Y2goZSl7Y2UuRGVmZXJyZWQuZXhjZXB0aW9uSG9vayYmY2UuRGVmZXJyZWQuZXhjZXB0aW9uSG9vayhlLHQuZXJyb3IpLHU8PWkrMSYmKGEhPT1xJiYobj12b2lkIDAscj1bZV0pLG8ucmVqZWN0V2l0aChuLHIpKX19O2k/dCgpOihjZS5EZWZlcnJlZC5nZXRFcnJvckhvb2s/dC5lcnJvcj1jZS5EZWZlcnJlZC5nZXRFcnJvckhvb2soKTpjZS5EZWZlcnJlZC5nZXRTdGFja0hvb2smJih0LmVycm9yPWNlLkRlZmVycmVkLmdldFN0YWNrSG9vaygpKSxpZS5zZXRUaW1lb3V0KHQpKX19cmV0dXJuIGNlLkRlZmVycmVkKGZ1bmN0aW9uKGUpe29bMF1bM10uYWRkKGwoMCxlLHYocik/cjpOLGUubm90aWZ5V2l0aCkpLG9bMV1bM10uYWRkKGwoMCxlLHYodCk/dDpOKSksb1syXVszXS5hZGQobCgwLGUsdihuKT9uOnEpKX0pLnByb21pc2UoKX0scHJvbWlzZTpmdW5jdGlvbihlKXtyZXR1cm4gbnVsbCE9ZT9jZS5leHRlbmQoZSxhKTphfX0scz17fTtyZXR1cm4gY2UuZWFjaChvLGZ1bmN0aW9uKGUsdCl7dmFyIG49dFsyXSxyPXRbNV07YVt0WzFdXT1uLmFkZCxyJiZuLmFkZChmdW5jdGlvbigpe2k9cn0sb1szLWVdWzJdLmRpc2FibGUsb1szLWVdWzNdLmRpc2FibGUsb1swXVsyXS5sb2NrLG9bMF1bM10ubG9jayksbi5hZGQodFszXS5maXJlKSxzW3RbMF1dPWZ1bmN0aW9uKCl7cmV0dXJuIHNbdFswXSsiV2l0aCJdKHRoaXM9PT1zP3ZvaWQgMDp0aGlzLGFyZ3VtZW50cyksdGhpc30sc1t0WzBdKyJXaXRoIl09bi5maXJlV2l0aH0pLGEucHJvbWlzZShzKSxlJiZlLmNhbGwocyxzKSxzfSx3aGVuOmZ1bmN0aW9uKGUpe3ZhciBuPWFyZ3VtZW50cy5sZW5ndGgsdD1uLHI9QXJyYXkodCksaT1hZS5jYWxsKGFyZ3VtZW50cyksbz1jZS5EZWZlcnJlZCgpLGE9ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3JbdF09dGhpcyxpW3RdPTE8YXJndW1lbnRzLmxlbmd0aD9hZS5jYWxsKGFyZ3VtZW50cyk6ZSwtLW58fG8ucmVzb2x2ZVdpdGgocixpKX19O2lmKG48PTEmJihMKGUsby5kb25lKGEodCkpLnJlc29sdmUsby5yZWplY3QsIW4pLCJwZW5kaW5nIj09PW8uc3RhdGUoKXx8dihpW3RdJiZpW3RdLnRoZW4pKSlyZXR1cm4gby50aGVuKCk7d2hpbGUodC0tKUwoaVt0XSxhKHQpLG8ucmVqZWN0KTtyZXR1cm4gby5wcm9taXNlKCl9fSk7dmFyIEg9L14oRXZhbHxJbnRlcm5hbHxSYW5nZXxSZWZlcmVuY2V8U3ludGF4fFR5cGV8VVJJKUVycm9yJC87Y2UuRGVmZXJyZWQuZXhjZXB0aW9uSG9vaz1mdW5jdGlvbihlLHQpe2llLmNvbnNvbGUmJmllLmNvbnNvbGUud2FybiYmZSYmSC50ZXN0KGUubmFtZSkmJmllLmNvbnNvbGUud2FybigialF1ZXJ5LkRlZmVycmVkIGV4Y2VwdGlvbjogIitlLm1lc3NhZ2UsZS5zdGFjayx0KX0sY2UucmVhZHlFeGNlcHRpb249ZnVuY3Rpb24oZSl7aWUuc2V0VGltZW91dChmdW5jdGlvbigpe3Rocm93IGV9KX07dmFyIE89Y2UuRGVmZXJyZWQoKTtmdW5jdGlvbiBQKCl7Qy5yZW1vdmVFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIixQKSxpZS5yZW1vdmVFdmVudExpc3RlbmVyKCJsb2FkIixQKSxjZS5yZWFkeSgpfWNlLmZuLnJlYWR5PWZ1bmN0aW9uKGUpe3JldHVybiBPLnRoZW4oZSlbImNhdGNoIl0oZnVuY3Rpb24oZSl7Y2UucmVhZHlFeGNlcHRpb24oZSl9KSx0aGlzfSxjZS5leHRlbmQoe2lzUmVhZHk6ITEscmVhZHlXYWl0OjEscmVhZHk6ZnVuY3Rpb24oZSl7KCEwPT09ZT8tLWNlLnJlYWR5V2FpdDpjZS5pc1JlYWR5KXx8KGNlLmlzUmVhZHk9ITApIT09ZSYmMDwtLWNlLnJlYWR5V2FpdHx8Ty5yZXNvbHZlV2l0aChDLFtjZV0pfX0pLGNlLnJlYWR5LnRoZW49Ty50aGVuLCJjb21wbGV0ZSI9PT1DLnJlYWR5U3RhdGV8fCJsb2FkaW5nIiE9PUMucmVhZHlTdGF0ZSYmIUMuZG9jdW1lbnRFbGVtZW50LmRvU2Nyb2xsP2llLnNldFRpbWVvdXQoY2UucmVhZHkpOihDLmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLFApLGllLmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLFApKTt2YXIgUj1mdW5jdGlvbihlLHQsbixyLGksbyxhKXt2YXIgcz0wLHU9ZS5sZW5ndGgsbD1udWxsPT1uO2lmKCJvYmplY3QiPT09eChuKSlmb3IocyBpbiBpPSEwLG4pUihlLHQscyxuW3NdLCEwLG8sYSk7ZWxzZSBpZih2b2lkIDAhPT1yJiYoaT0hMCx2KHIpfHwoYT0hMCksbCYmKGE/KHQuY2FsbChlLHIpLHQ9bnVsbCk6KGw9dCx0PWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gbC5jYWxsKGNlKGUpLG4pfSkpLHQpKWZvcig7czx1O3MrKyl0KGVbc10sbixhP3I6ci5jYWxsKGVbc10scyx0KGVbc10sbikpKTtyZXR1cm4gaT9lOmw/dC5jYWxsKGUpOnU/dChlWzBdLG4pOm99LE09L14tbXMtLyxJPS8tKFthLXpdKS9nO2Z1bmN0aW9uIFcoZSx0KXtyZXR1cm4gdC50b1VwcGVyQ2FzZSgpfWZ1bmN0aW9uIEYoZSl7cmV0dXJuIGUucmVwbGFjZShNLCJtcy0iKS5yZXBsYWNlKEksVyl9dmFyICQ9ZnVuY3Rpb24oZSl7cmV0dXJuIDE9PT1lLm5vZGVUeXBlfHw5PT09ZS5ub2RlVHlwZXx8IStlLm5vZGVUeXBlfTtmdW5jdGlvbiBCKCl7dGhpcy5leHBhbmRvPWNlLmV4cGFuZG8rQi51aWQrK31CLnVpZD0xLEIucHJvdG90eXBlPXtjYWNoZTpmdW5jdGlvbihlKXt2YXIgdD1lW3RoaXMuZXhwYW5kb107cmV0dXJuIHR8fCh0PXt9LCQoZSkmJihlLm5vZGVUeXBlP2VbdGhpcy5leHBhbmRvXT10Ok9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHRoaXMuZXhwYW5kbyx7dmFsdWU6dCxjb25maWd1cmFibGU6ITB9KSkpLHR9LHNldDpmdW5jdGlvbihlLHQsbil7dmFyIHIsaT10aGlzLmNhY2hlKGUpO2lmKCJzdHJpbmciPT10eXBlb2YgdClpW0YodCldPW47ZWxzZSBmb3IociBpbiB0KWlbRihyKV09dFtyXTtyZXR1cm4gaX0sZ2V0OmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHZvaWQgMD09PXQ/dGhpcy5jYWNoZShlKTplW3RoaXMuZXhwYW5kb10mJmVbdGhpcy5leHBhbmRvXVtGKHQpXX0sYWNjZXNzOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gdm9pZCAwPT09dHx8dCYmInN0cmluZyI9PXR5cGVvZiB0JiZ2b2lkIDA9PT1uP3RoaXMuZ2V0KGUsdCk6KHRoaXMuc2V0KGUsdCxuKSx2b2lkIDAhPT1uP246dCl9LHJlbW92ZTpmdW5jdGlvbihlLHQpe3ZhciBuLHI9ZVt0aGlzLmV4cGFuZG9dO2lmKHZvaWQgMCE9PXIpe2lmKHZvaWQgMCE9PXQpe249KHQ9QXJyYXkuaXNBcnJheSh0KT90Lm1hcChGKToodD1GKHQpKWluIHI/W3RdOnQubWF0Y2goRCl8fFtdKS5sZW5ndGg7d2hpbGUobi0tKWRlbGV0ZSByW3Rbbl1dfSh2b2lkIDA9PT10fHxjZS5pc0VtcHR5T2JqZWN0KHIpKSYmKGUubm9kZVR5cGU/ZVt0aGlzLmV4cGFuZG9dPXZvaWQgMDpkZWxldGUgZVt0aGlzLmV4cGFuZG9dKX19LGhhc0RhdGE6ZnVuY3Rpb24oZSl7dmFyIHQ9ZVt0aGlzLmV4cGFuZG9dO3JldHVybiB2b2lkIDAhPT10JiYhY2UuaXNFbXB0eU9iamVjdCh0KX19O3ZhciBfPW5ldyBCLFg9bmV3IEIsVT0vXig/Olx7W1x3XFddKlx9fFxbW1x3XFddKlxdKSQvLHo9L1tBLVpdL2c7ZnVuY3Rpb24gVihlLHQsbil7dmFyIHIsaTtpZih2b2lkIDA9PT1uJiYxPT09ZS5ub2RlVHlwZSlpZihyPSJkYXRhLSIrdC5yZXBsYWNlKHosIi0kJiIpLnRvTG93ZXJDYXNlKCksInN0cmluZyI9PXR5cGVvZihuPWUuZ2V0QXR0cmlidXRlKHIpKSl7dHJ5e249InRydWUiPT09KGk9bil8fCJmYWxzZSIhPT1pJiYoIm51bGwiPT09aT9udWxsOmk9PT0raSsiIj8raTpVLnRlc3QoaSk/SlNPTi5wYXJzZShpKTppKX1jYXRjaChlKXt9WC5zZXQoZSx0LG4pfWVsc2Ugbj12b2lkIDA7cmV0dXJuIG59Y2UuZXh0ZW5kKHtoYXNEYXRhOmZ1bmN0aW9uKGUpe3JldHVybiBYLmhhc0RhdGEoZSl8fF8uaGFzRGF0YShlKX0sZGF0YTpmdW5jdGlvbihlLHQsbil7cmV0dXJuIFguYWNjZXNzKGUsdCxuKX0scmVtb3ZlRGF0YTpmdW5jdGlvbihlLHQpe1gucmVtb3ZlKGUsdCl9LF9kYXRhOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gXy5hY2Nlc3MoZSx0LG4pfSxfcmVtb3ZlRGF0YTpmdW5jdGlvbihlLHQpe18ucmVtb3ZlKGUsdCl9fSksY2UuZm4uZXh0ZW5kKHtkYXRhOmZ1bmN0aW9uKG4sZSl7dmFyIHQscixpLG89dGhpc1swXSxhPW8mJm8uYXR0cmlidXRlcztpZih2b2lkIDA9PT1uKXtpZih0aGlzLmxlbmd0aCYmKGk9WC5nZXQobyksMT09PW8ubm9kZVR5cGUmJiFfLmdldChvLCJoYXNEYXRhQXR0cnMiKSkpe3Q9YS5sZW5ndGg7d2hpbGUodC0tKWFbdF0mJjA9PT0ocj1hW3RdLm5hbWUpLmluZGV4T2YoImRhdGEtIikmJihyPUYoci5zbGljZSg1KSksVihvLHIsaVtyXSkpO18uc2V0KG8sImhhc0RhdGFBdHRycyIsITApfXJldHVybiBpfXJldHVybiJvYmplY3QiPT10eXBlb2Ygbj90aGlzLmVhY2goZnVuY3Rpb24oKXtYLnNldCh0aGlzLG4pfSk6Uih0aGlzLGZ1bmN0aW9uKGUpe3ZhciB0O2lmKG8mJnZvaWQgMD09PWUpcmV0dXJuIHZvaWQgMCE9PSh0PVguZ2V0KG8sbikpP3Q6dm9pZCAwIT09KHQ9VihvLG4pKT90OnZvaWQgMDt0aGlzLmVhY2goZnVuY3Rpb24oKXtYLnNldCh0aGlzLG4sZSl9KX0sbnVsbCxlLDE8YXJndW1lbnRzLmxlbmd0aCxudWxsLCEwKX0scmVtb3ZlRGF0YTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7WC5yZW1vdmUodGhpcyxlKX0pfX0pLGNlLmV4dGVuZCh7cXVldWU6ZnVuY3Rpb24oZSx0LG4pe3ZhciByO2lmKGUpcmV0dXJuIHQ9KHR8fCJmeCIpKyJxdWV1ZSIscj1fLmdldChlLHQpLG4mJighcnx8QXJyYXkuaXNBcnJheShuKT9yPV8uYWNjZXNzKGUsdCxjZS5tYWtlQXJyYXkobikpOnIucHVzaChuKSkscnx8W119LGRlcXVldWU6ZnVuY3Rpb24oZSx0KXt0PXR8fCJmeCI7dmFyIG49Y2UucXVldWUoZSx0KSxyPW4ubGVuZ3RoLGk9bi5zaGlmdCgpLG89Y2UuX3F1ZXVlSG9va3MoZSx0KTsiaW5wcm9ncmVzcyI9PT1pJiYoaT1uLnNoaWZ0KCksci0tKSxpJiYoImZ4Ij09PXQmJm4udW5zaGlmdCgiaW5wcm9ncmVzcyIpLGRlbGV0ZSBvLnN0b3AsaS5jYWxsKGUsZnVuY3Rpb24oKXtjZS5kZXF1ZXVlKGUsdCl9LG8pKSwhciYmbyYmby5lbXB0eS5maXJlKCl9LF9xdWV1ZUhvb2tzOmZ1bmN0aW9uKGUsdCl7dmFyIG49dCsicXVldWVIb29rcyI7cmV0dXJuIF8uZ2V0KGUsbil8fF8uYWNjZXNzKGUsbix7ZW1wdHk6Y2UuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLmFkZChmdW5jdGlvbigpe18ucmVtb3ZlKGUsW3QrInF1ZXVlIixuXSl9KX0pfX0pLGNlLmZuLmV4dGVuZCh7cXVldWU6ZnVuY3Rpb24odCxuKXt2YXIgZT0yO3JldHVybiJzdHJpbmciIT10eXBlb2YgdCYmKG49dCx0PSJmeCIsZS0tKSxhcmd1bWVudHMubGVuZ3RoPGU/Y2UucXVldWUodGhpc1swXSx0KTp2b2lkIDA9PT1uP3RoaXM6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGU9Y2UucXVldWUodGhpcyx0LG4pO2NlLl9xdWV1ZUhvb2tzKHRoaXMsdCksImZ4Ij09PXQmJiJpbnByb2dyZXNzIiE9PWVbMF0mJmNlLmRlcXVldWUodGhpcyx0KX0pfSxkZXF1ZXVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtjZS5kZXF1ZXVlKHRoaXMsZSl9KX0sY2xlYXJRdWV1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5xdWV1ZShlfHwiZngiLFtdKX0scHJvbWlzZTpmdW5jdGlvbihlLHQpe3ZhciBuLHI9MSxpPWNlLkRlZmVycmVkKCksbz10aGlzLGE9dGhpcy5sZW5ndGgscz1mdW5jdGlvbigpey0tcnx8aS5yZXNvbHZlV2l0aChvLFtvXSl9OyJzdHJpbmciIT10eXBlb2YgZSYmKHQ9ZSxlPXZvaWQgMCksZT1lfHwiZngiO3doaWxlKGEtLSkobj1fLmdldChvW2FdLGUrInF1ZXVlSG9va3MiKSkmJm4uZW1wdHkmJihyKyssbi5lbXB0eS5hZGQocykpO3JldHVybiBzKCksaS5wcm9taXNlKHQpfX0pO3ZhciBHPS9bKy1dPyg/OlxkKlwufClcZCsoPzpbZUVdWystXT9cZCt8KS8uc291cmNlLFk9bmV3IFJlZ0V4cCgiXig/OihbKy1dKT18KSgiK0crIikoW2EteiVdKikkIiwiaSIpLFE9WyJUb3AiLCJSaWdodCIsIkJvdHRvbSIsIkxlZnQiXSxKPUMuZG9jdW1lbnRFbGVtZW50LEs9ZnVuY3Rpb24oZSl7cmV0dXJuIGNlLmNvbnRhaW5zKGUub3duZXJEb2N1bWVudCxlKX0sWj17Y29tcG9zZWQ6ITB9O0ouZ2V0Um9vdE5vZGUmJihLPWZ1bmN0aW9uKGUpe3JldHVybiBjZS5jb250YWlucyhlLm93bmVyRG9jdW1lbnQsZSl8fGUuZ2V0Um9vdE5vZGUoWik9PT1lLm93bmVyRG9jdW1lbnR9KTt2YXIgZWU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4ibm9uZSI9PT0oZT10fHxlKS5zdHlsZS5kaXNwbGF5fHwiIj09PWUuc3R5bGUuZGlzcGxheSYmSyhlKSYmIm5vbmUiPT09Y2UuY3NzKGUsImRpc3BsYXkiKX07ZnVuY3Rpb24gdGUoZSx0LG4scil7dmFyIGksbyxhPTIwLHM9cj9mdW5jdGlvbigpe3JldHVybiByLmN1cigpfTpmdW5jdGlvbigpe3JldHVybiBjZS5jc3MoZSx0LCIiKX0sdT1zKCksbD1uJiZuWzNdfHwoY2UuY3NzTnVtYmVyW3RdPyIiOiJweCIpLGM9ZS5ub2RlVHlwZSYmKGNlLmNzc051bWJlclt0XXx8InB4IiE9PWwmJit1KSYmWS5leGVjKGNlLmNzcyhlLHQpKTtpZihjJiZjWzNdIT09bCl7dS89MixsPWx8fGNbM10sYz0rdXx8MTt3aGlsZShhLS0pY2Uuc3R5bGUoZSx0LGMrbCksKDEtbykqKDEtKG89cygpL3V8fC41KSk8PTAmJihhPTApLGMvPW87Yyo9MixjZS5zdHlsZShlLHQsYytsKSxuPW58fFtdfXJldHVybiBuJiYoYz0rY3x8K3V8fDAsaT1uWzFdP2MrKG5bMV0rMSkqblsyXTorblsyXSxyJiYoci51bml0PWwsci5zdGFydD1jLHIuZW5kPWkpKSxpfXZhciBuZT17fTtmdW5jdGlvbiByZShlLHQpe2Zvcih2YXIgbixyLGksbyxhLHMsdSxsPVtdLGM9MCxmPWUubGVuZ3RoO2M8ZjtjKyspKHI9ZVtjXSkuc3R5bGUmJihuPXIuc3R5bGUuZGlzcGxheSx0Pygibm9uZSI9PT1uJiYobFtjXT1fLmdldChyLCJkaXNwbGF5Iil8fG51bGwsbFtjXXx8KHIuc3R5bGUuZGlzcGxheT0iIikpLCIiPT09ci5zdHlsZS5kaXNwbGF5JiZlZShyKSYmKGxbY109KHU9YT1vPXZvaWQgMCxhPShpPXIpLm93bmVyRG9jdW1lbnQscz1pLm5vZGVOYW1lLCh1PW5lW3NdKXx8KG89YS5ib2R5LmFwcGVuZENoaWxkKGEuY3JlYXRlRWxlbWVudChzKSksdT1jZS5jc3MobywiZGlzcGxheSIpLG8ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChvKSwibm9uZSI9PT11JiYodT0iYmxvY2siKSxuZVtzXT11KSkpKToibm9uZSIhPT1uJiYobFtjXT0ibm9uZSIsXy5zZXQociwiZGlzcGxheSIsbikpKTtmb3IoYz0wO2M8ZjtjKyspbnVsbCE9bFtjXSYmKGVbY10uc3R5bGUuZGlzcGxheT1sW2NdKTtyZXR1cm4gZX1jZS5mbi5leHRlbmQoe3Nob3c6ZnVuY3Rpb24oKXtyZXR1cm4gcmUodGhpcywhMCl9LGhpZGU6ZnVuY3Rpb24oKXtyZXR1cm4gcmUodGhpcyl9LHRvZ2dsZTpmdW5jdGlvbihlKXtyZXR1cm4iYm9vbGVhbiI9PXR5cGVvZiBlP2U/dGhpcy5zaG93KCk6dGhpcy5oaWRlKCk6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7ZWUodGhpcyk/Y2UodGhpcykuc2hvdygpOmNlKHRoaXMpLmhpZGUoKX0pfX0pO3ZhciB4ZSxiZSx3ZT0vXig/OmNoZWNrYm94fHJhZGlvKSQvaSxUZT0vPChbYS16XVteXC9cMD5ceDIwXHRcclxuXGZdKikvaSxDZT0vXiR8Xm1vZHVsZSR8XC8oPzpqYXZhfGVjbWEpc2NyaXB0L2k7eGU9Qy5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCkuYXBwZW5kQ2hpbGQoQy5jcmVhdGVFbGVtZW50KCJkaXYiKSksKGJlPUMuY3JlYXRlRWxlbWVudCgiaW5wdXQiKSkuc2V0QXR0cmlidXRlKCJ0eXBlIiwicmFkaW8iKSxiZS5zZXRBdHRyaWJ1dGUoImNoZWNrZWQiLCJjaGVja2VkIiksYmUuc2V0QXR0cmlidXRlKCJuYW1lIiwidCIpLHhlLmFwcGVuZENoaWxkKGJlKSxsZS5jaGVja0Nsb25lPXhlLmNsb25lTm9kZSghMCkuY2xvbmVOb2RlKCEwKS5sYXN0Q2hpbGQuY2hlY2tlZCx4ZS5pbm5lckhUTUw9Ijx0ZXh0YXJlYT54PC90ZXh0YXJlYT4iLGxlLm5vQ2xvbmVDaGVja2VkPSEheGUuY2xvbmVOb2RlKCEwKS5sYXN0Q2hpbGQuZGVmYXVsdFZhbHVlLHhlLmlubmVySFRNTD0iPG9wdGlvbj48L29wdGlvbj4iLGxlLm9wdGlvbj0hIXhlLmxhc3RDaGlsZDt2YXIga2U9e3RoZWFkOlsxLCI8dGFibGU+IiwiPC90YWJsZT4iXSxjb2w6WzIsIjx0YWJsZT48Y29sZ3JvdXA+IiwiPC9jb2xncm91cD48L3RhYmxlPiJdLHRyOlsyLCI8dGFibGU+PHRib2R5PiIsIjwvdGJvZHk+PC90YWJsZT4iXSx0ZDpbMywiPHRhYmxlPjx0Ym9keT48dHI+IiwiPC90cj48L3Rib2R5PjwvdGFibGU+Il0sX2RlZmF1bHQ6WzAsIiIsIiJdfTtmdW5jdGlvbiBTZShlLHQpe3ZhciBuO3JldHVybiBuPSJ1bmRlZmluZWQiIT10eXBlb2YgZS5nZXRFbGVtZW50c0J5VGFnTmFtZT9lLmdldEVsZW1lbnRzQnlUYWdOYW1lKHR8fCIqIik6InVuZGVmaW5lZCIhPXR5cGVvZiBlLnF1ZXJ5U2VsZWN0b3JBbGw/ZS5xdWVyeVNlbGVjdG9yQWxsKHR8fCIqIik6W10sdm9pZCAwPT09dHx8dCYmZmUoZSx0KT9jZS5tZXJnZShbZV0sbik6bn1mdW5jdGlvbiBFZShlLHQpe2Zvcih2YXIgbj0wLHI9ZS5sZW5ndGg7bjxyO24rKylfLnNldChlW25dLCJnbG9iYWxFdmFsIiwhdHx8Xy5nZXQodFtuXSwiZ2xvYmFsRXZhbCIpKX1rZS50Ym9keT1rZS50Zm9vdD1rZS5jb2xncm91cD1rZS5jYXB0aW9uPWtlLnRoZWFkLGtlLnRoPWtlLnRkLGxlLm9wdGlvbnx8KGtlLm9wdGdyb3VwPWtlLm9wdGlvbj1bMSwiPHNlbGVjdCBtdWx0aXBsZT0nbXVsdGlwbGUnPiIsIjwvc2VsZWN0PiJdKTt2YXIgamU9Lzx8JiM/XHcrOy87ZnVuY3Rpb24gQWUoZSx0LG4scixpKXtmb3IodmFyIG8sYSxzLHUsbCxjLGY9dC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCkscD1bXSxkPTAsaD1lLmxlbmd0aDtkPGg7ZCsrKWlmKChvPWVbZF0pfHwwPT09bylpZigib2JqZWN0Ij09PXgobykpY2UubWVyZ2UocCxvLm5vZGVUeXBlP1tvXTpvKTtlbHNlIGlmKGplLnRlc3Qobykpe2E9YXx8Zi5hcHBlbmRDaGlsZCh0LmNyZWF0ZUVsZW1lbnQoImRpdiIpKSxzPShUZS5leGVjKG8pfHxbIiIsIiJdKVsxXS50b0xvd2VyQ2FzZSgpLHU9a2Vbc118fGtlLl9kZWZhdWx0LGEuaW5uZXJIVE1MPXVbMV0rY2UuaHRtbFByZWZpbHRlcihvKSt1WzJdLGM9dVswXTt3aGlsZShjLS0pYT1hLmxhc3RDaGlsZDtjZS5tZXJnZShwLGEuY2hpbGROb2RlcyksKGE9Zi5maXJzdENoaWxkKS50ZXh0Q29udGVudD0iIn1lbHNlIHAucHVzaCh0LmNyZWF0ZVRleHROb2RlKG8pKTtmLnRleHRDb250ZW50PSIiLGQ9MDt3aGlsZShvPXBbZCsrXSlpZihyJiYtMTxjZS5pbkFycmF5KG8scikpaSYmaS5wdXNoKG8pO2Vsc2UgaWYobD1LKG8pLGE9U2UoZi5hcHBlbmRDaGlsZChvKSwic2NyaXB0IiksbCYmRWUoYSksbil7Yz0wO3doaWxlKG89YVtjKytdKUNlLnRlc3Qoby50eXBlfHwiIikmJm4ucHVzaChvKX1yZXR1cm4gZn12YXIgRGU9L14oW14uXSopKD86XC4oLispfCkvO2Z1bmN0aW9uIE5lKCl7cmV0dXJuITB9ZnVuY3Rpb24gcWUoKXtyZXR1cm4hMX1mdW5jdGlvbiBMZShlLHQsbixyLGksbyl7dmFyIGEscztpZigib2JqZWN0Ij09dHlwZW9mIHQpe2ZvcihzIGluInN0cmluZyIhPXR5cGVvZiBuJiYocj1yfHxuLG49dm9pZCAwKSx0KUxlKGUscyxuLHIsdFtzXSxvKTtyZXR1cm4gZX1pZihudWxsPT1yJiZudWxsPT1pPyhpPW4scj1uPXZvaWQgMCk6bnVsbD09aSYmKCJzdHJpbmciPT10eXBlb2Ygbj8oaT1yLHI9dm9pZCAwKTooaT1yLHI9bixuPXZvaWQgMCkpLCExPT09aSlpPXFlO2Vsc2UgaWYoIWkpcmV0dXJuIGU7cmV0dXJuIDE9PT1vJiYoYT1pLChpPWZ1bmN0aW9uKGUpe3JldHVybiBjZSgpLm9mZihlKSxhLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pLmd1aWQ9YS5ndWlkfHwoYS5ndWlkPWNlLmd1aWQrKykpLGUuZWFjaChmdW5jdGlvbigpe2NlLmV2ZW50LmFkZCh0aGlzLHQsaSxyLG4pfSl9ZnVuY3Rpb24gSGUoZSxyLHQpe3Q/KF8uc2V0KGUsciwhMSksY2UuZXZlbnQuYWRkKGUscix7bmFtZXNwYWNlOiExLGhhbmRsZXI6ZnVuY3Rpb24oZSl7dmFyIHQsbj1fLmdldCh0aGlzLHIpO2lmKDEmZS5pc1RyaWdnZXImJnRoaXNbcl0pe2lmKG4pKGNlLmV2ZW50LnNwZWNpYWxbcl18fHt9KS5kZWxlZ2F0ZVR5cGUmJmUuc3RvcFByb3BhZ2F0aW9uKCk7ZWxzZSBpZihuPWFlLmNhbGwoYXJndW1lbnRzKSxfLnNldCh0aGlzLHIsbiksdGhpc1tyXSgpLHQ9Xy5nZXQodGhpcyxyKSxfLnNldCh0aGlzLHIsITEpLG4hPT10KXJldHVybiBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLGUucHJldmVudERlZmF1bHQoKSx0fWVsc2UgbiYmKF8uc2V0KHRoaXMscixjZS5ldmVudC50cmlnZ2VyKG5bMF0sbi5zbGljZSgxKSx0aGlzKSksZS5zdG9wUHJvcGFnYXRpb24oKSxlLmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkPU5lKX19KSk6dm9pZCAwPT09Xy5nZXQoZSxyKSYmY2UuZXZlbnQuYWRkKGUscixOZSl9Y2UuZXZlbnQ9e2dsb2JhbDp7fSxhZGQ6ZnVuY3Rpb24odCxlLG4scixpKXt2YXIgbyxhLHMsdSxsLGMsZixwLGQsaCxnLHY9Xy5nZXQodCk7aWYoJCh0KSl7bi5oYW5kbGVyJiYobj0obz1uKS5oYW5kbGVyLGk9by5zZWxlY3RvciksaSYmY2UuZmluZC5tYXRjaGVzU2VsZWN0b3IoSixpKSxuLmd1aWR8fChuLmd1aWQ9Y2UuZ3VpZCsrKSwodT12LmV2ZW50cyl8fCh1PXYuZXZlbnRzPU9iamVjdC5jcmVhdGUobnVsbCkpLChhPXYuaGFuZGxlKXx8KGE9di5oYW5kbGU9ZnVuY3Rpb24oZSl7cmV0dXJuInVuZGVmaW5lZCIhPXR5cGVvZiBjZSYmY2UuZXZlbnQudHJpZ2dlcmVkIT09ZS50eXBlP2NlLmV2ZW50LmRpc3BhdGNoLmFwcGx5KHQsYXJndW1lbnRzKTp2b2lkIDB9KSxsPShlPShlfHwiIikubWF0Y2goRCl8fFsiIl0pLmxlbmd0aDt3aGlsZShsLS0pZD1nPShzPURlLmV4ZWMoZVtsXSl8fFtdKVsxXSxoPShzWzJdfHwiIikuc3BsaXQoIi4iKS5zb3J0KCksZCYmKGY9Y2UuZXZlbnQuc3BlY2lhbFtkXXx8e30sZD0oaT9mLmRlbGVnYXRlVHlwZTpmLmJpbmRUeXBlKXx8ZCxmPWNlLmV2ZW50LnNwZWNpYWxbZF18fHt9LGM9Y2UuZXh0ZW5kKHt0eXBlOmQsb3JpZ1R5cGU6ZyxkYXRhOnIsaGFuZGxlcjpuLGd1aWQ6bi5ndWlkLHNlbGVjdG9yOmksbmVlZHNDb250ZXh0OmkmJmNlLmV4cHIubWF0Y2gubmVlZHNDb250ZXh0LnRlc3QoaSksbmFtZXNwYWNlOmguam9pbigiLiIpfSxvKSwocD11W2RdKXx8KChwPXVbZF09W10pLmRlbGVnYXRlQ291bnQ9MCxmLnNldHVwJiYhMSE9PWYuc2V0dXAuY2FsbCh0LHIsaCxhKXx8dC5hZGRFdmVudExpc3RlbmVyJiZ0LmFkZEV2ZW50TGlzdGVuZXIoZCxhKSksZi5hZGQmJihmLmFkZC5jYWxsKHQsYyksYy5oYW5kbGVyLmd1aWR8fChjLmhhbmRsZXIuZ3VpZD1uLmd1aWQpKSxpP3Auc3BsaWNlKHAuZGVsZWdhdGVDb3VudCsrLDAsYyk6cC5wdXNoKGMpLGNlLmV2ZW50Lmdsb2JhbFtkXT0hMCl9fSxyZW1vdmU6ZnVuY3Rpb24oZSx0LG4scixpKXt2YXIgbyxhLHMsdSxsLGMsZixwLGQsaCxnLHY9Xy5oYXNEYXRhKGUpJiZfLmdldChlKTtpZih2JiYodT12LmV2ZW50cykpe2w9KHQ9KHR8fCIiKS5tYXRjaChEKXx8WyIiXSkubGVuZ3RoO3doaWxlKGwtLSlpZihkPWc9KHM9RGUuZXhlYyh0W2xdKXx8W10pWzFdLGg9KHNbMl18fCIiKS5zcGxpdCgiLiIpLnNvcnQoKSxkKXtmPWNlLmV2ZW50LnNwZWNpYWxbZF18fHt9LHA9dVtkPShyP2YuZGVsZWdhdGVUeXBlOmYuYmluZFR5cGUpfHxkXXx8W10scz1zWzJdJiZuZXcgUmVnRXhwKCIoXnxcXC4pIitoLmpvaW4oIlxcLig/Oi4qXFwufCkiKSsiKFxcLnwkKSIpLGE9bz1wLmxlbmd0aDt3aGlsZShvLS0pYz1wW29dLCFpJiZnIT09Yy5vcmlnVHlwZXx8biYmbi5ndWlkIT09Yy5ndWlkfHxzJiYhcy50ZXN0KGMubmFtZXNwYWNlKXx8ciYmciE9PWMuc2VsZWN0b3ImJigiKioiIT09cnx8IWMuc2VsZWN0b3IpfHwocC5zcGxpY2UobywxKSxjLnNlbGVjdG9yJiZwLmRlbGVnYXRlQ291bnQtLSxmLnJlbW92ZSYmZi5yZW1vdmUuY2FsbChlLGMpKTthJiYhcC5sZW5ndGgmJihmLnRlYXJkb3duJiYhMSE9PWYudGVhcmRvd24uY2FsbChlLGgsdi5oYW5kbGUpfHxjZS5yZW1vdmVFdmVudChlLGQsdi5oYW5kbGUpLGRlbGV0ZSB1W2RdKX1lbHNlIGZvcihkIGluIHUpY2UuZXZlbnQucmVtb3ZlKGUsZCt0W2xdLG4sciwhMCk7Y2UuaXNFbXB0eU9iamVjdCh1KSYmXy5yZW1vdmUoZSwiaGFuZGxlIGV2ZW50cyIpfX0sZGlzcGF0Y2g6ZnVuY3Rpb24oZSl7dmFyIHQsbixyLGksbyxhLHM9bmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGgpLHU9Y2UuZXZlbnQuZml4KGUpLGw9KF8uZ2V0KHRoaXMsImV2ZW50cyIpfHxPYmplY3QuY3JlYXRlKG51bGwpKVt1LnR5cGVdfHxbXSxjPWNlLmV2ZW50LnNwZWNpYWxbdS50eXBlXXx8e307Zm9yKHNbMF09dSx0PTE7dDxhcmd1bWVudHMubGVuZ3RoO3QrKylzW3RdPWFyZ3VtZW50c1t0XTtpZih1LmRlbGVnYXRlVGFyZ2V0PXRoaXMsIWMucHJlRGlzcGF0Y2h8fCExIT09Yy5wcmVEaXNwYXRjaC5jYWxsKHRoaXMsdSkpe2E9Y2UuZXZlbnQuaGFuZGxlcnMuY2FsbCh0aGlzLHUsbCksdD0wO3doaWxlKChpPWFbdCsrXSkmJiF1LmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpe3UuY3VycmVudFRhcmdldD1pLmVsZW0sbj0wO3doaWxlKChvPWkuaGFuZGxlcnNbbisrXSkmJiF1LmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCkpdS5ybmFtZXNwYWNlJiYhMSE9PW8ubmFtZXNwYWNlJiYhdS5ybmFtZXNwYWNlLnRlc3Qoby5uYW1lc3BhY2UpfHwodS5oYW5kbGVPYmo9byx1LmRhdGE9by5kYXRhLHZvaWQgMCE9PShyPSgoY2UuZXZlbnQuc3BlY2lhbFtvLm9yaWdUeXBlXXx8e30pLmhhbmRsZXx8by5oYW5kbGVyKS5hcHBseShpLmVsZW0scykpJiYhMT09PSh1LnJlc3VsdD1yKSYmKHUucHJldmVudERlZmF1bHQoKSx1LnN0b3BQcm9wYWdhdGlvbigpKSl9cmV0dXJuIGMucG9zdERpc3BhdGNoJiZjLnBvc3REaXNwYXRjaC5jYWxsKHRoaXMsdSksdS5yZXN1bHR9fSxoYW5kbGVyczpmdW5jdGlvbihlLHQpe3ZhciBuLHIsaSxvLGEscz1bXSx1PXQuZGVsZWdhdGVDb3VudCxsPWUudGFyZ2V0O2lmKHUmJmwubm9kZVR5cGUmJiEoImNsaWNrIj09PWUudHlwZSYmMTw9ZS5idXR0b24pKWZvcig7bCE9PXRoaXM7bD1sLnBhcmVudE5vZGV8fHRoaXMpaWYoMT09PWwubm9kZVR5cGUmJigiY2xpY2siIT09ZS50eXBlfHwhMCE9PWwuZGlzYWJsZWQpKXtmb3Iobz1bXSxhPXt9LG49MDtuPHU7bisrKXZvaWQgMD09PWFbaT0ocj10W25dKS5zZWxlY3RvcisiICJdJiYoYVtpXT1yLm5lZWRzQ29udGV4dD8tMTxjZShpLHRoaXMpLmluZGV4KGwpOmNlLmZpbmQoaSx0aGlzLG51bGwsW2xdKS5sZW5ndGgpLGFbaV0mJm8ucHVzaChyKTtvLmxlbmd0aCYmcy5wdXNoKHtlbGVtOmwsaGFuZGxlcnM6b30pfXJldHVybiBsPXRoaXMsdTx0Lmxlbmd0aCYmcy5wdXNoKHtlbGVtOmwsaGFuZGxlcnM6dC5zbGljZSh1KX0pLHN9LGFkZFByb3A6ZnVuY3Rpb24odCxlKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoY2UuRXZlbnQucHJvdG90eXBlLHQse2VudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLGdldDp2KGUpP2Z1bmN0aW9uKCl7aWYodGhpcy5vcmlnaW5hbEV2ZW50KXJldHVybiBlKHRoaXMub3JpZ2luYWxFdmVudCl9OmZ1bmN0aW9uKCl7aWYodGhpcy5vcmlnaW5hbEV2ZW50KXJldHVybiB0aGlzLm9yaWdpbmFsRXZlbnRbdF19LHNldDpmdW5jdGlvbihlKXtPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcyx0LHtlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMCx2YWx1ZTplfSl9fSl9LGZpeDpmdW5jdGlvbihlKXtyZXR1cm4gZVtjZS5leHBhbmRvXT9lOm5ldyBjZS5FdmVudChlKX0sc3BlY2lhbDp7bG9hZDp7bm9CdWJibGU6ITB9LGNsaWNrOntzZXR1cDpmdW5jdGlvbihlKXt2YXIgdD10aGlzfHxlO3JldHVybiB3ZS50ZXN0KHQudHlwZSkmJnQuY2xpY2smJmZlKHQsImlucHV0IikmJkhlKHQsImNsaWNrIiwhMCksITF9LHRyaWdnZXI6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpc3x8ZTtyZXR1cm4gd2UudGVzdCh0LnR5cGUpJiZ0LmNsaWNrJiZmZSh0LCJpbnB1dCIpJiZIZSh0LCJjbGljayIpLCEwfSxfZGVmYXVsdDpmdW5jdGlvbihlKXt2YXIgdD1lLnRhcmdldDtyZXR1cm4gd2UudGVzdCh0LnR5cGUpJiZ0LmNsaWNrJiZmZSh0LCJpbnB1dCIpJiZfLmdldCh0LCJjbGljayIpfHxmZSh0LCJhIil9fSxiZWZvcmV1bmxvYWQ6e3Bvc3REaXNwYXRjaDpmdW5jdGlvbihlKXt2b2lkIDAhPT1lLnJlc3VsdCYmZS5vcmlnaW5hbEV2ZW50JiYoZS5vcmlnaW5hbEV2ZW50LnJldHVyblZhbHVlPWUucmVzdWx0KX19fX0sY2UucmVtb3ZlRXZlbnQ9ZnVuY3Rpb24oZSx0LG4pe2UucmVtb3ZlRXZlbnRMaXN0ZW5lciYmZS5yZW1vdmVFdmVudExpc3RlbmVyKHQsbil9LGNlLkV2ZW50PWZ1bmN0aW9uKGUsdCl7aWYoISh0aGlzIGluc3RhbmNlb2YgY2UuRXZlbnQpKXJldHVybiBuZXcgY2UuRXZlbnQoZSx0KTtlJiZlLnR5cGU/KHRoaXMub3JpZ2luYWxFdmVudD1lLHRoaXMudHlwZT1lLnR5cGUsdGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQ9ZS5kZWZhdWx0UHJldmVudGVkfHx2b2lkIDA9PT1lLmRlZmF1bHRQcmV2ZW50ZWQmJiExPT09ZS5yZXR1cm5WYWx1ZT9OZTpxZSx0aGlzLnRhcmdldD1lLnRhcmdldCYmMz09PWUudGFyZ2V0Lm5vZGVUeXBlP2UudGFyZ2V0LnBhcmVudE5vZGU6ZS50YXJnZXQsdGhpcy5jdXJyZW50VGFyZ2V0PWUuY3VycmVudFRhcmdldCx0aGlzLnJlbGF0ZWRUYXJnZXQ9ZS5yZWxhdGVkVGFyZ2V0KTp0aGlzLnR5cGU9ZSx0JiZjZS5leHRlbmQodGhpcyx0KSx0aGlzLnRpbWVTdGFtcD1lJiZlLnRpbWVTdGFtcHx8RGF0ZS5ub3coKSx0aGlzW2NlLmV4cGFuZG9dPSEwfSxjZS5FdmVudC5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOmNlLkV2ZW50LGlzRGVmYXVsdFByZXZlbnRlZDpxZSxpc1Byb3BhZ2F0aW9uU3RvcHBlZDpxZSxpc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZDpxZSxpc1NpbXVsYXRlZDohMSxwcmV2ZW50RGVmYXVsdDpmdW5jdGlvbigpe3ZhciBlPXRoaXMub3JpZ2luYWxFdmVudDt0aGlzLmlzRGVmYXVsdFByZXZlbnRlZD1OZSxlJiYhdGhpcy5pc1NpbXVsYXRlZCYmZS5wcmV2ZW50RGVmYXVsdCgpfSxzdG9wUHJvcGFnYXRpb246ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm9yaWdpbmFsRXZlbnQ7dGhpcy5pc1Byb3BhZ2F0aW9uU3RvcHBlZD1OZSxlJiYhdGhpcy5pc1NpbXVsYXRlZCYmZS5zdG9wUHJvcGFnYXRpb24oKX0sc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vcmlnaW5hbEV2ZW50O3RoaXMuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ9TmUsZSYmIXRoaXMuaXNTaW11bGF0ZWQmJmUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksdGhpcy5zdG9wUHJvcGFnYXRpb24oKX19LGNlLmVhY2goe2FsdEtleTohMCxidWJibGVzOiEwLGNhbmNlbGFibGU6ITAsY2hhbmdlZFRvdWNoZXM6ITAsY3RybEtleTohMCxkZXRhaWw6ITAsZXZlbnRQaGFzZTohMCxtZXRhS2V5OiEwLHBhZ2VYOiEwLHBhZ2VZOiEwLHNoaWZ0S2V5OiEwLHZpZXc6ITAsImNoYXIiOiEwLGNvZGU6ITAsY2hhckNvZGU6ITAsa2V5OiEwLGtleUNvZGU6ITAsYnV0dG9uOiEwLGJ1dHRvbnM6ITAsY2xpZW50WDohMCxjbGllbnRZOiEwLG9mZnNldFg6ITAsb2Zmc2V0WTohMCxwb2ludGVySWQ6ITAscG9pbnRlclR5cGU6ITAsc2NyZWVuWDohMCxzY3JlZW5ZOiEwLHRhcmdldFRvdWNoZXM6ITAsdG9FbGVtZW50OiEwLHRvdWNoZXM6ITAsd2hpY2g6ITB9LGNlLmV2ZW50LmFkZFByb3ApLGNlLmVhY2goe2ZvY3VzOiJmb2N1c2luIixibHVyOiJmb2N1c291dCJ9LGZ1bmN0aW9uKHIsaSl7ZnVuY3Rpb24gbyhlKXtpZihDLmRvY3VtZW50TW9kZSl7dmFyIHQ9Xy5nZXQodGhpcywiaGFuZGxlIiksbj1jZS5ldmVudC5maXgoZSk7bi50eXBlPSJmb2N1c2luIj09PWUudHlwZT8iZm9jdXMiOiJibHVyIixuLmlzU2ltdWxhdGVkPSEwLHQoZSksbi50YXJnZXQ9PT1uLmN1cnJlbnRUYXJnZXQmJnQobil9ZWxzZSBjZS5ldmVudC5zaW11bGF0ZShpLGUudGFyZ2V0LGNlLmV2ZW50LmZpeChlKSl9Y2UuZXZlbnQuc3BlY2lhbFtyXT17c2V0dXA6ZnVuY3Rpb24oKXt2YXIgZTtpZihIZSh0aGlzLHIsITApLCFDLmRvY3VtZW50TW9kZSlyZXR1cm4hMTsoZT1fLmdldCh0aGlzLGkpKXx8dGhpcy5hZGRFdmVudExpc3RlbmVyKGksbyksXy5zZXQodGhpcyxpLChlfHwwKSsxKX0sdHJpZ2dlcjpmdW5jdGlvbigpe3JldHVybiBIZSh0aGlzLHIpLCEwfSx0ZWFyZG93bjpmdW5jdGlvbigpe3ZhciBlO2lmKCFDLmRvY3VtZW50TW9kZSlyZXR1cm4hMTsoZT1fLmdldCh0aGlzLGkpLTEpP18uc2V0KHRoaXMsaSxlKToodGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKGksbyksXy5yZW1vdmUodGhpcyxpKSl9LF9kZWZhdWx0OmZ1bmN0aW9uKGUpe3JldHVybiBfLmdldChlLnRhcmdldCxyKX0sZGVsZWdhdGVUeXBlOml9LGNlLmV2ZW50LnNwZWNpYWxbaV09e3NldHVwOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vd25lckRvY3VtZW50fHx0aGlzLmRvY3VtZW50fHx0aGlzLHQ9Qy5kb2N1bWVudE1vZGU/dGhpczplLG49Xy5nZXQodCxpKTtufHwoQy5kb2N1bWVudE1vZGU/dGhpcy5hZGRFdmVudExpc3RlbmVyKGksbyk6ZS5hZGRFdmVudExpc3RlbmVyKHIsbywhMCkpLF8uc2V0KHQsaSwobnx8MCkrMSl9LHRlYXJkb3duOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vd25lckRvY3VtZW50fHx0aGlzLmRvY3VtZW50fHx0aGlzLHQ9Qy5kb2N1bWVudE1vZGU/dGhpczplLG49Xy5nZXQodCxpKS0xO24/Xy5zZXQodCxpLG4pOihDLmRvY3VtZW50TW9kZT90aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoaSxvKTplLnJlbW92ZUV2ZW50TGlzdGVuZXIocixvLCEwKSxfLnJlbW92ZSh0LGkpKX19fSksY2UuZWFjaCh7bW91c2VlbnRlcjoibW91c2VvdmVyIixtb3VzZWxlYXZlOiJtb3VzZW91dCIscG9pbnRlcmVudGVyOiJwb2ludGVyb3ZlciIscG9pbnRlcmxlYXZlOiJwb2ludGVyb3V0In0sZnVuY3Rpb24oZSxpKXtjZS5ldmVudC5zcGVjaWFsW2VdPXtkZWxlZ2F0ZVR5cGU6aSxiaW5kVHlwZTppLGhhbmRsZTpmdW5jdGlvbihlKXt2YXIgdCxuPWUucmVsYXRlZFRhcmdldCxyPWUuaGFuZGxlT2JqO3JldHVybiBuJiYobj09PXRoaXN8fGNlLmNvbnRhaW5zKHRoaXMsbikpfHwoZS50eXBlPXIub3JpZ1R5cGUsdD1yLmhhbmRsZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLGUudHlwZT1pKSx0fX19KSxjZS5mbi5leHRlbmQoe29uOmZ1bmN0aW9uKGUsdCxuLHIpe3JldHVybiBMZSh0aGlzLGUsdCxuLHIpfSxvbmU6ZnVuY3Rpb24oZSx0LG4scil7cmV0dXJuIExlKHRoaXMsZSx0LG4sciwxKX0sb2ZmOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpO2lmKGUmJmUucHJldmVudERlZmF1bHQmJmUuaGFuZGxlT2JqKXJldHVybiByPWUuaGFuZGxlT2JqLGNlKGUuZGVsZWdhdGVUYXJnZXQpLm9mZihyLm5hbWVzcGFjZT9yLm9yaWdUeXBlKyIuIityLm5hbWVzcGFjZTpyLm9yaWdUeXBlLHIuc2VsZWN0b3Isci5oYW5kbGVyKSx0aGlzO2lmKCJvYmplY3QiPT10eXBlb2YgZSl7Zm9yKGkgaW4gZSl0aGlzLm9mZihpLHQsZVtpXSk7cmV0dXJuIHRoaXN9cmV0dXJuITEhPT10JiYiZnVuY3Rpb24iIT10eXBlb2YgdHx8KG49dCx0PXZvaWQgMCksITE9PT1uJiYobj1xZSksdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Y2UuZXZlbnQucmVtb3ZlKHRoaXMsZSxuLHQpfSl9fSk7dmFyIE9lPS88c2NyaXB0fDxzdHlsZXw8bGluay9pLFBlPS9jaGVja2VkXHMqKD86W149XXw9XHMqLmNoZWNrZWQuKS9pLFJlPS9eXHMqPCFcW0NEQVRBXFt8XF1cXT5ccyokL2c7ZnVuY3Rpb24gTWUoZSx0KXtyZXR1cm4gZmUoZSwidGFibGUiKSYmZmUoMTEhPT10Lm5vZGVUeXBlP3Q6dC5maXJzdENoaWxkLCJ0ciIpJiZjZShlKS5jaGlsZHJlbigidGJvZHkiKVswXXx8ZX1mdW5jdGlvbiBJZShlKXtyZXR1cm4gZS50eXBlPShudWxsIT09ZS5nZXRBdHRyaWJ1dGUoInR5cGUiKSkrIi8iK2UudHlwZSxlfWZ1bmN0aW9uIFdlKGUpe3JldHVybiJ0cnVlLyI9PT0oZS50eXBlfHwiIikuc2xpY2UoMCw1KT9lLnR5cGU9ZS50eXBlLnNsaWNlKDUpOmUucmVtb3ZlQXR0cmlidXRlKCJ0eXBlIiksZX1mdW5jdGlvbiBGZShlLHQpe3ZhciBuLHIsaSxvLGEscztpZigxPT09dC5ub2RlVHlwZSl7aWYoXy5oYXNEYXRhKGUpJiYocz1fLmdldChlKS5ldmVudHMpKWZvcihpIGluIF8ucmVtb3ZlKHQsImhhbmRsZSBldmVudHMiKSxzKWZvcihuPTAscj1zW2ldLmxlbmd0aDtuPHI7bisrKWNlLmV2ZW50LmFkZCh0LGksc1tpXVtuXSk7WC5oYXNEYXRhKGUpJiYobz1YLmFjY2VzcyhlKSxhPWNlLmV4dGVuZCh7fSxvKSxYLnNldCh0LGEpKX19ZnVuY3Rpb24gJGUobixyLGksbyl7cj1nKHIpO3ZhciBlLHQsYSxzLHUsbCxjPTAsZj1uLmxlbmd0aCxwPWYtMSxkPXJbMF0saD12KGQpO2lmKGh8fDE8ZiYmInN0cmluZyI9PXR5cGVvZiBkJiYhbGUuY2hlY2tDbG9uZSYmUGUudGVzdChkKSlyZXR1cm4gbi5lYWNoKGZ1bmN0aW9uKGUpe3ZhciB0PW4uZXEoZSk7aCYmKHJbMF09ZC5jYWxsKHRoaXMsZSx0Lmh0bWwoKSkpLCRlKHQscixpLG8pfSk7aWYoZiYmKHQ9KGU9QWUocixuWzBdLm93bmVyRG9jdW1lbnQsITEsbixvKSkuZmlyc3RDaGlsZCwxPT09ZS5jaGlsZE5vZGVzLmxlbmd0aCYmKGU9dCksdHx8bykpe2ZvcihzPShhPWNlLm1hcChTZShlLCJzY3JpcHQiKSxJZSkpLmxlbmd0aDtjPGY7YysrKXU9ZSxjIT09cCYmKHU9Y2UuY2xvbmUodSwhMCwhMCkscyYmY2UubWVyZ2UoYSxTZSh1LCJzY3JpcHQiKSkpLGkuY2FsbChuW2NdLHUsYyk7aWYocylmb3IobD1hW2EubGVuZ3RoLTFdLm93bmVyRG9jdW1lbnQsY2UubWFwKGEsV2UpLGM9MDtjPHM7YysrKXU9YVtjXSxDZS50ZXN0KHUudHlwZXx8IiIpJiYhXy5hY2Nlc3ModSwiZ2xvYmFsRXZhbCIpJiZjZS5jb250YWlucyhsLHUpJiYodS5zcmMmJiJtb2R1bGUiIT09KHUudHlwZXx8IiIpLnRvTG93ZXJDYXNlKCk/Y2UuX2V2YWxVcmwmJiF1Lm5vTW9kdWxlJiZjZS5fZXZhbFVybCh1LnNyYyx7bm9uY2U6dS5ub25jZXx8dS5nZXRBdHRyaWJ1dGUoIm5vbmNlIil9LGwpOm0odS50ZXh0Q29udGVudC5yZXBsYWNlKFJlLCIiKSx1LGwpKX1yZXR1cm4gbn1mdW5jdGlvbiBCZShlLHQsbil7Zm9yKHZhciByLGk9dD9jZS5maWx0ZXIodCxlKTplLG89MDtudWxsIT0ocj1pW29dKTtvKyspbnx8MSE9PXIubm9kZVR5cGV8fGNlLmNsZWFuRGF0YShTZShyKSksci5wYXJlbnROb2RlJiYobiYmSyhyKSYmRWUoU2Uociwic2NyaXB0IikpLHIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChyKSk7cmV0dXJuIGV9Y2UuZXh0ZW5kKHtodG1sUHJlZmlsdGVyOmZ1bmN0aW9uKGUpe3JldHVybiBlfSxjbG9uZTpmdW5jdGlvbihlLHQsbil7dmFyIHIsaSxvLGEscyx1LGwsYz1lLmNsb25lTm9kZSghMCksZj1LKGUpO2lmKCEobGUubm9DbG9uZUNoZWNrZWR8fDEhPT1lLm5vZGVUeXBlJiYxMSE9PWUubm9kZVR5cGV8fGNlLmlzWE1MRG9jKGUpKSlmb3IoYT1TZShjKSxyPTAsaT0obz1TZShlKSkubGVuZ3RoO3I8aTtyKyspcz1vW3JdLHU9YVtyXSx2b2lkIDAsImlucHV0Ij09PShsPXUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSkmJndlLnRlc3Qocy50eXBlKT91LmNoZWNrZWQ9cy5jaGVja2VkOiJpbnB1dCIhPT1sJiYidGV4dGFyZWEiIT09bHx8KHUuZGVmYXVsdFZhbHVlPXMuZGVmYXVsdFZhbHVlKTtpZih0KWlmKG4pZm9yKG89b3x8U2UoZSksYT1hfHxTZShjKSxyPTAsaT1vLmxlbmd0aDtyPGk7cisrKUZlKG9bcl0sYVtyXSk7ZWxzZSBGZShlLGMpO3JldHVybiAwPChhPVNlKGMsInNjcmlwdCIpKS5sZW5ndGgmJkVlKGEsIWYmJlNlKGUsInNjcmlwdCIpKSxjfSxjbGVhbkRhdGE6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0LG4scixpPWNlLmV2ZW50LnNwZWNpYWwsbz0wO3ZvaWQgMCE9PShuPWVbb10pO28rKylpZigkKG4pKXtpZih0PW5bXy5leHBhbmRvXSl7aWYodC5ldmVudHMpZm9yKHIgaW4gdC5ldmVudHMpaVtyXT9jZS5ldmVudC5yZW1vdmUobixyKTpjZS5yZW1vdmVFdmVudChuLHIsdC5oYW5kbGUpO25bXy5leHBhbmRvXT12b2lkIDB9bltYLmV4cGFuZG9dJiYobltYLmV4cGFuZG9dPXZvaWQgMCl9fX0pLGNlLmZuLmV4dGVuZCh7ZGV0YWNoOmZ1bmN0aW9uKGUpe3JldHVybiBCZSh0aGlzLGUsITApfSxyZW1vdmU6ZnVuY3Rpb24oZSl7cmV0dXJuIEJlKHRoaXMsZSl9LHRleHQ6ZnVuY3Rpb24oZSl7cmV0dXJuIFIodGhpcyxmdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZT9jZS50ZXh0KHRoaXMpOnRoaXMuZW1wdHkoKS5lYWNoKGZ1bmN0aW9uKCl7MSE9PXRoaXMubm9kZVR5cGUmJjExIT09dGhpcy5ub2RlVHlwZSYmOSE9PXRoaXMubm9kZVR5cGV8fCh0aGlzLnRleHRDb250ZW50PWUpfSl9LG51bGwsZSxhcmd1bWVudHMubGVuZ3RoKX0sYXBwZW5kOmZ1bmN0aW9uKCl7cmV0dXJuICRlKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGUpezEhPT10aGlzLm5vZGVUeXBlJiYxMSE9PXRoaXMubm9kZVR5cGUmJjkhPT10aGlzLm5vZGVUeXBlfHxNZSh0aGlzLGUpLmFwcGVuZENoaWxkKGUpfSl9LHByZXBlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gJGUodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24oZSl7aWYoMT09PXRoaXMubm9kZVR5cGV8fDExPT09dGhpcy5ub2RlVHlwZXx8OT09PXRoaXMubm9kZVR5cGUpe3ZhciB0PU1lKHRoaXMsZSk7dC5pbnNlcnRCZWZvcmUoZSx0LmZpcnN0Q2hpbGQpfX0pfSxiZWZvcmU6ZnVuY3Rpb24oKXtyZXR1cm4gJGUodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24oZSl7dGhpcy5wYXJlbnROb2RlJiZ0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGUsdGhpcyl9KX0sYWZ0ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gJGUodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24oZSl7dGhpcy5wYXJlbnROb2RlJiZ0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGUsdGhpcy5uZXh0U2libGluZyl9KX0sZW1wdHk6ZnVuY3Rpb24oKXtmb3IodmFyIGUsdD0wO251bGwhPShlPXRoaXNbdF0pO3QrKykxPT09ZS5ub2RlVHlwZSYmKGNlLmNsZWFuRGF0YShTZShlLCExKSksZS50ZXh0Q29udGVudD0iIik7cmV0dXJuIHRoaXN9LGNsb25lOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIGU9bnVsbCE9ZSYmZSx0PW51bGw9PXQ/ZTp0LHRoaXMubWFwKGZ1bmN0aW9uKCl7cmV0dXJuIGNlLmNsb25lKHRoaXMsZSx0KX0pfSxodG1sOmZ1bmN0aW9uKGUpe3JldHVybiBSKHRoaXMsZnVuY3Rpb24oZSl7dmFyIHQ9dGhpc1swXXx8e30sbj0wLHI9dGhpcy5sZW5ndGg7aWYodm9pZCAwPT09ZSYmMT09PXQubm9kZVR5cGUpcmV0dXJuIHQuaW5uZXJIVE1MO2lmKCJzdHJpbmciPT10eXBlb2YgZSYmIU9lLnRlc3QoZSkmJiFrZVsoVGUuZXhlYyhlKXx8WyIiLCIiXSlbMV0udG9Mb3dlckNhc2UoKV0pe2U9Y2UuaHRtbFByZWZpbHRlcihlKTt0cnl7Zm9yKDtuPHI7bisrKTE9PT0odD10aGlzW25dfHx7fSkubm9kZVR5cGUmJihjZS5jbGVhbkRhdGEoU2UodCwhMSkpLHQuaW5uZXJIVE1MPWUpO3Q9MH1jYXRjaChlKXt9fXQmJnRoaXMuZW1wdHkoKS5hcHBlbmQoZSl9LG51bGwsZSxhcmd1bWVudHMubGVuZ3RoKX0scmVwbGFjZVdpdGg6ZnVuY3Rpb24oKXt2YXIgbj1bXTtyZXR1cm4gJGUodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5wYXJlbnROb2RlO2NlLmluQXJyYXkodGhpcyxuKTwwJiYoY2UuY2xlYW5EYXRhKFNlKHRoaXMpKSx0JiZ0LnJlcGxhY2VDaGlsZChlLHRoaXMpKX0sbil9fSksY2UuZWFjaCh7YXBwZW5kVG86ImFwcGVuZCIscHJlcGVuZFRvOiJwcmVwZW5kIixpbnNlcnRCZWZvcmU6ImJlZm9yZSIsaW5zZXJ0QWZ0ZXI6ImFmdGVyIixyZXBsYWNlQWxsOiJyZXBsYWNlV2l0aCJ9LGZ1bmN0aW9uKGUsYSl7Y2UuZm5bZV09ZnVuY3Rpb24oZSl7Zm9yKHZhciB0LG49W10scj1jZShlKSxpPXIubGVuZ3RoLTEsbz0wO288PWk7bysrKXQ9bz09PWk/dGhpczp0aGlzLmNsb25lKCEwKSxjZShyW29dKVthXSh0KSxzLmFwcGx5KG4sdC5nZXQoKSk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKG4pfX0pO3ZhciBfZT1uZXcgUmVnRXhwKCJeKCIrRysiKSg/IXB4KVthLXolXSskIiwiaSIpLFhlPS9eLS0vLFVlPWZ1bmN0aW9uKGUpe3ZhciB0PWUub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldztyZXR1cm4gdCYmdC5vcGVuZXJ8fCh0PWllKSx0LmdldENvbXB1dGVkU3R5bGUoZSl9LHplPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG89e307Zm9yKGkgaW4gdClvW2ldPWUuc3R5bGVbaV0sZS5zdHlsZVtpXT10W2ldO2ZvcihpIGluIHI9bi5jYWxsKGUpLHQpZS5zdHlsZVtpXT1vW2ldO3JldHVybiByfSxWZT1uZXcgUmVnRXhwKFEuam9pbigifCIpLCJpIik7ZnVuY3Rpb24gR2UoZSx0LG4pe3ZhciByLGksbyxhLHM9WGUudGVzdCh0KSx1PWUuc3R5bGU7cmV0dXJuKG49bnx8VWUoZSkpJiYoYT1uLmdldFByb3BlcnR5VmFsdWUodCl8fG5bdF0scyYmYSYmKGE9YS5yZXBsYWNlKHZlLCIkMSIpfHx2b2lkIDApLCIiIT09YXx8SyhlKXx8KGE9Y2Uuc3R5bGUoZSx0KSksIWxlLnBpeGVsQm94U3R5bGVzKCkmJl9lLnRlc3QoYSkmJlZlLnRlc3QodCkmJihyPXUud2lkdGgsaT11Lm1pbldpZHRoLG89dS5tYXhXaWR0aCx1Lm1pbldpZHRoPXUubWF4V2lkdGg9dS53aWR0aD1hLGE9bi53aWR0aCx1LndpZHRoPXIsdS5taW5XaWR0aD1pLHUubWF4V2lkdGg9bykpLHZvaWQgMCE9PWE/YSsiIjphfWZ1bmN0aW9uIFllKGUsdCl7cmV0dXJue2dldDpmdW5jdGlvbigpe2lmKCFlKCkpcmV0dXJuKHRoaXMuZ2V0PXQpLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtkZWxldGUgdGhpcy5nZXR9fX0hZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7aWYobCl7dS5zdHlsZS5jc3NUZXh0PSJwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0Oi0xMTExMXB4O3dpZHRoOjYwcHg7bWFyZ2luLXRvcDoxcHg7cGFkZGluZzowO2JvcmRlcjowIixsLnN0eWxlLmNzc1RleHQ9InBvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6YmxvY2s7Ym94LXNpemluZzpib3JkZXItYm94O292ZXJmbG93OnNjcm9sbDttYXJnaW46YXV0bztib3JkZXI6MXB4O3BhZGRpbmc6MXB4O3dpZHRoOjYwJTt0b3A6MSUiLEouYXBwZW5kQ2hpbGQodSkuYXBwZW5kQ2hpbGQobCk7dmFyIGU9aWUuZ2V0Q29tcHV0ZWRTdHlsZShsKTtuPSIxJSIhPT1lLnRvcCxzPTEyPT09dChlLm1hcmdpbkxlZnQpLGwuc3R5bGUucmlnaHQ9IjYwJSIsbz0zNj09PXQoZS5yaWdodCkscj0zNj09PXQoZS53aWR0aCksbC5zdHlsZS5wb3NpdGlvbj0iYWJzb2x1dGUiLGk9MTI9PT10KGwub2Zmc2V0V2lkdGgvMyksSi5yZW1vdmVDaGlsZCh1KSxsPW51bGx9fWZ1bmN0aW9uIHQoZSl7cmV0dXJuIE1hdGgucm91bmQocGFyc2VGbG9hdChlKSl9dmFyIG4scixpLG8sYSxzLHU9Qy5jcmVhdGVFbGVtZW50KCJkaXYiKSxsPUMuY3JlYXRlRWxlbWVudCgiZGl2Iik7bC5zdHlsZSYmKGwuc3R5bGUuYmFja2dyb3VuZENsaXA9ImNvbnRlbnQtYm94IixsLmNsb25lTm9kZSghMCkuc3R5bGUuYmFja2dyb3VuZENsaXA9IiIsbGUuY2xlYXJDbG9uZVN0eWxlPSJjb250ZW50LWJveCI9PT1sLnN0eWxlLmJhY2tncm91bmRDbGlwLGNlLmV4dGVuZChsZSx7Ym94U2l6aW5nUmVsaWFibGU6ZnVuY3Rpb24oKXtyZXR1cm4gZSgpLHJ9LHBpeGVsQm94U3R5bGVzOmZ1bmN0aW9uKCl7cmV0dXJuIGUoKSxvfSxwaXhlbFBvc2l0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIGUoKSxufSxyZWxpYWJsZU1hcmdpbkxlZnQ6ZnVuY3Rpb24oKXtyZXR1cm4gZSgpLHN9LHNjcm9sbGJveFNpemU6ZnVuY3Rpb24oKXtyZXR1cm4gZSgpLGl9LHJlbGlhYmxlVHJEaW1lbnNpb25zOmZ1bmN0aW9uKCl7dmFyIGUsdCxuLHI7cmV0dXJuIG51bGw9PWEmJihlPUMuY3JlYXRlRWxlbWVudCgidGFibGUiKSx0PUMuY3JlYXRlRWxlbWVudCgidHIiKSxuPUMuY3JlYXRlRWxlbWVudCgiZGl2IiksZS5zdHlsZS5jc3NUZXh0PSJwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0Oi0xMTExMXB4O2JvcmRlci1jb2xsYXBzZTpzZXBhcmF0ZSIsdC5zdHlsZS5jc3NUZXh0PSJib3JkZXI6MXB4IHNvbGlkIix0LnN0eWxlLmhlaWdodD0iMXB4IixuLnN0eWxlLmhlaWdodD0iOXB4IixuLnN0eWxlLmRpc3BsYXk9ImJsb2NrIixKLmFwcGVuZENoaWxkKGUpLmFwcGVuZENoaWxkKHQpLmFwcGVuZENoaWxkKG4pLHI9aWUuZ2V0Q29tcHV0ZWRTdHlsZSh0KSxhPXBhcnNlSW50KHIuaGVpZ2h0LDEwKStwYXJzZUludChyLmJvcmRlclRvcFdpZHRoLDEwKStwYXJzZUludChyLmJvcmRlckJvdHRvbVdpZHRoLDEwKT09PXQub2Zmc2V0SGVpZ2h0LEoucmVtb3ZlQ2hpbGQoZSkpLGF9fSkpfSgpO3ZhciBRZT1bIldlYmtpdCIsIk1veiIsIm1zIl0sSmU9Qy5jcmVhdGVFbGVtZW50KCJkaXYiKS5zdHlsZSxLZT17fTtmdW5jdGlvbiBaZShlKXt2YXIgdD1jZS5jc3NQcm9wc1tlXXx8S2VbZV07cmV0dXJuIHR8fChlIGluIEplP2U6S2VbZV09ZnVuY3Rpb24oZSl7dmFyIHQ9ZVswXS50b1VwcGVyQ2FzZSgpK2Uuc2xpY2UoMSksbj1RZS5sZW5ndGg7d2hpbGUobi0tKWlmKChlPVFlW25dK3QpaW4gSmUpcmV0dXJuIGV9KGUpfHxlKX12YXIgZXQ9L14obm9uZXx0YWJsZSg/IS1jW2VhXSkuKykvLHR0PXtwb3NpdGlvbjoiYWJzb2x1dGUiLHZpc2liaWxpdHk6ImhpZGRlbiIsZGlzcGxheToiYmxvY2sifSxudD17bGV0dGVyU3BhY2luZzoiMCIsZm9udFdlaWdodDoiNDAwIn07ZnVuY3Rpb24gcnQoZSx0LG4pe3ZhciByPVkuZXhlYyh0KTtyZXR1cm4gcj9NYXRoLm1heCgwLHJbMl0tKG58fDApKSsoclszXXx8InB4Iik6dH1mdW5jdGlvbiBpdChlLHQsbixyLGksbyl7dmFyIGE9IndpZHRoIj09PXQ/MTowLHM9MCx1PTAsbD0wO2lmKG49PT0ocj8iYm9yZGVyIjoiY29udGVudCIpKXJldHVybiAwO2Zvcig7YTw0O2ErPTIpIm1hcmdpbiI9PT1uJiYobCs9Y2UuY3NzKGUsbitRW2FdLCEwLGkpKSxyPygiY29udGVudCI9PT1uJiYodS09Y2UuY3NzKGUsInBhZGRpbmciK1FbYV0sITAsaSkpLCJtYXJnaW4iIT09biYmKHUtPWNlLmNzcyhlLCJib3JkZXIiK1FbYV0rIldpZHRoIiwhMCxpKSkpOih1Kz1jZS5jc3MoZSwicGFkZGluZyIrUVthXSwhMCxpKSwicGFkZGluZyIhPT1uP3UrPWNlLmNzcyhlLCJib3JkZXIiK1FbYV0rIldpZHRoIiwhMCxpKTpzKz1jZS5jc3MoZSwiYm9yZGVyIitRW2FdKyJXaWR0aCIsITAsaSkpO3JldHVybiFyJiYwPD1vJiYodSs9TWF0aC5tYXgoMCxNYXRoLmNlaWwoZVsib2Zmc2V0Iit0WzBdLnRvVXBwZXJDYXNlKCkrdC5zbGljZSgxKV0tby11LXMtLjUpKXx8MCksdStsfWZ1bmN0aW9uIG90KGUsdCxuKXt2YXIgcj1VZShlKSxpPSghbGUuYm94U2l6aW5nUmVsaWFibGUoKXx8bikmJiJib3JkZXItYm94Ij09PWNlLmNzcyhlLCJib3hTaXppbmciLCExLHIpLG89aSxhPUdlKGUsdCxyKSxzPSJvZmZzZXQiK3RbMF0udG9VcHBlckNhc2UoKSt0LnNsaWNlKDEpO2lmKF9lLnRlc3QoYSkpe2lmKCFuKXJldHVybiBhO2E9ImF1dG8ifXJldHVybighbGUuYm94U2l6aW5nUmVsaWFibGUoKSYmaXx8IWxlLnJlbGlhYmxlVHJEaW1lbnNpb25zKCkmJmZlKGUsInRyIil8fCJhdXRvIj09PWF8fCFwYXJzZUZsb2F0KGEpJiYiaW5saW5lIj09PWNlLmNzcyhlLCJkaXNwbGF5IiwhMSxyKSkmJmUuZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGgmJihpPSJib3JkZXItYm94Ij09PWNlLmNzcyhlLCJib3hTaXppbmciLCExLHIpLChvPXMgaW4gZSkmJihhPWVbc10pKSwoYT1wYXJzZUZsb2F0KGEpfHwwKStpdChlLHQsbnx8KGk/ImJvcmRlciI6ImNvbnRlbnQiKSxvLHIsYSkrInB4In1mdW5jdGlvbiBhdChlLHQsbixyLGkpe3JldHVybiBuZXcgYXQucHJvdG90eXBlLmluaXQoZSx0LG4scixpKX1jZS5leHRlbmQoe2Nzc0hvb2tzOntvcGFjaXR5OntnZXQ6ZnVuY3Rpb24oZSx0KXtpZih0KXt2YXIgbj1HZShlLCJvcGFjaXR5Iik7cmV0dXJuIiI9PT1uPyIxIjpufX19fSxjc3NOdW1iZXI6e2FuaW1hdGlvbkl0ZXJhdGlvbkNvdW50OiEwLGFzcGVjdFJhdGlvOiEwLGJvcmRlckltYWdlU2xpY2U6ITAsY29sdW1uQ291bnQ6ITAsZmxleEdyb3c6ITAsZmxleFNocmluazohMCxmb250V2VpZ2h0OiEwLGdyaWRBcmVhOiEwLGdyaWRDb2x1bW46ITAsZ3JpZENvbHVtbkVuZDohMCxncmlkQ29sdW1uU3RhcnQ6ITAsZ3JpZFJvdzohMCxncmlkUm93RW5kOiEwLGdyaWRSb3dTdGFydDohMCxsaW5lSGVpZ2h0OiEwLG9wYWNpdHk6ITAsb3JkZXI6ITAsb3JwaGFuczohMCxzY2FsZTohMCx3aWRvd3M6ITAsekluZGV4OiEwLHpvb206ITAsZmlsbE9wYWNpdHk6ITAsZmxvb2RPcGFjaXR5OiEwLHN0b3BPcGFjaXR5OiEwLHN0cm9rZU1pdGVybGltaXQ6ITAsc3Ryb2tlT3BhY2l0eTohMH0sY3NzUHJvcHM6e30sc3R5bGU6ZnVuY3Rpb24oZSx0LG4scil7aWYoZSYmMyE9PWUubm9kZVR5cGUmJjghPT1lLm5vZGVUeXBlJiZlLnN0eWxlKXt2YXIgaSxvLGEscz1GKHQpLHU9WGUudGVzdCh0KSxsPWUuc3R5bGU7aWYodXx8KHQ9WmUocykpLGE9Y2UuY3NzSG9va3NbdF18fGNlLmNzc0hvb2tzW3NdLHZvaWQgMD09PW4pcmV0dXJuIGEmJiJnZXQiaW4gYSYmdm9pZCAwIT09KGk9YS5nZXQoZSwhMSxyKSk/aTpsW3RdOyJzdHJpbmciPT09KG89dHlwZW9mIG4pJiYoaT1ZLmV4ZWMobikpJiZpWzFdJiYobj10ZShlLHQsaSksbz0ibnVtYmVyIiksbnVsbCE9biYmbj09biYmKCJudW1iZXIiIT09b3x8dXx8KG4rPWkmJmlbM118fChjZS5jc3NOdW1iZXJbc10/IiI6InB4IikpLGxlLmNsZWFyQ2xvbmVTdHlsZXx8IiIhPT1ufHwwIT09dC5pbmRleE9mKCJiYWNrZ3JvdW5kIil8fChsW3RdPSJpbmhlcml0IiksYSYmInNldCJpbiBhJiZ2b2lkIDA9PT0obj1hLnNldChlLG4scikpfHwodT9sLnNldFByb3BlcnR5KHQsbik6bFt0XT1uKSl9fSxjc3M6ZnVuY3Rpb24oZSx0LG4scil7dmFyIGksbyxhLHM9Rih0KTtyZXR1cm4gWGUudGVzdCh0KXx8KHQ9WmUocykpLChhPWNlLmNzc0hvb2tzW3RdfHxjZS5jc3NIb29rc1tzXSkmJiJnZXQiaW4gYSYmKGk9YS5nZXQoZSwhMCxuKSksdm9pZCAwPT09aSYmKGk9R2UoZSx0LHIpKSwibm9ybWFsIj09PWkmJnQgaW4gbnQmJihpPW50W3RdKSwiIj09PW58fG4/KG89cGFyc2VGbG9hdChpKSwhMD09PW58fGlzRmluaXRlKG8pP298fDA6aSk6aX19KSxjZS5lYWNoKFsiaGVpZ2h0Iiwid2lkdGgiXSxmdW5jdGlvbihlLHUpe2NlLmNzc0hvb2tzW3VdPXtnZXQ6ZnVuY3Rpb24oZSx0LG4pe2lmKHQpcmV0dXJuIWV0LnRlc3QoY2UuY3NzKGUsImRpc3BsYXkiKSl8fGUuZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGgmJmUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGg/b3QoZSx1LG4pOnplKGUsdHQsZnVuY3Rpb24oKXtyZXR1cm4gb3QoZSx1LG4pfSl9LHNldDpmdW5jdGlvbihlLHQsbil7dmFyIHIsaT1VZShlKSxvPSFsZS5zY3JvbGxib3hTaXplKCkmJiJhYnNvbHV0ZSI9PT1pLnBvc2l0aW9uLGE9KG98fG4pJiYiYm9yZGVyLWJveCI9PT1jZS5jc3MoZSwiYm94U2l6aW5nIiwhMSxpKSxzPW4/aXQoZSx1LG4sYSxpKTowO3JldHVybiBhJiZvJiYocy09TWF0aC5jZWlsKGVbIm9mZnNldCIrdVswXS50b1VwcGVyQ2FzZSgpK3Uuc2xpY2UoMSldLXBhcnNlRmxvYXQoaVt1XSktaXQoZSx1LCJib3JkZXIiLCExLGkpLS41KSkscyYmKHI9WS5leGVjKHQpKSYmInB4IiE9PShyWzNdfHwicHgiKSYmKGUuc3R5bGVbdV09dCx0PWNlLmNzcyhlLHUpKSxydCgwLHQscyl9fX0pLGNlLmNzc0hvb2tzLm1hcmdpbkxlZnQ9WWUobGUucmVsaWFibGVNYXJnaW5MZWZ0LGZ1bmN0aW9uKGUsdCl7aWYodClyZXR1cm4ocGFyc2VGbG9hdChHZShlLCJtYXJnaW5MZWZ0IikpfHxlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQtemUoZSx7bWFyZ2luTGVmdDowfSxmdW5jdGlvbigpe3JldHVybiBlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnR9KSkrInB4In0pLGNlLmVhY2goe21hcmdpbjoiIixwYWRkaW5nOiIiLGJvcmRlcjoiV2lkdGgifSxmdW5jdGlvbihpLG8pe2NlLmNzc0hvb2tzW2krb109e2V4cGFuZDpmdW5jdGlvbihlKXtmb3IodmFyIHQ9MCxuPXt9LHI9InN0cmluZyI9PXR5cGVvZiBlP2Uuc3BsaXQoIiAiKTpbZV07dDw0O3QrKyluW2krUVt0XStvXT1yW3RdfHxyW3QtMl18fHJbMF07cmV0dXJuIG59fSwibWFyZ2luIiE9PWkmJihjZS5jc3NIb29rc1tpK29dLnNldD1ydCl9KSxjZS5mbi5leHRlbmQoe2NzczpmdW5jdGlvbihlLHQpe3JldHVybiBSKHRoaXMsZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbz17fSxhPTA7aWYoQXJyYXkuaXNBcnJheSh0KSl7Zm9yKHI9VWUoZSksaT10Lmxlbmd0aDthPGk7YSsrKW9bdFthXV09Y2UuY3NzKGUsdFthXSwhMSxyKTtyZXR1cm4gb31yZXR1cm4gdm9pZCAwIT09bj9jZS5zdHlsZShlLHQsbik6Y2UuY3NzKGUsdCl9LGUsdCwxPGFyZ3VtZW50cy5sZW5ndGgpfX0pLCgoY2UuVHdlZW49YXQpLnByb3RvdHlwZT17Y29uc3RydWN0b3I6YXQsaW5pdDpmdW5jdGlvbihlLHQsbixyLGksbyl7dGhpcy5lbGVtPWUsdGhpcy5wcm9wPW4sdGhpcy5lYXNpbmc9aXx8Y2UuZWFzaW5nLl9kZWZhdWx0LHRoaXMub3B0aW9ucz10LHRoaXMuc3RhcnQ9dGhpcy5ub3c9dGhpcy5jdXIoKSx0aGlzLmVuZD1yLHRoaXMudW5pdD1vfHwoY2UuY3NzTnVtYmVyW25dPyIiOiJweCIpfSxjdXI6ZnVuY3Rpb24oKXt2YXIgZT1hdC5wcm9wSG9va3NbdGhpcy5wcm9wXTtyZXR1cm4gZSYmZS5nZXQ/ZS5nZXQodGhpcyk6YXQucHJvcEhvb2tzLl9kZWZhdWx0LmdldCh0aGlzKX0scnVuOmZ1bmN0aW9uKGUpe3ZhciB0LG49YXQucHJvcEhvb2tzW3RoaXMucHJvcF07cmV0dXJuIHRoaXMub3B0aW9ucy5kdXJhdGlvbj90aGlzLnBvcz10PWNlLmVhc2luZ1t0aGlzLmVhc2luZ10oZSx0aGlzLm9wdGlvbnMuZHVyYXRpb24qZSwwLDEsdGhpcy5vcHRpb25zLmR1cmF0aW9uKTp0aGlzLnBvcz10PWUsdGhpcy5ub3c9KHRoaXMuZW5kLXRoaXMuc3RhcnQpKnQrdGhpcy5zdGFydCx0aGlzLm9wdGlvbnMuc3RlcCYmdGhpcy5vcHRpb25zLnN0ZXAuY2FsbCh0aGlzLmVsZW0sdGhpcy5ub3csdGhpcyksbiYmbi5zZXQ/bi5zZXQodGhpcyk6YXQucHJvcEhvb2tzLl9kZWZhdWx0LnNldCh0aGlzKSx0aGlzfX0pLmluaXQucHJvdG90eXBlPWF0LnByb3RvdHlwZSwoYXQucHJvcEhvb2tzPXtfZGVmYXVsdDp7Z2V0OmZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiAxIT09ZS5lbGVtLm5vZGVUeXBlfHxudWxsIT1lLmVsZW1bZS5wcm9wXSYmbnVsbD09ZS5lbGVtLnN0eWxlW2UucHJvcF0/ZS5lbGVtW2UucHJvcF06KHQ9Y2UuY3NzKGUuZWxlbSxlLnByb3AsIiIpKSYmImF1dG8iIT09dD90OjB9LHNldDpmdW5jdGlvbihlKXtjZS5meC5zdGVwW2UucHJvcF0/Y2UuZnguc3RlcFtlLnByb3BdKGUpOjEhPT1lLmVsZW0ubm9kZVR5cGV8fCFjZS5jc3NIb29rc1tlLnByb3BdJiZudWxsPT1lLmVsZW0uc3R5bGVbWmUoZS5wcm9wKV0/ZS5lbGVtW2UucHJvcF09ZS5ub3c6Y2Uuc3R5bGUoZS5lbGVtLGUucHJvcCxlLm5vdytlLnVuaXQpfX19KS5zY3JvbGxUb3A9YXQucHJvcEhvb2tzLnNjcm9sbExlZnQ9e3NldDpmdW5jdGlvbihlKXtlLmVsZW0ubm9kZVR5cGUmJmUuZWxlbS5wYXJlbnROb2RlJiYoZS5lbGVtW2UucHJvcF09ZS5ub3cpfX0sY2UuZWFzaW5nPXtsaW5lYXI6ZnVuY3Rpb24oZSl7cmV0dXJuIGV9LHN3aW5nOmZ1bmN0aW9uKGUpe3JldHVybi41LU1hdGguY29zKGUqTWF0aC5QSSkvMn0sX2RlZmF1bHQ6InN3aW5nIn0sY2UuZng9YXQucHJvdG90eXBlLmluaXQsY2UuZnguc3RlcD17fTt2YXIgc3QsdXQsbHQsY3QsZnQ9L14oPzp0b2dnbGV8c2hvd3xoaWRlKSQvLHB0PS9xdWV1ZUhvb2tzJC87ZnVuY3Rpb24gZHQoKXt1dCYmKCExPT09Qy5oaWRkZW4mJmllLnJlcXVlc3RBbmltYXRpb25GcmFtZT9pZS5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZHQpOmllLnNldFRpbWVvdXQoZHQsY2UuZnguaW50ZXJ2YWwpLGNlLmZ4LnRpY2soKSl9ZnVuY3Rpb24gaHQoKXtyZXR1cm4gaWUuc2V0VGltZW91dChmdW5jdGlvbigpe3N0PXZvaWQgMH0pLHN0PURhdGUubm93KCl9ZnVuY3Rpb24gZ3QoZSx0KXt2YXIgbixyPTAsaT17aGVpZ2h0OmV9O2Zvcih0PXQ/MTowO3I8NDtyKz0yLXQpaVsibWFyZ2luIisobj1RW3JdKV09aVsicGFkZGluZyIrbl09ZTtyZXR1cm4gdCYmKGkub3BhY2l0eT1pLndpZHRoPWUpLGl9ZnVuY3Rpb24gdnQoZSx0LG4pe2Zvcih2YXIgcixpPSh5dC50d2VlbmVyc1t0XXx8W10pLmNvbmNhdCh5dC50d2VlbmVyc1siKiJdKSxvPTAsYT1pLmxlbmd0aDtvPGE7bysrKWlmKHI9aVtvXS5jYWxsKG4sdCxlKSlyZXR1cm4gcn1mdW5jdGlvbiB5dChvLGUsdCl7dmFyIG4sYSxyPTAsaT15dC5wcmVmaWx0ZXJzLmxlbmd0aCxzPWNlLkRlZmVycmVkKCkuYWx3YXlzKGZ1bmN0aW9uKCl7ZGVsZXRlIHUuZWxlbX0pLHU9ZnVuY3Rpb24oKXtpZihhKXJldHVybiExO2Zvcih2YXIgZT1zdHx8aHQoKSx0PU1hdGgubWF4KDAsbC5zdGFydFRpbWUrbC5kdXJhdGlvbi1lKSxuPTEtKHQvbC5kdXJhdGlvbnx8MCkscj0wLGk9bC50d2VlbnMubGVuZ3RoO3I8aTtyKyspbC50d2VlbnNbcl0ucnVuKG4pO3JldHVybiBzLm5vdGlmeVdpdGgobyxbbCxuLHRdKSxuPDEmJmk/dDooaXx8cy5ub3RpZnlXaXRoKG8sW2wsMSwwXSkscy5yZXNvbHZlV2l0aChvLFtsXSksITEpfSxsPXMucHJvbWlzZSh7ZWxlbTpvLHByb3BzOmNlLmV4dGVuZCh7fSxlKSxvcHRzOmNlLmV4dGVuZCghMCx7c3BlY2lhbEVhc2luZzp7fSxlYXNpbmc6Y2UuZWFzaW5nLl9kZWZhdWx0fSx0KSxvcmlnaW5hbFByb3BlcnRpZXM6ZSxvcmlnaW5hbE9wdGlvbnM6dCxzdGFydFRpbWU6c3R8fGh0KCksZHVyYXRpb246dC5kdXJhdGlvbix0d2VlbnM6W10sY3JlYXRlVHdlZW46ZnVuY3Rpb24oZSx0KXt2YXIgbj1jZS5Ud2VlbihvLGwub3B0cyxlLHQsbC5vcHRzLnNwZWNpYWxFYXNpbmdbZV18fGwub3B0cy5lYXNpbmcpO3JldHVybiBsLnR3ZWVucy5wdXNoKG4pLG59LHN0b3A6ZnVuY3Rpb24oZSl7dmFyIHQ9MCxuPWU/bC50d2VlbnMubGVuZ3RoOjA7aWYoYSlyZXR1cm4gdGhpcztmb3IoYT0hMDt0PG47dCsrKWwudHdlZW5zW3RdLnJ1bigxKTtyZXR1cm4gZT8ocy5ub3RpZnlXaXRoKG8sW2wsMSwwXSkscy5yZXNvbHZlV2l0aChvLFtsLGVdKSk6cy5yZWplY3RXaXRoKG8sW2wsZV0pLHRoaXN9fSksYz1sLnByb3BzO2ZvcighZnVuY3Rpb24oZSx0KXt2YXIgbixyLGksbyxhO2ZvcihuIGluIGUpaWYoaT10W3I9RihuKV0sbz1lW25dLEFycmF5LmlzQXJyYXkobykmJihpPW9bMV0sbz1lW25dPW9bMF0pLG4hPT1yJiYoZVtyXT1vLGRlbGV0ZSBlW25dKSwoYT1jZS5jc3NIb29rc1tyXSkmJiJleHBhbmQiaW4gYSlmb3IobiBpbiBvPWEuZXhwYW5kKG8pLGRlbGV0ZSBlW3JdLG8pbiBpbiBlfHwoZVtuXT1vW25dLHRbbl09aSk7ZWxzZSB0W3JdPWl9KGMsbC5vcHRzLnNwZWNpYWxFYXNpbmcpO3I8aTtyKyspaWYobj15dC5wcmVmaWx0ZXJzW3JdLmNhbGwobCxvLGMsbC5vcHRzKSlyZXR1cm4gdihuLnN0b3ApJiYoY2UuX3F1ZXVlSG9va3MobC5lbGVtLGwub3B0cy5xdWV1ZSkuc3RvcD1uLnN0b3AuYmluZChuKSksbjtyZXR1cm4gY2UubWFwKGMsdnQsbCksdihsLm9wdHMuc3RhcnQpJiZsLm9wdHMuc3RhcnQuY2FsbChvLGwpLGwucHJvZ3Jlc3MobC5vcHRzLnByb2dyZXNzKS5kb25lKGwub3B0cy5kb25lLGwub3B0cy5jb21wbGV0ZSkuZmFpbChsLm9wdHMuZmFpbCkuYWx3YXlzKGwub3B0cy5hbHdheXMpLGNlLmZ4LnRpbWVyKGNlLmV4dGVuZCh1LHtlbGVtOm8sYW5pbTpsLHF1ZXVlOmwub3B0cy5xdWV1ZX0pKSxsfWNlLkFuaW1hdGlvbj1jZS5leHRlbmQoeXQse3R3ZWVuZXJzOnsiKiI6W2Z1bmN0aW9uKGUsdCl7dmFyIG49dGhpcy5jcmVhdGVUd2VlbihlLHQpO3JldHVybiB0ZShuLmVsZW0sZSxZLmV4ZWModCksbiksbn1dfSx0d2VlbmVyOmZ1bmN0aW9uKGUsdCl7dihlKT8odD1lLGU9WyIqIl0pOmU9ZS5tYXRjaChEKTtmb3IodmFyIG4scj0wLGk9ZS5sZW5ndGg7cjxpO3IrKyluPWVbcl0seXQudHdlZW5lcnNbbl09eXQudHdlZW5lcnNbbl18fFtdLHl0LnR3ZWVuZXJzW25dLnVuc2hpZnQodCl9LHByZWZpbHRlcnM6W2Z1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG8sYSxzLHUsbCxjLGY9IndpZHRoImluIHR8fCJoZWlnaHQiaW4gdCxwPXRoaXMsZD17fSxoPWUuc3R5bGUsZz1lLm5vZGVUeXBlJiZlZShlKSx2PV8uZ2V0KGUsImZ4c2hvdyIpO2ZvcihyIGluIG4ucXVldWV8fChudWxsPT0oYT1jZS5fcXVldWVIb29rcyhlLCJmeCIpKS51bnF1ZXVlZCYmKGEudW5xdWV1ZWQ9MCxzPWEuZW1wdHkuZmlyZSxhLmVtcHR5LmZpcmU9ZnVuY3Rpb24oKXthLnVucXVldWVkfHxzKCl9KSxhLnVucXVldWVkKysscC5hbHdheXMoZnVuY3Rpb24oKXtwLmFsd2F5cyhmdW5jdGlvbigpe2EudW5xdWV1ZWQtLSxjZS5xdWV1ZShlLCJmeCIpLmxlbmd0aHx8YS5lbXB0eS5maXJlKCl9KX0pKSx0KWlmKGk9dFtyXSxmdC50ZXN0KGkpKXtpZihkZWxldGUgdFtyXSxvPW98fCJ0b2dnbGUiPT09aSxpPT09KGc/ImhpZGUiOiJzaG93Iikpe2lmKCJzaG93IiE9PWl8fCF2fHx2b2lkIDA9PT12W3JdKWNvbnRpbnVlO2c9ITB9ZFtyXT12JiZ2W3JdfHxjZS5zdHlsZShlLHIpfWlmKCh1PSFjZS5pc0VtcHR5T2JqZWN0KHQpKXx8IWNlLmlzRW1wdHlPYmplY3QoZCkpZm9yKHIgaW4gZiYmMT09PWUubm9kZVR5cGUmJihuLm92ZXJmbG93PVtoLm92ZXJmbG93LGgub3ZlcmZsb3dYLGgub3ZlcmZsb3dZXSxudWxsPT0obD12JiZ2LmRpc3BsYXkpJiYobD1fLmdldChlLCJkaXNwbGF5IikpLCJub25lIj09PShjPWNlLmNzcyhlLCJkaXNwbGF5IikpJiYobD9jPWw6KHJlKFtlXSwhMCksbD1lLnN0eWxlLmRpc3BsYXl8fGwsYz1jZS5jc3MoZSwiZGlzcGxheSIpLHJlKFtlXSkpKSwoImlubGluZSI9PT1jfHwiaW5saW5lLWJsb2NrIj09PWMmJm51bGwhPWwpJiYibm9uZSI9PT1jZS5jc3MoZSwiZmxvYXQiKSYmKHV8fChwLmRvbmUoZnVuY3Rpb24oKXtoLmRpc3BsYXk9bH0pLG51bGw9PWwmJihjPWguZGlzcGxheSxsPSJub25lIj09PWM/IiI6YykpLGguZGlzcGxheT0iaW5saW5lLWJsb2NrIikpLG4ub3ZlcmZsb3cmJihoLm92ZXJmbG93PSJoaWRkZW4iLHAuYWx3YXlzKGZ1bmN0aW9uKCl7aC5vdmVyZmxvdz1uLm92ZXJmbG93WzBdLGgub3ZlcmZsb3dYPW4ub3ZlcmZsb3dbMV0saC5vdmVyZmxvd1k9bi5vdmVyZmxvd1syXX0pKSx1PSExLGQpdXx8KHY/ImhpZGRlbiJpbiB2JiYoZz12LmhpZGRlbik6dj1fLmFjY2VzcyhlLCJmeHNob3ciLHtkaXNwbGF5Omx9KSxvJiYodi5oaWRkZW49IWcpLGcmJnJlKFtlXSwhMCkscC5kb25lKGZ1bmN0aW9uKCl7Zm9yKHIgaW4gZ3x8cmUoW2VdKSxfLnJlbW92ZShlLCJmeHNob3ciKSxkKWNlLnN0eWxlKGUscixkW3JdKX0pKSx1PXZ0KGc/dltyXTowLHIscCksciBpbiB2fHwodltyXT11LnN0YXJ0LGcmJih1LmVuZD11LnN0YXJ0LHUuc3RhcnQ9MCkpfV0scHJlZmlsdGVyOmZ1bmN0aW9uKGUsdCl7dD95dC5wcmVmaWx0ZXJzLnVuc2hpZnQoZSk6eXQucHJlZmlsdGVycy5wdXNoKGUpfX0pLGNlLnNwZWVkPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1lJiYib2JqZWN0Ij09dHlwZW9mIGU/Y2UuZXh0ZW5kKHt9LGUpOntjb21wbGV0ZTpufHwhbiYmdHx8dihlKSYmZSxkdXJhdGlvbjplLGVhc2luZzpuJiZ0fHx0JiYhdih0KSYmdH07cmV0dXJuIGNlLmZ4Lm9mZj9yLmR1cmF0aW9uPTA6Im51bWJlciIhPXR5cGVvZiByLmR1cmF0aW9uJiYoci5kdXJhdGlvbiBpbiBjZS5meC5zcGVlZHM/ci5kdXJhdGlvbj1jZS5meC5zcGVlZHNbci5kdXJhdGlvbl06ci5kdXJhdGlvbj1jZS5meC5zcGVlZHMuX2RlZmF1bHQpLG51bGwhPXIucXVldWUmJiEwIT09ci5xdWV1ZXx8KHIucXVldWU9ImZ4Iiksci5vbGQ9ci5jb21wbGV0ZSxyLmNvbXBsZXRlPWZ1bmN0aW9uKCl7dihyLm9sZCkmJnIub2xkLmNhbGwodGhpcyksci5xdWV1ZSYmY2UuZGVxdWV1ZSh0aGlzLHIucXVldWUpfSxyfSxjZS5mbi5leHRlbmQoe2ZhZGVUbzpmdW5jdGlvbihlLHQsbixyKXtyZXR1cm4gdGhpcy5maWx0ZXIoZWUpLmNzcygib3BhY2l0eSIsMCkuc2hvdygpLmVuZCgpLmFuaW1hdGUoe29wYWNpdHk6dH0sZSxuLHIpfSxhbmltYXRlOmZ1bmN0aW9uKHQsZSxuLHIpe3ZhciBpPWNlLmlzRW1wdHlPYmplY3QodCksbz1jZS5zcGVlZChlLG4sciksYT1mdW5jdGlvbigpe3ZhciBlPXl0KHRoaXMsY2UuZXh0ZW5kKHt9LHQpLG8pOyhpfHxfLmdldCh0aGlzLCJmaW5pc2giKSkmJmUuc3RvcCghMCl9O3JldHVybiBhLmZpbmlzaD1hLGl8fCExPT09by5xdWV1ZT90aGlzLmVhY2goYSk6dGhpcy5xdWV1ZShvLnF1ZXVlLGEpfSxzdG9wOmZ1bmN0aW9uKGksZSxvKXt2YXIgYT1mdW5jdGlvbihlKXt2YXIgdD1lLnN0b3A7ZGVsZXRlIGUuc3RvcCx0KG8pfTtyZXR1cm4ic3RyaW5nIiE9dHlwZW9mIGkmJihvPWUsZT1pLGk9dm9pZCAwKSxlJiZ0aGlzLnF1ZXVlKGl8fCJmeCIsW10pLHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBlPSEwLHQ9bnVsbCE9aSYmaSsicXVldWVIb29rcyIsbj1jZS50aW1lcnMscj1fLmdldCh0aGlzKTtpZih0KXJbdF0mJnJbdF0uc3RvcCYmYShyW3RdKTtlbHNlIGZvcih0IGluIHIpclt0XSYmclt0XS5zdG9wJiZwdC50ZXN0KHQpJiZhKHJbdF0pO2Zvcih0PW4ubGVuZ3RoO3QtLTspblt0XS5lbGVtIT09dGhpc3x8bnVsbCE9aSYmblt0XS5xdWV1ZSE9PWl8fChuW3RdLmFuaW0uc3RvcChvKSxlPSExLG4uc3BsaWNlKHQsMSkpOyFlJiZvfHxjZS5kZXF1ZXVlKHRoaXMsaSl9KX0sZmluaXNoOmZ1bmN0aW9uKGEpe3JldHVybiExIT09YSYmKGE9YXx8ImZ4IiksdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGUsdD1fLmdldCh0aGlzKSxuPXRbYSsicXVldWUiXSxyPXRbYSsicXVldWVIb29rcyJdLGk9Y2UudGltZXJzLG89bj9uLmxlbmd0aDowO2Zvcih0LmZpbmlzaD0hMCxjZS5xdWV1ZSh0aGlzLGEsW10pLHImJnIuc3RvcCYmci5zdG9wLmNhbGwodGhpcywhMCksZT1pLmxlbmd0aDtlLS07KWlbZV0uZWxlbT09PXRoaXMmJmlbZV0ucXVldWU9PT1hJiYoaVtlXS5hbmltLnN0b3AoITApLGkuc3BsaWNlKGUsMSkpO2ZvcihlPTA7ZTxvO2UrKyluW2VdJiZuW2VdLmZpbmlzaCYmbltlXS5maW5pc2guY2FsbCh0aGlzKTtkZWxldGUgdC5maW5pc2h9KX19KSxjZS5lYWNoKFsidG9nZ2xlIiwic2hvdyIsImhpZGUiXSxmdW5jdGlvbihlLHIpe3ZhciBpPWNlLmZuW3JdO2NlLmZuW3JdPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gbnVsbD09ZXx8ImJvb2xlYW4iPT10eXBlb2YgZT9pLmFwcGx5KHRoaXMsYXJndW1lbnRzKTp0aGlzLmFuaW1hdGUoZ3QociwhMCksZSx0LG4pfX0pLGNlLmVhY2goe3NsaWRlRG93bjpndCgic2hvdyIpLHNsaWRlVXA6Z3QoImhpZGUiKSxzbGlkZVRvZ2dsZTpndCgidG9nZ2xlIiksZmFkZUluOntvcGFjaXR5OiJzaG93In0sZmFkZU91dDp7b3BhY2l0eToiaGlkZSJ9LGZhZGVUb2dnbGU6e29wYWNpdHk6InRvZ2dsZSJ9fSxmdW5jdGlvbihlLHIpe2NlLmZuW2VdPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gdGhpcy5hbmltYXRlKHIsZSx0LG4pfX0pLGNlLnRpbWVycz1bXSxjZS5meC50aWNrPWZ1bmN0aW9uKCl7dmFyIGUsdD0wLG49Y2UudGltZXJzO2ZvcihzdD1EYXRlLm5vdygpO3Q8bi5sZW5ndGg7dCsrKShlPW5bdF0pKCl8fG5bdF0hPT1lfHxuLnNwbGljZSh0LS0sMSk7bi5sZW5ndGh8fGNlLmZ4LnN0b3AoKSxzdD12b2lkIDB9LGNlLmZ4LnRpbWVyPWZ1bmN0aW9uKGUpe2NlLnRpbWVycy5wdXNoKGUpLGNlLmZ4LnN0YXJ0KCl9LGNlLmZ4LmludGVydmFsPTEzLGNlLmZ4LnN0YXJ0PWZ1bmN0aW9uKCl7dXR8fCh1dD0hMCxkdCgpKX0sY2UuZnguc3RvcD1mdW5jdGlvbigpe3V0PW51bGx9LGNlLmZ4LnNwZWVkcz17c2xvdzo2MDAsZmFzdDoyMDAsX2RlZmF1bHQ6NDAwfSxjZS5mbi5kZWxheT1mdW5jdGlvbihyLGUpe3JldHVybiByPWNlLmZ4JiZjZS5meC5zcGVlZHNbcl18fHIsZT1lfHwiZngiLHRoaXMucXVldWUoZSxmdW5jdGlvbihlLHQpe3ZhciBuPWllLnNldFRpbWVvdXQoZSxyKTt0LnN0b3A9ZnVuY3Rpb24oKXtpZS5jbGVhclRpbWVvdXQobil9fSl9LGx0PUMuY3JlYXRlRWxlbWVudCgiaW5wdXQiKSxjdD1DLmNyZWF0ZUVsZW1lbnQoInNlbGVjdCIpLmFwcGVuZENoaWxkKEMuY3JlYXRlRWxlbWVudCgib3B0aW9uIikpLGx0LnR5cGU9ImNoZWNrYm94IixsZS5jaGVja09uPSIiIT09bHQudmFsdWUsbGUub3B0U2VsZWN0ZWQ9Y3Quc2VsZWN0ZWQsKGx0PUMuY3JlYXRlRWxlbWVudCgiaW5wdXQiKSkudmFsdWU9InQiLGx0LnR5cGU9InJhZGlvIixsZS5yYWRpb1ZhbHVlPSJ0Ij09PWx0LnZhbHVlO3ZhciBtdCx4dD1jZS5leHByLmF0dHJIYW5kbGU7Y2UuZm4uZXh0ZW5kKHthdHRyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIFIodGhpcyxjZS5hdHRyLGUsdCwxPGFyZ3VtZW50cy5sZW5ndGgpfSxyZW1vdmVBdHRyOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtjZS5yZW1vdmVBdHRyKHRoaXMsZSl9KX19KSxjZS5leHRlbmQoe2F0dHI6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbz1lLm5vZGVUeXBlO2lmKDMhPT1vJiY4IT09byYmMiE9PW8pcmV0dXJuInVuZGVmaW5lZCI9PXR5cGVvZiBlLmdldEF0dHJpYnV0ZT9jZS5wcm9wKGUsdCxuKTooMT09PW8mJmNlLmlzWE1MRG9jKGUpfHwoaT1jZS5hdHRySG9va3NbdC50b0xvd2VyQ2FzZSgpXXx8KGNlLmV4cHIubWF0Y2guYm9vbC50ZXN0KHQpP210OnZvaWQgMCkpLHZvaWQgMCE9PW4/bnVsbD09PW4/dm9pZCBjZS5yZW1vdmVBdHRyKGUsdCk6aSYmInNldCJpbiBpJiZ2b2lkIDAhPT0ocj1pLnNldChlLG4sdCkpP3I6KGUuc2V0QXR0cmlidXRlKHQsbisiIiksbik6aSYmImdldCJpbiBpJiZudWxsIT09KHI9aS5nZXQoZSx0KSk/cjpudWxsPT0ocj1jZS5maW5kLmF0dHIoZSx0KSk/dm9pZCAwOnIpfSxhdHRySG9va3M6e3R5cGU6e3NldDpmdW5jdGlvbihlLHQpe2lmKCFsZS5yYWRpb1ZhbHVlJiYicmFkaW8iPT09dCYmZmUoZSwiaW5wdXQiKSl7dmFyIG49ZS52YWx1ZTtyZXR1cm4gZS5zZXRBdHRyaWJ1dGUoInR5cGUiLHQpLG4mJihlLnZhbHVlPW4pLHR9fX19LHJlbW92ZUF0dHI6ZnVuY3Rpb24oZSx0KXt2YXIgbixyPTAsaT10JiZ0Lm1hdGNoKEQpO2lmKGkmJjE9PT1lLm5vZGVUeXBlKXdoaWxlKG49aVtyKytdKWUucmVtb3ZlQXR0cmlidXRlKG4pfX0pLG10PXtzZXQ6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiExPT09dD9jZS5yZW1vdmVBdHRyKGUsbik6ZS5zZXRBdHRyaWJ1dGUobixuKSxufX0sY2UuZWFjaChjZS5leHByLm1hdGNoLmJvb2wuc291cmNlLm1hdGNoKC9cdysvZyksZnVuY3Rpb24oZSx0KXt2YXIgYT14dFt0XXx8Y2UuZmluZC5hdHRyO3h0W3RdPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG89dC50b0xvd2VyQ2FzZSgpO3JldHVybiBufHwoaT14dFtvXSx4dFtvXT1yLHI9bnVsbCE9YShlLHQsbik/bzpudWxsLHh0W29dPWkpLHJ9fSk7dmFyIGJ0PS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2ksd3Q9L14oPzphfGFyZWEpJC9pO2Z1bmN0aW9uIFR0KGUpe3JldHVybihlLm1hdGNoKEQpfHxbXSkuam9pbigiICIpfWZ1bmN0aW9uIEN0KGUpe3JldHVybiBlLmdldEF0dHJpYnV0ZSYmZS5nZXRBdHRyaWJ1dGUoImNsYXNzIil8fCIifWZ1bmN0aW9uIGt0KGUpe3JldHVybiBBcnJheS5pc0FycmF5KGUpP2U6InN0cmluZyI9PXR5cGVvZiBlJiZlLm1hdGNoKEQpfHxbXX1jZS5mbi5leHRlbmQoe3Byb3A6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gUih0aGlzLGNlLnByb3AsZSx0LDE8YXJndW1lbnRzLmxlbmd0aCl9LHJlbW92ZVByb3A6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2RlbGV0ZSB0aGlzW2NlLnByb3BGaXhbZV18fGVdfSl9fSksY2UuZXh0ZW5kKHtwcm9wOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG89ZS5ub2RlVHlwZTtpZigzIT09byYmOCE9PW8mJjIhPT1vKXJldHVybiAxPT09byYmY2UuaXNYTUxEb2MoZSl8fCh0PWNlLnByb3BGaXhbdF18fHQsaT1jZS5wcm9wSG9va3NbdF0pLHZvaWQgMCE9PW4/aSYmInNldCJpbiBpJiZ2b2lkIDAhPT0ocj1pLnNldChlLG4sdCkpP3I6ZVt0XT1uOmkmJiJnZXQiaW4gaSYmbnVsbCE9PShyPWkuZ2V0KGUsdCkpP3I6ZVt0XX0scHJvcEhvb2tzOnt0YWJJbmRleDp7Z2V0OmZ1bmN0aW9uKGUpe3ZhciB0PWNlLmZpbmQuYXR0cihlLCJ0YWJpbmRleCIpO3JldHVybiB0P3BhcnNlSW50KHQsMTApOmJ0LnRlc3QoZS5ub2RlTmFtZSl8fHd0LnRlc3QoZS5ub2RlTmFtZSkmJmUuaHJlZj8wOi0xfX19LHByb3BGaXg6eyJmb3IiOiJodG1sRm9yIiwiY2xhc3MiOiJjbGFzc05hbWUifX0pLGxlLm9wdFNlbGVjdGVkfHwoY2UucHJvcEhvb2tzLnNlbGVjdGVkPXtnZXQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wYXJlbnROb2RlO3JldHVybiB0JiZ0LnBhcmVudE5vZGUmJnQucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4LG51bGx9LHNldDpmdW5jdGlvbihlKXt2YXIgdD1lLnBhcmVudE5vZGU7dCYmKHQuc2VsZWN0ZWRJbmRleCx0LnBhcmVudE5vZGUmJnQucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4KX19KSxjZS5lYWNoKFsidGFiSW5kZXgiLCJyZWFkT25seSIsIm1heExlbmd0aCIsImNlbGxTcGFjaW5nIiwiY2VsbFBhZGRpbmciLCJyb3dTcGFuIiwiY29sU3BhbiIsInVzZU1hcCIsImZyYW1lQm9yZGVyIiwiY29udGVudEVkaXRhYmxlIl0sZnVuY3Rpb24oKXtjZS5wcm9wRml4W3RoaXMudG9Mb3dlckNhc2UoKV09dGhpc30pLGNlLmZuLmV4dGVuZCh7YWRkQ2xhc3M6ZnVuY3Rpb24odCl7dmFyIGUsbixyLGksbyxhO3JldHVybiB2KHQpP3RoaXMuZWFjaChmdW5jdGlvbihlKXtjZSh0aGlzKS5hZGRDbGFzcyh0LmNhbGwodGhpcyxlLEN0KHRoaXMpKSl9KTooZT1rdCh0KSkubGVuZ3RoP3RoaXMuZWFjaChmdW5jdGlvbigpe2lmKHI9Q3QodGhpcyksbj0xPT09dGhpcy5ub2RlVHlwZSYmIiAiK1R0KHIpKyIgIil7Zm9yKG89MDtvPGUubGVuZ3RoO28rKylpPWVbb10sbi5pbmRleE9mKCIgIitpKyIgIik8MCYmKG4rPWkrIiAiKTthPVR0KG4pLHIhPT1hJiZ0aGlzLnNldEF0dHJpYnV0ZSgiY2xhc3MiLGEpfX0pOnRoaXN9LHJlbW92ZUNsYXNzOmZ1bmN0aW9uKHQpe3ZhciBlLG4scixpLG8sYTtyZXR1cm4gdih0KT90aGlzLmVhY2goZnVuY3Rpb24oZSl7Y2UodGhpcykucmVtb3ZlQ2xhc3ModC5jYWxsKHRoaXMsZSxDdCh0aGlzKSkpfSk6YXJndW1lbnRzLmxlbmd0aD8oZT1rdCh0KSkubGVuZ3RoP3RoaXMuZWFjaChmdW5jdGlvbigpe2lmKHI9Q3QodGhpcyksbj0xPT09dGhpcy5ub2RlVHlwZSYmIiAiK1R0KHIpKyIgIil7Zm9yKG89MDtvPGUubGVuZ3RoO28rKyl7aT1lW29dO3doaWxlKC0xPG4uaW5kZXhPZigiICIraSsiICIpKW49bi5yZXBsYWNlKCIgIitpKyIgIiwiICIpfWE9VHQobiksciE9PWEmJnRoaXMuc2V0QXR0cmlidXRlKCJjbGFzcyIsYSl9fSk6dGhpczp0aGlzLmF0dHIoImNsYXNzIiwiIil9LHRvZ2dsZUNsYXNzOmZ1bmN0aW9uKHQsbil7dmFyIGUscixpLG8sYT10eXBlb2YgdCxzPSJzdHJpbmciPT09YXx8QXJyYXkuaXNBcnJheSh0KTtyZXR1cm4gdih0KT90aGlzLmVhY2goZnVuY3Rpb24oZSl7Y2UodGhpcykudG9nZ2xlQ2xhc3ModC5jYWxsKHRoaXMsZSxDdCh0aGlzKSxuKSxuKX0pOiJib29sZWFuIj09dHlwZW9mIG4mJnM/bj90aGlzLmFkZENsYXNzKHQpOnRoaXMucmVtb3ZlQ2xhc3ModCk6KGU9a3QodCksdGhpcy5lYWNoKGZ1bmN0aW9uKCl7aWYocylmb3Iobz1jZSh0aGlzKSxpPTA7aTxlLmxlbmd0aDtpKyspcj1lW2ldLG8uaGFzQ2xhc3Mocik/by5yZW1vdmVDbGFzcyhyKTpvLmFkZENsYXNzKHIpO2Vsc2Ugdm9pZCAwIT09dCYmImJvb2xlYW4iIT09YXx8KChyPUN0KHRoaXMpKSYmXy5zZXQodGhpcywiX19jbGFzc05hbWVfXyIsciksdGhpcy5zZXRBdHRyaWJ1dGUmJnRoaXMuc2V0QXR0cmlidXRlKCJjbGFzcyIscnx8ITE9PT10PyIiOl8uZ2V0KHRoaXMsIl9fY2xhc3NOYW1lX18iKXx8IiIpKX0pKX0saGFzQ2xhc3M6ZnVuY3Rpb24oZSl7dmFyIHQsbixyPTA7dD0iICIrZSsiICI7d2hpbGUobj10aGlzW3IrK10paWYoMT09PW4ubm9kZVR5cGUmJi0xPCgiICIrVHQoQ3QobikpKyIgIikuaW5kZXhPZih0KSlyZXR1cm4hMDtyZXR1cm4hMX19KTt2YXIgU3Q9L1xyL2c7Y2UuZm4uZXh0ZW5kKHt2YWw6ZnVuY3Rpb24obil7dmFyIHIsZSxpLHQ9dGhpc1swXTtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oaT12KG4pLHRoaXMuZWFjaChmdW5jdGlvbihlKXt2YXIgdDsxPT09dGhpcy5ub2RlVHlwZSYmKG51bGw9PSh0PWk/bi5jYWxsKHRoaXMsZSxjZSh0aGlzKS52YWwoKSk6bik/dD0iIjoibnVtYmVyIj09dHlwZW9mIHQ/dCs9IiI6QXJyYXkuaXNBcnJheSh0KSYmKHQ9Y2UubWFwKHQsZnVuY3Rpb24oZSl7cmV0dXJuIG51bGw9PWU/IiI6ZSsiIn0pKSwocj1jZS52YWxIb29rc1t0aGlzLnR5cGVdfHxjZS52YWxIb29rc1t0aGlzLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldKSYmInNldCJpbiByJiZ2b2lkIDAhPT1yLnNldCh0aGlzLHQsInZhbHVlIil8fCh0aGlzLnZhbHVlPXQpKX0pKTp0PyhyPWNlLnZhbEhvb2tzW3QudHlwZV18fGNlLnZhbEhvb2tzW3Qubm9kZU5hbWUudG9Mb3dlckNhc2UoKV0pJiYiZ2V0ImluIHImJnZvaWQgMCE9PShlPXIuZ2V0KHQsInZhbHVlIikpP2U6InN0cmluZyI9PXR5cGVvZihlPXQudmFsdWUpP2UucmVwbGFjZShTdCwiIik6bnVsbD09ZT8iIjplOnZvaWQgMH19KSxjZS5leHRlbmQoe3ZhbEhvb2tzOntvcHRpb246e2dldDpmdW5jdGlvbihlKXt2YXIgdD1jZS5maW5kLmF0dHIoZSwidmFsdWUiKTtyZXR1cm4gbnVsbCE9dD90OlR0KGNlLnRleHQoZSkpfX0sc2VsZWN0OntnZXQ6ZnVuY3Rpb24oZSl7dmFyIHQsbixyLGk9ZS5vcHRpb25zLG89ZS5zZWxlY3RlZEluZGV4LGE9InNlbGVjdC1vbmUiPT09ZS50eXBlLHM9YT9udWxsOltdLHU9YT9vKzE6aS5sZW5ndGg7Zm9yKHI9bzwwP3U6YT9vOjA7cjx1O3IrKylpZigoKG49aVtyXSkuc2VsZWN0ZWR8fHI9PT1vKSYmIW4uZGlzYWJsZWQmJighbi5wYXJlbnROb2RlLmRpc2FibGVkfHwhZmUobi5wYXJlbnROb2RlLCJvcHRncm91cCIpKSl7aWYodD1jZShuKS52YWwoKSxhKXJldHVybiB0O3MucHVzaCh0KX1yZXR1cm4gc30sc2V0OmZ1bmN0aW9uKGUsdCl7dmFyIG4scixpPWUub3B0aW9ucyxvPWNlLm1ha2VBcnJheSh0KSxhPWkubGVuZ3RoO3doaWxlKGEtLSkoKHI9aVthXSkuc2VsZWN0ZWQ9LTE8Y2UuaW5BcnJheShjZS52YWxIb29rcy5vcHRpb24uZ2V0KHIpLG8pKSYmKG49ITApO3JldHVybiBufHwoZS5zZWxlY3RlZEluZGV4PS0xKSxvfX19fSksY2UuZWFjaChbInJhZGlvIiwiY2hlY2tib3giXSxmdW5jdGlvbigpe2NlLnZhbEhvb2tzW3RoaXNdPXtzZXQ6ZnVuY3Rpb24oZSx0KXtpZihBcnJheS5pc0FycmF5KHQpKXJldHVybiBlLmNoZWNrZWQ9LTE8Y2UuaW5BcnJheShjZShlKS52YWwoKSx0KX19LGxlLmNoZWNrT258fChjZS52YWxIb29rc1t0aGlzXS5nZXQ9ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGw9PT1lLmdldEF0dHJpYnV0ZSgidmFsdWUiKT8ib24iOmUudmFsdWV9KX0pO3ZhciBFdD1pZS5sb2NhdGlvbixqdD17Z3VpZDpEYXRlLm5vdygpfSxBdD0vXD8vO2NlLnBhcnNlWE1MPWZ1bmN0aW9uKGUpe3ZhciB0LG47aWYoIWV8fCJzdHJpbmciIT10eXBlb2YgZSlyZXR1cm4gbnVsbDt0cnl7dD0obmV3IGllLkRPTVBhcnNlcikucGFyc2VGcm9tU3RyaW5nKGUsInRleHQveG1sIil9Y2F0Y2goZSl7fXJldHVybiBuPXQmJnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInBhcnNlcmVycm9yIilbMF0sdCYmIW58fGNlLmVycm9yKCJJbnZhbGlkIFhNTDogIisobj9jZS5tYXAobi5jaGlsZE5vZGVzLGZ1bmN0aW9uKGUpe3JldHVybiBlLnRleHRDb250ZW50fSkuam9pbigiXG4iKTplKSksdH07dmFyIER0PS9eKD86Zm9jdXNpbmZvY3VzfGZvY3Vzb3V0Ymx1cikkLyxOdD1mdW5jdGlvbihlKXtlLnN0b3BQcm9wYWdhdGlvbigpfTtjZS5leHRlbmQoY2UuZXZlbnQse3RyaWdnZXI6ZnVuY3Rpb24oZSx0LG4scil7dmFyIGksbyxhLHMsdSxsLGMsZixwPVtufHxDXSxkPXVlLmNhbGwoZSwidHlwZSIpP2UudHlwZTplLGg9dWUuY2FsbChlLCJuYW1lc3BhY2UiKT9lLm5hbWVzcGFjZS5zcGxpdCgiLiIpOltdO2lmKG89Zj1hPW49bnx8QywzIT09bi5ub2RlVHlwZSYmOCE9PW4ubm9kZVR5cGUmJiFEdC50ZXN0KGQrY2UuZXZlbnQudHJpZ2dlcmVkKSYmKC0xPGQuaW5kZXhPZigiLiIpJiYoZD0oaD1kLnNwbGl0KCIuIikpLnNoaWZ0KCksaC5zb3J0KCkpLHU9ZC5pbmRleE9mKCI6Iik8MCYmIm9uIitkLChlPWVbY2UuZXhwYW5kb10/ZTpuZXcgY2UuRXZlbnQoZCwib2JqZWN0Ij09dHlwZW9mIGUmJmUpKS5pc1RyaWdnZXI9cj8yOjMsZS5uYW1lc3BhY2U9aC5qb2luKCIuIiksZS5ybmFtZXNwYWNlPWUubmFtZXNwYWNlP25ldyBSZWdFeHAoIihefFxcLikiK2guam9pbigiXFwuKD86LipcXC58KSIpKyIoXFwufCQpIik6bnVsbCxlLnJlc3VsdD12b2lkIDAsZS50YXJnZXR8fChlLnRhcmdldD1uKSx0PW51bGw9PXQ/W2VdOmNlLm1ha2VBcnJheSh0LFtlXSksYz1jZS5ldmVudC5zcGVjaWFsW2RdfHx7fSxyfHwhYy50cmlnZ2VyfHwhMSE9PWMudHJpZ2dlci5hcHBseShuLHQpKSl7aWYoIXImJiFjLm5vQnViYmxlJiYheShuKSl7Zm9yKHM9Yy5kZWxlZ2F0ZVR5cGV8fGQsRHQudGVzdChzK2QpfHwobz1vLnBhcmVudE5vZGUpO287bz1vLnBhcmVudE5vZGUpcC5wdXNoKG8pLGE9bzthPT09KG4ub3duZXJEb2N1bWVudHx8QykmJnAucHVzaChhLmRlZmF1bHRWaWV3fHxhLnBhcmVudFdpbmRvd3x8aWUpfWk9MDt3aGlsZSgobz1wW2krK10pJiYhZS5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpKWY9byxlLnR5cGU9MTxpP3M6Yy5iaW5kVHlwZXx8ZCwobD0oXy5nZXQobywiZXZlbnRzIil8fE9iamVjdC5jcmVhdGUobnVsbCkpW2UudHlwZV0mJl8uZ2V0KG8sImhhbmRsZSIpKSYmbC5hcHBseShvLHQpLChsPXUmJm9bdV0pJiZsLmFwcGx5JiYkKG8pJiYoZS5yZXN1bHQ9bC5hcHBseShvLHQpLCExPT09ZS5yZXN1bHQmJmUucHJldmVudERlZmF1bHQoKSk7cmV0dXJuIGUudHlwZT1kLHJ8fGUuaXNEZWZhdWx0UHJldmVudGVkKCl8fGMuX2RlZmF1bHQmJiExIT09Yy5fZGVmYXVsdC5hcHBseShwLnBvcCgpLHQpfHwhJChuKXx8dSYmdihuW2RdKSYmIXkobikmJigoYT1uW3VdKSYmKG5bdV09bnVsbCksY2UuZXZlbnQudHJpZ2dlcmVkPWQsZS5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpJiZmLmFkZEV2ZW50TGlzdGVuZXIoZCxOdCksbltkXSgpLGUuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSYmZi5yZW1vdmVFdmVudExpc3RlbmVyKGQsTnQpLGNlLmV2ZW50LnRyaWdnZXJlZD12b2lkIDAsYSYmKG5bdV09YSkpLGUucmVzdWx0fX0sc2ltdWxhdGU6ZnVuY3Rpb24oZSx0LG4pe3ZhciByPWNlLmV4dGVuZChuZXcgY2UuRXZlbnQsbix7dHlwZTplLGlzU2ltdWxhdGVkOiEwfSk7Y2UuZXZlbnQudHJpZ2dlcihyLG51bGwsdCl9fSksY2UuZm4uZXh0ZW5kKHt0cmlnZ2VyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2NlLmV2ZW50LnRyaWdnZXIoZSx0LHRoaXMpfSl9LHRyaWdnZXJIYW5kbGVyOmZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpc1swXTtpZihuKXJldHVybiBjZS5ldmVudC50cmlnZ2VyKGUsdCxuLCEwKX19KTt2YXIgcXQ9L1xbXF0kLyxMdD0vXHI/XG4vZyxIdD0vXig/OnN1Ym1pdHxidXR0b258aW1hZ2V8cmVzZXR8ZmlsZSkkL2ksT3Q9L14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8a2V5Z2VuKS9pO2Z1bmN0aW9uIFB0KG4sZSxyLGkpe3ZhciB0O2lmKEFycmF5LmlzQXJyYXkoZSkpY2UuZWFjaChlLGZ1bmN0aW9uKGUsdCl7cnx8cXQudGVzdChuKT9pKG4sdCk6UHQobisiWyIrKCJvYmplY3QiPT10eXBlb2YgdCYmbnVsbCE9dD9lOiIiKSsiXSIsdCxyLGkpfSk7ZWxzZSBpZihyfHwib2JqZWN0IiE9PXgoZSkpaShuLGUpO2Vsc2UgZm9yKHQgaW4gZSlQdChuKyJbIit0KyJdIixlW3RdLHIsaSl9Y2UucGFyYW09ZnVuY3Rpb24oZSx0KXt2YXIgbixyPVtdLGk9ZnVuY3Rpb24oZSx0KXt2YXIgbj12KHQpP3QoKTp0O3Jbci5sZW5ndGhdPWVuY29kZVVSSUNvbXBvbmVudChlKSsiPSIrZW5jb2RlVVJJQ29tcG9uZW50KG51bGw9PW4/IiI6bil9O2lmKG51bGw9PWUpcmV0dXJuIiI7aWYoQXJyYXkuaXNBcnJheShlKXx8ZS5qcXVlcnkmJiFjZS5pc1BsYWluT2JqZWN0KGUpKWNlLmVhY2goZSxmdW5jdGlvbigpe2kodGhpcy5uYW1lLHRoaXMudmFsdWUpfSk7ZWxzZSBmb3IobiBpbiBlKVB0KG4sZVtuXSx0LGkpO3JldHVybiByLmpvaW4oIiYiKX0sY2UuZm4uZXh0ZW5kKHtzZXJpYWxpemU6ZnVuY3Rpb24oKXtyZXR1cm4gY2UucGFyYW0odGhpcy5zZXJpYWxpemVBcnJheSgpKX0sc2VyaWFsaXplQXJyYXk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXt2YXIgZT1jZS5wcm9wKHRoaXMsImVsZW1lbnRzIik7cmV0dXJuIGU/Y2UubWFrZUFycmF5KGUpOnRoaXN9KS5maWx0ZXIoZnVuY3Rpb24oKXt2YXIgZT10aGlzLnR5cGU7cmV0dXJuIHRoaXMubmFtZSYmIWNlKHRoaXMpLmlzKCI6ZGlzYWJsZWQiKSYmT3QudGVzdCh0aGlzLm5vZGVOYW1lKSYmIUh0LnRlc3QoZSkmJih0aGlzLmNoZWNrZWR8fCF3ZS50ZXN0KGUpKX0pLm1hcChmdW5jdGlvbihlLHQpe3ZhciBuPWNlKHRoaXMpLnZhbCgpO3JldHVybiBudWxsPT1uP251bGw6QXJyYXkuaXNBcnJheShuKT9jZS5tYXAobixmdW5jdGlvbihlKXtyZXR1cm57bmFtZTp0Lm5hbWUsdmFsdWU6ZS5yZXBsYWNlKEx0LCJcclxuIil9fSk6e25hbWU6dC5uYW1lLHZhbHVlOm4ucmVwbGFjZShMdCwiXHJcbiIpfX0pLmdldCgpfX0pO3ZhciBSdD0vJTIwL2csTXQ9LyMuKiQvLEl0PS8oWz8mXSlfPVteJl0qLyxXdD0vXiguKj8pOlsgXHRdKihbXlxyXG5dKikkL2dtLEZ0PS9eKD86R0VUfEhFQUQpJC8sJHQ9L15cL1wvLyxCdD17fSxfdD17fSxYdD0iKi8iLmNvbmNhdCgiKiIpLFV0PUMuY3JlYXRlRWxlbWVudCgiYSIpO2Z1bmN0aW9uIHp0KG8pe3JldHVybiBmdW5jdGlvbihlLHQpeyJzdHJpbmciIT10eXBlb2YgZSYmKHQ9ZSxlPSIqIik7dmFyIG4scj0wLGk9ZS50b0xvd2VyQ2FzZSgpLm1hdGNoKEQpfHxbXTtpZih2KHQpKXdoaWxlKG49aVtyKytdKSIrIj09PW5bMF0/KG49bi5zbGljZSgxKXx8IioiLChvW25dPW9bbl18fFtdKS51bnNoaWZ0KHQpKToob1tuXT1vW25dfHxbXSkucHVzaCh0KX19ZnVuY3Rpb24gVnQodCxpLG8sYSl7dmFyIHM9e30sdT10PT09X3Q7ZnVuY3Rpb24gbChlKXt2YXIgcjtyZXR1cm4gc1tlXT0hMCxjZS5lYWNoKHRbZV18fFtdLGZ1bmN0aW9uKGUsdCl7dmFyIG49dChpLG8sYSk7cmV0dXJuInN0cmluZyIhPXR5cGVvZiBufHx1fHxzW25dP3U/IShyPW4pOnZvaWQgMDooaS5kYXRhVHlwZXMudW5zaGlmdChuKSxsKG4pLCExKX0pLHJ9cmV0dXJuIGwoaS5kYXRhVHlwZXNbMF0pfHwhc1siKiJdJiZsKCIqIil9ZnVuY3Rpb24gR3QoZSx0KXt2YXIgbixyLGk9Y2UuYWpheFNldHRpbmdzLmZsYXRPcHRpb25zfHx7fTtmb3IobiBpbiB0KXZvaWQgMCE9PXRbbl0mJigoaVtuXT9lOnJ8fChyPXt9KSlbbl09dFtuXSk7cmV0dXJuIHImJmNlLmV4dGVuZCghMCxlLHIpLGV9VXQuaHJlZj1FdC5ocmVmLGNlLmV4dGVuZCh7YWN0aXZlOjAsbGFzdE1vZGlmaWVkOnt9LGV0YWc6e30sYWpheFNldHRpbmdzOnt1cmw6RXQuaHJlZix0eXBlOiJHRVQiLGlzTG9jYWw6L14oPzphYm91dHxhcHB8YXBwLXN0b3JhZ2V8ListZXh0ZW5zaW9ufGZpbGV8cmVzfHdpZGdldCk6JC8udGVzdChFdC5wcm90b2NvbCksZ2xvYmFsOiEwLHByb2Nlc3NEYXRhOiEwLGFzeW5jOiEwLGNvbnRlbnRUeXBlOiJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgiLGFjY2VwdHM6eyIqIjpYdCx0ZXh0OiJ0ZXh0L3BsYWluIixodG1sOiJ0ZXh0L2h0bWwiLHhtbDoiYXBwbGljYXRpb24veG1sLCB0ZXh0L3htbCIsanNvbjoiYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0In0sY29udGVudHM6e3htbDovXGJ4bWxcYi8saHRtbDovXGJodG1sLyxqc29uOi9cYmpzb25cYi99LHJlc3BvbnNlRmllbGRzOnt4bWw6InJlc3BvbnNlWE1MIix0ZXh0OiJyZXNwb25zZVRleHQiLGpzb246InJlc3BvbnNlSlNPTiJ9LGNvbnZlcnRlcnM6eyIqIHRleHQiOlN0cmluZywidGV4dCBodG1sIjohMCwidGV4dCBqc29uIjpKU09OLnBhcnNlLCJ0ZXh0IHhtbCI6Y2UucGFyc2VYTUx9LGZsYXRPcHRpb25zOnt1cmw6ITAsY29udGV4dDohMH19LGFqYXhTZXR1cDpmdW5jdGlvbihlLHQpe3JldHVybiB0P0d0KEd0KGUsY2UuYWpheFNldHRpbmdzKSx0KTpHdChjZS5hamF4U2V0dGluZ3MsZSl9LGFqYXhQcmVmaWx0ZXI6enQoQnQpLGFqYXhUcmFuc3BvcnQ6enQoX3QpLGFqYXg6ZnVuY3Rpb24oZSx0KXsib2JqZWN0Ij09dHlwZW9mIGUmJih0PWUsZT12b2lkIDApLHQ9dHx8e307dmFyIGMsZixwLG4sZCxyLGgsZyxpLG8sdj1jZS5hamF4U2V0dXAoe30sdCkseT12LmNvbnRleHR8fHYsbT12LmNvbnRleHQmJih5Lm5vZGVUeXBlfHx5LmpxdWVyeSk/Y2UoeSk6Y2UuZXZlbnQseD1jZS5EZWZlcnJlZCgpLGI9Y2UuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLHc9di5zdGF0dXNDb2RlfHx7fSxhPXt9LHM9e30sdT0iY2FuY2VsZWQiLFQ9e3JlYWR5U3RhdGU6MCxnZXRSZXNwb25zZUhlYWRlcjpmdW5jdGlvbihlKXt2YXIgdDtpZihoKXtpZighbil7bj17fTt3aGlsZSh0PVd0LmV4ZWMocCkpblt0WzFdLnRvTG93ZXJDYXNlKCkrIiAiXT0oblt0WzFdLnRvTG93ZXJDYXNlKCkrIiAiXXx8W10pLmNvbmNhdCh0WzJdKX10PW5bZS50b0xvd2VyQ2FzZSgpKyIgIl19cmV0dXJuIG51bGw9PXQ/bnVsbDp0LmpvaW4oIiwgIil9LGdldEFsbFJlc3BvbnNlSGVhZGVyczpmdW5jdGlvbigpe3JldHVybiBoP3A6bnVsbH0sc2V0UmVxdWVzdEhlYWRlcjpmdW5jdGlvbihlLHQpe3JldHVybiBudWxsPT1oJiYoZT1zW2UudG9Mb3dlckNhc2UoKV09c1tlLnRvTG93ZXJDYXNlKCldfHxlLGFbZV09dCksdGhpc30sb3ZlcnJpZGVNaW1lVHlwZTpmdW5jdGlvbihlKXtyZXR1cm4gbnVsbD09aCYmKHYubWltZVR5cGU9ZSksdGhpc30sc3RhdHVzQ29kZTpmdW5jdGlvbihlKXt2YXIgdDtpZihlKWlmKGgpVC5hbHdheXMoZVtULnN0YXR1c10pO2Vsc2UgZm9yKHQgaW4gZSl3W3RdPVt3W3RdLGVbdF1dO3JldHVybiB0aGlzfSxhYm9ydDpmdW5jdGlvbihlKXt2YXIgdD1lfHx1O3JldHVybiBjJiZjLmFib3J0KHQpLGwoMCx0KSx0aGlzfX07aWYoeC5wcm9taXNlKFQpLHYudXJsPSgoZXx8di51cmx8fEV0LmhyZWYpKyIiKS5yZXBsYWNlKCR0LEV0LnByb3RvY29sKyIvLyIpLHYudHlwZT10Lm1ldGhvZHx8dC50eXBlfHx2Lm1ldGhvZHx8di50eXBlLHYuZGF0YVR5cGVzPSh2LmRhdGFUeXBlfHwiKiIpLnRvTG93ZXJDYXNlKCkubWF0Y2goRCl8fFsiIl0sbnVsbD09di5jcm9zc0RvbWFpbil7cj1DLmNyZWF0ZUVsZW1lbnQoImEiKTt0cnl7ci5ocmVmPXYudXJsLHIuaHJlZj1yLmhyZWYsdi5jcm9zc0RvbWFpbj1VdC5wcm90b2NvbCsiLy8iK1V0Lmhvc3QhPXIucHJvdG9jb2wrIi8vIityLmhvc3R9Y2F0Y2goZSl7di5jcm9zc0RvbWFpbj0hMH19aWYodi5kYXRhJiZ2LnByb2Nlc3NEYXRhJiYic3RyaW5nIiE9dHlwZW9mIHYuZGF0YSYmKHYuZGF0YT1jZS5wYXJhbSh2LmRhdGEsdi50cmFkaXRpb25hbCkpLFZ0KEJ0LHYsdCxUKSxoKXJldHVybiBUO2ZvcihpIGluKGc9Y2UuZXZlbnQmJnYuZ2xvYmFsKSYmMD09Y2UuYWN0aXZlKysmJmNlLmV2ZW50LnRyaWdnZXIoImFqYXhTdGFydCIpLHYudHlwZT12LnR5cGUudG9VcHBlckNhc2UoKSx2Lmhhc0NvbnRlbnQ9IUZ0LnRlc3Qodi50eXBlKSxmPXYudXJsLnJlcGxhY2UoTXQsIiIpLHYuaGFzQ29udGVudD92LmRhdGEmJnYucHJvY2Vzc0RhdGEmJjA9PT0odi5jb250ZW50VHlwZXx8IiIpLmluZGV4T2YoImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpJiYodi5kYXRhPXYuZGF0YS5yZXBsYWNlKFJ0LCIrIikpOihvPXYudXJsLnNsaWNlKGYubGVuZ3RoKSx2LmRhdGEmJih2LnByb2Nlc3NEYXRhfHwic3RyaW5nIj09dHlwZW9mIHYuZGF0YSkmJihmKz0oQXQudGVzdChmKT8iJiI6Ij8iKSt2LmRhdGEsZGVsZXRlIHYuZGF0YSksITE9PT12LmNhY2hlJiYoZj1mLnJlcGxhY2UoSXQsIiQxIiksbz0oQXQudGVzdChmKT8iJiI6Ij8iKSsiXz0iK2p0Lmd1aWQrKytvKSx2LnVybD1mK28pLHYuaWZNb2RpZmllZCYmKGNlLmxhc3RNb2RpZmllZFtmXSYmVC5zZXRSZXF1ZXN0SGVhZGVyKCJJZi1Nb2RpZmllZC1TaW5jZSIsY2UubGFzdE1vZGlmaWVkW2ZdKSxjZS5ldGFnW2ZdJiZULnNldFJlcXVlc3RIZWFkZXIoIklmLU5vbmUtTWF0Y2giLGNlLmV0YWdbZl0pKSwodi5kYXRhJiZ2Lmhhc0NvbnRlbnQmJiExIT09di5jb250ZW50VHlwZXx8dC5jb250ZW50VHlwZSkmJlQuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIix2LmNvbnRlbnRUeXBlKSxULnNldFJlcXVlc3RIZWFkZXIoIkFjY2VwdCIsdi5kYXRhVHlwZXNbMF0mJnYuYWNjZXB0c1t2LmRhdGFUeXBlc1swXV0/di5hY2NlcHRzW3YuZGF0YVR5cGVzWzBdXSsoIioiIT09di5kYXRhVHlwZXNbMF0/IiwgIitYdCsiOyBxPTAuMDEiOiIiKTp2LmFjY2VwdHNbIioiXSksdi5oZWFkZXJzKVQuc2V0UmVxdWVzdEhlYWRlcihpLHYuaGVhZGVyc1tpXSk7aWYodi5iZWZvcmVTZW5kJiYoITE9PT12LmJlZm9yZVNlbmQuY2FsbCh5LFQsdil8fGgpKXJldHVybiBULmFib3J0KCk7aWYodT0iYWJvcnQiLGIuYWRkKHYuY29tcGxldGUpLFQuZG9uZSh2LnN1Y2Nlc3MpLFQuZmFpbCh2LmVycm9yKSxjPVZ0KF90LHYsdCxUKSl7aWYoVC5yZWFkeVN0YXRlPTEsZyYmbS50cmlnZ2VyKCJhamF4U2VuZCIsW1Qsdl0pLGgpcmV0dXJuIFQ7di5hc3luYyYmMDx2LnRpbWVvdXQmJihkPWllLnNldFRpbWVvdXQoZnVuY3Rpb24oKXtULmFib3J0KCJ0aW1lb3V0Iil9LHYudGltZW91dCkpO3RyeXtoPSExLGMuc2VuZChhLGwpfWNhdGNoKGUpe2lmKGgpdGhyb3cgZTtsKC0xLGUpfX1lbHNlIGwoLTEsIk5vIFRyYW5zcG9ydCIpO2Z1bmN0aW9uIGwoZSx0LG4scil7dmFyIGksbyxhLHMsdSxsPXQ7aHx8KGg9ITAsZCYmaWUuY2xlYXJUaW1lb3V0KGQpLGM9dm9pZCAwLHA9cnx8IiIsVC5yZWFkeVN0YXRlPTA8ZT80OjAsaT0yMDA8PWUmJmU8MzAwfHwzMDQ9PT1lLG4mJihzPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG8sYSxzPWUuY29udGVudHMsdT1lLmRhdGFUeXBlczt3aGlsZSgiKiI9PT11WzBdKXUuc2hpZnQoKSx2b2lkIDA9PT1yJiYocj1lLm1pbWVUeXBlfHx0LmdldFJlc3BvbnNlSGVhZGVyKCJDb250ZW50LVR5cGUiKSk7aWYocilmb3IoaSBpbiBzKWlmKHNbaV0mJnNbaV0udGVzdChyKSl7dS51bnNoaWZ0KGkpO2JyZWFrfWlmKHVbMF1pbiBuKW89dVswXTtlbHNle2ZvcihpIGluIG4pe2lmKCF1WzBdfHxlLmNvbnZlcnRlcnNbaSsiICIrdVswXV0pe289aTticmVha31hfHwoYT1pKX1vPW98fGF9aWYobylyZXR1cm4gbyE9PXVbMF0mJnUudW5zaGlmdChvKSxuW29dfSh2LFQsbikpLCFpJiYtMTxjZS5pbkFycmF5KCJzY3JpcHQiLHYuZGF0YVR5cGVzKSYmY2UuaW5BcnJheSgianNvbiIsdi5kYXRhVHlwZXMpPDAmJih2LmNvbnZlcnRlcnNbInRleHQgc2NyaXB0Il09ZnVuY3Rpb24oKXt9KSxzPWZ1bmN0aW9uKGUsdCxuLHIpe3ZhciBpLG8sYSxzLHUsbD17fSxjPWUuZGF0YVR5cGVzLnNsaWNlKCk7aWYoY1sxXSlmb3IoYSBpbiBlLmNvbnZlcnRlcnMpbFthLnRvTG93ZXJDYXNlKCldPWUuY29udmVydGVyc1thXTtvPWMuc2hpZnQoKTt3aGlsZShvKWlmKGUucmVzcG9uc2VGaWVsZHNbb10mJihuW2UucmVzcG9uc2VGaWVsZHNbb11dPXQpLCF1JiZyJiZlLmRhdGFGaWx0ZXImJih0PWUuZGF0YUZpbHRlcih0LGUuZGF0YVR5cGUpKSx1PW8sbz1jLnNoaWZ0KCkpaWYoIioiPT09bylvPXU7ZWxzZSBpZigiKiIhPT11JiZ1IT09byl7aWYoIShhPWxbdSsiICIrb118fGxbIiogIitvXSkpZm9yKGkgaW4gbClpZigocz1pLnNwbGl0KCIgIikpWzFdPT09byYmKGE9bFt1KyIgIitzWzBdXXx8bFsiKiAiK3NbMF1dKSl7ITA9PT1hP2E9bFtpXTohMCE9PWxbaV0mJihvPXNbMF0sYy51bnNoaWZ0KHNbMV0pKTticmVha31pZighMCE9PWEpaWYoYSYmZVsidGhyb3dzIl0pdD1hKHQpO2Vsc2UgdHJ5e3Q9YSh0KX1jYXRjaChlKXtyZXR1cm57c3RhdGU6InBhcnNlcmVycm9yIixlcnJvcjphP2U6Ik5vIGNvbnZlcnNpb24gZnJvbSAiK3UrIiB0byAiK299fX1yZXR1cm57c3RhdGU6InN1Y2Nlc3MiLGRhdGE6dH19KHYscyxULGkpLGk/KHYuaWZNb2RpZmllZCYmKCh1PVQuZ2V0UmVzcG9uc2VIZWFkZXIoIkxhc3QtTW9kaWZpZWQiKSkmJihjZS5sYXN0TW9kaWZpZWRbZl09dSksKHU9VC5nZXRSZXNwb25zZUhlYWRlcigiZXRhZyIpKSYmKGNlLmV0YWdbZl09dSkpLDIwND09PWV8fCJIRUFEIj09PXYudHlwZT9sPSJub2NvbnRlbnQiOjMwND09PWU/bD0ibm90bW9kaWZpZWQiOihsPXMuc3RhdGUsbz1zLmRhdGEsaT0hKGE9cy5lcnJvcikpKTooYT1sLCFlJiZsfHwobD0iZXJyb3IiLGU8MCYmKGU9MCkpKSxULnN0YXR1cz1lLFQuc3RhdHVzVGV4dD0odHx8bCkrIiIsaT94LnJlc29sdmVXaXRoKHksW28sbCxUXSk6eC5yZWplY3RXaXRoKHksW1QsbCxhXSksVC5zdGF0dXNDb2RlKHcpLHc9dm9pZCAwLGcmJm0udHJpZ2dlcihpPyJhamF4U3VjY2VzcyI6ImFqYXhFcnJvciIsW1QsdixpP286YV0pLGIuZmlyZVdpdGgoeSxbVCxsXSksZyYmKG0udHJpZ2dlcigiYWpheENvbXBsZXRlIixbVCx2XSksLS1jZS5hY3RpdmV8fGNlLmV2ZW50LnRyaWdnZXIoImFqYXhTdG9wIikpKX1yZXR1cm4gVH0sZ2V0SlNPTjpmdW5jdGlvbihlLHQsbil7cmV0dXJuIGNlLmdldChlLHQsbiwianNvbiIpfSxnZXRTY3JpcHQ6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gY2UuZ2V0KGUsdm9pZCAwLHQsInNjcmlwdCIpfX0pLGNlLmVhY2goWyJnZXQiLCJwb3N0Il0sZnVuY3Rpb24oZSxpKXtjZVtpXT1mdW5jdGlvbihlLHQsbixyKXtyZXR1cm4gdih0KSYmKHI9cnx8bixuPXQsdD12b2lkIDApLGNlLmFqYXgoY2UuZXh0ZW5kKHt1cmw6ZSx0eXBlOmksZGF0YVR5cGU6cixkYXRhOnQsc3VjY2VzczpufSxjZS5pc1BsYWluT2JqZWN0KGUpJiZlKSl9fSksY2UuYWpheFByZWZpbHRlcihmdW5jdGlvbihlKXt2YXIgdDtmb3IodCBpbiBlLmhlYWRlcnMpImNvbnRlbnQtdHlwZSI9PT10LnRvTG93ZXJDYXNlKCkmJihlLmNvbnRlbnRUeXBlPWUuaGVhZGVyc1t0XXx8IiIpfSksY2UuX2V2YWxVcmw9ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBjZS5hamF4KHt1cmw6ZSx0eXBlOiJHRVQiLGRhdGFUeXBlOiJzY3JpcHQiLGNhY2hlOiEwLGFzeW5jOiExLGdsb2JhbDohMSxjb252ZXJ0ZXJzOnsidGV4dCBzY3JpcHQiOmZ1bmN0aW9uKCl7fX0sZGF0YUZpbHRlcjpmdW5jdGlvbihlKXtjZS5nbG9iYWxFdmFsKGUsdCxuKX19KX0sY2UuZm4uZXh0ZW5kKHt3cmFwQWxsOmZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiB0aGlzWzBdJiYodihlKSYmKGU9ZS5jYWxsKHRoaXNbMF0pKSx0PWNlKGUsdGhpc1swXS5vd25lckRvY3VtZW50KS5lcSgwKS5jbG9uZSghMCksdGhpc1swXS5wYXJlbnROb2RlJiZ0Lmluc2VydEJlZm9yZSh0aGlzWzBdKSx0Lm1hcChmdW5jdGlvbigpe3ZhciBlPXRoaXM7d2hpbGUoZS5maXJzdEVsZW1lbnRDaGlsZCllPWUuZmlyc3RFbGVtZW50Q2hpbGQ7cmV0dXJuIGV9KS5hcHBlbmQodGhpcykpLHRoaXN9LHdyYXBJbm5lcjpmdW5jdGlvbihuKXtyZXR1cm4gdihuKT90aGlzLmVhY2goZnVuY3Rpb24oZSl7Y2UodGhpcykud3JhcElubmVyKG4uY2FsbCh0aGlzLGUpKX0pOnRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBlPWNlKHRoaXMpLHQ9ZS5jb250ZW50cygpO3QubGVuZ3RoP3Qud3JhcEFsbChuKTplLmFwcGVuZChuKX0pfSx3cmFwOmZ1bmN0aW9uKHQpe3ZhciBuPXYodCk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihlKXtjZSh0aGlzKS53cmFwQWxsKG4/dC5jYWxsKHRoaXMsZSk6dCl9KX0sdW53cmFwOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnBhcmVudChlKS5ub3QoImJvZHkiKS5lYWNoKGZ1bmN0aW9uKCl7Y2UodGhpcykucmVwbGFjZVdpdGgodGhpcy5jaGlsZE5vZGVzKX0pLHRoaXN9fSksY2UuZXhwci5wc2V1ZG9zLmhpZGRlbj1mdW5jdGlvbihlKXtyZXR1cm4hY2UuZXhwci5wc2V1ZG9zLnZpc2libGUoZSl9LGNlLmV4cHIucHNldWRvcy52aXNpYmxlPWZ1bmN0aW9uKGUpe3JldHVybiEhKGUub2Zmc2V0V2lkdGh8fGUub2Zmc2V0SGVpZ2h0fHxlLmdldENsaWVudFJlY3RzKCkubGVuZ3RoKX0sY2UuYWpheFNldHRpbmdzLnhocj1mdW5jdGlvbigpe3RyeXtyZXR1cm4gbmV3IGllLlhNTEh0dHBSZXF1ZXN0fWNhdGNoKGUpe319O3ZhciBZdD17MDoyMDAsMTIyMzoyMDR9LFF0PWNlLmFqYXhTZXR0aW5ncy54aHIoKTtsZS5jb3JzPSEhUXQmJiJ3aXRoQ3JlZGVudGlhbHMiaW4gUXQsbGUuYWpheD1RdD0hIVF0LGNlLmFqYXhUcmFuc3BvcnQoZnVuY3Rpb24oaSl7dmFyIG8sYTtpZihsZS5jb3JzfHxRdCYmIWkuY3Jvc3NEb21haW4pcmV0dXJue3NlbmQ6ZnVuY3Rpb24oZSx0KXt2YXIgbixyPWkueGhyKCk7aWYoci5vcGVuKGkudHlwZSxpLnVybCxpLmFzeW5jLGkudXNlcm5hbWUsaS5wYXNzd29yZCksaS54aHJGaWVsZHMpZm9yKG4gaW4gaS54aHJGaWVsZHMpcltuXT1pLnhockZpZWxkc1tuXTtmb3IobiBpbiBpLm1pbWVUeXBlJiZyLm92ZXJyaWRlTWltZVR5cGUmJnIub3ZlcnJpZGVNaW1lVHlwZShpLm1pbWVUeXBlKSxpLmNyb3NzRG9tYWlufHxlWyJYLVJlcXVlc3RlZC1XaXRoIl18fChlWyJYLVJlcXVlc3RlZC1XaXRoIl09IlhNTEh0dHBSZXF1ZXN0IiksZSlyLnNldFJlcXVlc3RIZWFkZXIobixlW25dKTtvPWZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbigpe28mJihvPWE9ci5vbmxvYWQ9ci5vbmVycm9yPXIub25hYm9ydD1yLm9udGltZW91dD1yLm9ucmVhZHlzdGF0ZWNoYW5nZT1udWxsLCJhYm9ydCI9PT1lP3IuYWJvcnQoKToiZXJyb3IiPT09ZT8ibnVtYmVyIiE9dHlwZW9mIHIuc3RhdHVzP3QoMCwiZXJyb3IiKTp0KHIuc3RhdHVzLHIuc3RhdHVzVGV4dCk6dChZdFtyLnN0YXR1c118fHIuc3RhdHVzLHIuc3RhdHVzVGV4dCwidGV4dCIhPT0oci5yZXNwb25zZVR5cGV8fCJ0ZXh0Iil8fCJzdHJpbmciIT10eXBlb2Ygci5yZXNwb25zZVRleHQ/e2JpbmFyeTpyLnJlc3BvbnNlfTp7dGV4dDpyLnJlc3BvbnNlVGV4dH0sci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSkpfX0sci5vbmxvYWQ9bygpLGE9ci5vbmVycm9yPXIub250aW1lb3V0PW8oImVycm9yIiksdm9pZCAwIT09ci5vbmFib3J0P3Iub25hYm9ydD1hOnIub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7ND09PXIucmVhZHlTdGF0ZSYmaWUuc2V0VGltZW91dChmdW5jdGlvbigpe28mJmEoKX0pfSxvPW8oImFib3J0Iik7dHJ5e3Iuc2VuZChpLmhhc0NvbnRlbnQmJmkuZGF0YXx8bnVsbCl9Y2F0Y2goZSl7aWYobyl0aHJvdyBlfX0sYWJvcnQ6ZnVuY3Rpb24oKXtvJiZvKCl9fX0pLGNlLmFqYXhQcmVmaWx0ZXIoZnVuY3Rpb24oZSl7ZS5jcm9zc0RvbWFpbiYmKGUuY29udGVudHMuc2NyaXB0PSExKX0pLGNlLmFqYXhTZXR1cCh7YWNjZXB0czp7c2NyaXB0OiJ0ZXh0L2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2VjbWFzY3JpcHQsIGFwcGxpY2F0aW9uL3gtZWNtYXNjcmlwdCJ9LGNvbnRlbnRzOntzY3JpcHQ6L1xiKD86amF2YXxlY21hKXNjcmlwdFxiL30sY29udmVydGVyczp7InRleHQgc2NyaXB0IjpmdW5jdGlvbihlKXtyZXR1cm4gY2UuZ2xvYmFsRXZhbChlKSxlfX19KSxjZS5hamF4UHJlZmlsdGVyKCJzY3JpcHQiLGZ1bmN0aW9uKGUpe3ZvaWQgMD09PWUuY2FjaGUmJihlLmNhY2hlPSExKSxlLmNyb3NzRG9tYWluJiYoZS50eXBlPSJHRVQiKX0pLGNlLmFqYXhUcmFuc3BvcnQoInNjcmlwdCIsZnVuY3Rpb24obil7dmFyIHIsaTtpZihuLmNyb3NzRG9tYWlufHxuLnNjcmlwdEF0dHJzKXJldHVybntzZW5kOmZ1bmN0aW9uKGUsdCl7cj1jZSgiPHNjcmlwdD4iKS5hdHRyKG4uc2NyaXB0QXR0cnN8fHt9KS5wcm9wKHtjaGFyc2V0Om4uc2NyaXB0Q2hhcnNldCxzcmM6bi51cmx9KS5vbigibG9hZCBlcnJvciIsaT1mdW5jdGlvbihlKXtyLnJlbW92ZSgpLGk9bnVsbCxlJiZ0KCJlcnJvciI9PT1lLnR5cGU/NDA0OjIwMCxlLnR5cGUpfSksQy5oZWFkLmFwcGVuZENoaWxkKHJbMF0pfSxhYm9ydDpmdW5jdGlvbigpe2kmJmkoKX19fSk7dmFyIEp0LEt0PVtdLFp0PS8oPSlcPyg/PSZ8JCl8XD9cPy87Y2UuYWpheFNldHVwKHtqc29ucDoiY2FsbGJhY2siLGpzb25wQ2FsbGJhY2s6ZnVuY3Rpb24oKXt2YXIgZT1LdC5wb3AoKXx8Y2UuZXhwYW5kbysiXyIranQuZ3VpZCsrO3JldHVybiB0aGlzW2VdPSEwLGV9fSksY2UuYWpheFByZWZpbHRlcigianNvbiBqc29ucCIsZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbyxhPSExIT09ZS5qc29ucCYmKFp0LnRlc3QoZS51cmwpPyJ1cmwiOiJzdHJpbmciPT10eXBlb2YgZS5kYXRhJiYwPT09KGUuY29udGVudFR5cGV8fCIiKS5pbmRleE9mKCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKSYmWnQudGVzdChlLmRhdGEpJiYiZGF0YSIpO2lmKGF8fCJqc29ucCI9PT1lLmRhdGFUeXBlc1swXSlyZXR1cm4gcj1lLmpzb25wQ2FsbGJhY2s9dihlLmpzb25wQ2FsbGJhY2spP2UuanNvbnBDYWxsYmFjaygpOmUuanNvbnBDYWxsYmFjayxhP2VbYV09ZVthXS5yZXBsYWNlKFp0LCIkMSIrcik6ITEhPT1lLmpzb25wJiYoZS51cmwrPShBdC50ZXN0KGUudXJsKT8iJiI6Ij8iKStlLmpzb25wKyI9IityKSxlLmNvbnZlcnRlcnNbInNjcmlwdCBqc29uIl09ZnVuY3Rpb24oKXtyZXR1cm4gb3x8Y2UuZXJyb3IocisiIHdhcyBub3QgY2FsbGVkIiksb1swXX0sZS5kYXRhVHlwZXNbMF09Impzb24iLGk9aWVbcl0saWVbcl09ZnVuY3Rpb24oKXtvPWFyZ3VtZW50c30sbi5hbHdheXMoZnVuY3Rpb24oKXt2b2lkIDA9PT1pP2NlKGllKS5yZW1vdmVQcm9wKHIpOmllW3JdPWksZVtyXSYmKGUuanNvbnBDYWxsYmFjaz10Lmpzb25wQ2FsbGJhY2ssS3QucHVzaChyKSksbyYmdihpKSYmaShvWzBdKSxvPWk9dm9pZCAwfSksInNjcmlwdCJ9KSxsZS5jcmVhdGVIVE1MRG9jdW1lbnQ9KChKdD1DLmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudCgiIikuYm9keSkuaW5uZXJIVE1MPSI8Zm9ybT48L2Zvcm0+PGZvcm0+PC9mb3JtPiIsMj09PUp0LmNoaWxkTm9kZXMubGVuZ3RoKSxjZS5wYXJzZUhUTUw9ZnVuY3Rpb24oZSx0LG4pe3JldHVybiJzdHJpbmciIT10eXBlb2YgZT9bXTooImJvb2xlYW4iPT10eXBlb2YgdCYmKG49dCx0PSExKSx0fHwobGUuY3JlYXRlSFRNTERvY3VtZW50Pygocj0odD1DLmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudCgiIikpLmNyZWF0ZUVsZW1lbnQoImJhc2UiKSkuaHJlZj1DLmxvY2F0aW9uLmhyZWYsdC5oZWFkLmFwcGVuZENoaWxkKHIpKTp0PUMpLG89IW4mJltdLChpPXcuZXhlYyhlKSk/W3QuY3JlYXRlRWxlbWVudChpWzFdKV06KGk9QWUoW2VdLHQsbyksbyYmby5sZW5ndGgmJmNlKG8pLnJlbW92ZSgpLGNlLm1lcmdlKFtdLGkuY2hpbGROb2RlcykpKTt2YXIgcixpLG99LGNlLmZuLmxvYWQ9ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbyxhPXRoaXMscz1lLmluZGV4T2YoIiAiKTtyZXR1cm4tMTxzJiYocj1UdChlLnNsaWNlKHMpKSxlPWUuc2xpY2UoMCxzKSksdih0KT8obj10LHQ9dm9pZCAwKTp0JiYib2JqZWN0Ij09dHlwZW9mIHQmJihpPSJQT1NUIiksMDxhLmxlbmd0aCYmY2UuYWpheCh7dXJsOmUsdHlwZTppfHwiR0VUIixkYXRhVHlwZToiaHRtbCIsZGF0YTp0fSkuZG9uZShmdW5jdGlvbihlKXtvPWFyZ3VtZW50cyxhLmh0bWwocj9jZSgiPGRpdj4iKS5hcHBlbmQoY2UucGFyc2VIVE1MKGUpKS5maW5kKHIpOmUpfSkuYWx3YXlzKG4mJmZ1bmN0aW9uKGUsdCl7YS5lYWNoKGZ1bmN0aW9uKCl7bi5hcHBseSh0aGlzLG98fFtlLnJlc3BvbnNlVGV4dCx0LGVdKX0pfSksdGhpc30sY2UuZXhwci5wc2V1ZG9zLmFuaW1hdGVkPWZ1bmN0aW9uKHQpe3JldHVybiBjZS5ncmVwKGNlLnRpbWVycyxmdW5jdGlvbihlKXtyZXR1cm4gdD09PWUuZWxlbX0pLmxlbmd0aH0sY2Uub2Zmc2V0PXtzZXRPZmZzZXQ6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbyxhLHMsdSxsPWNlLmNzcyhlLCJwb3NpdGlvbiIpLGM9Y2UoZSksZj17fTsic3RhdGljIj09PWwmJihlLnN0eWxlLnBvc2l0aW9uPSJyZWxhdGl2ZSIpLHM9Yy5vZmZzZXQoKSxvPWNlLmNzcyhlLCJ0b3AiKSx1PWNlLmNzcyhlLCJsZWZ0IiksKCJhYnNvbHV0ZSI9PT1sfHwiZml4ZWQiPT09bCkmJi0xPChvK3UpLmluZGV4T2YoImF1dG8iKT8oYT0ocj1jLnBvc2l0aW9uKCkpLnRvcCxpPXIubGVmdCk6KGE9cGFyc2VGbG9hdChvKXx8MCxpPXBhcnNlRmxvYXQodSl8fDApLHYodCkmJih0PXQuY2FsbChlLG4sY2UuZXh0ZW5kKHt9LHMpKSksbnVsbCE9dC50b3AmJihmLnRvcD10LnRvcC1zLnRvcCthKSxudWxsIT10LmxlZnQmJihmLmxlZnQ9dC5sZWZ0LXMubGVmdCtpKSwidXNpbmciaW4gdD90LnVzaW5nLmNhbGwoZSxmKTpjLmNzcyhmKX19LGNlLmZuLmV4dGVuZCh7b2Zmc2V0OmZ1bmN0aW9uKHQpe2lmKGFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHZvaWQgMD09PXQ/dGhpczp0aGlzLmVhY2goZnVuY3Rpb24oZSl7Y2Uub2Zmc2V0LnNldE9mZnNldCh0aGlzLHQsZSl9KTt2YXIgZSxuLHI9dGhpc1swXTtyZXR1cm4gcj9yLmdldENsaWVudFJlY3RzKCkubGVuZ3RoPyhlPXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksbj1yLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcse3RvcDplLnRvcCtuLnBhZ2VZT2Zmc2V0LGxlZnQ6ZS5sZWZ0K24ucGFnZVhPZmZzZXR9KTp7dG9wOjAsbGVmdDowfTp2b2lkIDB9LHBvc2l0aW9uOmZ1bmN0aW9uKCl7aWYodGhpc1swXSl7dmFyIGUsdCxuLHI9dGhpc1swXSxpPXt0b3A6MCxsZWZ0OjB9O2lmKCJmaXhlZCI9PT1jZS5jc3MociwicG9zaXRpb24iKSl0PXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7ZWxzZXt0PXRoaXMub2Zmc2V0KCksbj1yLm93bmVyRG9jdW1lbnQsZT1yLm9mZnNldFBhcmVudHx8bi5kb2N1bWVudEVsZW1lbnQ7d2hpbGUoZSYmKGU9PT1uLmJvZHl8fGU9PT1uLmRvY3VtZW50RWxlbWVudCkmJiJzdGF0aWMiPT09Y2UuY3NzKGUsInBvc2l0aW9uIikpZT1lLnBhcmVudE5vZGU7ZSYmZSE9PXImJjE9PT1lLm5vZGVUeXBlJiYoKGk9Y2UoZSkub2Zmc2V0KCkpLnRvcCs9Y2UuY3NzKGUsImJvcmRlclRvcFdpZHRoIiwhMCksaS5sZWZ0Kz1jZS5jc3MoZSwiYm9yZGVyTGVmdFdpZHRoIiwhMCkpfXJldHVybnt0b3A6dC50b3AtaS50b3AtY2UuY3NzKHIsIm1hcmdpblRvcCIsITApLGxlZnQ6dC5sZWZ0LWkubGVmdC1jZS5jc3MociwibWFyZ2luTGVmdCIsITApfX19LG9mZnNldFBhcmVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbigpe3ZhciBlPXRoaXMub2Zmc2V0UGFyZW50O3doaWxlKGUmJiJzdGF0aWMiPT09Y2UuY3NzKGUsInBvc2l0aW9uIikpZT1lLm9mZnNldFBhcmVudDtyZXR1cm4gZXx8Sn0pfX0pLGNlLmVhY2goe3Njcm9sbExlZnQ6InBhZ2VYT2Zmc2V0IixzY3JvbGxUb3A6InBhZ2VZT2Zmc2V0In0sZnVuY3Rpb24odCxpKXt2YXIgbz0icGFnZVlPZmZzZXQiPT09aTtjZS5mblt0XT1mdW5jdGlvbihlKXtyZXR1cm4gUih0aGlzLGZ1bmN0aW9uKGUsdCxuKXt2YXIgcjtpZih5KGUpP3I9ZTo5PT09ZS5ub2RlVHlwZSYmKHI9ZS5kZWZhdWx0Vmlldyksdm9pZCAwPT09bilyZXR1cm4gcj9yW2ldOmVbdF07cj9yLnNjcm9sbFRvKG8/ci5wYWdlWE9mZnNldDpuLG8/bjpyLnBhZ2VZT2Zmc2V0KTplW3RdPW59LHQsZSxhcmd1bWVudHMubGVuZ3RoKX19KSxjZS5lYWNoKFsidG9wIiwibGVmdCJdLGZ1bmN0aW9uKGUsbil7Y2UuY3NzSG9va3Nbbl09WWUobGUucGl4ZWxQb3NpdGlvbixmdW5jdGlvbihlLHQpe2lmKHQpcmV0dXJuIHQ9R2UoZSxuKSxfZS50ZXN0KHQpP2NlKGUpLnBvc2l0aW9uKClbbl0rInB4Ijp0fSl9KSxjZS5lYWNoKHtIZWlnaHQ6ImhlaWdodCIsV2lkdGg6IndpZHRoIn0sZnVuY3Rpb24oYSxzKXtjZS5lYWNoKHtwYWRkaW5nOiJpbm5lciIrYSxjb250ZW50OnMsIiI6Im91dGVyIithfSxmdW5jdGlvbihyLG8pe2NlLmZuW29dPWZ1bmN0aW9uKGUsdCl7dmFyIG49YXJndW1lbnRzLmxlbmd0aCYmKHJ8fCJib29sZWFuIiE9dHlwZW9mIGUpLGk9cnx8KCEwPT09ZXx8ITA9PT10PyJtYXJnaW4iOiJib3JkZXIiKTtyZXR1cm4gUih0aGlzLGZ1bmN0aW9uKGUsdCxuKXt2YXIgcjtyZXR1cm4geShlKT8wPT09by5pbmRleE9mKCJvdXRlciIpP2VbImlubmVyIithXTplLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudFsiY2xpZW50IithXTo5PT09ZS5ub2RlVHlwZT8ocj1lLmRvY3VtZW50RWxlbWVudCxNYXRoLm1heChlLmJvZHlbInNjcm9sbCIrYV0sclsic2Nyb2xsIithXSxlLmJvZHlbIm9mZnNldCIrYV0sclsib2Zmc2V0IithXSxyWyJjbGllbnQiK2FdKSk6dm9pZCAwPT09bj9jZS5jc3MoZSx0LGkpOmNlLnN0eWxlKGUsdCxuLGkpfSxzLG4/ZTp2b2lkIDAsbil9fSl9KSxjZS5lYWNoKFsiYWpheFN0YXJ0IiwiYWpheFN0b3AiLCJhamF4Q29tcGxldGUiLCJhamF4RXJyb3IiLCJhamF4U3VjY2VzcyIsImFqYXhTZW5kIl0sZnVuY3Rpb24oZSx0KXtjZS5mblt0XT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5vbih0LGUpfX0pLGNlLmZuLmV4dGVuZCh7YmluZDpmdW5jdGlvbihlLHQsbil7cmV0dXJuIHRoaXMub24oZSxudWxsLHQsbil9LHVuYmluZDpmdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLm9mZihlLG51bGwsdCl9LGRlbGVnYXRlOmZ1bmN0aW9uKGUsdCxuLHIpe3JldHVybiB0aGlzLm9uKHQsZSxuLHIpfSx1bmRlbGVnYXRlOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gMT09PWFyZ3VtZW50cy5sZW5ndGg/dGhpcy5vZmYoZSwiKioiKTp0aGlzLm9mZih0LGV8fCIqKiIsbil9LGhvdmVyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMubW91c2VlbnRlcihlKS5tb3VzZWxlYXZlKHR8fGUpfX0pLGNlLmVhY2goImJsdXIgZm9jdXMgZm9jdXNpbiBmb2N1c291dCByZXNpemUgc2Nyb2xsIGNsaWNrIGRibGNsaWNrIG1vdXNlZG93biBtb3VzZXVwIG1vdXNlbW92ZSBtb3VzZW92ZXIgbW91c2VvdXQgbW91c2VlbnRlciBtb3VzZWxlYXZlIGNoYW5nZSBzZWxlY3Qgc3VibWl0IGtleWRvd24ga2V5cHJlc3Mga2V5dXAgY29udGV4dG1lbnUiLnNwbGl0KCIgIiksZnVuY3Rpb24oZSxuKXtjZS5mbltuXT1mdW5jdGlvbihlLHQpe3JldHVybiAwPGFyZ3VtZW50cy5sZW5ndGg/dGhpcy5vbihuLG51bGwsZSx0KTp0aGlzLnRyaWdnZXIobil9fSk7dmFyIGVuPS9eW1xzXHVGRUZGXHhBMF0rfChbXlxzXHVGRUZGXHhBMF0pW1xzXHVGRUZGXHhBMF0rJC9nO2NlLnByb3h5PWZ1bmN0aW9uKGUsdCl7dmFyIG4scixpO2lmKCJzdHJpbmciPT10eXBlb2YgdCYmKG49ZVt0XSx0PWUsZT1uKSx2KGUpKXJldHVybiByPWFlLmNhbGwoYXJndW1lbnRzLDIpLChpPWZ1bmN0aW9uKCl7cmV0dXJuIGUuYXBwbHkodHx8dGhpcyxyLmNvbmNhdChhZS5jYWxsKGFyZ3VtZW50cykpKX0pLmd1aWQ9ZS5ndWlkPWUuZ3VpZHx8Y2UuZ3VpZCsrLGl9LGNlLmhvbGRSZWFkeT1mdW5jdGlvbihlKXtlP2NlLnJlYWR5V2FpdCsrOmNlLnJlYWR5KCEwKX0sY2UuaXNBcnJheT1BcnJheS5pc0FycmF5LGNlLnBhcnNlSlNPTj1KU09OLnBhcnNlLGNlLm5vZGVOYW1lPWZlLGNlLmlzRnVuY3Rpb249dixjZS5pc1dpbmRvdz15LGNlLmNhbWVsQ2FzZT1GLGNlLnR5cGU9eCxjZS5ub3c9RGF0ZS5ub3csY2UuaXNOdW1lcmljPWZ1bmN0aW9uKGUpe3ZhciB0PWNlLnR5cGUoZSk7cmV0dXJuKCJudW1iZXIiPT09dHx8InN0cmluZyI9PT10KSYmIWlzTmFOKGUtcGFyc2VGbG9hdChlKSl9LGNlLnRyaW09ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGw9PWU/IiI6KGUrIiIpLnJlcGxhY2UoZW4sIiQxIil9LCJmdW5jdGlvbiI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQmJmRlZmluZSgianF1ZXJ5IixbXSxmdW5jdGlvbigpe3JldHVybiBjZX0pO3ZhciB0bj1pZS5qUXVlcnksbm49aWUuJDtyZXR1cm4gY2Uubm9Db25mbGljdD1mdW5jdGlvbihlKXtyZXR1cm4gaWUuJD09PWNlJiYoaWUuJD1ubiksZSYmaWUualF1ZXJ5PT09Y2UmJihpZS5qUXVlcnk9dG4pLGNlfSwidW5kZWZpbmVkIj09dHlwZW9mIGUmJihpZS5qUXVlcnk9aWUuJD1jZSksY2V9KTsK"},{"meta":{"name":"sweetalert2.all.min.js","url":"https://unpkg.com/sweetalert2@10.16.6/dist/sweetalert2.all.min.js","ts":1734258410656,"mimetype":"text/javascript"},"source":"IWZ1bmN0aW9uKHQsZSl7Im9iamVjdCI9PXR5cGVvZiBleHBvcnRzJiYidW5kZWZpbmVkIiE9dHlwZW9mIG1vZHVsZT9tb2R1bGUuZXhwb3J0cz1lKCk6ImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoZSk6KHQ9dHx8c2VsZikuU3dlZXRhbGVydDI9ZSgpfSh0aGlzLGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHIodCl7cmV0dXJuKHI9ImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmInN5bWJvbCI9PXR5cGVvZiBTeW1ib2wuaXRlcmF0b3I/ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0fTpmdW5jdGlvbih0KXtyZXR1cm4gdCYmImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmdC5jb25zdHJ1Y3Rvcj09PVN5bWJvbCYmdCE9PVN5bWJvbC5wcm90b3R5cGU/InN5bWJvbCI6dHlwZW9mIHR9KSh0KX1mdW5jdGlvbiBhKHQsZSl7aWYoISh0IGluc3RhbmNlb2YgZSkpdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIil9ZnVuY3Rpb24gbyh0LGUpe2Zvcih2YXIgbj0wO248ZS5sZW5ndGg7bisrKXt2YXIgbz1lW25dO28uZW51bWVyYWJsZT1vLmVudW1lcmFibGV8fCExLG8uY29uZmlndXJhYmxlPSEwLCJ2YWx1ZSJpbiBvJiYoby53cml0YWJsZT0hMCksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsby5rZXksbyl9fWZ1bmN0aW9uIHModCxlLG4pe3JldHVybiBlJiZvKHQucHJvdG90eXBlLGUpLG4mJm8odCxuKSx0fWZ1bmN0aW9uIHUoKXtyZXR1cm4odT1PYmplY3QuYXNzaWdufHxmdW5jdGlvbih0KXtmb3IodmFyIGU9MTtlPGFyZ3VtZW50cy5sZW5ndGg7ZSsrKXt2YXIgbixvPWFyZ3VtZW50c1tlXTtmb3IobiBpbiBvKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvLG4pJiYodFtuXT1vW25dKX1yZXR1cm4gdH0pLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1mdW5jdGlvbiBjKHQpe3JldHVybihjPU9iamVjdC5zZXRQcm90b3R5cGVPZj9PYmplY3QuZ2V0UHJvdG90eXBlT2Y6ZnVuY3Rpb24odCl7cmV0dXJuIHQuX19wcm90b19ffHxPYmplY3QuZ2V0UHJvdG90eXBlT2YodCl9KSh0KX1mdW5jdGlvbiBsKHQsZSl7cmV0dXJuKGw9T2JqZWN0LnNldFByb3RvdHlwZU9mfHxmdW5jdGlvbih0LGUpe3JldHVybiB0Ll9fcHJvdG9fXz1lLHR9KSh0LGUpfWZ1bmN0aW9uIGQoKXtpZigidW5kZWZpbmVkIj09dHlwZW9mIFJlZmxlY3R8fCFSZWZsZWN0LmNvbnN0cnVjdClyZXR1cm4hMTtpZihSZWZsZWN0LmNvbnN0cnVjdC5zaGFtKXJldHVybiExO2lmKCJmdW5jdGlvbiI9PXR5cGVvZiBQcm94eSlyZXR1cm4hMDt0cnl7cmV0dXJuIEJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLFtdLGZ1bmN0aW9uKCl7fSkpLCEwfWNhdGNoKHQpe3JldHVybiExfX1mdW5jdGlvbiBpKHQsZSxuKXtyZXR1cm4oaT1kKCk/UmVmbGVjdC5jb25zdHJ1Y3Q6ZnVuY3Rpb24odCxlLG4pe3ZhciBvPVtudWxsXTtvLnB1c2guYXBwbHkobyxlKTtvPW5ldyhGdW5jdGlvbi5iaW5kLmFwcGx5KHQsbykpO3JldHVybiBuJiZsKG8sbi5wcm90b3R5cGUpLG99KS5hcHBseShudWxsLGFyZ3VtZW50cyl9ZnVuY3Rpb24gcCh0LGUpe3JldHVybiFlfHwib2JqZWN0IiE9dHlwZW9mIGUmJiJmdW5jdGlvbiIhPXR5cGVvZiBlP2Z1bmN0aW9uKHQpe2lmKHZvaWQgMD09PXQpdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTtyZXR1cm4gdH0odCk6ZX1mdW5jdGlvbiBmKHQsZSxuKXtyZXR1cm4oZj0idW5kZWZpbmVkIiE9dHlwZW9mIFJlZmxlY3QmJlJlZmxlY3QuZ2V0P1JlZmxlY3QuZ2V0OmZ1bmN0aW9uKHQsZSxuKXt0PWZ1bmN0aW9uKHQsZSl7Zm9yKDshT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsZSkmJm51bGwhPT0odD1jKHQpKTspO3JldHVybiB0fSh0LGUpO2lmKHQpe2U9T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0LGUpO3JldHVybiBlLmdldD9lLmdldC5jYWxsKG4pOmUudmFsdWV9fSkodCxlLG58fHQpfWZ1bmN0aW9uIG0odCl7cmV0dXJuIHQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkrdC5zbGljZSgxKX1mdW5jdGlvbiBoKGUpe3JldHVybiBPYmplY3Qua2V5cyhlKS5tYXAoZnVuY3Rpb24odCl7cmV0dXJuIGVbdF19KX1mdW5jdGlvbiBnKHQpe3JldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0KX1mdW5jdGlvbiB2KHQsZSl7ZT0nIicuY29uY2F0KHQsJyIgaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIHRoZSBuZXh0IG1ham9yIHJlbGVhc2UuIFBsZWFzZSB1c2UgIicpLmNvbmNhdChlLCciIGluc3RlYWQuJyksLTE9PT1ZLmluZGV4T2YoZSkmJihZLnB1c2goZSksVyhlKSl9ZnVuY3Rpb24gYih0KXtyZXR1cm4gdCYmImZ1bmN0aW9uIj09dHlwZW9mIHQudG9Qcm9taXNlfWZ1bmN0aW9uIHkodCl7cmV0dXJuIGIodCk/dC50b1Byb21pc2UoKTpQcm9taXNlLnJlc29sdmUodCl9ZnVuY3Rpb24gdyh0KXtyZXR1cm4gdCYmUHJvbWlzZS5yZXNvbHZlKHQpPT09dH1mdW5jdGlvbiBDKHQpe3JldHVybiB0IGluc3RhbmNlb2YgRWxlbWVudHx8Im9iamVjdCI9PT1yKHQ9dCkmJnQuanF1ZXJ5fWZ1bmN0aW9uIGsoKXtyZXR1cm4gZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yKCIuIi5jb25jYXQoJC5jb250YWluZXIpKX1mdW5jdGlvbiBlKHQpe3ZhciBlPWsoKTtyZXR1cm4gZT9lLnF1ZXJ5U2VsZWN0b3IodCk6bnVsbH1mdW5jdGlvbiB0KHQpe3JldHVybiBlKCIuIi5jb25jYXQodCkpfWZ1bmN0aW9uIEEoKXtyZXR1cm4gdCgkLnBvcHVwKX1mdW5jdGlvbiB4KCl7cmV0dXJuIHQoJC5pY29uKX1mdW5jdGlvbiBCKCl7cmV0dXJuIHQoJC50aXRsZSl9ZnVuY3Rpb24gUCgpe3JldHVybiB0KCQuY29udGVudCl9ZnVuY3Rpb24gTygpe3JldHVybiB0KCRbImh0bWwtY29udGFpbmVyIl0pfWZ1bmN0aW9uIEUoKXtyZXR1cm4gdCgkLmltYWdlKX1mdW5jdGlvbiBuKCl7cmV0dXJuIHQoJFsicHJvZ3Jlc3Mtc3RlcHMiXSl9ZnVuY3Rpb24gUygpe3JldHVybiB0KCRbInZhbGlkYXRpb24tbWVzc2FnZSJdKX1mdW5jdGlvbiBUKCl7cmV0dXJuIGUoIi4iLmNvbmNhdCgkLmFjdGlvbnMsIiAuIikuY29uY2F0KCQuY29uZmlybSkpfWZ1bmN0aW9uIEwoKXtyZXR1cm4gZSgiLiIuY29uY2F0KCQuYWN0aW9ucywiIC4iKS5jb25jYXQoJC5kZW55KSl9ZnVuY3Rpb24gRCgpe3JldHVybiBlKCIuIi5jb25jYXQoJC5sb2FkZXIpKX1mdW5jdGlvbiBxKCl7cmV0dXJuIGUoIi4iLmNvbmNhdCgkLmFjdGlvbnMsIiAuIikuY29uY2F0KCQuY2FuY2VsKSl9ZnVuY3Rpb24gaigpe3JldHVybiB0KCQuYWN0aW9ucyl9ZnVuY3Rpb24gTSgpe3JldHVybiB0KCQuaGVhZGVyKX1mdW5jdGlvbiBJKCl7cmV0dXJuIHQoJC5mb290ZXIpfWZ1bmN0aW9uIEgoKXtyZXR1cm4gdCgkWyJ0aW1lci1wcm9ncmVzcy1iYXIiXSl9ZnVuY3Rpb24gVigpe3JldHVybiB0KCQuY2xvc2UpfWZ1bmN0aW9uIFIoKXt2YXIgdD1nKEEoKS5xdWVyeVNlbGVjdG9yQWxsKCdbdGFiaW5kZXhdOm5vdChbdGFiaW5kZXg9Ii0xIl0pOm5vdChbdGFiaW5kZXg9IjAiXSknKSkuc29ydChmdW5jdGlvbih0LGUpe3JldHVybiB0PXBhcnNlSW50KHQuZ2V0QXR0cmlidXRlKCJ0YWJpbmRleCIpKSwoZT1wYXJzZUludChlLmdldEF0dHJpYnV0ZSgidGFiaW5kZXgiKSkpPHQ/MTp0PGU/LTE6MH0pLGU9ZyhBKCkucXVlcnlTZWxlY3RvckFsbCgnXG4gIGFbaHJlZl0sXG4gIGFyZWFbaHJlZl0sXG4gIGlucHV0Om5vdChbZGlzYWJsZWRdKSxcbiAgc2VsZWN0Om5vdChbZGlzYWJsZWRdKSxcbiAgdGV4dGFyZWE6bm90KFtkaXNhYmxlZF0pLFxuICBidXR0b246bm90KFtkaXNhYmxlZF0pLFxuICBpZnJhbWUsXG4gIG9iamVjdCxcbiAgZW1iZWQsXG4gIFt0YWJpbmRleD0iMCJdLFxuICBbY29udGVudGVkaXRhYmxlXSxcbiAgYXVkaW9bY29udHJvbHNdLFxuICB2aWRlb1tjb250cm9sc10sXG4gIHN1bW1hcnlcbicpKS5maWx0ZXIoZnVuY3Rpb24odCl7cmV0dXJuIi0xIiE9PXQuZ2V0QXR0cmlidXRlKCJ0YWJpbmRleCIpfSk7cmV0dXJuIGZ1bmN0aW9uKHQpe2Zvcih2YXIgZT1bXSxuPTA7bjx0Lmxlbmd0aDtuKyspLTE9PT1lLmluZGV4T2YodFtuXSkmJmUucHVzaCh0W25dKTtyZXR1cm4gZX0odC5jb25jYXQoZSkpLmZpbHRlcihmdW5jdGlvbih0KXtyZXR1cm4gd3QodCl9KX1mdW5jdGlvbiBOKCl7cmV0dXJuIUcoKSYmIWRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmNvbnRhaW5zKCRbIm5vLWJhY2tkcm9wIl0pfWZ1bmN0aW9uIFUoZSx0KXtlLnRleHRDb250ZW50PSIiLHQmJih0PShuZXcgRE9NUGFyc2VyKS5wYXJzZUZyb21TdHJpbmcodCwidGV4dC9odG1sIiksZyh0LnF1ZXJ5U2VsZWN0b3IoImhlYWQiKS5jaGlsZE5vZGVzKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe2UuYXBwZW5kQ2hpbGQodCl9KSxnKHQucXVlcnlTZWxlY3RvcigiYm9keSIpLmNoaWxkTm9kZXMpLmZvckVhY2goZnVuY3Rpb24odCl7ZS5hcHBlbmRDaGlsZCh0KX0pKX1mdW5jdGlvbiBGKHQsZSl7aWYoZSl7Zm9yKHZhciBuPWUuc3BsaXQoL1xzKy8pLG89MDtvPG4ubGVuZ3RoO28rKylpZighdC5jbGFzc0xpc3QuY29udGFpbnMobltvXSkpcmV0dXJuO3JldHVybiAxfX1mdW5jdGlvbiBfKHQsZSxuKXt2YXIgbyxpO2lmKGk9ZSxnKChvPXQpLmNsYXNzTGlzdCkuZm9yRWFjaChmdW5jdGlvbih0KXstMT09PWgoJCkuaW5kZXhPZih0KSYmLTE9PT1oKFgpLmluZGV4T2YodCkmJi0xPT09aChpLnNob3dDbGFzcykuaW5kZXhPZih0KSYmby5jbGFzc0xpc3QucmVtb3ZlKHQpfSksZS5jdXN0b21DbGFzcyYmZS5jdXN0b21DbGFzc1tuXSl7aWYoInN0cmluZyIhPXR5cGVvZiBlLmN1c3RvbUNsYXNzW25dJiYhZS5jdXN0b21DbGFzc1tuXS5mb3JFYWNoKXJldHVybiBXKCJJbnZhbGlkIHR5cGUgb2YgY3VzdG9tQ2xhc3MuIi5jb25jYXQobiwnISBFeHBlY3RlZCBzdHJpbmcgb3IgaXRlcmFibGUgb2JqZWN0LCBnb3QgIicpLmNvbmNhdChyKGUuY3VzdG9tQ2xhc3Nbbl0pLCciJykpO3Z0KHQsZS5jdXN0b21DbGFzc1tuXSl9fXZhciB6PSJTd2VldEFsZXJ0MjoiLFc9ZnVuY3Rpb24odCl7Y29uc29sZS53YXJuKCIiLmNvbmNhdCh6LCIgIikuY29uY2F0KCJvYmplY3QiPT09cih0KT90LmpvaW4oIiAiKTp0KSl9LEs9ZnVuY3Rpb24odCl7Y29uc29sZS5lcnJvcigiIi5jb25jYXQoeiwiICIpLmNvbmNhdCh0KSl9LFk9W10sWj1mdW5jdGlvbih0KXtyZXR1cm4iZnVuY3Rpb24iPT10eXBlb2YgdD90KCk6dH0sUT1PYmplY3QuZnJlZXplKHtjYW5jZWw6ImNhbmNlbCIsYmFja2Ryb3A6ImJhY2tkcm9wIixjbG9zZToiY2xvc2UiLGVzYzoiZXNjIix0aW1lcjoidGltZXIifSksSj1mdW5jdGlvbih0KXt2YXIgZSxuPXt9O2ZvcihlIGluIHQpblt0W2VdXT0ic3dhbDItIit0W2VdO3JldHVybiBufSwkPUooWyJjb250YWluZXIiLCJzaG93biIsImhlaWdodC1hdXRvIiwiaW9zZml4IiwicG9wdXAiLCJtb2RhbCIsIm5vLWJhY2tkcm9wIiwibm8tdHJhbnNpdGlvbiIsInRvYXN0IiwidG9hc3Qtc2hvd24iLCJzaG93IiwiaGlkZSIsImNsb3NlIiwidGl0bGUiLCJoZWFkZXIiLCJjb250ZW50IiwiaHRtbC1jb250YWluZXIiLCJhY3Rpb25zIiwiY29uZmlybSIsImRlbnkiLCJjYW5jZWwiLCJmb290ZXIiLCJpY29uIiwiaWNvbi1jb250ZW50IiwiaW1hZ2UiLCJpbnB1dCIsImZpbGUiLCJyYW5nZSIsInNlbGVjdCIsInJhZGlvIiwiY2hlY2tib3giLCJsYWJlbCIsInRleHRhcmVhIiwiaW5wdXRlcnJvciIsImlucHV0LWxhYmVsIiwidmFsaWRhdGlvbi1tZXNzYWdlIiwicHJvZ3Jlc3Mtc3RlcHMiLCJhY3RpdmUtcHJvZ3Jlc3Mtc3RlcCIsInByb2dyZXNzLXN0ZXAiLCJwcm9ncmVzcy1zdGVwLWxpbmUiLCJsb2FkZXIiLCJsb2FkaW5nIiwic3R5bGVkIiwidG9wIiwidG9wLXN0YXJ0IiwidG9wLWVuZCIsInRvcC1sZWZ0IiwidG9wLXJpZ2h0IiwiY2VudGVyIiwiY2VudGVyLXN0YXJ0IiwiY2VudGVyLWVuZCIsImNlbnRlci1sZWZ0IiwiY2VudGVyLXJpZ2h0IiwiYm90dG9tIiwiYm90dG9tLXN0YXJ0IiwiYm90dG9tLWVuZCIsImJvdHRvbS1sZWZ0IiwiYm90dG9tLXJpZ2h0IiwiZ3Jvdy1yb3ciLCJncm93LWNvbHVtbiIsImdyb3ctZnVsbHNjcmVlbiIsInJ0bCIsInRpbWVyLXByb2dyZXNzLWJhciIsInRpbWVyLXByb2dyZXNzLWJhci1jb250YWluZXIiLCJzY3JvbGxiYXItbWVhc3VyZSIsImljb24tc3VjY2VzcyIsImljb24td2FybmluZyIsImljb24taW5mbyIsImljb24tcXVlc3Rpb24iLCJpY29uLWVycm9yIl0pLFg9SihbInN1Y2Nlc3MiLCJ3YXJuaW5nIiwiaW5mbyIsInF1ZXN0aW9uIiwiZXJyb3IiXSksRz1mdW5jdGlvbigpe3JldHVybiBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5jb250YWlucygkWyJ0b2FzdC1zaG93biJdKX0sdHQ9e3ByZXZpb3VzQm9keVBhZGRpbmc6bnVsbH07ZnVuY3Rpb24gZXQodCxlKXtpZighZSlyZXR1cm4gbnVsbDtzd2l0Y2goZSl7Y2FzZSJzZWxlY3QiOmNhc2UidGV4dGFyZWEiOmNhc2UiZmlsZSI6cmV0dXJuIHl0KHQsJFtlXSk7Y2FzZSJjaGVja2JveCI6cmV0dXJuIHQucXVlcnlTZWxlY3RvcigiLiIuY29uY2F0KCQuY2hlY2tib3gsIiBpbnB1dCIpKTtjYXNlInJhZGlvIjpyZXR1cm4gdC5xdWVyeVNlbGVjdG9yKCIuIi5jb25jYXQoJC5yYWRpbywiIGlucHV0OmNoZWNrZWQiKSl8fHQucXVlcnlTZWxlY3RvcigiLiIuY29uY2F0KCQucmFkaW8sIiBpbnB1dDpmaXJzdC1jaGlsZCIpKTtjYXNlInJhbmdlIjpyZXR1cm4gdC5xdWVyeVNlbGVjdG9yKCIuIi5jb25jYXQoJC5yYW5nZSwiIGlucHV0IikpO2RlZmF1bHQ6cmV0dXJuIHl0KHQsJC5pbnB1dCl9fWZ1bmN0aW9uIG50KHQpe3ZhciBlO3QuZm9jdXMoKSwiZmlsZSIhPT10LnR5cGUmJihlPXQudmFsdWUsdC52YWx1ZT0iIix0LnZhbHVlPWUpfWZ1bmN0aW9uIG90KHQsZSxuKXt0JiZlJiYoZT0ic3RyaW5nIj09dHlwZW9mIGU/ZS5zcGxpdCgvXHMrLykuZmlsdGVyKEJvb2xlYW4pOmUpLmZvckVhY2goZnVuY3Rpb24oZSl7dC5mb3JFYWNoP3QuZm9yRWFjaChmdW5jdGlvbih0KXtuP3QuY2xhc3NMaXN0LmFkZChlKTp0LmNsYXNzTGlzdC5yZW1vdmUoZSl9KTpuP3QuY2xhc3NMaXN0LmFkZChlKTp0LmNsYXNzTGlzdC5yZW1vdmUoZSl9KX1mdW5jdGlvbiBpdCh0LGUsbil7KG49bj09PSIiLmNvbmNhdChwYXJzZUludChuKSk/cGFyc2VJbnQobik6bil8fDA9PT1wYXJzZUludChuKT90LnN0eWxlW2VdPSJudW1iZXIiPT10eXBlb2Ygbj8iIi5jb25jYXQobiwicHgiKTpuOnQuc3R5bGUucmVtb3ZlUHJvcGVydHkoZSl9ZnVuY3Rpb24gcnQodCl7dC5zdHlsZS5kaXNwbGF5PTE8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXToiZmxleCJ9ZnVuY3Rpb24gYXQodCl7dC5zdHlsZS5kaXNwbGF5PSJub25lIn1mdW5jdGlvbiBzdCh0LGUsbixvKXsoZT10LnF1ZXJ5U2VsZWN0b3IoZSkpJiYoZS5zdHlsZVtuXT1vKX1mdW5jdGlvbiB1dCh0LGUsbil7ZT9ydCh0LG4pOmF0KHQpfWZ1bmN0aW9uIGN0KHQpe3JldHVybiEhKHQuc2Nyb2xsSGVpZ2h0PnQuY2xpZW50SGVpZ2h0KX1mdW5jdGlvbiBsdCh0KXt2YXIgZT13aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0KSx0PXBhcnNlRmxvYXQoZS5nZXRQcm9wZXJ0eVZhbHVlKCJhbmltYXRpb24tZHVyYXRpb24iKXx8IjAiKSxlPXBhcnNlRmxvYXQoZS5nZXRQcm9wZXJ0eVZhbHVlKCJ0cmFuc2l0aW9uLWR1cmF0aW9uIil8fCIwIik7cmV0dXJuIDA8dHx8MDxlfWZ1bmN0aW9uIGR0KHQpe3ZhciBlPTE8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzFdJiZhcmd1bWVudHNbMV0sbj1IKCk7d3QobikmJihlJiYobi5zdHlsZS50cmFuc2l0aW9uPSJub25lIixuLnN0eWxlLndpZHRoPSIxMDAlIiksc2V0VGltZW91dChmdW5jdGlvbigpe24uc3R5bGUudHJhbnNpdGlvbj0id2lkdGggIi5jb25jYXQodC8xZTMsInMgbGluZWFyIiksbi5zdHlsZS53aWR0aD0iMCUifSwxMCkpfWZ1bmN0aW9uIHB0KCl7cmV0dXJuInVuZGVmaW5lZCI9PXR5cGVvZiB3aW5kb3d8fCJ1bmRlZmluZWQiPT10eXBlb2YgZG9jdW1lbnR9ZnVuY3Rpb24gZnQodCl7TW4uaXNWaXNpYmxlKCkmJmd0IT09dC50YXJnZXQudmFsdWUmJk1uLnJlc2V0VmFsaWRhdGlvbk1lc3NhZ2UoKSxndD10LnRhcmdldC52YWx1ZX1mdW5jdGlvbiBtdCh0LGUpe3QgaW5zdGFuY2VvZiBIVE1MRWxlbWVudD9lLmFwcGVuZENoaWxkKHQpOiJvYmplY3QiPT09cih0KT9BdCh0LGUpOnQmJlUoZSx0KX1mdW5jdGlvbiBodCh0LGUpe3ZhciBuPWooKSxvPUQoKSxpPVQoKSxyPUwoKSxhPXEoKTtlLnNob3dDb25maXJtQnV0dG9ufHxlLnNob3dEZW55QnV0dG9ufHxlLnNob3dDYW5jZWxCdXR0b258fGF0KG4pLF8obixlLCJhY3Rpb25zIiksUHQoaSwiY29uZmlybSIsZSksUHQociwiZGVueSIsZSksUHQoYSwiY2FuY2VsIixlKSxmdW5jdGlvbih0LGUsbixvKXtpZighby5idXR0b25zU3R5bGluZylyZXR1cm4gYnQoW3QsZSxuXSwkLnN0eWxlZCk7dnQoW3QsZSxuXSwkLnN0eWxlZCksby5jb25maXJtQnV0dG9uQ29sb3ImJih0LnN0eWxlLmJhY2tncm91bmRDb2xvcj1vLmNvbmZpcm1CdXR0b25Db2xvcik7by5kZW55QnV0dG9uQ29sb3ImJihlLnN0eWxlLmJhY2tncm91bmRDb2xvcj1vLmRlbnlCdXR0b25Db2xvcik7by5jYW5jZWxCdXR0b25Db2xvciYmKG4uc3R5bGUuYmFja2dyb3VuZENvbG9yPW8uY2FuY2VsQnV0dG9uQ29sb3IpfShpLHIsYSxlKSxlLnJldmVyc2VCdXR0b25zJiYobi5pbnNlcnRCZWZvcmUoYSxvKSxuLmluc2VydEJlZm9yZShyLG8pLG4uaW5zZXJ0QmVmb3JlKGksbykpLFUobyxlLmxvYWRlckh0bWwpLF8obyxlLCJsb2FkZXIiKX12YXIgZ3QsdnQ9ZnVuY3Rpb24odCxlKXtvdCh0LGUsITApfSxidD1mdW5jdGlvbih0LGUpe290KHQsZSwhMSl9LHl0PWZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBuPTA7bjx0LmNoaWxkTm9kZXMubGVuZ3RoO24rKylpZihGKHQuY2hpbGROb2Rlc1tuXSxlKSlyZXR1cm4gdC5jaGlsZE5vZGVzW25dfSx3dD1mdW5jdGlvbih0KXtyZXR1cm4hKCF0fHwhKHQub2Zmc2V0V2lkdGh8fHQub2Zmc2V0SGVpZ2h0fHx0LmdldENsaWVudFJlY3RzKCkubGVuZ3RoKSl9LEN0PSdcbiA8ZGl2IGFyaWEtbGFiZWxsZWRieT0iJy5jb25jYXQoJC50aXRsZSwnIiBhcmlhLWRlc2NyaWJlZGJ5PSInKS5jb25jYXQoJC5jb250ZW50LCciIGNsYXNzPSInKS5jb25jYXQoJC5wb3B1cCwnIiB0YWJpbmRleD0iLTEiPlxuICAgPGRpdiBjbGFzcz0iJykuY29uY2F0KCQuaGVhZGVyLCciPlxuICAgICA8dWwgY2xhc3M9IicpLmNvbmNhdCgkWyJwcm9ncmVzcy1zdGVwcyJdLCciPjwvdWw+XG4gICAgIDxkaXYgY2xhc3M9IicpLmNvbmNhdCgkLmljb24sJyI+PC9kaXY+XG4gICAgIDxpbWcgY2xhc3M9IicpLmNvbmNhdCgkLmltYWdlLCciIC8+XG4gICAgIDxoMiBjbGFzcz0iJykuY29uY2F0KCQudGl0bGUsJyIgaWQ9IicpLmNvbmNhdCgkLnRpdGxlLCciPjwvaDI+XG4gICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iJykuY29uY2F0KCQuY2xvc2UsJyI+PC9idXR0b24+XG4gICA8L2Rpdj5cbiAgIDxkaXYgY2xhc3M9IicpLmNvbmNhdCgkLmNvbnRlbnQsJyI+XG4gICAgIDxkaXYgaWQ9IicpLmNvbmNhdCgkLmNvbnRlbnQsJyIgY2xhc3M9IicpLmNvbmNhdCgkWyJodG1sLWNvbnRhaW5lciJdLCciPjwvZGl2PlxuICAgICA8aW5wdXQgY2xhc3M9IicpLmNvbmNhdCgkLmlucHV0LCciIC8+XG4gICAgIDxpbnB1dCB0eXBlPSJmaWxlIiBjbGFzcz0iJykuY29uY2F0KCQuZmlsZSwnIiAvPlxuICAgICA8ZGl2IGNsYXNzPSInKS5jb25jYXQoJC5yYW5nZSwnIj5cbiAgICAgICA8aW5wdXQgdHlwZT0icmFuZ2UiIC8+XG4gICAgICAgPG91dHB1dD48L291dHB1dD5cbiAgICAgPC9kaXY+XG4gICAgIDxzZWxlY3QgY2xhc3M9IicpLmNvbmNhdCgkLnNlbGVjdCwnIj48L3NlbGVjdD5cbiAgICAgPGRpdiBjbGFzcz0iJykuY29uY2F0KCQucmFkaW8sJyI+PC9kaXY+XG4gICAgIDxsYWJlbCBmb3I9IicpLmNvbmNhdCgkLmNoZWNrYm94LCciIGNsYXNzPSInKS5jb25jYXQoJC5jaGVja2JveCwnIj5cbiAgICAgICA8aW5wdXQgdHlwZT0iY2hlY2tib3giIC8+XG4gICAgICAgPHNwYW4gY2xhc3M9IicpLmNvbmNhdCgkLmxhYmVsLCciPjwvc3Bhbj5cbiAgICAgPC9sYWJlbD5cbiAgICAgPHRleHRhcmVhIGNsYXNzPSInKS5jb25jYXQoJC50ZXh0YXJlYSwnIj48L3RleHRhcmVhPlxuICAgICA8ZGl2IGNsYXNzPSInKS5jb25jYXQoJFsidmFsaWRhdGlvbi1tZXNzYWdlIl0sJyIgaWQ9IicpLmNvbmNhdCgkWyJ2YWxpZGF0aW9uLW1lc3NhZ2UiXSwnIj48L2Rpdj5cbiAgIDwvZGl2PlxuICAgPGRpdiBjbGFzcz0iJykuY29uY2F0KCQuYWN0aW9ucywnIj5cbiAgICAgPGRpdiBjbGFzcz0iJykuY29uY2F0KCQubG9hZGVyLCciPjwvZGl2PlxuICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9IicpLmNvbmNhdCgkLmNvbmZpcm0sJyI+PC9idXR0b24+XG4gICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iJykuY29uY2F0KCQuZGVueSwnIj48L2J1dHRvbj5cbiAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSInKS5jb25jYXQoJC5jYW5jZWwsJyI+PC9idXR0b24+XG4gICA8L2Rpdj5cbiAgIDxkaXYgY2xhc3M9IicpLmNvbmNhdCgkLmZvb3RlciwnIj48L2Rpdj5cbiAgIDxkaXYgY2xhc3M9IicpLmNvbmNhdCgkWyJ0aW1lci1wcm9ncmVzcy1iYXItY29udGFpbmVyIl0sJyI+XG4gICAgIDxkaXYgY2xhc3M9IicpLmNvbmNhdCgkWyJ0aW1lci1wcm9ncmVzcy1iYXIiXSwnIj48L2Rpdj5cbiAgIDwvZGl2PlxuIDwvZGl2PlxuJykucmVwbGFjZSgvKF58XG4pXHMqL2csIiIpLGt0PWZ1bmN0aW9uKHQpe3ZhciBlLG4sbyxpLHIsYT0hIShpPWsoKSkmJihpLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoaSksYnQoW2RvY3VtZW50LmRvY3VtZW50RWxlbWVudCxkb2N1bWVudC5ib2R5XSxbJFsibm8tYmFja2Ryb3AiXSwkWyJ0b2FzdC1zaG93biJdLCRbImhhcy1jb2x1bW4iXV0pLCEwKTtwdCgpP0soIlN3ZWV0QWxlcnQyIHJlcXVpcmVzIGRvY3VtZW50IHRvIGluaXRpYWxpemUiKTooKHI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikpLmNsYXNzTmFtZT0kLmNvbnRhaW5lcixhJiZ2dChyLCRbIm5vLXRyYW5zaXRpb24iXSksVShyLEN0KSwoaT0ic3RyaW5nIj09dHlwZW9mKGU9dC50YXJnZXQpP2RvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZSk6ZSkuYXBwZW5kQ2hpbGQociksYT10LChlPUEoKSkuc2V0QXR0cmlidXRlKCJyb2xlIixhLnRvYXN0PyJhbGVydCI6ImRpYWxvZyIpLGUuc2V0QXR0cmlidXRlKCJhcmlhLWxpdmUiLGEudG9hc3Q/InBvbGl0ZSI6ImFzc2VydGl2ZSIpLGEudG9hc3R8fGUuc2V0QXR0cmlidXRlKCJhcmlhLW1vZGFsIiwidHJ1ZSIpLHI9aSwicnRsIj09PXdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHIpLmRpcmVjdGlvbiYmdnQoaygpLCQucnRsKSx0PVAoKSxhPXl0KHQsJC5pbnB1dCksZT15dCh0LCQuZmlsZSksbj10LnF1ZXJ5U2VsZWN0b3IoIi4iLmNvbmNhdCgkLnJhbmdlLCIgaW5wdXQiKSksbz10LnF1ZXJ5U2VsZWN0b3IoIi4iLmNvbmNhdCgkLnJhbmdlLCIgb3V0cHV0IikpLGk9eXQodCwkLnNlbGVjdCkscj10LnF1ZXJ5U2VsZWN0b3IoIi4iLmNvbmNhdCgkLmNoZWNrYm94LCIgaW5wdXQiKSksdD15dCh0LCQudGV4dGFyZWEpLGEub25pbnB1dD1mdCxlLm9uY2hhbmdlPWZ0LGkub25jaGFuZ2U9ZnQsci5vbmNoYW5nZT1mdCx0Lm9uaW5wdXQ9ZnQsbi5vbmlucHV0PWZ1bmN0aW9uKHQpe2Z0KHQpLG8udmFsdWU9bi52YWx1ZX0sbi5vbmNoYW5nZT1mdW5jdGlvbih0KXtmdCh0KSxuLm5leHRTaWJsaW5nLnZhbHVlPW4udmFsdWV9KX0sQXQ9ZnVuY3Rpb24odCxlKXt0LmpxdWVyeT94dChlLHQpOlUoZSx0LnRvU3RyaW5nKCkpfSx4dD1mdW5jdGlvbih0LGUpe2lmKHQudGV4dENvbnRlbnQ9IiIsMCBpbiBlKWZvcih2YXIgbj0wO24gaW4gZTtuKyspdC5hcHBlbmRDaGlsZChlW25dLmNsb25lTm9kZSghMCkpO2Vsc2UgdC5hcHBlbmRDaGlsZChlLmNsb25lTm9kZSghMCkpfSxCdD1mdW5jdGlvbigpe2lmKHB0KCkpcmV0dXJuITE7dmFyIHQsZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSxuPXtXZWJraXRBbmltYXRpb246IndlYmtpdEFuaW1hdGlvbkVuZCIsT0FuaW1hdGlvbjoib0FuaW1hdGlvbkVuZCBvYW5pbWF0aW9uZW5kIixhbmltYXRpb246ImFuaW1hdGlvbmVuZCJ9O2Zvcih0IGluIG4paWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG4sdCkmJnZvaWQgMCE9PWUuc3R5bGVbdF0pcmV0dXJuIG5bdF07cmV0dXJuITF9KCk7ZnVuY3Rpb24gUHQodCxlLG4pe3V0KHQsblsic2hvdyIuY29uY2F0KG0oZSksIkJ1dHRvbiIpXSwiaW5saW5lLWJsb2NrIiksVSh0LG5bIiIuY29uY2F0KGUsIkJ1dHRvblRleHQiKV0pLHQuc2V0QXR0cmlidXRlKCJhcmlhLWxhYmVsIixuWyIiLmNvbmNhdChlLCJCdXR0b25BcmlhTGFiZWwiKV0pLHQuY2xhc3NOYW1lPSRbZV0sXyh0LG4sIiIuY29uY2F0KGUsIkJ1dHRvbiIpKSx2dCh0LG5bIiIuY29uY2F0KGUsIkJ1dHRvbkNsYXNzIildKX1mdW5jdGlvbiBPdCh0LGUpe3ZhciBuLG8saT1rKCk7aSYmKG89aSwic3RyaW5nIj09dHlwZW9mKG49ZS5iYWNrZHJvcCk/by5zdHlsZS5iYWNrZ3JvdW5kPW46bnx8dnQoW2RvY3VtZW50LmRvY3VtZW50RWxlbWVudCxkb2N1bWVudC5ib2R5XSwkWyJuby1iYWNrZHJvcCJdKSwhZS5iYWNrZHJvcCYmZS5hbGxvd091dHNpZGVDbGljayYmVygnImFsbG93T3V0c2lkZUNsaWNrIiBwYXJhbWV0ZXIgcmVxdWlyZXMgYGJhY2tkcm9wYCBwYXJhbWV0ZXIgdG8gYmUgc2V0IHRvIGB0cnVlYCcpLG89aSwobj1lLnBvc2l0aW9uKWluICQ/dnQobywkW25dKTooVygnVGhlICJwb3NpdGlvbiIgcGFyYW1ldGVyIGlzIG5vdCB2YWxpZCwgZGVmYXVsdGluZyB0byAiY2VudGVyIicpLHZ0KG8sJC5jZW50ZXIpKSxuPWksIShvPWUuZ3Jvdyl8fCJzdHJpbmciIT10eXBlb2Ygb3x8KG89Imdyb3ctIi5jb25jYXQobykpaW4gJCYmdnQobiwkW29dKSxfKGksZSwiY29udGFpbmVyIiksKGU9ZG9jdW1lbnQuYm9keS5nZXRBdHRyaWJ1dGUoImRhdGEtc3dhbDItcXVldWUtc3RlcCIpKSYmKGkuc2V0QXR0cmlidXRlKCJkYXRhLXF1ZXVlLXN0ZXAiLGUpLGRvY3VtZW50LmJvZHkucmVtb3ZlQXR0cmlidXRlKCJkYXRhLXN3YWwyLXF1ZXVlLXN0ZXAiKSkpfWZ1bmN0aW9uIEV0KHQsZSl7dC5wbGFjZWhvbGRlciYmIWUuaW5wdXRQbGFjZWhvbGRlcnx8KHQucGxhY2Vob2xkZXI9ZS5pbnB1dFBsYWNlaG9sZGVyKX1mdW5jdGlvbiBTdCh0LGUsbil7dmFyIG8saTtuLmlucHV0TGFiZWwmJih0LmlkPSQuaW5wdXQsbz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJsYWJlbCIpLGk9JFsiaW5wdXQtbGFiZWwiXSxvLnNldEF0dHJpYnV0ZSgiZm9yIix0LmlkKSxvLmNsYXNzTmFtZT1pLHZ0KG8sbi5jdXN0b21DbGFzcy5pbnB1dExhYmVsKSxvLmlubmVyVGV4dD1uLmlucHV0TGFiZWwsZS5pbnNlcnRBZGphY2VudEVsZW1lbnQoImJlZm9yZWJlZ2luIixvKSl9dmFyIFR0PXtwcm9taXNlOm5ldyBXZWFrTWFwLGlubmVyUGFyYW1zOm5ldyBXZWFrTWFwLGRvbUNhY2hlOm5ldyBXZWFrTWFwfSxMdD1bImlucHV0IiwiZmlsZSIsInJhbmdlIiwic2VsZWN0IiwicmFkaW8iLCJjaGVja2JveCIsInRleHRhcmVhIl0sRHQ9ZnVuY3Rpb24odCl7aWYoIUl0W3QuaW5wdXRdKXJldHVybiBLKCdVbmV4cGVjdGVkIHR5cGUgb2YgaW5wdXQhIEV4cGVjdGVkICJ0ZXh0IiwgImVtYWlsIiwgInBhc3N3b3JkIiwgIm51bWJlciIsICJ0ZWwiLCAic2VsZWN0IiwgInJhZGlvIiwgImNoZWNrYm94IiwgInRleHRhcmVhIiwgImZpbGUiIG9yICJ1cmwiLCBnb3QgIicuY29uY2F0KHQuaW5wdXQsJyInKSk7dmFyIGU9TXQodC5pbnB1dCksbj1JdFt0LmlucHV0XShlLHQpO3J0KG4pLHNldFRpbWVvdXQoZnVuY3Rpb24oKXtudChuKX0pfSxxdD1mdW5jdGlvbih0LGUpe3ZhciBuPWV0KFAoKSx0KTtpZihuKWZvcih2YXIgbyBpbiFmdW5jdGlvbih0KXtmb3IodmFyIGU9MDtlPHQuYXR0cmlidXRlcy5sZW5ndGg7ZSsrKXt2YXIgbj10LmF0dHJpYnV0ZXNbZV0ubmFtZTstMT09PVsidHlwZSIsInZhbHVlIiwic3R5bGUiXS5pbmRleE9mKG4pJiZ0LnJlbW92ZUF0dHJpYnV0ZShuKX19KG4pLGUpInJhbmdlIj09PXQmJiJwbGFjZWhvbGRlciI9PT1vfHxuLnNldEF0dHJpYnV0ZShvLGVbb10pfSxqdD1mdW5jdGlvbih0KXt2YXIgZT1NdCh0LmlucHV0KTt0LmN1c3RvbUNsYXNzJiZ2dChlLHQuY3VzdG9tQ2xhc3MuaW5wdXQpfSxNdD1mdW5jdGlvbih0KXt0PSRbdF18fCQuaW5wdXQ7cmV0dXJuIHl0KFAoKSx0KX0sSXQ9e307SXQudGV4dD1JdC5lbWFpbD1JdC5wYXNzd29yZD1JdC5udW1iZXI9SXQudGVsPUl0LnVybD1mdW5jdGlvbih0LGUpe3JldHVybiJzdHJpbmciPT10eXBlb2YgZS5pbnB1dFZhbHVlfHwibnVtYmVyIj09dHlwZW9mIGUuaW5wdXRWYWx1ZT90LnZhbHVlPWUuaW5wdXRWYWx1ZTp3KGUuaW5wdXRWYWx1ZSl8fFcoJ1VuZXhwZWN0ZWQgdHlwZSBvZiBpbnB1dFZhbHVlISBFeHBlY3RlZCAic3RyaW5nIiwgIm51bWJlciIgb3IgIlByb21pc2UiLCBnb3QgIicuY29uY2F0KHIoZS5pbnB1dFZhbHVlKSwnIicpKSxTdCh0LHQsZSksRXQodCxlKSx0LnR5cGU9ZS5pbnB1dCx0fSxJdC5maWxlPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIFN0KHQsdCxlKSxFdCh0LGUpLHR9LEl0LnJhbmdlPWZ1bmN0aW9uKHQsZSl7dmFyIG49dC5xdWVyeVNlbGVjdG9yKCJpbnB1dCIpLG89dC5xdWVyeVNlbGVjdG9yKCJvdXRwdXQiKTtyZXR1cm4gbi52YWx1ZT1lLmlucHV0VmFsdWUsbi50eXBlPWUuaW5wdXQsby52YWx1ZT1lLmlucHV0VmFsdWUsU3Qobix0LGUpLHR9LEl0LnNlbGVjdD1mdW5jdGlvbih0LGUpe3ZhciBuO3JldHVybiB0LnRleHRDb250ZW50PSIiLGUuaW5wdXRQbGFjZWhvbGRlciYmKG49ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgib3B0aW9uIiksVShuLGUuaW5wdXRQbGFjZWhvbGRlciksbi52YWx1ZT0iIixuLmRpc2FibGVkPSEwLG4uc2VsZWN0ZWQ9ITAsdC5hcHBlbmRDaGlsZChuKSksU3QodCx0LGUpLHR9LEl0LnJhZGlvPWZ1bmN0aW9uKHQpe3JldHVybiB0LnRleHRDb250ZW50PSIiLHR9LEl0LmNoZWNrYm94PWZ1bmN0aW9uKHQsZSl7dmFyIG49ZXQoUCgpLCJjaGVja2JveCIpO24udmFsdWU9MSxuLmlkPSQuY2hlY2tib3gsbi5jaGVja2VkPUJvb2xlYW4oZS5pbnB1dFZhbHVlKTtuPXQucXVlcnlTZWxlY3Rvcigic3BhbiIpO3JldHVybiBVKG4sZS5pbnB1dFBsYWNlaG9sZGVyKSx0fSxJdC50ZXh0YXJlYT1mdW5jdGlvbihlLHQpe2UudmFsdWU9dC5pbnB1dFZhbHVlLEV0KGUsdCksU3QoZSxlLHQpO2Z1bmN0aW9uIG4odCl7cmV0dXJuIHBhcnNlSW50KHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHQpLnBhZGRpbmdMZWZ0KStwYXJzZUludCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0KS5wYWRkaW5nUmlnaHQpfXZhciBvO3JldHVybiJNdXRhdGlvbk9ic2VydmVyImluIHdpbmRvdyYmKG89cGFyc2VJbnQod2luZG93LmdldENvbXB1dGVkU3R5bGUoQSgpKS53aWR0aCksbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24oKXt2YXIgdD1lLm9mZnNldFdpZHRoK24oQSgpKStuKFAoKSk7QSgpLnN0eWxlLndpZHRoPW88dD8iIi5jb25jYXQodCwicHgiKTpudWxsfSkub2JzZXJ2ZShlLHthdHRyaWJ1dGVzOiEwLGF0dHJpYnV0ZUZpbHRlcjpbInN0eWxlIl19KSksZX07ZnVuY3Rpb24gSHQodCxlKXt2YXIgbyxpLHIsbj1PKCk7XyhuLGUsImh0bWxDb250YWluZXIiKSxlLmh0bWw/KG10KGUuaHRtbCxuKSxydChuLCJibG9jayIpKTplLnRleHQ/KG4udGV4dENvbnRlbnQ9ZS50ZXh0LHJ0KG4sImJsb2NrIikpOmF0KG4pLHQ9dCxvPWUsaT1QKCksdD1UdC5pbm5lclBhcmFtcy5nZXQodCkscj0hdHx8by5pbnB1dCE9PXQuaW5wdXQsTHQuZm9yRWFjaChmdW5jdGlvbih0KXt2YXIgZT0kW3RdLG49eXQoaSxlKTtxdCh0LG8uaW5wdXRBdHRyaWJ1dGVzKSxuLmNsYXNzTmFtZT1lLHImJmF0KG4pfSksby5pbnB1dCYmKHImJkR0KG8pLGp0KG8pKSxfKFAoKSxlLCJjb250ZW50Iil9ZnVuY3Rpb24gVnQoKXtyZXR1cm4gaygpJiZrKCkuZ2V0QXR0cmlidXRlKCJkYXRhLXF1ZXVlLXN0ZXAiKX1mdW5jdGlvbiBSdCh0LG8pe3ZhciBpPW4oKTtpZighby5wcm9ncmVzc1N0ZXBzfHwwPT09by5wcm9ncmVzc1N0ZXBzLmxlbmd0aClyZXR1cm4gYXQoaSksMDtydChpKSxpLnRleHRDb250ZW50PSIiO3ZhciByPXBhcnNlSW50KHZvaWQgMD09PW8uY3VycmVudFByb2dyZXNzU3RlcD9WdCgpOm8uY3VycmVudFByb2dyZXNzU3RlcCk7cj49by5wcm9ncmVzc1N0ZXBzLmxlbmd0aCYmVygiSW52YWxpZCBjdXJyZW50UHJvZ3Jlc3NTdGVwIHBhcmFtZXRlciwgaXQgc2hvdWxkIGJlIGxlc3MgdGhhbiBwcm9ncmVzc1N0ZXBzLmxlbmd0aCAoY3VycmVudFByb2dyZXNzU3RlcCBsaWtlIEpTIGFycmF5cyBzdGFydHMgZnJvbSAwKSIpLG8ucHJvZ3Jlc3NTdGVwcy5mb3JFYWNoKGZ1bmN0aW9uKHQsZSl7dmFyIG4sdD0obj10LHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgibGkiKSx2dCh0LCRbInByb2dyZXNzLXN0ZXAiXSksVSh0LG4pLHQpO2kuYXBwZW5kQ2hpbGQodCksZT09PXImJnZ0KHQsJFsiYWN0aXZlLXByb2dyZXNzLXN0ZXAiXSksZSE9PW8ucHJvZ3Jlc3NTdGVwcy5sZW5ndGgtMSYmKHQ9byxlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImxpIiksdnQoZSwkWyJwcm9ncmVzcy1zdGVwLWxpbmUiXSksdC5wcm9ncmVzc1N0ZXBzRGlzdGFuY2UmJihlLnN0eWxlLndpZHRoPXQucHJvZ3Jlc3NTdGVwc0Rpc3RhbmNlKSxpLmFwcGVuZENoaWxkKGUpKX0pfWZ1bmN0aW9uIE50KHQsZSl7dmFyIG4sbz1NKCk7XyhvLGUsImhlYWRlciIpLFJ0KDAsZSksbj10LG89ZSx0PVR0LmlubmVyUGFyYW1zLmdldChuKSxuPXgoKSx0JiZvLmljb249PT10Lmljb24/KFd0KG4sbyksX3QobixvKSk6by5pY29ufHxvLmljb25IdG1sP28uaWNvbiYmLTE9PT1PYmplY3Qua2V5cyhYKS5pbmRleE9mKG8uaWNvbik/KEsoJ1Vua25vd24gaWNvbiEgRXhwZWN0ZWQgInN1Y2Nlc3MiLCAiZXJyb3IiLCAid2FybmluZyIsICJpbmZvIiBvciAicXVlc3Rpb24iLCBnb3QgIicuY29uY2F0KG8uaWNvbiwnIicpKSxhdChuKSk6KHJ0KG4pLFd0KG4sbyksX3QobixvKSx2dChuLG8uc2hvd0NsYXNzLmljb24pKTphdChuKSxmdW5jdGlvbih0KXt2YXIgZT1FKCk7aWYoIXQuaW1hZ2VVcmwpcmV0dXJuIGF0KGUpO3J0KGUsIiIpLGUuc2V0QXR0cmlidXRlKCJzcmMiLHQuaW1hZ2VVcmwpLGUuc2V0QXR0cmlidXRlKCJhbHQiLHQuaW1hZ2VBbHQpLGl0KGUsIndpZHRoIix0LmltYWdlV2lkdGgpLGl0KGUsImhlaWdodCIsdC5pbWFnZUhlaWdodCksZS5jbGFzc05hbWU9JC5pbWFnZSxfKGUsdCwiaW1hZ2UiKX0oZSksbz1lLG49QigpLHV0KG4sby50aXRsZXx8by50aXRsZVRleHQsImJsb2NrIiksby50aXRsZSYmbXQoby50aXRsZSxuKSxvLnRpdGxlVGV4dCYmKG4uaW5uZXJUZXh0PW8udGl0bGVUZXh0KSxfKG4sbywidGl0bGUiKSxvPWUsZT1WKCksVShlLG8uY2xvc2VCdXR0b25IdG1sKSxfKGUsbywiY2xvc2VCdXR0b24iKSx1dChlLG8uc2hvd0Nsb3NlQnV0dG9uKSxlLnNldEF0dHJpYnV0ZSgiYXJpYS1sYWJlbCIsby5jbG9zZUJ1dHRvbkFyaWFMYWJlbCl9ZnVuY3Rpb24gVXQodCxlKXt2YXIgbixvLGk7aT1lLG49aygpLG89QSgpLGkudG9hc3Q/KGl0KG4sIndpZHRoIixpLndpZHRoKSxvLnN0eWxlLndpZHRoPSIxMDAlIik6aXQobywid2lkdGgiLGkud2lkdGgpLGl0KG8sInBhZGRpbmciLGkucGFkZGluZyksaS5iYWNrZ3JvdW5kJiYoby5zdHlsZS5iYWNrZ3JvdW5kPWkuYmFja2dyb3VuZCksYXQoUygpKSxRdChvLGkpLE90KDAsZSksTnQodCxlKSxIdCh0LGUpLGh0KDAsZSksaT1lLHQ9SSgpLHV0KHQsaS5mb290ZXIpLGkuZm9vdGVyJiZtdChpLmZvb3Rlcix0KSxfKHQsaSwiZm9vdGVyIiksImZ1bmN0aW9uIj09dHlwZW9mIGUuZGlkUmVuZGVyP2UuZGlkUmVuZGVyKEEoKSk6ImZ1bmN0aW9uIj09dHlwZW9mIGUub25SZW5kZXImJmUub25SZW5kZXIoQSgpKX1mdW5jdGlvbiBGdCgpe3JldHVybiBUKCkmJlQoKS5jbGljaygpfXZhciBfdD1mdW5jdGlvbih0LGUpe2Zvcih2YXIgbiBpbiBYKWUuaWNvbiE9PW4mJmJ0KHQsWFtuXSk7dnQodCxYW2UuaWNvbl0pLEt0KHQsZSksenQoKSxfKHQsZSwiaWNvbiIpfSx6dD1mdW5jdGlvbigpe2Zvcih2YXIgdD1BKCksZT13aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0KS5nZXRQcm9wZXJ0eVZhbHVlKCJiYWNrZ3JvdW5kLWNvbG9yIiksbj10LnF1ZXJ5U2VsZWN0b3JBbGwoIltjbGFzc149c3dhbDItc3VjY2Vzcy1jaXJjdWxhci1saW5lXSwgLnN3YWwyLXN1Y2Nlc3MtZml4Iiksbz0wO288bi5sZW5ndGg7bysrKW5bb10uc3R5bGUuYmFja2dyb3VuZENvbG9yPWV9LFd0PWZ1bmN0aW9uKHQsZSl7dC50ZXh0Q29udGVudD0iIixlLmljb25IdG1sP1UodCxZdChlLmljb25IdG1sKSk6InN1Y2Nlc3MiPT09ZS5pY29uP1UodCwnXG4gICAgICA8ZGl2IGNsYXNzPSJzd2FsMi1zdWNjZXNzLWNpcmN1bGFyLWxpbmUtbGVmdCI+PC9kaXY+XG4gICAgICA8c3BhbiBjbGFzcz0ic3dhbDItc3VjY2Vzcy1saW5lLXRpcCI+PC9zcGFuPiA8c3BhbiBjbGFzcz0ic3dhbDItc3VjY2Vzcy1saW5lLWxvbmciPjwvc3Bhbj5cbiAgICAgIDxkaXYgY2xhc3M9InN3YWwyLXN1Y2Nlc3MtcmluZyI+PC9kaXY+IDxkaXYgY2xhc3M9InN3YWwyLXN1Y2Nlc3MtZml4Ij48L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3M9InN3YWwyLXN1Y2Nlc3MtY2lyY3VsYXItbGluZS1yaWdodCI+PC9kaXY+XG4gICAgJyk6ImVycm9yIj09PWUuaWNvbj9VKHQsJ1xuICAgICAgPHNwYW4gY2xhc3M9InN3YWwyLXgtbWFyayI+XG4gICAgICAgIDxzcGFuIGNsYXNzPSJzd2FsMi14LW1hcmstbGluZS1sZWZ0Ij48L3NwYW4+XG4gICAgICAgIDxzcGFuIGNsYXNzPSJzd2FsMi14LW1hcmstbGluZS1yaWdodCI+PC9zcGFuPlxuICAgICAgPC9zcGFuPlxuICAgICcpOlUodCxZdCh7cXVlc3Rpb246Ij8iLHdhcm5pbmc6IiEiLGluZm86ImkifVtlLmljb25dKSl9LEt0PWZ1bmN0aW9uKHQsZSl7aWYoZS5pY29uQ29sb3Ipe3Quc3R5bGUuY29sb3I9ZS5pY29uQ29sb3IsdC5zdHlsZS5ib3JkZXJDb2xvcj1lLmljb25Db2xvcjtmb3IodmFyIG49MCxvPVsiLnN3YWwyLXN1Y2Nlc3MtbGluZS10aXAiLCIuc3dhbDItc3VjY2Vzcy1saW5lLWxvbmciLCIuc3dhbDIteC1tYXJrLWxpbmUtbGVmdCIsIi5zd2FsMi14LW1hcmstbGluZS1yaWdodCJdO248by5sZW5ndGg7bisrKXN0KHQsb1tuXSwiYmFja2dyb3VuZENvbG9yIixlLmljb25Db2xvcik7c3QodCwiLnN3YWwyLXN1Y2Nlc3MtcmluZyIsImJvcmRlckNvbG9yIixlLmljb25Db2xvcil9fSxZdD1mdW5jdGlvbih0KXtyZXR1cm4nPGRpdiBjbGFzcz0iJy5jb25jYXQoJFsiaWNvbi1jb250ZW50Il0sJyI+JykuY29uY2F0KHQsIjwvZGl2PiIpfSxadD1bXSxRdD1mdW5jdGlvbih0LGUpe3QuY2xhc3NOYW1lPSIiLmNvbmNhdCgkLnBvcHVwLCIgIikuY29uY2F0KHd0KHQpP2Uuc2hvd0NsYXNzLnBvcHVwOiIiKSxlLnRvYXN0Pyh2dChbZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LGRvY3VtZW50LmJvZHldLCRbInRvYXN0LXNob3duIl0pLHZ0KHQsJC50b2FzdCkpOnZ0KHQsJC5tb2RhbCksXyh0LGUsInBvcHVwIiksInN0cmluZyI9PXR5cGVvZiBlLmN1c3RvbUNsYXNzJiZ2dCh0LGUuY3VzdG9tQ2xhc3MpLGUuaWNvbiYmdnQodCwkWyJpY29uLSIuY29uY2F0KGUuaWNvbildKX07ZnVuY3Rpb24gSnQodCl7KGU9QSgpKXx8TW4uZmlyZSgpO3ZhciBlPUEoKSxuPWooKSxvPUQoKTshdCYmd3QoVCgpKSYmKHQ9VCgpKSxydChuKSx0JiYoYXQodCksby5zZXRBdHRyaWJ1dGUoImRhdGEtYnV0dG9uLXRvLXJlcGxhY2UiLHQuY2xhc3NOYW1lKSksby5wYXJlbnROb2RlLmluc2VydEJlZm9yZShvLHQpLHZ0KFtlLG5dLCQubG9hZGluZykscnQobyksZS5zZXRBdHRyaWJ1dGUoImRhdGEtbG9hZGluZyIsITApLGUuc2V0QXR0cmlidXRlKCJhcmlhLWJ1c3kiLCEwKSxlLmZvY3VzKCl9ZnVuY3Rpb24gJHQobyl7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHQpe2lmKCFvKXJldHVybiB0KCk7dmFyIGU9d2luZG93LnNjcm9sbFgsbj13aW5kb3cuc2Nyb2xsWTt0ZS5yZXN0b3JlRm9jdXNUaW1lb3V0PXNldFRpbWVvdXQoZnVuY3Rpb24oKXt0ZS5wcmV2aW91c0FjdGl2ZUVsZW1lbnQmJnRlLnByZXZpb3VzQWN0aXZlRWxlbWVudC5mb2N1cz8odGUucHJldmlvdXNBY3RpdmVFbGVtZW50LmZvY3VzKCksdGUucHJldmlvdXNBY3RpdmVFbGVtZW50PW51bGwpOmRvY3VtZW50LmJvZHkmJmRvY3VtZW50LmJvZHkuZm9jdXMoKSx0KCl9LDEwMCksdm9pZCAwIT09ZSYmdm9pZCAwIT09biYmd2luZG93LnNjcm9sbFRvKGUsbil9KX1mdW5jdGlvbiBYdCgpe2lmKHRlLnRpbWVvdXQpcmV0dXJuIGZ1bmN0aW9uKCl7dmFyIHQ9SCgpLGU9cGFyc2VJbnQod2luZG93LmdldENvbXB1dGVkU3R5bGUodCkud2lkdGgpO3Quc3R5bGUucmVtb3ZlUHJvcGVydHkoInRyYW5zaXRpb24iKSx0LnN0eWxlLndpZHRoPSIxMDAlIjt2YXIgbj1wYXJzZUludCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0KS53aWR0aCksbj1wYXJzZUludChlL24qMTAwKTt0LnN0eWxlLnJlbW92ZVByb3BlcnR5KCJ0cmFuc2l0aW9uIiksdC5zdHlsZS53aWR0aD0iIi5jb25jYXQobiwiJSIpfSgpLHRlLnRpbWVvdXQuc3RvcCgpfWZ1bmN0aW9uIEd0KCl7aWYodGUudGltZW91dCl7dmFyIHQ9dGUudGltZW91dC5zdGFydCgpO3JldHVybiBkdCh0KSx0fX12YXIgdGU9e30sZWU9ITEsbmU9e307ZnVuY3Rpb24gb2UodCl7Zm9yKHZhciBlPXQudGFyZ2V0O2UmJmUhPT1kb2N1bWVudDtlPWUucGFyZW50Tm9kZSlmb3IodmFyIG4gaW4gbmUpe3ZhciBvPWUuZ2V0QXR0cmlidXRlKG4pO2lmKG8pcmV0dXJuIHZvaWQgbmVbbl0uZmlyZSh7dGVtcGxhdGU6b30pfX1mdW5jdGlvbiBpZSh0KXtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNlLHQpfWZ1bmN0aW9uIHJlKHQpe3JldHVybiBjZVt0XX1mdW5jdGlvbiBhZSh0KXtmb3IodmFyIGUgaW4gdClpZShuPWUpfHxXKCdVbmtub3duIHBhcmFtZXRlciAiJy5jb25jYXQobiwnIicpKSx0LnRvYXN0JiYobj1lLC0xIT09bGUuaW5kZXhPZihuKSYmVygnVGhlIHBhcmFtZXRlciAiJy5jb25jYXQobiwnIiBpcyBpbmNvbXBhdGlibGUgd2l0aCB0b2FzdHMnKSkpLHJlKGU9ZSkmJnYoZSxyZShlKSk7dmFyIG59dmFyIHNlPXt0aXRsZToiIix0aXRsZVRleHQ6IiIsdGV4dDoiIixodG1sOiIiLGZvb3RlcjoiIixpY29uOnZvaWQgMCxpY29uQ29sb3I6dm9pZCAwLGljb25IdG1sOnZvaWQgMCx0ZW1wbGF0ZTp2b2lkIDAsdG9hc3Q6ITEsYW5pbWF0aW9uOiEwLHNob3dDbGFzczp7cG9wdXA6InN3YWwyLXNob3ciLGJhY2tkcm9wOiJzd2FsMi1iYWNrZHJvcC1zaG93IixpY29uOiJzd2FsMi1pY29uLXNob3cifSxoaWRlQ2xhc3M6e3BvcHVwOiJzd2FsMi1oaWRlIixiYWNrZHJvcDoic3dhbDItYmFja2Ryb3AtaGlkZSIsaWNvbjoic3dhbDItaWNvbi1oaWRlIn0sY3VzdG9tQ2xhc3M6e30sdGFyZ2V0OiJib2R5IixiYWNrZHJvcDohMCxoZWlnaHRBdXRvOiEwLGFsbG93T3V0c2lkZUNsaWNrOiEwLGFsbG93RXNjYXBlS2V5OiEwLGFsbG93RW50ZXJLZXk6ITAsc3RvcEtleWRvd25Qcm9wYWdhdGlvbjohMCxrZXlkb3duTGlzdGVuZXJDYXB0dXJlOiExLHNob3dDb25maXJtQnV0dG9uOiEwLHNob3dEZW55QnV0dG9uOiExLHNob3dDYW5jZWxCdXR0b246ITEscHJlQ29uZmlybTp2b2lkIDAscHJlRGVueTp2b2lkIDAsY29uZmlybUJ1dHRvblRleHQ6Ik9LIixjb25maXJtQnV0dG9uQXJpYUxhYmVsOiIiLGNvbmZpcm1CdXR0b25Db2xvcjp2b2lkIDAsZGVueUJ1dHRvblRleHQ6Ik5vIixkZW55QnV0dG9uQXJpYUxhYmVsOiIiLGRlbnlCdXR0b25Db2xvcjp2b2lkIDAsY2FuY2VsQnV0dG9uVGV4dDoiQ2FuY2VsIixjYW5jZWxCdXR0b25BcmlhTGFiZWw6IiIsY2FuY2VsQnV0dG9uQ29sb3I6dm9pZCAwLGJ1dHRvbnNTdHlsaW5nOiEwLHJldmVyc2VCdXR0b25zOiExLGZvY3VzQ29uZmlybTohMCxmb2N1c0Rlbnk6ITEsZm9jdXNDYW5jZWw6ITEscmV0dXJuRm9jdXM6ITAsc2hvd0Nsb3NlQnV0dG9uOiExLGNsb3NlQnV0dG9uSHRtbDoiJnRpbWVzOyIsY2xvc2VCdXR0b25BcmlhTGFiZWw6IkNsb3NlIHRoaXMgZGlhbG9nIixsb2FkZXJIdG1sOiIiLHNob3dMb2FkZXJPbkNvbmZpcm06ITEsc2hvd0xvYWRlck9uRGVueTohMSxpbWFnZVVybDp2b2lkIDAsaW1hZ2VXaWR0aDp2b2lkIDAsaW1hZ2VIZWlnaHQ6dm9pZCAwLGltYWdlQWx0OiIiLHRpbWVyOnZvaWQgMCx0aW1lclByb2dyZXNzQmFyOiExLHdpZHRoOnZvaWQgMCxwYWRkaW5nOnZvaWQgMCxiYWNrZ3JvdW5kOnZvaWQgMCxpbnB1dDp2b2lkIDAsaW5wdXRQbGFjZWhvbGRlcjoiIixpbnB1dExhYmVsOiIiLGlucHV0VmFsdWU6IiIsaW5wdXRPcHRpb25zOnt9LGlucHV0QXV0b1RyaW06ITAsaW5wdXRBdHRyaWJ1dGVzOnt9LGlucHV0VmFsaWRhdG9yOnZvaWQgMCxyZXR1cm5JbnB1dFZhbHVlT25EZW55OiExLHZhbGlkYXRpb25NZXNzYWdlOnZvaWQgMCxncm93OiExLHBvc2l0aW9uOiJjZW50ZXIiLHByb2dyZXNzU3RlcHM6W10sY3VycmVudFByb2dyZXNzU3RlcDp2b2lkIDAscHJvZ3Jlc3NTdGVwc0Rpc3RhbmNlOnZvaWQgMCxvbkJlZm9yZU9wZW46dm9pZCAwLG9uT3Blbjp2b2lkIDAsd2lsbE9wZW46dm9pZCAwLGRpZE9wZW46dm9pZCAwLG9uUmVuZGVyOnZvaWQgMCxkaWRSZW5kZXI6dm9pZCAwLG9uQ2xvc2U6dm9pZCAwLG9uQWZ0ZXJDbG9zZTp2b2lkIDAsd2lsbENsb3NlOnZvaWQgMCxkaWRDbG9zZTp2b2lkIDAsb25EZXN0cm95OnZvaWQgMCxkaWREZXN0cm95OnZvaWQgMCxzY3JvbGxiYXJQYWRkaW5nOiEwfSx1ZT1bImFsbG93RXNjYXBlS2V5IiwiYWxsb3dPdXRzaWRlQ2xpY2siLCJiYWNrZ3JvdW5kIiwiYnV0dG9uc1N0eWxpbmciLCJjYW5jZWxCdXR0b25BcmlhTGFiZWwiLCJjYW5jZWxCdXR0b25Db2xvciIsImNhbmNlbEJ1dHRvblRleHQiLCJjbG9zZUJ1dHRvbkFyaWFMYWJlbCIsImNsb3NlQnV0dG9uSHRtbCIsImNvbmZpcm1CdXR0b25BcmlhTGFiZWwiLCJjb25maXJtQnV0dG9uQ29sb3IiLCJjb25maXJtQnV0dG9uVGV4dCIsImN1cnJlbnRQcm9ncmVzc1N0ZXAiLCJjdXN0b21DbGFzcyIsImRlbnlCdXR0b25BcmlhTGFiZWwiLCJkZW55QnV0dG9uQ29sb3IiLCJkZW55QnV0dG9uVGV4dCIsImRpZENsb3NlIiwiZGlkRGVzdHJveSIsImZvb3RlciIsImhpZGVDbGFzcyIsImh0bWwiLCJpY29uIiwiaWNvbkNvbG9yIiwiaWNvbkh0bWwiLCJpbWFnZUFsdCIsImltYWdlSGVpZ2h0IiwiaW1hZ2VVcmwiLCJpbWFnZVdpZHRoIiwib25BZnRlckNsb3NlIiwib25DbG9zZSIsIm9uRGVzdHJveSIsInByb2dyZXNzU3RlcHMiLCJyZXR1cm5Gb2N1cyIsInJldmVyc2VCdXR0b25zIiwic2hvd0NhbmNlbEJ1dHRvbiIsInNob3dDbG9zZUJ1dHRvbiIsInNob3dDb25maXJtQnV0dG9uIiwic2hvd0RlbnlCdXR0b24iLCJ0ZXh0IiwidGl0bGUiLCJ0aXRsZVRleHQiLCJ3aWxsQ2xvc2UiXSxjZT17YW5pbWF0aW9uOidzaG93Q2xhc3MiIGFuZCAiaGlkZUNsYXNzJyxvbkJlZm9yZU9wZW46IndpbGxPcGVuIixvbk9wZW46ImRpZE9wZW4iLG9uUmVuZGVyOiJkaWRSZW5kZXIiLG9uQ2xvc2U6IndpbGxDbG9zZSIsb25BZnRlckNsb3NlOiJkaWRDbG9zZSIsb25EZXN0cm95OiJkaWREZXN0cm95In0sbGU9WyJhbGxvd091dHNpZGVDbGljayIsImFsbG93RW50ZXJLZXkiLCJiYWNrZHJvcCIsImZvY3VzQ29uZmlybSIsImZvY3VzRGVueSIsImZvY3VzQ2FuY2VsIiwicmV0dXJuRm9jdXMiLCJoZWlnaHRBdXRvIiwia2V5ZG93bkxpc3RlbmVyQ2FwdHVyZSJdLGRlPU9iamVjdC5mcmVlemUoe2lzVmFsaWRQYXJhbWV0ZXI6aWUsaXNVcGRhdGFibGVQYXJhbWV0ZXI6ZnVuY3Rpb24odCl7cmV0dXJuLTEhPT11ZS5pbmRleE9mKHQpfSxpc0RlcHJlY2F0ZWRQYXJhbWV0ZXI6cmUsYXJnc1RvUGFyYW1zOmZ1bmN0aW9uKG4pe3ZhciBvPXt9O3JldHVybiJvYmplY3QiIT09cihuWzBdKXx8QyhuWzBdKT9bInRpdGxlIiwiaHRtbCIsImljb24iXS5mb3JFYWNoKGZ1bmN0aW9uKHQsZSl7ZT1uW2VdOyJzdHJpbmciPT10eXBlb2YgZXx8QyhlKT9vW3RdPWU6dm9pZCAwIT09ZSYmSygiVW5leHBlY3RlZCB0eXBlIG9mICIuY29uY2F0KHQsJyEgRXhwZWN0ZWQgInN0cmluZyIgb3IgIkVsZW1lbnQiLCBnb3QgJykuY29uY2F0KHIoZSkpKX0pOnUobyxuWzBdKSxvfSxpc1Zpc2libGU6ZnVuY3Rpb24oKXtyZXR1cm4gd3QoQSgpKX0sY2xpY2tDb25maXJtOkZ0LGNsaWNrRGVueTpmdW5jdGlvbigpe3JldHVybiBMKCkmJkwoKS5jbGljaygpfSxjbGlja0NhbmNlbDpmdW5jdGlvbigpe3JldHVybiBxKCkmJnEoKS5jbGljaygpfSxnZXRDb250YWluZXI6ayxnZXRQb3B1cDpBLGdldFRpdGxlOkIsZ2V0Q29udGVudDpQLGdldEh0bWxDb250YWluZXI6TyxnZXRJbWFnZTpFLGdldEljb246eCxnZXRJbnB1dExhYmVsOmZ1bmN0aW9uKCl7cmV0dXJuIHQoJFsiaW5wdXQtbGFiZWwiXSl9LGdldENsb3NlQnV0dG9uOlYsZ2V0QWN0aW9uczpqLGdldENvbmZpcm1CdXR0b246VCxnZXREZW55QnV0dG9uOkwsZ2V0Q2FuY2VsQnV0dG9uOnEsZ2V0TG9hZGVyOkQsZ2V0SGVhZGVyOk0sZ2V0Rm9vdGVyOkksZ2V0VGltZXJQcm9ncmVzc0JhcjpILGdldEZvY3VzYWJsZUVsZW1lbnRzOlIsZ2V0VmFsaWRhdGlvbk1lc3NhZ2U6Uyxpc0xvYWRpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gQSgpLmhhc0F0dHJpYnV0ZSgiZGF0YS1sb2FkaW5nIil9LGZpcmU6ZnVuY3Rpb24oKXtmb3IodmFyIHQ9YXJndW1lbnRzLmxlbmd0aCxlPW5ldyBBcnJheSh0KSxuPTA7bjx0O24rKyllW25dPWFyZ3VtZW50c1tuXTtyZXR1cm4gaSh0aGlzLGUpfSxtaXhpbjpmdW5jdGlvbihyKXtyZXR1cm4gZnVuY3Rpb24odCl7IWZ1bmN0aW9uKHQsZSl7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIGUmJm51bGwhPT1lKXRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7dC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShlJiZlLnByb3RvdHlwZSx7Y29uc3RydWN0b3I6e3ZhbHVlOnQsd3JpdGFibGU6ITAsY29uZmlndXJhYmxlOiEwfX0pLGUmJmwodCxlKX0oaSx0KTt2YXIgbixvLGU9KG49aSxvPWQoKSxmdW5jdGlvbigpe3ZhciB0LGU9YyhuKTtyZXR1cm4gcCh0aGlzLG8/KHQ9Yyh0aGlzKS5jb25zdHJ1Y3RvcixSZWZsZWN0LmNvbnN0cnVjdChlLGFyZ3VtZW50cyx0KSk6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cykpfSk7ZnVuY3Rpb24gaSgpe3JldHVybiBhKHRoaXMsaSksZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIHMoaSxbe2tleToiX21haW4iLHZhbHVlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIGYoYyhpLnByb3RvdHlwZSksIl9tYWluIix0aGlzKS5jYWxsKHRoaXMsdCx1KHt9LHIsZSkpfX1dKSxpfSh0aGlzKX0scXVldWU6ZnVuY3Rpb24odCl7dmFyIHI9dGhpcztadD10O2Z1bmN0aW9uIGEodCxlKXtadD1bXSx0KGUpfXZhciBzPVtdO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihpKXshZnVuY3Rpb24gZShuLG8pe248WnQubGVuZ3RoPyhkb2N1bWVudC5ib2R5LnNldEF0dHJpYnV0ZSgiZGF0YS1zd2FsMi1xdWV1ZS1zdGVwIixuKSxyLmZpcmUoWnRbbl0pLnRoZW4oZnVuY3Rpb24odCl7dm9pZCAwIT09dC52YWx1ZT8ocy5wdXNoKHQudmFsdWUpLGUobisxLG8pKTphKGkse2Rpc21pc3M6dC5kaXNtaXNzfSl9KSk6YShpLHt2YWx1ZTpzfSl9KDApfSl9LGdldFF1ZXVlU3RlcDpWdCxpbnNlcnRRdWV1ZVN0ZXA6ZnVuY3Rpb24odCxlKXtyZXR1cm4gZSYmZTxadC5sZW5ndGg/WnQuc3BsaWNlKGUsMCx0KTpadC5wdXNoKHQpfSxkZWxldGVRdWV1ZVN0ZXA6ZnVuY3Rpb24odCl7dm9pZCAwIT09WnRbdF0mJlp0LnNwbGljZSh0LDEpfSxzaG93TG9hZGluZzpKdCxlbmFibGVMb2FkaW5nOkp0LGdldFRpbWVyTGVmdDpmdW5jdGlvbigpe3JldHVybiB0ZS50aW1lb3V0JiZ0ZS50aW1lb3V0LmdldFRpbWVyTGVmdCgpfSxzdG9wVGltZXI6WHQscmVzdW1lVGltZXI6R3QsdG9nZ2xlVGltZXI6ZnVuY3Rpb24oKXt2YXIgdD10ZS50aW1lb3V0O3JldHVybiB0JiYodC5ydW5uaW5nP1h0Okd0KSgpfSxpbmNyZWFzZVRpbWVyOmZ1bmN0aW9uKHQpe2lmKHRlLnRpbWVvdXQpe3Q9dGUudGltZW91dC5pbmNyZWFzZSh0KTtyZXR1cm4gZHQodCwhMCksdH19LGlzVGltZXJSdW5uaW5nOmZ1bmN0aW9uKCl7cmV0dXJuIHRlLnRpbWVvdXQmJnRlLnRpbWVvdXQuaXNSdW5uaW5nKCl9LGJpbmRDbGlja0hhbmRsZXI6ZnVuY3Rpb24oKXtuZVswPGFyZ3VtZW50cy5sZW5ndGgmJnZvaWQgMCE9PWFyZ3VtZW50c1swXT9hcmd1bWVudHNbMF06ImRhdGEtc3dhbC10ZW1wbGF0ZSJdPXRoaXMsZWV8fChkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIixvZSksZWU9ITApfX0pO2Z1bmN0aW9uIHBlKCl7dmFyIHQsZTtUdC5pbm5lclBhcmFtcy5nZXQodGhpcykmJih0PVR0LmRvbUNhY2hlLmdldCh0aGlzKSxhdCh0LmxvYWRlciksKGU9dC5wb3B1cC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKHQubG9hZGVyLmdldEF0dHJpYnV0ZSgiZGF0YS1idXR0b24tdG8tcmVwbGFjZSIpKSkubGVuZ3RoP3J0KGVbMF0sImlubGluZS1ibG9jayIpOnd0KFQoKSl8fHd0KEwoKSl8fHd0KHEoKSl8fGF0KHQuYWN0aW9ucyksYnQoW3QucG9wdXAsdC5hY3Rpb25zXSwkLmxvYWRpbmcpLHQucG9wdXAucmVtb3ZlQXR0cmlidXRlKCJhcmlhLWJ1c3kiKSx0LnBvcHVwLnJlbW92ZUF0dHJpYnV0ZSgiZGF0YS1sb2FkaW5nIiksdC5jb25maXJtQnV0dG9uLmRpc2FibGVkPSExLHQuZGVueUJ1dHRvbi5kaXNhYmxlZD0hMSx0LmNhbmNlbEJ1dHRvbi5kaXNhYmxlZD0hMSl9ZnVuY3Rpb24gZmUoKXtudWxsPT09dHQucHJldmlvdXNCb2R5UGFkZGluZyYmZG9jdW1lbnQuYm9keS5zY3JvbGxIZWlnaHQ+d2luZG93LmlubmVySGVpZ2h0JiYodHQucHJldmlvdXNCb2R5UGFkZGluZz1wYXJzZUludCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKCJwYWRkaW5nLXJpZ2h0IikpLGRvY3VtZW50LmJvZHkuc3R5bGUucGFkZGluZ1JpZ2h0PSIiLmNvbmNhdCh0dC5wcmV2aW91c0JvZHlQYWRkaW5nK2Z1bmN0aW9uKCl7dmFyIHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7dC5jbGFzc05hbWU9JFsic2Nyb2xsYmFyLW1lYXN1cmUiXSxkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHQpO3ZhciBlPXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGgtdC5jbGllbnRXaWR0aDtyZXR1cm4gZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0KSxlfSgpLCJweCIpKX1mdW5jdGlvbiBtZSgpe3JldHVybiEhd2luZG93Lk1TSW5wdXRNZXRob2RDb250ZXh0JiYhIWRvY3VtZW50LmRvY3VtZW50TW9kZX1mdW5jdGlvbiBoZSgpe3ZhciB0PWsoKSxlPUEoKTt0LnN0eWxlLnJlbW92ZVByb3BlcnR5KCJhbGlnbi1pdGVtcyIpLGUub2Zmc2V0VG9wPDAmJih0LnN0eWxlLmFsaWduSXRlbXM9ImZsZXgtc3RhcnQiKX12YXIgZ2U9ZnVuY3Rpb24oKXtuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC8oQ3JpT1N8RnhpT1N8RWRnaU9TfFlhQnJvd3NlcnxVQ0Jyb3dzZXIpL2kpfHxBKCkuc2Nyb2xsSGVpZ2h0PndpbmRvdy5pbm5lckhlaWdodC00NCYmKGsoKS5zdHlsZS5wYWRkaW5nQm90dG9tPSIiLmNvbmNhdCg0NCwicHgiKSl9LHZlPWZ1bmN0aW9uKCl7dmFyIGUsdD1rKCk7dC5vbnRvdWNoc3RhcnQ9ZnVuY3Rpb24odCl7ZT1iZSh0KX0sdC5vbnRvdWNobW92ZT1mdW5jdGlvbih0KXtlJiYodC5wcmV2ZW50RGVmYXVsdCgpLHQuc3RvcFByb3BhZ2F0aW9uKCkpfX0sYmU9ZnVuY3Rpb24odCl7dmFyIGU9dC50YXJnZXQsbj1rKCk7cmV0dXJuIXllKHQpJiYhd2UodCkmJihlPT09bnx8IShjdChuKXx8IklOUFVUIj09PWUudGFnTmFtZXx8Y3QoUCgpKSYmUCgpLmNvbnRhaW5zKGUpKSl9LHllPWZ1bmN0aW9uKHQpe3JldHVybiB0LnRvdWNoZXMmJnQudG91Y2hlcy5sZW5ndGgmJiJzdHlsdXMiPT09dC50b3VjaGVzWzBdLnRvdWNoVHlwZX0sd2U9ZnVuY3Rpb24odCl7cmV0dXJuIHQudG91Y2hlcyYmMTx0LnRvdWNoZXMubGVuZ3RofSxDZT17c3dhbFByb21pc2VSZXNvbHZlOm5ldyBXZWFrTWFwfTtmdW5jdGlvbiBrZSh0LGUsbixvKXtHKCk/RWUodCxvKTooJHQobikudGhlbihmdW5jdGlvbigpe3JldHVybiBFZSh0LG8pfSksdGUua2V5ZG93blRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKCJrZXlkb3duIix0ZS5rZXlkb3duSGFuZGxlcix7Y2FwdHVyZTp0ZS5rZXlkb3duTGlzdGVuZXJDYXB0dXJlfSksdGUua2V5ZG93bkhhbmRsZXJBZGRlZD0hMSksZS5wYXJlbnROb2RlJiYhZG9jdW1lbnQuYm9keS5nZXRBdHRyaWJ1dGUoImRhdGEtc3dhbDItcXVldWUtc3RlcCIpJiZlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZSksTigpJiYobnVsbCE9PXR0LnByZXZpb3VzQm9keVBhZGRpbmcmJihkb2N1bWVudC5ib2R5LnN0eWxlLnBhZGRpbmdSaWdodD0iIi5jb25jYXQodHQucHJldmlvdXNCb2R5UGFkZGluZywicHgiKSx0dC5wcmV2aW91c0JvZHlQYWRkaW5nPW51bGwpLEYoZG9jdW1lbnQuYm9keSwkLmlvc2ZpeCkmJihlPXBhcnNlSW50KGRvY3VtZW50LmJvZHkuc3R5bGUudG9wLDEwKSxidChkb2N1bWVudC5ib2R5LCQuaW9zZml4KSxkb2N1bWVudC5ib2R5LnN0eWxlLnRvcD0iIixkb2N1bWVudC5ib2R5LnNjcm9sbFRvcD0tMSplKSwidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdyYmbWUoKSYmd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsaGUpLGcoZG9jdW1lbnQuYm9keS5jaGlsZHJlbikuZm9yRWFjaChmdW5jdGlvbih0KXt0Lmhhc0F0dHJpYnV0ZSgiZGF0YS1wcmV2aW91cy1hcmlhLWhpZGRlbiIpPyh0LnNldEF0dHJpYnV0ZSgiYXJpYS1oaWRkZW4iLHQuZ2V0QXR0cmlidXRlKCJkYXRhLXByZXZpb3VzLWFyaWEtaGlkZGVuIikpLHQucmVtb3ZlQXR0cmlidXRlKCJkYXRhLXByZXZpb3VzLWFyaWEtaGlkZGVuIikpOnQucmVtb3ZlQXR0cmlidXRlKCJhcmlhLWhpZGRlbiIpfSkpLGJ0KFtkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsZG9jdW1lbnQuYm9keV0sWyQuc2hvd24sJFsiaGVpZ2h0LWF1dG8iXSwkWyJuby1iYWNrZHJvcCJdLCRbInRvYXN0LXNob3duIl1dKX1mdW5jdGlvbiBBZSh0KXt2YXIgZSxuLG8saT1BKCk7aSYmKHQ9eGUodCksKGU9VHQuaW5uZXJQYXJhbXMuZ2V0KHRoaXMpKSYmIUYoaSxlLmhpZGVDbGFzcy5wb3B1cCkmJihuPUNlLnN3YWxQcm9taXNlUmVzb2x2ZS5nZXQodGhpcyksYnQoaSxlLnNob3dDbGFzcy5wb3B1cCksdnQoaSxlLmhpZGVDbGFzcy5wb3B1cCksbz1rKCksYnQobyxlLnNob3dDbGFzcy5iYWNrZHJvcCksdnQobyxlLmhpZGVDbGFzcy5iYWNrZHJvcCksQmUodGhpcyxpLGUpLG4odCkpKX1mdW5jdGlvbiB4ZSh0KXtyZXR1cm4gdm9pZCAwPT09dD97aXNDb25maXJtZWQ6ITEsaXNEZW5pZWQ6ITEsaXNEaXNtaXNzZWQ6ITB9OnUoe2lzQ29uZmlybWVkOiExLGlzRGVuaWVkOiExLGlzRGlzbWlzc2VkOiExfSx0KX1mdW5jdGlvbiBCZSh0LGUsbil7dmFyIG89aygpLGk9QnQmJmx0KGUpLHI9bi5vbkNsb3NlLGE9bi5vbkFmdGVyQ2xvc2Uscz1uLndpbGxDbG9zZSx1PW4uZGlkQ2xvc2U7UGUoZSxzLHIpLGk/T2UodCxlLG8sbi5yZXR1cm5Gb2N1cyx1fHxhKTprZSh0LG8sbi5yZXR1cm5Gb2N1cyx1fHxhKX12YXIgUGU9ZnVuY3Rpb24odCxlLG4pe251bGwhPT1lJiYiZnVuY3Rpb24iPT10eXBlb2YgZT9lKHQpOm51bGwhPT1uJiYiZnVuY3Rpb24iPT10eXBlb2YgbiYmbih0KX0sT2U9ZnVuY3Rpb24odCxlLG4sbyxpKXt0ZS5zd2FsQ2xvc2VFdmVudEZpbmlzaGVkQ2FsbGJhY2s9a2UuYmluZChudWxsLHQsbixvLGkpLGUuYWRkRXZlbnRMaXN0ZW5lcihCdCxmdW5jdGlvbih0KXt0LnRhcmdldD09PWUmJih0ZS5zd2FsQ2xvc2VFdmVudEZpbmlzaGVkQ2FsbGJhY2soKSxkZWxldGUgdGUuc3dhbENsb3NlRXZlbnRGaW5pc2hlZENhbGxiYWNrKX0pfSxFZT1mdW5jdGlvbih0LGUpe3NldFRpbWVvdXQoZnVuY3Rpb24oKXsiZnVuY3Rpb24iPT10eXBlb2YgZSYmZSgpLHQuX2Rlc3Ryb3koKX0pfTtmdW5jdGlvbiBTZSh0LGUsbil7dmFyIG89VHQuZG9tQ2FjaGUuZ2V0KHQpO2UuZm9yRWFjaChmdW5jdGlvbih0KXtvW3RdLmRpc2FibGVkPW59KX1mdW5jdGlvbiBUZSh0LGUpe2lmKCF0KXJldHVybiExO2lmKCJyYWRpbyI9PT10LnR5cGUpZm9yKHZhciBuPXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3JBbGwoImlucHV0Iiksbz0wO288bi5sZW5ndGg7bysrKW5bb10uZGlzYWJsZWQ9ZTtlbHNlIHQuZGlzYWJsZWQ9ZX12YXIgTGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBuKHQsZSl7YSh0aGlzLG4pLHRoaXMuY2FsbGJhY2s9dCx0aGlzLnJlbWFpbmluZz1lLHRoaXMucnVubmluZz0hMSx0aGlzLnN0YXJ0KCl9cmV0dXJuIHMobixbe2tleToic3RhcnQiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucnVubmluZ3x8KHRoaXMucnVubmluZz0hMCx0aGlzLnN0YXJ0ZWQ9bmV3IERhdGUsdGhpcy5pZD1zZXRUaW1lb3V0KHRoaXMuY2FsbGJhY2ssdGhpcy5yZW1haW5pbmcpKSx0aGlzLnJlbWFpbmluZ319LHtrZXk6InN0b3AiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucnVubmluZyYmKHRoaXMucnVubmluZz0hMSxjbGVhclRpbWVvdXQodGhpcy5pZCksdGhpcy5yZW1haW5pbmctPW5ldyBEYXRlLXRoaXMuc3RhcnRlZCksdGhpcy5yZW1haW5pbmd9fSx7a2V5OiJpbmNyZWFzZSIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5ydW5uaW5nO3JldHVybiBlJiZ0aGlzLnN0b3AoKSx0aGlzLnJlbWFpbmluZys9dCxlJiZ0aGlzLnN0YXJ0KCksdGhpcy5yZW1haW5pbmd9fSx7a2V5OiJnZXRUaW1lckxlZnQiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucnVubmluZyYmKHRoaXMuc3RvcCgpLHRoaXMuc3RhcnQoKSksdGhpcy5yZW1haW5pbmd9fSx7a2V5OiJpc1J1bm5pbmciLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucnVubmluZ319XSksbn0oKSxEZT17ZW1haWw6ZnVuY3Rpb24odCxlKXtyZXR1cm4vXlthLXpBLVowLTkuK18tXStAW2EtekEtWjAtOS4tXStcLlthLXpBLVowLTktXXsyLDI0fSQvLnRlc3QodCk/UHJvbWlzZS5yZXNvbHZlKCk6UHJvbWlzZS5yZXNvbHZlKGV8fCJJbnZhbGlkIGVtYWlsIGFkZHJlc3MiKX0sdXJsOmZ1bmN0aW9uKHQsZSl7cmV0dXJuL15odHRwcz86XC9cLyh3d3dcLik/Wy1hLXpBLVowLTlAOiUuXyt+Iz1dezEsMjU2fVwuW2Etel17Miw2M31cYihbLWEtekEtWjAtOUA6JV8rLn4jPyYvPV0qKSQvLnRlc3QodCk/UHJvbWlzZS5yZXNvbHZlKCk6UHJvbWlzZS5yZXNvbHZlKGV8fCJJbnZhbGlkIFVSTCIpfX07ZnVuY3Rpb24gcWUodCl7dmFyIGUsbjsoZT10KS5pbnB1dFZhbGlkYXRvcnx8T2JqZWN0LmtleXMoRGUpLmZvckVhY2goZnVuY3Rpb24odCl7ZS5pbnB1dD09PXQmJihlLmlucHV0VmFsaWRhdG9yPURlW3RdKX0pLHQuc2hvd0xvYWRlck9uQ29uZmlybSYmIXQucHJlQ29uZmlybSYmVygic2hvd0xvYWRlck9uQ29uZmlybSBpcyBzZXQgdG8gdHJ1ZSwgYnV0IHByZUNvbmZpcm0gaXMgbm90IGRlZmluZWQuXG5zaG93TG9hZGVyT25Db25maXJtIHNob3VsZCBiZSB1c2VkIHRvZ2V0aGVyIHdpdGggcHJlQ29uZmlybSwgc2VlIHVzYWdlIGV4YW1wbGU6XG5odHRwczovL3N3ZWV0YWxlcnQyLmdpdGh1Yi5pby8jYWpheC1yZXF1ZXN0IiksdC5hbmltYXRpb249Wih0LmFuaW1hdGlvbiksKG49dCkudGFyZ2V0JiYoInN0cmluZyIhPXR5cGVvZiBuLnRhcmdldHx8ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuLnRhcmdldCkpJiYoInN0cmluZyI9PXR5cGVvZiBuLnRhcmdldHx8bi50YXJnZXQuYXBwZW5kQ2hpbGQpfHwoVygnVGFyZ2V0IHBhcmFtZXRlciBpcyBub3QgdmFsaWQsIGRlZmF1bHRpbmcgdG8gImJvZHkiJyksbi50YXJnZXQ9ImJvZHkiKSwic3RyaW5nIj09dHlwZW9mIHQudGl0bGUmJih0LnRpdGxlPXQudGl0bGUuc3BsaXQoIlxuIikuam9pbigiPGJyIC8+IikpLGt0KHQpfWZ1bmN0aW9uIGplKHQpe3ZhciBlPWsoKSxuPUEoKTsiZnVuY3Rpb24iPT10eXBlb2YgdC53aWxsT3Blbj90LndpbGxPcGVuKG4pOiJmdW5jdGlvbiI9PXR5cGVvZiB0Lm9uQmVmb3JlT3BlbiYmdC5vbkJlZm9yZU9wZW4obik7dmFyIG89d2luZG93LmdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkub3ZlcmZsb3dZO0plKGUsbix0KSxzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7WmUoZSxuKX0sMTApLE4oKSYmKFFlKGUsdC5zY3JvbGxiYXJQYWRkaW5nLG8pLGcoZG9jdW1lbnQuYm9keS5jaGlsZHJlbikuZm9yRWFjaChmdW5jdGlvbih0KXt0PT09aygpfHxmdW5jdGlvbih0LGUpe2lmKCJmdW5jdGlvbiI9PXR5cGVvZiB0LmNvbnRhaW5zKXJldHVybiB0LmNvbnRhaW5zKGUpfSh0LGsoKSl8fCh0Lmhhc0F0dHJpYnV0ZSgiYXJpYS1oaWRkZW4iKSYmdC5zZXRBdHRyaWJ1dGUoImRhdGEtcHJldmlvdXMtYXJpYS1oaWRkZW4iLHQuZ2V0QXR0cmlidXRlKCJhcmlhLWhpZGRlbiIpKSx0LnNldEF0dHJpYnV0ZSgiYXJpYS1oaWRkZW4iLCJ0cnVlIikpfSkpLEcoKXx8dGUucHJldmlvdXNBY3RpdmVFbGVtZW50fHwodGUucHJldmlvdXNBY3RpdmVFbGVtZW50PWRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpLFllKG4sdCksYnQoZSwkWyJuby10cmFuc2l0aW9uIl0pfWZ1bmN0aW9uIE1lKHQpe3ZhciBlPUEoKTt0LnRhcmdldD09PWUmJih0PWsoKSxlLnJlbW92ZUV2ZW50TGlzdGVuZXIoQnQsTWUpLHQuc3R5bGUub3ZlcmZsb3dZPSJhdXRvIil9ZnVuY3Rpb24gSWUodCxlKXt0LmNsb3NlUG9wdXAoe2lzQ29uZmlybWVkOiEwLHZhbHVlOmV9KX1mdW5jdGlvbiBIZSh0LGUsbil7dmFyIG89UigpO2lmKG8ubGVuZ3RoKXJldHVybihlKz1uKT09PW8ubGVuZ3RoP2U9MDotMT09PWUmJihlPW8ubGVuZ3RoLTEpLG9bZV0uZm9jdXMoKTtBKCkuZm9jdXMoKX12YXIgVmU9WyJzd2FsLXRpdGxlIiwic3dhbC1odG1sIiwic3dhbC1mb290ZXIiXSxSZT1mdW5jdGlvbih0KXt2YXIgbj17fTtyZXR1cm4gZyh0LnF1ZXJ5U2VsZWN0b3JBbGwoInN3YWwtcGFyYW0iKSkuZm9yRWFjaChmdW5jdGlvbih0KXtLZSh0LFsibmFtZSIsInZhbHVlIl0pO3ZhciBlPXQuZ2V0QXR0cmlidXRlKCJuYW1lIiksdD10LmdldEF0dHJpYnV0ZSgidmFsdWUiKTsiYm9vbGVhbiI9PXR5cGVvZiBzZVtlXSYmImZhbHNlIj09PXQmJih0PSExKSwib2JqZWN0Ij09PXIoc2VbZV0pJiYodD1KU09OLnBhcnNlKHQpKSxuW2VdPXR9KSxufSxOZT1mdW5jdGlvbih0KXt2YXIgbj17fTtyZXR1cm4gZyh0LnF1ZXJ5U2VsZWN0b3JBbGwoInN3YWwtYnV0dG9uIikpLmZvckVhY2goZnVuY3Rpb24odCl7S2UodCxbInR5cGUiLCJjb2xvciIsImFyaWEtbGFiZWwiXSk7dmFyIGU9dC5nZXRBdHRyaWJ1dGUoInR5cGUiKTtuWyIiLmNvbmNhdChlLCJCdXR0b25UZXh0IildPXQuaW5uZXJIVE1MLG5bInNob3ciLmNvbmNhdChtKGUpLCJCdXR0b24iKV09ITAsdC5oYXNBdHRyaWJ1dGUoImNvbG9yIikmJihuWyIiLmNvbmNhdChlLCJCdXR0b25Db2xvciIpXT10LmdldEF0dHJpYnV0ZSgiY29sb3IiKSksdC5oYXNBdHRyaWJ1dGUoImFyaWEtbGFiZWwiKSYmKG5bIiIuY29uY2F0KGUsIkJ1dHRvbkFyaWFMYWJlbCIpXT10LmdldEF0dHJpYnV0ZSgiYXJpYS1sYWJlbCIpKX0pLG59LFVlPWZ1bmN0aW9uKHQpe3ZhciBlPXt9LHQ9dC5xdWVyeVNlbGVjdG9yKCJzd2FsLWltYWdlIik7cmV0dXJuIHQmJihLZSh0LFsic3JjIiwid2lkdGgiLCJoZWlnaHQiLCJhbHQiXSksdC5oYXNBdHRyaWJ1dGUoInNyYyIpJiYoZS5pbWFnZVVybD10LmdldEF0dHJpYnV0ZSgic3JjIikpLHQuaGFzQXR0cmlidXRlKCJ3aWR0aCIpJiYoZS5pbWFnZVdpZHRoPXQuZ2V0QXR0cmlidXRlKCJ3aWR0aCIpKSx0Lmhhc0F0dHJpYnV0ZSgiaGVpZ2h0IikmJihlLmltYWdlSGVpZ2h0PXQuZ2V0QXR0cmlidXRlKCJoZWlnaHQiKSksdC5oYXNBdHRyaWJ1dGUoImFsdCIpJiYoZS5pbWFnZUFsdD10LmdldEF0dHJpYnV0ZSgiYWx0IikpKSxlfSxGZT1mdW5jdGlvbih0KXt2YXIgZT17fSx0PXQucXVlcnlTZWxlY3Rvcigic3dhbC1pY29uIik7cmV0dXJuIHQmJihLZSh0LFsidHlwZSIsImNvbG9yIl0pLHQuaGFzQXR0cmlidXRlKCJ0eXBlIikmJihlLmljb249dC5nZXRBdHRyaWJ1dGUoInR5cGUiKSksdC5oYXNBdHRyaWJ1dGUoImNvbG9yIikmJihlLmljb25Db2xvcj10LmdldEF0dHJpYnV0ZSgiY29sb3IiKSksZS5pY29uSHRtbD10LmlubmVySFRNTCksZX0sX2U9ZnVuY3Rpb24odCl7dmFyIG49e30sZT10LnF1ZXJ5U2VsZWN0b3IoInN3YWwtaW5wdXQiKTtlJiYoS2UoZSxbInR5cGUiLCJsYWJlbCIsInBsYWNlaG9sZGVyIiwidmFsdWUiXSksbi5pbnB1dD1lLmdldEF0dHJpYnV0ZSgidHlwZSIpfHwidGV4dCIsZS5oYXNBdHRyaWJ1dGUoImxhYmVsIikmJihuLmlucHV0TGFiZWw9ZS5nZXRBdHRyaWJ1dGUoImxhYmVsIikpLGUuaGFzQXR0cmlidXRlKCJwbGFjZWhvbGRlciIpJiYobi5pbnB1dFBsYWNlaG9sZGVyPWUuZ2V0QXR0cmlidXRlKCJwbGFjZWhvbGRlciIpKSxlLmhhc0F0dHJpYnV0ZSgidmFsdWUiKSYmKG4uaW5wdXRWYWx1ZT1lLmdldEF0dHJpYnV0ZSgidmFsdWUiKSkpO3Q9dC5xdWVyeVNlbGVjdG9yQWxsKCJzd2FsLWlucHV0LW9wdGlvbiIpO3JldHVybiB0Lmxlbmd0aCYmKG4uaW5wdXRPcHRpb25zPXt9LGcodCkuZm9yRWFjaChmdW5jdGlvbih0KXtLZSh0LFsidmFsdWUiXSk7dmFyIGU9dC5nZXRBdHRyaWJ1dGUoInZhbHVlIiksdD10LmlubmVySFRNTDtuLmlucHV0T3B0aW9uc1tlXT10fSkpLG59LHplPWZ1bmN0aW9uKHQsZSl7dmFyIG4sbz17fTtmb3IobiBpbiBlKXt2YXIgaT1lW25dLHI9dC5xdWVyeVNlbGVjdG9yKGkpO3ImJihLZShyLFtdKSxvW2kucmVwbGFjZSgvXnN3YWwtLywiIildPXIuaW5uZXJIVE1MLnRyaW0oKSl9cmV0dXJuIG99LFdlPWZ1bmN0aW9uKGUpe3ZhciBuPVZlLmNvbmNhdChbInN3YWwtcGFyYW0iLCJzd2FsLWJ1dHRvbiIsInN3YWwtaW1hZ2UiLCJzd2FsLWljb24iLCJzd2FsLWlucHV0Iiwic3dhbC1pbnB1dC1vcHRpb24iXSk7ZyhlLnF1ZXJ5U2VsZWN0b3JBbGwoIioiKSkuZm9yRWFjaChmdW5jdGlvbih0KXt0LnBhcmVudE5vZGU9PT1lJiYodD10LnRhZ05hbWUudG9Mb3dlckNhc2UoKSwtMT09PW4uaW5kZXhPZih0KSYmVygiVW5yZWNvZ25pemVkIGVsZW1lbnQgPCIuY29uY2F0KHQsIj4iKSkpfSl9LEtlPWZ1bmN0aW9uKGUsbil7ZyhlLmF0dHJpYnV0ZXMpLmZvckVhY2goZnVuY3Rpb24odCl7LTE9PT1uLmluZGV4T2YodC5uYW1lKSYmVyhbJ1VucmVjb2duaXplZCBhdHRyaWJ1dGUgIicuY29uY2F0KHQubmFtZSwnIiBvbiA8JykuY29uY2F0KGUudGFnTmFtZS50b0xvd2VyQ2FzZSgpLCI+LiIpLCIiLmNvbmNhdChuLmxlbmd0aD8iQWxsb3dlZCBhdHRyaWJ1dGVzIGFyZTogIi5jb25jYXQobi5qb2luKCIsICIpKToiVG8gc2V0IHRoZSB2YWx1ZSwgdXNlIEhUTUwgd2l0aGluIHRoZSBlbGVtZW50LiIpXSl9KX0sWWU9ZnVuY3Rpb24odCxlKXsiZnVuY3Rpb24iPT10eXBlb2YgZS5kaWRPcGVuP3NldFRpbWVvdXQoZnVuY3Rpb24oKXtyZXR1cm4gZS5kaWRPcGVuKHQpfSk6ImZ1bmN0aW9uIj09dHlwZW9mIGUub25PcGVuJiZzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7cmV0dXJuIGUub25PcGVuKHQpfSl9LFplPWZ1bmN0aW9uKHQsZSl7QnQmJmx0KGUpPyh0LnN0eWxlLm92ZXJmbG93WT0iaGlkZGVuIixlLmFkZEV2ZW50TGlzdGVuZXIoQnQsTWUpKTp0LnN0eWxlLm92ZXJmbG93WT0iYXV0byJ9LFFlPWZ1bmN0aW9uKHQsZSxuKXt2YXIgbzsoL2lQYWR8aVBob25lfGlQb2QvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkmJiF3aW5kb3cuTVNTdHJlYW18fCJNYWNJbnRlbCI9PT1uYXZpZ2F0b3IucGxhdGZvcm0mJjE8bmF2aWdhdG9yLm1heFRvdWNoUG9pbnRzKSYmIUYoZG9jdW1lbnQuYm9keSwkLmlvc2ZpeCkmJihvPWRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wLGRvY3VtZW50LmJvZHkuc3R5bGUudG9wPSIiLmNvbmNhdCgtMSpvLCJweCIpLHZ0KGRvY3VtZW50LmJvZHksJC5pb3NmaXgpLHZlKCksZ2UoKSksInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3cmJm1lKCkmJihoZSgpLHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJyZXNpemUiLGhlKSksZSYmImhpZGRlbiIhPT1uJiZmZSgpLHNldFRpbWVvdXQoZnVuY3Rpb24oKXt0LnNjcm9sbFRvcD0wfSl9LEplPWZ1bmN0aW9uKHQsZSxuKXt2dCh0LG4uc2hvd0NsYXNzLmJhY2tkcm9wKSxlLnN0eWxlLnNldFByb3BlcnR5KCJvcGFjaXR5IiwiMCIsImltcG9ydGFudCIpLHJ0KGUpLHNldFRpbWVvdXQoZnVuY3Rpb24oKXt2dChlLG4uc2hvd0NsYXNzLnBvcHVwKSxlLnN0eWxlLnJlbW92ZVByb3BlcnR5KCJvcGFjaXR5Iil9LDEwKSx2dChbZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LGRvY3VtZW50LmJvZHldLCQuc2hvd24pLG4uaGVpZ2h0QXV0byYmbi5iYWNrZHJvcCYmIW4udG9hc3QmJnZ0KFtkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsZG9jdW1lbnQuYm9keV0sJFsiaGVpZ2h0LWF1dG8iXSl9LCRlPWZ1bmN0aW9uKHQpe3JldHVybiB0LmNoZWNrZWQ/MTowfSxYZT1mdW5jdGlvbih0KXtyZXR1cm4gdC5jaGVja2VkP3QudmFsdWU6bnVsbH0sR2U9ZnVuY3Rpb24odCl7cmV0dXJuIHQuZmlsZXMubGVuZ3RoP251bGwhPT10LmdldEF0dHJpYnV0ZSgibXVsdGlwbGUiKT90LmZpbGVzOnQuZmlsZXNbMF06bnVsbH0sdG49ZnVuY3Rpb24oZSxuKXtmdW5jdGlvbiBvKHQpe3JldHVybiBubltuLmlucHV0XShpLG9uKHQpLG4pfXZhciBpPVAoKTtiKG4uaW5wdXRPcHRpb25zKXx8dyhuLmlucHV0T3B0aW9ucyk/KEp0KFQoKSkseShuLmlucHV0T3B0aW9ucykudGhlbihmdW5jdGlvbih0KXtlLmhpZGVMb2FkaW5nKCksbyh0KX0pKToib2JqZWN0Ij09PXIobi5pbnB1dE9wdGlvbnMpP28obi5pbnB1dE9wdGlvbnMpOksoIlVuZXhwZWN0ZWQgdHlwZSBvZiBpbnB1dE9wdGlvbnMhIEV4cGVjdGVkIG9iamVjdCwgTWFwIG9yIFByb21pc2UsIGdvdCAiLmNvbmNhdChyKG4uaW5wdXRPcHRpb25zKSkpfSxlbj1mdW5jdGlvbihlLG4pe3ZhciBvPWUuZ2V0SW5wdXQoKTthdChvKSx5KG4uaW5wdXRWYWx1ZSkudGhlbihmdW5jdGlvbih0KXtvLnZhbHVlPSJudW1iZXIiPT09bi5pbnB1dD9wYXJzZUZsb2F0KHQpfHwwOiIiLmNvbmNhdCh0KSxydChvKSxvLmZvY3VzKCksZS5oaWRlTG9hZGluZygpfSkuY2F0Y2goZnVuY3Rpb24odCl7SygiRXJyb3IgaW4gaW5wdXRWYWx1ZSBwcm9taXNlOiAiLmNvbmNhdCh0KSksby52YWx1ZT0iIixydChvKSxvLmZvY3VzKCksZS5oaWRlTG9hZGluZygpfSl9LG5uPXtzZWxlY3Q6ZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG8odCxlLG4pe3ZhciBvPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpO28udmFsdWU9bixVKG8sZSksby5zZWxlY3RlZD1ybihuLGkuaW5wdXRWYWx1ZSksdC5hcHBlbmRDaGlsZChvKX12YXIgcj15dCh0LCQuc2VsZWN0KTtlLmZvckVhY2goZnVuY3Rpb24odCl7dmFyIGUsbj10WzBdLHQ9dFsxXTtBcnJheS5pc0FycmF5KHQpPygoZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRncm91cCIpKS5sYWJlbD1uLGUuZGlzYWJsZWQ9ITEsci5hcHBlbmRDaGlsZChlKSx0LmZvckVhY2goZnVuY3Rpb24odCl7cmV0dXJuIG8oZSx0WzFdLHRbMF0pfSkpOm8ocix0LG4pfSksci5mb2N1cygpfSxyYWRpbzpmdW5jdGlvbih0LGUsaSl7dmFyIHI9eXQodCwkLnJhZGlvKTtlLmZvckVhY2goZnVuY3Rpb24odCl7dmFyIGU9dFswXSxuPXRbMV0sbz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpLHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgibGFiZWwiKTtvLnR5cGU9InJhZGlvIixvLm5hbWU9JC5yYWRpbyxvLnZhbHVlPWUscm4oZSxpLmlucHV0VmFsdWUpJiYoby5jaGVja2VkPSEwKTtlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNwYW4iKTtVKGUsbiksZS5jbGFzc05hbWU9JC5sYWJlbCx0LmFwcGVuZENoaWxkKG8pLHQuYXBwZW5kQ2hpbGQoZSksci5hcHBlbmRDaGlsZCh0KX0pO2U9ci5xdWVyeVNlbGVjdG9yQWxsKCJpbnB1dCIpO2UubGVuZ3RoJiZlWzBdLmZvY3VzKCl9fSxvbj1mdW5jdGlvbiBuKG8pe3ZhciBpPVtdO3JldHVybiJ1bmRlZmluZWQiIT10eXBlb2YgTWFwJiZvIGluc3RhbmNlb2YgTWFwP28uZm9yRWFjaChmdW5jdGlvbih0LGUpeyJvYmplY3QiPT09cih0KSYmKHQ9bih0KSksaS5wdXNoKFtlLHRdKX0pOk9iamVjdC5rZXlzKG8pLmZvckVhY2goZnVuY3Rpb24odCl7dmFyIGU9b1t0XTsib2JqZWN0Ij09PXIoZSkmJihlPW4oZSkpLGkucHVzaChbdCxlXSl9KSxpfSxybj1mdW5jdGlvbih0LGUpe3JldHVybiBlJiZlLnRvU3RyaW5nKCk9PT10LnRvU3RyaW5nKCl9LGFuPWZ1bmN0aW9uKHQsZSxuKXt2YXIgbz1mdW5jdGlvbih0LGUpe3ZhciBuPXQuZ2V0SW5wdXQoKTtpZighbilyZXR1cm4gbnVsbDtzd2l0Y2goZS5pbnB1dCl7Y2FzZSJjaGVja2JveCI6cmV0dXJuICRlKG4pO2Nhc2UicmFkaW8iOnJldHVybiBYZShuKTtjYXNlImZpbGUiOnJldHVybiBHZShuKTtkZWZhdWx0OnJldHVybiBlLmlucHV0QXV0b1RyaW0/bi52YWx1ZS50cmltKCk6bi52YWx1ZX19KHQsZSk7ZS5pbnB1dFZhbGlkYXRvcj9zbih0LGUsbyk6dC5nZXRJbnB1dCgpLmNoZWNrVmFsaWRpdHkoKT8oImRlbnkiPT09bj91bjpjbikodCxlLG8pOih0LmVuYWJsZUJ1dHRvbnMoKSx0LnNob3dWYWxpZGF0aW9uTWVzc2FnZShlLnZhbGlkYXRpb25NZXNzYWdlKSl9LHNuPWZ1bmN0aW9uKGUsbixvKXtlLmRpc2FibGVJbnB1dCgpLFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4geShuLmlucHV0VmFsaWRhdG9yKG8sbi52YWxpZGF0aW9uTWVzc2FnZSkpfSkudGhlbihmdW5jdGlvbih0KXtlLmVuYWJsZUJ1dHRvbnMoKSxlLmVuYWJsZUlucHV0KCksdD9lLnNob3dWYWxpZGF0aW9uTWVzc2FnZSh0KTpjbihlLG4sbyl9KX0sdW49ZnVuY3Rpb24oZSx0LG4pe3Quc2hvd0xvYWRlck9uRGVueSYmSnQoTCgpKSx0LnByZURlbnk/UHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbigpe3JldHVybiB5KHQucHJlRGVueShuLHQudmFsaWRhdGlvbk1lc3NhZ2UpKX0pLnRoZW4oZnVuY3Rpb24odCl7ITE9PT10P2UuaGlkZUxvYWRpbmcoKTplLmNsb3NlUG9wdXAoe2lzRGVuaWVkOiEwLHZhbHVlOnZvaWQgMD09PXQ/bjp0fSl9KTplLmNsb3NlUG9wdXAoe2lzRGVuaWVkOiEwLHZhbHVlOm59KX0sY249ZnVuY3Rpb24oZSx0LG4pe3Quc2hvd0xvYWRlck9uQ29uZmlybSYmSnQoKSx0LnByZUNvbmZpcm0/KGUucmVzZXRWYWxpZGF0aW9uTWVzc2FnZSgpLFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4geSh0LnByZUNvbmZpcm0obix0LnZhbGlkYXRpb25NZXNzYWdlKSl9KS50aGVuKGZ1bmN0aW9uKHQpe3d0KFMoKSl8fCExPT09dD9lLmhpZGVMb2FkaW5nKCk6SWUoZSx2b2lkIDA9PT10P246dCl9KSk6SWUoZSxuKX0sbG49WyJBcnJvd1JpZ2h0IiwiQXJyb3dEb3duIiwiUmlnaHQiLCJEb3duIl0sZG49WyJBcnJvd0xlZnQiLCJBcnJvd1VwIiwiTGVmdCIsIlVwIl0scG49WyJFc2NhcGUiLCJFc2MiXSxmbj1mdW5jdGlvbih0LGUsbil7dmFyIG89VHQuaW5uZXJQYXJhbXMuZ2V0KHQpO28mJihvLnN0b3BLZXlkb3duUHJvcGFnYXRpb24mJmUuc3RvcFByb3BhZ2F0aW9uKCksIkVudGVyIj09PWUua2V5P21uKHQsZSxvKToiVGFiIj09PWUua2V5P2huKGUsbyk6LTEhPT1bXS5jb25jYXQobG4sZG4pLmluZGV4T2YoZS5rZXkpP2duKGUua2V5KTotMSE9PXBuLmluZGV4T2YoZS5rZXkpJiZ2bihlLG8sbikpfSxtbj1mdW5jdGlvbih0LGUsbil7ZS5pc0NvbXBvc2luZ3x8ZS50YXJnZXQmJnQuZ2V0SW5wdXQoKSYmZS50YXJnZXQub3V0ZXJIVE1MPT09dC5nZXRJbnB1dCgpLm91dGVySFRNTCYmLTE9PT1bInRleHRhcmVhIiwiZmlsZSJdLmluZGV4T2Yobi5pbnB1dCkmJihGdCgpLGUucHJldmVudERlZmF1bHQoKSl9LGhuPWZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBuPXQudGFyZ2V0LG89UigpLGk9LTEscj0wO3I8by5sZW5ndGg7cisrKWlmKG49PT1vW3JdKXtpPXI7YnJlYWt9dC5zaGlmdEtleT9IZSgwLGksLTEpOkhlKDAsaSwxKSx0LnN0b3BQcm9wYWdhdGlvbigpLHQucHJldmVudERlZmF1bHQoKX0sZ249ZnVuY3Rpb24odCl7LTEhPT1bVCgpLEwoKSxxKCldLmluZGV4T2YoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCkmJih0PS0xIT09bG4uaW5kZXhPZih0KT8ibmV4dEVsZW1lbnRTaWJsaW5nIjoicHJldmlvdXNFbGVtZW50U2libGluZyIsKHQ9ZG9jdW1lbnQuYWN0aXZlRWxlbWVudFt0XSkmJnQuZm9jdXMoKSl9LHZuPWZ1bmN0aW9uKHQsZSxuKXtaKGUuYWxsb3dFc2NhcGVLZXkpJiYodC5wcmV2ZW50RGVmYXVsdCgpLG4oUS5lc2MpKX0sYm49ZnVuY3Rpb24oZSx0LG4pe3QucG9wdXAub25jbGljaz1mdW5jdGlvbigpe3ZhciB0PVR0LmlubmVyUGFyYW1zLmdldChlKTt0LnNob3dDb25maXJtQnV0dG9ufHx0LnNob3dEZW55QnV0dG9ufHx0LnNob3dDYW5jZWxCdXR0b258fHQuc2hvd0Nsb3NlQnV0dG9ufHx0LnRpbWVyfHx0LmlucHV0fHxuKFEuY2xvc2UpfX0seW49ITEsd249ZnVuY3Rpb24oZSl7ZS5wb3B1cC5vbm1vdXNlZG93bj1mdW5jdGlvbigpe2UuY29udGFpbmVyLm9ubW91c2V1cD1mdW5jdGlvbih0KXtlLmNvbnRhaW5lci5vbm1vdXNldXA9dm9pZCAwLHQudGFyZ2V0PT09ZS5jb250YWluZXImJih5bj0hMCl9fX0sQ249ZnVuY3Rpb24oZSl7ZS5jb250YWluZXIub25tb3VzZWRvd249ZnVuY3Rpb24oKXtlLnBvcHVwLm9ubW91c2V1cD1mdW5jdGlvbih0KXtlLnBvcHVwLm9ubW91c2V1cD12b2lkIDAsdC50YXJnZXQhPT1lLnBvcHVwJiYhZS5wb3B1cC5jb250YWlucyh0LnRhcmdldCl8fCh5bj0hMCl9fX0sa249ZnVuY3Rpb24obixvLGkpe28uY29udGFpbmVyLm9uY2xpY2s9ZnVuY3Rpb24odCl7dmFyIGU9VHQuaW5uZXJQYXJhbXMuZ2V0KG4pO3luP3luPSExOnQudGFyZ2V0PT09by5jb250YWluZXImJlooZS5hbGxvd091dHNpZGVDbGljaykmJmkoUS5iYWNrZHJvcCl9fTtmdW5jdGlvbiBBbih0LGUpe3ZhciBuPWZ1bmN0aW9uKHQpe3Q9InN0cmluZyI9PXR5cGVvZiB0LnRlbXBsYXRlP2RvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodC50ZW1wbGF0ZSk6dC50ZW1wbGF0ZTtpZighdClyZXR1cm57fTt0PXQuY29udGVudHx8dDtyZXR1cm4gV2UodCksdShSZSh0KSxOZSh0KSxVZSh0KSxGZSh0KSxfZSh0KSx6ZSh0LFZlKSl9KHQpO3JldHVybihuPXUoe30sc2UsZSxuLHQpKS5zaG93Q2xhc3M9dSh7fSxzZS5zaG93Q2xhc3Msbi5zaG93Q2xhc3MpLG4uaGlkZUNsYXNzPXUoe30sc2UuaGlkZUNsYXNzLG4uaGlkZUNsYXNzKSwhMT09PXQuYW5pbWF0aW9uJiYobi5zaG93Q2xhc3M9e3BvcHVwOiJzd2FsMi1ub2FuaW1hdGlvbiIsYmFja2Ryb3A6InN3YWwyLW5vYW5pbWF0aW9uIn0sbi5oaWRlQ2xhc3M9e30pLG59ZnVuY3Rpb24geG4oYSxzLHUpe3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbih0KXtmdW5jdGlvbiBlKHQpe2EuY2xvc2VQb3B1cCh7aXNEaXNtaXNzZWQ6ITAsZGlzbWlzczp0fSl9dmFyIG4sbyxpLHI7Q2Uuc3dhbFByb21pc2VSZXNvbHZlLnNldChhLHQpLHMuY29uZmlybUJ1dHRvbi5vbmNsaWNrPWZ1bmN0aW9uKCl7cmV0dXJuIGU9dSwodD1hKS5kaXNhYmxlQnV0dG9ucygpLHZvaWQoZS5pbnB1dD9hbih0LGUsImNvbmZpcm0iKTpjbih0LGUsITApKTt2YXIgdCxlfSxzLmRlbnlCdXR0b24ub25jbGljaz1mdW5jdGlvbigpe3JldHVybiBlPXUsKHQ9YSkuZGlzYWJsZUJ1dHRvbnMoKSx2b2lkKGUucmV0dXJuSW5wdXRWYWx1ZU9uRGVueT9hbih0LGUsImRlbnkiKTp1bih0LGUsITEpKTt2YXIgdCxlfSxzLmNhbmNlbEJ1dHRvbi5vbmNsaWNrPWZ1bmN0aW9uKCl7cmV0dXJuIHQ9ZSxhLmRpc2FibGVCdXR0b25zKCksdm9pZCB0KFEuY2FuY2VsKTt2YXIgdH0scy5jbG9zZUJ1dHRvbi5vbmNsaWNrPWZ1bmN0aW9uKCl7cmV0dXJuIGUoUS5jbG9zZSl9LG49YSxyPXMsdD1lLFR0LmlubmVyUGFyYW1zLmdldChuKS50b2FzdD9ibihuLHIsdCk6KHduKHIpLENuKHIpLGtuKG4scix0KSksbz1hLHI9dSxpPWUsKHQ9dGUpLmtleWRvd25UYXJnZXQmJnQua2V5ZG93bkhhbmRsZXJBZGRlZCYmKHQua2V5ZG93blRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKCJrZXlkb3duIix0LmtleWRvd25IYW5kbGVyLHtjYXB0dXJlOnQua2V5ZG93bkxpc3RlbmVyQ2FwdHVyZX0pLHQua2V5ZG93bkhhbmRsZXJBZGRlZD0hMSksci50b2FzdHx8KHQua2V5ZG93bkhhbmRsZXI9ZnVuY3Rpb24odCl7cmV0dXJuIGZuKG8sdCxpKX0sdC5rZXlkb3duVGFyZ2V0PXIua2V5ZG93bkxpc3RlbmVyQ2FwdHVyZT93aW5kb3c6QSgpLHQua2V5ZG93bkxpc3RlbmVyQ2FwdHVyZT1yLmtleWRvd25MaXN0ZW5lckNhcHR1cmUsdC5rZXlkb3duVGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoImtleWRvd24iLHQua2V5ZG93bkhhbmRsZXIse2NhcHR1cmU6dC5rZXlkb3duTGlzdGVuZXJDYXB0dXJlfSksdC5rZXlkb3duSGFuZGxlckFkZGVkPSEwKSxyPWEsInNlbGVjdCI9PT0odD11KS5pbnB1dHx8InJhZGlvIj09PXQuaW5wdXQ/dG4ocix0KTotMSE9PVsidGV4dCIsImVtYWlsIiwibnVtYmVyIiwidGVsIiwidGV4dGFyZWEiXS5pbmRleE9mKHQuaW5wdXQpJiYoYih0LmlucHV0VmFsdWUpfHx3KHQuaW5wdXRWYWx1ZSkpJiZlbihyLHQpLGplKHUpLFBuKHRlLHUsZSksT24ocyx1KSxzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7cy5jb250YWluZXIuc2Nyb2xsVG9wPTB9KX0pfWZ1bmN0aW9uIEJuKHQpe3ZhciBlPXtwb3B1cDpBKCksY29udGFpbmVyOmsoKSxjb250ZW50OlAoKSxhY3Rpb25zOmooKSxjb25maXJtQnV0dG9uOlQoKSxkZW55QnV0dG9uOkwoKSxjYW5jZWxCdXR0b246cSgpLGxvYWRlcjpEKCksY2xvc2VCdXR0b246VigpLHZhbGlkYXRpb25NZXNzYWdlOlMoKSxwcm9ncmVzc1N0ZXBzOm4oKX07cmV0dXJuIFR0LmRvbUNhY2hlLnNldCh0LGUpLGV9dmFyIFBuPWZ1bmN0aW9uKHQsZSxuKXt2YXIgbz1IKCk7YXQobyksZS50aW1lciYmKHQudGltZW91dD1uZXcgTGUoZnVuY3Rpb24oKXtuKCJ0aW1lciIpLGRlbGV0ZSB0LnRpbWVvdXR9LGUudGltZXIpLGUudGltZXJQcm9ncmVzc0JhciYmKHJ0KG8pLHNldFRpbWVvdXQoZnVuY3Rpb24oKXt0LnRpbWVvdXQmJnQudGltZW91dC5ydW5uaW5nJiZkdChlLnRpbWVyKX0pKSl9LE9uPWZ1bmN0aW9uKHQsZSl7aWYoIWUudG9hc3QpcmV0dXJuIFooZS5hbGxvd0VudGVyS2V5KT92b2lkKEVuKHQsZSl8fEhlKDAsLTEsMSkpOlNuKCl9LEVuPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUuZm9jdXNEZW55JiZ3dCh0LmRlbnlCdXR0b24pPyh0LmRlbnlCdXR0b24uZm9jdXMoKSwhMCk6ZS5mb2N1c0NhbmNlbCYmd3QodC5jYW5jZWxCdXR0b24pPyh0LmNhbmNlbEJ1dHRvbi5mb2N1cygpLCEwKTohKCFlLmZvY3VzQ29uZmlybXx8IXd0KHQuY29uZmlybUJ1dHRvbikpJiYodC5jb25maXJtQnV0dG9uLmZvY3VzKCksITApfSxTbj1mdW5jdGlvbigpe2RvY3VtZW50LmFjdGl2ZUVsZW1lbnQmJiJmdW5jdGlvbiI9PXR5cGVvZiBkb2N1bWVudC5hY3RpdmVFbGVtZW50LmJsdXImJmRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuYmx1cigpfTtmdW5jdGlvbiBUbih0KXsiZnVuY3Rpb24iPT10eXBlb2YgdC5kaWREZXN0cm95P3QuZGlkRGVzdHJveSgpOiJmdW5jdGlvbiI9PXR5cGVvZiB0Lm9uRGVzdHJveSYmdC5vbkRlc3Ryb3koKX1mdW5jdGlvbiBMbih0KXtkZWxldGUgdC5wYXJhbXMsZGVsZXRlIHRlLmtleWRvd25IYW5kbGVyLGRlbGV0ZSB0ZS5rZXlkb3duVGFyZ2V0LHFuKFR0KSxxbihDZSl9dmFyIERuLHFuPWZ1bmN0aW9uKHQpe2Zvcih2YXIgZSBpbiB0KXRbZV09bmV3IFdlYWtNYXB9LEo9T2JqZWN0LmZyZWV6ZSh7aGlkZUxvYWRpbmc6cGUsZGlzYWJsZUxvYWRpbmc6cGUsZ2V0SW5wdXQ6ZnVuY3Rpb24odCl7dmFyIGU9VHQuaW5uZXJQYXJhbXMuZ2V0KHR8fHRoaXMpO3JldHVybih0PVR0LmRvbUNhY2hlLmdldCh0fHx0aGlzKSk/ZXQodC5jb250ZW50LGUuaW5wdXQpOm51bGx9LGNsb3NlOkFlLGNsb3NlUG9wdXA6QWUsY2xvc2VNb2RhbDpBZSxjbG9zZVRvYXN0OkFlLGVuYWJsZUJ1dHRvbnM6ZnVuY3Rpb24oKXtTZSh0aGlzLFsiY29uZmlybUJ1dHRvbiIsImRlbnlCdXR0b24iLCJjYW5jZWxCdXR0b24iXSwhMSl9LGRpc2FibGVCdXR0b25zOmZ1bmN0aW9uKCl7U2UodGhpcyxbImNvbmZpcm1CdXR0b24iLCJkZW55QnV0dG9uIiwiY2FuY2VsQnV0dG9uIl0sITApfSxlbmFibGVJbnB1dDpmdW5jdGlvbigpe3JldHVybiBUZSh0aGlzLmdldElucHV0KCksITEpfSxkaXNhYmxlSW5wdXQ6ZnVuY3Rpb24oKXtyZXR1cm4gVGUodGhpcy5nZXRJbnB1dCgpLCEwKX0sc2hvd1ZhbGlkYXRpb25NZXNzYWdlOmZ1bmN0aW9uKHQpe3ZhciBlPVR0LmRvbUNhY2hlLmdldCh0aGlzKSxuPVR0LmlubmVyUGFyYW1zLmdldCh0aGlzKTtVKGUudmFsaWRhdGlvbk1lc3NhZ2UsdCksZS52YWxpZGF0aW9uTWVzc2FnZS5jbGFzc05hbWU9JFsidmFsaWRhdGlvbi1tZXNzYWdlIl0sbi5jdXN0b21DbGFzcyYmbi5jdXN0b21DbGFzcy52YWxpZGF0aW9uTWVzc2FnZSYmdnQoZS52YWxpZGF0aW9uTWVzc2FnZSxuLmN1c3RvbUNsYXNzLnZhbGlkYXRpb25NZXNzYWdlKSxydChlLnZhbGlkYXRpb25NZXNzYWdlKSwoZT10aGlzLmdldElucHV0KCkpJiYoZS5zZXRBdHRyaWJ1dGUoImFyaWEtaW52YWxpZCIsITApLGUuc2V0QXR0cmlidXRlKCJhcmlhLWRlc2NyaWJlZEJ5IiwkWyJ2YWxpZGF0aW9uLW1lc3NhZ2UiXSksbnQoZSksdnQoZSwkLmlucHV0ZXJyb3IpKX0scmVzZXRWYWxpZGF0aW9uTWVzc2FnZTpmdW5jdGlvbigpe3ZhciB0PVR0LmRvbUNhY2hlLmdldCh0aGlzKTt0LnZhbGlkYXRpb25NZXNzYWdlJiZhdCh0LnZhbGlkYXRpb25NZXNzYWdlKSwodD10aGlzLmdldElucHV0KCkpJiYodC5yZW1vdmVBdHRyaWJ1dGUoImFyaWEtaW52YWxpZCIpLHQucmVtb3ZlQXR0cmlidXRlKCJhcmlhLWRlc2NyaWJlZEJ5IiksYnQodCwkLmlucHV0ZXJyb3IpKX0sZ2V0UHJvZ3Jlc3NTdGVwczpmdW5jdGlvbigpe3JldHVybiBUdC5kb21DYWNoZS5nZXQodGhpcykucHJvZ3Jlc3NTdGVwc30sX21haW46ZnVuY3Rpb24odCl7dmFyIGU9MTxhcmd1bWVudHMubGVuZ3RoJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0/YXJndW1lbnRzWzFdOnt9O3JldHVybiBhZSh1KHt9LGUsdCkpLHRlLmN1cnJlbnRJbnN0YW5jZSYmdGUuY3VycmVudEluc3RhbmNlLl9kZXN0cm95KCksdGUuY3VycmVudEluc3RhbmNlPXRoaXMscWUodD1Bbih0LGUpKSxPYmplY3QuZnJlZXplKHQpLHRlLnRpbWVvdXQmJih0ZS50aW1lb3V0LnN0b3AoKSxkZWxldGUgdGUudGltZW91dCksY2xlYXJUaW1lb3V0KHRlLnJlc3RvcmVGb2N1c1RpbWVvdXQpLGU9Qm4odGhpcyksVXQodGhpcyx0KSxUdC5pbm5lclBhcmFtcy5zZXQodGhpcyx0KSx4bih0aGlzLGUsdCl9LHVwZGF0ZTpmdW5jdGlvbihlKXt2YXIgdD1BKCksbj1UdC5pbm5lclBhcmFtcy5nZXQodGhpcyk7aWYoIXR8fEYodCxuLmhpZGVDbGFzcy5wb3B1cCkpcmV0dXJuIFcoIllvdSdyZSB0cnlpbmcgdG8gdXBkYXRlIHRoZSBjbG9zZWQgb3IgY2xvc2luZyBwb3B1cCwgdGhhdCB3b24ndCB3b3JrLiBVc2UgdGhlIHVwZGF0ZSgpIG1ldGhvZCBpbiBwcmVDb25maXJtIHBhcmFtZXRlciBvciBzaG93IGEgbmV3IHBvcHVwLiIpO3ZhciBvPXt9O09iamVjdC5rZXlzKGUpLmZvckVhY2goZnVuY3Rpb24odCl7TW4uaXNVcGRhdGFibGVQYXJhbWV0ZXIodCk/b1t0XT1lW3RdOlcoJ0ludmFsaWQgcGFyYW1ldGVyIHRvIHVwZGF0ZTogIicuY29uY2F0KHQsJyIuIFVwZGF0YWJsZSBwYXJhbXMgYXJlIGxpc3RlZCBoZXJlOiBodHRwczovL2dpdGh1Yi5jb20vc3dlZXRhbGVydDIvc3dlZXRhbGVydDIvYmxvYi9tYXN0ZXIvc3JjL3V0aWxzL3BhcmFtcy5qc1xuXG5JZiB5b3UgdGhpbmsgdGhpcyBwYXJhbWV0ZXIgc2hvdWxkIGJlIHVwZGF0YWJsZSwgcmVxdWVzdCBpdCBoZXJlOiBodHRwczovL2dpdGh1Yi5jb20vc3dlZXRhbGVydDIvc3dlZXRhbGVydDIvaXNzdWVzL25ldz90ZW1wbGF0ZT0wMl9mZWF0dXJlX3JlcXVlc3QubWQnKSl9KSxuPXUoe30sbixvKSxVdCh0aGlzLG4pLFR0LmlubmVyUGFyYW1zLnNldCh0aGlzLG4pLE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMse3BhcmFtczp7dmFsdWU6dSh7fSx0aGlzLnBhcmFtcyxlKSx3cml0YWJsZTohMSxlbnVtZXJhYmxlOiEwfX0pfSxfZGVzdHJveTpmdW5jdGlvbigpe3ZhciB0PVR0LmRvbUNhY2hlLmdldCh0aGlzKSxlPVR0LmlubmVyUGFyYW1zLmdldCh0aGlzKTtlJiYodC5wb3B1cCYmdGUuc3dhbENsb3NlRXZlbnRGaW5pc2hlZENhbGxiYWNrJiYodGUuc3dhbENsb3NlRXZlbnRGaW5pc2hlZENhbGxiYWNrKCksZGVsZXRlIHRlLnN3YWxDbG9zZUV2ZW50RmluaXNoZWRDYWxsYmFjayksdGUuZGVmZXJEaXNwb3NhbFRpbWVyJiYoY2xlYXJUaW1lb3V0KHRlLmRlZmVyRGlzcG9zYWxUaW1lciksZGVsZXRlIHRlLmRlZmVyRGlzcG9zYWxUaW1lciksVG4oZSksTG4odGhpcykpfX0pLGpuPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gaSgpe2lmKGEodGhpcyxpKSwidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdyl7InVuZGVmaW5lZCI9PXR5cGVvZiBQcm9taXNlJiZLKCJUaGlzIHBhY2thZ2UgcmVxdWlyZXMgYSBQcm9taXNlIGxpYnJhcnksIHBsZWFzZSBpbmNsdWRlIGEgc2hpbSB0byBlbmFibGUgaXQgaW4gdGhpcyBicm93c2VyIChTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9zd2VldGFsZXJ0Mi9zd2VldGFsZXJ0Mi93aWtpL01pZ3JhdGlvbi1mcm9tLVN3ZWV0QWxlcnQtdG8tU3dlZXRBbGVydDIjMS1pZS1zdXBwb3J0KSIpLERuPXRoaXM7Zm9yKHZhciB0PWFyZ3VtZW50cy5sZW5ndGgsZT1uZXcgQXJyYXkodCksbj0wO248dDtuKyspZVtuXT1hcmd1bWVudHNbbl07dmFyIG89T2JqZWN0LmZyZWV6ZSh0aGlzLmNvbnN0cnVjdG9yLmFyZ3NUb1BhcmFtcyhlKSk7T2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcyx7cGFyYW1zOnt2YWx1ZTpvLHdyaXRhYmxlOiExLGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfX0pO289dGhpcy5fbWFpbih0aGlzLnBhcmFtcyk7VHQucHJvbWlzZS5zZXQodGhpcyxvKX19cmV0dXJuIHMoaSxbe2tleToidGhlbiIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIFR0LnByb21pc2UuZ2V0KHRoaXMpLnRoZW4odCl9fSx7a2V5OiJmaW5hbGx5Iix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gVHQucHJvbWlzZS5nZXQodGhpcykuZmluYWxseSh0KX19XSksaX0oKTt1KGpuLnByb3RvdHlwZSxKKSx1KGpuLGRlKSxPYmplY3Qua2V5cyhKKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe2puW3RdPWZ1bmN0aW9uKCl7aWYoRG4pcmV0dXJuIERuW3RdLmFwcGx5KERuLGFyZ3VtZW50cyl9fSksam4uRGlzbWlzc1JlYXNvbj1RLGpuLnZlcnNpb249IjEwLjE2LjYiO3ZhciBNbj1qbjtyZXR1cm4gTW4uZGVmYXVsdD1Nbn0pLHZvaWQgMCE9PXRoaXMmJnRoaXMuU3dlZXRhbGVydDImJih0aGlzLnN3YWw9dGhpcy5zd2VldEFsZXJ0PXRoaXMuU3dhbD10aGlzLlN3ZWV0QWxlcnQ9dGhpcy5Td2VldGFsZXJ0Mik7CiJ1bmRlZmluZWQiIT10eXBlb2YgZG9jdW1lbnQmJmZ1bmN0aW9uKGUsdCl7dmFyIG49ZS5jcmVhdGVFbGVtZW50KCJzdHlsZSIpO2lmKGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImhlYWQiKVswXS5hcHBlbmRDaGlsZChuKSxuLnN0eWxlU2hlZXQpbi5zdHlsZVNoZWV0LmRpc2FibGVkfHwobi5zdHlsZVNoZWV0LmNzc1RleHQ9dCk7ZWxzZSB0cnl7bi5pbm5lckhUTUw9dH1jYXRjaChlKXtuLmlubmVyVGV4dD10fX0oZG9jdW1lbnQsIi5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdHtmbGV4LWRpcmVjdGlvbjpjb2x1bW47YWxpZ24taXRlbXM6c3RyZXRjaDt3aWR0aDphdXRvO3BhZGRpbmc6MS4yNWVtO292ZXJmbG93LXk6aGlkZGVuO2JhY2tncm91bmQ6I2ZmZjtib3gtc2hhZG93OjAgMCAuNjI1ZW0gI2Q5ZDlkOX0uc3dhbDItcG9wdXAuc3dhbDItdG9hc3QgLnN3YWwyLWhlYWRlcntmbGV4LWRpcmVjdGlvbjpyb3c7cGFkZGluZzowfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItdGl0bGV7ZmxleC1ncm93OjE7anVzdGlmeS1jb250ZW50OmZsZXgtc3RhcnQ7bWFyZ2luOjAgLjYyNWVtO2ZvbnQtc2l6ZToxZW19LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1sb2FkaW5ne2p1c3RpZnktY29udGVudDpjZW50ZXJ9LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1pbnB1dHtoZWlnaHQ6MmVtO21hcmdpbjouMzEyNWVtIGF1dG87Zm9udC1zaXplOjFlbX0uc3dhbDItcG9wdXAuc3dhbDItdG9hc3QgLnN3YWwyLXZhbGlkYXRpb24tbWVzc2FnZXtmb250LXNpemU6MWVtfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItZm9vdGVye21hcmdpbjouNWVtIDAgMDtwYWRkaW5nOi41ZW0gMCAwO2ZvbnQtc2l6ZTouOGVtfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItY2xvc2V7cG9zaXRpb246c3RhdGljO3dpZHRoOi44ZW07aGVpZ2h0Oi44ZW07bGluZS1oZWlnaHQ6Ljh9LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1jb250ZW50e2p1c3RpZnktY29udGVudDpmbGV4LXN0YXJ0O21hcmdpbjowIC42MjVlbTtwYWRkaW5nOjA7Zm9udC1zaXplOjFlbTt0ZXh0LWFsaWduOmluaXRpYWx9LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1odG1sLWNvbnRhaW5lcntwYWRkaW5nOi42MjVlbSAwIDB9LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1odG1sLWNvbnRhaW5lcjplbXB0eXtwYWRkaW5nOjB9LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1pY29ue3dpZHRoOjJlbTttaW4td2lkdGg6MmVtO2hlaWdodDoyZW07bWFyZ2luOjAgLjVlbSAwIDB9LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1pY29uIC5zd2FsMi1pY29uLWNvbnRlbnR7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtmb250LXNpemU6MS44ZW07Zm9udC13ZWlnaHQ6NzAwfUBtZWRpYSBhbGwgYW5kICgtbXMtaGlnaC1jb250cmFzdDpub25lKSwoLW1zLWhpZ2gtY29udHJhc3Q6YWN0aXZlKXsuc3dhbDItcG9wdXAuc3dhbDItdG9hc3QgLnN3YWwyLWljb24gLnN3YWwyLWljb24tY29udGVudHtmb250LXNpemU6LjI1ZW19fS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItaWNvbi5zd2FsMi1zdWNjZXNzIC5zd2FsMi1zdWNjZXNzLXJpbmd7d2lkdGg6MmVtO2hlaWdodDoyZW19LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1pY29uLnN3YWwyLWVycm9yIFtjbGFzc149c3dhbDIteC1tYXJrLWxpbmVde3RvcDouODc1ZW07d2lkdGg6MS4zNzVlbX0uc3dhbDItcG9wdXAuc3dhbDItdG9hc3QgLnN3YWwyLWljb24uc3dhbDItZXJyb3IgW2NsYXNzXj1zd2FsMi14LW1hcmstbGluZV1bY2xhc3MkPWxlZnRde2xlZnQ6LjMxMjVlbX0uc3dhbDItcG9wdXAuc3dhbDItdG9hc3QgLnN3YWwyLWljb24uc3dhbDItZXJyb3IgW2NsYXNzXj1zd2FsMi14LW1hcmstbGluZV1bY2xhc3MkPXJpZ2h0XXtyaWdodDouMzEyNWVtfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItYWN0aW9uc3tmbGV4OjE7ZmxleC1iYXNpczphdXRvIWltcG9ydGFudDthbGlnbi1zZWxmOnN0cmV0Y2g7d2lkdGg6YXV0bztoZWlnaHQ6Mi4yZW07aGVpZ2h0OmF1dG87bWFyZ2luOjAgLjMxMjVlbTttYXJnaW4tdG9wOi4zMTI1ZW07cGFkZGluZzowfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItc3R5bGVke21hcmdpbjouMTI1ZW0gLjMxMjVlbTtwYWRkaW5nOi4zMTI1ZW0gLjYyNWVtO2ZvbnQtc2l6ZToxZW19LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1zdHlsZWQ6Zm9jdXN7Ym94LXNoYWRvdzowIDAgMCAxcHggI2ZmZiwwIDAgMCAzcHggcmdiYSgxMDAsMTUwLDIwMCwuNSl9LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1zdWNjZXNze2JvcmRlci1jb2xvcjojYTVkYzg2fS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItc3VjY2VzcyBbY2xhc3NePXN3YWwyLXN1Y2Nlc3MtY2lyY3VsYXItbGluZV17cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MS42ZW07aGVpZ2h0OjNlbTt0cmFuc2Zvcm06cm90YXRlKDQ1ZGVnKTtib3JkZXItcmFkaXVzOjUwJX0uc3dhbDItcG9wdXAuc3dhbDItdG9hc3QgLnN3YWwyLXN1Y2Nlc3MgW2NsYXNzXj1zd2FsMi1zdWNjZXNzLWNpcmN1bGFyLWxpbmVdW2NsYXNzJD1sZWZ0XXt0b3A6LS44ZW07bGVmdDotLjVlbTt0cmFuc2Zvcm06cm90YXRlKC00NWRlZyk7dHJhbnNmb3JtLW9yaWdpbjoyZW0gMmVtO2JvcmRlci1yYWRpdXM6NGVtIDAgMCA0ZW19LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1zdWNjZXNzIFtjbGFzc149c3dhbDItc3VjY2Vzcy1jaXJjdWxhci1saW5lXVtjbGFzcyQ9cmlnaHRde3RvcDotLjI1ZW07bGVmdDouOTM3NWVtO3RyYW5zZm9ybS1vcmlnaW46MCAxLjVlbTtib3JkZXItcmFkaXVzOjAgNGVtIDRlbSAwfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItc3VjY2VzcyAuc3dhbDItc3VjY2Vzcy1yaW5ne3dpZHRoOjJlbTtoZWlnaHQ6MmVtfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItc3VjY2VzcyAuc3dhbDItc3VjY2Vzcy1maXh7dG9wOjA7bGVmdDouNDM3NWVtO3dpZHRoOi40Mzc1ZW07aGVpZ2h0OjIuNjg3NWVtfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItc3VjY2VzcyBbY2xhc3NePXN3YWwyLXN1Y2Nlc3MtbGluZV17aGVpZ2h0Oi4zMTI1ZW19LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1zdWNjZXNzIFtjbGFzc149c3dhbDItc3VjY2Vzcy1saW5lXVtjbGFzcyQ9dGlwXXt0b3A6MS4xMjVlbTtsZWZ0Oi4xODc1ZW07d2lkdGg6Ljc1ZW19LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1zdWNjZXNzIFtjbGFzc149c3dhbDItc3VjY2Vzcy1saW5lXVtjbGFzcyQ9bG9uZ117dG9wOi45Mzc1ZW07cmlnaHQ6LjE4NzVlbTt3aWR0aDoxLjM3NWVtfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItc3VjY2Vzcy5zd2FsMi1pY29uLXNob3cgLnN3YWwyLXN1Y2Nlc3MtbGluZS10aXB7LXdlYmtpdC1hbmltYXRpb246c3dhbDItdG9hc3QtYW5pbWF0ZS1zdWNjZXNzLWxpbmUtdGlwIC43NXM7YW5pbWF0aW9uOnN3YWwyLXRvYXN0LWFuaW1hdGUtc3VjY2Vzcy1saW5lLXRpcCAuNzVzfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItc3VjY2Vzcy5zd2FsMi1pY29uLXNob3cgLnN3YWwyLXN1Y2Nlc3MtbGluZS1sb25ney13ZWJraXQtYW5pbWF0aW9uOnN3YWwyLXRvYXN0LWFuaW1hdGUtc3VjY2Vzcy1saW5lLWxvbmcgLjc1czthbmltYXRpb246c3dhbDItdG9hc3QtYW5pbWF0ZS1zdWNjZXNzLWxpbmUtbG9uZyAuNzVzfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdC5zd2FsMi1zaG93ey13ZWJraXQtYW5pbWF0aW9uOnN3YWwyLXRvYXN0LXNob3cgLjVzO2FuaW1hdGlvbjpzd2FsMi10b2FzdC1zaG93IC41c30uc3dhbDItcG9wdXAuc3dhbDItdG9hc3Quc3dhbDItaGlkZXstd2Via2l0LWFuaW1hdGlvbjpzd2FsMi10b2FzdC1oaWRlIC4xcyBmb3J3YXJkczthbmltYXRpb246c3dhbDItdG9hc3QtaGlkZSAuMXMgZm9yd2FyZHN9LnN3YWwyLWNvbnRhaW5lcntkaXNwbGF5OmZsZXg7cG9zaXRpb246Zml4ZWQ7ei1pbmRleDoxMDYwO3RvcDowO3JpZ2h0OjA7Ym90dG9tOjA7bGVmdDowO2ZsZXgtZGlyZWN0aW9uOnJvdzthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjtwYWRkaW5nOi42MjVlbTtvdmVyZmxvdy14OmhpZGRlbjt0cmFuc2l0aW9uOmJhY2tncm91bmQtY29sb3IgLjFzOy13ZWJraXQtb3ZlcmZsb3ctc2Nyb2xsaW5nOnRvdWNofS5zd2FsMi1jb250YWluZXIuc3dhbDItYmFja2Ryb3Atc2hvdywuc3dhbDItY29udGFpbmVyLnN3YWwyLW5vYW5pbWF0aW9ue2JhY2tncm91bmQ6cmdiYSgwLDAsMCwuNCl9LnN3YWwyLWNvbnRhaW5lci5zd2FsMi1iYWNrZHJvcC1oaWRle2JhY2tncm91bmQ6MCAwIWltcG9ydGFudH0uc3dhbDItY29udGFpbmVyLnN3YWwyLXRvcHthbGlnbi1pdGVtczpmbGV4LXN0YXJ0fS5zd2FsMi1jb250YWluZXIuc3dhbDItdG9wLWxlZnQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi10b3Atc3RhcnR7YWxpZ24taXRlbXM6ZmxleC1zdGFydDtqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1zdGFydH0uc3dhbDItY29udGFpbmVyLnN3YWwyLXRvcC1lbmQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi10b3AtcmlnaHR7YWxpZ24taXRlbXM6ZmxleC1zdGFydDtqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1lbmR9LnN3YWwyLWNvbnRhaW5lci5zd2FsMi1jZW50ZXJ7YWxpZ24taXRlbXM6Y2VudGVyfS5zd2FsMi1jb250YWluZXIuc3dhbDItY2VudGVyLWxlZnQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1jZW50ZXItc3RhcnR7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpmbGV4LXN0YXJ0fS5zd2FsMi1jb250YWluZXIuc3dhbDItY2VudGVyLWVuZCwuc3dhbDItY29udGFpbmVyLnN3YWwyLWNlbnRlci1yaWdodHthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmZsZXgtZW5kfS5zd2FsMi1jb250YWluZXIuc3dhbDItYm90dG9te2FsaWduLWl0ZW1zOmZsZXgtZW5kfS5zd2FsMi1jb250YWluZXIuc3dhbDItYm90dG9tLWxlZnQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tc3RhcnR7YWxpZ24taXRlbXM6ZmxleC1lbmQ7anVzdGlmeS1jb250ZW50OmZsZXgtc3RhcnR9LnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tZW5kLC5zd2FsMi1jb250YWluZXIuc3dhbDItYm90dG9tLXJpZ2h0e2FsaWduLWl0ZW1zOmZsZXgtZW5kO2p1c3RpZnktY29udGVudDpmbGV4LWVuZH0uc3dhbDItY29udGFpbmVyLnN3YWwyLWJvdHRvbS1lbmQ+OmZpcnN0LWNoaWxkLC5zd2FsMi1jb250YWluZXIuc3dhbDItYm90dG9tLWxlZnQ+OmZpcnN0LWNoaWxkLC5zd2FsMi1jb250YWluZXIuc3dhbDItYm90dG9tLXJpZ2h0PjpmaXJzdC1jaGlsZCwuc3dhbDItY29udGFpbmVyLnN3YWwyLWJvdHRvbS1zdGFydD46Zmlyc3QtY2hpbGQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20+OmZpcnN0LWNoaWxke21hcmdpbi10b3A6YXV0b30uc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctZnVsbHNjcmVlbj4uc3dhbDItbW9kYWx7ZGlzcGxheTpmbGV4IWltcG9ydGFudDtmbGV4OjE7YWxpZ24tc2VsZjpzdHJldGNoO2p1c3RpZnktY29udGVudDpjZW50ZXJ9LnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LXJvdz4uc3dhbDItbW9kYWx7ZGlzcGxheTpmbGV4IWltcG9ydGFudDtmbGV4OjE7YWxpZ24tY29udGVudDpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcn0uc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctY29sdW1ue2ZsZXg6MTtmbGV4LWRpcmVjdGlvbjpjb2x1bW59LnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LWNvbHVtbi5zd2FsMi1ib3R0b20sLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LWNvbHVtbi5zd2FsMi1jZW50ZXIsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LWNvbHVtbi5zd2FsMi10b3B7YWxpZ24taXRlbXM6Y2VudGVyfS5zd2FsMi1jb250YWluZXIuc3dhbDItZ3Jvdy1jb2x1bW4uc3dhbDItYm90dG9tLWxlZnQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LWNvbHVtbi5zd2FsMi1ib3R0b20tc3RhcnQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LWNvbHVtbi5zd2FsMi1jZW50ZXItbGVmdCwuc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctY29sdW1uLnN3YWwyLWNlbnRlci1zdGFydCwuc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctY29sdW1uLnN3YWwyLXRvcC1sZWZ0LC5zd2FsMi1jb250YWluZXIuc3dhbDItZ3Jvdy1jb2x1bW4uc3dhbDItdG9wLXN0YXJ0e2FsaWduLWl0ZW1zOmZsZXgtc3RhcnR9LnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LWNvbHVtbi5zd2FsMi1ib3R0b20tZW5kLC5zd2FsMi1jb250YWluZXIuc3dhbDItZ3Jvdy1jb2x1bW4uc3dhbDItYm90dG9tLXJpZ2h0LC5zd2FsMi1jb250YWluZXIuc3dhbDItZ3Jvdy1jb2x1bW4uc3dhbDItY2VudGVyLWVuZCwuc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctY29sdW1uLnN3YWwyLWNlbnRlci1yaWdodCwuc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctY29sdW1uLnN3YWwyLXRvcC1lbmQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LWNvbHVtbi5zd2FsMi10b3AtcmlnaHR7YWxpZ24taXRlbXM6ZmxleC1lbmR9LnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LWNvbHVtbj4uc3dhbDItbW9kYWx7ZGlzcGxheTpmbGV4IWltcG9ydGFudDtmbGV4OjE7YWxpZ24tY29udGVudDpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcn0uc3dhbDItY29udGFpbmVyLnN3YWwyLW5vLXRyYW5zaXRpb257dHJhbnNpdGlvbjpub25lIWltcG9ydGFudH0uc3dhbDItY29udGFpbmVyOm5vdCguc3dhbDItdG9wKTpub3QoLnN3YWwyLXRvcC1zdGFydCk6bm90KC5zd2FsMi10b3AtZW5kKTpub3QoLnN3YWwyLXRvcC1sZWZ0KTpub3QoLnN3YWwyLXRvcC1yaWdodCk6bm90KC5zd2FsMi1jZW50ZXItc3RhcnQpOm5vdCguc3dhbDItY2VudGVyLWVuZCk6bm90KC5zd2FsMi1jZW50ZXItbGVmdCk6bm90KC5zd2FsMi1jZW50ZXItcmlnaHQpOm5vdCguc3dhbDItYm90dG9tKTpub3QoLnN3YWwyLWJvdHRvbS1zdGFydCk6bm90KC5zd2FsMi1ib3R0b20tZW5kKTpub3QoLnN3YWwyLWJvdHRvbS1sZWZ0KTpub3QoLnN3YWwyLWJvdHRvbS1yaWdodCk6bm90KC5zd2FsMi1ncm93LWZ1bGxzY3JlZW4pPi5zd2FsMi1tb2RhbHttYXJnaW46YXV0b31AbWVkaWEgYWxsIGFuZCAoLW1zLWhpZ2gtY29udHJhc3Q6bm9uZSksKC1tcy1oaWdoLWNvbnRyYXN0OmFjdGl2ZSl7LnN3YWwyLWNvbnRhaW5lciAuc3dhbDItbW9kYWx7bWFyZ2luOjAhaW1wb3J0YW50fX0uc3dhbDItcG9wdXB7ZGlzcGxheTpub25lO3Bvc2l0aW9uOnJlbGF0aXZlO2JveC1zaXppbmc6Ym9yZGVyLWJveDtmbGV4LWRpcmVjdGlvbjpjb2x1bW47anVzdGlmeS1jb250ZW50OmNlbnRlcjt3aWR0aDozMmVtO21heC13aWR0aDoxMDAlO3BhZGRpbmc6MS4yNWVtO2JvcmRlcjpub25lO2JvcmRlci1yYWRpdXM6NXB4O2JhY2tncm91bmQ6I2ZmZjtmb250LWZhbWlseTppbmhlcml0O2ZvbnQtc2l6ZToxcmVtfS5zd2FsMi1wb3B1cDpmb2N1c3tvdXRsaW5lOjB9LnN3YWwyLXBvcHVwLnN3YWwyLWxvYWRpbmd7b3ZlcmZsb3cteTpoaWRkZW59LnN3YWwyLWhlYWRlcntkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2FsaWduLWl0ZW1zOmNlbnRlcjtwYWRkaW5nOjAgMS44ZW19LnN3YWwyLXRpdGxle3Bvc2l0aW9uOnJlbGF0aXZlO21heC13aWR0aDoxMDAlO21hcmdpbjowIDAgLjRlbTtwYWRkaW5nOjA7Y29sb3I6IzU5NTk1OTtmb250LXNpemU6MS44NzVlbTtmb250LXdlaWdodDo2MDA7dGV4dC1hbGlnbjpjZW50ZXI7dGV4dC10cmFuc2Zvcm06bm9uZTt3b3JkLXdyYXA6YnJlYWstd29yZH0uc3dhbDItYWN0aW9uc3tkaXNwbGF5OmZsZXg7ei1pbmRleDoxO2JveC1zaXppbmc6Ym9yZGVyLWJveDtmbGV4LXdyYXA6d3JhcDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjt3aWR0aDoxMDAlO21hcmdpbjoxLjI1ZW0gYXV0byAwO3BhZGRpbmc6MH0uc3dhbDItYWN0aW9uczpub3QoLnN3YWwyLWxvYWRpbmcpIC5zd2FsMi1zdHlsZWRbZGlzYWJsZWRde29wYWNpdHk6LjR9LnN3YWwyLWFjdGlvbnM6bm90KC5zd2FsMi1sb2FkaW5nKSAuc3dhbDItc3R5bGVkOmhvdmVye2JhY2tncm91bmQtaW1hZ2U6bGluZWFyLWdyYWRpZW50KHJnYmEoMCwwLDAsLjEpLHJnYmEoMCwwLDAsLjEpKX0uc3dhbDItYWN0aW9uczpub3QoLnN3YWwyLWxvYWRpbmcpIC5zd2FsMi1zdHlsZWQ6YWN0aXZle2JhY2tncm91bmQtaW1hZ2U6bGluZWFyLWdyYWRpZW50KHJnYmEoMCwwLDAsLjIpLHJnYmEoMCwwLDAsLjIpKX0uc3dhbDItbG9hZGVye2Rpc3BsYXk6bm9uZTthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjt3aWR0aDoyLjJlbTtoZWlnaHQ6Mi4yZW07bWFyZ2luOjAgMS44NzVlbTstd2Via2l0LWFuaW1hdGlvbjpzd2FsMi1yb3RhdGUtbG9hZGluZyAxLjVzIGxpbmVhciAwcyBpbmZpbml0ZSBub3JtYWw7YW5pbWF0aW9uOnN3YWwyLXJvdGF0ZS1sb2FkaW5nIDEuNXMgbGluZWFyIDBzIGluZmluaXRlIG5vcm1hbDtib3JkZXItd2lkdGg6LjI1ZW07Ym9yZGVyLXN0eWxlOnNvbGlkO2JvcmRlci1yYWRpdXM6MTAwJTtib3JkZXItY29sb3I6IzI3NzhjNCB0cmFuc3BhcmVudCAjMjc3OGM0IHRyYW5zcGFyZW50fS5zd2FsMi1zdHlsZWR7bWFyZ2luOi4zMTI1ZW07cGFkZGluZzouNjI1ZW0gMS4xZW07Ym94LXNoYWRvdzpub25lO2ZvbnQtd2VpZ2h0OjUwMH0uc3dhbDItc3R5bGVkOm5vdChbZGlzYWJsZWRdKXtjdXJzb3I6cG9pbnRlcn0uc3dhbDItc3R5bGVkLnN3YWwyLWNvbmZpcm17Ym9yZGVyOjA7Ym9yZGVyLXJhZGl1czouMjVlbTtiYWNrZ3JvdW5kOmluaXRpYWw7YmFja2dyb3VuZC1jb2xvcjojMjc3OGM0O2NvbG9yOiNmZmY7Zm9udC1zaXplOjFlbX0uc3dhbDItc3R5bGVkLnN3YWwyLWRlbnl7Ym9yZGVyOjA7Ym9yZGVyLXJhZGl1czouMjVlbTtiYWNrZ3JvdW5kOmluaXRpYWw7YmFja2dyb3VuZC1jb2xvcjojZDE0NTI5O2NvbG9yOiNmZmY7Zm9udC1zaXplOjFlbX0uc3dhbDItc3R5bGVkLnN3YWwyLWNhbmNlbHtib3JkZXI6MDtib3JkZXItcmFkaXVzOi4yNWVtO2JhY2tncm91bmQ6aW5pdGlhbDtiYWNrZ3JvdW5kLWNvbG9yOiM3NTc1NzU7Y29sb3I6I2ZmZjtmb250LXNpemU6MWVtfS5zd2FsMi1zdHlsZWQ6Zm9jdXN7b3V0bGluZTowO2JveC1zaGFkb3c6MCAwIDAgM3B4IHJnYmEoMTAwLDE1MCwyMDAsLjUpfS5zd2FsMi1zdHlsZWQ6Oi1tb3otZm9jdXMtaW5uZXJ7Ym9yZGVyOjB9LnN3YWwyLWZvb3RlcntqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO21hcmdpbjoxLjI1ZW0gMCAwO3BhZGRpbmc6MWVtIDAgMDtib3JkZXItdG9wOjFweCBzb2xpZCAjZWVlO2NvbG9yOiM1NDU0NTQ7Zm9udC1zaXplOjFlbX0uc3dhbDItdGltZXItcHJvZ3Jlc3MtYmFyLWNvbnRhaW5lcntwb3NpdGlvbjphYnNvbHV0ZTtyaWdodDowO2JvdHRvbTowO2xlZnQ6MDtoZWlnaHQ6LjI1ZW07b3ZlcmZsb3c6aGlkZGVuO2JvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOjVweDtib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzOjVweH0uc3dhbDItdGltZXItcHJvZ3Jlc3MtYmFye3dpZHRoOjEwMCU7aGVpZ2h0Oi4yNWVtO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwuMil9LnN3YWwyLWltYWdle21heC13aWR0aDoxMDAlO21hcmdpbjoxLjI1ZW0gYXV0b30uc3dhbDItY2xvc2V7cG9zaXRpb246YWJzb2x1dGU7ei1pbmRleDoyO3RvcDowO3JpZ2h0OjA7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7d2lkdGg6MS4yZW07aGVpZ2h0OjEuMmVtO3BhZGRpbmc6MDtvdmVyZmxvdzpoaWRkZW47dHJhbnNpdGlvbjpjb2xvciAuMXMgZWFzZS1vdXQ7Ym9yZGVyOm5vbmU7Ym9yZGVyLXJhZGl1czo1cHg7YmFja2dyb3VuZDowIDA7Y29sb3I6I2NjYztmb250LWZhbWlseTpzZXJpZjtmb250LXNpemU6Mi41ZW07bGluZS1oZWlnaHQ6MS4yO2N1cnNvcjpwb2ludGVyfS5zd2FsMi1jbG9zZTpob3Zlcnt0cmFuc2Zvcm06bm9uZTtiYWNrZ3JvdW5kOjAgMDtjb2xvcjojZjI3NDc0fS5zd2FsMi1jbG9zZTpmb2N1c3tvdXRsaW5lOjA7Ym94LXNoYWRvdzppbnNldCAwIDAgMCAzcHggcmdiYSgxMDAsMTUwLDIwMCwuNSl9LnN3YWwyLWNsb3NlOjotbW96LWZvY3VzLWlubmVye2JvcmRlcjowfS5zd2FsMi1jb250ZW50e3otaW5kZXg6MTtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO21hcmdpbjowO3BhZGRpbmc6MCAxLjZlbTtjb2xvcjojNTQ1NDU0O2ZvbnQtc2l6ZToxLjEyNWVtO2ZvbnQtd2VpZ2h0OjQwMDtsaW5lLWhlaWdodDpub3JtYWw7dGV4dC1hbGlnbjpjZW50ZXI7d29yZC13cmFwOmJyZWFrLXdvcmR9LnN3YWwyLWNoZWNrYm94LC5zd2FsMi1maWxlLC5zd2FsMi1pbnB1dCwuc3dhbDItcmFkaW8sLnN3YWwyLXNlbGVjdCwuc3dhbDItdGV4dGFyZWF7bWFyZ2luOjFlbSBhdXRvfS5zd2FsMi1maWxlLC5zd2FsMi1pbnB1dCwuc3dhbDItdGV4dGFyZWF7Ym94LXNpemluZzpib3JkZXItYm94O3dpZHRoOjEwMCU7dHJhbnNpdGlvbjpib3JkZXItY29sb3IgLjNzLGJveC1zaGFkb3cgLjNzO2JvcmRlcjoxcHggc29saWQgI2Q5ZDlkOTtib3JkZXItcmFkaXVzOi4xODc1ZW07YmFja2dyb3VuZDppbmhlcml0O2JveC1zaGFkb3c6aW5zZXQgMCAxcHggMXB4IHJnYmEoMCwwLDAsLjA2KTtjb2xvcjppbmhlcml0O2ZvbnQtc2l6ZToxLjEyNWVtfS5zd2FsMi1maWxlLnN3YWwyLWlucHV0ZXJyb3IsLnN3YWwyLWlucHV0LnN3YWwyLWlucHV0ZXJyb3IsLnN3YWwyLXRleHRhcmVhLnN3YWwyLWlucHV0ZXJyb3J7Ym9yZGVyLWNvbG9yOiNmMjc0NzQhaW1wb3J0YW50O2JveC1zaGFkb3c6MCAwIDJweCAjZjI3NDc0IWltcG9ydGFudH0uc3dhbDItZmlsZTpmb2N1cywuc3dhbDItaW5wdXQ6Zm9jdXMsLnN3YWwyLXRleHRhcmVhOmZvY3Vze2JvcmRlcjoxcHggc29saWQgI2I0ZGJlZDtvdXRsaW5lOjA7Ym94LXNoYWRvdzowIDAgMCAzcHggcmdiYSgxMDAsMTUwLDIwMCwuNSl9LnN3YWwyLWZpbGU6Oi1tb3otcGxhY2Vob2xkZXIsLnN3YWwyLWlucHV0OjotbW96LXBsYWNlaG9sZGVyLC5zd2FsMi10ZXh0YXJlYTo6LW1vei1wbGFjZWhvbGRlcntjb2xvcjojY2NjfS5zd2FsMi1maWxlOi1tcy1pbnB1dC1wbGFjZWhvbGRlciwuc3dhbDItaW5wdXQ6LW1zLWlucHV0LXBsYWNlaG9sZGVyLC5zd2FsMi10ZXh0YXJlYTotbXMtaW5wdXQtcGxhY2Vob2xkZXJ7Y29sb3I6I2NjY30uc3dhbDItZmlsZTo6cGxhY2Vob2xkZXIsLnN3YWwyLWlucHV0OjpwbGFjZWhvbGRlciwuc3dhbDItdGV4dGFyZWE6OnBsYWNlaG9sZGVye2NvbG9yOiNjY2N9LnN3YWwyLXJhbmdle21hcmdpbjoxZW0gYXV0bztiYWNrZ3JvdW5kOiNmZmZ9LnN3YWwyLXJhbmdlIGlucHV0e3dpZHRoOjgwJX0uc3dhbDItcmFuZ2Ugb3V0cHV0e3dpZHRoOjIwJTtjb2xvcjppbmhlcml0O2ZvbnQtd2VpZ2h0OjYwMDt0ZXh0LWFsaWduOmNlbnRlcn0uc3dhbDItcmFuZ2UgaW5wdXQsLnN3YWwyLXJhbmdlIG91dHB1dHtoZWlnaHQ6Mi42MjVlbTtwYWRkaW5nOjA7Zm9udC1zaXplOjEuMTI1ZW07bGluZS1oZWlnaHQ6Mi42MjVlbX0uc3dhbDItaW5wdXR7aGVpZ2h0OjIuNjI1ZW07cGFkZGluZzowIC43NWVtfS5zd2FsMi1pbnB1dFt0eXBlPW51bWJlcl17bWF4LXdpZHRoOjEwZW19LnN3YWwyLWZpbGV7YmFja2dyb3VuZDppbmhlcml0O2ZvbnQtc2l6ZToxLjEyNWVtfS5zd2FsMi10ZXh0YXJlYXtoZWlnaHQ6Ni43NWVtO3BhZGRpbmc6Ljc1ZW19LnN3YWwyLXNlbGVjdHttaW4td2lkdGg6NTAlO21heC13aWR0aDoxMDAlO3BhZGRpbmc6LjM3NWVtIC42MjVlbTtiYWNrZ3JvdW5kOmluaGVyaXQ7Y29sb3I6aW5oZXJpdDtmb250LXNpemU6MS4xMjVlbX0uc3dhbDItY2hlY2tib3gsLnN3YWwyLXJhZGlve2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2JhY2tncm91bmQ6I2ZmZjtjb2xvcjppbmhlcml0fS5zd2FsMi1jaGVja2JveCBsYWJlbCwuc3dhbDItcmFkaW8gbGFiZWx7bWFyZ2luOjAgLjZlbTtmb250LXNpemU6MS4xMjVlbX0uc3dhbDItY2hlY2tib3ggaW5wdXQsLnN3YWwyLXJhZGlvIGlucHV0e2ZsZXgtc2hyaW5rOjA7bWFyZ2luOjAgLjRlbX0uc3dhbDItaW5wdXQtbGFiZWx7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpjZW50ZXI7bWFyZ2luOjFlbSBhdXRvfS5zd2FsMi12YWxpZGF0aW9uLW1lc3NhZ2V7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7bWFyZ2luOjAgLTIuN2VtO3BhZGRpbmc6LjYyNWVtO292ZXJmbG93OmhpZGRlbjtiYWNrZ3JvdW5kOiNmMGYwZjA7Y29sb3I6IzY2Njtmb250LXNpemU6MWVtO2ZvbnQtd2VpZ2h0OjMwMH0uc3dhbDItdmFsaWRhdGlvbi1tZXNzYWdlOjpiZWZvcmV7Y29udGVudDpcIiFcIjtkaXNwbGF5OmlubGluZS1ibG9jazt3aWR0aDoxLjVlbTttaW4td2lkdGg6MS41ZW07aGVpZ2h0OjEuNWVtO21hcmdpbjowIC42MjVlbTtib3JkZXItcmFkaXVzOjUwJTtiYWNrZ3JvdW5kLWNvbG9yOiNmMjc0NzQ7Y29sb3I6I2ZmZjtmb250LXdlaWdodDo2MDA7bGluZS1oZWlnaHQ6MS41ZW07dGV4dC1hbGlnbjpjZW50ZXJ9LnN3YWwyLWljb257cG9zaXRpb246cmVsYXRpdmU7Ym94LXNpemluZzpjb250ZW50LWJveDtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO3dpZHRoOjVlbTtoZWlnaHQ6NWVtO21hcmdpbjoxLjI1ZW0gYXV0byAxLjg3NWVtO2JvcmRlcjouMjVlbSBzb2xpZCB0cmFuc3BhcmVudDtib3JkZXItcmFkaXVzOjUwJTtib3JkZXItY29sb3I6IzAwMDtmb250LWZhbWlseTppbmhlcml0O2xpbmUtaGVpZ2h0OjVlbTtjdXJzb3I6ZGVmYXVsdDstd2Via2l0LXVzZXItc2VsZWN0Om5vbmU7LW1vei11c2VyLXNlbGVjdDpub25lOy1tcy11c2VyLXNlbGVjdDpub25lO3VzZXItc2VsZWN0Om5vbmV9LnN3YWwyLWljb24gLnN3YWwyLWljb24tY29udGVudHtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2ZvbnQtc2l6ZTozLjc1ZW19LnN3YWwyLWljb24uc3dhbDItZXJyb3J7Ym9yZGVyLWNvbG9yOiNmMjc0NzQ7Y29sb3I6I2YyNzQ3NH0uc3dhbDItaWNvbi5zd2FsMi1lcnJvciAuc3dhbDIteC1tYXJre3Bvc2l0aW9uOnJlbGF0aXZlO2ZsZXgtZ3JvdzoxfS5zd2FsMi1pY29uLnN3YWwyLWVycm9yIFtjbGFzc149c3dhbDIteC1tYXJrLWxpbmVde2Rpc3BsYXk6YmxvY2s7cG9zaXRpb246YWJzb2x1dGU7dG9wOjIuMzEyNWVtO3dpZHRoOjIuOTM3NWVtO2hlaWdodDouMzEyNWVtO2JvcmRlci1yYWRpdXM6LjEyNWVtO2JhY2tncm91bmQtY29sb3I6I2YyNzQ3NH0uc3dhbDItaWNvbi5zd2FsMi1lcnJvciBbY2xhc3NePXN3YWwyLXgtbWFyay1saW5lXVtjbGFzcyQ9bGVmdF17bGVmdDoxLjA2MjVlbTt0cmFuc2Zvcm06cm90YXRlKDQ1ZGVnKX0uc3dhbDItaWNvbi5zd2FsMi1lcnJvciBbY2xhc3NePXN3YWwyLXgtbWFyay1saW5lXVtjbGFzcyQ9cmlnaHRde3JpZ2h0OjFlbTt0cmFuc2Zvcm06cm90YXRlKC00NWRlZyl9LnN3YWwyLWljb24uc3dhbDItZXJyb3Iuc3dhbDItaWNvbi1zaG93ey13ZWJraXQtYW5pbWF0aW9uOnN3YWwyLWFuaW1hdGUtZXJyb3ItaWNvbiAuNXM7YW5pbWF0aW9uOnN3YWwyLWFuaW1hdGUtZXJyb3ItaWNvbiAuNXN9LnN3YWwyLWljb24uc3dhbDItZXJyb3Iuc3dhbDItaWNvbi1zaG93IC5zd2FsMi14LW1hcmt7LXdlYmtpdC1hbmltYXRpb246c3dhbDItYW5pbWF0ZS1lcnJvci14LW1hcmsgLjVzO2FuaW1hdGlvbjpzd2FsMi1hbmltYXRlLWVycm9yLXgtbWFyayAuNXN9LnN3YWwyLWljb24uc3dhbDItd2FybmluZ3tib3JkZXItY29sb3I6I2ZhY2VhODtjb2xvcjojZjhiYjg2fS5zd2FsMi1pY29uLnN3YWwyLWluZm97Ym9yZGVyLWNvbG9yOiM5ZGUwZjY7Y29sb3I6IzNmYzNlZX0uc3dhbDItaWNvbi5zd2FsMi1xdWVzdGlvbntib3JkZXItY29sb3I6I2M5ZGFlMTtjb2xvcjojODdhZGJkfS5zd2FsMi1pY29uLnN3YWwyLXN1Y2Nlc3N7Ym9yZGVyLWNvbG9yOiNhNWRjODY7Y29sb3I6I2E1ZGM4Nn0uc3dhbDItaWNvbi5zd2FsMi1zdWNjZXNzIFtjbGFzc149c3dhbDItc3VjY2Vzcy1jaXJjdWxhci1saW5lXXtwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDozLjc1ZW07aGVpZ2h0OjcuNWVtO3RyYW5zZm9ybTpyb3RhdGUoNDVkZWcpO2JvcmRlci1yYWRpdXM6NTAlfS5zd2FsMi1pY29uLnN3YWwyLXN1Y2Nlc3MgW2NsYXNzXj1zd2FsMi1zdWNjZXNzLWNpcmN1bGFyLWxpbmVdW2NsYXNzJD1sZWZ0XXt0b3A6LS40Mzc1ZW07bGVmdDotMi4wNjM1ZW07dHJhbnNmb3JtOnJvdGF0ZSgtNDVkZWcpO3RyYW5zZm9ybS1vcmlnaW46My43NWVtIDMuNzVlbTtib3JkZXItcmFkaXVzOjcuNWVtIDAgMCA3LjVlbX0uc3dhbDItaWNvbi5zd2FsMi1zdWNjZXNzIFtjbGFzc149c3dhbDItc3VjY2Vzcy1jaXJjdWxhci1saW5lXVtjbGFzcyQ9cmlnaHRde3RvcDotLjY4NzVlbTtsZWZ0OjEuODc1ZW07dHJhbnNmb3JtOnJvdGF0ZSgtNDVkZWcpO3RyYW5zZm9ybS1vcmlnaW46MCAzLjc1ZW07Ym9yZGVyLXJhZGl1czowIDcuNWVtIDcuNWVtIDB9LnN3YWwyLWljb24uc3dhbDItc3VjY2VzcyAuc3dhbDItc3VjY2Vzcy1yaW5ne3Bvc2l0aW9uOmFic29sdXRlO3otaW5kZXg6Mjt0b3A6LS4yNWVtO2xlZnQ6LS4yNWVtO2JveC1zaXppbmc6Y29udGVudC1ib3g7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtib3JkZXI6LjI1ZW0gc29saWQgcmdiYSgxNjUsMjIwLDEzNCwuMyk7Ym9yZGVyLXJhZGl1czo1MCV9LnN3YWwyLWljb24uc3dhbDItc3VjY2VzcyAuc3dhbDItc3VjY2Vzcy1maXh7cG9zaXRpb246YWJzb2x1dGU7ei1pbmRleDoxO3RvcDouNWVtO2xlZnQ6MS42MjVlbTt3aWR0aDouNDM3NWVtO2hlaWdodDo1LjYyNWVtO3RyYW5zZm9ybTpyb3RhdGUoLTQ1ZGVnKX0uc3dhbDItaWNvbi5zd2FsMi1zdWNjZXNzIFtjbGFzc149c3dhbDItc3VjY2Vzcy1saW5lXXtkaXNwbGF5OmJsb2NrO3Bvc2l0aW9uOmFic29sdXRlO3otaW5kZXg6MjtoZWlnaHQ6LjMxMjVlbTtib3JkZXItcmFkaXVzOi4xMjVlbTtiYWNrZ3JvdW5kLWNvbG9yOiNhNWRjODZ9LnN3YWwyLWljb24uc3dhbDItc3VjY2VzcyBbY2xhc3NePXN3YWwyLXN1Y2Nlc3MtbGluZV1bY2xhc3MkPXRpcF17dG9wOjIuODc1ZW07bGVmdDouODEyNWVtO3dpZHRoOjEuNTYyNWVtO3RyYW5zZm9ybTpyb3RhdGUoNDVkZWcpfS5zd2FsMi1pY29uLnN3YWwyLXN1Y2Nlc3MgW2NsYXNzXj1zd2FsMi1zdWNjZXNzLWxpbmVdW2NsYXNzJD1sb25nXXt0b3A6Mi4zNzVlbTtyaWdodDouNWVtO3dpZHRoOjIuOTM3NWVtO3RyYW5zZm9ybTpyb3RhdGUoLTQ1ZGVnKX0uc3dhbDItaWNvbi5zd2FsMi1zdWNjZXNzLnN3YWwyLWljb24tc2hvdyAuc3dhbDItc3VjY2Vzcy1saW5lLXRpcHstd2Via2l0LWFuaW1hdGlvbjpzd2FsMi1hbmltYXRlLXN1Y2Nlc3MtbGluZS10aXAgLjc1czthbmltYXRpb246c3dhbDItYW5pbWF0ZS1zdWNjZXNzLWxpbmUtdGlwIC43NXN9LnN3YWwyLWljb24uc3dhbDItc3VjY2Vzcy5zd2FsMi1pY29uLXNob3cgLnN3YWwyLXN1Y2Nlc3MtbGluZS1sb25ney13ZWJraXQtYW5pbWF0aW9uOnN3YWwyLWFuaW1hdGUtc3VjY2Vzcy1saW5lLWxvbmcgLjc1czthbmltYXRpb246c3dhbDItYW5pbWF0ZS1zdWNjZXNzLWxpbmUtbG9uZyAuNzVzfS5zd2FsMi1pY29uLnN3YWwyLXN1Y2Nlc3Muc3dhbDItaWNvbi1zaG93IC5zd2FsMi1zdWNjZXNzLWNpcmN1bGFyLWxpbmUtcmlnaHR7LXdlYmtpdC1hbmltYXRpb246c3dhbDItcm90YXRlLXN1Y2Nlc3MtY2lyY3VsYXItbGluZSA0LjI1cyBlYXNlLWluO2FuaW1hdGlvbjpzd2FsMi1yb3RhdGUtc3VjY2Vzcy1jaXJjdWxhci1saW5lIDQuMjVzIGVhc2UtaW59LnN3YWwyLXByb2dyZXNzLXN0ZXBze2ZsZXgtd3JhcDp3cmFwO2FsaWduLWl0ZW1zOmNlbnRlcjttYXgtd2lkdGg6MTAwJTttYXJnaW46MCAwIDEuMjVlbTtwYWRkaW5nOjA7YmFja2dyb3VuZDppbmhlcml0O2ZvbnQtd2VpZ2h0OjYwMH0uc3dhbDItcHJvZ3Jlc3Mtc3RlcHMgbGl7ZGlzcGxheTppbmxpbmUtYmxvY2s7cG9zaXRpb246cmVsYXRpdmV9LnN3YWwyLXByb2dyZXNzLXN0ZXBzIC5zd2FsMi1wcm9ncmVzcy1zdGVwe3otaW5kZXg6MjA7ZmxleC1zaHJpbms6MDt3aWR0aDoyZW07aGVpZ2h0OjJlbTtib3JkZXItcmFkaXVzOjJlbTtiYWNrZ3JvdW5kOiMyNzc4YzQ7Y29sb3I6I2ZmZjtsaW5lLWhlaWdodDoyZW07dGV4dC1hbGlnbjpjZW50ZXJ9LnN3YWwyLXByb2dyZXNzLXN0ZXBzIC5zd2FsMi1wcm9ncmVzcy1zdGVwLnN3YWwyLWFjdGl2ZS1wcm9ncmVzcy1zdGVwe2JhY2tncm91bmQ6IzI3NzhjNH0uc3dhbDItcHJvZ3Jlc3Mtc3RlcHMgLnN3YWwyLXByb2dyZXNzLXN0ZXAuc3dhbDItYWN0aXZlLXByb2dyZXNzLXN0ZXB+LnN3YWwyLXByb2dyZXNzLXN0ZXB7YmFja2dyb3VuZDojYWRkOGU2O2NvbG9yOiNmZmZ9LnN3YWwyLXByb2dyZXNzLXN0ZXBzIC5zd2FsMi1wcm9ncmVzcy1zdGVwLnN3YWwyLWFjdGl2ZS1wcm9ncmVzcy1zdGVwfi5zd2FsMi1wcm9ncmVzcy1zdGVwLWxpbmV7YmFja2dyb3VuZDojYWRkOGU2fS5zd2FsMi1wcm9ncmVzcy1zdGVwcyAuc3dhbDItcHJvZ3Jlc3Mtc3RlcC1saW5le3otaW5kZXg6MTA7ZmxleC1zaHJpbms6MDt3aWR0aDoyLjVlbTtoZWlnaHQ6LjRlbTttYXJnaW46MCAtMXB4O2JhY2tncm91bmQ6IzI3NzhjNH1bY2xhc3NePXN3YWwyXXstd2Via2l0LXRhcC1oaWdobGlnaHQtY29sb3I6dHJhbnNwYXJlbnR9LnN3YWwyLXNob3d7LXdlYmtpdC1hbmltYXRpb246c3dhbDItc2hvdyAuM3M7YW5pbWF0aW9uOnN3YWwyLXNob3cgLjNzfS5zd2FsMi1oaWRley13ZWJraXQtYW5pbWF0aW9uOnN3YWwyLWhpZGUgLjE1cyBmb3J3YXJkczthbmltYXRpb246c3dhbDItaGlkZSAuMTVzIGZvcndhcmRzfS5zd2FsMi1ub2FuaW1hdGlvbnt0cmFuc2l0aW9uOm5vbmV9LnN3YWwyLXNjcm9sbGJhci1tZWFzdXJle3Bvc2l0aW9uOmFic29sdXRlO3RvcDotOTk5OXB4O3dpZHRoOjUwcHg7aGVpZ2h0OjUwcHg7b3ZlcmZsb3c6c2Nyb2xsfS5zd2FsMi1ydGwgLnN3YWwyLWNsb3Nle3JpZ2h0OmF1dG87bGVmdDowfS5zd2FsMi1ydGwgLnN3YWwyLXRpbWVyLXByb2dyZXNzLWJhcntyaWdodDowO2xlZnQ6YXV0b31Ac3VwcG9ydHMgKC1tcy1hY2NlbGVyYXRvcjp0cnVlKXsuc3dhbDItcmFuZ2UgaW5wdXR7d2lkdGg6MTAwJSFpbXBvcnRhbnR9LnN3YWwyLXJhbmdlIG91dHB1dHtkaXNwbGF5Om5vbmV9fUBtZWRpYSBhbGwgYW5kICgtbXMtaGlnaC1jb250cmFzdDpub25lKSwoLW1zLWhpZ2gtY29udHJhc3Q6YWN0aXZlKXsuc3dhbDItcmFuZ2UgaW5wdXR7d2lkdGg6MTAwJSFpbXBvcnRhbnR9LnN3YWwyLXJhbmdlIG91dHB1dHtkaXNwbGF5Om5vbmV9fUAtd2Via2l0LWtleWZyYW1lcyBzd2FsMi10b2FzdC1zaG93ezAle3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0uNjI1ZW0pIHJvdGF0ZVooMmRlZyl9MzMle3RyYW5zZm9ybTp0cmFuc2xhdGVZKDApIHJvdGF0ZVooLTJkZWcpfTY2JXt0cmFuc2Zvcm06dHJhbnNsYXRlWSguMzEyNWVtKSByb3RhdGVaKDJkZWcpfTEwMCV7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCkgcm90YXRlWigwKX19QGtleWZyYW1lcyBzd2FsMi10b2FzdC1zaG93ezAle3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0uNjI1ZW0pIHJvdGF0ZVooMmRlZyl9MzMle3RyYW5zZm9ybTp0cmFuc2xhdGVZKDApIHJvdGF0ZVooLTJkZWcpfTY2JXt0cmFuc2Zvcm06dHJhbnNsYXRlWSguMzEyNWVtKSByb3RhdGVaKDJkZWcpfTEwMCV7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCkgcm90YXRlWigwKX19QC13ZWJraXQta2V5ZnJhbWVzIHN3YWwyLXRvYXN0LWhpZGV7MTAwJXt0cmFuc2Zvcm06cm90YXRlWigxZGVnKTtvcGFjaXR5OjB9fUBrZXlmcmFtZXMgc3dhbDItdG9hc3QtaGlkZXsxMDAle3RyYW5zZm9ybTpyb3RhdGVaKDFkZWcpO29wYWNpdHk6MH19QC13ZWJraXQta2V5ZnJhbWVzIHN3YWwyLXRvYXN0LWFuaW1hdGUtc3VjY2Vzcy1saW5lLXRpcHswJXt0b3A6LjU2MjVlbTtsZWZ0Oi4wNjI1ZW07d2lkdGg6MH01NCV7dG9wOi4xMjVlbTtsZWZ0Oi4xMjVlbTt3aWR0aDowfTcwJXt0b3A6LjYyNWVtO2xlZnQ6LS4yNWVtO3dpZHRoOjEuNjI1ZW19ODQle3RvcDoxLjA2MjVlbTtsZWZ0Oi43NWVtO3dpZHRoOi41ZW19MTAwJXt0b3A6MS4xMjVlbTtsZWZ0Oi4xODc1ZW07d2lkdGg6Ljc1ZW19fUBrZXlmcmFtZXMgc3dhbDItdG9hc3QtYW5pbWF0ZS1zdWNjZXNzLWxpbmUtdGlwezAle3RvcDouNTYyNWVtO2xlZnQ6LjA2MjVlbTt3aWR0aDowfTU0JXt0b3A6LjEyNWVtO2xlZnQ6LjEyNWVtO3dpZHRoOjB9NzAle3RvcDouNjI1ZW07bGVmdDotLjI1ZW07d2lkdGg6MS42MjVlbX04NCV7dG9wOjEuMDYyNWVtO2xlZnQ6Ljc1ZW07d2lkdGg6LjVlbX0xMDAle3RvcDoxLjEyNWVtO2xlZnQ6LjE4NzVlbTt3aWR0aDouNzVlbX19QC13ZWJraXQta2V5ZnJhbWVzIHN3YWwyLXRvYXN0LWFuaW1hdGUtc3VjY2Vzcy1saW5lLWxvbmd7MCV7dG9wOjEuNjI1ZW07cmlnaHQ6MS4zNzVlbTt3aWR0aDowfTY1JXt0b3A6MS4yNWVtO3JpZ2h0Oi45Mzc1ZW07d2lkdGg6MH04NCV7dG9wOi45Mzc1ZW07cmlnaHQ6MDt3aWR0aDoxLjEyNWVtfTEwMCV7dG9wOi45Mzc1ZW07cmlnaHQ6LjE4NzVlbTt3aWR0aDoxLjM3NWVtfX1Aa2V5ZnJhbWVzIHN3YWwyLXRvYXN0LWFuaW1hdGUtc3VjY2Vzcy1saW5lLWxvbmd7MCV7dG9wOjEuNjI1ZW07cmlnaHQ6MS4zNzVlbTt3aWR0aDowfTY1JXt0b3A6MS4yNWVtO3JpZ2h0Oi45Mzc1ZW07d2lkdGg6MH04NCV7dG9wOi45Mzc1ZW07cmlnaHQ6MDt3aWR0aDoxLjEyNWVtfTEwMCV7dG9wOi45Mzc1ZW07cmlnaHQ6LjE4NzVlbTt3aWR0aDoxLjM3NWVtfX1ALXdlYmtpdC1rZXlmcmFtZXMgc3dhbDItc2hvd3swJXt0cmFuc2Zvcm06c2NhbGUoLjcpfTQ1JXt0cmFuc2Zvcm06c2NhbGUoMS4wNSl9ODAle3RyYW5zZm9ybTpzY2FsZSguOTUpfTEwMCV7dHJhbnNmb3JtOnNjYWxlKDEpfX1Aa2V5ZnJhbWVzIHN3YWwyLXNob3d7MCV7dHJhbnNmb3JtOnNjYWxlKC43KX00NSV7dHJhbnNmb3JtOnNjYWxlKDEuMDUpfTgwJXt0cmFuc2Zvcm06c2NhbGUoLjk1KX0xMDAle3RyYW5zZm9ybTpzY2FsZSgxKX19QC13ZWJraXQta2V5ZnJhbWVzIHN3YWwyLWhpZGV7MCV7dHJhbnNmb3JtOnNjYWxlKDEpO29wYWNpdHk6MX0xMDAle3RyYW5zZm9ybTpzY2FsZSguNSk7b3BhY2l0eTowfX1Aa2V5ZnJhbWVzIHN3YWwyLWhpZGV7MCV7dHJhbnNmb3JtOnNjYWxlKDEpO29wYWNpdHk6MX0xMDAle3RyYW5zZm9ybTpzY2FsZSguNSk7b3BhY2l0eTowfX1ALXdlYmtpdC1rZXlmcmFtZXMgc3dhbDItYW5pbWF0ZS1zdWNjZXNzLWxpbmUtdGlwezAle3RvcDoxLjE4NzVlbTtsZWZ0Oi4wNjI1ZW07d2lkdGg6MH01NCV7dG9wOjEuMDYyNWVtO2xlZnQ6LjEyNWVtO3dpZHRoOjB9NzAle3RvcDoyLjE4NzVlbTtsZWZ0Oi0uMzc1ZW07d2lkdGg6My4xMjVlbX04NCV7dG9wOjNlbTtsZWZ0OjEuMzEyNWVtO3dpZHRoOjEuMDYyNWVtfTEwMCV7dG9wOjIuODEyNWVtO2xlZnQ6LjgxMjVlbTt3aWR0aDoxLjU2MjVlbX19QGtleWZyYW1lcyBzd2FsMi1hbmltYXRlLXN1Y2Nlc3MtbGluZS10aXB7MCV7dG9wOjEuMTg3NWVtO2xlZnQ6LjA2MjVlbTt3aWR0aDowfTU0JXt0b3A6MS4wNjI1ZW07bGVmdDouMTI1ZW07d2lkdGg6MH03MCV7dG9wOjIuMTg3NWVtO2xlZnQ6LS4zNzVlbTt3aWR0aDozLjEyNWVtfTg0JXt0b3A6M2VtO2xlZnQ6MS4zMTI1ZW07d2lkdGg6MS4wNjI1ZW19MTAwJXt0b3A6Mi44MTI1ZW07bGVmdDouODEyNWVtO3dpZHRoOjEuNTYyNWVtfX1ALXdlYmtpdC1rZXlmcmFtZXMgc3dhbDItYW5pbWF0ZS1zdWNjZXNzLWxpbmUtbG9uZ3swJXt0b3A6My4zNzVlbTtyaWdodDoyLjg3NWVtO3dpZHRoOjB9NjUle3RvcDozLjM3NWVtO3JpZ2h0OjIuODc1ZW07d2lkdGg6MH04NCV7dG9wOjIuMTg3NWVtO3JpZ2h0OjA7d2lkdGg6My40Mzc1ZW19MTAwJXt0b3A6Mi4zNzVlbTtyaWdodDouNWVtO3dpZHRoOjIuOTM3NWVtfX1Aa2V5ZnJhbWVzIHN3YWwyLWFuaW1hdGUtc3VjY2Vzcy1saW5lLWxvbmd7MCV7dG9wOjMuMzc1ZW07cmlnaHQ6Mi44NzVlbTt3aWR0aDowfTY1JXt0b3A6My4zNzVlbTtyaWdodDoyLjg3NWVtO3dpZHRoOjB9ODQle3RvcDoyLjE4NzVlbTtyaWdodDowO3dpZHRoOjMuNDM3NWVtfTEwMCV7dG9wOjIuMzc1ZW07cmlnaHQ6LjVlbTt3aWR0aDoyLjkzNzVlbX19QC13ZWJraXQta2V5ZnJhbWVzIHN3YWwyLXJvdGF0ZS1zdWNjZXNzLWNpcmN1bGFyLWxpbmV7MCV7dHJhbnNmb3JtOnJvdGF0ZSgtNDVkZWcpfTUle3RyYW5zZm9ybTpyb3RhdGUoLTQ1ZGVnKX0xMiV7dHJhbnNmb3JtOnJvdGF0ZSgtNDA1ZGVnKX0xMDAle3RyYW5zZm9ybTpyb3RhdGUoLTQwNWRlZyl9fUBrZXlmcmFtZXMgc3dhbDItcm90YXRlLXN1Y2Nlc3MtY2lyY3VsYXItbGluZXswJXt0cmFuc2Zvcm06cm90YXRlKC00NWRlZyl9NSV7dHJhbnNmb3JtOnJvdGF0ZSgtNDVkZWcpfTEyJXt0cmFuc2Zvcm06cm90YXRlKC00MDVkZWcpfTEwMCV7dHJhbnNmb3JtOnJvdGF0ZSgtNDA1ZGVnKX19QC13ZWJraXQta2V5ZnJhbWVzIHN3YWwyLWFuaW1hdGUtZXJyb3IteC1tYXJrezAle21hcmdpbi10b3A6MS42MjVlbTt0cmFuc2Zvcm06c2NhbGUoLjQpO29wYWNpdHk6MH01MCV7bWFyZ2luLXRvcDoxLjYyNWVtO3RyYW5zZm9ybTpzY2FsZSguNCk7b3BhY2l0eTowfTgwJXttYXJnaW4tdG9wOi0uMzc1ZW07dHJhbnNmb3JtOnNjYWxlKDEuMTUpfTEwMCV7bWFyZ2luLXRvcDowO3RyYW5zZm9ybTpzY2FsZSgxKTtvcGFjaXR5OjF9fUBrZXlmcmFtZXMgc3dhbDItYW5pbWF0ZS1lcnJvci14LW1hcmt7MCV7bWFyZ2luLXRvcDoxLjYyNWVtO3RyYW5zZm9ybTpzY2FsZSguNCk7b3BhY2l0eTowfTUwJXttYXJnaW4tdG9wOjEuNjI1ZW07dHJhbnNmb3JtOnNjYWxlKC40KTtvcGFjaXR5OjB9ODAle21hcmdpbi10b3A6LS4zNzVlbTt0cmFuc2Zvcm06c2NhbGUoMS4xNSl9MTAwJXttYXJnaW4tdG9wOjA7dHJhbnNmb3JtOnNjYWxlKDEpO29wYWNpdHk6MX19QC13ZWJraXQta2V5ZnJhbWVzIHN3YWwyLWFuaW1hdGUtZXJyb3ItaWNvbnswJXt0cmFuc2Zvcm06cm90YXRlWCgxMDBkZWcpO29wYWNpdHk6MH0xMDAle3RyYW5zZm9ybTpyb3RhdGVYKDApO29wYWNpdHk6MX19QGtleWZyYW1lcyBzd2FsMi1hbmltYXRlLWVycm9yLWljb257MCV7dHJhbnNmb3JtOnJvdGF0ZVgoMTAwZGVnKTtvcGFjaXR5OjB9MTAwJXt0cmFuc2Zvcm06cm90YXRlWCgwKTtvcGFjaXR5OjF9fUAtd2Via2l0LWtleWZyYW1lcyBzd2FsMi1yb3RhdGUtbG9hZGluZ3swJXt0cmFuc2Zvcm06cm90YXRlKDApfTEwMCV7dHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpfX1Aa2V5ZnJhbWVzIHN3YWwyLXJvdGF0ZS1sb2FkaW5nezAle3RyYW5zZm9ybTpyb3RhdGUoMCl9MTAwJXt0cmFuc2Zvcm06cm90YXRlKDM2MGRlZyl9fWJvZHkuc3dhbDItc2hvd246bm90KC5zd2FsMi1uby1iYWNrZHJvcCk6bm90KC5zd2FsMi10b2FzdC1zaG93bil7b3ZlcmZsb3c6aGlkZGVufWJvZHkuc3dhbDItaGVpZ2h0LWF1dG97aGVpZ2h0OmF1dG8haW1wb3J0YW50fWJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lcnt0b3A6YXV0bztyaWdodDphdXRvO2JvdHRvbTphdXRvO2xlZnQ6YXV0bzttYXgtd2lkdGg6Y2FsYygxMDAlIC0gLjYyNWVtICogMik7YmFja2dyb3VuZC1jb2xvcjp0cmFuc3BhcmVudCFpbXBvcnRhbnR9Ym9keS5zd2FsMi1uby1iYWNrZHJvcCAuc3dhbDItY29udGFpbmVyPi5zd2FsMi1tb2RhbHtib3gtc2hhZG93OjAgMCAxMHB4IHJnYmEoMCwwLDAsLjQpfWJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi10b3B7dG9wOjA7bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSl9Ym9keS5zd2FsMi1uby1iYWNrZHJvcCAuc3dhbDItY29udGFpbmVyLnN3YWwyLXRvcC1sZWZ0LGJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi10b3Atc3RhcnR7dG9wOjA7bGVmdDowfWJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi10b3AtZW5kLGJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi10b3AtcmlnaHR7dG9wOjA7cmlnaHQ6MH1ib2R5LnN3YWwyLW5vLWJhY2tkcm9wIC5zd2FsMi1jb250YWluZXIuc3dhbDItY2VudGVye3RvcDo1MCU7bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZSgtNTAlLC01MCUpfWJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1jZW50ZXItbGVmdCxib2R5LnN3YWwyLW5vLWJhY2tkcm9wIC5zd2FsMi1jb250YWluZXIuc3dhbDItY2VudGVyLXN0YXJ0e3RvcDo1MCU7bGVmdDowO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC01MCUpfWJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1jZW50ZXItZW5kLGJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1jZW50ZXItcmlnaHR7dG9wOjUwJTtyaWdodDowO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC01MCUpfWJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b217Ym90dG9tOjA7bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSl9Ym9keS5zd2FsMi1uby1iYWNrZHJvcCAuc3dhbDItY29udGFpbmVyLnN3YWwyLWJvdHRvbS1sZWZ0LGJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tc3RhcnR7Ym90dG9tOjA7bGVmdDowfWJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tZW5kLGJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tcmlnaHR7cmlnaHQ6MDtib3R0b206MH1AbWVkaWEgcHJpbnR7Ym9keS5zd2FsMi1zaG93bjpub3QoLnN3YWwyLW5vLWJhY2tkcm9wKTpub3QoLnN3YWwyLXRvYXN0LXNob3duKXtvdmVyZmxvdy15OnNjcm9sbCFpbXBvcnRhbnR9Ym9keS5zd2FsMi1zaG93bjpub3QoLnN3YWwyLW5vLWJhY2tkcm9wKTpub3QoLnN3YWwyLXRvYXN0LXNob3duKT5bYXJpYS1oaWRkZW49dHJ1ZV17ZGlzcGxheTpub25lfWJvZHkuc3dhbDItc2hvd246bm90KC5zd2FsMi1uby1iYWNrZHJvcCk6bm90KC5zd2FsMi10b2FzdC1zaG93bikgLnN3YWwyLWNvbnRhaW5lcntwb3NpdGlvbjpzdGF0aWMhaW1wb3J0YW50fX1ib2R5LnN3YWwyLXRvYXN0LXNob3duIC5zd2FsMi1jb250YWluZXJ7YmFja2dyb3VuZC1jb2xvcjp0cmFuc3BhcmVudH1ib2R5LnN3YWwyLXRvYXN0LXNob3duIC5zd2FsMi1jb250YWluZXIuc3dhbDItdG9we3RvcDowO3JpZ2h0OmF1dG87Ym90dG9tOmF1dG87bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSl9Ym9keS5zd2FsMi10b2FzdC1zaG93biAuc3dhbDItY29udGFpbmVyLnN3YWwyLXRvcC1lbmQsYm9keS5zd2FsMi10b2FzdC1zaG93biAuc3dhbDItY29udGFpbmVyLnN3YWwyLXRvcC1yaWdodHt0b3A6MDtyaWdodDowO2JvdHRvbTphdXRvO2xlZnQ6YXV0b31ib2R5LnN3YWwyLXRvYXN0LXNob3duIC5zd2FsMi1jb250YWluZXIuc3dhbDItdG9wLWxlZnQsYm9keS5zd2FsMi10b2FzdC1zaG93biAuc3dhbDItY29udGFpbmVyLnN3YWwyLXRvcC1zdGFydHt0b3A6MDtyaWdodDphdXRvO2JvdHRvbTphdXRvO2xlZnQ6MH1ib2R5LnN3YWwyLXRvYXN0LXNob3duIC5zd2FsMi1jb250YWluZXIuc3dhbDItY2VudGVyLWxlZnQsYm9keS5zd2FsMi10b2FzdC1zaG93biAuc3dhbDItY29udGFpbmVyLnN3YWwyLWNlbnRlci1zdGFydHt0b3A6NTAlO3JpZ2h0OmF1dG87Ym90dG9tOmF1dG87bGVmdDowO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC01MCUpfWJvZHkuc3dhbDItdG9hc3Qtc2hvd24gLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1jZW50ZXJ7dG9wOjUwJTtyaWdodDphdXRvO2JvdHRvbTphdXRvO2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGUoLTUwJSwtNTAlKX1ib2R5LnN3YWwyLXRvYXN0LXNob3duIC5zd2FsMi1jb250YWluZXIuc3dhbDItY2VudGVyLWVuZCxib2R5LnN3YWwyLXRvYXN0LXNob3duIC5zd2FsMi1jb250YWluZXIuc3dhbDItY2VudGVyLXJpZ2h0e3RvcDo1MCU7cmlnaHQ6MDtib3R0b206YXV0bztsZWZ0OmF1dG87dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTUwJSl9Ym9keS5zd2FsMi10b2FzdC1zaG93biAuc3dhbDItY29udGFpbmVyLnN3YWwyLWJvdHRvbS1sZWZ0LGJvZHkuc3dhbDItdG9hc3Qtc2hvd24gLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tc3RhcnR7dG9wOmF1dG87cmlnaHQ6YXV0bztib3R0b206MDtsZWZ0OjB9Ym9keS5zd2FsMi10b2FzdC1zaG93biAuc3dhbDItY29udGFpbmVyLnN3YWwyLWJvdHRvbXt0b3A6YXV0bztyaWdodDphdXRvO2JvdHRvbTowO2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpfWJvZHkuc3dhbDItdG9hc3Qtc2hvd24gLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tZW5kLGJvZHkuc3dhbDItdG9hc3Qtc2hvd24gLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tcmlnaHR7dG9wOmF1dG87cmlnaHQ6MDtib3R0b206MDtsZWZ0OmF1dG99Iik7"},{"meta":{"name":"md5.min.js","url":"https://unpkg.com/js-md5@0.7.3/build/md5.min.js","ts":1734258410848,"mimetype":"text/javascript"},"source":"LyoqCiAqIFtqcy1tZDVde0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9lbW4xNzgvanMtbWQ1fQogKgogKiBAbmFtZXNwYWNlIG1kNQogKiBAdmVyc2lvbiAwLjcuMwogKiBAYXV0aG9yIENoZW4sIFlpLUN5dWFuIFtlbW4xNzhAZ21haWwuY29tXQogKiBAY29weXJpZ2h0IENoZW4sIFlpLUN5dWFuIDIwMTQtMjAxNwogKiBAbGljZW5zZSBNSVQKICovCiFmdW5jdGlvbigpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiB0KHQpe2lmKHQpZFswXT1kWzE2XT1kWzFdPWRbMl09ZFszXT1kWzRdPWRbNV09ZFs2XT1kWzddPWRbOF09ZFs5XT1kWzEwXT1kWzExXT1kWzEyXT1kWzEzXT1kWzE0XT1kWzE1XT0wLHRoaXMuYmxvY2tzPWQsdGhpcy5idWZmZXI4PWw7ZWxzZSBpZihhKXt2YXIgcj1uZXcgQXJyYXlCdWZmZXIoNjgpO3RoaXMuYnVmZmVyOD1uZXcgVWludDhBcnJheShyKSx0aGlzLmJsb2Nrcz1uZXcgVWludDMyQXJyYXkocil9ZWxzZSB0aGlzLmJsb2Nrcz1bMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwXTt0aGlzLmgwPXRoaXMuaDE9dGhpcy5oMj10aGlzLmgzPXRoaXMuc3RhcnQ9dGhpcy5ieXRlcz10aGlzLmhCeXRlcz0wLHRoaXMuZmluYWxpemVkPXRoaXMuaGFzaGVkPSExLHRoaXMuZmlyc3Q9ITB9dmFyIHI9ImlucHV0IGlzIGludmFsaWQgdHlwZSIsZT0ib2JqZWN0Ij09dHlwZW9mIHdpbmRvdyxpPWU/d2luZG93Ont9O2kuSlNfTUQ1X05PX1dJTkRPVyYmKGU9ITEpO3ZhciBzPSFlJiYib2JqZWN0Ij09dHlwZW9mIHNlbGYsaD0haS5KU19NRDVfTk9fTk9ERV9KUyYmIm9iamVjdCI9PXR5cGVvZiBwcm9jZXNzJiZwcm9jZXNzLnZlcnNpb25zJiZwcm9jZXNzLnZlcnNpb25zLm5vZGU7aD9pPWdsb2JhbDpzJiYoaT1zZWxmKTt2YXIgZj0haS5KU19NRDVfTk9fQ09NTU9OX0pTJiYib2JqZWN0Ij09dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHMsbz0iZnVuY3Rpb24iPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kLGE9IWkuSlNfTUQ1X05PX0FSUkFZX0JVRkZFUiYmInVuZGVmaW5lZCIhPXR5cGVvZiBBcnJheUJ1ZmZlcixuPSIwMTIzNDU2Nzg5YWJjZGVmIi5zcGxpdCgiIiksdT1bMTI4LDMyNzY4LDgzODg2MDgsLTIxNDc0ODM2NDhdLHk9WzAsOCwxNiwyNF0sYz1bImhleCIsImFycmF5IiwiZGlnZXN0IiwiYnVmZmVyIiwiYXJyYXlCdWZmZXIiLCJiYXNlNjQiXSxwPSJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvIi5zcGxpdCgiIiksZD1bXSxsO2lmKGEpe3ZhciBBPW5ldyBBcnJheUJ1ZmZlcig2OCk7bD1uZXcgVWludDhBcnJheShBKSxkPW5ldyBVaW50MzJBcnJheShBKX0haS5KU19NRDVfTk9fTk9ERV9KUyYmQXJyYXkuaXNBcnJheXx8KEFycmF5LmlzQXJyYXk9ZnVuY3Rpb24odCl7cmV0dXJuIltvYmplY3QgQXJyYXldIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX0pLCFhfHwhaS5KU19NRDVfTk9fQVJSQVlfQlVGRkVSX0lTX1ZJRVcmJkFycmF5QnVmZmVyLmlzVmlld3x8KEFycmF5QnVmZmVyLmlzVmlldz1mdW5jdGlvbih0KXtyZXR1cm4ib2JqZWN0Ij09dHlwZW9mIHQmJnQuYnVmZmVyJiZ0LmJ1ZmZlci5jb25zdHJ1Y3Rvcj09PUFycmF5QnVmZmVyfSk7dmFyIGI9ZnVuY3Rpb24ocil7cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiBuZXcgdCghMCkudXBkYXRlKGUpW3JdKCl9fSx2PWZ1bmN0aW9uKCl7dmFyIHI9YigiaGV4Iik7aCYmKHI9dyhyKSksci5jcmVhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHR9LHIudXBkYXRlPWZ1bmN0aW9uKHQpe3JldHVybiByLmNyZWF0ZSgpLnVwZGF0ZSh0KX07Zm9yKHZhciBlPTA7ZTxjLmxlbmd0aDsrK2Upe3ZhciBpPWNbZV07cltpXT1iKGkpfXJldHVybiByfSx3PWZ1bmN0aW9uKHQpe3ZhciBlPWV2YWwoInJlcXVpcmUoJ2NyeXB0bycpIiksaT1ldmFsKCJyZXF1aXJlKCdidWZmZXInKS5CdWZmZXIiKSxzPWZ1bmN0aW9uKHMpe2lmKCJzdHJpbmciPT10eXBlb2YgcylyZXR1cm4gZS5jcmVhdGVIYXNoKCJtZDUiKS51cGRhdGUocywidXRmOCIpLmRpZ2VzdCgiaGV4Iik7aWYobnVsbD09PXN8fHZvaWQgMD09PXMpdGhyb3cgcjtyZXR1cm4gcy5jb25zdHJ1Y3Rvcj09PUFycmF5QnVmZmVyJiYocz1uZXcgVWludDhBcnJheShzKSksQXJyYXkuaXNBcnJheShzKXx8QXJyYXlCdWZmZXIuaXNWaWV3KHMpfHxzLmNvbnN0cnVjdG9yPT09aT9lLmNyZWF0ZUhhc2goIm1kNSIpLnVwZGF0ZShuZXcgaShzKSkuZGlnZXN0KCJoZXgiKTp0KHMpfTtyZXR1cm4gc307dC5wcm90b3R5cGUudXBkYXRlPWZ1bmN0aW9uKHQpe2lmKCF0aGlzLmZpbmFsaXplZCl7dmFyIGUsaT10eXBlb2YgdDtpZigic3RyaW5nIiE9PWkpe2lmKCJvYmplY3QiIT09aSl0aHJvdyByO2lmKG51bGw9PT10KXRocm93IHI7aWYoYSYmdC5jb25zdHJ1Y3Rvcj09PUFycmF5QnVmZmVyKXQ9bmV3IFVpbnQ4QXJyYXkodCk7ZWxzZSBpZighKEFycmF5LmlzQXJyYXkodCl8fGEmJkFycmF5QnVmZmVyLmlzVmlldyh0KSkpdGhyb3cgcjtlPSEwfWZvcih2YXIgcyxoLGY9MCxvPXQubGVuZ3RoLG49dGhpcy5ibG9ja3MsdT10aGlzLmJ1ZmZlcjg7ZjxvOyl7aWYodGhpcy5oYXNoZWQmJih0aGlzLmhhc2hlZD0hMSxuWzBdPW5bMTZdLG5bMTZdPW5bMV09blsyXT1uWzNdPW5bNF09bls1XT1uWzZdPW5bN109bls4XT1uWzldPW5bMTBdPW5bMTFdPW5bMTJdPW5bMTNdPW5bMTRdPW5bMTVdPTApLGUpaWYoYSlmb3IoaD10aGlzLnN0YXJ0O2Y8byYmaDw2NDsrK2YpdVtoKytdPXRbZl07ZWxzZSBmb3IoaD10aGlzLnN0YXJ0O2Y8byYmaDw2NDsrK2YpbltoPj4yXXw9dFtmXTw8eVszJmgrK107ZWxzZSBpZihhKWZvcihoPXRoaXMuc3RhcnQ7ZjxvJiZoPDY0OysrZikocz10LmNoYXJDb2RlQXQoZikpPDEyOD91W2grK109czpzPDIwNDg/KHVbaCsrXT0xOTJ8cz4+Nix1W2grK109MTI4fDYzJnMpOnM8NTUyOTZ8fHM+PTU3MzQ0Pyh1W2grK109MjI0fHM+PjEyLHVbaCsrXT0xMjh8cz4+NiY2Myx1W2grK109MTI4fDYzJnMpOihzPTY1NTM2KygoMTAyMyZzKTw8MTB8MTAyMyZ0LmNoYXJDb2RlQXQoKytmKSksdVtoKytdPTI0MHxzPj4xOCx1W2grK109MTI4fHM+PjEyJjYzLHVbaCsrXT0xMjh8cz4+NiY2Myx1W2grK109MTI4fDYzJnMpO2Vsc2UgZm9yKGg9dGhpcy5zdGFydDtmPG8mJmg8NjQ7KytmKShzPXQuY2hhckNvZGVBdChmKSk8MTI4P25baD4+Ml18PXM8PHlbMyZoKytdOnM8MjA0OD8obltoPj4yXXw9KDE5MnxzPj42KTw8eVszJmgrK10sbltoPj4yXXw9KDEyOHw2MyZzKTw8eVszJmgrK10pOnM8NTUyOTZ8fHM+PTU3MzQ0PyhuW2g+PjJdfD0oMjI0fHM+PjEyKTw8eVszJmgrK10sbltoPj4yXXw9KDEyOHxzPj42JjYzKTw8eVszJmgrK10sbltoPj4yXXw9KDEyOHw2MyZzKTw8eVszJmgrK10pOihzPTY1NTM2KygoMTAyMyZzKTw8MTB8MTAyMyZ0LmNoYXJDb2RlQXQoKytmKSksbltoPj4yXXw9KDI0MHxzPj4xOCk8PHlbMyZoKytdLG5baD4+Ml18PSgxMjh8cz4+MTImNjMpPDx5WzMmaCsrXSxuW2g+PjJdfD0oMTI4fHM+PjYmNjMpPDx5WzMmaCsrXSxuW2g+PjJdfD0oMTI4fDYzJnMpPDx5WzMmaCsrXSk7dGhpcy5sYXN0Qnl0ZUluZGV4PWgsdGhpcy5ieXRlcys9aC10aGlzLnN0YXJ0LGg+PTY0Pyh0aGlzLnN0YXJ0PWgtNjQsdGhpcy5oYXNoKCksdGhpcy5oYXNoZWQ9ITApOnRoaXMuc3RhcnQ9aH1yZXR1cm4gdGhpcy5ieXRlcz40Mjk0OTY3Mjk1JiYodGhpcy5oQnl0ZXMrPXRoaXMuYnl0ZXMvNDI5NDk2NzI5Njw8MCx0aGlzLmJ5dGVzPXRoaXMuYnl0ZXMlNDI5NDk2NzI5NiksdGhpc319LHQucHJvdG90eXBlLmZpbmFsaXplPWZ1bmN0aW9uKCl7aWYoIXRoaXMuZmluYWxpemVkKXt0aGlzLmZpbmFsaXplZD0hMDt2YXIgdD10aGlzLmJsb2NrcyxyPXRoaXMubGFzdEJ5dGVJbmRleDt0W3I+PjJdfD11WzMmcl0scj49NTYmJih0aGlzLmhhc2hlZHx8dGhpcy5oYXNoKCksdFswXT10WzE2XSx0WzE2XT10WzFdPXRbMl09dFszXT10WzRdPXRbNV09dFs2XT10WzddPXRbOF09dFs5XT10WzEwXT10WzExXT10WzEyXT10WzEzXT10WzE0XT10WzE1XT0wKSx0WzE0XT10aGlzLmJ5dGVzPDwzLHRbMTVdPXRoaXMuaEJ5dGVzPDwzfHRoaXMuYnl0ZXM+Pj4yOSx0aGlzLmhhc2goKX19LHQucHJvdG90eXBlLmhhc2g9ZnVuY3Rpb24oKXt2YXIgdCxyLGUsaSxzLGgsZj10aGlzLmJsb2Nrczt0aGlzLmZpcnN0P3I9KChyPSgodD0oKHQ9ZlswXS02ODA4NzY5MzcpPDw3fHQ+Pj4yNSktMjcxNzMzODc5PDwwKV4oZT0oKGU9KC0yNzE3MzM4NzleKGk9KChpPSgtMTczMjU4NDE5NF4yMDA0MzE4MDcxJnQpK2ZbMV0tMTE3ODMwNzA4KTw8MTJ8aT4+PjIwKSt0PDwwKSYoLTI3MTczMzg3OV50KSkrZlsyXS0xMTI2NDc4Mzc1KTw8MTd8ZT4+PjE1KStpPDwwKSYoaV50KSkrZlszXS0xMzE2MjU5MjA5KTw8MjJ8cj4+PjEwKStlPDwwOih0PXRoaXMuaDAscj10aGlzLmgxLGU9dGhpcy5oMixyPSgocis9KCh0PSgodCs9KChpPXRoaXMuaDMpXnImKGVeaSkpK2ZbMF0tNjgwODc2OTM2KTw8N3x0Pj4+MjUpK3I8PDApXihlPSgoZSs9KHJeKGk9KChpKz0oZV50JihyXmUpKStmWzFdLTM4OTU2NDU4Nik8PDEyfGk+Pj4yMCkrdDw8MCkmKHRecikpK2ZbMl0rNjA2MTA1ODE5KTw8MTd8ZT4+PjE1KStpPDwwKSYoaV50KSkrZlszXS0xMDQ0NTI1MzMwKTw8MjJ8cj4+PjEwKStlPDwwKSxyPSgocis9KCh0PSgodCs9KGleciYoZV5pKSkrZls0XS0xNzY0MTg4OTcpPDw3fHQ+Pj4yNSkrcjw8MCleKGU9KChlKz0ocl4oaT0oKGkrPShlXnQmKHJeZSkpK2ZbNV0rMTIwMDA4MDQyNik8PDEyfGk+Pj4yMCkrdDw8MCkmKHRecikpK2ZbNl0tMTQ3MzIzMTM0MSk8PDE3fGU+Pj4xNSkraTw8MCkmKGledCkpK2ZbN10tNDU3MDU5ODMpPDwyMnxyPj4+MTApK2U8PDAscj0oKHIrPSgodD0oKHQrPShpXnImKGVeaSkpK2ZbOF0rMTc3MDAzNTQxNik8PDd8dD4+PjI1KStyPDwwKV4oZT0oKGUrPShyXihpPSgoaSs9KGVedCYocl5lKSkrZls5XS0xOTU4NDE0NDE3KTw8MTJ8aT4+PjIwKSt0PDwwKSYodF5yKSkrZlsxMF0tNDIwNjMpPDwxN3xlPj4+MTUpK2k8PDApJihpXnQpKStmWzExXS0xOTkwNDA0MTYyKTw8MjJ8cj4+PjEwKStlPDwwLHI9KChyKz0oKHQ9KCh0Kz0oaV5yJihlXmkpKStmWzEyXSsxODA0NjAzNjgyKTw8N3x0Pj4+MjUpK3I8PDApXihlPSgoZSs9KHJeKGk9KChpKz0oZV50JihyXmUpKStmWzEzXS00MDM0MTEwMSk8PDEyfGk+Pj4yMCkrdDw8MCkmKHRecikpK2ZbMTRdLTE1MDIwMDIyOTApPDwxN3xlPj4+MTUpK2k8PDApJihpXnQpKStmWzE1XSsxMjM2NTM1MzI5KTw8MjJ8cj4+PjEwKStlPDwwLHI9KChyKz0oKGk9KChpKz0ocl5lJigodD0oKHQrPShlXmkmKHJeZSkpK2ZbMV0tMTY1Nzk2NTEwKTw8NXx0Pj4+MjcpK3I8PDApXnIpKStmWzZdLTEwNjk1MDE2MzIpPDw5fGk+Pj4yMykrdDw8MCledCYoKGU9KChlKz0odF5yJihpXnQpKStmWzExXSs2NDM3MTc3MTMpPDwxNHxlPj4+MTgpK2k8PDApXmkpKStmWzBdLTM3Mzg5NzMwMik8PDIwfHI+Pj4xMikrZTw8MCxyPSgocis9KChpPSgoaSs9KHJeZSYoKHQ9KCh0Kz0oZV5pJihyXmUpKStmWzVdLTcwMTU1ODY5MSk8PDV8dD4+PjI3KStyPDwwKV5yKSkrZlsxMF0rMzgwMTYwODMpPDw5fGk+Pj4yMykrdDw8MCledCYoKGU9KChlKz0odF5yJihpXnQpKStmWzE1XS02NjA0NzgzMzUpPDwxNHxlPj4+MTgpK2k8PDApXmkpKStmWzRdLTQwNTUzNzg0OCk8PDIwfHI+Pj4xMikrZTw8MCxyPSgocis9KChpPSgoaSs9KHJeZSYoKHQ9KCh0Kz0oZV5pJihyXmUpKStmWzldKzU2ODQ0NjQzOCk8PDV8dD4+PjI3KStyPDwwKV5yKSkrZlsxNF0tMTAxOTgwMzY5MCk8PDl8aT4+PjIzKSt0PDwwKV50JigoZT0oKGUrPSh0XnImKGledCkpK2ZbM10tMTg3MzYzOTYxKTw8MTR8ZT4+PjE4KStpPDwwKV5pKSkrZls4XSsxMTYzNTMxNTAxKTw8MjB8cj4+PjEyKStlPDwwLHI9KChyKz0oKGk9KChpKz0ocl5lJigodD0oKHQrPShlXmkmKHJeZSkpK2ZbMTNdLTE0NDQ2ODE0NjcpPDw1fHQ+Pj4yNykrcjw8MClecikpK2ZbMl0tNTE0MDM3ODQpPDw5fGk+Pj4yMykrdDw8MCledCYoKGU9KChlKz0odF5yJihpXnQpKStmWzddKzE3MzUzMjg0NzMpPDwxNHxlPj4+MTgpK2k8PDApXmkpKStmWzEyXS0xOTI2NjA3NzM0KTw8MjB8cj4+PjEyKStlPDwwLHI9KChyKz0oKGg9KGk9KChpKz0oKHM9cl5lKV4odD0oKHQrPShzXmkpK2ZbNV0tMzc4NTU4KTw8NHx0Pj4+MjgpK3I8PDApKStmWzhdLTIwMjI1NzQ0NjMpPDwxMXxpPj4+MjEpK3Q8PDApXnQpXihlPSgoZSs9KGhecikrZlsxMV0rMTgzOTAzMDU2Mik8PDE2fGU+Pj4xNikraTw8MCkpK2ZbMTRdLTM1MzA5NTU2KTw8MjN8cj4+PjkpK2U8PDAscj0oKHIrPSgoaD0oaT0oKGkrPSgocz1yXmUpXih0PSgodCs9KHNeaSkrZlsxXS0xNTMwOTkyMDYwKTw8NHx0Pj4+MjgpK3I8PDApKStmWzRdKzEyNzI4OTMzNTMpPDwxMXxpPj4+MjEpK3Q8PDApXnQpXihlPSgoZSs9KGhecikrZls3XS0xNTU0OTc2MzIpPDwxNnxlPj4+MTYpK2k8PDApKStmWzEwXS0xMDk0NzMwNjQwKTw8MjN8cj4+PjkpK2U8PDAscj0oKHIrPSgoaD0oaT0oKGkrPSgocz1yXmUpXih0PSgodCs9KHNeaSkrZlsxM10rNjgxMjc5MTc0KTw8NHx0Pj4+MjgpK3I8PDApKStmWzBdLTM1ODUzNzIyMik8PDExfGk+Pj4yMSkrdDw8MCledCleKGU9KChlKz0oaF5yKStmWzNdLTcyMjUyMTk3OSk8PDE2fGU+Pj4xNikraTw8MCkpK2ZbNl0rNzYwMjkxODkpPDwyM3xyPj4+OSkrZTw8MCxyPSgocis9KChoPShpPSgoaSs9KChzPXJeZSleKHQ9KCh0Kz0oc15pKStmWzldLTY0MDM2NDQ4Nyk8PDR8dD4+PjI4KStyPDwwKSkrZlsxMl0tNDIxODE1ODM1KTw8MTF8aT4+PjIxKSt0PDwwKV50KV4oZT0oKGUrPShoXnIpK2ZbMTVdKzUzMDc0MjUyMCk8PDE2fGU+Pj4xNikraTw8MCkpK2ZbMl0tOTk1MzM4NjUxKTw8MjN8cj4+PjkpK2U8PDAscj0oKHIrPSgoaT0oKGkrPShyXigodD0oKHQrPShlXihyfH5pKSkrZlswXS0xOTg2MzA4NDQpPDw2fHQ+Pj4yNikrcjw8MCl8fmUpKStmWzddKzExMjY4OTE0MTUpPDwxMHxpPj4+MjIpK3Q8PDApXigoZT0oKGUrPSh0XihpfH5yKSkrZlsxNF0tMTQxNjM1NDkwNSk8PDE1fGU+Pj4xNykraTw8MCl8fnQpKStmWzVdLTU3NDM0MDU1KTw8MjF8cj4+PjExKStlPDwwLHI9KChyKz0oKGk9KChpKz0ocl4oKHQ9KCh0Kz0oZV4ocnx+aSkpK2ZbMTJdKzE3MDA0ODU1NzEpPDw2fHQ+Pj4yNikrcjw8MCl8fmUpKStmWzNdLTE4OTQ5ODY2MDYpPDwxMHxpPj4+MjIpK3Q8PDApXigoZT0oKGUrPSh0XihpfH5yKSkrZlsxMF0tMTA1MTUyMyk8PDE1fGU+Pj4xNykraTw8MCl8fnQpKStmWzFdLTIwNTQ5MjI3OTkpPDwyMXxyPj4+MTEpK2U8PDAscj0oKHIrPSgoaT0oKGkrPShyXigodD0oKHQrPShlXihyfH5pKSkrZls4XSsxODczMzEzMzU5KTw8Nnx0Pj4+MjYpK3I8PDApfH5lKSkrZlsxNV0tMzA2MTE3NDQpPDwxMHxpPj4+MjIpK3Q8PDApXigoZT0oKGUrPSh0XihpfH5yKSkrZls2XS0xNTYwMTk4MzgwKTw8MTV8ZT4+PjE3KStpPDwwKXx+dCkpK2ZbMTNdKzEzMDkxNTE2NDkpPDwyMXxyPj4+MTEpK2U8PDAscj0oKHIrPSgoaT0oKGkrPShyXigodD0oKHQrPShlXihyfH5pKSkrZls0XS0xNDU1MjMwNzApPDw2fHQ+Pj4yNikrcjw8MCl8fmUpKStmWzExXS0xMTIwMjEwMzc5KTw8MTB8aT4+PjIyKSt0PDwwKV4oKGU9KChlKz0odF4oaXx+cikpK2ZbMl0rNzE4Nzg3MjU5KTw8MTV8ZT4+PjE3KStpPDwwKXx+dCkpK2ZbOV0tMzQzNDg1NTUxKTw8MjF8cj4+PjExKStlPDwwLHRoaXMuZmlyc3Q/KHRoaXMuaDA9dCsxNzMyNTg0MTkzPDwwLHRoaXMuaDE9ci0yNzE3MzM4Nzk8PDAsdGhpcy5oMj1lLTE3MzI1ODQxOTQ8PDAsdGhpcy5oMz1pKzI3MTczMzg3ODw8MCx0aGlzLmZpcnN0PSExKToodGhpcy5oMD10aGlzLmgwK3Q8PDAsdGhpcy5oMT10aGlzLmgxK3I8PDAsdGhpcy5oMj10aGlzLmgyK2U8PDAsdGhpcy5oMz10aGlzLmgzK2k8PDApfSx0LnByb3RvdHlwZS5oZXg9ZnVuY3Rpb24oKXt0aGlzLmZpbmFsaXplKCk7dmFyIHQ9dGhpcy5oMCxyPXRoaXMuaDEsZT10aGlzLmgyLGk9dGhpcy5oMztyZXR1cm4gblt0Pj40JjE1XStuWzE1JnRdK25bdD4+MTImMTVdK25bdD4+OCYxNV0rblt0Pj4yMCYxNV0rblt0Pj4xNiYxNV0rblt0Pj4yOCYxNV0rblt0Pj4yNCYxNV0rbltyPj40JjE1XStuWzE1JnJdK25bcj4+MTImMTVdK25bcj4+OCYxNV0rbltyPj4yMCYxNV0rbltyPj4xNiYxNV0rbltyPj4yOCYxNV0rbltyPj4yNCYxNV0rbltlPj40JjE1XStuWzE1JmVdK25bZT4+MTImMTVdK25bZT4+OCYxNV0rbltlPj4yMCYxNV0rbltlPj4xNiYxNV0rbltlPj4yOCYxNV0rbltlPj4yNCYxNV0rbltpPj40JjE1XStuWzE1JmldK25baT4+MTImMTVdK25baT4+OCYxNV0rbltpPj4yMCYxNV0rbltpPj4xNiYxNV0rbltpPj4yOCYxNV0rbltpPj4yNCYxNV19LHQucHJvdG90eXBlLnRvU3RyaW5nPXQucHJvdG90eXBlLmhleCx0LnByb3RvdHlwZS5kaWdlc3Q9ZnVuY3Rpb24oKXt0aGlzLmZpbmFsaXplKCk7dmFyIHQ9dGhpcy5oMCxyPXRoaXMuaDEsZT10aGlzLmgyLGk9dGhpcy5oMztyZXR1cm5bMjU1JnQsdD4+OCYyNTUsdD4+MTYmMjU1LHQ+PjI0JjI1NSwyNTUmcixyPj44JjI1NSxyPj4xNiYyNTUscj4+MjQmMjU1LDI1NSZlLGU+PjgmMjU1LGU+PjE2JjI1NSxlPj4yNCYyNTUsMjU1JmksaT4+OCYyNTUsaT4+MTYmMjU1LGk+PjI0JjI1NV19LHQucHJvdG90eXBlLmFycmF5PXQucHJvdG90eXBlLmRpZ2VzdCx0LnByb3RvdHlwZS5hcnJheUJ1ZmZlcj1mdW5jdGlvbigpe3RoaXMuZmluYWxpemUoKTt2YXIgdD1uZXcgQXJyYXlCdWZmZXIoMTYpLHI9bmV3IFVpbnQzMkFycmF5KHQpO3JldHVybiByWzBdPXRoaXMuaDAsclsxXT10aGlzLmgxLHJbMl09dGhpcy5oMixyWzNdPXRoaXMuaDMsdH0sdC5wcm90b3R5cGUuYnVmZmVyPXQucHJvdG90eXBlLmFycmF5QnVmZmVyLHQucHJvdG90eXBlLmJhc2U2ND1mdW5jdGlvbigpe2Zvcih2YXIgdCxyLGUsaT0iIixzPXRoaXMuYXJyYXkoKSxoPTA7aDwxNTspdD1zW2grK10scj1zW2grK10sZT1zW2grK10saSs9cFt0Pj4+Ml0rcFs2MyYodDw8NHxyPj4+NCldK3BbNjMmKHI8PDJ8ZT4+PjYpXStwWzYzJmVdO3JldHVybiB0PXNbaF0saSs9cFt0Pj4+Ml0rcFt0PDw0JjYzXSsiPT0ifTt2YXIgXz12KCk7Zj9tb2R1bGUuZXhwb3J0cz1fOihpLm1kNT1fLG8mJmRlZmluZShmdW5jdGlvbigpe3JldHVybiBffSkpfSgpOw=="}]},{"name":"||||","options":{"check_for_updates":true,"user_modified":null,"comment":null,"compatopts_for_requires":true,"compat_wrappedjsobject":false,"compat_metadata":false,"compat_foreach":false,"compat_powerful_this":null,"sandbox":null,"noframes":null,"unwrap":null,"run_at":null,"run_in":null,"tags":[],"override":{"use_includes":[],"orig_includes":[],"merge_includes":true,"use_matches":[],"orig_matches":["*://*/*"],"merge_matches":true,"use_excludes":[],"orig_excludes":["*://yiyan.baidu.com/*","*://*.bing.com/search*"],"merge_excludes":true,"use_connects":[],"orig_connects":[],"merge_connects":true,"use_blockers":[],"orig_run_at":"document-start","orig_run_in":[],"orig_noframes":null,"orig_tags":[]}},"storage":{"ts":1753533597812,"data":{"_h5player_lastContactRemoteHelperTime":"n1737288583714","_global_id_":"n13089","__monkeyMsgBroadcast__":"o{\"data\": {},\"tabId\": 11541,\"title\": \"Release SRBMiner-MULTI v2.9.4  doktor83/SRBMiner-Multi  GitHub\",\"referrer\": {\"href\": \"https://github.com/doktor83/SRBMiner-Multi/releases/tag/2.9.4\",\"origin\": \"https://github.com\",\"protocol\": \"https:\",\"host\": \"github.com\",\"hostname\": \"github.com\",\"port\": \"\",\"pathname\": \"/doktor83/SRBMiner-Multi/releases/tag/2.9.4\",\"search\": \"\",\"hash\": \"\"},\"updateTime\": 1764734371397}","_h5player_enhance_allowExperimentFeatures":"btrue","globalKeydownEvent":"o{\"data\": {\"isTrusted\": true,\"charCode\": 0,\"keyCode\": 39,\"altKey\": false,\"ctrlKey\": false,\"shiftKey\": false,\"metaKey\": false,\"location\": 0,\"repeat\": false,\"isComposing\": false,\"key\": \"ArrowRight\",\"code\": \"ArrowRight\",\"DOM_KEY_LOCATION_STANDARD\": 0,\"DOM_KEY_LOCATION_LEFT\": 1,\"DOM_KEY_LOCATION_RIGHT\": 2,\"DOM_KEY_LOCATION_NUMPAD\": 3,\"DOM_VK_CANCEL\": 3,\"DOM_VK_HELP\": 6,\"DOM_VK_BACK_SPACE\": 8,\"DOM_VK_TAB\": 9,\"DOM_VK_CLEAR\": 12,\"DOM_VK_RETURN\": 13,\"DOM_VK_SHIFT\": 16,\"DOM_VK_CONTROL\": 17,\"DOM_VK_ALT\": 18,\"DOM_VK_PAUSE\": 19,\"DOM_VK_CAPS_LOCK\": 20,\"DOM_VK_KANA\": 21,\"DOM_VK_HANGUL\": 21,\"DOM_VK_EISU\": 22,\"DOM_VK_JUNJA\": 23,\"DOM_VK_FINAL\": 24,\"DOM_VK_HANJA\": 25,\"DOM_VK_KANJI\": 25,\"DOM_VK_ESCAPE\": 27,\"DOM_VK_CONVERT\": 28,\"DOM_VK_NONCONVERT\": 29,\"DOM_VK_ACCEPT\": 30,\"DOM_VK_MODECHANGE\": 31,\"DOM_VK_SPACE\": 32,\"DOM_VK_PAGE_UP\": 33,\"DOM_VK_PAGE_DOWN\": 34,\"DOM_VK_END\": 35,\"DOM_VK_HOME\": 36,\"DOM_VK_LEFT\": 37,\"DOM_VK_UP\": 38,\"DOM_VK_RIGHT\": 39,\"DOM_VK_DOWN\": 40,\"DOM_VK_SELECT\": 41,\"DOM_VK_PRINT\": 42,\"DOM_VK_EXECUTE\": 43,\"DOM_VK_PRINTSCREEN\": 44,\"DOM_VK_INSERT\": 45,\"DOM_VK_DELETE\": 46,\"DOM_VK_0\": 48,\"DOM_VK_1\": 49,\"DOM_VK_2\": 50,\"DOM_VK_3\": 51,\"DOM_VK_4\": 52,\"DOM_VK_5\": 53,\"DOM_VK_6\": 54,\"DOM_VK_7\": 55,\"DOM_VK_8\": 56,\"DOM_VK_9\": 57,\"DOM_VK_COLON\": 58,\"DOM_VK_SEMICOLON\": 59,\"DOM_VK_LESS_THAN\": 60,\"DOM_VK_EQUALS\": 61,\"DOM_VK_GREATER_THAN\": 62,\"DOM_VK_QUESTION_MARK\": 63,\"DOM_VK_AT\": 64,\"DOM_VK_A\": 65,\"DOM_VK_B\": 66,\"DOM_VK_C\": 67,\"DOM_VK_D\": 68,\"DOM_VK_E\": 69,\"DOM_VK_F\": 70,\"DOM_VK_G\": 71,\"DOM_VK_H\": 72,\"DOM_VK_I\": 73,\"DOM_VK_J\": 74,\"DOM_VK_K\": 75,\"DOM_VK_L\": 76,\"DOM_VK_M\": 77,\"DOM_VK_N\": 78,\"DOM_VK_O\": 79,\"DOM_VK_P\": 80,\"DOM_VK_Q\": 81,\"DOM_VK_R\": 82,\"DOM_VK_S\": 83,\"DOM_VK_T\": 84,\"DOM_VK_U\": 85,\"DOM_VK_V\": 86,\"DOM_VK_W\": 87,\"DOM_VK_X\": 88,\"DOM_VK_Y\": 89,\"DOM_VK_Z\": 90,\"DOM_VK_WIN\": 91,\"DOM_VK_CONTEXT_MENU\": 93,\"DOM_VK_SLEEP\": 95,\"DOM_VK_NUMPAD0\": 96,\"DOM_VK_NUMPAD1\": 97,\"DOM_VK_NUMPAD2\": 98,\"DOM_VK_NUMPAD3\": 99,\"DOM_VK_NUMPAD4\": 100,\"DOM_VK_NUMPAD5\": 101,\"DOM_VK_NUMPAD6\": 102,\"DOM_VK_NUMPAD7\": 103,\"DOM_VK_NUMPAD8\": 104,\"DOM_VK_NUMPAD9\": 105,\"DOM_VK_MULTIPLY\": 106,\"DOM_VK_ADD\": 107,\"DOM_VK_SEPARATOR\": 108,\"DOM_VK_SUBTRACT\": 109,\"DOM_VK_DECIMAL\": 110,\"DOM_VK_DIVIDE\": 111,\"DOM_VK_F1\": 112,\"DOM_VK_F2\": 113,\"DOM_VK_F3\": 114,\"DOM_VK_F4\": 115,\"DOM_VK_F5\": 116,\"DOM_VK_F6\": 117,\"DOM_VK_F7\": 118,\"DOM_VK_F8\": 119,\"DOM_VK_F9\": 120,\"DOM_VK_F10\": 121,\"DOM_VK_F11\": 122,\"DOM_VK_F12\": 123,\"DOM_VK_F13\": 124,\"DOM_VK_F14\": 125,\"DOM_VK_F15\": 126,\"DOM_VK_F16\": 127,\"DOM_VK_F17\": 128,\"DOM_VK_F18\": 129,\"DOM_VK_F19\": 130,\"DOM_VK_F20\": 131,\"DOM_VK_F21\": 132,\"DOM_VK_F22\": 133,\"DOM_VK_F23\": 134,\"DOM_VK_F24\": 135,\"DOM_VK_NUM_LOCK\": 144,\"DOM_VK_SCROLL_LOCK\": 145,\"DOM_VK_WIN_OEM_FJ_JISHO\": 146,\"DOM_VK_WIN_OEM_FJ_MASSHOU\": 147,\"DOM_VK_WIN_OEM_FJ_TOUROKU\": 148,\"DOM_VK_WIN_OEM_FJ_LOYA\": 149,\"DOM_VK_WIN_OEM_FJ_ROYA\": 150,\"DOM_VK_CIRCUMFLEX\": 160,\"DOM_VK_EXCLAMATION\": 161,\"DOM_VK_DOUBLE_QUOTE\": 162,\"DOM_VK_HASH\": 163,\"DOM_VK_DOLLAR\": 164,\"DOM_VK_PERCENT\": 165,\"DOM_VK_AMPERSAND\": 166,\"DOM_VK_UNDERSCORE\": 167,\"DOM_VK_OPEN_PAREN\": 168,\"DOM_VK_CLOSE_PAREN\": 169,\"DOM_VK_ASTERISK\": 170,\"DOM_VK_PLUS\": 171,\"DOM_VK_PIPE\": 172,\"DOM_VK_HYPHEN_MINUS\": 173,\"DOM_VK_OPEN_CURLY_BRACKET\": 174,\"DOM_VK_CLOSE_CURLY_BRACKET\": 175,\"DOM_VK_TILDE\": 176,\"DOM_VK_VOLUME_MUTE\": 181,\"DOM_VK_VOLUME_DOWN\": 182,\"DOM_VK_VOLUME_UP\": 183,\"DOM_VK_COMMA\": 188,\"DOM_VK_PERIOD\": 190,\"DOM_VK_SLASH\": 191,\"DOM_VK_BACK_QUOTE\": 192,\"DOM_VK_OPEN_BRACKET\": 219,\"DOM_VK_BACK_SLASH\": 220,\"DOM_VK_CLOSE_BRACKET\": 221,\"DOM_VK_QUOTE\": 222,\"DOM_VK_META\": 224,\"DOM_VK_ALTGR\": 225,\"DOM_VK_WIN_ICO_HELP\": 227,\"DOM_VK_WIN_ICO_00\": 228,\"DOM_VK_PROCESSKEY\": 229,\"DOM_VK_WIN_ICO_CLEAR\": 230,\"DOM_VK_WIN_OEM_RESET\": 233,\"DOM_VK_WIN_OEM_JUMP\": 234,\"DOM_VK_WIN_OEM_PA1\": 235,\"DOM_VK_WIN_OEM_PA2\": 236,\"DOM_VK_WIN_OEM_PA3\": 237,\"DOM_VK_WIN_OEM_WSCTRL\": 238,\"DOM_VK_WIN_OEM_CUSEL\": 239,\"DOM_VK_WIN_OEM_ATTN\": 240,\"DOM_VK_WIN_OEM_FINISH\": 241,\"DOM_VK_WIN_OEM_COPY\": 242,\"DOM_VK_WIN_OEM_AUTO\": 243,\"DOM_VK_WIN_OEM_ENLW\": 244,\"DOM_VK_WIN_OEM_BACKTAB\": 245,\"DOM_VK_ATTN\": 246,\"DOM_VK_CRSEL\": 247,\"DOM_VK_EXSEL\": 248,\"DOM_VK_EREOF\": 249,\"DOM_VK_PLAY\": 250,\"DOM_VK_ZOOM\": 251,\"DOM_VK_PA1\": 253,\"DOM_VK_WIN_OEM_CLEAR\": 254,\"detail\": 0,\"layerX\": 0,\"layerY\": 0,\"which\": 39,\"rangeOffset\": 0,\"SCROLL_PAGE_UP\": -32768,\"SCROLL_PAGE_DOWN\": 32768,\"type\": \"keydown\",\"eventPhase\": 1,\"bubbles\": true,\"cancelable\": true,\"returnValue\": true,\"defaultPrevented\": false,\"composed\": true,\"timeStamp\": 4364628,\"cancelBubble\": false,\"NONE\": 0,\"CAPTURING_PHASE\": 1,\"AT_TARGET\": 2,\"BUBBLING_PHASE\": 3,\"ALT_MASK\": 1,\"CONTROL_MASK\": 2,\"SHIFT_MASK\": 4,\"META_MASK\": 8},\"tabId\": 13067,\"title\": \"Dark Myth Wuchang : Fallen Kong - YouTube\",\"referrer\": {\"href\": \"https://www.youtube.com/watch?v=J93E6_w5f0o\",\"origin\": \"https://www.youtube.com\",\"protocol\": \"https:\",\"host\": \"www.youtube.com\",\"hostname\": \"www.youtube.com\",\"port\": \"\",\"pathname\": \"/watch\",\"search\": \"?v=J93E6_w5f0o\",\"hash\": \"\"},\"updateTime\": 1753533282020}","_h5player_recommendList":"o[{\"title\": \"Free GPT-4Provided by the overseas team of ByteDance\",\"url\": \"https://u.anzz.top/ai\",\"i18n\": {\"zh\": {\"title\": \"GPT-4\",\"url\": \"https://u.anzz.top/h5precommend\"}},\"disabled\": true},{\"title\": \"make.comFrom tasks and workflows to apps and systems, build and automate anything in one powerful visual platform.\",\"url\": \"https://www.make.com/en/register?pc=ankvps\",\"lang\": [\"en\"],\"i18n\": {},\"disabled\": false},{\"title\": \"Claude 3GPT-4oStable DiffusionDALLE30\",\"desc\": \"\",\"url\": \"https://u.anzz.top/anakinai\",\"i18n\": {\"en\": {\"title\": \"Free trialClaude 3, GPT-4, Stable Diffusion, DALLE, etc. are free for 30 days\",\"desc\": \"Use the author's invitation link to get more free quota!!\",\"url\": \"https://u.anzz.top/h5precommend\"}},\"disabled\": true},{\"title\": \"Apple IDGPT-PlusNetflixDisney+ \",\"url\": \"https://universalbus.cn?s=04l91CIddv\",\"lang\": [\"zh\"],\"disabled\": true},{\"title\": \"\",\"url\": \"https://u.anzz.top/996\",\"lang\": [\"zh\"],\"disabled\": true},{\"title\": \"\",\"url\": \"https://u.anzz.top/996chatgroup\",\"lang\": [\"zh\"]},{\"title\": \" []\",\"url\": \"https://anzz.flowus.cn/share/c35d8cee-c5d3-44cb-813d-0c43e702ce59\",\"lang\": [\"zh\"]},{\"title\": \"ChatGPTNetflixYouTubeTikTok\",\"url\": \"https://lingdianyun20.xyz/auth/register?code=sblF\",\"lang\": [\"zh\"]},{\"title\": \"VPNChatGPTNetflixYouTubeTikTok\",\"url\": \"https://www.bygcloud.com/#/register?code=kV2kxp8W\",\"lang\": [\"zh\"]},{\"title\": \"\",\"url\": \"https://developer.aliyun.com/topic/ecs/huanshou?userCode=5khxr0dt\",\"lang\": [\"zh\"],\"disabled\": true},{\"title\": \"22G3M61\",\"url\": \"https://www.aliyun.com/daily-act/ecs/activity_selection?userCode=5khxr0dt\",\"lang\": [\"zh\"],\"disabled\": true},{\"title\": \"22G4M99\",\"url\": \"https://curl.qcloud.com/SNJPPDGR\",\"lang\": [\"zh\"],\"disabled\": true},{\"title\": \"AIAI\",\"url\": \"https://u.anzz.top/comate\",\"desc\": \"\",\"lang\": [\"zh\"],\"disabled\": false},{\"title\": \"GPT-4o 498999\",\"url\": \"https://u.anzz.top/huluai02\",\"lang\": [\"zh\"]},{\"title\": \"GPT-4o + Midjourney 498\",\"url\": \"https://u.anzz.top/huluai02\",\"lang\": [\"zh\"],\"disabled\": true},{\"title\": \"AI SupermarketAggregating all kinds of AI products, one-stop purchase\",\"url\": \"https://gpt302.saaslink.net/FgFheK\",\"i18n\": {\"zh\": {\"title\": \"AIAI\"}}},{\"title\": \"100\",\"url\": \"https://u.anzz.top/aboutdonate\",\"i18n\": {\"en\": {\"title\": \"How much reward income does an open source work with 1 million installations generate in a year?\",\"url\": \"https://github.com/xxxily/h5player/blob/master/docs/home/aboutDonate-en.md\"}}},{\"title\": \"\",\"url\": \"https://github.com/xxxily/ffmpeg-script\",\"desc\": \"h5player\",\"i18n\": {\"en\": {\"title\": \"Audio and video merge tool, no secondary coding required\",\"desc\": \"Automatically merge the audio and video files downloaded by h5player into one file without secondary coding, which can be quickly merged\"}},\"disabled\": true}]","_h5player_remoteHelperSyncInterval":"n14400000","_h5player_contactRemoteHelperSuccessTime":"n1736016487466","_h5player_enhance_unfoldMenu":"btrue","_h5player_blacklist_domains":"o[\"challenges.cloudflare.com\",\"www.douyin.com\",\"mail.google.com\",\"www.binance.com\",\"accounts.google.com\"]","_h5player_hotkeys":"o[{\"desc\": \"\",\"key\": \"shift+enter\",\"command\": \"setWebFullScreen\",\"disabled\": true},{\"desc\": \"\",\"key\": \"enter\",\"command\": \"setFullScreen\",\"disabled\": true},{\"desc\": \"\",\"key\": \"shift+p\",\"command\": \"togglePictureInPicture\",\"disabled\": false},{\"desc\": \"\",\"key\": \"\\\\\",\"command\": \"capture\",\"disabled\": false},{\"desc\": \"\",\"key\": \"shift+r\",\"command\": \"switchRestorePlayProgressStatus\",\"disabled\": true},{\"desc\": \"\",\"key\": \"shift+m\",\"command\": \"setMirror\",\"args\": [true],\"disabled\": true},{\"desc\": \"\",\"key\": \"m\",\"command\": \"setMirror\",\"disabled\": true},{\"desc\": \"\",\"key\": \"*\",\"command\": \"mediaDownload\",\"disabled\": false},{\"desc\": \" -0.05\",\"key\": \"shift+x\",\"command\": \"setScaleDown\",\"args\": -0.05,\"disabled\": true},{\"desc\": \" +0.05\",\"key\": \"shift+c\",\"command\": \"setScaleUp\",\"args\": 0.05,\"disabled\": true},{\"desc\": \"\",\"key\": \"shift+z\",\"command\": \"resetTransform\",\"disabled\": true},{\"desc\": \"10px\",\"key\": \"shift+arrowright\",\"command\": \"setTranslateRight\",\"args\": 10,\"disabled\": true},{\"desc\": \"10px\",\"key\": \"shift+arrowleft\",\"command\": \"setTranslateLeft\",\"args\": -10,\"disabled\": true},{\"desc\": \"10px\",\"key\": \"shift+arrowup\",\"command\": \"setTranslateUp\",\"args\": 10,\"disabled\": true},{\"desc\": \"10px\",\"key\": \"shift+arrowdown\",\"command\": \"setTranslateDown\",\"args\": -10,\"disabled\": true},{\"desc\": \"5\",\"key\": \"arrowright\",\"command\": \"setCurrentTimeUp\",\"args\": 5,\"disabled\": false},{\"desc\": \"5\",\"key\": \"arrowleft\",\"command\": \"setCurrentTimeDown\",\"args\": -5,\"disabled\": false},{\"desc\": \"30\",\"key\": \"ctrl+arrowright\",\"command\": \"setCurrentTimeUp\",\"args\": [30],\"disabled\": false},{\"desc\": \"30\",\"key\": \"ctrl+arrowleft\",\"command\": \"setCurrentTimeDown\",\"args\": [-30],\"disabled\": false},{\"desc\": \" 5%\",\"key\": \"arrowup\",\"command\": \"setVolumeUp\",\"args\": [0.05],\"disabled\": false},{\"desc\": \" 5%\",\"key\": \"arrowdown\",\"command\": \"setVolumeDown\",\"args\": [-0.05],\"disabled\": false},{\"desc\": \" 20%\",\"key\": \"ctrl+arrowup\",\"command\": \"setVolumeUp\",\"args\": [0.2],\"disabled\": false},{\"desc\": \" 20%\",\"key\": \"ctrl+arrowdown\",\"command\": \"setVolumeDown\",\"args\": [-0.2],\"disabled\": false},{\"desc\": \"/\",\"key\": \"space\",\"command\": \"switchPlayStatus\",\"disabled\": false},{\"desc\": \"\",\"key\": \"[\",\"command\": \"setPlaybackRateDown\",\"args\": -0.2,\"disabled\": false},{\"desc\": \"\",\"key\": \"]\",\"command\": \"setPlaybackRateUp\",\"args\": 0.2,\"disabled\": false},{\"desc\": \"\",\"key\": 0,\"command\": \"resetPlaybackRate\",\"disabled\": false},{\"desc\": \"1x\",\"key\": \"Digit1\",\"command\": \"setPlaybackRatePlus\",\"args\": 1,\"disabled\": true},{\"desc\": \"1x\",\"key\": \"Numpad1\",\"command\": \"setPlaybackRatePlus\",\"args\": 1,\"disabled\": true},{\"desc\": \"2x\",\"key\": \"Digit2\",\"command\": \"setPlaybackRatePlus\",\"args\": 2,\"disabled\": true},{\"desc\": \"2x\",\"key\": \"Numpad2\",\"command\": \"setPlaybackRatePlus\",\"args\": 2,\"disabled\": true},{\"desc\": \"3x\",\"key\": \"Digit3\",\"command\": \"setPlaybackRatePlus\",\"args\": 3,\"disabled\": true},{\"desc\": \"3x\",\"key\": \"Numpad3\",\"command\": \"setPlaybackRatePlus\",\"args\": 3,\"disabled\": true},{\"desc\": \"4x\",\"key\": \"Digit4\",\"command\": \"setPlaybackRatePlus\",\"args\": 4,\"disabled\": true},{\"desc\": \"4x\",\"key\": \"Numpad4\",\"command\": \"setPlaybackRatePlus\",\"args\": 4,\"disabled\": true},{\"desc\": \"\",\"key\": \"=\",\"command\": \"freezeFrame\",\"args\": 1,\"disabled\": false},{\"desc\": \"\",\"key\": \"-\",\"command\": \"freezeFrame\",\"args\": -1,\"disabled\": false},{\"desc\": \"\",\"key\": \"E\",\"command\": \"setBrightnessUp\",\"disabled\": true},{\"desc\": \"\",\"key\": \"W\",\"command\": \"setBrightnessDown\",\"disabled\": true},{\"desc\": \"\",\"key\": \"T\",\"command\": \"setContrastUp\",\"disabled\": true},{\"desc\": \"\",\"key\": \"R\",\"command\": \"setContrastDown\",\"disabled\": true},{\"desc\": \"\",\"key\": \"U\",\"command\": \"setSaturationUp\",\"disabled\": true},{\"desc\": \"\",\"key\": \"Y\",\"command\": \"setSaturationDown\",\"disabled\": true},{\"desc\": \"\",\"key\": \"O\",\"command\": \"setHueUp\",\"disabled\": true},{\"desc\": \"\",\"key\": \"I\",\"command\": \"setHueDown\",\"disabled\": true},{\"desc\": \" 1 px\",\"key\": \"K\",\"command\": \"setBlurUp\",\"disabled\": true},{\"desc\": \" 1 px\",\"key\": \"J\",\"command\": \"setBlurDown\",\"disabled\": true},{\"desc\": \"\",\"key\": \"Q\",\"command\": \"resetFilterAndTransform\",\"disabled\": true},{\"desc\": \" 90 \",\"key\": \"S\",\"command\": \"setRotate\",\"disabled\": true},{\"desc\": \"\",\"key\": \"N\",\"command\": \"setNextVideo\",\"disabled\": true},{\"desc\": \"debugger\",\"key\": \"ctrl+shift+alt+d\",\"command\": \"debuggerNow\",\"disabled\": true},{\"desc\": \"JS\",\"key\": \"ctrl+j ctrl+s\",\"when\": \"\",\"disabled\": true}]","_h5player_blacklist_urls":"o[\"https://www.bilibili.com/\"]","_h5player_media_playbackRate":"n1.8","videoDetected":"o{\"data\": {\"src\": \"\"},\"tabId\": 13060,\"title\": \"YouTube\",\"referrer\": {\"href\": \"https://www.youtube.com/embed/oMY5ZdgHulc?feature=oembed\",\"origin\": \"https://www.youtube.com\",\"protocol\": \"https:\",\"host\": \"www.youtube.com\",\"hostname\": \"www.youtube.com\",\"port\": \"\",\"pathname\": \"/embed/oMY5ZdgHulc\",\"search\": \"?feature=oembed\",\"hash\": \"\"},\"updateTime\": 1753526384112}","_h5player_ui_enable":"bfalse","h5player_openTab_https://u.anzz.top/h5pjsoneditor":"n1744993204691","_h5player_enhance_allowExternalCustomConfiguration":"btrue","h5player_openTab_https://h5player.anzz.top":"n1753533231233","h5player_openTab_https://h5player.anzz.top/tools/json-editor/index.html?mode=tree&saveHandlerName=saveH5PlayerConfig&expandAll=true&json=":"n1751531366324"}},"enabled":true,"position":7,"file_url":"https://update.greasyfork.org/scripts/381682/%E9%9F%B3%E8%A7%86%E9%A2%91%E5%A2%9E%E5%BC%BA%E8%84%9A%E6%9C%AC%EF%BC%9A%E6%97%A0%E6%9E%81%E8%B0%83%E9%80%9F%7C%E5%80%8D%E9%80%9F%E5%BF%AB%E5%AD%A6%7C%E5%BF%AB%E4%B9%90%E5%88%B7%E5%89%A7%7C%E8%A7%86%E9%A2%91%E4%B8%8B%E8%BD%BD%7C%E7%94%BB%E9%9D%A2%E6%88%AA%E5%9B%BE%E7%AD%89%E3%80%8C%E9%80%82%E7%94%A8%E5%A4%A7%E9%83%A8%E5%88%86%E7%BD%91%E7%AB%99%E3%80%8D.user.js","uuid":"d281c3a7-8b46-4ecc-93bd-10714cc34df5","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICDpn7Pop4bpopHlop7lvLrohJrmnKzvvJrml6DmnoHosIPpgJ985YCN6YCf5b+r5a2mfOW/q+S5kOWIt+WJp3zop4bpopHkuIvovb1855S76Z2i5oiq5Zu+562J44CM6YCC55So5aSn6YOo5YiG572R56uZ44CNCi8vIEBuYW1lOmVuICAgICAgQXVkaW8gYW5kIFZpZGVvIEVuaGFuY2VtZW50IFNjcmlwdDogU3VwcG9ydHMgaW5maW5pdGUgc3BlZWQgYWRqdXN0bWVudCwgdmlkZW8gZG93bmxvYWRpbmcsIGFuZCBtb3JlLgovLyBAbmFtZTp6aCAgICAgIOmfs+inhumikeWinuW8uuiEmuacrO+8muaUr+aMgeaXoOaegeiwg+mAn+OAgeWAjemAn+W/q+WtpuOAgeW/q+S5kOWIt+WJp+OAgeinhumikeS4i+i9veOAgeeUu+mdouaIquWbvuetieOAjOmAgueUqOWkp+mDqOWIhue9keermeOAjQovLyBAbmFtZTp6aC1UVyAgIOmfs+W9seeJh+WinuW8t+iFs+acrO+8muaUr+aPtOeEoealteiqv+mAn+OAgeWAjemAn+W/q+WtuOOAgeW/q+aoguWIt+WKh+OAgeW9seeJh+S4i+i8ieOAgeeVq+mdouaIquWcluetieOAjOmBqeeUqOWkp+mDqOWIhue2suermeOAjQovLyBAbmFtZTpqYSAgICAgIOOCquODvOODh+OCo+OCquOBiuOCiOOBs+ODk+ODh+OCquW8t+WMluOCueOCr+ODquODl+ODiDog54Sh6ZmQ6YCf5bqm6Kq/5pW044CB5YCN6YCf5a2m57+S44CB5b+r6YGp44GqIFRWIOOCt+ODquODvOOCuuimluiBtOOAgeODk+ODh+OCqiDjg4Djgqbjg7Pjg63jg7zjg4njgIHjgrnjgq/jg6rjg7zjg7Pjgrfjg6fjg4Pjg4jjgarjganjgpLjgrXjg53jg7zjg4jjgZfjgb7jgZnjgILjgIzjgbvjgajjgpPjganjga4gV2ViIOOCteOCpOODiOOBq+mBqeeUqOWPr+iDveOAjQovLyBAbmFtZTprbyAgICAgIOyYpOuUlOyYpCDrsI8g67mE65SU7JikIO2WpeyDgSDsiqTtgazrpr3tirg6IOustO2VnCDsho3rj4Qg7KGw7KCVLCDrsLDsho0g7ZWZ7Iq1LCDtlonrs7XtlZwgVFYg7Iuc66as7KaIIOyLnOyyrSwg67mE65SU7JikIOuLpOyatOuhnOuTnCwg7Iqk7YGs66aw7IO3IOuTseydhCDsp4Dsm5Dtlanri4jri6QuICLrjIDrtoDrtoTsnZgg7Ju57IKs7J207Yq47JeQIOyggeyaqSDqsIDriqUiCi8vIEBuYW1lOnJ1ICAgICAg0KHQutGA0LjQv9GCINGD0LvRg9GH0YjQtdC90LjRjyDQt9Cy0YPQutCwINC4INCy0LjQtNC10L46INC/0L7QtNC00LXRgNC20LjQstCw0LXRgiDQsdC10YHQutC+0L3QtdGH0L3Rg9GOINGA0LXQs9GD0LvQuNGA0L7QstC60YMg0YHQutC+0YDQvtGB0YLQuCDQuCDQvNC90L7Qs9C+0LUg0LTRgNGD0LPQvtC1LgovLyBAbmFtZTpkZSAgICAgIFNrcmlwdCB6dXIgQXVkaW8tIHVuZCBWaWRlb3ZlcmJlc3NlcnVuZzogVW50ZXJzdMO8dHp0IHN0dWZlbmxvc2UgR2VzY2h3aW5kaWdrZWl0c2FucGFzc3VuZyB1bmQgbWVoci4KLy8gQG5hbWVzcGFjZSAgICBodHRwczovL2dpdGh1Yi5jb20veHh4aWx5L2g1cGxheWVyCi8vIEBob21lcGFnZSAgICAgaHR0cHM6Ly9naXRodWIuY29tL3h4eGlseS9oNXBsYXllcgovLyBAdmVyc2lvbiAgICAgIDQuMy40Ci8vIEBkZXNjcmlwdGlvbiAg6KeG6aKR5aKe5by66ISa5pys77yM5pSv5oyB5omA5pyJSDXpn7Pop4bpopHnvZHnq5nvvIzkvovlpoLvvJpC56uZ44CB5oqW6Z+z44CB6IW+6K6v6KeG6aKR44CB5LyY6YW344CB54ix5aWH6Im644CB6KW/55Oc6KeG6aKR44CB5rK5566h77yIWW91VHViZe+8ieOAgeW+ruWNmuinhumikeOAgeefpeS5juinhumikeOAgeaQnOeLkOinhumikeOAgee9keaYk+WFrOW8gOivvuOAgeeZvuW6pue9keebmOOAgemYv+mHjOS6keebmOOAgXRlZOOAgWluc3RhZ3JhbeOAgXR3aXR0ZXLnrYnjgILlhajnqIvlv6vmjbfplK7mjqfliLbvvIzmlK/mjIHvvJrlgI3pgJ/mkq3mlL4v5Yqg6YCf5pKt5pS+44CB6KeG6aKR55S76Z2i5oiq5Zu+44CB55S75Lit55S744CB572R6aG15YWo5bGP44CB6LCD6IqC5Lqu5bqm44CB6aWx5ZKM5bqm44CB5a+55q+U5bqm44CB6Ieq5a6a5LmJ6YWN572u5Yqf6IO95aKe5by6562J5Yqf6IO977yM5Li65L2g5o+Q5L6b5oSJ5oKm55qE5Zyo57q/6KeG6aKR5pKt5pS+5L2T6aqM44CC6L+Y5pyJ6KeG6aKR5bm/5ZGK5b+r6L+b44CB5Zyo57q/5pWZ56iLL+aVmeiCsuinhumikeWAjemAn+W/q+WtpuOAgeinhumikeaWh+S7tuS4i+i9veetieiDveWKmwovLyBAZGVzY3JpcHRpb246ZW4gIEF1ZGlvIGFuZCBWaWRlbyBlbmhhbmNlbWVudCBzY3JpcHQsIHN1cHBvcnRzIGFsbCBINSB2aWRlbyB3ZWJzaXRlcywgc3VjaCBhczogQmlsaWJpbGksIERvdXlpbiwgVGVuY2VudCBWaWRlbywgWW91a3UsIGlRaXlpLCBYaWd1YSBWaWRlbywgWW91VHViZSwgV2VpYm8gVmlkZW8sIFpoaWh1IFZpZGVvLCBTb2h1IFZpZGVvLCBOZXRFYXNlIE9wZW4gQ291cnNlLCBCYWlkdSBuZXR3b3JrIGRpc2ssIEFsaWJhYmEgY2xvdWQgZGlzaywgdGVkLCBpbnN0YWdyYW0sIHR3aXR0ZXIsIGV0Yy4gRnVsbCBzaG9ydGN1dCBrZXkgY29udHJvbCwgc3VwcG9ydDogZG91YmxlLXNwZWVkIHBsYXliYWNrL2FjY2VsZXJhdGVkIHBsYXliYWNrLCB2aWRlbyBzY3JlZW5zaG90cywgcGljdHVyZS1pbi1waWN0dXJlLCBmdWxsLXNjcmVlbiB3ZWIgcGFnZXMsIGFkanVzdGluZyBicmlnaHRuZXNzLCBzYXR1cmF0aW9uLCBjb250cmFzdAovLyBAZGVzY3JpcHRpb246emggIOmfs+inhumikeWinuW8uuiEmuacrO+8jOaUr+aMgeaJgOaciUg16KeG6aKR572R56uZ77yM5L6L5aaC77yaQuermeOAgeaKlumfs+OAgeiFvuiur+inhumikeOAgeS8mOmFt+OAgeeIseWlh+iJuuOAgeilv+eTnOinhumikeOAgeayueeuoe+8iFlvdVR1YmXvvInjgIHlvq7ljZrop4bpopHjgIHnn6XkuY7op4bpopHjgIHmkJzni5Dop4bpopHjgIHnvZHmmJPlhazlvIDor77jgIHnmb7luqbnvZHnm5jjgIHpmL/ph4zkupHnm5jjgIF0ZWTjgIFpbnN0YWdyYW3jgIF0d2l0dGVy562J44CC5YWo56iL5b+r5o236ZSu5o6n5Yi277yM5pSv5oyB77ya5YCN6YCf5pKt5pS+L+WKoOmAn+aSreaUvuOAgeinhumikeeUu+mdouaIquWbvuOAgeeUu+S4reeUu+OAgee9kemhteWFqOWxj+OAgeiwg+iKguS6ruW6puOAgemlseWSjOW6puOAgeWvueavlOW6puOAgeiHquWumuS5iemFjee9ruWKn+iDveWinuW8uuetieWKn+iDve+8jOS4uuS9oOaPkOS+m+aEieaCpueahOWcqOe6v+inhumikeaSreaUvuS9k+mqjOOAgui/mOacieinhumikeW5v+WRiuW/q+i/m+OAgeWcqOe6v+aVmeeoiy/mlZnogrLop4bpopHlgI3pgJ/lv6vlrabjgIHop4bpopHmlofku7bkuIvovb3nrYnog73lipsKLy8gQGRlc2NyaXB0aW9uOnpoLVRXICDpn7PlvbHniYflop7lvLfohbPmnKzvvIzmlK/mjIHmiYDmnIlINeimlumgu+e2suerme+8jOS+i+Wmgu+8mkLnq5njgIHmipbpn7PjgIHpqLDoqIroppbpoLvjgIHlhKrphbfjgIHmhJvlpYfol53jgIHopb/nk5zoppbpoLvjgIHmsrnnrqHvvIhZb3VUdWJl77yJ44CB5b6u5Y2a6KaW6aC744CB55+l5LmO6KaW6aC744CB5pCc54uQ6KaW6aC744CB57ay5piT5YWs6ZaL6Kqy44CB55m+5bqm57ay55uk44CB6Zi/6YeM6Zuy55uk44CBdGVk44CBaW5zdGFncmFt44CBdHdpdHRlcuetieOAguWFqOeoi+W/q+aNt+mNteaOp+WItu+8jOaUr+aMge+8muWAjemAn+aSreaUvi/liqDpgJ/mkq3mlL7jgIHoppbpoLvnlavpnaLmiKrlnJbjgIHnlavkuK3nlavjgIHntrLpoIHlhajlsY/jgIHoqr/nr4Dkuq7luqbjgIHpo73lkozluqbjgIHlsI3mr5TluqbjgIHoh6rlrprnvqnphY3nva7lip/og73lop7lvLfnrYnlip/og73vvIzngrrkvaDmj5DkvpvmhInmgoXnmoTlnKjnt5roppbpoLvmkq3mlL7pq5TpqZfjgILpgoTmnInoppbpoLvlu6PlkYrlv6vpgLLjgIHlnKjnt5rmlZnnqIsv5pWZ6IKy6KaW6aC75YCN6YCf5b+r5a2444CB6KaW6aC75paH5Lu25LiL6LyJ562J6IO95YqbCi8vIEBkZXNjcmlwdGlvbjpqYSAg44OT44OH44Kq5ouh5by144K544Kv44Oq44OX44OI44Gv44CBQmlsaWJpbGnjgIFEb3V5aW7jgIFUZW5jZW50IFZpZGVv44CBWW91a3XjgIFpUWl5aeOAgVhpZ3VhIFZpZGVv44CBWW91VHViZeOAgVdlaWJvIFZpZGVv44CBWmhpaHUgVmlkZW/jgIFTb2h1IFZpZGVv44CBTmV0RWFzZSBPcGVuIENvdXJzZeOAgUJhaWR1IOODjeODg+ODiOODr+ODvOOCryDjg4fjgqPjgrnjgq/jgIFBbGliYWJhIOOCr+ODqeOCpuODiSDjg4fjgqPjgrnjgq/jgarjganjgIHjgZnjgbnjgabjga4gSDUg44OT44OH44KqIFdlYiDjgrXjgqTjg4jjgpLjgrXjg53jg7zjg4jjgZfjgb7jgZnjgILjg4bjg4Pjg4njgIHjgqTjg7Pjgrnjgr/jgrDjg6njg6DjgIHjg4TjgqTjg4Pjgr/jg7zjgarjgakg5a6M5YWo44Gq44K344On44O844OI44Kr44OD44OIIOOCreODvCDjgrPjg7Pjg4jjg63jg7zjg6vjgIHjgrXjg53jg7zjg4g6IOWAjemAn+WGjeeUny/liqDpgJ/lho3nlJ/jgIHjg5Pjg4fjgqog44K544Kv44Oq44O844Oz44K344On44OD44OI44CB44OU44Kv44OB44Oj44O8IOOCpOODsyDjg5Tjgq/jg4Hjg6Pjg7zjgIHjg5Xjg6vjgrnjgq/jg6rjg7zjg7MgV2ViIOODmuODvOOCuOOAgeaYjuOCi+OBleOAgeW9qeW6puOAgeOCs+ODs+ODiOODqeOCueODiOOBruiqv+aVtOOAgeOCq+OCueOCv+ODoOani+aIkOOBruW8t+WMluOAgeOBneOBruS7luOBruapn+iDveOBq+OCiOOCiuOAgeW/q+mBqeOBquOCquODs+ODqeOCpOODs+OCkuaPkOS+m+OBl+OBvuOBmeOAguODk+ODh+OCquWGjeeUn+S9k+mok+OAgiDjg5Pjg4fjgqrluoPlkYrjgIHjgqrjg7Pjg6njgqTjg7Mg44OB44Ol44O844OI44Oq44Ki44OrL+aVmeiCsuODk+ODh+OCquOBquOBqeOCkuaXqemAgeOCiuOBmeOCi+apn+iDveOCguOBguOCiuOBvuOBmeOAggovLyBAZGVzY3JpcHRpb246a28gIOu5hOuUlOyYpCDtlqXsg4Eg7Iqk7YGs66a97Yq464qUIEJpbGliaWxpLCBEb3V5aW4sIFRlbmNlbnQgVmlkZW8sIFlvdWt1LCBpUWl5aSwgWGlndWEgVmlkZW8sIFlvdVR1YmUsIFdlaWJvIFZpZGVvLCBaaGlodSBWaWRlbywgU29odSBWaWRlbywgTmV0RWFzZSBPcGVuIENvdXJzZSwgQmFpZHUg64Sk7Yq47JuM7YGsIOuUlOyKpO2BrCwgQWxpYmFiYSDtgbTrnbzsmrDrk5wg65SU7Iqk7YGs7JmAIOqwmeydgCDrqqjrk6AgSDUg67mE65SU7JikIOybueyCrOydtO2KuOulvCDsp4Dsm5Dtlanri4jri6QuIO2FjOuTnCwg7J247Iqk7YOA6re4656oLCDtirjsnITthLAg65OxIOyghOyytCDrsJTroZwgMeqwgOq4sCDtgqQg7KCc7Ja0LCDsp4Dsm5A6IOuwsOyGjSDsnqzsg50v6rCA7IaNIOyerOyDnSwg67mE65SU7JikIOyKpO2BrOumsOyDtywgUElQKFBpY3R1cmUtaW4tUGljdHVyZSksIOyghOyytCDtmZTrqbQg7Ju5IO2OmOydtOyngCwg67Cd6riwLCDssYTrj4QsIOuMgOu5hCwg7IKs7Jqp7J6QIOygleydmCDqtazshLEg7Zal7IOBIOuwjyDquLDtg4Ag6riw64qlIOyhsOyglSwg7L6M7KCB7ZWcIOyYqOudvOyduCDtmZjqsr0g7KCc6rO1IOu5hOuUlOyYpCDsnqzsg50g6rK97ZeYLiDruYTrlJTsmKQg6rSR6rOgLCDsmKjrnbzsnbgg7J6Q7Iq17IScL+q1kOycoSDruYTrlJTsmKQg65Ox7J2EIOu5qOumrCDqsJDquLDtlZjripQg6riw64ql64+EIOyeiOyKteuLiOuLpC4KLy8gQGRlc2NyaXB0aW9uOnJ1ICDQodGG0LXQvdCw0YDQuNC5INGD0LvRg9GH0YjQtdC90LjRjyDQstC40LTQtdC+INC/0L7QtNC00LXRgNC20LjQstCw0LXRgiDQstGB0LUg0LLQuNC00LXQvi3RgdCw0LnRgtGLIEg1LCDRgtCw0LrQuNC1INC60LDQujogQmlsaWJpbGksIERvdXlpbiwgVGVuY2VudCBWaWRlbywgWW91a3UsIGlRaXlpLCBYaWd1YSBWaWRlbywgWW91VHViZSwgV2VpYm8gVmlkZW8sIFpoaWh1IFZpZGVvLCBTb2h1IFZpZGVvLCBOZXRFYXNlIE9wZW4gQ291cnNlLCDRgdC10YLQtdCy0L7QuSDQtNC40YHQuiBCYWlkdSwg0L7QsdC70LDRh9C90YvQuSDQtNC40YHQuiBBbGliYWJhLCDQotC10LQsINC40L3RgdGC0LDQs9GA0LDQvCwg0YLQstC40YLRgtC10YAg0Lgg0YIu0LQuINCf0L7Qu9C90L7QtSDRg9C/0YDQsNCy0LvQtdC90LjQtSDQutC70LDQstC40YjQsNC80Lgg0LHRi9GB0YLRgNC+0LPQviDQtNC+0YHRgtGD0L/QsCwg0L/QvtC00LTQtdGA0LbQutCwOiDQstC+0YHQv9GA0L7QuNC30LLQtdC00LXQvdC40LUg0YEg0YPQtNCy0L7QtdC90L3QvtC5INGB0LrQvtGA0L7RgdGC0YzRji/Rg9GB0LrQvtGA0LXQvdC90L7QtSDQstC+0YHQv9GA0L7QuNC30LLQtdC00LXQvdC40LUsINGB0LrRgNC40L3RiNC+0YLRiyDQstC40LTQtdC+LCDQutCw0YDRgtC40L3QutCwINCyINC60LDRgNGC0LjQvdC60LUsINC/0L7Qu9C90L7RjdC60YDQsNC90L3Ri9C1INCy0LXQsS3RgdGC0YDQsNC90LjRhtGLCi8vIEBkZXNjcmlwdGlvbjpkZSAgVmlkZW92ZXJiZXNzZXJ1bmdzc2tyaXB0LCB1bnRlcnN0w7x0enQgYWxsZSBINS1WaWRlb3dlYnNpdGVzLCB3aWUgei4gdGVkLCBpbnN0YWdyYW0sIHR3aXR0ZXIgdXN3LiBWb2xsc3TDpG5kaWdlIFRhc3RlbmtvbWJpbmF0aW9uc3N0ZXVlcnVuZywgVW50ZXJzdMO8dHp1bmc6IFdpZWRlcmdhYmUgbWl0IGRvcHBlbHRlciBHZXNjaHdpbmRpZ2tlaXQvYmVzY2hsZXVuaWd0ZSBXaWVkZXJnYWJlLCBWaWRlby1TY3JlZW5zaG90cywgQmlsZC1pbi1CaWxkLCBWb2xsYmlsZC1XZWJzZWl0ZW4sIEFucGFzc3VuZyB2b24gSGVsbGlna2VpdCwgU8OkdHRpZ3VuZywgS29udHJhc3QsIGJlbnV0emVyZGVmaW5pZXJ0ZSBLb25maWd1cmF0aW9uc3ZlcmJlc3NlcnVuZ2VuIHVuZCBhbmRlcmUgRnVua3Rpb25lbgovLyBAYXV0aG9yICAgICAgIGFua3ZwcwovLyBAaWNvbiAgICAgICAgIGRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBSUFBQUFDQUNBTUFBQUQwNEpINUFBQURBRkJNVkVVQUFBQVpvK0lpcU5rWGxNeCt4cytLdzk0N3VleXE1ZkFvbU1sVHVkZTc2T25KNXVvNm84QnJ2dUIwdTlTSXpOZEZvOHNqcGNJb203SXVyT0RhNjk4UGpjQlcwdXhBb01vY3A5MHhqc1Irdjl6UzJjM2o2K1V6bmJQNS8vdVl0SzMvN2ROSG45REw5UGJNOXZZRHFlMENxK3NEcU8wSXB1MENxdThFcWU4Q3FlWUdwdkFNcHVNQXJ1bi8vLy8vKy8vNy8vLy8vLzBEcCt2LytQOEFyUFVIcU9yLysvUC8rL2NCclBEcy8vLy8rUHNDcXVqLy92b0JxZlA0L2YvMy8vNEJydmoxLy9jSnFPWDgvUDRCcXZmdy8vOEFyZnNCcnViLy9QdisvdklDcC9jQnJQTUFyLy81L3ZjRHBmOEtwZWtHcWQwQnF2L3kvL29OcDkwQnFmc0ZxK0FMcE9BQnAvTDgvL3YvLytqeS8vTDAvLzhMcHRnQ3Jlei85dllCc080Qm9PTC8vL1lHcGZZUG9QWUJtK1lCb2ZFQW51b0JsZUVCcnVFQXN1b0hwZnJsLy84Q3Jkc0JvdXNIcXVNTm90MEVqZG9Obk5uMCsvOEJuUFVNcE83LysrMFFvK2NCbTl3WW9PQSt0TkFGbHRBQW92ZjUvdS9BNy84Q3J2TC8vKzRBbXUyYzFPTUNsZGNCbjhnQm52d0FsZWh4dmNvQm90b0ZxdElDbnRMLzlQM1Q5ZkFBdFA4Qmx2Rm12c3pkLy9zQnMvUUpwUElVbnUwQ3NlUUF0UG0rNmZDajF1WkxxOVBSKy96Kzl1MEJwdUd4OC8zcyt2dlM4dnU4OVBlbTVmY0ZqUFJ6MGVvYW9OZ0VsTUxhK1BzZnN1K3k1T2dFa2N3UW52OEJsL3ppK2ZyRzcvbEh4dStKMU9nQXR1SC8vTngxeXRnNnNOZ0RoOE82OFA3RysvdXk2UEtWMnZBK3Qra0RzZGYrK09Vam1kOEF1T3d0dU9Ka3hkb3RvZFg2K1AzcC8vZUIzZmRlMSsxaXhlMms4UGVtMmZBVmwrY1pydVJhdmR4d3U5b0dxOGRNdSt0YzB1QWlsdFhRNnZkTXh0eEF1OXhTdDlVYm9NNisvUDRBdlBuLzcvVnh2K2NRbjc2VzUvcC95ZTJQNWVjUGxONFhyTmVuMWRVbnE4ei83LzRHaStncHF0dzluOUF1cWV1ejBPZGZ0ZVJIdDhVRGhiU2ozK2lMeHVNN251RWl1dEZhckxudDcvb1RwZk8rMTltSnVjWWVsc0VIbnEwYW1QWHArdWRmb09kNTRPSE43TjBFdXMrdTkrL04yUEdleE84b211NGZ4TDhacGFFQXpPd0w3ZmJqQUFBQUpIUlNUbE1BenNqK2hRU3pXZjZkY0NmOGZWRTRuLzM2dlJQMTQ5dk11cGNKQk9uaWhFa0hsOEx2L3J4akFBQWRwRWxFUVZSNDJyeVdXMmpUVUJpQXE5YnBOcWZ6ZnI4bnAwblhpUndTS0pSQXFDR0R0allwU2RlWGpvNHVYVHRaYjNSTVdhSFUxYUhpUk1WNVlXcTlUbEdtSUF3M21JbzN2SXRYUkp6Nm9DaUlJS2d2Z2o1NFV2RzJxZTN5c08raFRSN09mNzZjODUvLy9MckJURnMwVDZkYlhGcFNvdGNYRnhWTkhhMHlhNVFtWnVVR1R5MHFLdGJyUzBwS0Y2dkJwK255TVhmQmtuRmw1VFBIajJrNTFoSkhSS05ScVRxSGFSaFU1NUNpQ0JRRGhSb3pmbVo1MmJpbEMrYmxGWmc0byt2cWdKSk9PbDBPV1RCQWlBR0FXWXlhc0toak1RQUZydDNoVEthVmdhdGRNeWJtbVg1UytmbFl1b0ppR1ZubVBCN1M0MkVvQklGcmdrQkQ3WXdId1hBODUyRzVpdnJZK2ZKSnVuOHpkczZFVEcxZHBGRVVSYThrZWEwRVlVNlpFUVJBWU1Rd3dBQ0NNT2NnN0JZSlJVTkJHNjExdFprSmM4Yis4L05ueDhJZFBzbGRGWEs3UlRRbVlrRVlqVllqWGFFSkdnMDFXaEFSRkV4MHV5TlZicW1tb3o0MmU5SS9kbisreUx1Y2RKL1BvUzRkQW85WVZVd213YUFKQVdXalZRVzMyeWs3UmJFT1h4L3RkTW5pL0lsL3kvNDUwemYycHpnL3FLUmtqa1h3dkpuR01JZ0NOUmx3VGFDQkJnTUVHRzNtZVJiQnlWUWw4TXNkL1pucGMrWU8yZjZGY2JZNUxwNXFvSnhOSmtHZ2FRekhHWTVpR0p2Zjd5ZXJxaXFIVFZVVmlZYmFHSWJpN0RpT1FWb1FURTFPcXVHVUdHOW00d3NISjBMWkljaEFtc1p4c2dMUUtJVWcrbmp5QjVoR3lCK28wUUJhQ2xCQjRqZ05TUVllS2h1MC85Tlpnc1lJa2dRQXgxQVNEd0pvQWhzRWlvc0RRSklFQWUzODlEL3lvSFJLUmlDeEVZUVVNbE5LZjB1QTJSdjdvNElaR3pITTRXai94dG0vMGtBZmt6dmM5QWd1QVVtN3Q5cGkrcDhGYUhMQXhaM0NSMUlBUDhXNUFwTi9GS1RpVElmVDM0QURiTVFBZUlQZjJaRXAxdW5VMjNIY21Gb2ZUVkxFc0U3V3p5ZHRCZ1JGMGpXMVk4YmxUc0NNWUYxMVg2WFRneGN5LzUrSFU2c0E3bkZXOWtsMXNSbnFTU2pwQ2xoRkg5VmtLQ1IzSkZFRjNWVlI5TlRZMk9pVm9DWUZReFBsYzF2cnUwclVIZGpNYkFnNVpCTk5GQ0NBU3VYM2lpSUlPQ3EyVlJFanBrV0FvRTJ5STdUQnMxbmRnN0lnNVhXem5JRGxGNkR0cmw4NEVPaFAwd0tnRCtCWXQ4Z0Z5MUFSS20ralJEZkZDaUJmNXFMOUptMDJHMmY3ZnNjd3FNOUJUOXFTQUFnc0VtRGJpc2ZxcHMxTWVKQUFUNE84K1FjQlpzMjFtMnFESTBtbWFsTnpjelBVdEFlQVpsblJ5eVZtVHRPTisrQzBlVVVrQVBPdEdwb0tXbkRVSW5WMmRrWkM3azZqa1lhb2FVMEJPSHdCU1BPVTZMVTV4NWZxU3NhNFpFbWkrUHpTa01CSmw5cXJodXNWSlJ5dUR3U1Nzb3MzRTBoQ0F6d2xTYklMVlFKOWk0UHplaW4rdjZjZTNkTW9SY09LRWx3ZFhYUHRiSGQzZDI5Mzc2czFBOEdnVWg4bXpJQWdRSzRzcUQ5RXdRSmV6dEdpUndMdE9RSDg3MlVQUllRNE1yQ1RpdEptUG50ajdaVnN6KzVOT1k3c3pwNjVjWDlyZlZ2QWJFYUdxSDhCT0lTQUtjZ0E1eW52ZDRIaVZwWXlSbERiU0E2WjNSS2hEVVFxUmRuZU45Zld0bXpvdmZodzk4TTlaeTVldXI1TDVmWGxneGV2OUd6WnZlZjZnOWFnVWxPVDlJU01xeHlQR2g1VTJ3c29hV3JMYTZUWTFtSmRVZHpBb0JmSWtVUExGYlJzRDBXYVpBZmYyWHIrWk0rVzdNNzdOK09iazU1d09zQ3ZXNWRJSkpLZEw5NDgzM0hoeEpuZTF0V1dkam5xeGJheU5jOU1UQUVDSEl6Z0ZFTzNGaUVCd0pndFZteW9BTERKcWUyTjNqWE5TckQzWWphNzluNDhFUWdmT0o1UVZzZlNmRkpaSFF3a2srbWdVbnY2WkxibnlhMjRtS296Zlo1OHA2NmRGY2dDQkRDcnhjd1k0a1c2cVZISW1JMVdNRVFBZ0liK2lqcS9MM1Q0NVpjVDJiczNiMjRNSjlMcFQxOTc3ejErMjIyNmRmRHg5ZDZ1YldrbEVZRHJ2YmYyOSt4Lzg5SFNIaC8vb01MRjBGaUJBaVNNVHRXTlJnSXBKR0FibWdPTkd3aVhLeEM5ZlNUNzVzUEFnUU50NnovZlBibGozNUc5SzVZOW5MeHorZktWZS9mdFAzbnVYV2JnUUNJUnYzLzB4Tk8remV0a1gyaE5JYjBkYVFOSXdBT3JrVUExWnYvR2laMTlOWEhGY1FEdjh0SUhYOXFuL2dHRUpBVHZ6QkRJWkNhVGpUQWtnMWtrZ2lHSmhBUWhJQUZLUWNBbExMSTByQUpGV2hZUkVNc1dJV3hpbzFRc0xpakZyWlhhVmkxdWRTdldVMXR0YTlkTGtkYmE1WVIrejBsT1p1YWVtVTkrZCs3Y21ZRVZZRVBBTXhHK2VmemdRUG5kMCs3SjZXNnJ2ZkNyL2YyVkJBWnNSbzhYR2ZuNkJzajJlbTBBays2NWZXYXF1djE0K2ZUMjA2MGZCSVZINnFhanhiNEEyS0VCbkdEL3RTOHNBa0lEL3dIQVN0RUdQQmdrN3QrMTdvaEt1UFJlQ3dFQUJoQ2IwV2hCanE1NUMxWE5Xa2dFd0tDTmcxK1dKNWFVdm5qNThQdXZWd2VuaXJnK0FPTFpnUkRnOXhUZzc3Tkt5SGxEeG1YNTRJUG1rdXJWZS9OaWpFMjRtVWFCMlVIemthUHBZN1Naanlna0tFcGs0dGxNWThkVVd1L1dXL1AzMmk1WnMzZ3NYd0FiL3dRSWd5RmdZd3IzcVZtSFo0Z1Y4YlRURHg3UFBTei85ZUNWaDExU0NtOXF3dW1kRkViVW1HYjVMYTljbG1vb0lEWExOVklwbFcwQllOZDJ1emE4ZTBYbDZLRjIyVXF4Z1F1ZmY0VEMvd0NrYkF3TTVjZzRFUERxV2hhSEU2Smp3K3ZZazhPTDJPTDY5RGZqejArLzh0M28zZmJJbGNVZEZvclNLQlFvcXFCd2xkemtiTUozdlhJWk1BSVZLbzFoSkFvRU1Uc2NRUERKcFMwUnVidEhkcTRvU2xrekVMcGVWcnNwaC9NZlV6dGJGOElSc2dKZmZlNTUrQXp2eDJPemxINUxnSFIyMUVEWk45cTRYNzY3dHlZM1ArbFFGd2JNWmhRZUJ3R1lCTkdvSkNaajNxWnRJRWFnQWloQUhXYWtRa1U3YUFBcWIzWkc5bDVwKy9idWxlbXluSjZxODdzM0NmOFY0S2Rrc1hudzFVL2c4ODg5SHhnUXdQa0RBQVBIUno1YmRERHRWTU5IVjRmWGxJMmZCb2pKeUFod0JNR3dtTDhDVUJSRGFaUWtjWnNOdDVDZzc4eVdRbnRaVitzaFY5MzZEY29jY2I2L2p3RFJBbURsSHdCZHZYSjk1TUNGeC9ldXUxN3JQRHNLNWl4ZWo3RUFWNmxVVkF5cStDc0FtbFFrU2RrWXBtbDJEdEF6eGNtNXJ6ZnN5dWtOVC83d2dIcEgwTDhEVmk0QVdQOEVnRW1PVG9rc0c1eDQySDYrN0d3Zmd1Q3pPQVlXZ3RtWVp3RUFnNlVCQVA0QUNHNlpJMmFLMzh4NnViS3RORTUwSURRODJGY0E2NjhWcUUxZnR5UHJpOFBicmVxTThWRmtWa0FEeDlHeC90dHVHZ2orRHFDOEFrQ1B0dldQdGJYUVpBVkp6N2kweGZPZ285eVFZbWdPNGZ3UEFQemVrZk5hOHRyVyt3OSt0YjdrQnFTQWtoN2RuMU1FM3pTZWJNWGtDdVRaQ2xnb1I4ZlZpeGN2V245K1JHT3pGVFZuUzRPNzc5QkRWblZLZWJUNGZ3Qmd4Q202emtkNXAxTHJpeHVRT1EwaEhlc3NTb3lQaXJBT3Y5UkN4endEd0REZ09ERmNsTFUxd3REZHVUZVRiS0w2aHJLQ2J6MXVMUk90dDdPV1dRRWU5OG50b2pyamJlS012YmU5SDB6TTR1aG5uZFZoMGJFeWRSVnZlRk1laG1qd1JRRDZCSkI1OGxaMFZXUlk4cnM5V2QwemhORkw3WXV2S3IzVzEvRmdvQ1NMdFN3QWl3WGJ3NnVSLy9xd2k0KzdpcXZhSHdMZ3pGYTBYczFWNTZ4VHl1QlRDQy9qaUpuU2tBbzVBd0dZU2dESEJJSzJEWmNmck0xblJhZSsyV09mL3F6QUkwQTdFclJYT3ZwV2ZLL2R1anhBZmIxU3hQSXppTVhIclVkMi9yeWxaT283RmQvb2NieC9KVEcxTENDMlZoWVd6M2FsdTIxU2hRVUhlUWUyWVNTamwxUWd4TjZpT0dWcTZ1cjRsTmMyVkNXZGtNTExzdmZ0RXUyNnloKzM3SkNGTEF1Z1ZJb2dnQ3NPVGlnL090WnBUWmlrVlB4c28rTklhVVJ6T3R0UHlPSFZzVG5XWXphelFoQ3pBQUFrWTVMd3daNHBhMzUrOU9wMGczYXRzaXJoMmg0TVI3SGIxcWp1OTFvM2hhMWEzakFVd2NCcGdST2MrOFZIWDJZa1hHckU0SjlsaUhPNVZWeERIWSt0MDIza3FaUHVVTFJFb01IeVRpMEE5QkJRT1dVSUMrY0dwblBDUW9QVTRrTnVnQ3RRK1FlbHJ4L2YxVkhLV2Q1SkdLSUxZVUdBME4vVjhFTnh1MzBTMHhBU0M1bDV3bFVWcm8zZzVRUUdzb0xWaGR0c3RBU1hVazhERWlPMUticFFWbHhJc0RyeGVpdXdNR2F3TDdlNmVuRGtlTkF5QVJ2OS9lSmdKOWpISGR1MzlOYU9GZ2dJdW1JT2ZWUmNxNDJVY1hYcDBjbHhFWWtOREoxSlNTbjNoMHNBeDNodVpJbVdGN3B5ZzlBZ3l4aXFBWGlCa3pTZDdjMGFiL3dpaWNQaEJ2a09ZTmR4aGJHaWdMU2tqdEVMdWRWN01hTkFZdVpYZ0gwWFhDbXlXaUc4UXgrb1Q3cE9HUFVTRmF6QUVnQ1JkblRuYkUzaEJpamp3c1M1dzU5S0FjWVlMZGhZYjRLdTVWaEdHbnpSN3p1QVo0RHpjMXhBUWtMTG82SkVWeHZHeENBb2dnRHA0QzEyM0FiL3VsVWJCb3FIMnpDdlFxRXlZM203bHdCbzQ0cGhtWmdsVXJJaVZ0MWEwUWNRbFliUllJMmJ5aE9QVkI2eXd6dGIzd0Zjc1RBdU5sWlgrazdqZTFsWlgrNUUrQW9Fb3drcGxubHVPRmxaMXhOWjVScStnMm84SklMUTRIZUFFd0lVZXF6aHBhTDhIYldyd3RRWlg3c3hGUjhsY0xrWjNWNWVPTFh6NDhTZ0lBN1hEdzR0WHdId0ppbzA2VWpsTlczYVRBdzZNYUZSMFlTRUJIc20xMjNKdUZKYU92VStpbWk4SkorZnVUZ01jYW1DaitncDBESmU3bkxsSmlYdGJ3R1VBRUZwWEU1Z2w5ZWxoYnFQMmVIak85eTV2NC9uUU93RzN2cTYrZ3MzanBaSEJiVmhjcjNKaGloZ0pvQzBvZVBFaVpOM1dnRk9vbEt5WW1LQ0dqbCtBMU9RY0RPQ3FERGd1RDE0N3N6TS9YdGdvVDJpRUZBb2NLOEpiMzdVOEdHK3pKVXE3cWtMNFBvTWlFaSs0TzdQS1BubU5JVXJTSTFKRG1NeU9TbFVTa3VwQXEvSFk2S05SdHJwYVZtM1RXb3lPdVY2dWJPcHFVa0Zad1NDcGhqWWRLRzlBUFlTc2IrazlJMitJWEg0NjZtcmV1cVVmcjREVm4vZWVLUzY5L3BPQnBZYWR6SUxjV2JqZkF3MTA0Y1A2NTBGTnE4WGRYcEdkbC9HQ3J4R1c0eW00TnR2NFdGUkdNYkpMRVlqUVVqd2NXLzd3NzV6YWVyQTFHQXRWN21NQ3JqT3V2ZEhKWDZnTndveTRYNmVwR0tPcjVEU0JFMUxTTVJpVWVETXlJRWJHR1hCTWRnRGtLV1hURXhNVkpCTDBkZG9zbTM5V1NWZnVVL2Fvd0pUWlZyaE1nQlJxOCs0eDJXY1NhZkhTZWpSek1YUUV4YUxBS2NvbFFMSkpCUVN4MkhRb2hzejA1a1NncUFsQytjQndvZVJaRW9XbTh2MUdxUHhzK2J3L0padENWdlhRa0Jzc2ovWDV3bzB6N2l2R25MN0dZOU5vdExJbDZLWHl6VXhLbjRGS2FjWnA4UGsyYlY3bTlua05PbjFlcE1BaG5FNllUOHNCZlpZazNIZkdrTkFTeGNFSk11MG9tVUE0bDJURGFjS000NWhEQUFJTG5nU1NvckdVQlNHSVNvQmxwME5zajJ0MSs1akJVYXZ6U2JJTGxpTTB5bFlpb1hQcjZCT1h5MU0ydGRsM1pxakRGOFdJTUkxMlhVcXkvNkptV2hzSk16RTA2R0poVGdJb3NaQmpmeDBESzZnNGRKUzRNSlNIRFUxRHZTamR3cVRqalUwSjBKQWp5NmE2ek1neWpYVHRWc3RIcCtmSHhxQ244MVA4dlpDaG1BMncxWGptK2ZIMWUrYzNYeno1dWFudC8reE1IOXo2TzM1emJGUjlpVkFqbStBM3pnMTk2Y21yaWlPLzhBdi9hRi9Sa2hDSy9zZ0pDRmhreVVrQ3lSa0VVSW9oSmlYQmxFRGtnWkNGSkJBQklRVUJFRlVGQVFNSUNKVVJFR3RnaWpTUXJINEZxVVdiZFhhc1dPbDczYjZtSjZOQm5WUUIzb0dacGJac0h6WWUrNjk1M3kvTjQ4VnlpUWh2SUdFd3FuNWlvbkorWXJ0Z1pqY3ZoQVZGY01WODVmVWw0Y3JLaXJncDlmRWZNVWtmSmtTU29hV0R3QkpDQUNGR2JjUXNyYVdSUFRrODlBL0M3aUFIcEFpa1dQMTQwd3ZRdXF4NXdHZkNWeGhDRFNLK2oyZE5TV3RqZWJDNVE2QmlrbkNWTmNRb2FSc01qRXZFR2dnNGxDaldHN1VIWDc4QUlremltSCtpWG1MZ3RBNHhNVGg1RnhySzVPRTY1YWNoR3lUSCtEaTlFaUdwNCtwYm9WR1lTQ0laeUczS09WT3A3N295SmFSQjNpUjB3bGJzMEM0T0hCZWs3c3hKM2Z0NExnVkFKWThEVmwrZ0wyWFd1NFhsclM3anpnUmxBN01iVTBnWkRLUlVtbExoNzJBV1FlS0tKR0dabTYvL0owdVMwTUI0RHR6SWVkWXFWV1Z6eXhFeXdEUXBseHVtVkxsVHNsMEFneVZVdnJuSVYwSVI1eGNsTzdldDJrWFJ0SzB3eUdWdjdnVHVNQ2duOFhiY3pkME1rdnhCMHRmaXRrc1B3QnNSaGxsOXpzc0JEeG9JWGd2d3V1RldubkxKdzhRbmxqTWUyMWdJS1lndlljS0w5ZnV6bFova0JYdjM0eVdQQXZXelRUMlpaYlZiMEZ3N0FVQUwwQWhGa01TU290MHh3QkFET2tvaDF1Qit3dEJpeDFZODVsRDF2NmVrUkFBOEcvSFN3ZG9tQ205VUZCV1BnNEFvRWY0QTlaZ3NybFpBNjI0aHFZMVNwckpnV1FtQjJTVVNFOXJOQ1NPYWVBK2FJWWFmeFE1TmRqMG5VT3VyNmFEaWdGZ3lRVUpDNHg3TUIrc3ZWQ1NsVnlrVVlkWUtxTFMzRTFDaEd3ZE8zR2k5L3dnNkZMR1U2TWl4MWxpMzRGZEdBMlZEMGhrVFVMczJybGV1RC9VZ3dpTlorV2tLRjNtUUwrcVpKbW14NjBnZi9GRGxscVNRU2RwQ09abWwzZlc5dWZXZkQrS1NsRTVLU1VFQXJ4bjhxQUhqQW5QajZVa1lUeFNLNEphL1JnQStFVXFEQmNpZzNNRjFzeE0xOEZ2QmhISUNvUlV5dVM4N1pWaG5WQ1VzZ0pGNmRJQk9OYnlmZDk1d2x5dHVDQ09LVWh3Yk0rVlI5c01YRVZNWHNHalladncxQ2lGZXZHWEFNakJId2RZcWgyUytMMittUXNJd2tOeHB3QTU3Qy9MRDJSemw5V2UrOVVCTnFmOGZNKzcyKzcxVXFjRWNpOUlYN1pobjJsOVExMU1rbXFIeDNjTzE0bW9PUEdMTjRBajEwWUdUQXJ3anNMclR2dm05a0JmUUFpOGx2YmNUL09PelhwU2w2Y1B3T21qaURBV3gzckhWbEhWeHQvdlRwZUtCVUpzTU1oY2JUclpJQUhIa09zNjA2T2pTSEVBUU1nQW5EOFlhd3JYcXRqQk1lcjRnWDRNdDlCaXRQYjdzcHFqdFpmTXk1Tm9ERnkvVE1sbEY0d3p6ZWtZVGxOcFNndlZiazlLTXAzTWVnL2syNGppNkVhM1htNlVCd0JnUTNLY3FGcTMzc0Rock5pNElVR2R1YnNaVjhxaytHemlqcmErL1RtUkljc0ZZQTZlQkJlN2RsKzdZbjgvK1JpaG9keHUyOFBNaEtUSXJLeU4wZUFiUjdsS1FhQVF3bTc0aVg4SUFPQ2pyeE5UUXQ5Ym1iOHhzYjQ3cWVhYkZseXBRWjZjeVA3dy92RXhsK0YvQVJoTVpzK3RRWjg1K3p5UnBoZTRteCtXS3d6UllXR01lTURTWnZZQmdFRDJNc0Jua2JHaFlSeCtjT2ltdk9xTWtXbklYWHkyUE9GZysvNnIyUkl1MXk5QXc0TVhQTGpuQU56WEEzQTQwS0diOHMxVHRtOFBKaVUveGRFbUp6bFdYbHdabXFDS01Ka2lKQWtsc3d5QUJscXp3QkEwZDRaeDJlQWp4OWRWcnJ1ZStuVUhjUVA1NWV1eVF5bkgyMzNjMWZBZitmL3d5eVlrTVBEZmtJVEE1LytGR0VYUTB6OHJFOXAyeXhCakUzTE9zN2FoSVg4Rm54VUNWdG45M3duWk01RXFNQXV3aC9hNm5lRnI2dk5YelNTck4vUnFuRUxrWm9saDROeXRtWS9WZVpXSnNhQjk1Vy9LVTBmRmM4SHpUUW1OWVlHT3I1RHdvMSszRW5LZWUxVmFkY0c3dGVmTEQ5M3JSNGdtck9PeHF5NHlKVHBFa3Jvanp6NW1RZFA5TXAwZmdNQmdGZ3dPWkYyUDJ2QnpmdUtCNHR4N3JXazZZcnd0d2JjZGZJNnFtc2lUc2N4NXN1amthRVU4TjVnNW1SZWg1a2J6SlZvRmYwWHNZb0FGdWY2OTRwMmVtODF6ZjBnR3VoQm5FZEphNVZKVVY2dlZPL21QNXE0aFBGcjhDZ0JPRFQvS3FrNUtVRmVydFFQelJCRXgvVVhvM3FBTzVFbmpsU0JYM2M3QzdqVTdES2NiRHVUQWlUeUpLaUVtY205MFdMeENzakw2TFFEc2s2czJxTXVuZi8vM3V2WEhQL0VtaTM0OHFJb2RIcVBLSEhoM1AwbUFVUGtxQUt4VWp3NldGR3FqQ3UzelJUcjNuak0xV1RQamlCZEhzTUhlZXJzVkR1WVZSMFd1U280T1NkVW1KR1VVNUt4a2g4U0hjUGh2Qm1DSG5MN3ppVlo5TkgzZVhPMmFhOEZoVUJzdlhiMzY0YWFSL2c2RVlMVGlWd0Znclp6OTVwMHZ2dGpVT2FROG9yTk5aV3Q5L2ZDZW5EZkVtR2o2NXRXdEoyUGp1MWViaXNNVkt0WHFEUHRFYjNZcU41alBlWnRjejQ0eFhGMVJ2VzBTdlpsYWJkKzhIMjlLeHh3ZmRlMGFQQzVDaEFKTS9pb0Fnb3Q1Q05ZejNkWFYySnltYzlmMjFwUzVya2pSczZPL09KMDBKT24raTk5djlYeWFFUk9sa0dTN2ZGZmJPOGJLRmZHUkc4TzRid1lJWm5YSC8xSDVRNTNyTDk1VXpXclA1c09JUlNoUTR2QktFVlFzVEZzTUFMVXg0eVhnT2gxUk81VmJaai9hZ1hyVFJtdlRsUmFsemdLZTN0REVIZk5hMkMwTDNwbTRZTk5QWkNaSk5pYXl3d01BaXl3YkFLai80WFRLcHFnbyt5N3FxR2UxL2M0RnFFNEZRcVpFamtPeHhRQUU3aS9YR2NpV005WXkrOXdlM0NoSG9TeWdVRm9tTkhwQnlkdDNxKzkyKysyaDR6WVNJeWN6MWNXSnE5aUsyTWlBWmJQWXRLcGMwUjIrTGw5dCt1bXA1V2hOOWRxZ1VoeVJTdU1FVG1jYXFRL0k5ZlZRa0R3RGtOSHdjdlRRckNCZEkydGpQSnRiRU1Ib0tPL3VYVXJrZFlpa1o1a0dWMmdoRUFqbUVUZ0ExRlZXaHNRc0FDeXk3ZGhjT0h3Ykg3cHk5ZldzZjU5aVk5YnJld2NlUHNFUlNrTVRhQm90UkVsTlVaT0ZzZTNpR044VWo2T2JuRXJTSmtLYWJudjJaZzlzN3JBYzBhV25HMi9jQUFtTHB1V28yR2l4RkoxeUtna2Nxb3NtQVQ2OExXbE4vY2JZaUJCK3dMWmJiRnhDbW9hOXp3M21hTGNOOU9sdiswNmEyaDdQMmhDZTF4aW5rWWxSQ294TDlNOS92MklrTWdTVGk0MjB3R2drNk85MjF5U1pmY004OEpZdHVBVTZlZ0dJTlJiMExIeElEbFlqYlNIQWQ1SWp5S1ZLYlhjM3R5RTJZRnkremJvTjNsQlNkVkgwNEoxdDFZWG1NNjAyb1VCSVVTaFBhdE43MFF1clNrVU9GS3BXSEJHUk1BeURFMlpWbE9lZFhWUmozN2x6dDhlUDE0b3dYT2trVUJnYkNrUHZlbEZnWlZwTURCbXVWSFN2TWNRR0I2emJ0NW5YZklVNnhYZWw0OG12bjU4dUs2KzZQTlRoTjY5Uldua0QzWGVnRktSMHA5dkMyR21pcmtzNUpkb3kzKzRXMGVUTTFzeTJlMThldU54K3pZWVQzcnN3WUtNeStWbXZGelJkaXRLVEtESzhsYXRLRFExOWY4Rzhmb3Q5ejQzT01hdzMvLzJnNTdkL3RucCticXZwSE83cW9YRFFncDNJRnNnQnNOSGRCTlh6ZS8rWk5XMlpIeFo4TnR2Uit0aWVHbUhPeVNpemVyYk9UUXphVUs5WG9BTXhUK1NBdVVES2FJdFFEQUFHaVdFOVAyL0J2bi96QVFaV3hIL04yMXVJRWxFWXdIR0lJZ3FDZW84ZVlwdzgyblhJTW14S3dyUzBXZzNORnkzTEhFMmNDdHh5MDNLdFZWUk0xbHQwMisyK21WMFdvOXRtRkczRkdsWjBaZE9JNkVMUkZ2UlNEMEVGZlROR1ZHWk5XZGFuSUFOeUhPR0FCL3o5ZTNydTNKa1lTRi9mRWVsN1lISm1kbTBvdkR5N2Z2K09TTnUwN2NPZVQybHJpK3cvMG52SzBaSzJacUtKczVIMjNyUkxyckZMSExnZHBGellmZTNwem9Oakoydzl2V3J0K2ZualppMXVibDRGbTJYODFiQVhXN1pNbEdBQkEwbXM2RmVkY0dDOEpmTmt5ME9Gd3Q1Y2FjZnQwdEZRRVBsOXBrQlAvdVhtcDRkMXA2NWNlZkZrTmVWMFVwU0Z1Sis5M2Y3dWZVRGRhY2pseUR2R0JwNXhrWkd3N0dyNWNLOFYvdGRiT0huNjlMbXptNXNud1U3WS9paUlpR1NuS0FHRVF3Q0dCQWhIVmNTQ0U2bU5yNjhWM29ZU21VRFRoVXZITCsxK1JOSEJhTVpDbUZaU0tkb1hqVG85bnNCRGF2bmg0dkZEM2VmUy9qbGpRb1k5VGJLTjRtMFNubGlsVjJxU2haYWpKOXZId3phWk9YZnkxQWxnRFU3bVhNWjRvNjFUWkM0akZod1FTMVhHZ3lQZC9kVUp2VmNxVytTbE40UXZuMmh0UFhIazJlTWVqOUxpOHhFQ3loZTFMTCsxdVcvbmx0Wk5wZHhLVDZ6VDBiQkVHb3RoT1ZHTWo5T2prRVJpUHVDMHVoNWQzZjltOFZobTJwN2YyT3RlSkRjbmRQRHZQc040VkhwUU5BQ1paR1FGWkdLSE5JU1NVdjg4ZVV4aEVpUFRCdmVEM3AzcnRrUU9GYnRMZmIzWmJMYlVYYndFcU9wWTMyTzNkU2t1MTNhRlJ0bmxxWlFvSi9KaVF0QUJFa1hpdFYyak40WHZycm5ZWFN5ZUxOMXd1N2NadlhDdUVTaEVqU1FEbVVpQVRJd2xrMWFoWEloRVFOd0pBc0ZoWGN5bmwxb3RNNTVsajV4bzM3ZVBsVno3TnEzUDNoeEcrNncwWkJBRUhOdVo0eGFCaVRHY01aYzRJSEVqaitDTGhUUUYrMFJ2b1NnYWVma01ETU5oMlRMbDJ1anUvMlBNaHRnekdnWXZzS0FLVVVzSjJ1VnF5bmQwNVBNZCtkVXJYQ1lKajhaVll2NFhiLzd5REF4ZkNxNVY4S2tnMGdqNEVwK1doVGZ3UG1NMjRIeEtBd2ZPaC9nRUlTRG5hT2I1L2Y2TTMrTnhadngrTGFoT1BzYko4OEV0Vk9GOFhFRWpRZ0FxaVlZRU0rWjRZL3pWcTBUaVZTUDhvbkR3akFqaHdPeStBeHI5QUJxQmRKSUd0VlQ2VTlLSkU0aVVoRUR5cW5YSnBNMld0S21ERGtkWEY2dUxmNjRoNGZIVk5keUFUcTFuU09lQVFRRVpGOVFLQTl0S2tXUmFpMldmUnFGSUpqSDBtNmgxb3M0dzBUZDBBTXQ2NFFZNHNWNmUwR3ovZG1wZ3ZVR3BkUWdMbTFVT2pyQVpRL0c0RU9FaUdNaFFDQ1FVeHVNSSsyM1kzS1VLREdScE56VkR4NUYyOHhRd05tWjBPcHVOdWFoQ0JMalJibC9IWUJhM3J6U1BMdVAydWcyTDJ4ZXd1UDBYZVQvNmRyQ2FlZi93ZnhzNGdDMGZ6aVlleW5vbkhzb3ZFZytJWEpTeCtrWXVFbDFNdTdMLzE1a1BYYy9NcDZHSnlYeituOUNKU2Iza0tvSmZ2OVNMRDZsWFpleUc2aFM3QVJqSDl3ejUzM0kvSm5oc09aUFN4djk2OENqem5nbEQ4UGo5NUZQN1Y1SlBPUExDZkU0KzVaQjgvcHZvMVFiUjZ5STJldVdZL1FwVVlwZ2FzMS9tU3NDc1pxaklmcXVFejFhcUhENHI5YVFVTnFHcXh2QlpUOEpxZXFWV1M4cWxRc29LNFRQMzlGdmVBQXdIcnkzOWhpY0NJcW1wU0wrNXh1OHIva3o4bmk3SDd5TkhWT3orK3ViL3d5dnovNDl5SExOYXVnYW9FQUFBQUFCSlJVNUVya0pnZ2c9PQovLyBAbWF0Y2ggICAgICAgICo6Ly8qLyoKLy8gQGV4Y2x1ZGUgICAgICAqOi8veWl5YW4uYmFpZHUuY29tLyoKLy8gQGV4Y2x1ZGUgICAgICAqOi8vKi5iaW5nLmNvbS9zZWFyY2gqCi8vIEBncmFudCAgICAgICAgdW5zYWZlV2luZG93Ci8vIEBncmFudCAgICAgICAgR01fYWRkU3R5bGUKLy8gQGdyYW50ICAgICAgICBHTV9zZXRWYWx1ZQovLyBAZ3JhbnQgICAgICAgIEdNX2dldFZhbHVlCi8vIEBncmFudCAgICAgICAgR01fZGVsZXRlVmFsdWUKLy8gQGdyYW50ICAgICAgICBHTV9saXN0VmFsdWVzCi8vIEBncmFudCAgICAgICAgR01fYWRkVmFsdWVDaGFuZ2VMaXN0ZW5lcgovLyBAZ3JhbnQgICAgICAgIEdNX3JlbW92ZVZhbHVlQ2hhbmdlTGlzdGVuZXIKLy8gQGdyYW50ICAgICAgICBHTV9yZWdpc3Rlck1lbnVDb21tYW5kCi8vIEBncmFudCAgICAgICAgR01fdW5yZWdpc3Rlck1lbnVDb21tYW5kCi8vIEBncmFudCAgICAgICAgR01fZ2V0VGFiCi8vIEBncmFudCAgICAgICAgR01fc2F2ZVRhYgovLyBAZ3JhbnQgICAgICAgIEdNX2dldFRhYnMKLy8gQGdyYW50ICAgICAgICBHTV9vcGVuSW5UYWIKLy8gQGdyYW50ICAgICAgICBHTV9zZXRDbGlwYm9hcmQKLy8gQHJ1bi1hdCAgICAgICBkb2N1bWVudC1zdGFydAovLyBAbGljZW5zZSAgICAgIEdQTAovLyBAZG93bmxvYWRVUkwgaHR0cHM6Ly91cGRhdGUuZ3JlYXN5Zm9yay5vcmcvc2NyaXB0cy8zODE2ODIvJUU5JTlGJUIzJUU4JUE3JTg2JUU5JUEyJTkxJUU1JUEyJTlFJUU1JUJDJUJBJUU4JTg0JTlBJUU2JTlDJUFDJUVGJUJDJTlBJUU2JTk3JUEwJUU2JTlFJTgxJUU4JUIwJTgzJUU5JTgwJTlGJTdDJUU1JTgwJThEJUU5JTgwJTlGJUU1JUJGJUFCJUU1JUFEJUE2JTdDJUU1JUJGJUFCJUU0JUI5JTkwJUU1JTg4JUI3JUU1JTg5JUE3JTdDJUU4JUE3JTg2JUU5JUEyJTkxJUU0JUI4JThCJUU4JUJEJUJEJTdDJUU3JTk0JUJCJUU5JTlEJUEyJUU2JTg4JUFBJUU1JTlCJUJFJUU3JUFEJTg5JUUzJTgwJThDJUU5JTgwJTgyJUU3JTk0JUE4JUU1JUE0JUE3JUU5JTgzJUE4JUU1JTg4JTg2JUU3JUJEJTkxJUU3JUFCJTk5JUUzJTgwJThELnVzZXIuanMKLy8gQHVwZGF0ZVVSTCBodHRwczovL3VwZGF0ZS5ncmVhc3lmb3JrLm9yZy9zY3JpcHRzLzM4MTY4Mi8lRTklOUYlQjMlRTglQTclODYlRTklQTIlOTElRTUlQTIlOUUlRTUlQkMlQkElRTglODQlOUElRTYlOUMlQUMlRUYlQkMlOUElRTYlOTclQTAlRTYlOUUlODElRTglQjAlODMlRTklODAlOUYlN0MlRTUlODAlOEQlRTklODAlOUYlRTUlQkYlQUIlRTUlQUQlQTYlN0MlRTUlQkYlQUIlRTQlQjklOTAlRTUlODglQjclRTUlODklQTclN0MlRTglQTclODYlRTklQTIlOTElRTQlQjglOEIlRTglQkQlQkQlN0MlRTclOTQlQkIlRTklOUQlQTIlRTYlODglQUElRTUlOUIlQkUlRTclQUQlODklRTMlODAlOEMlRTklODAlODIlRTclOTQlQTglRTUlQTQlQTclRTklODMlQTglRTUlODglODYlRTclQkQlOTElRTclQUIlOTklRTMlODAlOEQubWV0YS5qcwovLyA9PS9Vc2VyU2NyaXB0PT0KKGZ1bmN0aW9uICh3KSB7IGlmICh3KSB7IHcubmFtZSA9ICdoNXBsYXllcic7IH0gfSkoKTsKCi8qIOS/neWtmOmHjeimgeeahOWOn+Wni+WHveaVsO+8jOmYsuatouiiq+WklumDqOiEmuacrOaxoeafkyAqLwpjb25zdCBvcmlnaW5hbE1ldGhvZHMgPSB7CiAgT2JqZWN0OiB7CiAgICBkZWZpbmVQcm9wZXJ0eTogT2JqZWN0LmRlZmluZVByb3BlcnR5LAogICAgZGVmaW5lUHJvcGVydGllczogT2JqZWN0LmRlZmluZVByb3BlcnRpZXMKICB9LAogIHNldEludGVydmFsOiB3aW5kb3cuc2V0SW50ZXJ2YWwsCiAgc2V0VGltZW91dDogd2luZG93LnNldFRpbWVvdXQsCgogIEhUTUxFbGVtZW50OiB3aW5kb3cuSFRNTEVsZW1lbnQsCiAgY3VzdG9tRWxlbWVudHM6IHdpbmRvdy5jdXN0b21FbGVtZW50cywKICBjdXN0b21FbGVtZW50c01ldGhvZHM6IHsKICAgIGRlZmluZTogd2luZG93LmN1c3RvbUVsZW1lbnRzLmRlZmluZSwKICAgIGdldDogd2luZG93LmN1c3RvbUVsZW1lbnRzLmdldAogIH0KfTsKCi8qKgogKiDlhYPntKDnm5HlkKzlmagKICogQHBhcmFtIHNlbGVjdG9yIC3lv4XpgIkKICogQHBhcmFtIGZuIC3lv4XpgInvvIzlhYPntKDlrZjlnKjml7bnmoTlm57osIMKICogQHBhcmFtIHNoYWRvd1Jvb3QgLeWPr+mAiSDmjIflrprnm5HlkKzmn5DkuKpzaGFkb3dSb2905LiL6Z2i55qERE9N5YWD57SgCiAqIOWPguiAg++8mmh0dHBzOi8vamF2YXNjcmlwdC5ydWFueWlmZW5nLmNvbS9kb20vbXV0YXRpb25vYnNlcnZlci5odG1sCiAqLwpmdW5jdGlvbiByZWFkeSAoc2VsZWN0b3IsIGZuLCBzaGFkb3dSb290KSB7CiAgY29uc3Qgd2luID0gd2luZG93OwogIGNvbnN0IGRvY1Jvb3QgPSBzaGFkb3dSb290IHx8IHdpbi5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7CiAgaWYgKCFkb2NSb290KSByZXR1cm4gZmFsc2UKICBjb25zdCBNdXRhdGlvbk9ic2VydmVyID0gd2luLk11dGF0aW9uT2JzZXJ2ZXIgfHwgd2luLldlYktpdE11dGF0aW9uT2JzZXJ2ZXI7CiAgY29uc3QgbGlzdGVuZXJzID0gZG9jUm9vdC5fTXV0YXRpb25MaXN0ZW5lcnMgfHwgW107CgogIGZ1bmN0aW9uICRyZWFkeSAoc2VsZWN0b3IsIGZuKSB7CiAgICAvLyDlgqjlrZjpgInmi6nlmajlkozlm57osIPlh73mlbAKICAgIGxpc3RlbmVycy5wdXNoKHsKICAgICAgc2VsZWN0b3I6IHNlbGVjdG9yLAogICAgICBmbjogZm4KICAgIH0pOwoKICAgIC8qIOWinuWKoOebkeWQrOWvueixoSAqLwogICAgaWYgKCFkb2NSb290Ll9NdXRhdGlvbkxpc3RlbmVycyB8fCAhZG9jUm9vdC5fTXV0YXRpb25PYnNlcnZlcikgewogICAgICBkb2NSb290Ll9NdXRhdGlvbkxpc3RlbmVycyA9IGxpc3RlbmVyczsKICAgICAgZG9jUm9vdC5fTXV0YXRpb25PYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKCgpID0+IHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRvY1Jvb3QuX011dGF0aW9uTGlzdGVuZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBjb25zdCBpdGVtID0gZG9jUm9vdC5fTXV0YXRpb25MaXN0ZW5lcnNbaV07CiAgICAgICAgICBjaGVjayhpdGVtLnNlbGVjdG9yLCBpdGVtLmZuKTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgZG9jUm9vdC5fTXV0YXRpb25PYnNlcnZlci5vYnNlcnZlKGRvY1Jvb3QsIHsKICAgICAgICBjaGlsZExpc3Q6IHRydWUsCiAgICAgICAgc3VidHJlZTogdHJ1ZQogICAgICB9KTsKICAgIH0KCiAgICAvLyDmo4Dmn6XoioLngrnmmK/lkKblt7Lnu4/lnKhET03kuK0KICAgIGNoZWNrKHNlbGVjdG9yLCBmbik7CiAgfQoKICBmdW5jdGlvbiBjaGVjayAoc2VsZWN0b3IsIGZuKSB7CiAgICBjb25zdCBlbGVtZW50cyA9IGRvY1Jvb3QucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGVsZW1lbnQgPSBlbGVtZW50c1tpXTsKICAgICAgZWxlbWVudC5fTXV0YXRpb25SZWFkeUxpc3RfID0gZWxlbWVudC5fTXV0YXRpb25SZWFkeUxpc3RfIHx8IFtdOwogICAgICBpZiAoIWVsZW1lbnQuX011dGF0aW9uUmVhZHlMaXN0Xy5pbmNsdWRlcyhmbikpIHsKICAgICAgICBlbGVtZW50Ll9NdXRhdGlvblJlYWR5TGlzdF8ucHVzaChmbik7CiAgICAgICAgZm4uY2FsbChlbGVtZW50LCBlbGVtZW50KTsKICAgICAgfQogICAgfQogIH0KCiAgY29uc3Qgc2VsZWN0b3JBcnIgPSBBcnJheS5pc0FycmF5KHNlbGVjdG9yKSA/IHNlbGVjdG9yIDogW3NlbGVjdG9yXTsKICBzZWxlY3RvckFyci5mb3JFYWNoKHNlbGVjdG9yID0+ICRyZWFkeShzZWxlY3RvciwgZm4pKTsKfQoKLyoqCiAqIOafkOS6m+e9kemhteeUqOS6hmF0dGFjaFNoYWRvdyBjbG9zZWQgbW9kZe+8jOmcgOimgW9wZW7miY3og73ojrflj5Z2aWRlb+agh+etvu+8jOS+i+WmgueZvuW6puS6keebmAogKiDop6PlhrPlj4LogIPvvJoKICogaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vd2ViL2Z1bmRhbWVudGFscy93ZWItY29tcG9uZW50cy9zaGFkb3dkb20/aGw9emgtY24jY2xvc2VkCiAqIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzU0OTU0MzgzL292ZXJyaWRlLWVsZW1lbnQtcHJvdG90eXBlLWF0dGFjaHNoYWRvdy11c2luZy1jaHJvbWUtZXh0ZW5zaW9uCiAqLwpmdW5jdGlvbiBoYWNrQXR0YWNoU2hhZG93ICgpIHsKICBpZiAod2luZG93Ll9oYXNIYWNrQXR0YWNoU2hhZG93XykgcmV0dXJuCiAgdHJ5IHsKICAgIHdpbmRvdy5fc2hhZG93RG9tTGlzdF8gPSBbXTsKICAgIHdpbmRvdy5FbGVtZW50LnByb3RvdHlwZS5fYXR0YWNoU2hhZG93ID0gd2luZG93LkVsZW1lbnQucHJvdG90eXBlLmF0dGFjaFNoYWRvdzsKICAgIHdpbmRvdy5FbGVtZW50LnByb3RvdHlwZS5hdHRhY2hTaGFkb3cgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGNvbnN0IGFyZyA9IGFyZ3VtZW50czsKICAgICAgY29uc3QgaXNDbG9zZWQgPSBhcmdbMF0gJiYgYXJnWzBdLm1vZGUgPT09ICdjbG9zZWQnOwoKICAgICAgaWYgKGFyZ1swXSAmJiBhcmdbMF0ubW9kZSkgewogICAgICAgIC8vIOW8uuWItuS9v+eUqCBvcGVuIG1vZGUKICAgICAgICBhcmdbMF0ubW9kZSA9ICdvcGVuJzsKICAgICAgfQogICAgICBjb25zdCBzaGFkb3dSb290ID0gdGhpcy5fYXR0YWNoU2hhZG93LmFwcGx5KHRoaXMsIGFyZyk7CiAgICAgIC8vIOWtmOS4gOS7vXNoYWRvd0RvbUxpc3QKICAgICAgd2luZG93Ll9zaGFkb3dEb21MaXN0Xy5wdXNoKHNoYWRvd1Jvb3QpOwoKICAgICAgLyog6K6pc2hhZG93Um9vdOmHjOmdoueahOWFg+e0oOacieacuuS8muiuv+mXrnNoYWRvd0hvc3QgKi8KICAgICAgc2hhZG93Um9vdC5fc2hhZG93SG9zdCA9IHRoaXM7CgogICAgICAvLyDlnKhkb2N1bWVudOS4i+mdoua3u+WKoCBhZGRTaGFkb3dSb290IOiHquWumuS5ieS6i+S7tgogICAgICBjb25zdCBzaGFkb3dFdmVudCA9IG5ldyB3aW5kb3cuQ3VzdG9tRXZlbnQoJ2FkZFNoYWRvd1Jvb3QnLCB7CiAgICAgICAgc2hhZG93Um9vdCwKICAgICAgICBkZXRhaWw6IHsKICAgICAgICAgIHNoYWRvd1Jvb3QsCiAgICAgICAgICBtZXNzYWdlOiAnYWRkU2hhZG93Um9vdCcsCiAgICAgICAgICB0aW1lOiBuZXcgRGF0ZSgpCiAgICAgICAgfSwKICAgICAgICBidWJibGVzOiB0cnVlLAogICAgICAgIGNhbmNlbGFibGU6IHRydWUKICAgICAgfSk7CiAgICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQoc2hhZG93RXZlbnQpOwoKICAgICAgaWYgKGlzQ2xvc2VkKSB7CiAgICAgICAgLyoqCiAgICAgICAgICog6YCa6L+HZGVmaW5lUHJvcGVydHnmnaXorr7nva5zaGFkb3dSb29077yMZ2V055qE5pe25YCZ6L+U5ZuebnVsbAogICAgICAgICAqIOiuqeWklumDqOaEn+efpeWIsOeahOi/mOaYr2Nsb3NlZOeahHNoYWRvd1Jvb3TvvIzpmLLmraLor6/liKTmiJbpkojlr7nmgKfmo4DmtYsKICAgICAgICAgKi8KICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgJ3NoYWRvd1Jvb3QnLCB7CiAgICAgICAgICBnZXQgKCkgewogICAgICAgICAgICByZXR1cm4gbnVsbAogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CgogICAgICAvLyBjb25zb2xlLmxvZygnYWRkU2hhZG93Um9vdCcsIHNoYWRvd1Jvb3QuaG9zdCwgdGhpcywgdGhpcy5zaGFkb3dSb290KQoKICAgICAgcmV0dXJuIHNoYWRvd1Jvb3QKICAgIH07CiAgICB3aW5kb3cuX2hhc0hhY2tBdHRhY2hTaGFkb3dfID0gdHJ1ZTsKICB9IGNhdGNoIChlKSB7CiAgICBjb25zb2xlLmVycm9yKCdoYWNrQXR0YWNoU2hhZG93IGVycm9yIGJ5IGg1cGxheWVyIHBsdWctaW4nLCBlKTsKICB9Cn0KCi8qIQogKiBAbmFtZSAgICAgICAgIG9yaWdpbmFsLmpzCiAqIEBkZXNjcmlwdGlvbiAg5a2Y5YKo6YOo5YiG6YeN6KaB55qE5Y6f55Sf5Ye95pWw77yM6Ziy5q2i6KKr5aSW6YOo5rGh5p+T77yM5q2k6YC76L6R5bqU5bC95Y+v6IO95YmN572u77yM5ZCm5YiZ5a2Y5YKo55qE5bCG5piv5rGh5p+T5ZCO55qE5Ye95pWwCiAqIEB2ZXJzaW9uICAgICAgMC4wLjEKICogQGF1dGhvciAgICAgICB4eHhpbHkKICogQGRhdGUgICAgICAgICAyMDIyLzEwLzE2IDEwOjMyCiAqIEBnaXRodWIgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL3h4eGlseQogKi8KCmNvbnN0IG9yaWdpbmFsID0gewogIC8vIOmYsuatomRlZmluZVByb3BlcnR55ZKMZGVmaW5lUHJvcGVydGllc+iiq0FPUOiEmuacrOmHjeWGmQogIE9iamVjdDogewogICAgZGVmaW5lUHJvcGVydHk6IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSwKICAgIGRlZmluZVByb3BlcnRpZXM6IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzCiAgfSwKCiAgLy8g6Ziy5q2i5q2k57G7546p5rOV77yaaHR0cHM6Ly9qdWVqaW4uY24vcG9zdC82ODY1OTEwNTY0ODE3MDEwNzAyCiAgUHJveHksCgogIE1hcCwKICBtYXA6IHsKICAgIGNsZWFyOiBNYXAucHJvdG90eXBlLmNsZWFyLAogICAgc2V0OiBNYXAucHJvdG90eXBlLnNldCwKICAgIGhhczogTWFwLnByb3RvdHlwZS5oYXMsCiAgICBnZXQ6IE1hcC5wcm90b3R5cGUuZ2V0LAogICAgZGVsZXRlOiBNYXAucHJvdG90eXBlLmRlbGV0ZQogIH0sCgogIGNvbnNvbGU6IHsKICAgIGxvZzogY29uc29sZS5sb2csCiAgICBpbmZvOiBjb25zb2xlLmluZm8sCiAgICBlcnJvcjogY29uc29sZS5lcnJvciwKICAgIHdhcm46IGNvbnNvbGUud2FybiwKICAgIHRhYmxlOiBjb25zb2xlLnRhYmxlCiAgfSwKCiAgU2hhZG93Um9vdCwKICBIVE1MTWVkaWFFbGVtZW50LAogIEN1c3RvbUV2ZW50LAogIC8vIGFwcGVuZENoaWxkOiBOb2RlLnByb3RvdHlwZS5hcHBlbmRDaGlsZCwKCiAgSlNPTjogewogICAgcGFyc2U6IEpTT04ucGFyc2UsCiAgICBzdHJpbmdpZnk6IEpTT04uc3RyaW5naWZ5CiAgfSwKCiAgYWxlcnQsCiAgY29uZmlybSwKICBwcm9tcHQKfTsKCi8qKgogKiDlqpLkvZPmoIfnrb7mo4DmtYvvvIzlj6/ku6Xmo4DmtYvlh7p2aW9kZeOAgWF1ZGlv44CB5Lul5Y+K5YW25a6D5qCH562+5ZCN57uP6L+H5pS56YCg5ZCO55qE5aqS5L2TRWxlbWVudAogKiBAcGFyYW0ge0Z1bmN0aW9ufSBoYW5kbGVyIC3lv4XpgIkg5qOA5Ye65ZCO6KaB5omn6KGM55qE5Zue6LCD5Ye95pWwCiAqIEByZXR1cm5zIG1lZGlhRWxlbWVudExpc3QKICovCmNvbnN0IG1lZGlhQ29yZSA9IChmdW5jdGlvbiAoKSB7CiAgbGV0IGhhc01lZGlhQ29yZUluaXQgPSBmYWxzZTsKICBsZXQgaGFzUHJveHlIVE1MTWVkaWFFbGVtZW50ID0gZmFsc2U7CiAgbGV0IG9yaWdpbkRlc2NyaXB0b3JzID0ge307CiAgY29uc3Qgb3JpZ2luTWV0aG9kcyA9IHt9OwogIGNvbnN0IG1lZGlhRWxlbWVudExpc3QgPSBbXTsKICBjb25zdCBtZWRpYUVsZW1lbnRIYW5kbGVyID0gW107CiAgY29uc3QgbWVkaWFNYXAgPSBuZXcgb3JpZ2luYWwuTWFwKCk7CgogIGNvbnN0IGZpcnN0VXBwZXJDYXNlID0gc3RyID0+IHN0ci5yZXBsYWNlKC9eXFMvLCBzID0+IHMudG9VcHBlckNhc2UoKSk7CiAgZnVuY3Rpb24gaXNIVE1MTWVkaWFFbGVtZW50IChlbCkgewogICAgcmV0dXJuIGVsIGluc3RhbmNlb2Ygb3JpZ2luYWwuSFRNTE1lZGlhRWxlbWVudAogIH0KCiAgLyoqCiAgICog5qC55o2uSFRNTE1lZGlhRWxlbWVudOeahOWunuS+i+WvueixoeWIm+W7uuWinuW8uuaOp+WItueahOebuOWFs0FQSeWHveaVsO+8jOS7juiAjOWunueOsOmUgeWumuaSreaUvuWAjemAn++8jOmUgeWumuaaguWBnOWSjOaSreaUvuetieWinuW8uuWKn+iDvQogICAqIEBwYXJhbSB7Kn0gbWVkaWFFbGVtZW50IC0g5b+F6YCJ77yMSFRNTE1lZGlhRWxlbWVudOeahOWFt+S9k+WunuS+i++8jOS+i+Wmgue9kemhteS4iueahHZpZGVv5qCH562+5oiWbmV3IEF1ZGlvKCnnrYkKICAgKiBAcmV0dXJucyBtZWRpYVBsdXNBcGkKICAgKi8KICBmdW5jdGlvbiBjcmVhdGVNZWRpYVBsdXNBcGkgKG1lZGlhRWxlbWVudCkgewogICAgaWYgKCFpc0hUTUxNZWRpYUVsZW1lbnQobWVkaWFFbGVtZW50KSkgeyByZXR1cm4gZmFsc2UgfQoKICAgIGxldCBtZWRpYVBsdXNBcGkgPSBvcmlnaW5hbC5tYXAuZ2V0LmNhbGwobWVkaWFNYXAsIG1lZGlhRWxlbWVudCk7CiAgICBpZiAobWVkaWFQbHVzQXBpKSB7CiAgICAgIHJldHVybiBtZWRpYVBsdXNBcGkKICAgIH0KCiAgICAvKiDliJvlu7pNZWRpYVBsdXNBcGnlr7nosaEgKi8KICAgIG1lZGlhUGx1c0FwaSA9IHt9OwogICAgY29uc3QgbWVkaWFQbHVzQmFzZUFwaSA9IHsKICAgICAgLyoqCiAgICAgICAqIOWIm+W7uumUge+8jOmYu+atouWklumDqOmAu+i+keaTjeS9nG1lZGlhRWxlbWVudOebuOWFs+eahOWxnuaAp+aIluWHveaVsAogICAgICAgKiDov5nph4znmoTplIHpgLvovpHlj6rmmK/mlbDmja7nirbmgIHmoIfms6jlkozliIfmjaLvvIzlhbfkvZPnmoTplIHlip/og73pnIDlnKgKICAgICAgICogcHJveHlQcm90b3R5cGVNZXRob2TlkoxoaWphY2tQcm90b3R5cGVQcm9wZXJ0eemHjOWunueOsAogICAgICAgKi8KICAgICAgbG9jayAoa2V5TmFtZSwgZHVyYXRpb24pIHsKICAgICAgICBjb25zdCBpbmZvS2V5ID0gYF9fJHtrZXlOYW1lfV9pbmZvX19gOwogICAgICAgIG1lZGlhUGx1c0FwaVtpbmZvS2V5XSA9IG1lZGlhUGx1c0FwaVtpbmZvS2V5XSB8fCB7fTsKICAgICAgICBtZWRpYVBsdXNBcGlbaW5mb0tleV0ubG9jayA9IHRydWU7CgogICAgICAgIC8qIOino+mUgeaXtumXtOS/oeaBryAqLwogICAgICAgIGR1cmF0aW9uID0gTnVtYmVyKGR1cmF0aW9uKTsKICAgICAgICBpZiAoIU51bWJlci5pc05hTihkdXJhdGlvbikgJiYgZHVyYXRpb24gPiAwKSB7CiAgICAgICAgICBtZWRpYVBsdXNBcGlbaW5mb0tleV0udW5Mb2NrVGltZSA9IERhdGUubm93KCkgKyBkdXJhdGlvbjsKICAgICAgICB9CgogICAgICAgIC8vIG9yaWdpbmFsLmNvbnNvbGUubG9nKGBbbWVkaWFQbHVzQXBpXVtsb2NrXVske2tleU5hbWV9XSAke2R1cmF0aW9ufWApCiAgICAgIH0sCiAgICAgIHVuTG9jayAoa2V5TmFtZSkgewogICAgICAgIGNvbnN0IGluZm9LZXkgPSBgX18ke2tleU5hbWV9X2luZm9fX2A7CiAgICAgICAgbWVkaWFQbHVzQXBpW2luZm9LZXldID0gbWVkaWFQbHVzQXBpW2luZm9LZXldIHx8IHt9OwogICAgICAgIG1lZGlhUGx1c0FwaVtpbmZvS2V5XS5sb2NrID0gZmFsc2U7CiAgICAgICAgbWVkaWFQbHVzQXBpW2luZm9LZXldLnVuTG9ja1RpbWUgPSBEYXRlLm5vdygpIC0gMTAwOwoKICAgICAgICAvLyBvcmlnaW5hbC5jb25zb2xlLmxvZyhgW21lZGlhUGx1c0FwaV1bdW5Mb2NrXVske2tleU5hbWV9XWApCiAgICAgIH0sCiAgICAgIGlzTG9jayAoa2V5TmFtZSkgewogICAgICAgIGNvbnN0IGluZm8gPSBtZWRpYVBsdXNBcGlbYF9fJHtrZXlOYW1lfV9pbmZvX19gXSB8fCB7fTsKCiAgICAgICAgaWYgKGluZm8udW5Mb2NrVGltZSkgewogICAgICAgICAgLyog5bu25pe26ZSB5qC55o2u5b2T5YmN5pe26Ze06K6h566X5piv5ZCm6L+Y5aSE5LqO6ZSB54q25oCBICovCiAgICAgICAgICByZXR1cm4gRGF0ZS5ub3coKSA8IGluZm8udW5Mb2NrVGltZQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gaW5mby5sb2NrIHx8IGZhbHNlCiAgICAgICAgfQogICAgICB9LAoKICAgICAgLyog5rOo5oSP77ya6LCD55So5q2k5aSE55qEZ2V05ZKMc2V05ZKMYXBwbHnkuI3lj5fplIHnmoTpmZDliLYgKi8KICAgICAgZ2V0IChrZXlOYW1lKSB7CiAgICAgICAgaWYgKG9yaWdpbkRlc2NyaXB0b3JzW2tleU5hbWVdICYmIG9yaWdpbkRlc2NyaXB0b3JzW2tleU5hbWVdLmdldCAmJiAhb3JpZ2luTWV0aG9kc1trZXlOYW1lXSkgewogICAgICAgICAgcmV0dXJuIG9yaWdpbkRlc2NyaXB0b3JzW2tleU5hbWVdLmdldC5hcHBseShtZWRpYUVsZW1lbnQpCiAgICAgICAgfQogICAgICB9LAogICAgICBzZXQgKGtleU5hbWUsIHZhbCkgewogICAgICAgIGlmIChvcmlnaW5EZXNjcmlwdG9yc1trZXlOYW1lXSAmJiBvcmlnaW5EZXNjcmlwdG9yc1trZXlOYW1lXS5zZXQgJiYgIW9yaWdpbk1ldGhvZHNba2V5TmFtZV0gJiYgdHlwZW9mIHZhbCAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgIC8vIG9yaWdpbmFsLmNvbnNvbGUubG9nKGBbbWVkaWFQbHVzQXBpXVske2tleU5hbWV9XSDmiafooYzljp/nlJ9zZXTmk43kvZxgKQogICAgICAgICAgcmV0dXJuIG9yaWdpbkRlc2NyaXB0b3JzW2tleU5hbWVdLnNldC5hcHBseShtZWRpYUVsZW1lbnQsIFt2YWxdKQogICAgICAgIH0KICAgICAgfSwKICAgICAgYXBwbHkgKGtleU5hbWUpIHsKICAgICAgICBpZiAob3JpZ2luTWV0aG9kc1trZXlOYW1lXSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7CiAgICAgICAgICBjb25zdCBhcmdzID0gQXJyYXkuZnJvbShhcmd1bWVudHMpOwogICAgICAgICAgYXJncy5zaGlmdCgpOwogICAgICAgICAgLy8gb3JpZ2luYWwuY29uc29sZS5sb2coYFttZWRpYVBsdXNBcGldWyR7a2V5TmFtZX1dIOaJp+ihjOWOn+eUn2FwcGx55pON5L2cYCkKICAgICAgICAgIHJldHVybiBvcmlnaW5NZXRob2RzW2tleU5hbWVdLmFwcGx5KG1lZGlhRWxlbWVudCwgYXJncykKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgbWVkaWFQbHVzQXBpID0geyAuLi5tZWRpYVBsdXNBcGksIC4uLm1lZGlhUGx1c0Jhc2VBcGkgfTsKCiAgICAvKioKICAgICAqIOaJqeWxlWFwaeWIl+ihqOOAguWunueOsCdwbGF5YmFja1JhdGUnLCAndm9sdW1lJywgJ2N1cnJlbnRUaW1lJywgJ3BsYXknLCAncGF1c2Un55qE57qvYXBp6LCD55So5pWI5p6c77yM5YW35L2T5Y+v55SoQVBJ5aaC5LiL77yaCiAgICAgKiBtZWRpYVBsdXNBcGkubG9ja1BsYXliYWNrUmF0ZSgpCiAgICAgKiBtZWRpYVBsdXNBcGkudW5Mb2NrUGxheWJhY2tSYXRlKCkKICAgICAqIG1lZGlhUGx1c0FwaS5pc0xvY2tQbGF5YmFja1JhdGUoKQogICAgICogbWVkaWFQbHVzQXBpLmdldFBsYXliYWNrUmF0ZSgpCiAgICAgKiBtZWRpYVBsdXNBcGkuc2V0UGxheWJhY2tSYXRlKHZhbCkKICAgICAqCiAgICAgKiBtZWRpYVBsdXNBcGkubG9ja1ZvbHVtZSgpCiAgICAgKiBtZWRpYVBsdXNBcGkudW5Mb2NrVm9sdW1lKCkKICAgICAqIG1lZGlhUGx1c0FwaS5pc0xvY2tWb2x1bWUoKQogICAgICogbWVkaWFQbHVzQXBpLmdldFZvbHVtZSgpCiAgICAgKiBtZWRpYVBsdXNBcGkuc2V0Vm9sdW1lKHZhbCkKICAgICAqCiAgICAgKiBtZWRpYVBsdXNBcGkubG9ja0N1cnJlbnRUaW1lKCkKICAgICAqIG1lZGlhUGx1c0FwaS51bkxvY2tDdXJyZW50VGltZSgpCiAgICAgKiBtZWRpYVBsdXNBcGkuaXNMb2NrQ3VycmVudFRpbWUoKQogICAgICogbWVkaWFQbHVzQXBpLmdldEN1cnJlbnRUaW1lKCkKICAgICAqIG1lZGlhUGx1c0FwaS5zZXRDdXJyZW50VGltZSh2YWwpCiAgICAgKgogICAgICogbWVkaWFQbHVzQXBpLmxvY2tQbGF5KCkKICAgICAqIG1lZGlhUGx1c0FwaS51bkxvY2tQbGF5KCkKICAgICAqIG1lZGlhUGx1c0FwaS5pc0xvY2tQbGF5KCkKICAgICAqIG1lZGlhUGx1c0FwaS5hcHBseVBsYXkoKQogICAgICoKICAgICAqIG1lZGlhUGx1c0FwaS5sb2NrUGF1c2UoKQogICAgICogbWVkaWFQbHVzQXBpLnVuTG9ja1BhdXNlKCkKICAgICAqIG1lZGlhUGx1c0FwaS5pc0xvY2tQYXVzZSgpCiAgICAgKiBtZWRpYVBsdXNBcGkuYXBwbHlQYXVzZSgpCiAgICAgKi8KICAgIGNvbnN0IGV4dEFwaUtleXMgPSBbJ3BsYXliYWNrUmF0ZScsICd2b2x1bWUnLCAnY3VycmVudFRpbWUnLCAncGxheScsICdwYXVzZSddOwogICAgY29uc3QgYmFzZUFwaUtleXMgPSBPYmplY3Qua2V5cyhtZWRpYVBsdXNCYXNlQXBpKTsKICAgIGV4dEFwaUtleXMuZm9yRWFjaChrZXkgPT4gewogICAgICBiYXNlQXBpS2V5cy5mb3JFYWNoKGJhc2VLZXkgPT4gewogICAgICAgIC8qIOW9k2tleeWvueW6lOeahOaYr+WHveaVsOaXtu+8jOS4jeW6lOivpeaciWdldOOAgXNldOeahGFwae+8jOiAjOW6lOivpeaciWFwcGx555qEYXBpICovCiAgICAgICAgaWYgKG9yaWdpbk1ldGhvZHNba2V5XSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7CiAgICAgICAgICBpZiAoYmFzZUtleSA9PT0gJ2dldCcgfHwgYmFzZUtleSA9PT0gJ3NldCcpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWUKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGJhc2VLZXkgPT09ICdhcHBseScpIHsKICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgfQoKICAgICAgICBtZWRpYVBsdXNBcGlbYCR7YmFzZUtleX0ke2ZpcnN0VXBwZXJDYXNlKGtleSl9YF0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gbWVkaWFQbHVzQmFzZUFwaVtiYXNlS2V5XS5hcHBseShudWxsLCBba2V5LCAuLi5hcmd1bWVudHNdKQogICAgICAgIH07CiAgICAgIH0pOwogICAgfSk7CgogICAgb3JpZ2luYWwubWFwLnNldC5jYWxsKG1lZGlhTWFwLCBtZWRpYUVsZW1lbnQsIG1lZGlhUGx1c0FwaSk7CgogICAgcmV0dXJuIG1lZGlhUGx1c0FwaQogIH0KCiAgLyog5qOA5rWL5YiwbWVkaWHlr7nosaHnmoTlpITnkIbpgLvovpHvvIzkvp3otZZQcm94eeWvuW1lZGlh5Ye95pWw55qE5Luj55CGICovCiAgZnVuY3Rpb24gbWVkaWFEZXRlY3RIYW5kbGVyIChjdHgpIHsKICAgIGlmIChpc0hUTUxNZWRpYUVsZW1lbnQoY3R4KSAmJiAhbWVkaWFFbGVtZW50TGlzdC5pbmNsdWRlcyhjdHgpKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKGBbbWVkaWFEZXRlY3RIYW5kbGVyXWAsIGN0eCkKICAgICAgbWVkaWFFbGVtZW50TGlzdC5wdXNoKGN0eCk7CiAgICAgIGNyZWF0ZU1lZGlhUGx1c0FwaShjdHgpOwoKICAgICAgdHJ5IHsKICAgICAgICBtZWRpYUVsZW1lbnRIYW5kbGVyLmZvckVhY2goaGFuZGxlciA9PiB7CiAgICAgICAgICAoaGFuZGxlciBpbnN0YW5jZW9mIEZ1bmN0aW9uKSAmJiBoYW5kbGVyKGN0eCk7CiAgICAgICAgfSk7CiAgICAgIH0gY2F0Y2ggKGUpIHt9CiAgICB9CiAgfQoKICAvKiDku6PnkIbmlrnms5VwbGF55ZKMcGF1c2Xmlrnms5XvvIznoa7kv53og73mraPnoa7mmoLlgZzlkozmkq3mlL4gKi8KICBmdW5jdGlvbiBwcm94eVByb3RvdHlwZU1ldGhvZCAoZWxlbWVudCwgbWV0aG9kTmFtZSkgewogICAgY29uc3Qgb3JpZ2luRnVuYyA9IGVsZW1lbnQgJiYgZWxlbWVudC5wcm90b3R5cGVbbWV0aG9kTmFtZV07CiAgICBpZiAoIW9yaWdpbkZ1bmMpIHJldHVybgoKICAgIGVsZW1lbnQucHJvdG90eXBlW21ldGhvZE5hbWVdID0gbmV3IG9yaWdpbmFsLlByb3h5KG9yaWdpbkZ1bmMsIHsKICAgICAgYXBwbHkgKHRhcmdldCwgY3R4LCBhcmdzKSB7CiAgICAgICAgbWVkaWFEZXRlY3RIYW5kbGVyKGN0eCk7CiAgICAgICAgLy8gb3JpZ2luYWwuY29uc29sZS5sb2coYFttZWRpYUVsZW1lbnRNZXRob2RQcm94eV0g5omn6KGM5Luj55CG5ZCO55qEJHttZXRob2ROYW1lfeWHveaVsGApCgogICAgICAgIC8qIOWvueaSreaUvuaaguWBnOmAu+i+kei/m+ihjOWinuW8uuWkhOeQhu+8jOS+i+WmguWFgeiuuOmAmui/h21lZGlhUGx1c0Fwaei/m+ihjOmUgeWumiAqLwogICAgICAgIGlmIChbJ3BsYXknLCAncGF1c2UnXS5pbmNsdWRlcyhtZXRob2ROYW1lKSkgewogICAgICAgICAgY29uc3QgbWVkaWFQbHVzQXBpID0gY3JlYXRlTWVkaWFQbHVzQXBpKGN0eCk7CiAgICAgICAgICBpZiAobWVkaWFQbHVzQXBpICYmIG1lZGlhUGx1c0FwaS5pc0xvY2sobWV0aG9kTmFtZSkpIHsKICAgICAgICAgICAgLy8gb3JpZ2luYWwuY29uc29sZS5sb2coYFttZWRpYUVsZW1lbnRNZXRob2RQcm94eV0gJHttZXRob2ROYW1lfeW3suiiq+mUgeWumu+8jOaXoOazleaJp+ihjOebuOWFs+aTjeS9nGApCiAgICAgICAgICAgIHJldHVybgogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGFyZ2V0LmFwcGx5KGN0eCwgYXJncyk7CgogICAgICAgIC8vIFRPRE8g5a+55Ye95pWw5omn6KGM57uT5p6c6L+b6KGM6KeC5a+f5Yik5patCgogICAgICAgIHJldHVybiByZXN1bHQKICAgICAgfQogICAgfSk7CgogICAgLy8g5LiN5bu66K6u5a+5SFRNTE1lZGlhRWxlbWVudOeahOWOn+Wei+mTvui/m+ihjOaJqeWxle+8jOi/meagt+WuueaYk+iuqee9kemhteajgOa1i+WIsG1lZGlhQ29yZeWinuW8uumAu+i+keeahOWtmOWcqAogICAgLy8gaWYgKG9yaWdpbk1ldGhvZHNbbWV0aG9kTmFtZV0pIHsKICAgIC8vICAgZWxlbWVudC5wcm90b3R5cGVbYF9fJHttZXRob2ROYW1lfV9fYF0gPSBvcmlnaW5NZXRob2RzW21ldGhvZE5hbWVdCiAgICAvLyB9CiAgfQoKICAvKioKICAgKiDliqvmjIEgcGxheWJhY2tSYXRl44CBdm9sdW1l44CBY3VycmVudFRpbWUg5bGe5oCn77yM5bm25aKe5Yqg6ZSB5a6a55qE6YC76L6R77yM5LuO6ICM5a6e546w5pu05by655qE5oqX5bmy5omw6IO95YqbCiAgICovCiAgZnVuY3Rpb24gaGlqYWNrUHJvdG90eXBlUHJvcGVydHkgKGVsZW1lbnQsIHByb3BlcnR5KSB7CiAgICBpZiAoIWVsZW1lbnQgfHwgIWVsZW1lbnQucHJvdG90eXBlIHx8ICFvcmlnaW5EZXNjcmlwdG9yc1twcm9wZXJ0eV0pIHsKICAgICAgcmV0dXJuIGZhbHNlCiAgICB9CgogICAgb3JpZ2luYWwuT2JqZWN0LmRlZmluZVByb3BlcnR5LmNhbGwoT2JqZWN0LCBlbGVtZW50LnByb3RvdHlwZSwgcHJvcGVydHksIHsKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICBjb25zdCB2YWwgPSBvcmlnaW5EZXNjcmlwdG9yc1twcm9wZXJ0eV0uZ2V0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgLy8gb3JpZ2luYWwuY29uc29sZS5sb2coYFttZWRpYUVsZW1lbnRQcm9wZXJ0eUhpamFja11bJHtwcm9wZXJ0eX1dW2dldF1gLCB2YWwpCgogICAgICAgIGNvbnN0IG1lZGlhUGx1c0FwaSA9IGNyZWF0ZU1lZGlhUGx1c0FwaSh0aGlzKTsKICAgICAgICBpZiAobWVkaWFQbHVzQXBpICYmIG1lZGlhUGx1c0FwaS5pc0xvY2socHJvcGVydHkpKSB7CiAgICAgICAgICBpZiAocHJvcGVydHkgPT09ICdwbGF5YmFja1JhdGUnKSB7CiAgICAgICAgICAgIHJldHVybiArIStbXQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHZhbAogICAgICB9LAogICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIC8vIG9yaWdpbmFsLmNvbnNvbGUubG9nKGBbbWVkaWFFbGVtZW50UHJvcGVydHlIaWphY2tdWyR7cHJvcGVydHl9XVtzZXRdYCwgdmFsdWUpCgogICAgICAgIGlmIChwcm9wZXJ0eSA9PT0gJ3NyYycpIHsKICAgICAgICAgIG1lZGlhRGV0ZWN0SGFuZGxlcih0aGlzKTsKICAgICAgICB9CgogICAgICAgIC8qIOWvueiwg+mAn+OAgeiwg+mfs+WSjOi/m+W6puaOp+WItumAu+i+kei/m+ihjOWinuW8uuWkhOeQhu+8jOS+i+WmguWFgeiuuOmAmui/h21lZGlhUGx1c0Fwaei/meS6m+WKn+iDvei/m+ihjOmUgeWumiAqLwogICAgICAgIGlmIChbJ3BsYXliYWNrUmF0ZScsICd2b2x1bWUnLCAnY3VycmVudFRpbWUnXS5pbmNsdWRlcyhwcm9wZXJ0eSkpIHsKICAgICAgICAgIGNvbnN0IG1lZGlhUGx1c0FwaSA9IGNyZWF0ZU1lZGlhUGx1c0FwaSh0aGlzKTsKICAgICAgICAgIGlmIChtZWRpYVBsdXNBcGkgJiYgbWVkaWFQbHVzQXBpLmlzTG9jayhwcm9wZXJ0eSkpIHsKICAgICAgICAgICAgLy8gb3JpZ2luYWwuY29uc29sZS5sb2coYFttZWRpYUVsZW1lbnRQcm9wZXJ0eUhpamFja10gJHtwcm9wZXJ0eX3lt7LooqvplIHlrprvvIzml6Dms5XmiafooYznm7jlhbPmk43kvZxgKQogICAgICAgICAgICByZXR1cm4KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBvcmlnaW5EZXNjcmlwdG9yc1twcm9wZXJ0eV0uc2V0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykKICAgICAgfQogICAgfSk7CiAgfQoKICBmdW5jdGlvbiBtZWRpYVBsdXMgKG1lZGlhRWxlbWVudCkgewogICAgcmV0dXJuIGNyZWF0ZU1lZGlhUGx1c0FwaShtZWRpYUVsZW1lbnQpCiAgfQoKICBmdW5jdGlvbiBtZWRpYVByb3h5ICgpIHsKICAgIGlmICghaGFzUHJveHlIVE1MTWVkaWFFbGVtZW50KSB7CiAgICAgIGNvbnN0IHByb3h5TWV0aG9kcyA9IFsncGxheScsICdwYXVzZScsICdsb2FkJywgJ2FkZEV2ZW50TGlzdGVuZXInXTsKICAgICAgcHJveHlNZXRob2RzLmZvckVhY2gobWV0aG9kTmFtZSA9PiB7IHByb3h5UHJvdG90eXBlTWV0aG9kKEhUTUxNZWRpYUVsZW1lbnQsIG1ldGhvZE5hbWUpOyB9KTsKCiAgICAgIGNvbnN0IGhpamFja1Byb3BlcnR5ID0gWydwbGF5YmFja1JhdGUnLCAndm9sdW1lJywgJ2N1cnJlbnRUaW1lJywgJ3NyYyddOwogICAgICBoaWphY2tQcm9wZXJ0eS5mb3JFYWNoKHByb3BlcnR5ID0+IHsgaGlqYWNrUHJvdG90eXBlUHJvcGVydHkoSFRNTE1lZGlhRWxlbWVudCwgcHJvcGVydHkpOyB9KTsKCiAgICAgIGhhc1Byb3h5SFRNTE1lZGlhRWxlbWVudCA9IHRydWU7CiAgICB9CgogICAgcmV0dXJuIGhhc1Byb3h5SFRNTE1lZGlhRWxlbWVudAogIH0KCiAgLyoqCiAgICog5aqS5L2T5qCH562+5qOA5rWL77yM5Y+v5Lul5qOA5rWL5Ye6dmlvZGXjgIFhdWRpb+OAgeS7peWPiuWFtuWug+agh+etvuWQjee7j+i/h+aUuemAoOWQjueahOWqkuS9k0VsZW1lbnQKICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBoYW5kbGVyIC3lv4XpgIkg5qOA5Ye65ZCO6KaB5omn6KGM55qE5Zue6LCD5Ye95pWwCiAgICogQHJldHVybnMgbWVkaWFFbGVtZW50TGlzdAogICAqLwogIGZ1bmN0aW9uIG1lZGlhQ2hlY2tlciAoaGFuZGxlcikgewogICAgaWYgKCEoaGFuZGxlciBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB8fCBtZWRpYUVsZW1lbnRIYW5kbGVyLmluY2x1ZGVzKGhhbmRsZXIpKSB7CiAgICAgIHJldHVybiBtZWRpYUVsZW1lbnRMaXN0CiAgICB9IGVsc2UgewogICAgICBtZWRpYUVsZW1lbnRIYW5kbGVyLnB1c2goaGFuZGxlcik7CiAgICB9CgogICAgaWYgKCFoYXNQcm94eUhUTUxNZWRpYUVsZW1lbnQpIHsKICAgICAgbWVkaWFQcm94eSgpOwogICAgfQoKICAgIHJldHVybiBtZWRpYUVsZW1lbnRMaXN0CiAgfQoKICAvKioKICAgKiDliJ3lp4vljJZtZWRpYUNvcmXnm7jlhbPlip/og70KICAgKi8KICBmdW5jdGlvbiBpbml0IChtZWRpYUNoZWNrZXJIYW5kbGVyKSB7CiAgICBpZiAoaGFzTWVkaWFDb3JlSW5pdCkgeyByZXR1cm4gZmFsc2UgfQoKICAgIG9yaWdpbkRlc2NyaXB0b3JzID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoSFRNTE1lZGlhRWxlbWVudC5wcm90b3R5cGUpOwoKICAgIE9iamVjdC5rZXlzKEhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlKS5mb3JFYWNoKGtleSA9PiB7CiAgICAgIHRyeSB7CiAgICAgICAgaWYgKEhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlW2tleV0gaW5zdGFuY2VvZiBGdW5jdGlvbikgewogICAgICAgICAgb3JpZ2luTWV0aG9kc1trZXldID0gSFRNTE1lZGlhRWxlbWVudC5wcm90b3R5cGVba2V5XTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGUpIHt9CiAgICB9KTsKCiAgICBtZWRpYUNoZWNrZXJIYW5kbGVyID0gbWVkaWFDaGVja2VySGFuZGxlciBpbnN0YW5jZW9mIEZ1bmN0aW9uID8gbWVkaWFDaGVja2VySGFuZGxlciA6IGZ1bmN0aW9uICgpIHt9OwogICAgbWVkaWFDaGVja2VyKG1lZGlhQ2hlY2tlckhhbmRsZXIpOwoKICAgIGhhc01lZGlhQ29yZUluaXQgPSB0cnVlOwogICAgcmV0dXJuIHRydWUKICB9CgogIHJldHVybiB7CiAgICBpbml0LAogICAgbWVkaWFQbHVzLAogICAgbWVkaWFDaGVja2VyLAogICAgb3JpZ2luRGVzY3JpcHRvcnMsCiAgICBvcmlnaW5NZXRob2RzLAogICAgbWVkaWFFbGVtZW50TGlzdAogIH0KfSkoKTsKCi8qIQogKiBAbmFtZSAgICAgICAgIHV0aWxzLmpzCiAqIEBkZXNjcmlwdGlvbiAg5pWw5o2u57G75Z6L55u45YWz55qE5pa55rOVCiAqIEB2ZXJzaW9uICAgICAgMC4wLjEKICogQGF1dGhvciAgICAgICBCbGF6ZQogKiBAZGF0ZSAgICAgICAgIDIyLzAzLzIwMTkgMjI6NDYKICogQGdpdGh1YiAgICAgICBodHRwczovL2dpdGh1Yi5jb20veHh4aWx5CiAqLwoKLyoqCiAqIOWHhuehruWcsOiOt+WPluWvueixoeeahOWFt+S9k+exu+WeiyDlj4Lop4HvvJpodHRwczovL3d3dy50YWxraW5nY29kZXIuY29tL2FydGljbGUvNjMzMzU1NzQ0MjcwNTY5NjcxOQogKiBAcGFyYW0gb2JqIHsgYWxsIH0gLeW/hemAiSDopoHliKTmlq3nmoTlr7nosaEKICogQHJldHVybnMgeyp9IOi/lOWbnuWIpOaWreeahOWFt+S9k+exu+WeiwogKi8KZnVuY3Rpb24gZ2V0VHlwZSAob2JqKSB7CiAgaWYgKG9iaiA9PSBudWxsKSB7CiAgICByZXR1cm4gU3RyaW5nKG9iaikKICB9CiAgcmV0dXJuIHR5cGVvZiBvYmogPT09ICdvYmplY3QnIHx8IHR5cGVvZiBvYmogPT09ICdmdW5jdGlvbicKICAgID8gKG9iai5jb25zdHJ1Y3RvciAmJiBvYmouY29uc3RydWN0b3IubmFtZSAmJiBvYmouY29uc3RydWN0b3IubmFtZS50b0xvd2VyQ2FzZSgpKSB8fAogICAgL2Z1bmN0aW9uXHMoLis/KVwoLy5leGVjKG9iai5jb25zdHJ1Y3RvcilbMV0udG9Mb3dlckNhc2UoKQogICAgOiB0eXBlb2Ygb2JqCn0KCmNvbnN0IGlzVHlwZSA9IChvYmosIHR5cGVOYW1lKSA9PiBnZXRUeXBlKG9iaikgPT09IHR5cGVOYW1lOwpjb25zdCBpc09iaiQxID0gb2JqID0+IGlzVHlwZShvYmosICdvYmplY3QnKTsKCi8qIQogKiBAbmFtZSAgICAgICAgIG9iamVjdC5qcwogKiBAZGVzY3JpcHRpb24gIOWvueixoeaTjeS9nOeahOebuOWFs+aWueazlQogKiBAdmVyc2lvbiAgICAgIDAuMC4xCiAqIEBhdXRob3IgICAgICAgQmxhemUKICogQGRhdGUgICAgICAgICAyMS8wMy8yMDE5IDIzOjEwCiAqIEBnaXRodWIgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL3h4eGlseQogKi8KCi8qKgogKiDlr7nkuIDkuKrlr7nosaHov5vooYzmt7Hluqbmi7fotJ0KICogQHNvdXJjZSAt5b+F6YCJ77yIT2JqZWN0fEFycmF577yJ6ZyA5ou36LSd55qE5a+56LGh5oiW5pWw57uECiAqLwpmdW5jdGlvbiBjbG9uZSAoc291cmNlKSB7CiAgdmFyIHJlc3VsdCA9IHt9OwoKICBpZiAodHlwZW9mIHNvdXJjZSAhPT0gJ29iamVjdCcpIHsKICAgIHJldHVybiBzb3VyY2UKICB9CiAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChzb3VyY2UpID09PSAnW29iamVjdCBBcnJheV0nKSB7CiAgICByZXN1bHQgPSBbXTsKICB9CiAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChzb3VyY2UpID09PSAnW29iamVjdCBOdWxsXScpIHsKICAgIHJlc3VsdCA9IG51bGw7CiAgfQogIGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHsKICAgIHJlc3VsdFtrZXldID0gKHR5cGVvZiBzb3VyY2Vba2V5XSA9PT0gJ29iamVjdCcpID8gY2xvbmUoc291cmNlW2tleV0pIDogc291cmNlW2tleV07CiAgfQogIHJldHVybiByZXN1bHQKfQoKLyog6YGN5Y6G5a+56LGh77yM5L2G5LiN5YyF5ZCr5YW25Y6f5Z6L6ZO+5LiK55qE5bGe5oCnICovCmZ1bmN0aW9uIGZvckluIChvYmosIGZuKSB7CiAgZm4gPSBmbiB8fCBmdW5jdGlvbiAoKSB7fTsKICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7CiAgICAgIGZuKGtleSwgb2JqW2tleV0pOwogICAgfQogIH0KfQoKLyoqCiAqIOa3seW6puWQiOW5tuS4pOS4quWPr+aemuS4vueahOWvueixoQogKiBAcGFyYW0gb2JqQSB7b2JqZWN0fSAt5b+F6YCJIOWvueixoUEKICogQHBhcmFtIG9iakIge29iamVjdH0gLeW/hemAiSDlr7nosaFCCiAqIEBwYXJhbSBjb25jYXRBcnIge2Jvb2xlYW59IC3lj6/pgIkg5ZCI5bm25pWw57uE77yM6buY6K6k6YGH5Yiw5pWw57uE55qE5pe25YCZ77yM55u05o6l5Lul5Y+m5aSW5LiA5Liq5pWw57uE5pu/5o2i5b2T5YmN5pWw57uE77yM5bCG5q2k6K6+572udHJ1ZeWIme+8jOmBh+WIsOaVsOe7hOeahOaXtuWAmeS4gOW+i+WQiOW5tu+8jOiAjOS4jeaYr+ebtOaOpeabv+aNogogKiBAcmV0dXJucyB7Knx2b2lkfQogKi8KZnVuY3Rpb24gbWVyZ2VPYmogKG9iakEsIG9iakIsIGNvbmNhdEFycikgewogIGZ1bmN0aW9uIGlzT2JqIChvYmopIHsKICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSA9PT0gJ1tvYmplY3QgT2JqZWN0XScKICB9CiAgZnVuY3Rpb24gaXNBcnIgKGFycikgewogICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhcnIpID09PSAnW29iamVjdCBBcnJheV0nCiAgfQogIGlmICghaXNPYmoob2JqQSkgfHwgIWlzT2JqKG9iakIpKSByZXR1cm4gb2JqQQogIGZ1bmN0aW9uIGRlZXBNZXJnZSAob2JqQSwgb2JqQikgewogICAgZm9ySW4ob2JqQiwgZnVuY3Rpb24gKGtleSkgewogICAgICBjb25zdCBzdWJJdGVtQSA9IG9iakFba2V5XTsKICAgICAgY29uc3Qgc3ViSXRlbUIgPSBvYmpCW2tleV07CiAgICAgIGlmICh0eXBlb2Ygc3ViSXRlbUEgPT09ICd1bmRlZmluZWQnKSB7CiAgICAgICAgb2JqQVtrZXldID0gc3ViSXRlbUI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKGlzT2JqKHN1Ykl0ZW1BKSAmJiBpc09iaihzdWJJdGVtQikpIHsKICAgICAgICAgIC8qIOi/m+ihjOa3seWxguWQiOW5tiAqLwogICAgICAgICAgb2JqQVtrZXldID0gZGVlcE1lcmdlKHN1Ykl0ZW1BLCBzdWJJdGVtQik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChjb25jYXRBcnIgJiYgaXNBcnIoc3ViSXRlbUEpICYmIGlzQXJyKHN1Ykl0ZW1CKSkgewogICAgICAgICAgICBvYmpBW2tleV0gPSBzdWJJdGVtQS5jb25jYXQoc3ViSXRlbUIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgb2JqQVtrZXldID0gc3ViSXRlbUI7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICAgIHJldHVybiBvYmpBCiAgfQogIHJldHVybiBkZWVwTWVyZ2Uob2JqQSwgb2JqQikKfQoKLyoqCiAqIOagueaNruaWh+acrOi3r+W+hOiOt+WPluWvueixoemHjOmdoueahOWAvO+8jOWmgumcgOaUr+aMgeaVsOe7hOivt+S9v+eUqGxvZGFzaOeahGdldOaWueazlQogKiBAcGFyYW0gb2JqIHtPYmplY3R9IC3lv4XpgIkg6KaB5pON5L2c55qE5a+56LGhCiAqIEBwYXJhbSBwYXRoIHtTdHJpbmd9IC3lv4XpgIkg6Lev5b6E5L+h5oGvCiAqIEByZXR1cm5zIHsqfQogKi8KZnVuY3Rpb24gZ2V0VmFsQnlQYXRoJDEgKG9iaiwgcGF0aCkgewogIHBhdGggPSBwYXRoIHx8ICcnOwogIGNvbnN0IHBhdGhBcnIgPSBwYXRoLnNwbGl0KCcuJyk7CiAgbGV0IHJlc3VsdCA9IG9iajsKCiAgLyog6YCS5b2S5o+Q5Y+W57uT5p6c5YC8ICovCiAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXRoQXJyLmxlbmd0aDsgaSsrKSB7CiAgICBpZiAoIXJlc3VsdCkgYnJlYWsKICAgIHJlc3VsdCA9IHJlc3VsdFtwYXRoQXJyW2ldXTsKICB9CgogIHJldHVybiByZXN1bHQKfQoKLyoqCiAqIOagueaNruaWh+acrOi3r+W+hOiuvue9ruWvueixoemHjOmdoueahOWAvO+8jOWmgumcgOaUr+aMgeaVsOe7hOivt+S9v+eUqGxvZGFzaOeahHNldOaWueazlQogKiBAcGFyYW0gb2JqIHtPYmplY3R9IC3lv4XpgIkg6KaB5pON5L2c55qE5a+56LGhCiAqIEBwYXJhbSBwYXRoIHtTdHJpbmd9IC3lv4XpgIkg6Lev5b6E5L+h5oGvCiAqIEBwYXJhbSB2YWwge0FueX0gLeW/hemAiSDlpoLmnpzkuI3kvKDor6Xlj4LvvIzmnIDnu4jnu5PmnpzkvJrooqvorr7nva7kuLp1bmRlZmluZWQKICogQHJldHVybnMge0Jvb2xlYW59IOi/lOWbnnRydWXooajnpLrorr7nva7miJDlip/vvIzlkKbliJnorr7nva7lpLHotKUKICovCmZ1bmN0aW9uIHNldFZhbEJ5UGF0aCAob2JqLCBwYXRoLCB2YWwpIHsKICBpZiAoIW9iaiB8fCAhcGF0aCB8fCB0eXBlb2YgcGF0aCAhPT0gJ3N0cmluZycpIHsKICAgIHJldHVybiBmYWxzZQogIH0KCiAgbGV0IHJlc3VsdCA9IG9iajsKICBjb25zdCBwYXRoQXJyID0gcGF0aC5zcGxpdCgnLicpOwoKICBmb3IgKGxldCBpID0gMDsgaSA8IHBhdGhBcnIubGVuZ3RoOyBpKyspIHsKICAgIGlmICghcmVzdWx0KSBicmVhawoKICAgIGlmIChpID09PSBwYXRoQXJyLmxlbmd0aCAtIDEpIHsKICAgICAgcmVzdWx0W3BhdGhBcnJbaV1dID0gdmFsOwogICAgICByZXR1cm4gTnVtYmVyLmlzTmFOKHZhbCkgPyBOdW1iZXIuaXNOYU4ocmVzdWx0W3BhdGhBcnJbaV1dKSA6IHJlc3VsdFtwYXRoQXJyW2ldXSA9PT0gdmFsCiAgICB9CgogICAgcmVzdWx0ID0gcmVzdWx0W3BhdGhBcnJbaV1dOwogIH0KCiAgcmV0dXJuIGZhbHNlCn0KCmNvbnN0IHF1aWNrU29ydCA9IGZ1bmN0aW9uIChhcnIpIHsKICBpZiAoYXJyLmxlbmd0aCA8PSAxKSB7IHJldHVybiBhcnIgfQogIHZhciBwaXZvdEluZGV4ID0gTWF0aC5mbG9vcihhcnIubGVuZ3RoIC8gMik7CiAgdmFyIHBpdm90ID0gYXJyLnNwbGljZShwaXZvdEluZGV4LCAxKVswXTsKICB2YXIgbGVmdCA9IFtdOwogIHZhciByaWdodCA9IFtdOwogIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICBpZiAoYXJyW2ldIDwgcGl2b3QpIHsKICAgICAgbGVmdC5wdXNoKGFycltpXSk7CiAgICB9IGVsc2UgewogICAgICByaWdodC5wdXNoKGFycltpXSk7CiAgICB9CiAgfQogIHJldHVybiBxdWlja1NvcnQobGVmdCkuY29uY2F0KFtwaXZvdF0sIHF1aWNrU29ydChyaWdodCkpCn07CgpmdW5jdGlvbiBoaWRlRG9tIChzZWxlY3RvciwgZGVsYXkpIHsKICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgIGNvbnN0IGRvbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpOwogICAgaWYgKGRvbSkgewogICAgICBkb20uc3R5bGUub3BhY2l0eSA9IDA7CiAgICB9CiAgfSwgZGVsYXkgfHwgMTAwMCAqIDUpOwp9CgovKioKICog5ZCR5LiK5p+l5om+5pON5L2cCiAqIEBwYXJhbSBkb20ge0VsZW1lbnR9IC3lv4XpgIkg5Yid5aeLZG9t5YWD57SgCiAqIEBwYXJhbSBmbiB7ZnVuY3Rpb259IC3lv4XpgIkg5q+P5LiA57qnUGFyZW50Tm9kZeeahOWbnuiwg+aTjeS9nAogKiDlpoLmnpzlh73mlbDov5Tlm550cnVl5YiZ6KGo56S65YGc5q2i5ZCR5LiK5p+l5om+5Yqo5L2cCiAqLwpmdW5jdGlvbiBlYWNoUGFyZW50Tm9kZSAoZG9tLCBmbikgewogIGxldCBwYXJlbnQgPSBkb20ucGFyZW50Tm9kZTsKICB3aGlsZSAocGFyZW50KSB7CiAgICBjb25zdCBpc0VuZCA9IGZuKHBhcmVudCwgZG9tKTsKICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnROb2RlOwogICAgaWYgKGlzRW5kKSB7CiAgICAgIGJyZWFrCiAgICB9CiAgfQp9CgovKioKICog5Yqo5oCB5Yqg6L29Y3Nz5YaF5a65CiAqIEBwYXJhbSBjc3NUZXh0IHtTdHJpbmd9IC3lv4XpgIkg5qC35byP55qE5paH5pys5YaF5a65CiAqIEBwYXJhbSBpZCB7U3RyaW5nfSAt5Y+v6YCJIOaMh+Wumuagt+W8j+aWh+acrOeahGlk5Y+377yM5aaC5p6c5bey5a2Y5Zyo5a+55bqUaWTlj7fliJnkuI3kvJrlho3mrKHmj5LlhaUKICogQHBhcmFtIGluc2V0VG8ge0RvbX0gLeWPr+mAiSDmjIflrprmj5LlhaXliLDlk6oKICogQHJldHVybnMge0hUTUxTdHlsZUVsZW1lbnR9CiAqLwpmdW5jdGlvbiBsb2FkQ1NTVGV4dCAoY3NzVGV4dCwgaWQsIGluc2V0VG8pIHsKICBpZiAoaWQgJiYgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpKSB7CiAgICByZXR1cm4gZmFsc2UKICB9CgogIGNvbnN0IHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKICBjb25zdCBoZWFkID0gaW5zZXRUbyB8fCBkb2N1bWVudC5oZWFkIHx8IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF07CiAgc3R5bGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY3NzVGV4dCkpOwogIGhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpOwoKICBpZiAoaWQpIHsKICAgIHN0eWxlLnNldEF0dHJpYnV0ZSgnaWQnLCBpZCk7CiAgfQoKICByZXR1cm4gc3R5bGUKfQoKLyoqCiAqIOWIpOaWreW9k+WJjeWFg+e0oOaYr+WQpuS4uuWPr+e8lui+keWFg+e0oAogKiBAcGFyYW0gdGFyZ2V0CiAqIEByZXR1cm5zIEJvb2xlYW4KICovCmZ1bmN0aW9uIGlzRWRpdGFibGVUYXJnZXQgKHRhcmdldCkgewogIGNvbnN0IGlzRWRpdGFibGUgPSB0YXJnZXQuZ2V0QXR0cmlidXRlICYmIHRhcmdldC5nZXRBdHRyaWJ1dGUoJ2NvbnRlbnRlZGl0YWJsZScpID09PSAndHJ1ZSc7CiAgY29uc3QgaXNJbnB1dERvbSA9IC9JTlBVVHxURVhUQVJFQXxTRUxFQ1R8TEFCRUwvLnRlc3QodGFyZ2V0Lm5vZGVOYW1lKTsKICByZXR1cm4gaXNFZGl0YWJsZSB8fCBpc0lucHV0RG9tCn0KCi8qKgogKiDliKTmlq3mn5DkuKrlhYPntKDmmK/lkKblpITkuo5zaGFkb3dEb23ph4zpnaIKICog5Y+C6ICD77yaaHR0cHM6Ly93d3cuY29kZXIud29yay9hcnRpY2xlLzI5OTcwMAogKiBAcGFyYW0gbm9kZQogKiBAcmV0dXJucyB7Ym9vbGVhbn0KICovCmZ1bmN0aW9uIGlzSW5TaGFkb3cgKG5vZGUsIHJldHVyblNoYWRvd1Jvb3QpIHsKICBmb3IgKDsgbm9kZTsgbm9kZSA9IG5vZGUucGFyZW50Tm9kZSkgewogICAgaWYgKG5vZGUudG9TdHJpbmcoKSA9PT0gJ1tvYmplY3QgU2hhZG93Um9vdF0nKSB7CiAgICAgIGlmIChyZXR1cm5TaGFkb3dSb290KSB7CiAgICAgICAgcmV0dXJuIG5vZGUKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdHJ1ZQogICAgICB9CiAgICB9CiAgfQogIHJldHVybiBmYWxzZQp9CgovKioKICog5Yik5pat5p+Q5Liq5YWD57Sg5piv5ZCm5aSE5LqO5Y+v6KeG5Yy65Z+f77yM6YCC55So5LqO6KKr5Yqo6LCD55So5oOF5Ya177yM6ZyA6KaB6auY5oCn6IO977yM6K+35L2/55SoSW50ZXJzZWN0aW9uT2JzZXJ2ZXIKICog5Y+C6ICD77yaaHR0cHM6Ly9naXRodWIuY29tL2ZlYm9iby93ZWItaW50ZXJ2aWV3L2lzc3Vlcy84NAogKiBAcGFyYW0gZWxlbWVudAogKiBAcmV0dXJucyB7Ym9vbGVhbn0KICovCmZ1bmN0aW9uIGlzSW5WaWV3UG9ydCAoZWxlbWVudCkgewogIGNvbnN0IHZpZXdXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aDsKICBjb25zdCB2aWV3SGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQ7CiAgY29uc3QgewogICAgdG9wLAogICAgcmlnaHQsCiAgICBib3R0b20sCiAgICBsZWZ0CiAgfSA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CgogIHJldHVybiAoCiAgICB0b3AgPj0gMCAmJgogICAgbGVmdCA+PSAwICYmCiAgICByaWdodCA8PSB2aWV3V2lkdGggJiYKICAgIGJvdHRvbSA8PSB2aWV3SGVpZ2h0CiAgKQp9CgovKioKICog5Z+65LqOSW50ZXJzZWN0aW9uT2JzZXJ2ZXLnmoTlj6/op4bljLrln5/liKTmlq0KICogQHBhcmFtIHsgRnVuY3Rpb24gfSBjYWxsYmFjawogKiBAcGFyYW0geyBFbGVtZW50IH0gZWxlbWVudAogKiBAcmV0dXJucyB7IEludGVyc2VjdGlvbk9ic2VydmVyIH0KICovCmZ1bmN0aW9uIG9ic2VydmVWaXNpYmlsaXR5IChjYWxsYmFjaywgZWxlbWVudCkgewogIGNvbnN0IG9ic2VydmVyID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKChlbnRyaWVzLCBvYnNlcnZlcikgPT4gewogICAgZW50cmllcy5mb3JFYWNoKGVudHJ5ID0+IHsKICAgICAgaWYgKGVudHJ5LmlzSW50ZXJzZWN0aW5nKSB7CiAgICAgICAgLyog5YWD57Sg5Zyo5Y+v6KeG5Yy65Z+f5YaFICovCiAgICAgICAgY2FsbGJhY2soZW50cnksIG9ic2VydmVyKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvKiDlhYPntKDkuI3lnKjlj6/op4bljLrln5/lhoUgKi8KICAgICAgICBjYWxsYmFjayhudWxsLCBvYnNlcnZlcik7CiAgICAgIH0KICAgIH0pOwogIH0pOwoKICBpZiAoZWxlbWVudCkgewogICAgb2JzZXJ2ZXIub2JzZXJ2ZShlbGVtZW50KTsKICB9CgogIC8qIOi/lOWbnuinguWvn+Wvueixoe+8jOS7peS+v+WklumDqOWPr+S7peWPlua2iOinguWvn++8mm9ic2VydmVyLmRpc2Nvbm5lY3QoKe+8jOaIluiAheWinuWKoOaWsOeahOinguWvn+Wvueixoe+8mm9ic2VydmVyLm9ic2VydmUoZWxlbWVudCkgKi8KICByZXR1cm4gb2JzZXJ2ZXIKfQoKLy8g5L2/55So56S65L6L77yaCi8vIGNvbnN0IHRlbXAxID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3RlbXAxJykKLy8gdmFyIG9ic2VydmVyID0gb2JzZXJ2ZVZpc2liaWxpdHkoZnVuY3Rpb24gKGVudHJ5LCBvYnNlcnZlcikgewovLyAgIGlmIChlbnRyeSkgewovLyAgICAgY29uc29sZS5sb2coJ1tlbnRyeV0nLCBlbnRyeSkKLy8gICB9IGVsc2UgewovLyAgICAgY29uc29sZS5sb2coJ1tlbnRyeV0nLCAnbnVsbCcpCi8vICAgfQovLyB9LCB0ZW1wMSkKCi8qKgogKiDliKTmlq3mmK/lkKbkuLrkuI3lj6/op4HnmoTlhYPntKDvvIzkuLvopoHnlKjku6XliKTmlq3mmK/lkKblt7Lnu4/ohLHnprvmlofmoaPmtYHmiJbooqvorr7nva7kuLpkaXNwbGF5Om5vbmXnmoTlhYPntKAKICogQHBhcmFtIHsqfSBlbGVtZW50CiAqIEByZXR1cm5zCiAqLwpmdW5jdGlvbiBpc091dE9mRG9jdW1lbnQgKGVsZW1lbnQpIHsKICBpZiAoIWVsZW1lbnQgfHwgZWxlbWVudC5vZmZzZXRQYXJlbnQgPT09IG51bGwpIHsKICAgIHJldHVybiB0cnVlCiAgfQoKICBpZiAoZWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ID09PSAnaGlkZGVuJyB8fCBlbGVtZW50LnN0eWxlLmRpc3BsYXkgPT09ICdub25lJykgeyByZXR1cm4gdHJ1ZSB9CgogIGNvbnN0IHsKICAgIHRvcCwKICAgIHJpZ2h0LAogICAgYm90dG9tLAogICAgbGVmdCwKICAgIHdpZHRoLAogICAgaGVpZ2h0CiAgfSA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CgogIHJldHVybiAoCiAgICB0b3AgPT09IDAgJiYKICAgIHJpZ2h0ID09PSAwICYmCiAgICBib3R0b20gPT09IDAgJiYKICAgIGxlZnQgPT09IDAgJiYKICAgIHdpZHRoID09PSAwICYmCiAgICBoZWlnaHQgPT09IDAKICApCn0KCi8qKgogKiDliKTmlq3lnZDmoIfmmK/lkKblnKjlhYPntKDlhoUKICovCmZ1bmN0aW9uIGlzQ29vcmRpbmF0ZUluRWxlbWVudCAoeCwgeSwgZWxlbWVudCkgewogIGlmICghZWxlbWVudCB8fCAhZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QpIHsgcmV0dXJuIGZhbHNlIH0KCiAgY29uc3QgcmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CgogIGlmICh4ID49IHJlY3QubGVmdCAmJiB4IDw9IHJlY3QucmlnaHQgJiYgeSA+PSByZWN0LnRvcCAmJiB5IDw9IHJlY3QuYm90dG9tKSB7CiAgICByZXR1cm4gdHJ1ZQogIH0gZWxzZSB7CiAgICByZXR1cm4gZmFsc2UKICB9Cn0KCi8qKgogKiDmnInkupvnvZHnq5nlvIDlkK/kuoZDU1DvvIzkvJrlr7zoh7Tml6Dms5Xkvb/nlKhpbm5lckhUTUzvvIzmiYDku6XpnIDopoHkvb/nlKh0cnVzdGVkVHlwZXMKICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSFRUUC9IZWFkZXJzL0NvbnRlbnQtU2VjdXJpdHktUG9saWN5L3RydXN0ZWQtdHlwZXMKICogQHBhcmFtIHsgU3RyaW5nIH0gaHRtbFN0cmluZyAt5b+F6YCJIEhUTUzlrZfnrKbkuLIKICogQHJldHVybnMKICovCmZ1bmN0aW9uIGNyZWF0ZVRydXN0ZWRIVE1MIChodG1sU3RyaW5nKSB7CiAgaWYgKHdpbmRvdy50cnVzdGVkVHlwZXMgJiYgd2luZG93LnRydXN0ZWRUeXBlcy5jcmVhdGVQb2xpY3kpIHsKICAgIC8qIOWIm+W7umRlZmF1bHTnrZbnlaXliY3lhYjmo4Dmn6XmmK/lkKblt7Lnu4/lrZjlnKggKi8KICAgIGxldCBwb2xpY3kgPSB3aW5kb3cudHJ1c3RlZFR5cGVzLmRlZmF1bHRQb2xpY3kgfHwgbnVsbDsKICAgIGlmICghcG9saWN5KSB7CiAgICAgIHBvbGljeSA9IHdpbmRvdy50cnVzdGVkVHlwZXMuY3JlYXRlUG9saWN5KCdkZWZhdWx0JywgewogICAgICAgIGNyZWF0ZUhUTUw6IChzdHJpbmcpID0+IHN0cmluZwogICAgICB9KTsKICAgIH0KCiAgICBjb25zdCB0cnVzdGVkSFRNTCA9IHBvbGljeS5jcmVhdGVIVE1MKGh0bWxTdHJpbmcpOwoKICAgIHJldHVybiB0cnVzdGVkSFRNTAogIH0gZWxzZSB7CiAgICByZXR1cm4gaHRtbFN0cmluZwogIH0KfQoKLyoqCiAqIOino+aekEhUTUzlrZfnrKbkuLLvvIzov5Tlm55ET03oioLngrnmlbDnu4QKICogQHBhcmFtIHsgU3RyaW5nIH0gLeW/hemAiSBodG1sU3RyaW5nIEhUTUzlrZfnrKbkuLIKICogQHBhcmFtIHsgSFRNTEVsZW1lbnQgfSAt5Y+v6YCJIHRhcmdldEVsZW1lbnQg55uu5qCH5YWD57Sg77yM5aaC5p6c5Lyg5YWl77yM5YiZ5Lya5bCG6Kej5p6Q5ZCO55qE6IqC54K55re75Yqg5Yiw6K+l5YWD57Sg5LitCiAqIEByZXR1cm5zIHsgQXJyYXkgfSBET03oioLngrnmlbDnu4QKICovCmZ1bmN0aW9uIHBhcnNlSFRNTCAoaHRtbFN0cmluZywgdGFyZ2V0RWxlbWVudCkgewogIGlmICh0eXBlb2YgaHRtbFN0cmluZyAhPT0gJ3N0cmluZycpIHsKICAgIHRocm93IG5ldyBFcnJvcignW3BhcnNlSFRNTF0gSW5wdXQgbXVzdCBiZSBhIHN0cmluZycpCiAgfQoKICBjb25zdCB0cnVzdGVkSFRNTCA9IGNyZWF0ZVRydXN0ZWRIVE1MKGh0bWxTdHJpbmcpOwoKICBjb25zdCBwYXJzZXIgPSBuZXcgRE9NUGFyc2VyKCk7CiAgY29uc3QgZG9jID0gcGFyc2VyLnBhcnNlRnJvbVN0cmluZyh0cnVzdGVkSFRNTCwgJ3RleHQvaHRtbCcpOwogIGNvbnN0IG5vZGVzID0gZG9jLmJvZHkuY2hpbGROb2RlczsKICBjb25zdCByZXN1bHQgPSBbXTsKCiAgaWYgKHRhcmdldEVsZW1lbnQgJiYgdGFyZ2V0RWxlbWVudC5hcHBlbmRDaGlsZCkgewogICAgbm9kZXMuZm9yRWFjaChub2RlID0+IHsKICAgICAgY29uc3QgdGFyZ2V0Tm9kZSA9IG5vZGUuY2xvbmVOb2RlKHRydWUpOwogICAgICB0cnkgewogICAgICAgIC8qIOacieS6m+e9keermeWHuuS6juS4muWKoemcgOimgeS8muWvuWFwcGVuZENoaWxk6L+b6KGM6YeN5YaZ77yM5Y+v6IO95Lya5a+86Ie0YXBwZW5kQ2hpbGTmiqXplJnvvIzmiYDku6Xov5nph4zpnIDopoF0cnkgY2F0Y2ggKi8KICAgICAgICB0YXJnZXRFbGVtZW50LmFwcGVuZENoaWxkKHRhcmdldE5vZGUpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgY29uc29sZS5lcnJvcignW3BhcnNlSFRNTF0gYXBwZW5kQ2hpbGQgZXJyb3InLCBlLCB0YXJnZXRFbGVtZW50LCB0YXJnZXROb2RlKTsKICAgICAgfQogICAgICByZXN1bHQucHVzaCh0YXJnZXROb2RlKTsKICAgIH0pOwogIH0KCiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPyByZXN1bHQgOiBub2Rlcwp9CgovKioKICog5bCG6KGM5YaF5qC35byP6L2s5o2i5oiQ5a+56LGh55qE5b2i5byPCiAqIEBwYXJhbSB7c3RyaW5nfSBpbmxpbmVTdHlsZSAt5b+F6YCJ77yM5L6L5aaC77yaIHBvc2l0aW9uOiByZWxhdGl2ZTsgb3BhY2l0eTogMTsgdmlzaWJpbGl0eTogaGlkZGVuOyB0cmFuc2Zvcm06IHNjYWxlKDAuMSkgcm90YXRlKDE4MGRlZyk7CiAqIEByZXR1cm5zIHtPYmplY3R9CiAqLwoKZnVuY3Rpb24gaW5saW5lU3R5bGVUb09iaiAoaW5saW5lU3R5bGUpIHsKICBpZiAodHlwZW9mIGlubGluZVN0eWxlICE9PSAnc3RyaW5nJykgewogICAgcmV0dXJuIHt9CiAgfQoKICBjb25zdCByZXN1bHQgPSB7fTsKICBjb25zdCBzdHlBcnIgPSBpbmxpbmVTdHlsZS5zcGxpdCgnOycpOwogIHN0eUFyci5mb3JFYWNoKGl0ZW0gPT4gewogICAgY29uc3QgdG1wQXJyID0gaXRlbS5zcGxpdCgnOicpOwogICAgaWYgKHRtcEFyci5sZW5ndGggPT09IDIpIHsKICAgICAgcmVzdWx0W3RtcEFyclswXS50cmltKCldID0gdG1wQXJyWzFdLnRyaW0oKTsKICAgIH0KICB9KTsKCiAgcmV0dXJuIHJlc3VsdAp9CgpmdW5jdGlvbiBvYmpUb0lubGluZVN0eWxlIChvYmopIHsKICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaikgIT09ICdbb2JqZWN0IE9iamVjdF0nKSB7CiAgICByZXR1cm4gJycKICB9CgogIGNvbnN0IHN0eWxlQXJyID0gW107CiAgT2JqZWN0LmtleXMob2JqKS5mb3JFYWNoKGtleSA9PiB7CiAgICBzdHlsZUFyci5wdXNoKGAke2tleX06ICR7b2JqW2tleV19YCk7CiAgfSk7CgogIHJldHVybiBzdHlsZUFyci5qb2luKCc7ICcpCn0KCi8qIHVh5L+h5oGv5Lyq6KOFICovCmZ1bmN0aW9uIGZha2VVQSAodWEpIHsKICAvLyBPYmplY3QuZGVmaW5lUHJvcGVydHkobmF2aWdhdG9yLCAndXNlckFnZW50JywgewogIC8vICAgdmFsdWU6IHVhLAogIC8vICAgd3JpdGFibGU6IGZhbHNlLAogIC8vICAgY29uZmlndXJhYmxlOiBmYWxzZSwKICAvLyAgIGVudW1lcmFibGU6IHRydWUKICAvLyB9KQoKICBjb25zdCBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihOYXZpZ2F0b3IucHJvdG90eXBlLCAndXNlckFnZW50Jyk7CiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE5hdmlnYXRvci5wcm90b3R5cGUsICd1c2VyQWdlbnQnLCB7IC4uLmRlc2MsIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdWEgfSB9KTsKfQoKLyogdWHkv6Hmga/mnaXmupDvvJpodHRwczovL2RldmVsb3BlcnMud2hhdGlzbXlicm93c2VyLmNvbSAqLwpjb25zdCB1c2VyQWdlbnRNYXAgPSB7CiAgYW5kcm9pZDogewogICAgY2hyb21lOiAnTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDk7IFNNLUc5NjBGIEJ1aWxkL1BQUjEuMTgwNjEwLjAxMTsgd3YpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIENocm9tZS83NC4wLjM3MjkuMTU3IE1vYmlsZSBTYWZhcmkvNTM3LjM2JywKICAgIGZpcmVmb3g6ICdNb3ppbGxhLzUuMCAoQW5kcm9pZCA3LjA7IE1vYmlsZTsgcnY6NTcuMCkgR2Vja28vNTcuMCBGaXJlZm94LzU3LjAnCiAgfSwKICBpUGhvbmU6IHsKICAgIHNhZmFyaTogJ01vemlsbGEvNS4wIChpUGhvbmU7IENQVSBpUGhvbmUgT1MgMTNfMiBsaWtlIE1hYyBPUyBYKSBBcHBsZVdlYktpdC82MDUuMS4xNSAoS0hUTUwsIGxpa2UgR2Vja28pIENyaU9TLzExMS4wLjAuMCBNb2JpbGUvMTVFMTQ4IFNhZmFyaS82MDQuMScsCiAgICBjaHJvbWU6ICdNb3ppbGxhLzUuMCAoaVBob25lOyBDUFUgaVBob25lIE9TIDEyXzIgbGlrZSBNYWMgT1MgWCkgQXBwbGVXZWJLaXQvNjA1LjEuMTUgKEtIVE1MLCBsaWtlIEdlY2tvKSBDcmlPUy83NC4wLjM3MjkuMTIxIE1vYmlsZS8xNUUxNDggU2FmYXJpLzYwNS4xJwogIH0sCiAgaVBhZDogewogICAgc2FmYXJpOiAnTW96aWxsYS81LjAgKGlQYWQ7IENQVSBPUyAxMl8yIGxpa2UgTWFjIE9TIFgpIEFwcGxlV2ViS2l0LzYwNS4xLjE1IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi8xMi4xIE1vYmlsZS8xNUUxNDggU2FmYXJpLzYwNC4xJywKICAgIGNocm9tZTogJ01vemlsbGEvNS4wIChpUGFkOyBDUFUgT1MgMTJfMyBsaWtlIE1hYyBPUyBYKSBBcHBsZVdlYktpdC82MDUuMS4xNSAoS0hUTUwsIGxpa2UgR2Vja28pIENyaU9TLzc0LjAuMzcyOS4xNTUgTW9iaWxlLzE1RTE0OCBTYWZhcmkvNjA1LjEnCiAgfSwKICBtYWM6IHsKICAgIHNhZmFyaTogJ01vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwXzE0XzUpIEFwcGxlV2ViS2l0LzYwNS4xLjE1IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi8xMi4xLjEgU2FmYXJpLzYwNS4xLjE1JywKICAgIGNocm9tZTogJ01vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwXzE0XzUpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgRmlyZWZveCkgQ2hyb21lLzc0LjAuMzcyOS4xNTcgU2FmYXJpLzUzNy4zNicKICB9Cn07CgovKioKICog5Yik5pat5piv5ZCm5aSE5LqOSWZyYW1l5LitCiAqIEByZXR1cm5zIHtib29sZWFufQogKi8KZnVuY3Rpb24gaXNJbklmcmFtZSAoKSB7CiAgcmV0dXJuIHdpbmRvdyAhPT0gd2luZG93LnRvcAp9CgovKioKICog5Yik5pat5piv5ZCm5aSE5LqO6Leo5Z+f6ZmQ5Yi255qESWZyYW1l5LitCiAqIEByZXR1cm5zIHtib29sZWFufQogKi8KZnVuY3Rpb24gaXNJbkNyb3NzT3JpZ2luRnJhbWUgKCkgewogIGxldCByZXN1bHQgPSB0cnVlOwogIHRyeSB7CiAgICBpZiAod2luZG93LnRvcC5sb2NhbFN0b3JhZ2UgfHwgd2luZG93LnRvcC5sb2NhdGlvbi5ocmVmKSB7CiAgICAgIHJlc3VsdCA9IGZhbHNlOwogICAgfQogIH0gY2F0Y2ggKGUpIHsKICAgIHJlc3VsdCA9IHRydWU7CiAgfQogIHJldHVybiByZXN1bHQKfQoKLyoqCiAqIOeugOWNleeahOiKgua1geWHveaVsAogKiBAcGFyYW0gZm4KICogQHBhcmFtIGludGVydmFsCiAqIEByZXR1cm5zIHtGdW5jdGlvbn0KICovCmZ1bmN0aW9uIHRocm90dGxlIChmbiwgaW50ZXJ2YWwgPSA4MCkgewogIGxldCB0aW1lb3V0ID0gbnVsbDsKICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgaWYgKHRpbWVvdXQpIHJldHVybiBmYWxzZQogICAgdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICB0aW1lb3V0ID0gbnVsbDsKICAgIH0sIGludGVydmFsKTsKICAgIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfQp9CgovKiEKICogQG5hbWUgICAgICAgICB1cmwuanMKICogQGRlc2NyaXB0aW9uICDnlKjkuo7lr7l1cmzov5vooYzop6PmnpDnmoTnm7jlhbPmlrnms5UKICogQHZlcnNpb24gICAgICAwLjAuMQogKiBAYXV0aG9yICAgICAgIEJsYXplCiAqIEBkYXRlICAgICAgICAgMjcvMDMvMjAxOSAxNTo1MgogKiBAZ2l0aHViICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS94eHhpbHkKICovCgovKioKICog5Y+C6ICD56S65L6L77yaCiAqIGh0dHBzOi8vc2VnbWVudGZhdWx0LmNvbS9hLzExOTAwMDAwMDYyMTU0OTUKICog5rOo5oSP77ya6K+l5pa55rOV5b+F6aG75L6d6LWW5rWP6KeI5Zmo55qERE9N5a+56LGhCiAqLwoKZnVuY3Rpb24gcGFyc2VVUkwgKHVybCkgewogIHZhciBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogIGEuaHJlZiA9IHVybCB8fCB3aW5kb3cubG9jYXRpb24uaHJlZjsKICByZXR1cm4gewogICAgc291cmNlOiB1cmwsCiAgICBwcm90b2NvbDogYS5wcm90b2NvbC5yZXBsYWNlKCc6JywgJycpLAogICAgaG9zdDogYS5ob3N0bmFtZSwKICAgIHBvcnQ6IGEucG9ydCwKICAgIG9yaWdpbjogYS5vcmlnaW4sCiAgICBzZWFyY2g6IGEuc2VhcmNoLAogICAgcXVlcnk6IGEuc2VhcmNoLAogICAgZmlsZTogKGEucGF0aG5hbWUubWF0Y2goL1wvKFteLz8jXSspJC9pKSB8fCBbJycsICcnXSlbMV0sCiAgICBoYXNoOiBhLmhhc2gucmVwbGFjZSgnIycsICcnKSwKICAgIHBhdGg6IGEucGF0aG5hbWUucmVwbGFjZSgvXihbXi9dKS8sICcvJDEnKSwKICAgIHJlbGF0aXZlOiAoYS5ocmVmLm1hdGNoKC90cHM/OlwvXC9bXi9dKyguKykvKSB8fCBbJycsICcnXSlbMV0sCiAgICBwYXJhbXM6IChmdW5jdGlvbiAoKSB7CiAgICAgIHZhciByZXQgPSB7fTsKICAgICAgdmFyIHNlZyA9IFtdOwogICAgICB2YXIgcGFyYW1BcnIgPSBhLnNlYXJjaC5yZXBsYWNlKC9eXD8vLCAnJykuc3BsaXQoJyYnKTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFyYW1BcnIubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgaXRlbSA9IHBhcmFtQXJyW2ldOwogICAgICAgIGlmIChpdGVtICE9PSAnJyAmJiBpdGVtLmluZGV4T2YoJz0nKSkgewogICAgICAgICAgc2VnLnB1c2goaXRlbSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlZy5sZW5ndGg7IGorKykgewogICAgICAgIHZhciBwYXJhbSA9IHNlZ1tqXTsKICAgICAgICB2YXIgaWR4ID0gcGFyYW0uaW5kZXhPZignPScpOwogICAgICAgIHZhciBrZXkgPSBwYXJhbS5zdWJzdHJpbmcoMCwgaWR4KTsKICAgICAgICB2YXIgdmFsID0gcGFyYW0uc3Vic3RyaW5nKGlkeCArIDEpOwogICAgICAgIGlmICgha2V5KSB7CiAgICAgICAgICByZXRbdmFsXSA9IG51bGw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldFtrZXldID0gdmFsOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcmV0CiAgICB9KSgpCiAgfQp9CgovKioKICog5bCGcGFyYW1z5a+56LGh6L2s5o2i5oiQ5a2X56ym5Liy5qih5byPCiAqIEBwYXJhbSBwYXJhbXMge09iamVjdH0gLSDlv4XpgIkgcGFyYW1z5a+56LGhCiAqIEByZXR1cm5zIHtzdHJpbmd9CiAqLwpmdW5jdGlvbiBzdHJpbmdpZnlQYXJhbXMgKHBhcmFtcykgewogIHZhciBzdHJBcnIgPSBbXTsKCiAgaWYgKCFPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwocGFyYW1zKSA9PT0gJ1tvYmplY3QgT2JqZWN0XScpIHsKICAgIHJldHVybiAnJwogIH0KCiAgZm9yICh2YXIga2V5IGluIHBhcmFtcykgewogICAgaWYgKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKHBhcmFtcywga2V5KSkgewogICAgICB2YXIgdmFsID0gcGFyYW1zW2tleV07CiAgICAgIHZhciB2YWxUeXBlID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbCk7CgogICAgICBpZiAodmFsID09PSAnJyB8fCB2YWxUeXBlID09PSAnW29iamVjdCBVbmRlZmluZWRdJykgY29udGludWUKCiAgICAgIGlmICh2YWwgPT09IG51bGwpIHsKICAgICAgICBzdHJBcnIucHVzaChrZXkpOwogICAgICB9IGVsc2UgaWYgKHZhbFR5cGUgPT09ICdbb2JqZWN0IEFycmF5XScpIHsKICAgICAgICBzdHJBcnIucHVzaChrZXkgKyAnPScgKyB2YWwuam9pbignLCcpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YWwgPSAoSlNPTi5zdHJpbmdpZnkodmFsKSB8fCAnJyArIHZhbCkucmVwbGFjZSgvKF4ifCIkKS9nLCAnJyk7CiAgICAgICAgc3RyQXJyLnB1c2goa2V5ICsgJz0nICsgdmFsKTsKICAgICAgfQogICAgfQogIH0KICByZXR1cm4gc3RyQXJyLmpvaW4oJyYnKQp9CgovKioKICog5bCG6YCa6L+HcGFyc2VVUkzop6PmnpDlh7rmnaV1cmzlr7nosaHph43mlrDov5jljp/miJB1cmzlnLDlnYAKICog5Li76KaB55So5LqO5p+l6K+i5Y+C5pWw6KKr5Yqo5oCB5L+u5pS55ZCO77yM5YaN6YeN57uEdXJs6ZO+5o6lCiAqIEBwYXJhbSBvYmoge09iamVjdH0gLeW/hemAiSBwYXJzZVVSTOino+aekOWHuuadpXVybOWvueixoQogKi8KZnVuY3Rpb24gc3RyaW5naWZ5VG9VcmwgKHVybE9iaikgewogIHZhciBxdWVyeSA9IHN0cmluZ2lmeVBhcmFtcyh1cmxPYmoucGFyYW1zKSB8fCAnJzsKICBpZiAocXVlcnkpIHsgcXVlcnkgPSAnPycgKyBxdWVyeTsgfQogIHZhciBoYXNoID0gdXJsT2JqLmhhc2ggPyAnIycgKyB1cmxPYmouaGFzaCA6ICcnOwogIHJldHVybiB1cmxPYmoub3JpZ2luICsgdXJsT2JqLnBhdGggKyBxdWVyeSArIGhhc2gKfQoKLyog5b2T5YmN55So5Yiw55qE5b+r5o236ZSuICovCmNvbnN0IGhhc1VzZUtleSA9IHsKICBrZXlDb2RlTGlzdDogWzEzLCAxNiwgMTcsIDE4LCAyNywgMzIsIDM3LCAzOCwgMzksIDQwLCA0OSwgNTAsIDUxLCA1MiwgNjcsIDY4LCA2OSwgNzAsIDczLCA3NCwgNzUsIDc3LCA3OCwgNzksIDgwLCA4MSwgODIsIDgzLCA4NCwgODUsIDg3LCA4OCwgODksIDkwLCA5NywgOTgsIDk5LCAxMDAsIDIyMF0sCiAga2V5TGlzdDogWydlbnRlcicsICdzaGlmdCcsICdjb250cm9sJywgJ2FsdCcsICdlc2NhcGUnLCAnICcsICdhcnJvd2xlZnQnLCAnYXJyb3dyaWdodCcsICdhcnJvd3VwJywgJ2Fycm93ZG93bicsICcxJywgJzInLCAnMycsICc0JywgJ2MnLCAnZCcsICdlJywgJ2YnLCAnaScsICdqJywgJ2snLCAnbicsICdvJywgJ3AnLCAncScsICdyJywgJ3MnLCAndCcsICd1JywgJ3cnLCAneCcsICd5JywgJ3onLCAnXFwnLCAnfCddLAogIGtleU1hcDogewogICAgZW50ZXI6IDEzLAogICAgc2hpZnQ6IDE2LAogICAgY3RybDogMTcsCiAgICBhbHQ6IDE4LAogICAgZXNjOiAyNywKICAgIHNwYWNlOiAzMiwKICAgICfihpAnOiAzNywKICAgICfihpEnOiAzOCwKICAgICfihpInOiAzOSwKICAgICfihpMnOiA0MCwKICAgIDE6IDQ5LAogICAgMjogNTAsCiAgICAzOiA1MSwKICAgIDQ6IDUyLAogICAgYzogNjcsCiAgICBkOiA2OCwKICAgIGU6IDY5LAogICAgZjogNzAsCiAgICBpOiA3MywKICAgIGo6IDc0LAogICAgazogNzUsCiAgICBtOiA3NywKICAgIG46IDc4LAogICAgbzogNzksCiAgICBwOiA4MCwKICAgIHE6IDgxLAogICAgcjogODIsCiAgICBzOiA4MywKICAgIHQ6IDg0LAogICAgdTogODUsCiAgICB3OiA4NywKICAgIHg6IDg4LAogICAgeTogODksCiAgICB6OiA5MCwKICAgIHBhZDE6IDk3LAogICAgcGFkMjogOTgsCiAgICBwYWQzOiA5OSwKICAgIHBhZDQ6IDEwMCwKICAgICdcXCc6IDIyMAogIH0KfTsKCi8qKgogKiDliKTmlq3lvZPliY3mjInplK7mmK/lkKbms6jlhozkuLrpnIDopoHnlKjnmoTmjInplK4KICog55So5LqO5YeP5bCR5a+55YW25a6D6ZSu5L2N55qE5bmy5omwCiAqLwpmdW5jdGlvbiBpc1JlZ2lzdGVyS2V5IChldmVudCkgewogIGNvbnN0IGtleUNvZGUgPSBldmVudC5rZXlDb2RlOwogIGNvbnN0IGtleSA9IGV2ZW50LmtleS50b0xvd2VyQ2FzZSgpOwogIHJldHVybiBoYXNVc2VLZXkua2V5Q29kZUxpc3QuaW5jbHVkZXMoa2V5Q29kZSkgfHwKICAgIGhhc1VzZUtleS5rZXlMaXN0LmluY2x1ZGVzKGtleSkKfQoKLyoqCiAqIOeUseS6jnRhbXBlcm1vbmtleeWvuXdpbmRvd+Wvueixoei/m+ihjOS6huWwgeijhe+8jOaIkeS7rOWunumZheiuv+mXruWIsOeahHdpbmRvd+W5tumdnumhtemdouecn+WunueahHdpbmRvdwogKiDov5nlsLHlr7zoh7TkuoblpoLmnpzmiJHku6zpnIDopoHlsIbmn5Dkupvlr7nosaHmjILovb3liLDpobXpnaLnmoR3aW5kb3fov5vooYzosIPor5XnmoTml7blgJnlsLHml6Dms5XmjILovb3kuoYKICog5omA5Lul5b+F6aG75L2/55So54m55q6K5omL5q615omN6IO96K6/6Zeu5Yiw6aG16Z2i55yf5a6e55qEd2luZG935a+56LGh77yM5LqO5piv5bCx5pyJ5LqG5LiL6Z2i6L+Z5Liq5Ye95pWwCiAqIEByZXR1cm5zIHtQcm9taXNlPHZvaWQ+fQogKi8KYXN5bmMgZnVuY3Rpb24gZ2V0UGFnZVdpbmRvdyAoKSB7CiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgIGlmICh3aW5kb3cuX3BhZ2VXaW5kb3cpIHsKICAgICAgcmV0dXJuIHJlc29sdmUod2luZG93Ll9wYWdlV2luZG93KQogICAgfQoKICAgIC8qIOWwneivlemAmui/h+WQjOatpeeahOaWueW8j+iOt+WPlnBhZ2VXaW5kb3cgKi8KICAgIHRyeSB7CiAgICAgIGNvbnN0IHBhZ2VXaW4gPSBnZXRQYWdlV2luZG93U3luYygpOwogICAgICBpZiAocGFnZVdpbiAmJiBwYWdlV2luLmRvY3VtZW50ICYmIHBhZ2VXaW4uWE1MSHR0cFJlcXVlc3QpIHsKICAgICAgICB3aW5kb3cuX3BhZ2VXaW5kb3cgPSBwYWdlV2luOwogICAgICAgIHJlc29sdmUocGFnZVdpbik7CiAgICAgICAgcmV0dXJuIHBhZ2VXaW4KICAgICAgfQogICAgfSBjYXRjaCAoZSkge30KCiAgICAvKiDkuIvpnaLlvILmraXojrflj5ZwYWdld2luZG9355qE5pa55rOV5Zyo5pyA5paw55qEY2hyb21l5rWP6KeI5Zmo6YeM5bey5aSx5pWIICovCgogICAgY29uc3QgbGlzdGVuRXZlbnRMaXN0ID0gWydsb2FkJywgJ21vdXNlbW92ZScsICdzY3JvbGwnLCAnZ2V0LXBhZ2Utd2luZG93LWV2ZW50J107CgogICAgZnVuY3Rpb24gZ2V0V2luIChldmVudCkgewogICAgICB3aW5kb3cuX3BhZ2VXaW5kb3cgPSB0aGlzOwogICAgICAvLyBkZWJ1Zy5sb2coJ2dldFBhZ2VXaW5kb3cgc3VjY2VlZCcsIGV2ZW50KQogICAgICBsaXN0ZW5FdmVudExpc3QuZm9yRWFjaChldmVudFR5cGUgPT4gewogICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50VHlwZSwgZ2V0V2luLCB0cnVlKTsKICAgICAgfSk7CiAgICAgIHJlc29sdmUod2luZG93Ll9wYWdlV2luZG93KTsKICAgIH0KCiAgICBsaXN0ZW5FdmVudExpc3QuZm9yRWFjaChldmVudFR5cGUgPT4gewogICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGdldFdpbiwgdHJ1ZSk7CiAgICB9KTsKCiAgICAvKiDoh6rooYzmtL7lj5Hkuovku7bku6Xkvr/nlKjmnIDnn63nmoTml7bpl7TojrflvpdwYWdlV2luZG935a+56LGhICovCiAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgd2luZG93LkV2ZW50KCdnZXQtcGFnZS13aW5kb3ctZXZlbnQnKSk7CiAgfSkKfQpnZXRQYWdlV2luZG93KCk7CgovKioKICog6YCa6L+H5ZCM5q2l55qE5pa55byP6I635Y+WcGFnZVdpbmRvdwogKiDms6jmhI/lkIzmraXojrflj5bnmoTmlrnlvI/pnIDopoHlsIbohJrmnKzlhpnlhaVoZWFk77yM6YOo5YiG572R56uZ55Sx5LqO5a6J5YWo562W55Wl5Lya5a+86Ie05YaZ5YWl5aSx6LSl77yM6ICM5peg5rOV5q2j5bi46I635Y+WCiAqIEByZXR1cm5zIHsqfQogKi8KZnVuY3Rpb24gZ2V0UGFnZVdpbmRvd1N5bmMgKHJhd0Z1bmN0aW9uKSB7CiAgaWYgKHdpbmRvdy51bnNhZmVXaW5kb3cpIHJldHVybiB3aW5kb3cudW5zYWZlV2luZG93CiAgaWYgKGRvY3VtZW50Ll93aW5fKSByZXR1cm4gZG9jdW1lbnQuX3dpbl8KCiAgdHJ5IHsKICAgIHJhd0Z1bmN0aW9uID0gcmF3RnVuY3Rpb24gfHwgd2luZG93Ll9fcmF3RnVuY3Rpb25fXyB8fCBGdW5jdGlvbi5wcm90b3R5cGUuY29uc3RydWN0b3I7CiAgICAvLyByZXR1cm4gcmF3RnVuY3Rpb24oJ3JldHVybiB3aW5kb3cnKSgpCiAgICAvLyBGdW5jdGlvbigncmV0dXJuIChmdW5jdGlvbigpe30uY29uc3RydWN0b3IoInJldHVybiB0aGlzIikoKSk7JykKICAgIHJldHVybiByYXdGdW5jdGlvbigncmV0dXJuIChmdW5jdGlvbigpe30uY29uc3RydWN0b3IoInZhciBnZXRQYWdlV2luZG93U3luYz0xOyByZXR1cm4gdGhpcyIpKCkpOycpKCkKICB9IGNhdGNoIChlKSB7CiAgICBjb25zb2xlLmVycm9yKCdnZXRQYWdlV2luZG93U3luYyBlcnJvcicsIGUpOwoKICAgIGNvbnN0IGhlYWQgPSBkb2N1bWVudC5oZWFkIHx8IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2hlYWQnKTsKICAgIGNvbnN0IHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOwogICAgc2NyaXB0LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCdkb2N1bWVudC5fd2luXyA9IHdpbmRvdycpKTsKICAgIGhlYWQuYXBwZW5kQ2hpbGQoc2NyaXB0KTsKCiAgICByZXR1cm4gZG9jdW1lbnQuX3dpbl8KICB9Cn0KCmZ1bmN0aW9uIG9wZW5JblRhYiAodXJsLCBvcHRzLCByZWZlcmVyKSB7CiAgLy8gZml4IHRhbXBlcm1vbmtleSBtZW51IGJ1ZyBzdGFydAogIC8vIOeUseS6jnRhbXBlcm1vbmtleeeahOiPnOWNleWKn+azqOWGjOWSjOWPlua2iOazqOWGjOWtmOWcqOafkOS6m+mavuS7peaOkuafpeeahGJ1Z++8jOaJgOS7pei/meWkhOWvuW9wZW5JblRhYueahOaJk+W8gOmikeeOh+i/m+ihjOS6humZkOWItu+8jOS7peino+WGs+eCueWHu3RhbXBlcm1vbmtleSDoj5zljZXmiZPlvIDpk77mjqXml7blgJnph43lpI3miZPlvIDkuIDloIbnm7jlkIxVUkznmoTpl67popgKICAvLyDmraTmlrnms5XmsrvmoIfkuI3msrvmnKzvvIzov5jmmK/kvJrpgZfnlZnlvojlpJroj5zljZXms6jlhozlkozlj5bmtojms6jlhoznlZnkuIvnmoTlnZHvvIzlu7rorq7mm7/mjaJjaHJvbWXmj5Lku7blrp7njrDlvZPliY3ohJrmnKzlip/og70KCiAgLy8g5L2/55SoR01fZ2V0VmFsdWUvR01fc2V0VmFsdWXmiJZzZXNzaW9uU3RvcmFnZeaOp+WItuWQjOS4gFVSTOeahOiwg+eUqOmikeeOhwogIGNvbnN0IG5vdyA9IERhdGUubm93KCk7CiAgY29uc3Qgc2Vzc2lvbktleSA9IGBoNXBsYXllcl9vcGVuVGFiXyR7dXJsfWA7CiAgbGV0IGxhc3RPcGVuVGltZSA9IDA7CgogIC8vIOS8mOWFiOS9v+eUqEdNX2dldFZhbHVlL0dNX3NldFZhbHVlCiAgaWYgKHdpbmRvdy5HTV9nZXRWYWx1ZSAmJiB3aW5kb3cuR01fc2V0VmFsdWUpIHsKICAgIGxhc3RPcGVuVGltZSA9IHdpbmRvdy5HTV9nZXRWYWx1ZShzZXNzaW9uS2V5LCAwKTsKCiAgICBpZiAobGFzdE9wZW5UaW1lICYmIChub3cgLSBsYXN0T3BlblRpbWUpIDwgMTAwMCkgewogICAgICAvLyBjb25zb2xlLmluZm8oJ+W3sumYu+atoumHjeWkjeaJk+W8gOWQjOS4gFVSTDonLCB1cmwpCiAgICAgIHJldHVybgogICAgfQoKICAgIHdpbmRvdy5HTV9zZXRWYWx1ZShzZXNzaW9uS2V5LCBub3cpOwogIH0gZWxzZSB7CiAgICAvLyDlm57pgIDliLBzZXNzaW9uU3RvcmFnZQogICAgbGFzdE9wZW5UaW1lID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShzZXNzaW9uS2V5KTsKCiAgICBpZiAobGFzdE9wZW5UaW1lICYmIChub3cgLSBwYXJzZUludChsYXN0T3BlblRpbWUpKSA8IDEwMDApIHsKICAgICAgLy8gY29uc29sZS5pbmZvKCflt7LpmLvmraLph43lpI3miZPlvIDlkIzkuIBVUkw6JywgdXJsKQogICAgICByZXR1cm4KICAgIH0KCiAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKHNlc3Npb25LZXksIG5vdy50b1N0cmluZygpKTsKICB9CiAgLy8gZml4IHRhbXBlcm1vbmtleSBtZW51IGJ1ZyBlbmQKCiAgaWYgKHJlZmVyZXIpIHsKICAgIGNvbnN0IHVybE9iaiA9IHBhcnNlVVJMKHVybCk7CiAgICBpZiAoIXVybE9iai5wYXJhbXMucmVmZXJlcikgewogICAgICB1cmxPYmoucGFyYW1zLnJlZmVyZXIgPSBlbmNvZGVVUklDb21wb25lbnQod2luZG93LmxvY2F0aW9uLmhyZWYpOwogICAgICB1cmwgPSBzdHJpbmdpZnlUb1VybCh1cmxPYmopOwogICAgfQogIH0KCiAgaWYgKHdpbmRvdy5HTV9vcGVuSW5UYWIpIHsKICAgIHdpbmRvdy5HTV9vcGVuSW5UYWIodXJsLCBvcHRzIHx8IHsKICAgICAgYWN0aXZlOiB0cnVlLAogICAgICBpbnNlcnQ6IHRydWUsCiAgICAgIHNldFBhcmVudDogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIC8vIOWIm+W7uuaWsOeahGHmoIfnrb7lubbmqKHmi5/ngrnlh7sKICAgIGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CiAgICBhLmhyZWYgPSB1cmw7CiAgICBhLnRhcmdldCA9ICdfYmxhbmsnOwogICAgYS5yZWwgPSAnbm9vcGVuZXIgbm9yZWZlcnJlcic7CiAgICBhLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJzsKICAgIGEuc3R5bGUud2lkdGggPSAnMXB4JzsKICAgIGEuc3R5bGUuaGVpZ2h0ID0gJzFweCc7CiAgICBhLnN0eWxlLm9wY2l0eSA9IDA7CiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpOwogICAgYS5jbGljaygpOwogICAgc2V0VGltZW91dCgoKSA9PiB7IGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoYSk7IH0sIDMwMCk7CiAgfQp9CgovKiDnoa7kv53mlbDlrZfkuLrmraPmlbAgKi8KZnVuY3Rpb24gbnVtVXAgKG51bSkgewogIGlmICh0eXBlb2YgbnVtID09PSAnbnVtYmVyJyAmJiBudW0gPCAwKSB7CiAgICBudW0gPSBNYXRoLmFicyhudW0pOwogIH0KICByZXR1cm4gbnVtCn0KCi8qIOehruS/neaVsOWtl+S4uui0n+aVsCAqLwpmdW5jdGlvbiBudW1Eb3duIChudW0pIHsKICBpZiAodHlwZW9mIG51bSA9PT0gJ251bWJlcicgJiYgbnVtID4gMCkgewogICAgbnVtID0gLW51bTsKICB9CiAgcmV0dXJuIG51bQp9CgpmdW5jdGlvbiBpc01lZGlhRWxlbWVudCAoZWxlbWVudCkgewogIHJldHVybiBlbGVtZW50ICYmIChlbGVtZW50IGluc3RhbmNlb2YgSFRNTE1lZGlhRWxlbWVudCB8fCBlbGVtZW50LkhUTUxNZWRpYUVsZW1lbnQgfHwgZWxlbWVudC5IVE1MVmlkZW9FbGVtZW50IHx8IGVsZW1lbnQuSFRNTEF1ZGlvRWxlbWVudCkKfQoKZnVuY3Rpb24gaXNWaWRlb0VsZW1lbnQgKGVsZW1lbnQpIHsKICByZXR1cm4gZWxlbWVudCAmJiAoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxWaWRlb0VsZW1lbnQgfHwgZWxlbWVudC5IVE1MVmlkZW9FbGVtZW50KQp9CgpmdW5jdGlvbiBpc0F1ZGlvRWxlbWVudCAoZWxlbWVudCkgewogIHJldHVybiBlbGVtZW50ICYmIChlbGVtZW50IGluc3RhbmNlb2YgSFRNTEF1ZGlvRWxlbWVudCB8fCBlbGVtZW50LkhUTUxBdWRpb0VsZW1lbnQpCn0KCi8qIQogKiBjb25maWdNYW5hZ2VyIHBhcnNlIGxvY2FsU3RvcmFnZSBlcnJvciAqIEBuYW1lICAgICAgICAgY29uZmlnTWFuYWdlci50cwogKiBAZGVzY3JpcHRpb24gIOmFjee9rue7n+S4gOeuoeeQhuiEmuacrAogKiBAdmVyc2lvbiAgICAgIDAuMC4xCiAqIEBhdXRob3IgICAgICAgeHh4aWx5CiAqIEBkYXRlICAgICAgICAgMjAyMy8wMy8wNiAxNDoyOQogKiBAZ2l0aHViICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS94eHhpbHkKICovCgoKLyoqCiAqIOWIpOaWrWxvY2FsU3RvcmFnZeaYr+WQpuWPr+eUqAogKiBsb2NhbFN0b3JhZ2XlubbkuI3og73kv53or4ExMDAl5Y+v55So77yM5omA5Lul5L2/55So5YmN5b+F6aG76L+b6KGM5Yik5pat77yM5ZCm5YiZ5Lya5a+86Ie06YOo5YiG572R56uZ5LiL6ISa5pys5Ye6546w5byC5bi4CiAqIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzMwNDgxNTE2L2lmcmFtZS1pbi1jaHJvbWUtZXJyb3ItZmFpbGVkLXRvLXJlYWQtbG9jYWxzdG9yYWdlLWZyb20td2luZG93LWFjY2Vzcy1kZW5pCiAqIGh0dHBzOi8vY2xvdWQudGVuY2VudC5jb20vZGV2ZWxvcGVyL2FydGljbGUvMTgwMzA5NyAo5b2TbG9jYWxTdG9yYWdl5LiN6IO955So5pe277yMd2luZG93LmxvY2FsU3RvcmFnZeS4um51bGzvvIzogIzkuI3mmK/mlofkuK3nmoR1bmRlZmluZWQpCiAqLwpmdW5jdGlvbiBpc0xvY2FsU3RvcmFnZVVzYWJsZSAoKSB7CiAgcmV0dXJuIHdpbmRvdy5sb2NhbFN0b3JhZ2UgJiYgd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtIGluc3RhbmNlb2YgRnVuY3Rpb24gJiYgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtIGluc3RhbmNlb2YgRnVuY3Rpb24KfQoKLyoqCiAqIOWIpOaWrUdsb2JhbFN0b3JhZ2XmmK/lkKblj6/nlKjvvIznm67liY3kvb/nlKjnmoRHbG9iYWxTdG9yYWdl5piv5Z+65LqOdGFtcGVybW9ua2V55o+Q5L6b55qE55u45YWzYXBpCiAqIGh0dHBzOi8vd3d3LnRhbXBlcm1vbmtleS5uZXQvZG9jdW1lbnRhdGlvbi5waHA/ZXh0PWRoZGcjR01fc2V0VmFsdWUKICovCmZ1bmN0aW9uIGlzR2xvYmFsU3RvcmFnZVVzYWJsZSAoKSB7CiAgcmV0dXJuIHdpbmRvdy5HTV9zZXRWYWx1ZSAmJiB3aW5kb3cuR01fZ2V0VmFsdWUgJiYgd2luZG93LkdNX2RlbGV0ZVZhbHVlICYmIHdpbmRvdy5HTV9saXN0VmFsdWVzIGluc3RhbmNlb2YgRnVuY3Rpb24KfQoKLyoqCiAqIOWtmOWCqOW5suWHgOeahGxvY2FsU3RvcmFnZeebuOWFs+aWueazlQogKiDpmLLmraJsb2NhbFN0b3JhZ2Xlr7nosaHkuIvnmoTmlrnms5XooqvmlLnlhpnogIzlr7zoh7Tor7vlj5blkozlhpnlhaXop4TliJnkuI3kuIDmoLfnmoTpl67popgKICovCmNvbnN0IHJhd0xvY2FsU3RvcmFnZSA9IChmdW5jdGlvbiBnZXRSYXdMb2NhbFN0b3JhZ2UgKCkgewogIGNvbnN0IGxvY2FsU3RvcmFnZUFwaXMgPSBbJ2dldEl0ZW0nLCAnc2V0SXRlbScsICdyZW1vdmVJdGVtJywgJ2NsZWFyJywgJ2tleSddOwoKICBjb25zdCByYXdMb2NhbFN0b3JhZ2UgPSB7fTsKCiAgbG9jYWxTdG9yYWdlQXBpcy5mb3JFYWNoKChhcGlLZXkpID0+IHsKICAgIGlmIChpc0xvY2FsU3RvcmFnZVVzYWJsZSgpKSB7CiAgICAgIHJhd0xvY2FsU3RvcmFnZVtgXyR7YXBpS2V5fV9gXSA9IGxvY2FsU3RvcmFnZVthcGlLZXldOwogICAgICByYXdMb2NhbFN0b3JhZ2VbYXBpS2V5XSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gcmF3TG9jYWxTdG9yYWdlW2BfJHthcGlLZXl9X2BdLmFwcGx5KGxvY2FsU3RvcmFnZSwgYXJndW1lbnRzKQogICAgICB9OwogICAgfSBlbHNlIHsKICAgICAgcmF3TG9jYWxTdG9yYWdlW2FwaUtleV0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgY29uc29sZS5lcnJvcignbG9jYWxTdG9yYWdlIHVuYXZhaWxhYmxlJyk7CiAgICAgIH07CiAgICB9CiAgfSk7CgogIHJldHVybiByYXdMb2NhbFN0b3JhZ2UKfSkoKTsKCmNsYXNzIENvbmZpZ01hbmFnZXIgewogIGNvbnN0cnVjdG9yIChvcHRzKSB7CiAgICB0aGlzLm9wdHMgPSBvcHRzOwogIH0KCiAgaXNMb2NhbFN0b3JhZ2VVc2FibGUgPSBpc0xvY2FsU3RvcmFnZVVzYWJsZQogIGlzR2xvYmFsU3RvcmFnZVVzYWJsZSA9IGlzR2xvYmFsU3RvcmFnZVVzYWJsZQoKICAvKioKICAgKiDlsIZjb25mUGF0aOi9rOaNouensOacgOe7iOWtmOWCqOWIsGxvY2FsU3RvcmFnZeaIlmdsb2JhbFN0b3JhZ2Xph4znmoTplK7lkI0KICAgKiBAcGFyYW0ge1N0cmluZ30gY29uZlBhdGggLeW/hemAie+8jOmFjee9rui3r+W+hOS/oeaBr++8muS+i+Wmgu+8midlbmhhbmNlLmJsb2NrU2V0UGxheWJhY2tSYXRlJwogICAqIEByZXR1cm5zIHtrZXlOYW1lfQogICAqLwogIGdldENvbmZLZXlOYW1lIChjb25mUGF0aCA9ICcnKSB7CiAgICByZXR1cm4gdGhpcy5vcHRzLnByZWZpeCArIGNvbmZQYXRoLnJlcGxhY2UoL1wuL2csICdfJykKICB9CgogIC8qKgogICAqIOWwhuWtmOWCqOWIsGxvY2FsU3RvcmFnZeaIlmdsb2JhbFN0b3JhZ2Xph4znmoTplK7lkI3ovazmjaLmiJDlrp7pmYXosIPnlKjml7blgJnnmoRjb25mUGF0aAogICAqIEBwYXJhbSB7U3RyaW5nfSBrZXlOYW1lIC3lv4XpgIkg5a2Y5YKo5YiwbG9jYWxTdG9yYWdl5oiWZ2xvYmFsU3RvcmFnZemHjOeahOmUruWQje+8jOS+i+Wmgu+8midfaDVwbGF5ZXJfZW5oYW5jZV9ibG9ja1NldFBsYXliYWNrUmF0ZScKICAgKiBAcmV0dXJucyB7Y29uZlBhdGh9CiAgICovCiAgZ2V0Q29uZlBhdGggKGtleU5hbWUgPSAnJykgewogICAgcmV0dXJuIGtleU5hbWUucmVwbGFjZSh0aGlzLm9wdHMucHJlZml4LCAnJykucmVwbGFjZSgvXy9nLCAnLicpCiAgfQoKICBnZXRDb25mUGF0aExpc3QgKGNvbmZpZykgewogICAgY29uc3QgY29uZlBhdGhMaXN0ID0gW107CgogICAgLyog6YCS5b2S6I635Y+W5omA5pyJ6YWN572u6aG555qE6Lev5b6EICovCiAgICBmdW5jdGlvbiBnZXRDb25mUGF0aExpc3QgKGNvbmZpZywgcGF0aCA9ICcnKSB7CiAgICAgIE9iamVjdC5rZXlzKGNvbmZpZykuZm9yRWFjaCgoa2V5KSA9PiB7CiAgICAgICAgY29uc3QgcGF0aEtleSA9IHBhdGggPyBgJHtwYXRofS4ke2tleX1gIDoga2V5OwogICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoY29uZmlnW2tleV0pID09PSAnW29iamVjdCBPYmplY3RdJykgewogICAgICAgICAgZ2V0Q29uZlBhdGhMaXN0KGNvbmZpZ1trZXldLCBwYXRoS2V5KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uZlBhdGhMaXN0LnB1c2gocGF0aEtleSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICAgIGdldENvbmZQYXRoTGlzdChjb25maWcpOwoKICAgIHJldHVybiBjb25mUGF0aExpc3QKICB9CgogIC8qKgogICAqIOagueaNrue7meWumueahOmFjee9rui3r+W+hO+8jOiOt+WPluebuOWFs+mFjee9ruS/oeaBrwogICAqIOiOt+WPlumhuuW6j++8mkxvY2FsU3RvcmFnZSA+IEdsb2JhbFN0b3JhZ2UgPiBkZWZDb25maWcgPiBudWxsCiAgICogQHBhcmFtIHtTdHJpbmd9IGNvbmZQYXRoIC3lv4XpgInvvIzphY3nva7ot6/lvoTkv6Hmga/vvJrkvovlpoLvvJonZW5oYW5jZS5ibG9ja1NldFBsYXliYWNrUmF0ZScKICAgKiBAcmV0dXJucyB7Kn0g5aaC5p6c6L+U5ZuebnVsbO+8jOWImeihqOekuuayoeiOt+WPluWIsOebuOWFs+mFjee9ruS/oeaBrwogICAqLwogIGdldCAoY29uZlBhdGgpIHsKICAgIGlmICh0eXBlb2YgY29uZlBhdGggIT09ICdzdHJpbmcnKSB7CiAgICAgIHJldHVybiBudWxsCiAgICB9CgogICAgLyog6buY6K6k5LyY5YWI5L2/55So5pys5Zyw55qEbG9jYWxTdG9yYWdl6YWN572uICovCiAgICBjb25zdCBsb2NhbENvbmYgPSB0aGlzLmdldExvY2FsU3RvcmFnZShjb25mUGF0aCk7CiAgICBpZiAobG9jYWxDb25mICE9PSBudWxsICYmIGxvY2FsQ29uZiAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiBsb2NhbENvbmYKICAgIH0KCiAgICAvKiDlpoLmnpxsb2NhbFN0b3JhZ2XmsqHnm7jlhbPphY3nva7vvIzliJnlsJ3or5Xkvb/nlKhHbG9iYWxTdG9yYWdl55qE6YWN572uICovCiAgICBjb25zdCBnbG9iYWxDb25mID0gdGhpcy5nZXRHbG9iYWxTdG9yYWdlKGNvbmZQYXRoKTsKICAgIGlmIChnbG9iYWxDb25mICE9PSBudWxsICYmIGdsb2JhbENvbmYgIT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gZ2xvYmFsQ29uZgogICAgfQoKICAgIC8qIOWmguaenGxvY2FsU3RvcmFnZeWSjEdsb2JhbFN0b3JhZ2XphY3nva7pg73msqHmib7liLDvvIzliJnlsJ3or5XlnKjpu5jorqTphY3nva7ooajph4zmi7/nm7jlhbPphY3nva7kv6Hmga8gKi8KICAgIHJldHVybiB0aGlzLmdldE1lbW9yeVN0b3JhZ2UoY29uZlBhdGgpCiAgfQoKICAvKioKICAgKiDlsIbphY3nva7nu5PmnpzlhpnlhaXliLBsb2NhbFN0b3JhZ2XmiJZHbG9iYWxTdG9yYWdlCiAgICog5YaZ5YWl6aG65bqP77yaTG9jYWxTdG9yYWdlID4gR2xvYmFsU3RvcmFnZQogICAqIOaXoOiuuuaYr+WQpuWGmeWFpeaIkOWKn+mDveS8muWwhue7k+aenOabtOaWsOWIsGRlZkNvbmZpZ+mHjOWvueW6lOeahOmFjee9rumhueS4igogICAqIEBwYXJhbSB7U3RyaW5nfSBjb25mUGF0aAogICAqIEBwYXJhbSB7Kn0gdmFsCiAgICogQHJldHVybnMge0Jvb2xlYW59CiAgICovCiAgc2V0IChjb25mUGF0aCwgdmFsKSB7CiAgICBpZiAodHlwZW9mIGNvbmZQYXRoICE9PSAnc3RyaW5nJyB8fCB0eXBlb2YgdmFsID09PSAndW5kZWZpbmVkJyB8fCB2YWwgPT09IG51bGwpIHsKICAgICAgcmV0dXJuIGZhbHNlCiAgICB9CgogICAgc2V0VmFsQnlQYXRoKHRoaXMub3B0cy5jb25maWcsIGNvbmZQYXRoLCB2YWwpOwoKICAgIGxldCBzdWNTdGF0dXMgPSBmYWxzZTsKCiAgICBzdWNTdGF0dXMgPSB0aGlzLnNldExvY2FsU3RvcmFnZShjb25mUGF0aCwgdmFsKTsKCiAgICBpZiAoIXN1Y1N0YXR1cykgewogICAgICBzdWNTdGF0dXMgPSB0aGlzLnNldEdsb2JhbFN0b3JhZ2UoY29uZlBhdGgsIHZhbCk7CiAgICB9CgogICAgcmV0dXJuIHN1Y1N0YXR1cwogIH0KCiAgLyog6I635Y+W5bm25YiX5Ye65b2T5YmN5omA5pyJ5bey6K6+5a6a55qE6YWN572u6aG5ICovCiAgbGlzdCAoKSB7CiAgICBjb25zdCByZXN1bHQgPSB7CiAgICAgIGxvY2FsQ29uZjogdGhpcy5saXN0TG9jYWxTdG9yYWdlKCksCiAgICAgIGdsb2JhbENvbmY6IHRoaXMubGlzdEdsb2JhbFN0b3JhZ2UoKSwKICAgICAgZGVmQ29uZmlnOiB0aGlzLm9wdHMuY29uZmlnCiAgICB9OwogICAgcmV0dXJuIHJlc3VsdAogIH0KCiAgLyog5riF6Zmk5bey57uP5YaZ5YWl5Yiw5pys5Zyw5a2Y5YKo6YeM55qE6YWN572u6aG5ICovCiAgY2xlYXIgKCkgewogICAgdGhpcy5jbGVhckxvY2FsU3RvcmFnZSgpOwogICAgdGhpcy5jbGVhckdsb2JhbFN0b3JhZ2UoKTsKICB9CgogIGdldE1lbW9yeVN0b3JhZ2UgKGNvbmZQYXRoKSB7CiAgICBpZiAodHlwZW9mIGNvbmZQYXRoICE9PSAnc3RyaW5nJykgeyByZXR1cm4gbnVsbCB9CgogICAgY29uc3QgY29uZmlnID0gdGhpcy5nZXRDb25mT2JqKCk7CiAgICBjb25zdCB2YWwgPSBnZXRWYWxCeVBhdGgkMShjb25maWcsIGNvbmZQYXRoKTsKICAgIGlmICh0eXBlb2YgdmFsICE9PSAndW5kZWZpbmVkJyAmJiB2YWwgIT09IG51bGwpIHsKICAgICAgcmV0dXJuIHZhbAogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIG51bGwKICAgIH0KICB9CgogIC8qKgogICAqIOagueaNrue7meWumueahOmFjee9rui3r+W+hO+8jOiOt+WPlkxvY2FsU3RvcmFnZeS4i+WumuS5ieeahOmFjee9ruS/oeaBrwogICAqIEBwYXJhbSB7U3RyaW5nfSBjb25mUGF0aCAt5b+F6YCJ77yM6YWN572u6Lev5b6E5L+h5oGvCiAgICogQHJldHVybnMKICAgKi8KICBnZXRMb2NhbFN0b3JhZ2UgKGNvbmZQYXRoKSB7CiAgICBpZiAodHlwZW9mIGNvbmZQYXRoICE9PSAnc3RyaW5nJykgewogICAgICByZXR1cm4gbnVsbAogICAgfQoKICAgIGNvbnN0IGtleSA9IHRoaXMuZ2V0Q29uZktleU5hbWUoY29uZlBhdGgpOwoKICAgIGlmIChpc0xvY2FsU3RvcmFnZVVzYWJsZSgpKSB7CiAgICAgIGxldCBsb2NhbENvbmYgPSByYXdMb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpOwogICAgICBpZiAobG9jYWxDb25mICE9PSBudWxsICYmIGxvY2FsQ29uZiAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGxvY2FsQ29uZiA9IEpTT04ucGFyc2UobG9jYWxDb25mKTsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCdjb25maWdNYW5hZ2VyIHBhcnNlIGxvY2FsU3RvcmFnZSBlcnJvcjonLCBrZXksIGxvY2FsQ29uZik7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbG9jYWxDb25mCiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TWVtb3J5U3RvcmFnZShjb25mUGF0aCkKICAgICAgfQogICAgfQoKICAgIHJldHVybiBudWxsCiAgfQoKICAvKioKICAgKiDmoLnmja7nu5nlrprnmoTphY3nva7ot6/lvoTvvIzojrflj5ZHbG9iYWxTdG9yYWdl5LiL5a6a5LmJ55qE6YWN572u5L+h5oGvCiAgICogQHBhcmFtIHtTdHJpbmd9IGNvbmZQYXRoIC3lv4XpgInvvIzphY3nva7ot6/lvoTkv6Hmga8KICAgKiBAcmV0dXJucwogICAqLwogIGdldEdsb2JhbFN0b3JhZ2UgKGNvbmZQYXRoKSB7CiAgICBpZiAodHlwZW9mIGNvbmZQYXRoICE9PSAnc3RyaW5nJykgewogICAgICByZXR1cm4gbnVsbAogICAgfQoKICAgIGNvbnN0IGtleSA9IHRoaXMuZ2V0Q29uZktleU5hbWUoY29uZlBhdGgpOwoKICAgIGlmIChpc0dsb2JhbFN0b3JhZ2VVc2FibGUoKSkgewogICAgICBjb25zdCBnbG9iYWxDb25mID0gd2luZG93LkdNX2dldFZhbHVlKGtleSk7CiAgICAgIGlmIChnbG9iYWxDb25mICE9PSBudWxsICYmIGdsb2JhbENvbmYgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiBnbG9iYWxDb25mCiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TWVtb3J5U3RvcmFnZShjb25mUGF0aCkKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgLyog6Z2e5rK554y0546v5aKD77yM5Zue6YCA5YiwbG9jYWxTdG9yYWdl5a2Y5YKoICovCiAgICAgIHJldHVybiB0aGlzLmdldExvY2FsU3RvcmFnZShjb25mUGF0aCkKICAgIH0KICB9CgogIHNldE1lbW9yeVN0b3JhZ2UgKGNvbmZQYXRoLCB2YWwpIHsKICAgIGlmICh0eXBlb2YgY29uZlBhdGggIT09ICdzdHJpbmcnIHx8IHR5cGVvZiB2YWwgPT09ICd1bmRlZmluZWQnIHx8IHZhbCA9PT0gbnVsbCkgewogICAgICByZXR1cm4gZmFsc2UKICAgIH0gZWxzZSB7CiAgICAgIHNldFZhbEJ5UGF0aCh0aGlzLm9wdHMuY29uZmlnLCBjb25mUGF0aCwgdmFsKTsKICAgICAgcmV0dXJuIHRydWUKICAgIH0KICB9CgogIC8qKgogICAqIOWwhumFjee9rue7k+aenOWGmeWFpeWIsGxvY2FsU3RvcmFnZemHjAogICAqIEBwYXJhbSB7U3RyaW5nfSBjb25mUGF0aAogICAqIEBwYXJhbSB7Kn0gdmFsCiAgICogQHJldHVybnMge0Jvb2xlYW59CiAgICovCiAgc2V0TG9jYWxTdG9yYWdlIChjb25mUGF0aCwgdmFsKSB7CiAgICBpZiAodHlwZW9mIGNvbmZQYXRoICE9PSAnc3RyaW5nJyB8fCB0eXBlb2YgdmFsID09PSAndW5kZWZpbmVkJyB8fCB2YWwgPT09IG51bGwpIHsKICAgICAgcmV0dXJuIGZhbHNlCiAgICB9CgogICAgc2V0VmFsQnlQYXRoKHRoaXMub3B0cy5jb25maWcsIGNvbmZQYXRoLCB2YWwpOwoKICAgIGNvbnN0IGtleSA9IHRoaXMuZ2V0Q29uZktleU5hbWUoY29uZlBhdGgpOwoKICAgIGlmIChpc0xvY2FsU3RvcmFnZVVzYWJsZSgpKSB7CiAgICAgIHRyeSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh2YWwpID09PSAnW29iamVjdCBPYmplY3RdJyB8fCBBcnJheS5pc0FycmF5KHZhbCkpIHsKICAgICAgICAgIHZhbCA9IEpTT04uc3RyaW5naWZ5KHZhbCk7CiAgICAgICAgfQoKICAgICAgICByYXdMb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIHZhbCk7CgogICAgICAgIHJldHVybiB0cnVlCiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCdjb25maWdNYW5hZ2VyIHNldCBsb2NhbFN0b3JhZ2UgZXJyb3I6Jywga2V5LCB2YWwsIGUpOwogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZmFsc2UKICAgIH0KICB9CgogIC8qKgogICAqIOWwhumFjee9rue7k+aenOWGmeWFpeWIsGdsb2JhbFN0b3JhZ2Xph4wKICAgKiBAcGFyYW0ge1N0cmluZ30gY29uZlBhdGgKICAgKiBAcGFyYW0geyp9IHZhbAogICAqIEByZXR1cm5zIHtCb29sZWFufQogICAqLwogIHNldEdsb2JhbFN0b3JhZ2UgKGNvbmZQYXRoLCB2YWwpIHsKICAgIGlmICh0eXBlb2YgY29uZlBhdGggIT09ICdzdHJpbmcnIHx8IHR5cGVvZiB2YWwgPT09ICd1bmRlZmluZWQnIHx8IHZhbCA9PT0gbnVsbCkgewogICAgICByZXR1cm4gZmFsc2UKICAgIH0KCiAgICBzZXRWYWxCeVBhdGgodGhpcy5vcHRzLmNvbmZpZywgY29uZlBhdGgsIHZhbCk7CgogICAgY29uc3Qga2V5ID0gdGhpcy5nZXRDb25mS2V5TmFtZShjb25mUGF0aCk7CgogICAgaWYgKGlzR2xvYmFsU3RvcmFnZVVzYWJsZSgpKSB7CiAgICAgIHRyeSB7CiAgICAgICAgd2luZG93LkdNX3NldFZhbHVlKGtleSwgdmFsKTsKICAgICAgICByZXR1cm4gdHJ1ZQogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgY29uc29sZS5lcnJvcignY29uZmlnTWFuYWdlciBzZXQgZ2xvYmFsU3RvcmFnZSBlcnJvcjonLCBrZXksIHZhbCwgZSk7CiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIC8qIOmdnuayueeMtOeOr+Wig++8jOWbnumAgOWIsGxvY2FsU3RvcmFnZeWtmOWCqCAqLwogICAgICByZXR1cm4gdGhpcy5zZXRMb2NhbFN0b3JhZ2UoY29uZlBhdGgsIHZhbCkKICAgIH0KICB9CgogIGxpc3RMb2NhbFN0b3JhZ2UgKCkgewogICAgaWYgKGlzTG9jYWxTdG9yYWdlVXNhYmxlKCkpIHsKICAgICAgY29uc3QgcmVzdWx0ID0ge307CiAgICAgIE9iamVjdC5rZXlzKGxvY2FsU3RvcmFnZSkuZm9yRWFjaCgoa2V5KSA9PiB7CiAgICAgICAgaWYgKGtleS5zdGFydHNXaXRoKHRoaXMub3B0cy5wcmVmaXgpKSB7CiAgICAgICAgICBjb25zdCBjb25mUGF0aCA9IHRoaXMuZ2V0Q29uZlBhdGgoa2V5KTsKICAgICAgICAgIHJlc3VsdFtjb25mUGF0aF0gPSB0aGlzLmdldExvY2FsU3RvcmFnZShjb25mUGF0aCk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgcmV0dXJuIHJlc3VsdAogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHt9CiAgICB9CiAgfQoKICBsaXN0R2xvYmFsU3RvcmFnZSAoKSB7CiAgICBpZiAoaXNHbG9iYWxTdG9yYWdlVXNhYmxlKCkpIHsKICAgICAgY29uc3QgcmVzdWx0ID0ge307CiAgICAgIGNvbnN0IGdsb2JhbFN0b3JhZ2UgPSB3aW5kb3cuR01fbGlzdFZhbHVlcygpOwogICAgICBnbG9iYWxTdG9yYWdlLmZvckVhY2goKGtleSkgPT4gewogICAgICAgIGlmIChrZXkuc3RhcnRzV2l0aCh0aGlzLm9wdHMucHJlZml4KSkgewogICAgICAgICAgY29uc3QgY29uZlBhdGggPSB0aGlzLmdldENvbmZQYXRoKGtleSk7CiAgICAgICAgICByZXN1bHRbY29uZlBhdGhdID0gdGhpcy5nZXRHbG9iYWxTdG9yYWdlKGNvbmZQYXRoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gcmVzdWx0CiAgICB9IGVsc2UgewogICAgICByZXR1cm4ge30KICAgIH0KICB9CgogIGdldENvbmZPYmogKCkgewogICAgY29uc3QgY29uZkxpc3QgPSB0aGlzLmxpc3QoKTsKCiAgICAvKiDlkIzmraXlhajlsYDphY3nva7liLB0aGlzLm9wdHMuY29uZmlnICovCiAgICBPYmplY3Qua2V5cyhjb25mTGlzdC5nbG9iYWxDb25mKS5mb3JFYWNoKChjb25mUGF0aCkgPT4gewogICAgICBzZXRWYWxCeVBhdGgodGhpcy5vcHRzLmNvbmZpZywgY29uZlBhdGgsIGNvbmZMaXN0Lmdsb2JhbENvbmZbY29uZlBhdGhdKTsKICAgIH0pOwoKICAgIC8qIOWQjOatpeacrOWcsOmFjee9ruWIsHRoaXMub3B0cy5jb25maWcgKi8KICAgIE9iamVjdC5rZXlzKGNvbmZMaXN0LmxvY2FsQ29uZikuZm9yRWFjaCgoY29uZlBhdGgpID0+IHsKICAgICAgc2V0VmFsQnlQYXRoKHRoaXMub3B0cy5jb25maWcsIGNvbmZQYXRoLCBjb25mTGlzdC5sb2NhbENvbmZbY29uZlBhdGhdKTsKICAgIH0pOwoKICAgIHJldHVybiB0aGlzLm9wdHMuY29uZmlnCiAgfQoKICBzZXRMb2NhbFN0b3JhZ2VCeU9iaiAoY29uZmlnKSB7CiAgICBjb25zdCBvbGRDb25maWcgPSB0aGlzLmdldENvbmZPYmooKTsKICAgIGNvbnN0IGNvbmZQYXRoTGlzdCA9IHRoaXMuZ2V0Q29uZlBhdGhMaXN0KGNvbmZpZyk7CiAgICBjb25mUGF0aExpc3QuZm9yRWFjaCgoY29uZlBhdGgpID0+IHsKICAgICAgY29uc3Qgb2xkVmFsID0gZ2V0VmFsQnlQYXRoJDEob2xkQ29uZmlnLCBjb25mUGF0aCk7CiAgICAgIGNvbnN0IHZhbCA9IGdldFZhbEJ5UGF0aCQxKGNvbmZpZywgY29uZlBhdGgpOwoKICAgICAgLyog6Lez6L+H5LiA5qC355qE5YC85oiW5Zyo5pen6YWN572u5Lit5LiN5a2Y5Zyo55qE5YC8ICovCiAgICAgIGlmIChvbGRWYWwgPT09IHZhbCB8fCBvbGRWYWwgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybgogICAgICB9CgogICAgICB0aGlzLnNldExvY2FsU3RvcmFnZShjb25mUGF0aCwgdmFsKTsKICAgIH0pOwogIH0KCiAgc2V0R2xvYmFsU3RvcmFnZUJ5T2JqIChjb25maWcpIHsKICAgIGNvbnN0IG9sZENvbmZpZyA9IHRoaXMuZ2V0Q29uZk9iaigpOwogICAgY29uc3QgY29uZlBhdGhMaXN0ID0gdGhpcy5nZXRDb25mUGF0aExpc3QoY29uZmlnKTsKICAgIGNvbmZQYXRoTGlzdC5mb3JFYWNoKChjb25mUGF0aCkgPT4gewogICAgICBjb25zdCBvbGRWYWwgPSBnZXRWYWxCeVBhdGgkMShvbGRDb25maWcsIGNvbmZQYXRoKTsKICAgICAgY29uc3QgdmFsID0gZ2V0VmFsQnlQYXRoJDEoY29uZmlnLCBjb25mUGF0aCk7CgogICAgICAvKiDot7Pov4fkuIDmoLfnmoTlgLzmiJblnKjml6fphY3nva7kuK3kuI3lrZjlnKjnmoTlgLwgKi8KCiAgICAgIGlmIChvbGRWYWwgPT09IHZhbCB8fCBvbGRWYWwgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybgogICAgICB9CgogICAgICAvLyBjb25zb2xlLmxvZygnc2V0R2xvYmFsU3RvcmFnZUJ5T2JqJywgY29uZlBhdGgsIHZhbCkKCiAgICAgIHRoaXMuc2V0R2xvYmFsU3RvcmFnZShjb25mUGF0aCwgdmFsKTsKICAgIH0pOwogIH0KCiAgY2xlYXJMb2NhbFN0b3JhZ2UgKCkgewogICAgaWYgKGlzTG9jYWxTdG9yYWdlVXNhYmxlKCkpIHsKICAgICAgT2JqZWN0LmtleXMobG9jYWxTdG9yYWdlKS5mb3JFYWNoKChrZXkpID0+IHsKICAgICAgICBpZiAoa2V5LnN0YXJ0c1dpdGgodGhpcy5vcHRzLnByZWZpeCkpIHsKICAgICAgICAgIHJhd0xvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9CgogIGNsZWFyR2xvYmFsU3RvcmFnZSAoKSB7CiAgICBpZiAoaXNHbG9iYWxTdG9yYWdlVXNhYmxlKCkpIHsKICAgICAgY29uc3QgZ2xvYmFsU3RvcmFnZSA9IHdpbmRvdy5HTV9saXN0VmFsdWVzKCk7CiAgICAgIGdsb2JhbFN0b3JhZ2UuZm9yRWFjaCgoa2V5KSA9PiB7CiAgICAgICAgaWYgKGtleS5zdGFydHNXaXRoKHRoaXMub3B0cy5wcmVmaXgpKSB7CiAgICAgICAgICB3aW5kb3cuR01fZGVsZXRlVmFsdWUoa2V5KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KCiAgbWVyZ2VEZWZDb25mIChjb25mKSB7CiAgICByZXR1cm4gbWVyZ2VPYmoodGhpcy5vcHRzLmNvbmZpZywgY29uZikKICB9Cn0KCi8qIOS9v+eUqOekuuS+i++8miAqLwovLyBjb25zdCBteUNvbmZpZyA9IG5ldyBDb25maWdNYW5hZ2VyKHsKLy8gICBwcmVmaXg6ICdfbXlDb25maWdfJywKLy8gICBjb25maWc6IHsKLy8gICAgIGhvdGtleXM6IFsKLy8gICAgICAgewovLyAgICAgICAgIGRlc2M6ICfmtYvor5UnLAovLyAgICAgICAgIGtleTogJ3YnLAovLyAgICAgICAgIGNvbW1hbmQ6ICd0b2dnbGVWaXNpYmxlJywKLy8gICAgICAgICAvKiDlpoLpnIDnpoHnlKjlv6vmjbfplK7vvIzlsIZkaXNhYmxlZOiuvuS4unRydWUgKi8KLy8gICAgICAgICBkaXNhYmxlZDogZmFsc2UsCi8vICAgICAgIH0sCi8vICAgICBdLAovLyAgICAgZW5hYmxlOiB0cnVlLAovLyAgICAgZGVidWc6IGZhbHNlLAovLyAgIH0sCi8vIH0pCi8vIG15Q29uZmlnLnNldCgnZW5hYmxlJywgZmFsc2UpCi8vIC8qIOWvueS6juaVsOe7hO+8jOaaguS4jeaUr+aMgeebtOaOpeS/ruaUueaVsOe7hOWFg+e0oO+8jOmcgOimgeWFiOiOt+WPluaVsOe7hO+8jOWGjeS/ruaUueaVsOe7hOWFg+e0oO+8jOWGjemHjeaWsOWGmeWFpSAqLwovLyBjb25zdCBob3RrZXlzID0gbXlDb25maWcuZ2V0KCdob3RrZXlzJykKLy8gaG90a2V5c1swXS5kaXNhYmxlZCA9IHRydWUKLy8gbXlDb25maWcuc2V0KCdob3RrZXlzJywgaG90a2V5cykKCmNvbnN0IGNvbmZpZ01hbmFnZXIgPSBuZXcgQ29uZmlnTWFuYWdlcih7CiAgcHJlZml4OiAnX2g1cGxheWVyXycsCiAgY29uZmlnOiB7CiAgICBlbmFibGU6IHRydWUsCiAgICBtZWRpYTogewogICAgICBhdXRvUGxheTogZmFsc2UsCiAgICAgIHBsYXliYWNrUmF0ZTogMSwKICAgICAgdm9sdW1lOiAxLAoKICAgICAgLyog5pyA5ZCO5LiA5qyh6K6+5a6a55qE5pKt5pS+6YCf5bqm77yM6buY6K6kMS41ICovCiAgICAgIGxhc3RQbGF5YmFja1JhdGU6IDEuNSwKCiAgICAgIC8qIOaYr+WQpuWFgeiuuOWtmOWCqOaSreaUvui/m+W6piAqLwogICAgICBhbGxvd1Jlc3RvcmVQbGF5UHJvZ3Jlc3M6IHsKCiAgICAgIH0sCiAgICAgIC8qIOinhumikeaSreaUvui/m+W6puaYoOWwhOihqCAqLwogICAgICBwcm9ncmVzczoge30KICAgIH0sCiAgICBlbmFibGVIb3RrZXlzOiB0cnVlLAogICAgaG90a2V5czogWwogICAgICB7CiAgICAgICAgZGVzYzogJ+e9kemhteWFqOWxjycsCiAgICAgICAga2V5OiAnc2hpZnQrZW50ZXInLAogICAgICAgIGNvbW1hbmQ6ICdzZXRXZWJGdWxsU2NyZWVuJywKICAgICAgICAvKiDlpoLpnIDnpoHnlKjlv6vmjbfplK7vvIzlsIZkaXNhYmxlZOiuvuS4unRydWUgKi8KICAgICAgICBkaXNhYmxlZDogZmFsc2UKICAgICAgfSwKICAgICAgewogICAgICAgIGRlc2M6ICflhajlsY8nLAogICAgICAgIGtleTogJ2VudGVyJywKICAgICAgICBjb21tYW5kOiAnc2V0RnVsbFNjcmVlbicKICAgICAgfSwKICAgICAgewogICAgICAgIGRlc2M6ICfliIfmjaLnlLvkuK3nlLvmqKHlvI8nLAogICAgICAgIGtleTogJ3NoaWZ0K3AnLAogICAgICAgIGNvbW1hbmQ6ICd0b2dnbGVQaWN0dXJlSW5QaWN0dXJlJwogICAgICB9LAogICAgICB7CiAgICAgICAgZGVzYzogJ+inhumikeaIquWbvicsCiAgICAgICAga2V5OiAnc2hpZnQrcycsCiAgICAgICAgY29tbWFuZDogJ2NhcHR1cmUnCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBkZXNjOiAn5ZCv55So5oiW56aB5q2i6Ieq5Yqo5oGi5aSN5pKt5pS+6L+b5bqm5Yqf6IO9JywKICAgICAgICBrZXk6ICdzaGlmdCtyJywKICAgICAgICBjb21tYW5kOiAnc3dpdGNoUmVzdG9yZVBsYXlQcm9ncmVzc1N0YXR1cycKICAgICAgfSwKICAgICAgewogICAgICAgIGRlc2M6ICflnoLnm7TplZzlg4/nv7vovawnLAogICAgICAgIGtleTogJ3NoaWZ0K20nLAogICAgICAgIGNvbW1hbmQ6ICdzZXRNaXJyb3InLAogICAgICAgIGFyZ3M6IFt0cnVlXQogICAgICB9LAogICAgICB7CiAgICAgICAgZGVzYzogJ+awtOW5s+mVnOWDj+e/u+i9rCcsCiAgICAgICAga2V5OiAnbScsCiAgICAgICAgY29tbWFuZDogJ3NldE1pcnJvcicKICAgICAgfSwKICAgICAgewogICAgICAgIGRlc2M6ICfkuIvovb3pn7Pop4bpopHmlofku7bvvIjlrp7pqozmgKflip/og73vvIknLAogICAgICAgIGtleTogJ3NoaWZ0K2QnLAogICAgICAgIGNvbW1hbmQ6ICdtZWRpYURvd25sb2FkJwogICAgICB9LAogICAgICB7CiAgICAgICAgZGVzYzogJ+e8qeWwj+inhumikeeUu+mdoiAtMC4wNScsCiAgICAgICAga2V5OiAnc2hpZnQreCcsCiAgICAgICAgY29tbWFuZDogJ3NldFNjYWxlRG93bicsCiAgICAgICAgYXJnczogLTAuMDUKICAgICAgfSwKICAgICAgewogICAgICAgIGRlc2M6ICfmlL7lpKfop4bpopHnlLvpnaIgKzAuMDUnLAogICAgICAgIGtleTogJ3NoaWZ0K2MnLAogICAgICAgIGNvbW1hbmQ6ICdzZXRTY2FsZVVwJywKICAgICAgICBhcmdzOiAwLjA1CiAgICAgIH0sCiAgICAgIHsKICAgICAgICBkZXNjOiAn5oGi5aSN6KeG6aKR55S76Z2iJywKICAgICAgICBrZXk6ICdzaGlmdCt6JywKICAgICAgICBjb21tYW5kOiAncmVzZXRUcmFuc2Zvcm0nCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBkZXNjOiAn55S76Z2i5ZCR5Y+z56e75YqoMTBweCcsCiAgICAgICAga2V5OiAnc2hpZnQrYXJyb3dyaWdodCcsCiAgICAgICAgY29tbWFuZDogJ3NldFRyYW5zbGF0ZVJpZ2h0JywKICAgICAgICBhcmdzOiAxMAogICAgICB9LAogICAgICB7CiAgICAgICAgZGVzYzogJ+eUu+mdouWQkeW3puenu+WKqDEwcHgnLAogICAgICAgIGtleTogJ3NoaWZ0K2Fycm93bGVmdCcsCiAgICAgICAgY29tbWFuZDogJ3NldFRyYW5zbGF0ZUxlZnQnLAogICAgICAgIGFyZ3M6IC0xMAogICAgICB9LAogICAgICB7CiAgICAgICAgZGVzYzogJ+eUu+mdouWQkeS4iuenu+WKqDEwcHgnLAogICAgICAgIGtleTogJ3NoaWZ0K2Fycm93dXAnLAogICAgICAgIGNvbW1hbmQ6ICdzZXRUcmFuc2xhdGVVcCcsCiAgICAgICAgYXJnczogMTAKICAgICAgfSwKICAgICAgewogICAgICAgIGRlc2M6ICfnlLvpnaLlkJHkuIvnp7vliqgxMHB4JywKICAgICAgICBrZXk6ICdzaGlmdCthcnJvd2Rvd24nLAogICAgICAgIGNvbW1hbmQ6ICdzZXRUcmFuc2xhdGVEb3duJywKICAgICAgICBhcmdzOiAtMTAKICAgICAgfSwKICAgICAgewogICAgICAgIGRlc2M6ICfliY3ov5s156eSJywKICAgICAgICBrZXk6ICdhcnJvd3JpZ2h0JywKICAgICAgICBjb21tYW5kOiAnc2V0Q3VycmVudFRpbWVVcCcsCiAgICAgICAgYXJnczogNQogICAgICB9LAogICAgICB7CiAgICAgICAgZGVzYzogJ+WQjumAgDXnp5InLAogICAgICAgIGtleTogJ2Fycm93bGVmdCcsCiAgICAgICAgY29tbWFuZDogJ3NldEN1cnJlbnRUaW1lRG93bicsCiAgICAgICAgYXJnczogLTUKICAgICAgfSwKICAgICAgewogICAgICAgIGRlc2M6ICfliY3ov5szMOenkicsCiAgICAgICAga2V5OiAnY3RybCthcnJvd3JpZ2h0JywKICAgICAgICBjb21tYW5kOiAnc2V0Q3VycmVudFRpbWVVcCcsCiAgICAgICAgYXJnczogWzMwXQogICAgICB9LAogICAgICB7CiAgICAgICAgZGVzYzogJ+WQjumAgDMw56eSJywKICAgICAgICBrZXk6ICdjdHJsK2Fycm93bGVmdCcsCiAgICAgICAgY29tbWFuZDogJ3NldEN1cnJlbnRUaW1lRG93bicsCiAgICAgICAgYXJnczogWy0zMF0KICAgICAgfSwKICAgICAgewogICAgICAgIGRlc2M6ICfpn7Pph4/ljYfpq5ggNSUnLAogICAgICAgIGtleTogJ2Fycm93dXAnLAogICAgICAgIGNvbW1hbmQ6ICdzZXRWb2x1bWVVcCcsCiAgICAgICAgYXJnczogWzAuMDVdCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBkZXNjOiAn6Z+z6YeP6ZmN5L2OIDUlJywKICAgICAgICBrZXk6ICdhcnJvd2Rvd24nLAogICAgICAgIGNvbW1hbmQ6ICdzZXRWb2x1bWVEb3duJywKICAgICAgICBhcmdzOiBbLTAuMDVdCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBkZXNjOiAn6Z+z6YeP5Y2H6auYIDIwJScsCiAgICAgICAga2V5OiAnY3RybCthcnJvd3VwJywKICAgICAgICBjb21tYW5kOiAnc2V0Vm9sdW1lVXAnLAogICAgICAgIGFyZ3M6IFswLjJdCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBkZXNjOiAn6Z+z6YeP6ZmN5L2OIDIwJScsCiAgICAgICAga2V5OiAnY3RybCthcnJvd2Rvd24nLAogICAgICAgIGNvbW1hbmQ6ICdzZXRWb2x1bWVEb3duJywKICAgICAgICBhcmdzOiBbLTAuMl0KICAgICAgfSwKICAgICAgewogICAgICAgIGRlc2M6ICfliIfmjaLmmoLlgZwv5pKt5pS+JywKICAgICAgICBrZXk6ICdzcGFjZScsCiAgICAgICAgY29tbWFuZDogJ3N3aXRjaFBsYXlTdGF0dXMnCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBkZXNjOiAn5YeP6YCf5pKt5pS+JywKICAgICAgICBrZXk6ICd4JywKICAgICAgICBjb21tYW5kOiAnc2V0UGxheWJhY2tSYXRlRG93bicsCiAgICAgICAgYXJnczogLTAuMQogICAgICB9LAogICAgICB7CiAgICAgICAgZGVzYzogJ+WKoOmAn+aSreaUvicsCiAgICAgICAga2V5OiAnYycsCiAgICAgICAgY29tbWFuZDogJ3NldFBsYXliYWNrUmF0ZVVwJywKICAgICAgICBhcmdzOiAwLjEKICAgICAgfSwKICAgICAgewogICAgICAgIGRlc2M6ICfmraPluLjpgJ/luqbmkq3mlL4nLAogICAgICAgIGtleTogJ3onLAogICAgICAgIGNvbW1hbmQ6ICdyZXNldFBsYXliYWNrUmF0ZScKICAgICAgfSwKICAgICAgewogICAgICAgIGRlc2M6ICforr7nva4xeOeahOaSreaUvumAn+W6picsCiAgICAgICAga2V5OiAnRGlnaXQxJywKICAgICAgICBjb21tYW5kOiAnc2V0UGxheWJhY2tSYXRlUGx1cycsCiAgICAgICAgYXJnczogMQogICAgICB9LAogICAgICB7CiAgICAgICAgZGVzYzogJ+iuvue9rjF455qE5pKt5pS+6YCf5bqmJywKICAgICAgICBrZXk6ICdOdW1wYWQxJywKICAgICAgICBjb21tYW5kOiAnc2V0UGxheWJhY2tSYXRlUGx1cycsCiAgICAgICAgYXJnczogMQogICAgICB9LAogICAgICB7CiAgICAgICAgZGVzYzogJ+iuvue9rjJ455qE5pKt5pS+6YCf5bqmJywKICAgICAgICBrZXk6ICdEaWdpdDInLAogICAgICAgIGNvbW1hbmQ6ICdzZXRQbGF5YmFja1JhdGVQbHVzJywKICAgICAgICBhcmdzOiAyCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBkZXNjOiAn6K6+572uMnjnmoTmkq3mlL7pgJ/luqYnLAogICAgICAgIGtleTogJ051bXBhZDInLAogICAgICAgIGNvbW1hbmQ6ICdzZXRQbGF5YmFja1JhdGVQbHVzJywKICAgICAgICBhcmdzOiAyCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBkZXNjOiAn6K6+572uM3jnmoTmkq3mlL7pgJ/luqYnLAogICAgICAgIGtleTogJ0RpZ2l0MycsCiAgICAgICAgY29tbWFuZDogJ3NldFBsYXliYWNrUmF0ZVBsdXMnLAogICAgICAgIGFyZ3M6IDMKICAgICAgfSwKICAgICAgewogICAgICAgIGRlc2M6ICforr7nva4zeOeahOaSreaUvumAn+W6picsCiAgICAgICAga2V5OiAnTnVtcGFkMycsCiAgICAgICAgY29tbWFuZDogJ3NldFBsYXliYWNrUmF0ZVBsdXMnLAogICAgICAgIGFyZ3M6IDMKICAgICAgfSwKICAgICAgewogICAgICAgIGRlc2M6ICforr7nva40eOeahOaSreaUvumAn+W6picsCiAgICAgICAga2V5OiAnRGlnaXQ0JywKICAgICAgICBjb21tYW5kOiAnc2V0UGxheWJhY2tSYXRlUGx1cycsCiAgICAgICAgYXJnczogNAogICAgICB9LAogICAgICB7CiAgICAgICAgZGVzYzogJ+iuvue9rjR455qE5pKt5pS+6YCf5bqmJywKICAgICAgICBrZXk6ICdOdW1wYWQ0JywKICAgICAgICBjb21tYW5kOiAnc2V0UGxheWJhY2tSYXRlUGx1cycsCiAgICAgICAgYXJnczogNAogICAgICB9LAogICAgICB7CiAgICAgICAgZGVzYzogJ+S4i+S4gOW4pycsCiAgICAgICAga2V5OiAnRicsCiAgICAgICAgY29tbWFuZDogJ2ZyZWV6ZUZyYW1lJywKICAgICAgICBhcmdzOiAxCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBkZXNjOiAn5LiK5LiA5binJywKICAgICAgICBrZXk6ICdEJywKICAgICAgICBjb21tYW5kOiAnZnJlZXplRnJhbWUnLAogICAgICAgIGFyZ3M6IC0xCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBkZXNjOiAn5aKe5Yqg5Lqu5bqmJywKICAgICAgICBrZXk6ICdFJywKICAgICAgICBjb21tYW5kOiAnc2V0QnJpZ2h0bmVzc1VwJwogICAgICB9LAogICAgICB7CiAgICAgICAgZGVzYzogJ+WHj+WwkeS6ruW6picsCiAgICAgICAga2V5OiAnVycsCiAgICAgICAgY29tbWFuZDogJ3NldEJyaWdodG5lc3NEb3duJwogICAgICB9LAogICAgICB7CiAgICAgICAgZGVzYzogJ+WinuWKoOWvueavlOW6picsCiAgICAgICAga2V5OiAnVCcsCiAgICAgICAgY29tbWFuZDogJ3NldENvbnRyYXN0VXAnCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBkZXNjOiAn5YeP5bCR5a+55q+U5bqmJywKICAgICAgICBrZXk6ICdSJywKICAgICAgICBjb21tYW5kOiAnc2V0Q29udHJhc3REb3duJwogICAgICB9LAogICAgICB7CiAgICAgICAgZGVzYzogJ+WinuWKoOmlseWSjOW6picsCiAgICAgICAga2V5OiAnVScsCiAgICAgICAgY29tbWFuZDogJ3NldFNhdHVyYXRpb25VcCcKICAgICAgfSwKICAgICAgewogICAgICAgIGRlc2M6ICflh4/lsJHppbHlkozluqYnLAogICAgICAgIGtleTogJ1knLAogICAgICAgIGNvbW1hbmQ6ICdzZXRTYXR1cmF0aW9uRG93bicKICAgICAgfSwKICAgICAgewogICAgICAgIGRlc2M6ICflop7liqDoibLnm7gnLAogICAgICAgIGtleTogJ08nLAogICAgICAgIGNvbW1hbmQ6ICdzZXRIdWVVcCcKICAgICAgfSwKICAgICAgewogICAgICAgIGRlc2M6ICflh4/lsJHoibLnm7gnLAogICAgICAgIGtleTogJ0knLAogICAgICAgIGNvbW1hbmQ6ICdzZXRIdWVEb3duJwogICAgICB9LAogICAgICB7CiAgICAgICAgZGVzYzogJ+aooeeziuWinuWKoCAxIHB4JywKICAgICAgICBrZXk6ICdLJywKICAgICAgICBjb21tYW5kOiAnc2V0Qmx1clVwJwogICAgICB9LAogICAgICB7CiAgICAgICAgZGVzYzogJ+aooeeziuWHj+WwkSAxIHB4JywKICAgICAgICBrZXk6ICdKJywKICAgICAgICBjb21tYW5kOiAnc2V0Qmx1ckRvd24nCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBkZXNjOiAn5Zu+5YOP5aSN5L2NJywKICAgICAgICBrZXk6ICdRJywKICAgICAgICBjb21tYW5kOiAncmVzZXRGaWx0ZXJBbmRUcmFuc2Zvcm0nCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBkZXNjOiAn55S76Z2i5peL6L2sIDkwIOW6picsCiAgICAgICAga2V5OiAnUycsCiAgICAgICAgY29tbWFuZDogJ3NldFJvdGF0ZScKICAgICAgfSwKICAgICAgewogICAgICAgIGRlc2M6ICfmkq3mlL7kuIvkuIDpm4YnLAogICAgICAgIGtleTogJ04nLAogICAgICAgIGNvbW1hbmQ6ICdzZXROZXh0VmlkZW8nCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBkZXNjOiAn5o+S5YWlZGVidWdnZXLmlq3ngrknLAogICAgICAgIGtleTogJ2N0cmwrc2hpZnQrYWx0K2QnLAogICAgICAgIGNvbW1hbmQ6ICdkZWJ1Z2dlck5vdycKICAgICAgfSwKICAgICAgewogICAgICAgIGRlc2M6ICfmiafooYxKU+iEmuacrCcsCiAgICAgICAga2V5OiAnY3RybCtqIGN0cmwrcycsCiAgICAgICAgY29tbWFuZDogKCkgPT4gewogICAgICAgICAgYWxlcnQoJ+iHquWumuS5iUpT6ISa5pysJyk7CiAgICAgICAgfSwKICAgICAgICB3aGVuOiAnJwogICAgICB9CiAgICBdLAogICAgbW91c2U6IHsKICAgICAgZW5hYmxlOiBmYWxzZSwKICAgICAgLyog6ZW/5oyJ5aSa5LmF5ZON5bqU6byg5qCH6ZW/5oyJ5LqL5Lu2ICovCiAgICAgIGxvbmdQcmVzc1RpbWU6IDYwMAogICAgfSwKICAgIHVpOiB7CiAgICAgIGVuYWJsZTogdHJ1ZSwKICAgICAgYWx3YXlzU2hvdzogZmFsc2UsCgogICAgICAvKiBVSeaooeWdl+eahOebuOWFs+mFjee9riAqLwogICAgICBtb2Q6IHsKICAgICAgICAvKiDpu5jorqTnpoHnlKjmjqjojZDmqKHlnZcgKi8KICAgICAgICByZWNvbW1lbmQ6IHsKICAgICAgICAgIGVuYWJsZTogZmFsc2UKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBkb3dubG9hZDogewogICAgICBlbmFibGU6IHRydWUKICAgIH0sCiAgICBlbmhhbmNlOiB7CiAgICAgIC8qIOS4jeemgeeUqOm7mOiupOeahOiwg+mAn+mAu+i+ke+8jOWImeWcqOWkmuS4quinhumikeWIh+aNouaXtu+8jOmAn+W6puW+iOWuueaYk+iiq+mHjee9ru+8jOaJgOS7peivpemAiemhuem7mOiupOW8gOWQryAqLwogICAgICBibG9ja1NldFBsYXliYWNrUmF0ZTogdHJ1ZSwKCiAgICAgIGJsb2NrU2V0Q3VycmVudFRpbWU6IGZhbHNlLAogICAgICBibG9ja1NldFZvbHVtZTogZmFsc2UsCiAgICAgIGFsbG93RXhwZXJpbWVudEZlYXR1cmVzOiBmYWxzZSwKICAgICAgYWxsb3dFeHRlcm5hbEN1c3RvbUNvbmZpZ3VyYXRpb246IGZhbHNlLAogICAgICAvKiDmmK/lkKblvIDlkK/pn7Pph4/lop7nm4rlip/og70gKi8KICAgICAgYWxsb3dBY291c3RpY0dhaW46IGZhbHNlLAogICAgICAvKiDmmK/lkKblvIDlkK/ot6jln5/mjqfliLYgKi8KICAgICAgYWxsb3dDcm9zc09yaWdpbkNvbnRyb2w6IHRydWUsCiAgICAgIHVuZm9sZE1lbnU6IGZhbHNlCiAgICB9LAogICAgbGFuZ3VhZ2U6ICdhdXRvJywKICAgIGRlYnVnOiBmYWxzZSwKICAgIGJsYWNrbGlzdDogewogICAgICAvKioKICAgICAgICogdXJs6buR5ZCN5Y2V77yM5Zyo6L+Z5LqbdXJs5LiL6Z2i56aB5q2i6L+Q6KGMaDVwbGF5ZXLohJrmnKwKICAgICAgICog5Lul6YCC5bqU5LiA5Lqb6Zq+5Lul5o6S5p+l44CB5oiW6Zq+5Lul6YCa5LiA5YW85a6555qE6aG16Z2i77yM5L2G5Y+I5LiN5biM5pyb5a+55pW05Liq572R56uZ6L+b6KGM56aB55So55qE5oOF5Ya1CiAgICAgICAqIOS+i+Wmgu+8mkLnq5npppbpobUKICAgICAgICovCiAgICAgIHVybHM6IFsKICAgICAgICAnaHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tLycKICAgICAgXSwKICAgICAgZG9tYWluczogWwogICAgICAgICdjaGFsbGVuZ2VzLmNsb3VkZmxhcmUuY29tJwogICAgICBdCiAgICB9CiAgfQp9KTsKCmFzeW5jIGZ1bmN0aW9uIGluaXRVaUNvbmZpZ01hbmFnZXIgKCkgewogIGNvbnN0IGlzVWlDb25maWdQYWdlID0gbG9jYXRpb24uaHJlZi5pbmRleE9mKCdoNXBsYXllci5hbnp6LnRvcC90b29scy9qc29uLWVkaXRvcicpID4gLTEgfHwgbG9jYXRpb24uaHJlZi5pbmRleE9mKCdoNXBsYXllci5hbnp6LnNpdGUvdG9vbHMvanNvbi1lZGl0b3InKSA+IC0xOwogIGNvbnN0IGlzVWlDb25maWdNb2RlID0gbG9jYXRpb24uaHJlZi5pbmRleE9mKCdzYXZlSGFuZGxlck5hbWU9c2F2ZUg1UGxheWVyQ29uZmlnJykgPiAtMTsKICBpZiAoIWlzVWlDb25maWdQYWdlIHx8ICFpc1VpQ29uZmlnTW9kZSkgcmV0dXJuCgogIGZ1bmN0aW9uIGluaXQgKHBhZ2VXaW5kb3cpIHsKICAgIGNvbnN0IGNvbmZpZyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY29uZmlnTWFuYWdlci5nZXRDb25mT2JqKCkpKTsKICAgIGRlbGV0ZSBjb25maWcucmVjb21tZW5kTGlzdDsKICAgIGlmIChBcnJheS5pc0FycmF5KGNvbmZpZy5ob3RrZXlzKSkgewogICAgICAvKiDnu5lob3RrZXlz55qE5ZCE6Ieq6aG55re75YqgZGlzYWJsZWTpgInpobnvvIzku6Xkvr/lnKjnlYzpnaLkvqflj6/ku6Xlv6vpgJ/npoHnlKjmiJblkK/nlKjmn5DkuKrpobkgKi8KICAgICAgY29uZmlnLmhvdGtleXMuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICBpZiAoaXRlbS5kaXNhYmxlZCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBpdGVtLmRpc2FibGVkID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgICBwYWdlV2luZG93Lmpzb25FZGl0b3Iuc2V0KGNvbmZpZyk7CgogICAgLy8gcGFnZVdpbmRvdy5qc29uRWRpdG9yLmNvbGxhcHNlQWxsKCkKICAgIHBhZ2VXaW5kb3cuanNvbkVkaXRvci5leHBhbmRBbGwgJiYgcGFnZVdpbmRvdy5qc29uRWRpdG9yLmV4cGFuZEFsbCgpOwoKICAgIHBhZ2VXaW5kb3cuc2F2ZUg1UGxheWVyQ29uZmlnID0gZnVuY3Rpb24gKGVkaXRvcikgewogICAgICB0cnkgewogICAgICAgIGNvbnN0IGRlZkNvbmZpZyA9IGNvbmZpZ01hbmFnZXIuZ2V0Q29uZk9iaigpOwogICAgICAgIGNvbnN0IG5ld0NvbmZpZyA9IGVkaXRvci5nZXQoKTsKICAgICAgICBuZXdDb25maWcucmVjb21tZW5kTGlzdCA9IGRlZkNvbmZpZy5yZWNvbW1lbmRMaXN0IHx8IFtdOwogICAgICAgIGNvbmZpZ01hbmFnZXIuc2V0R2xvYmFsU3RvcmFnZUJ5T2JqKG5ld0NvbmZpZyk7CiAgICAgICAgYWxlcnQoJ+mFjee9ruW3suabtOaWsCcpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgYWxlcnQoYOmFjee9ruagvOW8j+W8guW4uO+8jOS/neWtmOWksei0pe+8miR7ZX1gKTsKICAgICAgfQogICAgfTsKICB9CgogIGxldCBjaGVja0NvdW50ID0gMDsKICBmdW5jdGlvbiBjaGVja0pTT05FZGl0b3IgKHBhZ2VXaW5kb3cpIHsKICAgIGlmICghcGFnZVdpbmRvdy5KU09ORWRpdG9yKSB7CiAgICAgIGlmIChjaGVja0NvdW50IDwgMzApIHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIGNoZWNrQ291bnQrKzsKICAgICAgICAgIGNoZWNrSlNPTkVkaXRvcihwYWdlV2luZG93KTsKICAgICAgICB9LCAyMDApOwogICAgICB9CgogICAgICByZXR1cm4KICAgIH0KCiAgICBpbml0KHBhZ2VXaW5kb3cpOwogIH0KCiAgY29uc3QgcGFnZVdpbmRvdyA9IGF3YWl0IGdldFBhZ2VXaW5kb3coKTsKCiAgaWYgKCFwYWdlV2luZG93KSB7CiAgICByZXR1cm4KICB9CgogIGNoZWNrSlNPTkVkaXRvcihwYWdlV2luZG93KTsKfQppbml0VWlDb25maWdNYW5hZ2VyKCk7CgovKioKICog5Lu75Yqh6YWN572u5Lit5b+DIFRhc2sgQ29udHJvbCBDZW50ZXIKICog55So5LqO6YWN572u5omA5pyJ5peg5rOV6L+b6KGM6YCa55So5aSE55CG55qE5Lu75Yqh77yM5aaC5LiN5ZCM572R56uZ55qE5YWo5bGP5pa55byP5LiN5LiA5qC377yM5b+F6aG76LCD55So572R56uZ5pys6Lqr55qE5YWo5bGP6YC76L6R77yM5omN6IO956Gu5L+d5a2X5bmV44CB5by55bmV562J5q2j5bi45bel5L2cCiAqKi8KCmxldCBUQ0MkMSA9IGNsYXNzIFRDQyB7CiAgY29uc3RydWN0b3IgKHRhc2tDb25mLCBkb1Rhc2tGdW5jKSB7CiAgICB0aGlzLmNvbmYgPSB0YXNrQ29uZiB8fCB7CiAgICAgIC8qKgogICAgICAgKiDphY3nva7npLrkvosKICAgICAgICog54i257qn6ZSu5ZCN5a+55bqU55qE5piv5LiA57qn5Z+f5ZCN77yMCiAgICAgICAqIOWtkOe6p+mUruWQjeWvueW6lOeahOebuOWFs+WKn+iDveWQjeensO+8jOmUruWAvOWvueW6lOeahOivpeWKn+iDveimgeinpuWPkeeahOeCueWHu+mAieaLqeWZqOaIluiAheimgeiwg+eUqOeahOebuOWFs+WHveaVsAogICAgICAgKiDmiYDmnInlrZDnuqfnmoTplK7lgLzpg73mlK/mjIHkvb/nlKjpgInmi6nlmajop6blj5HmiJblh73mlbDosIPnlKgKICAgICAgICog6YWN572u5LqG5a2Q57qn55qE5YiZ5L2/55So5a2Q57qn6YWN572u6YC76L6R6L+b6KGM5pON5L2c77yM5ZCm5YiZ5L2/55So6buY6K6k6YC76L6RCiAgICAgICAqIOazqOaEj++8mmluY2x1ZGXvvIxleGNsdWRl6L+Z5Lik5Liq5a2Q57qn6ZSu5ZCN6Zmk5aSW77yM6L+Z5Lik5Liq5piv55So5p2l6L+b6KGMdXJs6IyD5Zu05Yy56YWN55qECiAgICAgICAqICovCiAgICAgICdkZW1vLmRlbW8nOiB7CiAgICAgICAgZnVsbFNjcmVlbjogJy5mdWxsc2NyZWVuLWJ0bicsCiAgICAgICAgZXhpdEZ1bGxTY3JlZW46ICcuZXhpdC1mdWxsc2NyZWVuLWJ0bicsCiAgICAgICAgd2ViRnVsbFNjcmVlbjogZnVuY3Rpb24gKCkge30sCiAgICAgICAgZXhpdFdlYkZ1bGxTY3JlZW46ICcuZXhpdC1mdWxsc2NyZWVuLWJ0bicsCiAgICAgICAgYXV0b1BsYXk6ICcucGxheWVyLXN0YXJ0LWJ0bicsCiAgICAgICAgcGF1c2U6ICcucGxheWVyLXBhdXNlJywKICAgICAgICBwbGF5OiAnLnBsYXllci1wbGF5JywKICAgICAgICBzd2l0Y2hQbGF5U3RhdHVzOiAnLnBsYXllci1wbGF5JywKICAgICAgICBwbGF5YmFja1JhdGU6IGZ1bmN0aW9uICgpIHt9LAogICAgICAgIGN1cnJlbnRUaW1lOiBmdW5jdGlvbiAoKSB7fSwKICAgICAgICBhZGRDdXJyZW50VGltZTogJy5hZGQtY3VycmVudHRpbWUnLAogICAgICAgIHN1YnRyYWN0Q3VycmVudFRpbWU6ICcuc3VidHJhY3QtY3VycmVudHRpbWUnLAogICAgICAgIC8vIOiHquWumuS5ieW/q+aNt+mUrueahOaJp+ihjOaWueW8j++8jOWmguaenOaYr+e7hOWQiOmUru+8jOW/hemhu+aYryBjdHJsLS0+c2hpZnQtLT5hbHQg6L+Z5qC355qE6aG65bqP77yM5rKh5pyJ5Y+v5Lul5b+955Wl77yM6ZSu5ZCN5b+F6aG75YWo5bCP5YaZCiAgICAgICAgc2hvcnRjdXRzOiB7CiAgICAgICAgICAvKiDms6jlhozopoHmiafooYzoh6rlrprkuYnlm57osIPmk43kvZznmoTlv6vmjbfplK4gKi8KICAgICAgICAgIHJlZ2lzdGVyOiBbCiAgICAgICAgICAgICdjdHJsK3NoaWZ0K2FsdCtjJywKICAgICAgICAgICAgJ2N0cmwrc2hpZnQrYycsCiAgICAgICAgICAgICdjdHJsK2FsdCtjJywKICAgICAgICAgICAgJ2N0cmwrYycsCiAgICAgICAgICAgICdjJwogICAgICAgICAgXSwKICAgICAgICAgIC8qIOiHquWumuS5ieW/q+aNt+mUrueahOWbnuiwg+aTjeS9nCAqLwogICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIChoNVBsYXllciwgdGFza0NvbmYsIGRhdGEpIHsKICAgICAgICAgICAgY29uc3QgeyBldmVudCwgcGxheWVyIH0gPSBkYXRhOwogICAgICAgICAgICBjb25zb2xlLmxvZyhldmVudCwgcGxheWVyKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIC8qIOW9k+WJjeWfn+WQjeS4i+mcgOWMheWQq+eahOi3r+W+hOS/oeaBr++8jOm7mOiupOaVtOS4quWfn+WQjeS4i+aJgOaciei3r+W+hOWPr+eUqCDlv4XpobvmmK/mraPliJkgKi8KICAgICAgICBpbmNsdWRlOiAvXi4qLywKICAgICAgICAvKiDlvZPliY3ln5/lkI3kuIvpnIDmjpLpmaTnmoTot6/lvoTkv6Hmga/vvIzpu5jorqTkuI3mjpLpmaTku7vkvZXot6/lvoQg5b+F6aG75piv5q2j5YiZICovCiAgICAgICAgZXhjbHVkZTogL1x0LwogICAgICB9CiAgICB9OwoKICAgIC8vIOmAmui/h2RvVGFza0Z1bmPlm57osIPlrprkuYnphY3nva7or6XlpoLkvZXmiafooYzku7vliqEKICAgIHRoaXMuZG9UYXNrRnVuYyA9IGRvVGFza0Z1bmMgaW5zdGFuY2VvZiBGdW5jdGlvbiA/IGRvVGFza0Z1bmMgOiBmdW5jdGlvbiAoKSB7fTsKICB9CgogIHNldFRhc2tDb25mICh0YXNrQ29uZikgeyB0aGlzLmNvbmYgPSB0YXNrQ29uZjsgfQoKICAvKioKICAgKiDojrflj5bln5/lkI0gLCDnm67liY3lrp7njrDmlrnlvI/kuI3lpb3vvIzpnIDmlLnpgKDvvIzlr7nlnLDljLrmgKfln5/lkI3vvIjlpoJjb20uY27vvInjgIHkuInnuqflj4rku6XkuIrln5/lkI3mlK/mjIHkuI3lpb0KICAgKiAqLwogIGdldERvbWFpbiAoKSB7CiAgICBjb25zdCBob3N0ID0gd2luZG93LmxvY2F0aW9uLmhvc3Q7CiAgICBsZXQgZG9tYWluID0gaG9zdDsKICAgIGNvbnN0IHRtcEFyciA9IGhvc3Quc3BsaXQoJy4nKTsKICAgIGlmICh0bXBBcnIubGVuZ3RoID4gMikgewogICAgICB0bXBBcnIuc2hpZnQoKTsKICAgICAgZG9tYWluID0gdG1wQXJyLmpvaW4oJy4nKTsKICAgIH0KICAgIHJldHVybiBkb21haW4KICB9CgogIC8qKgogICAqIOagvOW8j+WMlumFjee9ruS7u+WKoQogICAqIEBwYXJhbSBpc0FsbCB7IGJvb2xlYW4gfSAt5Y+v6YCJIOm7mOiupOWPquagvOW8j+W9k+WJjeWfn+WQjeaIlmhvc3TkuIvnmoTphY3nva7ku7vliqHvvIzkvKDlhaV0cnVl5YiZ5bCG5omA5pyJ5Z+f5ZCN5LiL55qE5Lu75Yqh6YWN572u6YO96L+b6KGM5qC85byP5YyWCiAgICovCiAgZm9ybWF0VENDIChpc0FsbCkgewogICAgY29uc3QgdCA9IHRoaXM7CiAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXModC5jb25mKTsKICAgIGNvbnN0IGRvbWFpbiA9IHQuZ2V0RG9tYWluKCk7CiAgICBjb25zdCBob3N0ID0gd2luZG93LmxvY2F0aW9uLmhvc3Q7CgogICAgZnVuY3Rpb24gZm9ybWF0dGVyIChpdGVtKSB7CiAgICAgIGNvbnN0IGRlZk9iaiA9IHsKICAgICAgICBpbmNsdWRlOiAvXi4qLywKICAgICAgICBleGNsdWRlOiAvXHQvCiAgICAgIH07CiAgICAgIGl0ZW0uaW5jbHVkZSA9IGl0ZW0uaW5jbHVkZSB8fCBkZWZPYmouaW5jbHVkZTsKICAgICAgaXRlbS5leGNsdWRlID0gaXRlbS5leGNsdWRlIHx8IGRlZk9iai5leGNsdWRlOwogICAgICByZXR1cm4gaXRlbQogICAgfQoKICAgIGNvbnN0IHJlc3VsdCA9IHt9OwogICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgbGV0IGl0ZW0gPSB0W2tleV07CiAgICAgIGlmIChpc09iaiQxKGl0ZW0pKSB7CiAgICAgICAgaWYgKGlzQWxsKSB7CiAgICAgICAgICBpdGVtID0gZm9ybWF0dGVyKGl0ZW0pOwogICAgICAgICAgcmVzdWx0W2tleV0gPSBpdGVtOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAoa2V5ID09PSBob3N0IHx8IGtleSA9PT0gZG9tYWluKSB7CiAgICAgICAgICAgIGl0ZW0gPSBmb3JtYXR0ZXIoaXRlbSk7CiAgICAgICAgICAgIHJlc3VsdFtrZXldID0gaXRlbTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogICAgcmV0dXJuIHJlc3VsdAogIH0KCiAgLyog5Yik5pat5omA5o+Q5L6b55qE6YWN572u5Lu75Yqh5piv5ZCm6YCC55So5LqO5b2T5YmNVVJMICovCiAgaXNNYXRjaCAodGFza0NvbmYpIHsKICAgIGNvbnN0IHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmOwogICAgbGV0IGlzTWF0Y2ggPSBmYWxzZTsKICAgIGlmICghdGFza0NvbmYuaW5jbHVkZSAmJiAhdGFza0NvbmYuZXhjbHVkZSkgewogICAgICBpc01hdGNoID0gdHJ1ZTsKICAgIH0gZWxzZSB7CiAgICAgIGlmICh0YXNrQ29uZi5pbmNsdWRlICYmIHRhc2tDb25mLmluY2x1ZGUudGVzdCh1cmwpKSB7CiAgICAgICAgaXNNYXRjaCA9IHRydWU7CiAgICAgIH0KICAgICAgaWYgKHRhc2tDb25mLmV4Y2x1ZGUgJiYgdGFza0NvbmYuZXhjbHVkZS50ZXN0KHVybCkpIHsKICAgICAgICBpc01hdGNoID0gZmFsc2U7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBpc01hdGNoCiAgfQoKICAvKioKICAgKiDojrflj5bku7vliqHphY3nva7vvIzlj6rog73ojrflj5bliLDlvZPliY3ln5/lkI3kuIvnmoTku7vliqHphY3nva7kv6Hmga8KICAgKiBAcGFyYW0gdGFza05hbWUge3N0cmluZ30gLeWPr+mAiSDmjIflrprlhbfkvZPku7vliqHvvIzpu5jorqTov5Tlm57miYDmnInnsbvlnovnmoTku7vliqHphY3nva4KICAgKi8KICBnZXRUYXNrQ29uZmlnICgpIHsKICAgIGNvbnN0IHQgPSB0aGlzOwogICAgaWYgKCF0Ll9oYXNGb3JtYXRUQ0NfKSB7CiAgICAgIHQuZm9ybWF0VENDKCk7CiAgICAgIHQuX2hhc0Zvcm1hdFRDQ18gPSB0cnVlOwogICAgfQogICAgY29uc3QgZG9tYWluID0gdC5nZXREb21haW4oKTsKICAgIGNvbnN0IHRhc2tDb25mID0gdC5jb25mW3dpbmRvdy5sb2NhdGlvbi5ob3N0XSB8fCB0LmNvbmZbZG9tYWluXTsKCiAgICBpZiAodGFza0NvbmYgJiYgdC5pc01hdGNoKHRhc2tDb25mKSkgewogICAgICByZXR1cm4gdGFza0NvbmYKICAgIH0KCiAgICByZXR1cm4ge30KICB9CgogIC8qKgogICAqIOaJp+ihjOW9k+WJjemhtemdouS4i+eahOebuOW6lOS7u+WKoQogICAqIEBwYXJhbSB0YXNrTmFtZSB7b2JqZWN0fHN0cmluZ30gLeW/hemAie+8jOWPr+ebtOaOpeS8oOWFpeS7u+WKoemFjee9ruWvueixoe+8jOS5n+WPr+eUqOaYr+S7u+WKoeWQjeensOeahOWtl+espuS4suS/oeaBr++8jOiHquW3seWOu+afpeaJvuaYr+WQpuacieS7u+WKoemcgOimgeaJp+ihjAogICAqIEBwYXJhbSBkYXRhIHtvYmplY3R9IC3lj6/pgInvvIzkvKDnu5nlm57osIPlh73mlbDnmoTmlbDmja4KICAgKi8KICBkb1Rhc2sgKHRhc2tOYW1lLCBkYXRhKSB7CiAgICBjb25zdCB0ID0gdGhpczsKICAgIGxldCBpc0RvID0gZmFsc2U7CiAgICBpZiAoIXRhc2tOYW1lKSByZXR1cm4gaXNEbwogICAgY29uc3QgdGFza0NvbmYgPSBpc09iaiQxKHRhc2tOYW1lKSA/IHRhc2tOYW1lIDogdC5nZXRUYXNrQ29uZmlnKCk7CgogICAgaWYgKCFpc09iaiQxKHRhc2tDb25mKSB8fCAhdGFza0NvbmZbdGFza05hbWVdKSByZXR1cm4gaXNEbwoKICAgIGNvbnN0IHRhc2sgPSB0YXNrQ29uZlt0YXNrTmFtZV07CgogICAgaWYgKHRhc2spIHsKICAgICAgaXNEbyA9IHQuZG9UYXNrRnVuYyh0YXNrTmFtZSwgdGFza0NvbmYsIGRhdGEpOwogICAgfQoKICAgIHJldHVybiBpc0RvCiAgfQp9OwoKY2xhc3MgRGVidWcgewogIGNvbnN0cnVjdG9yIChjb25maWcgPSB7fSkgewogICAgdGhpcy5jb25maWcgPSB7CiAgICAgIG1zZzogJ1tEZWJ1ZyBNc2ddJywKICAgICAgLyog5pi+56S66LCD55So5qCI5L+h5oGvICovCiAgICAgIHRyYWNlOiBmYWxzZSwKICAgICAgLyog5piv5ZCm5oqK6LCD55So5qCI5L+h5oGv5ZKM6KaB5omT5Y2w55qE5L+h5oGv5pS+5Zyo5LiA57uE5oqY5Y+g6LW35p2l77yM55u05o6l6L6T5Ye655qE6K+d5YaN5aSn6YeP6L6D5aSa5L+h5oGv55qE5pe25YCZ5Lya5pi+5b6X6Z2e5bi45YeM5Lmx77yM5omA5Lul6buY6K6kdHJ1ZSAqLwogICAgICB0cmFjZUdyb3VwOiB0cnVlLAogICAgICBwcmludFRpbWU6IGZhbHNlLAoKICAgICAgLyog57uf5LiA6K6+572u5a2X5L2T6aKc6Imy77yM6IOM5pmv6aKc6Imy77yM5YW25a6D5qC35byP562JICovCiAgICAgIGNvbG9yOiAnIzAwMDAwMCcsCiAgICAgIGJhY2tncm91bmRDb2xvcjogJ3RyYW5zcGFyZW50JywKICAgICAgc3R5bGU6ICcnLAoKICAgICAgLi4uY29uZmlnLAoKICAgICAgLyog5Li65LiN5ZCM55qE6LCD6K+V5pa55rOV6K6+572u5LiN5ZCM55qE5a2X5L2T6aKc6Imy77yM6IOM5pmv6aKc6Imy77yM5YW25a6D5qC35byP562JICovCiAgICAgIGNvbG9yTWFwOiB7CiAgICAgICAgaW5mbzogJyMyMjc0QTUnLAogICAgICAgIGxvZzogJyM5NUI0NkEnLAogICAgICAgIHdhcm46ICcjRjVBNjIzJywKICAgICAgICBlcnJvcjogJyNEMzNGNDknLAogICAgICAgIC4uLmNvbmZpZy5jb2xvck1hcCB8fCB7fQogICAgICB9LAogICAgICBiYWNrZ3JvdW5kQ29sb3JNYXA6IHsKICAgICAgICBpbmZvOiAnJywKICAgICAgICBsb2c6ICcnLAogICAgICAgIHdhcm46ICcnLAogICAgICAgIGVycm9yOiAnJywKICAgICAgICAuLi5jb25maWcuYmFja2dyb3VuZENvbG9yTWFwIHx8IHt9CiAgICAgIH0sCiAgICAgIHN0eWxlTWFwOiB7CiAgICAgICAgaW5mbzogJycsCiAgICAgICAgbG9nOiAnJywKICAgICAgICB3YXJuOiAnJywKICAgICAgICBlcnJvcjogJycsCiAgICAgICAgLi4uY29uZmlnLnN0eWxlTWFwIHx8IHt9CiAgICAgIH0KICAgIH07CgogICAgY29uc3QgZGVidWdNZXRob2RMaXN0ID0gWydsb2cnLCAnZXJyb3InLCAnaW5mbycsICd3YXJuJ107CiAgICBkZWJ1Z01ldGhvZExpc3QuZm9yRWFjaCgobmFtZSkgPT4gewogICAgICB0aGlzW25hbWVdID0gdGhpcy5jcmVhdGVEZWJ1Z01ldGhvZChuYW1lKTsKICAgIH0pOwogIH0KCiAgY3JlYXRlIChtc2cpIHsKICAgIHJldHVybiBuZXcgRGVidWcobXNnKQogIH0KCiAgY3JlYXRlRGVidWdNZXRob2QgKG5hbWUpIHsKICAgIG5hbWUgPSBuYW1lIHx8ICdpbmZvJzsKCiAgICBjb25zdCB7IG1zZywgY29sb3IsIGNvbG9yTWFwLCBiYWNrZ3JvdW5kQ29sb3IsIGJhY2tncm91bmRDb2xvck1hcCwgc3R5bGUsIHN0eWxlTWFwLCBwcmludFRpbWUsIHRyYWNlLCB0cmFjZUdyb3VwIH0gPSB0aGlzLmNvbmZpZzsKICAgIGNvbnN0IHRleHRDb2xvciA9IGNvbG9yTWFwW25hbWVdIHx8IGNvbG9yOwogICAgY29uc3QgYmdDb2xvciA9IGJhY2tncm91bmRDb2xvck1hcFtuYW1lXSB8fCBiYWNrZ3JvdW5kQ29sb3I7CiAgICBjb25zdCBjdXN0b21TdHlsZSA9IHN0eWxlTWFwW25hbWVdIHx8IHN0eWxlOwoKICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICghd2luZG93Ll9kZWJ1Z01vZGVfKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KCiAgICAgIGNvbnN0IGFyZyA9IEFycmF5LmZyb20oYXJndW1lbnRzKTsKICAgICAgY29uc3QgYXJnMCA9IGFyZ1swXTsKICAgICAgYXJnLnVuc2hpZnQoYGNvbG9yOiAke3RleHRDb2xvcn07IGJhY2tncm91bmQtY29sb3I6ICR7YmdDb2xvcn07ICR7Y3VzdG9tU3R5bGV9YCk7CgogICAgICBsZXQgdGltZVN0ciA9ICcnOwoKICAgICAgaWYgKHByaW50VGltZSkgewogICAgICAgIGNvbnN0IGN1clRpbWUgPSBuZXcgRGF0ZSgpOwogICAgICAgIGNvbnN0IEggPSBjdXJUaW1lLmdldEhvdXJzKCk7CiAgICAgICAgY29uc3QgTSA9IGN1clRpbWUuZ2V0TWludXRlcygpOwogICAgICAgIGNvbnN0IFMgPSBjdXJUaW1lLmdldFNlY29uZHMoKTsKICAgICAgICB0aW1lU3RyID0gYFske0h9OiR7TX06JHtTfV0gYDsKICAgICAgfQoKICAgICAgYXJnLnVuc2hpZnQoYCVjICR7dGltZVN0cn0ke21zZ30gYCk7CgogICAgICBpZiAodHJhY2UpIHsKICAgICAgICBpZiAodHJhY2VHcm91cCkgewogICAgICAgICAgY29uc3QgYXJnMVN0ciA9IHR5cGVvZiBhcmcwID09PSAnc3RyaW5nJyA/IGFyZzAgOiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYXJnMCk7CiAgICAgICAgICBjb25zb2xlLmdyb3VwQ29sbGFwc2VkKGAlYyAke3RpbWVTdHJ9JHttc2d9ICR7YXJnMVN0cn1gLCBgY29sb3I6ICR7dGV4dENvbG9yfTsgYmFja2dyb3VuZC1jb2xvcjogJHtiZ0NvbG9yfTsgJHtjdXN0b21TdHlsZX1gKTsKICAgICAgICAgIHdpbmRvdy5jb25zb2xlW25hbWVdLmFwcGx5KGNvbnNvbGUsIGFyZyk7CiAgICAgICAgICBjb25zb2xlLnRyYWNlKCk7CiAgICAgICAgICBjb25zb2xlLmdyb3VwRW5kKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHdpbmRvdy5jb25zb2xlW25hbWVdLmFwcGx5KGNvbnNvbGUsIGFyZyk7CiAgICAgICAgICBjb25zb2xlLnRyYWNlKCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHdpbmRvdy5jb25zb2xlW25hbWVdLmFwcGx5KHdpbmRvdy5jb25zb2xlLCBhcmcpOwogICAgICB9CiAgICB9CiAgfQoKICBpc0RlYnVnTW9kZSAoKSB7CiAgICByZXR1cm4gQm9vbGVhbih3aW5kb3cuX2RlYnVnTW9kZV8pCiAgfQp9CgovLyBmdW5jdGlvbiBkZW1vICgpIHsKLy8gICB3aW5kb3cuX2RlYnVnTW9kZV8gPSB0cnVlCi8vICAgd2luZG93LmRlYnVnID0gbmV3IERlYnVnKHsKLy8gICAgIG1zZzogJ1tEZWJ1ZyBNZXNzYWdlXScsCi8vICAgICBjb2xvck1hcDogewovLyAgICAgICBpbmZvOiAnI0ZGRkZGRicsCi8vICAgICAgIGxvZzogJyNGRkZGRkYnCi8vICAgICB9LAovLyAgICAgYmFja2dyb3VuZENvbG9yTWFwOiB7Ci8vICAgICAgIGluZm86ICcjMjI3NEE1JywKLy8gICAgICAgbG9nOiAnIzk1QjQ2QScKLy8gICAgIH0sCi8vICAgICBzdHlsZTogJ2ZvbnQtc2l6ZTogMjJweDsgZm9udC13ZWlnaHQ6IGJvbGQ7IHBhZGRpbmc6IDJweCA0cHg7IGJvcmRlci1yYWRpdXM6IDJweDsnLAovLyAgICAgdHJhY2U6IHRydWUsCi8vICAgICB0cmFjZUdyb3VwOiB0cnVlLAovLyAgICAgcHJpbnRUaW1lOiB0cnVlCi8vICAgfSkKCi8vICAgd2luZG93LmRlYnVnLmxvZygnZGVidWcgbW9kZSBpcyBvbicsIHdpbmRvdy5kZWJ1ZykKLy8gICB3aW5kb3cuZGVidWcuaW5mbygnZGVidWcgbW9kZSBpcyBvbicsIHdpbmRvdy5kZWJ1ZykKLy8gICB3aW5kb3cuZGVidWcud2FybignZGVidWcgbW9kZSBpcyBvbicsIHdpbmRvdy5kZWJ1ZykKLy8gICB3aW5kb3cuZGVidWcuZXJyb3IoJ2RlYnVnIG1vZGUgaXMgb24nLCB3aW5kb3cuZGVidWcpCi8vIH0KLy8gZGVtbygpCgp2YXIgRGVidWckMSA9IG5ldyBEZWJ1ZygpOwoKdmFyIGRlYnVnID0gRGVidWckMS5jcmVhdGUoewogIG1zZzogJ1tINXBsYXllciBNc2ddJywKICB0cmFjZTogZmFsc2UsCiAgdHJhY2VHcm91cDogdHJ1ZSwKICBwcmludFRpbWU6IGZhbHNlCn0pOwoKY29uc3QgJHEgPSBmdW5jdGlvbiAoc3RyKSB7IHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHN0cikgfTsKCi8qKgogKiDku7vliqHphY3nva7kuK3lv4MgVGFzayBDb250cm9sIENlbnRlcgogKiDnlKjkuo7phY3nva7miYDmnInml6Dms5Xov5vooYzpgJrnlKjlpITnkIbnmoTku7vliqHvvIzlpoLkuI3lkIznvZHnq5nnmoTlhajlsY/mlrnlvI/kuI3kuIDmoLfvvIzlv4XpobvosIPnlKjnvZHnq5nmnKzouqvnmoTlhajlsY/pgLvovpHvvIzmiY3og73noa7kv53lrZfluZXjgIHlvLnluZXnrYnmraPluLjlt6XkvZwKICogKi8KCmNvbnN0IHRhc2tDb25mID0gewogIC8qKgogICAqIOmFjee9ruekuuS+iwogICAqIOeItue6p+mUruWQjeWvueW6lOeahOaYr+S4gOe6p+Wfn+WQje+8jAogICAqIOWtkOe6p+mUruWQjeWvueW6lOeahOebuOWFs+WKn+iDveWQjeensO+8jOmUruWAvOWvueW6lOeahOivpeWKn+iDveimgeinpuWPkeeahOeCueWHu+mAieaLqeWZqOaIluiAheimgeiwg+eUqOeahOebuOWFs+WHveaVsAogICAqIOaJgOacieWtkOe6p+eahOmUruWAvOmDveaUr+aMgeS9v+eUqOmAieaLqeWZqOinpuWPkeaIluWHveaVsOiwg+eUqAogICAqIOmFjee9ruS6huWtkOe6p+eahOWImeS9v+eUqOWtkOe6p+mFjee9rumAu+i+kei/m+ihjOaTjeS9nO+8jOWQpuWImeS9v+eUqOm7mOiupOmAu+i+kQogICAqIOazqOaEj++8mmluY2x1ZGXvvIxleGNsdWRl6L+Z5Lik5Liq5a2Q57qn6ZSu5ZCN6Zmk5aSW77yM6L+Z5Lik5Liq5piv55So5p2l6L+b6KGMdXJs6IyD5Zu05Yy56YWN55qECiAgICogKi8KICAnZGVtby5kZW1vJzogewogICAgLy8gZGlzYWJsZTogdHJ1ZSwgLy8g5Zyo6K+l5Z+f5ZCN5LiL56aB5q2i5o+S5Lu255qE5omA5pyJ5Yqf6IO9CiAgICBpbml0OiBmdW5jdGlvbiAoaDVQbGF5ZXIsIHRhc2tDb25mKSB7fSwKICAgIGZ1bGxTY3JlZW46ICcuZnVsbHNjcmVlbi1idG4nLAogICAgZXhpdEZ1bGxTY3JlZW46ICcuZXhpdC1mdWxsc2NyZWVuLWJ0bicsCiAgICB3ZWJGdWxsU2NyZWVuOiBmdW5jdGlvbiAoKSB7fSwKICAgIGV4aXRXZWJGdWxsU2NyZWVuOiAnLmV4aXQtZnVsbHNjcmVlbi1idG4nLAogICAgYXV0b1BsYXk6ICcucGxheWVyLXN0YXJ0LWJ0bicsCiAgICAvLyBwYXVzZTogWycucGxheWVyLXBhdXNlJywgJy5wbGF5ZXItcGF1c2UwMiddLCAvL+WkmuenjeaDheWGteWvueW6lOS4jeWQjOeahOmAieaLqeWZqOaXtu+8jOWPr+S9v+eUqOaVsOe7hO+8jOaPkuS7tuS8muWvuemAieaLqeWZqOi/m+ihjOmBjeWOhu+8jOefpemBk+aJvuWIsOWPr+eUqOeahOS4uuatogogICAgcGF1c2U6ICcucGxheWVyLXBhdXNlJywKICAgIHBsYXk6ICcucGxheWVyLXBsYXknLAogICAgYWZ0ZXJQbGF5OiBmdW5jdGlvbiAoaDVQbGF5ZXIsIHRhc2tDb25mKSB7fSwKICAgIGFmdGVyUGF1c2U6IGZ1bmN0aW9uIChoNVBsYXllciwgdGFza0NvbmYpIHt9LAogICAgc3dpdGNoUGxheVN0YXR1czogJy5wbGF5ZXItcGxheScsCiAgICBwbGF5YmFja1JhdGU6IGZ1bmN0aW9uICgpIHt9LAogICAgLy8gcGxheWJhY2tSYXRlOiB0cnVlLCAvLyDlvZPnu5nmn5DkuKrlip/og73orr7nva50cnVl5pe277yM6KGo56S65L2/55So572R56uZ6Ieq6Lqr55qE6IO95Yqb5o6n5Yi26KeG6aKR77yM6ICM5b+955Wl5o+S5Lu255qE6IO95YqbCiAgICBjdXJyZW50VGltZTogZnVuY3Rpb24gKCkge30sCiAgICBhZGRDdXJyZW50VGltZTogJy5hZGQtY3VycmVudHRpbWUnLAogICAgc3VidHJhY3RDdXJyZW50VGltZTogJy5zdWJ0cmFjdC1jdXJyZW50dGltZScsCiAgICAvLyDoh6rlrprkuYnlv6vmjbfplK7nmoTmiafooYzmlrnlvI/vvIzlpoLmnpzmmK/nu4TlkIjplK7vvIzlv4XpobvmmK8gY3RybC0tPnNoaWZ0LS0+YWx0IOi/meagt+eahOmhuuW6j++8jOayoeacieWPr+S7peW/veeVpe+8jOmUruWQjeW/hemhu+WFqOWwj+WGmQogICAgc2hvcnRjdXRzOiB7CiAgICAgIC8qIOazqOWGjOimgeaJp+ihjOiHquWumuS5ieWbnuiwg+aTjeS9nOeahOW/q+aNt+mUriAqLwogICAgICByZWdpc3RlcjogWwogICAgICAgICdjdHJsK3NoaWZ0K2FsdCtjJywKICAgICAgICAnY3RybCtzaGlmdCtjJywKICAgICAgICAnY3RybCthbHQrYycsCiAgICAgICAgJ2N0cmwrYycsCiAgICAgICAgJ2MnCiAgICAgIF0sCiAgICAgIC8qIOiHquWumuS5ieW/q+aNt+mUrueahOWbnuiwg+aTjeS9nCAqLwogICAgICBjYWxsYmFjazogZnVuY3Rpb24gKGg1UGxheWVyLCB0YXNrQ29uZiwgZGF0YSkgewogICAgICAgIGNvbnN0IHsgZXZlbnQsIHBsYXllciB9ID0gZGF0YTsKICAgICAgICBjb25zb2xlLmxvZyhldmVudCwgcGxheWVyKTsKICAgICAgfQogICAgfSwKCiAgICAvKiDpmLvmraLnvZHnq5noh6rouqvnmoTosIPpgJ/ooYzkuLrvvIzlop7lvLrnqoHnoLTosIPpgJ/pmZDliLbnmoTog73lipsgKi8KICAgIGJsb2NrU2V0UGxheWJhY2tSYXRlOiB0cnVlLAogICAgLyog6Zi75q2i572R56uZ6Ieq6Lqr55qE5pKt5pS+6L+b5bqm5o6n5Yi26YC76L6R77yM5aKe5by656qB56C06L+b5bqm6LCD5o6n6ZmQ5Yi255qE6IO95YqbICovCiAgICBibG9ja1NldEN1cnJlbnRUaW1lOiB0cnVlLAogICAgLyog6Zi75q2i572R56uZ6Ieq6Lqr55qE6Z+z6YeP5o6n5Yi26YC76L6R77yM5o6S6Zmk572R56uZ6Ieq6Lqr55qE6LCD6Z+z5bmy5omwICovCiAgICBibG9ja1NldFZvbHVtZTogdHJ1ZSwKCiAgICAvKiDlvZPliY3ln5/lkI3kuIvpnIDljIXlkKvnmoTot6/lvoTkv6Hmga/vvIzpu5jorqTmlbTkuKrln5/lkI3kuIvmiYDmnInot6/lvoTlj6/nlKgg5b+F6aG75piv5q2j5YiZICovCiAgICBpbmNsdWRlOiAvXi4qLywKICAgIC8qIOW9k+WJjeWfn+WQjeS4i+mcgOaOkumZpOeahOi3r+W+hOS/oeaBr++8jOm7mOiupOS4jeaOkumZpOS7u+S9lei3r+W+hCDlv4XpobvmmK/mraPliJkgKi8KICAgIGV4Y2x1ZGU6IC9cdC8KICB9LAogICd5b3V0dWJlLmNvbSc6IHsKICAgIGluaXQ6IGZ1bmN0aW9uIChoNVBsYXllciwgdGFza0NvbmYpIHsKICAgICAgaWYgKGg1UGxheWVyLmhhc0JpbmRTa2lwQWRFdmVudHMpIHsgcmV0dXJuIH0KICAgICAgY29uc3Qgc3RhcnRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7CiAgICAgIGxldCBza2lwQ291bnQgPSAwOwoKICAgICAgY29uc3Qgc2tpcEhhbmRsZXIgPSAoZWxlbWVudCkgPT4gewogICAgICAgIGNvbnN0IGVuZFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsKICAgICAgICBjb25zdCB0aW1lID0gZW5kVGltZSAtIHN0YXJ0VGltZTsKICAgICAgICAvKiDov4fml6nop6blj5HkvJrlr7zoh7Tlub/lkYrml6Dms5Xot7Pov4cgKi8KICAgICAgICBpZiAodGltZSA8IDMwMDApIHsKICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgIH0KCiAgICAgICAgLyog6aG16Z2i5aSE5LqO5LiN5Y+v6KeB54q25oCB5pe25YCZ5Lmf5LiN6Kem5Y+RICovCiAgICAgICAgaWYgKGRvY3VtZW50LmhpZGRlbikgewogICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgfQoKICAgICAgICBlbGVtZW50LmNsaWNrKCk7CiAgICAgICAgc2tpcENvdW50Kys7CgogICAgICAgIGRlYnVnLmxvZygneW91dHViZS5jb20gYWQgc2tpcCBjb3VudCcsIHNraXBDb3VudCk7CiAgICAgIH07CgogICAgICByZWFkeSgnLnl0cC1hZC1za2lwLWJ1dHRvbicsIGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgc2tpcEhhbmRsZXIoZWxlbWVudCk7CiAgICAgIH0pOwoKICAgICAgcmVhZHkoJy55dHAtYWQtc2tpcC1idXR0b24tbW9kZXJuJywgZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBza2lwSGFuZGxlcihlbGVtZW50KTsKICAgICAgfSk7CgogICAgICBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgY29uc3QgYWRTa2lwQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnl0cC1hZC1za2lwLWJ1dHRvbicpOwogICAgICAgIGNvbnN0IGFkU2tpcEJ0bk1vZGVybiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy55dHAtYWQtc2tpcC1idXR0b24tbW9kZXJuJyk7CiAgICAgICAgYWRTa2lwQnRuICYmIHNraXBIYW5kbGVyKGFkU2tpcEJ0bik7CiAgICAgICAgYWRTa2lwQnRuTW9kZXJuICYmIHNraXBIYW5kbGVyKGFkU2tpcEJ0bk1vZGVybik7CiAgICAgIH0sIDEwMDApOwoKICAgICAgaDVQbGF5ZXIuaGFzQmluZFNraXBBZEV2ZW50cyA9IHRydWU7CiAgICB9LAogICAgd2ViRnVsbFNjcmVlbjogJ2J1dHRvbi55dHAtc2l6ZS1idXR0b24nLAogICAgZnVsbFNjcmVlbjogJ2J1dHRvbi55dHAtZnVsbHNjcmVlbi1idXR0b24nLAogICAgbmV4dDogJy55dHAtbmV4dC1idXR0b24nLAogICAgYWZ0ZXJQbGF5OiBmdW5jdGlvbiAoaDVQbGF5ZXIsIHRhc2tDb25mKSB7CiAgICAgIC8qIOino+WGs+Wtl+W5leaYvuekuuWBnOa7numXrumimCAqLwogICAgICBzZXRUaW1lb3V0KCgpID0+IHsgaDVQbGF5ZXIuc2V0Q3VycmVudFRpbWVVcCgwLjAxLCB0cnVlKTsgfSwgMCk7CgogICAgICAvKiDop6PlhrPlv6vmjbfplK7mmoLlgZzjgIHmkq3mlL7lkI7kuIDnm7TmnIlsb2FkaW5n5Zu+5qCH5rue55WZ55qE6Zeu6aKYICovCiAgICAgIGNvbnN0IHBsYXllciA9IGg1UGxheWVyLnBsYXllcigpOwogICAgICBjb25zdCBwbGF5ZXJ3V3JhcCA9IHBsYXllci5jbG9zZXN0KCcuaHRtbDUtdmlkZW8tcGxheWVyJyk7CgogICAgICBpZiAoIXBsYXllcndXcmFwKSB7CiAgICAgICAgcmV0dXJuCiAgICAgIH0KCiAgICAgIHBsYXllcndXcmFwLmNsYXNzTGlzdC5hZGQoJ3l0cC1hdXRvaGlkZScsICdwbGF5aW5nLW1vZGUnKTsKICAgICAgY2xlYXJUaW1lb3V0KHBsYXllcndXcmFwLmF1dG9oaWRlVGltZXIpOwogICAgICBwbGF5ZXJ3V3JhcC5hdXRvaGlkZVRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgcGxheWVyd1dyYXAuY2xhc3NMaXN0LmFkZCgneXRwLWF1dG9oaWRlJywgJ3BsYXlpbmctbW9kZScpOwogICAgICB9LCAxMDAwKTsKCiAgICAgIGlmICghcGxheWVyd1dyYXAuaGFzQmluZEN1c3RvbUV2ZW50cykgewogICAgICAgIGNvbnN0IG1vdXNlbW92ZUhhbmRlciA9IChldmVudCkgPT4gewogICAgICAgICAgcGxheWVyd1dyYXAuY2xhc3NMaXN0LnJlbW92ZSgneXRwLWF1dG9oaWRlJywgJ3l0cC1oaWRlLWluZm8tYmFyJyk7CgogICAgICAgICAgY2xlYXJUaW1lb3V0KHBsYXllcndXcmFwLm1vdXNlbW92ZVRpbWVyKTsKICAgICAgICAgIHBsYXllcndXcmFwLm1vdXNlbW92ZVRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgIGlmICghcGxheWVyLnBhdXNlZCkgewogICAgICAgICAgICAgIHBsYXllcndXcmFwLmNsYXNzTGlzdC5hZGQoJ3l0cC1hdXRvaGlkZScsICd5dHAtaGlkZS1pbmZvLWJhcicpOwogICAgICAgICAgICB9CiAgICAgICAgICB9LCAxMDAwICogMik7CiAgICAgICAgfTsKCiAgICAgICAgY29uc3QgY2xpY2tIYW5kZXIgPSAoZXZlbnQpID0+IHsKICAgICAgICAgIGg1UGxheWVyLnN3aXRjaFBsYXlTdGF0dXMoKTsKICAgICAgICAgIG1vdXNlbW92ZUhhbmRlcigpOwogICAgICAgIH07CgogICAgICAgIHBsYXllci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBtb3VzZW1vdmVIYW5kZXIpOwogICAgICAgIHBsYXllci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsaWNrSGFuZGVyKTsKCiAgICAgICAgcGxheWVyd1dyYXAuaGFzQmluZEN1c3RvbUV2ZW50cyA9IHRydWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IHNwaW5uZXIgPSBwbGF5ZXJ3V3JhcC5xdWVyeVNlbGVjdG9yKCcueXRwLXNwaW5uZXInKTsKCiAgICAgIGlmIChzcGlubmVyKSB7CiAgICAgICAgY29uc3QgaGlkZGVuU3Bpbm5lciA9ICgpID0+IHsgc3Bpbm5lciAmJiAoc3Bpbm5lci5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbicpOyB9OwogICAgICAgIGNvbnN0IHZpc2libGVTcGlubmVyID0gKCkgPT4geyBzcGlubmVyICYmIChzcGlubmVyLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZScpOyB9OwoKICAgICAgICAvKiDngrnlh7vmkq3mlL7ml7bnq4vljbPpmpDol49zcGlubmVyICovCiAgICAgICAgaGlkZGVuU3Bpbm5lcigpOwoKICAgICAgICBjbGVhclRpbWVvdXQocGxheWVyd1dyYXAuc3Bpbm5lclRpbWVyKTsKICAgICAgICBwbGF5ZXJ3V3JhcC5zcGlubmVyVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIC8qIDHnp5LlkI7lsIZzcGlubmVy6K6+572u5Li6bm9uZe+8jOW5tuS4lOaBouWkjVNwaW5uZXLnmoTlj6/op4HnirbmgIHvvIzku6Xkvr/lhbblroPpgLvovpHku43og73mraPnoa7mjqfliLZzcGlubmVy55qE5pi+6ZqQ54q25oCBICovCiAgICAgICAgICBzcGlubmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICB2aXNpYmxlU3Bpbm5lcigpOwogICAgICAgIH0sIDEwMDApOwogICAgICB9CiAgICB9LAogICAgYWZ0ZXJQYXVzZTogZnVuY3Rpb24gKGg1UGxheWVyLCB0YXNrQ29uZikgewogICAgICBjb25zdCBwbGF5ZXIgPSBoNVBsYXllci5wbGF5ZXIoKTsKICAgICAgY29uc3QgcGxheWVyd1dyYXAgPSBwbGF5ZXIuY2xvc2VzdCgnLmh0bWw1LXZpZGVvLXBsYXllcicpOwoKICAgICAgaWYgKCFwbGF5ZXJ3V3JhcCkgcmV0dXJuCgogICAgICBwbGF5ZXJ3V3JhcC5jbGFzc0xpc3QucmVtb3ZlKCd5dHAtYXV0b2hpZGUnLCAncGxheWluZy1tb2RlJyk7CiAgICAgIHBsYXllcndXcmFwLmNsYXNzTGlzdC5hZGQoJ3BhdXNlZC1tb2RlJyk7CiAgICAgIGNsZWFyVGltZW91dChwbGF5ZXJ3V3JhcC5hdXRvaGlkZVRpbWVyKTsKICAgIH0sCiAgICBzaG9ydGN1dHM6IHsKICAgICAgcmVnaXN0ZXI6IFsKICAgICAgICAnZXNjYXBlJwogICAgICBdLAogICAgICBjYWxsYmFjazogZnVuY3Rpb24gKGg1UGxheWVyLCB0YXNrQ29uZiwgZGF0YSkgewogICAgICAgIGNvbnN0IHsgZXZlbnQgfSA9IGRhdGE7CiAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDI3KSB7CiAgICAgICAgICAvKiDlj5bmtojmkq3mlL7kuIvkuIDkuKrmjqjojZDnmoTop4bpopEgKi8KICAgICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcueXRwLXVwbmV4dCcpLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJykgewogICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcueXRwLXVwbmV4dC1jYW5jZWwtYnV0dG9uJykuY2xpY2soKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LAogICduZXRmbGl4LmNvbSc6IHsKICAgIC8vIOWBnOatouWcqG5ldGZsaXjkuIvkvb/nlKjmj5Lku7bnmoTmiYDmnInlip/og70KICAgIC8vIGRpc2FibGU6IHRydWUsCiAgICBmdWxsU2NyZWVuOiAnYnV0dG9uLmJ1dHRvbi1uZnBsYXllckZ1bGxzY3JlZW4nLAogICAgYWRkQ3VycmVudFRpbWU6ICdidXR0b24uYnV0dG9uLW5mcGxheWVyRmFzdEZvcndhcmQnLAogICAgc3VidHJhY3RDdXJyZW50VGltZTogJ2J1dHRvbi5idXR0b24tbmZwbGF5ZXJCYWNrVGVuJywKICAgIC8qKgogICAgICog5L2/55SobmV0ZmxpeOiHqui6q+eahOiwg+mAn++8jOWboOS4uuebruWJjeaPkuS7tuayoeazleino+WGs+iwg+mAn+WvvOiHtOeahOacjeWKoeS4reaWremXrumimAogICAgICogaHR0cHM6Ly9naXRodWIuY29tL3h4eGlseS9oNXBsYXllci9pc3N1ZXMvMjM0CiAgICAgKiBodHRwczovL2dpdGh1Yi5jb20veHh4aWx5L2g1cGxheWVyL2lzc3Vlcy8zMTcKICAgICAqIGh0dHBzOi8vZ2l0aHViLmNvbS94eHhpbHkvaDVwbGF5ZXIvaXNzdWVzLzM4MQogICAgICogaHR0cHM6Ly9naXRodWIuY29tL3h4eGlseS9oNXBsYXllci9pc3N1ZXMvMTc5CiAgICAgKiBodHRwczovL2dpdGh1Yi5jb20veHh4aWx5L2g1cGxheWVyL2lzc3Vlcy8xNDcKICAgICAqLwogICAgcGxheWJhY2tSYXRlOiB0cnVlLAogICAgc2hvcnRjdXRzOiB7CiAgICAgIC8qKgogICAgICAgKiBUT0RPCiAgICAgICAqIG5ldGZsaXgg5LiA5Lqb55So5oi35Lmg5oOv5L2/55SoRumUrui/m+ihjOWFqOWxj++8jOaJgOS7peatpOWkhOWxj+iUveaOiWbplK7nmoTkuIvkuIDluKflip/og70KICAgICAgICog5ZCO57ut5byA5pS+6Ieq5a6a5LmJ6YWN572u6IO95Yqb5ZCO77yM6K6p55So5oi36Ieq6KGM5Yaz5a6a5piv5ZCm5bGP6JS9CiAgICAgICAqLwogICAgICByZWdpc3RlcjogWwogICAgICAgICdmJwogICAgICBdLAogICAgICBjYWxsYmFjazogZnVuY3Rpb24gKGg1UGxheWVyLCB0YXNrQ29uZiwgZGF0YSkgewogICAgICAgIHJldHVybiB0cnVlCiAgICAgIH0KICAgIH0KICB9LAogICdiaWxpYmlsaS5jb20nOiB7CiAgICBmdWxsU2NyZWVuOiBmdW5jdGlvbiAoKSB7CiAgICAgIGNvbnN0IGZ1bGxTY3JlZW4gPSAkcSgnLmJweC1wbGF5ZXItY3RybC1mdWxsJykgfHwgJHEoJy5zcXVpcnRsZS12aWRlby1mdWxsc2NyZWVuJykgfHwgJHEoJy5iaWxpYmlsaS1wbGF5ZXItdmlkZW8tYnRuLWZ1bGxzY3JlZW4nKTsKICAgICAgaWYgKGZ1bGxTY3JlZW4pIHsKICAgICAgICBmdWxsU2NyZWVuLmNsaWNrKCk7CiAgICAgICAgcmV0dXJuIHRydWUKICAgICAgfQogICAgfSwKICAgIHdlYkZ1bGxTY3JlZW46IGZ1bmN0aW9uICgpIHsKICAgICAgY29uc3Qgb2xkV2ViRnVsbHNjcmVlbiA9ICRxKCcuYmlsaWJpbGktcGxheWVyLXZpZGVvLXdlYi1mdWxsc2NyZWVuJyk7CiAgICAgIGNvbnN0IHdlYkZ1bGxzY3JlZW5FbnRlciA9ICRxKCcuYnB4LXBsYXllci1jdHJsLXdlYi1lbnRlcicpIHx8ICRxKCcuc3F1aXJ0bGUtcGFnZWZ1bGxzY3JlZW4taW5hY3RpdmUnKTsKICAgICAgY29uc3Qgd2ViRnVsbHNjcmVlbkxlYXZlID0gJHEoJy5icHgtcGxheWVyLWN0cmwtd2ViLWxlYXZlJykgfHwgJHEoJy5zcXVpcnRsZS1wYWdlZnVsbHNjcmVlbi1hY3RpdmUnKTsKICAgICAgaWYgKG9sZFdlYkZ1bGxzY3JlZW4gfHwgKHdlYkZ1bGxzY3JlZW5FbnRlciAmJiB3ZWJGdWxsc2NyZWVuTGVhdmUpKSB7CiAgICAgICAgY29uc3Qgd2ViRnVsbHNjcmVlbiA9IG9sZFdlYkZ1bGxzY3JlZW4gfHwgKGdldENvbXB1dGVkU3R5bGUod2ViRnVsbHNjcmVlbkxlYXZlKS5kaXNwbGF5ID09PSAnbm9uZScgPyB3ZWJGdWxsc2NyZWVuRW50ZXIgOiB3ZWJGdWxsc2NyZWVuTGVhdmUpOwogICAgICAgIHdlYkZ1bGxzY3JlZW4uY2xpY2soKTsKCiAgICAgICAgLyog5Y+W5raI5by55bmV5qGG6IGa54Sm77yM5bmy5omw5LqG5b+r5o236ZSu55qE5pON5L2cICovCiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBjb25zdCBkYW5tYWt1ID0gJHEoJy5icHgtcGxheWVyLWRtLWlucHV0JykgfHwgJHEoJy5iaWxpYmlsaS1wbGF5ZXItdmlkZW8tZGFubWFrdS1pbnB1dCcpOwogICAgICAgICAgZGFubWFrdSAmJiBkYW5tYWt1LmJsdXIoKTsKICAgICAgICB9LCAxMDAwICogMC4xKTsKCiAgICAgICAgcmV0dXJuIHRydWUKICAgICAgfQogICAgfSwKICAgIGF1dG9QbGF5OiBbJy5icHgtcGxheWVyLWN0cmwtcGxheScsICcuc3F1aXJ0bGUtdmlkZW8tc3RhcnQnLCAnLmJpbGliaWxpLXBsYXllci12aWRlby1idG4tc3RhcnQnXSwKICAgIHN3aXRjaFBsYXlTdGF0dXM6IFsnLmJweC1wbGF5ZXItY3RybC1wbGF5JywgJy5zcXVpcnRsZS12aWRlby1zdGFydCcsICcuYmlsaWJpbGktcGxheWVyLXZpZGVvLWJ0bi1zdGFydCddLAogICAgbmV4dDogWycuYnB4LXBsYXllci1jdHJsLW5leHQnLCAnLnNxdWlydGxlLXZpZGVvLW5leHQnLCAnLmJpbGliaWxpLXBsYXllci12aWRlby1idG4tbmV4dCcsICcuYnB4LXBsYXllci1jdHJsLWJ0blthcmlhLWxhYmVsPSLkuIvkuIDkuKoiXSddLAogICAgaW5pdDogZnVuY3Rpb24gKGg1UGxheWVyLCB0YXNrQ29uZikge30sCiAgICBzaG9ydGN1dHM6IHsKICAgICAgcmVnaXN0ZXI6IFsKICAgICAgICAnZXNjYXBlJwogICAgICBdLAogICAgICBjYWxsYmFjazogZnVuY3Rpb24gKGg1UGxheWVyLCB0YXNrQ29uZiwgZGF0YSkgewogICAgICAgIGNvbnN0IHsgZXZlbnQgfSA9IGRhdGE7CiAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDI3KSB7CiAgICAgICAgICAvKiDpgIDlh7rnvZHpobXlhajlsY8gKi8KICAgICAgICAgIGNvbnN0IG9sZFdlYkZ1bGxzY3JlZW4gPSAkcSgnLmJpbGliaWxpLXBsYXllci12aWRlby13ZWItZnVsbHNjcmVlbicpOwogICAgICAgICAgaWYgKG9sZFdlYkZ1bGxzY3JlZW4gJiYgb2xkV2ViRnVsbHNjcmVlbi5jbGFzc0xpc3QuY29udGFpbnMoJ2Nsb3NlZCcpKSB7CiAgICAgICAgICAgIG9sZFdlYkZ1bGxzY3JlZW4uY2xpY2soKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IHdlYkZ1bGxzY3JlZW5MZWF2ZSA9ICRxKCcuYnB4LXBsYXllci1jdHJsLXdlYi1sZWF2ZScpIHx8ICRxKCcuc3F1aXJ0bGUtcGFnZWZ1bGxzY3JlZW4tYWN0aXZlJyk7CiAgICAgICAgICAgIGlmIChnZXRDb21wdXRlZFN0eWxlKHdlYkZ1bGxzY3JlZW5MZWF2ZSkuZGlzcGxheSAhPT0gJ25vbmUnKSB7CiAgICAgICAgICAgICAgd2ViRnVsbHNjcmVlbkxlYXZlLmNsaWNrKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LAogICd0LmJpbGliaWxpLmNvbSc6IHsKICAgIGZ1bGxTY3JlZW46ICdidXR0b25bbmFtZT0iZnVsbHNjcmVlbi1idXR0b24iXScKICB9LAogICdsaXZlLmJpbGliaWxpLmNvbSc6IHsKICAgIGluaXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCFKU09OLl9zdHJpbmdpZnlTb3VyY2VfKSB7CiAgICAgICAgSlNPTi5fc3RyaW5naWZ5U291cmNlXyA9IEpTT04uc3RyaW5naWZ5OwoKICAgICAgICBKU09OLnN0cmluZ2lmeSA9IGZ1bmN0aW9uIChhcmcxKSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICByZXR1cm4gSlNPTi5fc3RyaW5naWZ5U291cmNlXy5hcHBseSh0aGlzLCBhcmd1bWVudHMpCiAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0pTT04uc3RyaW5naWZ5IOino+mHiuWHuumUme+8micsIGUsIGFyZzEpOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0KICAgIH0sCiAgICBmdWxsU2NyZWVuOiAnLmJpbGliaWxpLWxpdmUtcGxheWVyLXZpZGVvLWNvbnRyb2xsZXItZnVsbHNjcmVlbi1idG4gYnV0dG9uJywKICAgIHdlYkZ1bGxTY3JlZW46ICcuYmlsaWJpbGktbGl2ZS1wbGF5ZXItdmlkZW8tY29udHJvbGxlci13ZWItZnVsbHNjcmVlbi1idG4gYnV0dG9uJywKICAgIHN3aXRjaFBsYXlTdGF0dXM6ICcuYmlsaWJpbGktbGl2ZS1wbGF5ZXItdmlkZW8tY29udHJvbGxlci1zdGFydC1idG4gYnV0dG9uJwogIH0sCiAgJ2FjZnVuLmNuJzogewogICAgZnVsbFNjcmVlbjogJ1tkYXRhLWJpbmQta2V5PSJzY3JlZW5UaXAiXScsCiAgICB3ZWJGdWxsU2NyZWVuOiAnW2RhdGEtYmluZC1rZXk9IndlYlRpcCJdJywKICAgIHN3aXRjaFBsYXlTdGF0dXM6IGZ1bmN0aW9uIChoNXBsYXllcikgewogICAgICAvKiDml6Dms5XmiqLlvpfmjqfliLbmnYPvvIzlj6rlpb3lu7bov5/liKTmlq3opoHkuI3opoHlubLpooQgKi8KICAgICAgY29uc3QgcGxheWVyID0gaDVwbGF5ZXIucGxheWVyKCk7CiAgICAgIGNvbnN0IHN0YXR1cyA9IHBsYXllci5wYXVzZWQ7CiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIGlmIChzdGF0dXMgPT09IHBsYXllci5wYXVzZWQpIHsKICAgICAgICAgIGlmIChwbGF5ZXIucGF1c2VkKSB7CiAgICAgICAgICAgIHBsYXllci5wbGF5KCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwbGF5ZXIucGF1c2UoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIDIwMCk7CiAgICB9CiAgfSwKICAnaXhpZ3VhLmNvbSc6IHsKICAgIGZ1bGxTY3JlZW46IFsneGctZnVsbHNjcmVlbi54Z3BsYXllci1mdWxsc2NyZWVuJywgJy54Z3BsYXllci1jb250cm9sLWl0ZW1fX2VudHJ5W2FyaWEtbGFiZWw9IuWFqOWxjyJdJywgJy54Z3BsYXllci1jb250cm9sLWl0ZW1fX2VudHJ5W2FyaWEtbGFiZWw9IumAgOWHuuWFqOWxjyJdJ10sCiAgICB3ZWJGdWxsU2NyZWVuOiBbJ3hnLWNzc2Z1bGxzY3JlZW4ueGdwbGF5ZXItY3NzZnVsbHNjcmVlbicsICcueGdwbGF5ZXItY29udHJvbC1pdGVtX19lbnRyeVthcmlhLWxhYmVsPSLliaflnLrmqKHlvI8iXScsICcueGdwbGF5ZXItY29udHJvbC1pdGVtX19lbnRyeVthcmlhLWxhYmVsPSLpgIDlh7rliaflnLrmqKHlvI8iXSddCiAgfSwKICAndHYuc29odS5jb20nOiB7CiAgICBmdWxsU2NyZWVuOiAnYnV0dG9uW2RhdGEtdGl0bGU9Iue9kemhteWFqOWxjyJdJywKICAgIHdlYkZ1bGxTY3JlZW46ICdidXR0b25bZGF0YS10aXRsZT0i5YWo5bGPIl0nCiAgfSwKICAnaXFpeWkuY29tJzogewogICAgZnVsbFNjcmVlbjogJy5pcXAtYnRuLWZ1bGxzY3JlZW4nLAogICAgd2ViRnVsbFNjcmVlbjogJy5pcXAtYnRuLXdlYnNjcmVlbicsCiAgICBuZXh0OiAnLmlxcC1idG4tbmV4dCcsCiAgICBpbml0OiBmdW5jdGlvbiAoaDVQbGF5ZXIsIHRhc2tDb25mKSB7CiAgICAgIC8vIOmakOiXj+awtOWNsAogICAgICBoaWRlRG9tKCcuaXFwLWxvZ28tYm94Jyk7CiAgICAgIC8vIOenu+mZpOaaguWBnOW5v+WRigogICAgICB3aW5kb3cuR01fYWRkU3R5bGUoYAogICAgICAgICAgZGl2W3RlbXBsYXRldHlwZT0iY29tbW9uX3BhdXNlIl17IGRpc3BsYXk6bm9uZSB9CiAgICAgICAgICAuaXFwLWxvZ28tYm94eyBkaXNwbGF5Om5vbmUgIWltcG9ydGFudCB9CiAgICAgIGApOwogICAgfQogIH0sCiAgJ3lvdWt1LmNvbSc6IHsKICAgIGZ1bGxTY3JlZW46ICcuY29udHJvbC1mdWxsc2NyZWVuLWljb24nLAogICAgbmV4dDogJy5jb250cm9sLW5leHQtdmlkZW8nLAogICAgaW5pdDogZnVuY3Rpb24gKGg1UGxheWVyLCB0YXNrQ29uZikgewogICAgICAvLyDpmpDol4/msLTljbAKICAgICAgaGlkZURvbSgnLnlvdWt1LWxheWVyLWxvZ28nKTsKICAgIH0KICB9LAogICd0ZWQuY29tJzogewogICAgZnVsbFNjcmVlbjogJ2J1dHRvbi5GdWxsc2NyZWVuJwogIH0sCiAgJ3FxLmNvbSc6IHsKICAgIHBhdXNlOiAnLmNvbnRhaW5lcl9pbm5lciAudHhwLXNoYWRvdy1tb2QnLAogICAgcGxheTogJy5jb250YWluZXJfaW5uZXIgLnR4cC1zaGFkb3ctbW9kJywKICAgIHNob3J0Y3V0czogewogICAgICByZWdpc3RlcjogWydjJywgJ3gnLCAneicsICcxJywgJzInLCAnMycsICc0J10sCiAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiAoaDVQbGF5ZXIsIHRhc2tDb25mLCBkYXRhKSB7CiAgICAgICAgY29uc3QgeyBldmVudCB9ID0gZGF0YTsKICAgICAgICBjb25zdCBrZXkgPSBldmVudC5rZXkudG9Mb3dlckNhc2UoKTsKICAgICAgICBjb25zdCBrZXlOYW1lID0gJ2N1c3RvbVNob3J0Y3V0c18nICsga2V5OwoKICAgICAgICBpZiAoIWg1UGxheWVyW2tleU5hbWVdKSB7CiAgICAgICAgICAvKiDnrKzkuIDmrKHmjInkuIvlv6vmjbfplK7kvb/nlKjpu5jorqTpgLvovpHov5vooYzosIPpgJ8gKi8KICAgICAgICAgIGg1UGxheWVyW2tleU5hbWVdID0gewogICAgICAgICAgICB0aW1lOiBEYXRlLm5vdygpLAogICAgICAgICAgICBwbGF5YmFja1JhdGU6IGg1UGxheWVyLnBsYXliYWNrUmF0ZQogICAgICAgICAgfTsKICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvKiDnrKzkuIDmrKHmk43kvZzlkI7nmoQyMDBtc+WGheeahOaTjeS9nOmDveaYr+eUsem7mOiupOmAu+i+kei/m+ihjOiwg+mAnyAqLwogICAgICAgICAgaWYgKERhdGUubm93KCkgLSBoNVBsYXllcltrZXlOYW1lXS50aW1lIDwgMjAwKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgICAgfQoKICAgICAgICAgIC8qIOWIpOaWreaYr+WQpumcgOi/m+ihjOmZjee6p+WkhOeQhu+8jOWIqeeUqHNlc3Npb25TdG9yYWdl6L+b6KGM6LCD6YCfICovCiAgICAgICAgICBpZiAoaDVQbGF5ZXJba2V5TmFtZV0gPT09IGg1UGxheWVyLnBsYXliYWNrUmF0ZSB8fCBoNVBsYXllcltrZXlOYW1lXSA9PT0gdHJ1ZSkgewogICAgICAgICAgICBpZiAod2luZG93LnNlc3Npb25TdG9yYWdlLnBsYXliYWNrUmF0ZSAmJiAvKGN8eHx6fDF8MnwzfDQpLy50ZXN0KGtleSkpIHsKICAgICAgICAgICAgICBjb25zdCBjdXJTcGVlZCA9IE51bWJlcih3aW5kb3cuc2Vzc2lvblN0b3JhZ2UucGxheWJhY2tSYXRlKTsKICAgICAgICAgICAgICBjb25zdCBwZXJTcGVlZCA9IGN1clNwZWVkIC0gMC4xID49IDAgPyBjdXJTcGVlZCAtIDAuMSA6IDAuMTsKICAgICAgICAgICAgICBjb25zdCBuZXh0U3BlZWQgPSBjdXJTcGVlZCArIDAuMSA8PSA0ID8gY3VyU3BlZWQgKyAwLjEgOiA0OwogICAgICAgICAgICAgIGxldCB0YXJnZXRTcGVlZCA9IGN1clNwZWVkOwogICAgICAgICAgICAgIHN3aXRjaCAoa2V5KSB7CiAgICAgICAgICAgICAgICBjYXNlICd6JyA6CiAgICAgICAgICAgICAgICAgIHRhcmdldFNwZWVkID0gMTsKICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIGNhc2UgJ2MnIDoKICAgICAgICAgICAgICAgICAgdGFyZ2V0U3BlZWQgPSBuZXh0U3BlZWQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBjYXNlICd4JyA6CiAgICAgICAgICAgICAgICAgIHRhcmdldFNwZWVkID0gcGVyU3BlZWQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBkZWZhdWx0IDoKICAgICAgICAgICAgICAgICAgdGFyZ2V0U3BlZWQgPSBOdW1iZXIoa2V5KTsKICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5wbGF5YmFja1JhdGUgPSB0YXJnZXRTcGVlZDsKICAgICAgICAgICAgICBoNVBsYXllci5zZXRDdXJyZW50VGltZVVwKDAuMDEsIHRydWUpOwogICAgICAgICAgICAgIGg1UGxheWVyLnNldFBsYXliYWNrUmF0ZSh0YXJnZXRTcGVlZCwgdHJ1ZSk7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWUKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLyog5qCH6K+G6buY6K6k6LCD6YCf5pa55qGI5aSx5pWI77yM6ZyA5ZCv55Soc2Vzc2lvblN0b3JhZ2XosIPpgJ/mlrnmoYggKi8KICAgICAgICAgICAgaDVQbGF5ZXJba2V5TmFtZV0gPSB0cnVlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLyog5qCH6K+G6buY6K6k6LCD6YCf5pa55qGI55Sf5pWIICovCiAgICAgICAgICAgIGg1UGxheWVyW2tleU5hbWVdID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgZnVsbFNjcmVlbjogJ3R4cGRpdltkYXRhLXJlcG9ydD0id2luZG93LWZ1bGxzY3JlZW4iXScsCiAgICB3ZWJGdWxsU2NyZWVuOiAndHhwZGl2W2RhdGEtcmVwb3J0PSJicm93c2VyLWZ1bGxzY3JlZW4iXScsCiAgICBuZXh0OiAndHhwZGl2W2RhdGEtcmVwb3J0PSJwbGF5LW5leHQiXScsCiAgICBpbml0OiBmdW5jdGlvbiAoaDVQbGF5ZXIsIHRhc2tDb25mKSB7CiAgICAgIC8vIOmakOiXj+awtOWNsAogICAgICBoaWRlRG9tKCcudHhwLXdhdGVybWFyaycpOwogICAgICBoaWRlRG9tKCcudHhwLXdhdGVybWFyay1hY3Rpb24nKTsKICAgIH0sCiAgICBpbmNsdWRlOiAvKHYucXF8c3BvcnRzLnFxKS8KICB9LAogICdwYW4uYmFpZHUuY29tJzogewogICAgZnVsbFNjcmVlbjogZnVuY3Rpb24gKGg1UGxheWVyLCB0YXNrQ29uZikgewogICAgICBoNVBsYXllci5wbGF5ZXIoKS5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy52anMtZnVsbHNjcmVlbi1jb250cm9sJykuY2xpY2soKTsKICAgIH0KICB9LAogIC8vICdwb3JuaHViLmNvbSc6IHsKICAvLyAgIGZ1bGxTY3JlZW46ICdkaXZbY2xhc3MqPSJpY29uLWZ1bGxzY3JlZW4iXScsCiAgLy8gICB3ZWJGdWxsU2NyZWVuOiAnZGl2W2NsYXNzKj0iaWNvbi1zaXplLWxhcmdlIl0nCiAgLy8gfSwKICAnZmFjZWJvb2suY29tJzogewogICAgZnVsbFNjcmVlbjogZnVuY3Rpb24gKGg1UGxheWVyLCB0YXNrQ29uZikgewogICAgICBjb25zdCBhY3Rpb25CdG4gPSBoNVBsYXllci5wbGF5ZXIoKS5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3JBbGwoJ2J1dHRvbicpOwogICAgICBpZiAoYWN0aW9uQnRuICYmIGFjdGlvbkJ0bi5sZW5ndGggPiAzKSB7CiAgICAgICAgLyog5qih5ouf54K55Ye75YCS5pWw56ys5LqM5Liq5oyJ6ZKuICovCiAgICAgICAgYWN0aW9uQnRuW2FjdGlvbkJ0bi5sZW5ndGggLSAyXS5jbGljaygpOwogICAgICAgIHJldHVybiB0cnVlCiAgICAgIH0KICAgIH0sCiAgICB3ZWJGdWxsU2NyZWVuOiBmdW5jdGlvbiAoaDVQbGF5ZXIsIHRhc2tDb25mKSB7CiAgICAgIGNvbnN0IGFjdGlvbkJ0biA9IGg1UGxheWVyLnBsYXllcigpLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uJyk7CiAgICAgIGlmIChhY3Rpb25CdG4gJiYgYWN0aW9uQnRuLmxlbmd0aCA+IDMpIHsKICAgICAgICAvKiDmqKHmi5/ngrnlh7vlgJLmlbDnrKzkuozkuKrmjInpkq4gKi8KICAgICAgICBhY3Rpb25CdG5bYWN0aW9uQnRuLmxlbmd0aCAtIDJdLmNsaWNrKCk7CiAgICAgICAgcmV0dXJuIHRydWUKICAgICAgfQogICAgfSwKICAgIHNob3J0Y3V0czogewogICAgICAvKiDlnKjop4bpopHmqKHlvI/kuIvmjIllc2PplK7vvIzoh6rliqjov5Tlm57kuIrkuIDlsYLnlYzpnaIgKi8KICAgICAgcmVnaXN0ZXI6IFsKICAgICAgICAnZXNjYXBlJwogICAgICBdLAogICAgICAvKiDoh6rlrprkuYnlv6vmjbfplK7nmoTlm57osIPmk43kvZwgKi8KICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIChoNVBsYXllciwgdGFza0NvbmYsIGRhdGEpIHsKICAgICAgICBlYWNoUGFyZW50Tm9kZShoNVBsYXllci5wbGF5ZXIoKSwgZnVuY3Rpb24gKHBhcmVudE5vZGUpIHsKICAgICAgICAgIGlmIChwYXJlbnROb2RlLmdldEF0dHJpYnV0ZSgnZGF0YS1mdWxsc2NyZWVuLWNvbnRhaW5lcicpID09PSAndHJ1ZScpIHsKICAgICAgICAgICAgY29uc3QgZ29CYWNrQnRuID0gcGFyZW50Tm9kZS5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJ2Rpdj5hPmk+dScpOwogICAgICAgICAgICBpZiAoZ29CYWNrQnRuKSB7CiAgICAgICAgICAgICAgZ29CYWNrQnRuLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGljaygpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LAogICdkb3V5dS5jb20nOiB7CiAgICBmdWxsU2NyZWVuOiBmdW5jdGlvbiAoaDVQbGF5ZXIsIHRhc2tDb25mKSB7CiAgICAgIGNvbnN0IHBsYXllciA9IGg1UGxheWVyLnBsYXllcigpOwogICAgICBjb25zdCBjb250YWluZXIgPSBwbGF5ZXIuX2Z1bGxTY3JlZW5fLmdldENvbnRhaW5lcigpOwogICAgICBpZiAocGxheWVyLl9pc0Z1bGxTY3JlZW5fKSB7CiAgICAgICAgY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ2Rpdlt0aXRsZT0i6YCA5Ye656qX5Y+j5YWo5bGPIl0nKS5jbGljaygpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdkaXZbdGl0bGU9Iueql+WPo+WFqOWxjyJdJykuY2xpY2soKTsKICAgICAgfQogICAgICBwbGF5ZXIuX2lzRnVsbFNjcmVlbl8gPSAhcGxheWVyLl9pc0Z1bGxTY3JlZW5fOwogICAgICByZXR1cm4gdHJ1ZQogICAgfSwKICAgIHdlYkZ1bGxTY3JlZW46IGZ1bmN0aW9uIChoNVBsYXllciwgdGFza0NvbmYpIHsKICAgICAgY29uc3QgcGxheWVyID0gaDVQbGF5ZXIucGxheWVyKCk7CiAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHBsYXllci5fZnVsbFNjcmVlbl8uZ2V0Q29udGFpbmVyKCk7CiAgICAgIGlmIChwbGF5ZXIuX2lzV2ViRnVsbFNjcmVlbl8pIHsKICAgICAgICBjb250YWluZXIucXVlcnlTZWxlY3RvcignZGl2W3RpdGxlPSLpgIDlh7rnvZHpobXlhajlsY8iXScpLmNsaWNrKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ2Rpdlt0aXRsZT0i572R6aG15YWo5bGPIl0nKS5jbGljaygpOwogICAgICB9CiAgICAgIHBsYXllci5faXNXZWJGdWxsU2NyZWVuXyA9ICFwbGF5ZXIuX2lzV2ViRnVsbFNjcmVlbl87CiAgICAgIHJldHVybiB0cnVlCiAgICB9CiAgfSwKICAnb3Blbi4xNjMuY29tJzogewogICAgaW5pdDogZnVuY3Rpb24gKGg1UGxheWVyLCB0YXNrQ29uZikgewogICAgICBjb25zdCBwbGF5ZXIgPSBoNVBsYXllci5wbGF5ZXIoKTsKICAgICAgLyoqCiAgICAgICAqIOS4jeiuvue9rkNPUlPmoIfor4bvvIzov5nmoLfmiY3og73ot6jln5/miKrlm74KICAgICAgICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSFRNTC9DT1JTX2VuYWJsZWRfaW1hZ2UKICAgICAgICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSFRNTC9DT1JTX3NldHRpbmdzX2F0dHJpYnV0ZXMKICAgICAgICovCiAgICAgIHBsYXllci5zZXRBdHRyaWJ1dGUoJ2Nyb3NzT3JpZ2luJywgJ2Fub255bW91cycpOwogICAgfQogIH0sCiAgJ2FnZWZhbnMudHYnOiB7CiAgICBpbml0OiBmdW5jdGlvbiAoaDVQbGF5ZXIsIHRhc2tDb25mKSB7CiAgICAgIGg1UGxheWVyLnBsYXllcigpLnNldEF0dHJpYnV0ZSgnY3Jvc3NPcmlnaW4nLCAnYW5vbnltb3VzJyk7CiAgICB9CiAgfSwKICAnY2hhb3hpbmcuY29tJzogewogICAgZnVsbFNjcmVlbjogJy52anMtZnVsbHNjcmVlbi1jb250cm9sJwogIH0sCiAgJ3lpeGkudHYnOiB7CiAgICBpbml0OiBmdW5jdGlvbiAoaDVQbGF5ZXIsIHRhc2tDb25mKSB7CiAgICAgIGg1UGxheWVyLnBsYXllcigpLnNldEF0dHJpYnV0ZSgnY3Jvc3NPcmlnaW4nLCAnYW5vbnltb3VzJyk7CiAgICB9CiAgfSwKICAnZG91eWluLmNvbSc6IHsKICAgIGZ1bGxTY3JlZW46ICcueGdwbGF5ZXItZnVsbHNjcmVlbicsCiAgICB3ZWJGdWxsU2NyZWVuOiAnLnhncGxheWVyLXBhZ2UtZnVsbC1zY3JlZW4nLAogICAgbmV4dDogWycueGdwbGF5ZXItcGxheXN3aXRjaC1uZXh0J10sCiAgICBpbml0OiBmdW5jdGlvbiAoaDVQbGF5ZXIsIHRhc2tDb25mKSB7CiAgICAgIGg1UGxheWVyLnBsYXllcigpLnNldEF0dHJpYnV0ZSgnY3Jvc3NPcmlnaW4nLCAnYW5vbnltb3VzJyk7CgogICAgICBjb25zdCBwbGF5ZXIgPSBoNVBsYXllci5wbGF5ZXIoKTsKICAgICAgY29uc3Qgd3JhcEVsID0gcGxheWVyLmNsb3Nlc3QoJ2RpdltkYXRhLWUyZT0iZmVlZC1pdGVtIl0nKTsKCiAgICAgIGNvbnN0IHNldFZpZGVvVGl0bGUgPSAoKSA9PiB7CiAgICAgICAgaWYgKHdyYXBFbCAmJiB3cmFwRWwucXVlcnlTZWxlY3RvcignLnZpZGVvLWluZm8tZGV0YWlsJykpIHsKICAgICAgICAgIGNvbnN0IHZpZGVvSW5mbyA9IHdyYXBFbC5xdWVyeVNlbGVjdG9yKCcudmlkZW8taW5mby1kZXRhaWwnKTsKICAgICAgICAgIGNvbnN0IGFjY291bnROYW1lRUwgPSB2aWRlb0luZm8ucXVlcnlTZWxlY3RvcignLmFjY291bnQtbmFtZScpOwogICAgICAgICAgLyog56e76ZmkYWNjb3VudE5hbWXliY3pnaLnmoRA56ym5Y+3ICovCiAgICAgICAgICBjb25zdCBhY2NvdW50TmFtZSA9IGFjY291bnROYW1lRUwuaW5uZXJUZXh0LnJlcGxhY2UoL15AKi8sICcnKTsKCiAgICAgICAgICBjb25zdCB0aXRsZUVsID0gdmlkZW9JbmZvLnF1ZXJ5U2VsZWN0b3IoJy50aXRsZScpOwogICAgICAgICAgY29uc3QgdGl0bGVUZXh0ID0gdGl0bGVFbC5pbm5lclRleHQudHJpbSgpOwogICAgICAgICAgY29uc3QgdGl0bGUgPSBgJHt0aXRsZVRleHR9IC0gJHthY2NvdW50TmFtZX1gLnJlcGxhY2UoL1tcXC86Kj8iPD58XS9nLCAnLScpOwoKICAgICAgICAgIHdyYXBFbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtdGl0bGUnLCB0aXRsZSk7CiAgICAgICAgICBwbGF5ZXIuc2V0QXR0cmlidXRlKCdkYXRhLXRpdGxlJywgdGl0bGUpOwogICAgICAgICAgZG9jdW1lbnQudGl0bGUgPSB0aXRsZTsKICAgICAgICAgIHdyYXBFbC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCBzZXRWaWRlb1RpdGxlKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICB3cmFwRWwgJiYgd3JhcEVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsIHNldFZpZGVvVGl0bGUpOwogICAgICBzZXRUaW1lb3V0KHNldFZpZGVvVGl0bGUsIDEyMDApOwogICAgfQogIH0sCiAgJ2xpdmUuZG91eWluLmNvbSc6IHsKICAgIGZ1bGxTY3JlZW46ICcueGdwbGF5ZXItZnVsbHNjcmVlbicsCiAgICB3ZWJGdWxsU2NyZWVuOiAnLnhncGxheWVyLXBhZ2UtZnVsbC1zY3JlZW4nLAogICAgbmV4dDogWycueGdwbGF5ZXItcGxheXN3aXRjaC1uZXh0J10sCiAgICBpbml0OiBmdW5jdGlvbiAoaDVQbGF5ZXIsIHRhc2tDb25mKSB7CiAgICAgIGg1UGxheWVyLnBsYXllcigpLnNldEF0dHJpYnV0ZSgnY3Jvc3NPcmlnaW4nLCAnYW5vbnltb3VzJyk7CiAgICB9CiAgfSwKICAnemhpaHUuY29tJzogewogICAgZnVsbFNjcmVlbjogWydidXR0b25bYXJpYS1sYWJlbD0i5YWo5bGPIl0nLCAnYnV0dG9uW2FyaWEtbGFiZWw9IumAgOWHuuWFqOWxjyJdJ10sCiAgICBwbGF5OiBmdW5jdGlvbiAoaDVQbGF5ZXIsIHRhc2tDb25mLCBkYXRhKSB7CiAgICAgIGNvbnN0IHBsYXllciA9IGg1UGxheWVyLnBsYXllcigpOwogICAgICBpZiAocGxheWVyICYmIHBsYXllci5wYXJlbnROb2RlICYmIHBsYXllci5wYXJlbnROb2RlLnBhcmVudE5vZGUpIHsKICAgICAgICBjb25zdCBtYXNrV3JhcCA9IHBsYXllci5wYXJlbnROb2RlLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignZGl2fmRpdjpudGgtY2hpbGQoMyknKTsKICAgICAgICBpZiAobWFza1dyYXApIHsKICAgICAgICAgIGNvbnN0IG1hc2sgPSBtYXNrV3JhcC5xdWVyeVNlbGVjdG9yKCdkaXYnKTsKICAgICAgICAgIGlmIChtYXNrICYmIG1hc2suaW5uZXJUZXh0ID09PSAnJykgewogICAgICAgICAgICBtYXNrLmNsaWNrKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgaW5pdDogZnVuY3Rpb24gKGg1UGxheWVyLCB0YXNrQ29uZikgewogICAgICBoNVBsYXllci5wbGF5ZXIoKS5zZXRBdHRyaWJ1dGUoJ2Nyb3NzT3JpZ2luJywgJ2Fub255bW91cycpOwogICAgfQogIH0sCiAgJ3dlaWJvLmNvbSc6IHsKICAgIGZ1bGxTY3JlZW46IFsnYnV0dG9uLndicHYtZnVsbHNjcmVlbi1jb250cm9sJ10sCiAgICAvLyB3ZWJGdWxsU2NyZWVuOiBbJ2Rpdlt0aXRsZT0i5YWz6Zet5by55bGCIl0nLCAnZGl2LndicHYtb3Blbi1sYXllci1idXR0b24nXQogICAgd2ViRnVsbFNjcmVlbjogWydkaXYud2Jwdi1vcGVuLWxheWVyLWJ1dHRvbiddCiAgfSwKICAndHdpdHRlci5jb20nOiB7CiAgICBpbml0OiBmdW5jdGlvbiAoaDVQbGF5ZXIsIHRhc2tDb25mKSB7CiAgICAgIGNvbnN0IHBsYXllciA9IGg1UGxheWVyLnBsYXllcigpOwogICAgICBjb25zdCB3cmFwRWwgPSBwbGF5ZXIuY2xvc2VzdCgnYXJ0aWNsZVtkYXRhLXRlc3RpZD0idHdlZXQiXScpOwoKICAgICAgY29uc3Qgc2V0VmlkZW9UaXRsZSA9ICgpID0+IHsKICAgICAgICBpZiAod3JhcEVsICYmICF3cmFwRWwuZ2V0QXR0cmlidXRlKCdkYXRhLXRpdGxlJykgJiYgd3JhcEVsLnF1ZXJ5U2VsZWN0b3IoJ2RpdltkYXRhLXRlc3RpZD0idHdlZXRUZXh0Il0nKSkgewogICAgICAgICAgY29uc3QgdGl0bGVFbCA9IHdyYXBFbC5xdWVyeVNlbGVjdG9yKCdkaXZbZGF0YS10ZXN0aWQ9InR3ZWV0VGV4dCJdJyk7CiAgICAgICAgICBjb25zdCB0aXRsZVRleHQgPSB0aXRsZUVsLmlubmVyVGV4dC50cmltKCk7CiAgICAgICAgICBjb25zdCB0aXRsZSA9IGAke3RpdGxlVGV4dH1gLnJlcGxhY2UoL1tcXC86Kj8iPD58XS9nLCAnLScpOwoKICAgICAgICAgIHdyYXBFbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtdGl0bGUnLCB0aXRsZSk7CiAgICAgICAgICBwbGF5ZXIuc2V0QXR0cmlidXRlKCdkYXRhLXRpdGxlJywgdGl0bGUpOwogICAgICAgICAgd3JhcEVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsIHNldFZpZGVvVGl0bGUpOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIHdyYXBFbCAmJiB3cmFwRWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgc2V0VmlkZW9UaXRsZSk7CiAgICAgIHNldFRpbWVvdXQoc2V0VmlkZW9UaXRsZSwgNjAwKTsKICAgIH0KICB9Cn07CgpmdW5jdGlvbiBoNVBsYXllclRjY0luaXQgKGg1UGxheWVyKSB7CiAgcmV0dXJuIG5ldyBUQ0MkMSh0YXNrQ29uZiwgZnVuY3Rpb24gKHRhc2tOYW1lLCB0YXNrQ29uZiwgZGF0YSkgewogICAgdHJ5IHsKICAgICAgY29uc3QgdGFzayA9IHRhc2tDb25mW3Rhc2tOYW1lXTsKICAgICAgY29uc3Qgd3JhcERvbSA9IGg1UGxheWVyLmdldFBsYXllcldyYXBEb20oKTsKCiAgICAgIGlmICghdGFzaykgeyByZXR1cm4gfQoKICAgICAgaWYgKHRhc2tOYW1lID09PSAnc2hvcnRjdXRzJykgewogICAgICAgIGlmIChpc09iaiQxKHRhc2spICYmIHRhc2suY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikgewogICAgICAgICAgcmV0dXJuIHRhc2suY2FsbGJhY2soaDVQbGF5ZXIsIHRhc2tDb25mLCBkYXRhKQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh0YXNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHsKICAgICAgICB0cnkgewogICAgICAgICAgcmV0dXJuIHRhc2soaDVQbGF5ZXIsIHRhc2tDb25mLCBkYXRhKQogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIGRlYnVnLmVycm9yKCfku7vliqHphY3nva7kuK3lv4PnmoToh6rlrprkuYnlh73mlbDmiafooYzlpLHotKXvvJonLCB0YXNrTmFtZSwgdGFza0NvbmYsIGRhdGEsIGUpOwogICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHR5cGVvZiB0YXNrID09PSAnYm9vbGVhbicpIHsKICAgICAgICByZXR1cm4gdGFzawogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IHNlbGVjdG9yTGlzdCA9IEFycmF5LmlzQXJyYXkodGFzaykgPyB0YXNrIDogW3Rhc2tdOwogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0b3JMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBjb25zdCBzZWxlY3RvciA9IHNlbGVjdG9yTGlzdFtpXTsKCiAgICAgICAgICAvKiDop6blj5HpgInmi6nlmajkuIrnmoTngrnlh7vkuovku7YgKi8KICAgICAgICAgIGlmICh3cmFwRG9tICYmIHdyYXBEb20ucXVlcnlTZWxlY3RvcihzZWxlY3RvcikpIHsKICAgICAgICAgIC8vIOWcqHZpZGVv55qE54i25YWD57Sg6YeM5p+l5om+77yM5piv5Li65LqG5bC95Y+v6IO95YW85a655aSa5a6e5L6L5LiL55qE6YC76L6RCiAgICAgICAgICAgIHdyYXBEb20ucXVlcnlTZWxlY3RvcihzZWxlY3RvcikuY2xpY2soKTsKICAgICAgICAgICAgcmV0dXJuIHRydWUKICAgICAgICAgIH0gZWxzZSBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvcikpIHsKICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvcikuY2xpY2soKTsKICAgICAgICAgICAgcmV0dXJuIHRydWUKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgZGVidWcuZXJyb3IoJ+S7u+WKoemFjee9ruS4reW/g+eahOiHquWumuS5ieS7u+WKoeaJp+ihjOWksei0pe+8micsIHRhc2tOYW1lLCB0YXNrQ29uZiwgZGF0YSwgZSk7CiAgICAgIHJldHVybiBmYWxzZQogICAgfQogIH0pCn0KCmZ1bmN0aW9uIG1lcmdlVGFza0NvbmYgKGNvbmZpZykgewogIHJldHVybiBtZXJnZU9iaih0YXNrQ29uZiwgY29uZmlnKQp9CgovKiB1YeS8quijhemFjee9riAqLwpjb25zdCBmYWtlQ29uZmlnID0gewogIC8vICd0di5jY3R2LmNvbSc6IHVzZXJBZ2VudE1hcC5pUGhvbmUuY2hyb21lLAogIC8vICd2LnFxLmNvbSc6IHVzZXJBZ2VudE1hcC5pUGFkLmNocm9tZSwKICAnb3Blbi4xNjMuY29tJzogdXNlckFnZW50TWFwLmlQaG9uZS5jaHJvbWUsCiAgJ20ub3Blbi4xNjMuY29tJzogdXNlckFnZW50TWFwLmlQaG9uZS5jaHJvbWUsCiAgLyog55m+5bqm55uY55qE6Z2e5Lya5ZGY5Lya5L2/55So6Ieq6Lqr55qE5LiT55So5pKt5pS+5Zmo77yM5a+86Ie05rKh5rOV5L2/55SoaDVwbGF5ZXLvvIzmiYDku6XpnIDopoHpgJrov4fkvKroo4V1Yeadpeino+WGs+ivpemXrumimCAqLwogICdwYW4uYmFpZHUuY29tJzogdXNlckFnZW50TWFwLmlQaG9uZS5zYWZhcmkKfTsKCmZ1bmN0aW9uIHNldEZha2VVQSAodWEpIHsKICBjb25zdCBob3N0ID0gd2luZG93LmxvY2F0aW9uLmhvc3Q7CiAgdWEgPSB1YSB8fCBmYWtlQ29uZmlnW2hvc3RdOwoKICAvKioKICAgKiDliqjmgIHliKTmlq3mmK/lkKbpnIDopoHov5vooYx1YeS8quijhQogICAqIOS4i+mdouaWueahiOaaguaXtuS4jeWPr+eUqAogICAqIOeUseS6jumDqOWIhue9keermei3s+i9rOiHs+enu+WKqOerr+WQjuWfn+WQjeS4jeS4gOiHtO+8jOW9ouaIkOi3qOWfn+mXrumimAogICAqIOWvvOiHtOaXoOazleWQjOatpeS8quijhemFjee9ruiAjOS4jeaWreatu+W+queOr+i3s+i9rAogICAqIGVnLiBvcGVuLjE2My5jb20KICAgKiAqLwogIC8vIGxldCBjdXN0b21VQSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnX2g1X3BsYXllcl91c2VyX2FnZW50XycpCiAgLy8gZGVidWcubG9nKGN1c3RvbVVBLCB3aW5kb3cubG9jYXRpb24uaHJlZiwgd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQsIGRvY3VtZW50LnJlZmVycmVyKQogIC8vIGlmIChjdXN0b21VQSkgewogIC8vICAgZmFrZVVBKGN1c3RvbVVBKQogIC8vICAgYWxlcnQoY3VzdG9tVUEpCiAgLy8gfSBlbHNlIHsKICAvLyAgIGFsZXJ0KCd1YSBmYWxzZScpCiAgLy8gfQoKICB1YSAmJiBmYWtlVUEodWEpOwp9CgovKioKICog5YWD57Sg5YWo5bGPQVBJ77yM5ZCM5pe25YW85a65572R6aG15YWo5bGPCiAqLwoKY2xhc3MgRnVsbFNjcmVlbiB7CiAgY29uc3RydWN0b3IgKGRvbSwgcGFnZU1vZGUpIHsKICAgIHRoaXMuZG9tID0gZG9tOwogICAgdGhpcy5zaGFkb3dSb290ID0gbnVsbDsKICAgIHRoaXMuZnVsbFN0YXR1cyA9IGZhbHNlOwogICAgLy8g6buY6K6k5YWo5bGP5qih5byP77yM5aaC5p6c5Lyg5YWlcGFnZU1vZGXliJnooajnpLrov5vooYznmoTmmK/pobXpnaLlhajlsY/mk43kvZwKICAgIHRoaXMucGFnZU1vZGUgPSBwYWdlTW9kZSB8fCBmYWxzZTsKICAgIGNvbnN0IGZ1bGxQYWdlU3R5bGUgPSBgCiAgICAgIC5fd2ViZnVsbHNjcmVlbl9ib3hfc2l6ZV8gewoJCQkJd2lkdGg6IDEwMCUgIWltcG9ydGFudDsKCQkJCWhlaWdodDogMTAwJSAhaW1wb3J0YW50OwoJCQl9CiAgICAgIC5fd2ViZnVsbHNjcmVlbl8gewogICAgICAgIGRpc3BsYXk6IGJsb2NrICFpbXBvcnRhbnQ7CgkJCQlwb3NpdGlvbjogZml4ZWQgIWltcG9ydGFudDsKCQkJCXdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7CgkJCQloZWlnaHQ6IDEwMCUgIWltcG9ydGFudDsKCQkJCXRvcDogMCAhaW1wb3J0YW50OwoJCQkJbGVmdDogMCAhaW1wb3J0YW50OwoJCQkJYmFja2dyb3VuZDogIzAwMCAhaW1wb3J0YW50OwoJCQkJei1pbmRleDogOTk5OTk5ICFpbXBvcnRhbnQ7CgkJCX0KCQkJLl93ZWJmdWxsc2NyZWVuX3ppbmRleF8gewoJCQkJei1pbmRleDogOTk5OTk5ICFpbXBvcnRhbnQ7CgkJCX0KCQlgOwogICAgLyog5bCG5qC35byP5o+S5YWl5Yiw5YWo5bGA6aG16Z2i5LitICovCiAgICBpZiAoIXdpbmRvdy5faGFzSW5pdEZ1bGxQYWdlU3R5bGVfICYmIHdpbmRvdy5HTV9hZGRTdHlsZSkgewogICAgICB3aW5kb3cuR01fYWRkU3R5bGUoZnVsbFBhZ2VTdHlsZSk7CiAgICAgIHdpbmRvdy5faGFzSW5pdEZ1bGxQYWdlU3R5bGVfID0gdHJ1ZTsKICAgIH0KCiAgICAvKiDlsIbmoLflvI/mj5LlhaXliLBzaGFkb3dSb2905LitICovCiAgICBjb25zdCBzaGFkb3dSb290ID0gaXNJblNoYWRvdyhkb20sIHRydWUpOwogICAgaWYgKHNoYWRvd1Jvb3QpIHsKICAgICAgdGhpcy5zaGFkb3dSb290ID0gc2hhZG93Um9vdDsKICAgICAgbG9hZENTU1RleHQoZnVsbFBhZ2VTdHlsZSwgJ2Z1bGxQYWdlU3R5bGUnLCBzaGFkb3dSb290KTsKICAgIH0KCiAgICBjb25zdCB0ID0gdGhpczsKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIChldmVudCkgPT4gewogICAgICBjb25zdCBrZXkgPSBldmVudC5rZXkudG9Mb3dlckNhc2UoKTsKICAgICAgaWYgKGtleSA9PT0gJ2VzY2FwZScpIHsKICAgICAgICBpZiAodC5pc0Z1bGwoKSkgewogICAgICAgICAgdC5leGl0KCk7CiAgICAgICAgfSBlbHNlIGlmICh0LmlzRnVsbFNjcmVlbigpKSB7CiAgICAgICAgICB0LmV4aXRGdWxsU2NyZWVuKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCB0cnVlKTsKCiAgICB0aGlzLmdldENvbnRhaW5lcigpOwogIH0KCiAgZWFjaFBhcmVudE5vZGUgKGRvbSwgZm4pIHsKICAgIGxldCBwYXJlbnQgPSBkb20ucGFyZW50Tm9kZTsKICAgIHdoaWxlIChwYXJlbnQgJiYgcGFyZW50LmNsYXNzTGlzdCkgewogICAgICBjb25zdCBpc0VuZCA9IGZuKHBhcmVudCwgZG9tKTsKICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudE5vZGU7CiAgICAgIGlmIChpc0VuZCkgewogICAgICAgIGJyZWFrCiAgICAgIH0KICAgIH0KICB9CgogIGdldENvbnRhaW5lciAoKSB7CiAgICBjb25zdCB0ID0gdGhpczsKICAgIGlmICh0Ll9jb250YWluZXJfKSByZXR1cm4gdC5fY29udGFpbmVyXwoKICAgIGNvbnN0IGQgPSB0LmRvbTsKICAgIGNvbnN0IGRvbUJveCA9IGQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICBsZXQgY29udGFpbmVyID0gZDsKICAgIHQuZWFjaFBhcmVudE5vZGUoZCwgZnVuY3Rpb24gKHBhcmVudE5vZGUpIHsKICAgICAgY29uc3Qgbm9QYXJlbnROb2RlID0gIXBhcmVudE5vZGUgfHwgIXBhcmVudE5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0OwogICAgICBpZiAobm9QYXJlbnROb2RlIHx8IHBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCdkYXRhLWZ1bGxzY3JlZW4tY29udGFpbmVyJykpIHsKICAgICAgICBjb250YWluZXIgPSBwYXJlbnROb2RlOwogICAgICAgIHJldHVybiB0cnVlCiAgICAgIH0KCiAgICAgIGNvbnN0IHBhcmVudEJveCA9IHBhcmVudE5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIGNvbnN0IGlzSW5zaWRlVGhlQm94ID0gcGFyZW50Qm94LndpZHRoIDw9IGRvbUJveC53aWR0aCAmJiBwYXJlbnRCb3guaGVpZ2h0IDw9IGRvbUJveC5oZWlnaHQ7CiAgICAgIGlmIChpc0luc2lkZVRoZUJveCkgewogICAgICAgIGNvbnRhaW5lciA9IHBhcmVudE5vZGU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRydWUKICAgICAgfQogICAgfSk7CgogICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZSgnZGF0YS1mdWxsc2NyZWVuLWNvbnRhaW5lcicsICd0cnVlJyk7CiAgICB0Ll9jb250YWluZXJfID0gY29udGFpbmVyOwogICAgcmV0dXJuIGNvbnRhaW5lcgogIH0KCiAgaXNGdWxsICgpIHsKICAgIHJldHVybiB0aGlzLmRvbS5jbGFzc0xpc3QuY29udGFpbnMoJ193ZWJmdWxsc2NyZWVuXycpIHx8IHRoaXMuZnVsbFN0YXR1cwogIH0KCiAgaXNGdWxsU2NyZWVuICgpIHsKICAgIGNvbnN0IGQgPSBkb2N1bWVudDsKICAgIHJldHVybiAhIShkLmZ1bGxzY3JlZW4gfHwgZC53ZWJraXRJc0Z1bGxTY3JlZW4gfHwgZC5tb3pGdWxsU2NyZWVuIHx8CiAgICAgIGQuZnVsbHNjcmVlbkVsZW1lbnQgfHwgZC53ZWJraXRGdWxsc2NyZWVuRWxlbWVudCB8fCBkLm1vekZ1bGxTY3JlZW5FbGVtZW50KQogIH0KCiAgZW50ZXJGdWxsU2NyZWVuICgpIHsKICAgIGNvbnN0IGMgPSB0aGlzLmdldENvbnRhaW5lcigpOwogICAgY29uc3QgZW50ZXJGbiA9IGMucmVxdWVzdEZ1bGxzY3JlZW4gfHwgYy53ZWJraXRSZXF1ZXN0RnVsbFNjcmVlbiB8fCBjLm1velJlcXVlc3RGdWxsU2NyZWVuIHx8IGMubXNSZXF1ZXN0RnVsbFNjcmVlbjsKICAgIGVudGVyRm4gJiYgZW50ZXJGbi5jYWxsKGMpOwogIH0KCiAgZW50ZXIgKCkgewogICAgY29uc3QgdCA9IHRoaXM7CiAgICBpZiAodC5pc0Z1bGwoKSkgcmV0dXJuCiAgICBjb25zdCBjb250YWluZXIgPSB0LmdldENvbnRhaW5lcigpOwogICAgbGV0IG5lZWRTZXRJbmRleCA9IGZhbHNlOwogICAgaWYgKHQuZG9tID09PSBjb250YWluZXIpIHsKICAgICAgbmVlZFNldEluZGV4ID0gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGRGdWxsc2NyZWVuU3R5bGVUb1BhcmVudE5vZGUgKG5vZGUpIHsKICAgICAgdC5lYWNoUGFyZW50Tm9kZShub2RlLCBmdW5jdGlvbiAocGFyZW50Tm9kZSkgewogICAgICAgIHBhcmVudE5vZGUuY2xhc3NMaXN0LmFkZCgnX3dlYmZ1bGxzY3JlZW5fJyk7CiAgICAgICAgaWYgKGNvbnRhaW5lciA9PT0gcGFyZW50Tm9kZSB8fCBuZWVkU2V0SW5kZXgpIHsKICAgICAgICAgIG5lZWRTZXRJbmRleCA9IHRydWU7CiAgICAgICAgICBwYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoJ193ZWJmdWxsc2NyZWVuX3ppbmRleF8nKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogICAgYWRkRnVsbHNjcmVlblN0eWxlVG9QYXJlbnROb2RlKHQuZG9tKTsKCiAgICAvKiDliKTmlq1kb23oh6rouqvmmK/lkKbpnIDopoHliqDkuIp3ZWJmdWxsc2NyZWVu5qC35byPICovCiAgICBpZiAodC5kb20ucGFyZW50Tm9kZSkgewogICAgICBjb25zdCBkb21Cb3ggPSB0LmRvbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgY29uc3QgZG9tUGFyZW50Qm94ID0gdC5kb20ucGFyZW50Tm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgaWYgKGRvbVBhcmVudEJveC53aWR0aCAtIGRvbUJveC53aWR0aCA+PSA1KSB7CiAgICAgICAgdC5kb20uY2xhc3NMaXN0LmFkZCgnX3dlYmZ1bGxzY3JlZW5fJyk7CiAgICAgIH0KCiAgICAgIGlmICh0LnNoYWRvd1Jvb3QgJiYgdC5zaGFkb3dSb290Ll9zaGFkb3dIb3N0KSB7CiAgICAgICAgY29uc3Qgc2hhZG93SG9zdCA9IHQuc2hhZG93Um9vdC5fc2hhZG93SG9zdDsKICAgICAgICBjb25zdCBzaGFkb3dIb3N0Qm94ID0gc2hhZG93SG9zdC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICBpZiAoc2hhZG93SG9zdEJveC53aWR0aCA8PSBkb21Cb3gud2lkdGgpIHsKICAgICAgICAgIHNoYWRvd0hvc3QuY2xhc3NMaXN0LmFkZCgnX3dlYmZ1bGxzY3JlZW5fJyk7CiAgICAgICAgICBhZGRGdWxsc2NyZWVuU3R5bGVUb1BhcmVudE5vZGUoc2hhZG93SG9zdCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgY29uc3QgZnVsbFNjcmVlbk1vZGUgPSAhdC5wYWdlTW9kZTsKICAgIGlmIChmdWxsU2NyZWVuTW9kZSkgewogICAgICB0LmVudGVyRnVsbFNjcmVlbigpOwogICAgfQoKICAgIHRoaXMuZnVsbFN0YXR1cyA9IHRydWU7CiAgfQoKICBleGl0RnVsbFNjcmVlbiAoKSB7CiAgICBjb25zdCBkID0gZG9jdW1lbnQ7CiAgICBjb25zdCBleGl0Rm4gPSBkLmV4aXRGdWxsc2NyZWVuIHx8IGQud2Via2l0RXhpdEZ1bGxzY3JlZW4gfHwgZC5tb3pDYW5jZWxGdWxsU2NyZWVuIHx8IGQubXNFeGl0RnVsbHNjcmVlbjsKICAgIGV4aXRGbiAmJiBleGl0Rm4uY2FsbChkKTsKICB9CgogIGV4aXQgKCkgewogICAgY29uc3QgdCA9IHRoaXM7CgogICAgZnVuY3Rpb24gcmVtb3ZlRnVsbHNjcmVlblN0eWxlVG9QYXJlbnROb2RlIChub2RlKSB7CiAgICAgIHQuZWFjaFBhcmVudE5vZGUobm9kZSwgZnVuY3Rpb24gKHBhcmVudE5vZGUpIHsKICAgICAgICBwYXJlbnROb2RlLmNsYXNzTGlzdC5yZW1vdmUoJ193ZWJmdWxsc2NyZWVuXycpOwogICAgICAgIHBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnX3dlYmZ1bGxzY3JlZW5femluZGV4XycpOwogICAgICB9KTsKICAgIH0KICAgIHJlbW92ZUZ1bGxzY3JlZW5TdHlsZVRvUGFyZW50Tm9kZSh0LmRvbSk7CgogICAgdC5kb20uY2xhc3NMaXN0LnJlbW92ZSgnX3dlYmZ1bGxzY3JlZW5fJyk7CgogICAgaWYgKHQuc2hhZG93Um9vdCAmJiB0LnNoYWRvd1Jvb3QuX3NoYWRvd0hvc3QpIHsKICAgICAgY29uc3Qgc2hhZG93SG9zdCA9IHQuc2hhZG93Um9vdC5fc2hhZG93SG9zdDsKICAgICAgc2hhZG93SG9zdC5jbGFzc0xpc3QucmVtb3ZlKCdfd2ViZnVsbHNjcmVlbl8nKTsKICAgICAgcmVtb3ZlRnVsbHNjcmVlblN0eWxlVG9QYXJlbnROb2RlKHNoYWRvd0hvc3QpOwogICAgfQoKICAgIGNvbnN0IGZ1bGxTY3JlZW5Nb2RlID0gIXQucGFnZU1vZGU7CiAgICBpZiAoZnVsbFNjcmVlbk1vZGUgfHwgdC5pc0Z1bGxTY3JlZW4oKSkgewogICAgICB0LmV4aXRGdWxsU2NyZWVuKCk7CiAgICB9CiAgICB0aGlzLmZ1bGxTdGF0dXMgPSBmYWxzZTsKICB9CgogIHRvZ2dsZSAoKSB7CiAgICB0aGlzLmlzRnVsbCgpID8gdGhpcy5leGl0KCkgOiB0aGlzLmVudGVyKCk7CiAgfQp9CgovKiEKICogQG5hbWUgICAgICB2aWRlb0NhcHR1cmVyLmpzCiAqIEB2ZXJzaW9uICAgMC4wLjEKICogQGF1dGhvciAgICBCbGF6ZQogKiBAZGF0ZSAgICAgIDIwMTkvOS8yMSAxMjowMwogKiBAZ2l0aHViICAgIGh0dHBzOi8vZ2l0aHViLmNvbS94eHhpbHkKICovCgphc3luYyBmdW5jdGlvbiBzZXRDbGlwYm9hcmQgKGJsb2IpIHsKICBpZiAobmF2aWdhdG9yLmNsaXBib2FyZCkgewogICAgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZShbCiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlZgogICAgICBuZXcgQ2xpcGJvYXJkSXRlbSh7CiAgICAgICAgW2Jsb2IudHlwZV06IGJsb2IKICAgICAgfSkKICAgIF0pLnRoZW4oKCkgPT4gewogICAgICBjb25zb2xlLmluZm8oJ1tzZXRDbGlwYm9hcmRdIGNsaXBib2FyZCBzdWMnLCBibG9iLnR5cGUpOwogICAgfSkuY2F0Y2goKGUpID0+IHsKICAgICAgY29uc29sZS5lcnJvcignW3NldENsaXBib2FyZF0gY2xpcGJvYXJkIGVycicsIGJsb2IudHlwZSwgZSk7CiAgICB9KTsKICB9IGVsc2UgewogICAgY29uc29sZS5lcnJvcign5b2T5YmN572R56uZ5LiN5pSv5oyB5bCG5pWw5o2u5YaZ5YWl5Yiw5Ymq6LS05p2/6YeM77yM6KeB77yaXG4gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0NsaXBib2FyZCcpOwogIH0KfQoKdmFyIHZpZGVvQ2FwdHVyZXIgPSB7CiAgLyoqCiAgICog6L+b6KGM5oiq5Zu+5pON5L2cCiAgICogQHBhcmFtIHZpZGVvIHtkb219IC3lv4XpgIkgdmlkZW8gZG9tIOagh+etvgogICAqIEByZXR1cm5zIHtib29sZWFufQogICAqLwogIGNhcHR1cmUgKHZpZGVvLCBkb3dubG9hZCwgdGl0bGUpIHsKICAgIGlmICghdmlkZW8pIHJldHVybiBmYWxzZQogICAgY29uc3QgdCA9IHRoaXM7CiAgICBjb25zdCBjdXJyZW50VGltZSA9IGAke01hdGguZmxvb3IodmlkZW8uY3VycmVudFRpbWUgLyA2MCl9JyR7KHZpZGVvLmN1cnJlbnRUaW1lICUgNjApLnRvRml4ZWQoMyl9JydgOwogICAgY29uc3QgY2FwdHVyZVRpdGxlID0gdGl0bGUgfHwgYCR7ZG9jdW1lbnQudGl0bGV9XyR7Y3VycmVudFRpbWV9YDsKCiAgICAvKiDmiKrlm77moLjlv4PpgLvovpEgKi8KICAgIHZpZGVvLnNldEF0dHJpYnV0ZSgnY3Jvc3NvcmlnaW4nLCAnYW5vbnltb3VzJyk7CiAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTsKICAgIGNhbnZhcy53aWR0aCA9IHZpZGVvLnZpZGVvV2lkdGg7CiAgICBjYW52YXMuaGVpZ2h0ID0gdmlkZW8udmlkZW9IZWlnaHQ7CiAgICBjb25zdCBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7CiAgICBjb250ZXh0LmRyYXdJbWFnZSh2aWRlbywgMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTsKCiAgICBpZiAoZG93bmxvYWQpIHsKICAgICAgdC5kb3dubG9hZChjYW52YXMsIGNhcHR1cmVUaXRsZSwgdmlkZW8pOwogICAgfSBlbHNlIHsKICAgICAgdC5wcmV2aWUoY2FudmFzLCBjYXB0dXJlVGl0bGUpOwogICAgfQoKICAgIHJldHVybiBjYW52YXMKICB9LAogIC8qKgogICAqIOmihOiniOaIquWPluWIsOeahOeUu+mdouWGheWuuQogICAqIEBwYXJhbSBjYW52YXMKICAgKi8KICBwcmV2aWUgKGNhbnZhcywgdGl0bGUpIHsKICAgIGNhbnZhcy5zdHlsZSA9ICdtYXgtd2lkdGg6MTAwJSc7CiAgICBjb25zdCBwcmV2aWV3UGFnZSA9IHdpbmRvdy5vcGVuKCcnLCAnX2JsYW5rJyk7CiAgICBwcmV2aWV3UGFnZS5kb2N1bWVudC50aXRsZSA9IGBjYXB0dXJlIHByZXZpZSAtICR7dGl0bGUgfHwgJ1VudGl0bGVkJ31gOwogICAgcHJldmlld1BhZ2UuZG9jdW1lbnQuYm9keS5zdHlsZS50ZXh0QWxpZ24gPSAnY2VudGVyJzsKICAgIHByZXZpZXdQYWdlLmRvY3VtZW50LmJvZHkuc3R5bGUuYmFja2dyb3VuZCA9ICcjMDAwJzsKICAgIHByZXZpZXdQYWdlLmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY2FudmFzKTsKICB9LAogIC8qKgogICAqIGNhbnZhcyDkuIvovb3miKrlj5bliLDnmoTlhoXlrrkKICAgKiBAcGFyYW0gY2FudmFzCiAgICovCiAgZG93bmxvYWQgKGNhbnZhcywgdGl0bGUsIHZpZGVvKSB7CiAgICB0aXRsZSA9IHRpdGxlIHx8ICd2aWRlb0NhcHR1cmVyXycgKyBEYXRlLm5vdygpOwoKICAgIHRyeSB7CiAgICAgIC8qKgogICAgICAgKiDlsJ3or5XlpI3liLbliLDliarotLTmnb8KICAgICAgICog5rOo5oSP6YOo5YiG5rWP6KeI5Zmo5LiN5pSv5oyB5bCGJ2ltYWdlL2pwZWcn57G75Z6L55qE5pWw5o2u5YaZ5YWl5Yiw5Ymq6LS05p2/77yMaW1hZ2UvanBn5Y+v5Lul77yM5L2G5Lya5a+86Ie0dG9CbG9i55qE57uT5p6c5Li6cG5n55qE5pWw5o2u77yMCiAgICAgICAqIOaJgOS7pei/memHjOaWsOi1t+S6hidpbWFnZS9wbmcn5p2l5bCd6K+V5aSN5Yi25Yiw5Ymq6LS05p2/77yM6ICM5LiN6IO95bCGc2V0Q2xpcGJvYXJkKGJsb2Ip5pS+5Yiw5LiL6Z2i55qEdHJ56YeMCiAgICAgICAqIOWPpuWklueUseS6juS4i+mdoueahOiHquWKqOS4i+i9veaIquWbvuS8muWvvOiHtOmhtemdouWkseeEpu+8jOS5n+S8mumAoOaIkOWkjeWItuWIsOWJqui0tOadv+Wksei0pe+8jOaJgOS7pei/memHjOWFiOWkjeWItuWIsOWJqui0tOadv++8jOWGjei/m+ihjOS4i+i9vQogICAgICAgKi8KICAgICAgY2FudmFzLnRvQmxvYihmdW5jdGlvbiAoYmxvYikgewogICAgICAgIHNldENsaXBib2FyZChibG9iKTsKICAgICAgfSwgJ2ltYWdlL3BuZycsIDAuOTkpOwogICAgfSBjYXRjaCAoZSkgewogICAgICBjb25zb2xlLmVycm9yKCfml6Dms5XlsIbmiKrlm77lpI3liLbliLDliarotLTmnb/jgIInLCBlKTsKICAgIH0KCiAgICB0cnkgewogICAgICBjYW52YXMudG9CbG9iKGZ1bmN0aW9uIChibG9iKSB7CiAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CiAgICAgICAgZWwuZG93bmxvYWQgPSBgJHt0aXRsZX0uanBnYDsKICAgICAgICBlbC5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsKICAgICAgICBlbC5jbGljaygpOwogICAgICB9LCAnaW1hZ2UvanBlZycsIDAuOTkpOwogICAgfSBjYXRjaCAoZSkgewogICAgICB2aWRlb0NhcHR1cmVyLnByZXZpZShjYW52YXMsIHRpdGxlKTsKICAgICAgY29uc29sZS5lcnJvcign6KeG6aKR5rqQ5Y+XQ09SU+agh+ivhumZkOWItu+8jOaXoOazleebtOaOpeS4i+i9veaIquWbvu+8jOinge+8mlxuIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0hUVFAvQ09SUycpOwogICAgICBjb25zb2xlLmVycm9yKHZpZGVvLCBlKTsKICAgIH0KICB9Cn07CgovKioKICog6byg5qCH5LqL5Lu26KeC5rWL5a+56LGhCiAqIOeUqOS6juWunueOsOm8oOagh+S6i+S7tueahOepv+mAj+WTjeW6lO+8jOacieWIq+S6jnBvaW50ZXItZXZlbnRzOm5vbmUKICogcG9pbnRlci1ldmVudHM6bm9uZeaYr+iuvue9ruW9k+WJjeWxguWFgeiuuOepv+mAjwogKiDogIxNb3VzZU9ic2VydmVy5piv77ya5Y2z5L2/5LiN55+l6YGTdGFyZ2V05LiK6Z2i5a2Y5Zyo5aSa5bCR5bGC6YGu5oyh77yM5LiA5qC35Y+v5Lul5ZON5bqU6byg5qCH5LqL5Lu2CiAqLwoKY2xhc3MgTW91c2VPYnNlcnZlciB7CiAgY29uc3RydWN0b3IgKG9ic2VydmVPcHQpIHsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlZgogICAgdGhpcy5vYnNlcnZlciA9IG5ldyBJbnRlcnNlY3Rpb25PYnNlcnZlcigoaW5mb0xpc3QpID0+IHsKICAgICAgaW5mb0xpc3QuZm9yRWFjaCgoaW5mbykgPT4gewogICAgICAgIGluZm8udGFyZ2V0LkludGVyc2VjdGlvbk9ic2VydmVyRW50cnkgPSBpbmZvOwogICAgICB9KTsKICAgIH0sIG9ic2VydmVPcHQgfHwge30pOwoKICAgIHRoaXMub2JzZXJ2ZUxpc3QgPSBbXTsKICB9CgogIF9vYnNlcnZlICh0YXJnZXQpIHsKICAgIGxldCBoYXNPYnNlcnZlID0gZmFsc2U7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMub2JzZXJ2ZUxpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgZWwgPSB0aGlzLm9ic2VydmVMaXN0W2ldOwogICAgICBpZiAodGFyZ2V0ID09PSBlbCkgewogICAgICAgIGhhc09ic2VydmUgPSB0cnVlOwogICAgICAgIGJyZWFrCiAgICAgIH0KICAgIH0KCiAgICBpZiAoIWhhc09ic2VydmUpIHsKICAgICAgdGhpcy5vYnNlcnZlci5vYnNlcnZlKHRhcmdldCk7CiAgICAgIHRoaXMub2JzZXJ2ZUxpc3QucHVzaCh0YXJnZXQpOwogICAgfQogIH0KCiAgX3Vub2JzZXJ2ZSAodGFyZ2V0KSB7CiAgICB0aGlzLm9ic2VydmVyLnVub2JzZXJ2ZSh0YXJnZXQpOwogICAgY29uc3QgbmV3T2JzZXJ2ZUxpc3QgPSBbXTsKICAgIHRoaXMub2JzZXJ2ZUxpc3QuZm9yRWFjaCgoZWwpID0+IHsKICAgICAgaWYgKGVsICE9PSB0YXJnZXQpIHsKICAgICAgICBuZXdPYnNlcnZlTGlzdC5wdXNoKGVsKTsKICAgICAgfQogICAgfSk7CiAgICB0aGlzLm9ic2VydmVMaXN0ID0gbmV3T2JzZXJ2ZUxpc3Q7CiAgfQoKICAvKioKICAgKiDlop7liqDkuovku7bnu5HlrpoKICAgKiBAcGFyYW0gdGFyZ2V0IHtlbGVtZW50fSAt5b+F6YCJIOimgee7keWumuS6i+S7tueahGRvbeWvueixoQogICAqIEBwYXJhbSB0eXBlIHtzdHJpbmd9IC3lv4XpgIkg6KaB57uR5a6a55qE5LqL5Lu277yM5Y+q5pSv5oyB6byg5qCH5LqL5Lu2CiAgICogQHBhcmFtIGxpc3RlbmVyIHtmdW5jdGlvbn0gLeW/hemAiSDnrKblkIjop6blj5HmnaHku7bml7bnmoTlk43lupTlh73mlbAKICAgKi8KICBvbiAodGFyZ2V0LCB0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucykgewogICAgY29uc3QgdCA9IHRoaXM7CiAgICB0Ll9vYnNlcnZlKHRhcmdldCk7CgogICAgaWYgKCF0YXJnZXQuTW91c2VPYnNlcnZlckV2ZW50KSB7CiAgICAgIHRhcmdldC5Nb3VzZU9ic2VydmVyRXZlbnQgPSB7fTsKICAgIH0KICAgIHRhcmdldC5Nb3VzZU9ic2VydmVyRXZlbnRbdHlwZV0gPSB0cnVlOwoKICAgIGlmICghdC5fbW91c2VPYnNlcnZlcl8pIHsKICAgICAgdC5fbW91c2VPYnNlcnZlcl8gPSB7fTsKICAgIH0KCiAgICBpZiAoIXQuX21vdXNlT2JzZXJ2ZXJfW3R5cGVdKSB7CiAgICAgIHQuX21vdXNlT2JzZXJ2ZXJfW3R5cGVdID0gW107CgogICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCAoZXZlbnQpID0+IHsKICAgICAgICB0Lm9ic2VydmVMaXN0LmZvckVhY2goKHRhcmdldCkgPT4gewogICAgICAgICAgY29uc3QgaXNWaXNpYmlsaXR5ID0gdGFyZ2V0LkludGVyc2VjdGlvbk9ic2VydmVyRW50cnkgJiYgdGFyZ2V0LkludGVyc2VjdGlvbk9ic2VydmVyRW50cnkuaW50ZXJzZWN0aW9uUmF0aW8gPiAwOwogICAgICAgICAgY29uc3QgaXNSZWcgPSB0YXJnZXQuTW91c2VPYnNlcnZlckV2ZW50W2V2ZW50LnR5cGVdID09PSB0cnVlOwogICAgICAgICAgaWYgKGlzVmlzaWJpbGl0eSAmJiBpc1JlZykgewogICAgICAgICAgICAvKiDliKTmlq3mmK/lkKbnrKblkIjop6blj5HkvqblkKzlmajkuovku7bmnaHku7YgKi8KICAgICAgICAgICAgY29uc3QgYm91bmQgPSB0YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgICAgIGNvbnN0IG9mZnNldFggPSBldmVudC54IC0gYm91bmQueDsKICAgICAgICAgICAgY29uc3Qgb2Zmc2V0WSA9IGV2ZW50LnkgLSBib3VuZC55OwogICAgICAgICAgICBjb25zdCBpc05lZWRUYXAgPSBvZmZzZXRYIDw9IGJvdW5kLndpZHRoICYmIG9mZnNldFggPj0gMCAmJiBvZmZzZXRZIDw9IGJvdW5kLmhlaWdodCAmJiBvZmZzZXRZID49IDA7CgogICAgICAgICAgICBpZiAoaXNOZWVkVGFwKSB7CiAgICAgICAgICAgICAgLyog5omn6KGM55uR5ZCs5Zue6LCDICovCiAgICAgICAgICAgICAgY29uc3QgbGlzdGVuZXJMaXN0ID0gdC5fbW91c2VPYnNlcnZlcl9bdHlwZV07CiAgICAgICAgICAgICAgbGlzdGVuZXJMaXN0LmZvckVhY2goKGxpc3RlbmVyKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAobGlzdGVuZXIgaW5zdGFuY2VvZiBGdW5jdGlvbikgewogICAgICAgICAgICAgICAgICBsaXN0ZW5lci5jYWxsKHQsIGV2ZW50LCB7CiAgICAgICAgICAgICAgICAgICAgeDogb2Zmc2V0WCwKICAgICAgICAgICAgICAgICAgICB5OiBvZmZzZXRZCiAgICAgICAgICAgICAgICAgIH0sIHRhcmdldCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSwgb3B0aW9ucyk7CiAgICB9CgogICAgLyog5bCG55uR5ZCs5Zue6LCD5Yqg5YWl5Yiw5LqL5Lu26Zif5YiXICovCiAgICBpZiAobGlzdGVuZXIgaW5zdGFuY2VvZiBGdW5jdGlvbikgewogICAgICB0Ll9tb3VzZU9ic2VydmVyX1t0eXBlXS5wdXNoKGxpc3RlbmVyKTsKICAgIH0KICB9CgogIC8qKgogICAqIOino+mZpOS6i+S7tue7keWumgogICAqIEBwYXJhbSB0YXJnZXQge2VsZW1lbnR9IC3lv4XpgIkg6KaB6Kej6Zmk5LqL5Lu255qEZG9t5a+56LGhCiAgICogQHBhcmFtIHR5cGUge3N0cmluZ30gLeW/hemAiSDopoHop6PpmaTnmoTkuovku7bvvIzlj6rmlK/mjIHpvKDmoIfkuovku7YKICAgKiBAcGFyYW0gbGlzdGVuZXIge2Z1bmN0aW9ufSAt5b+F6YCJIOe7keWumuS6i+S7tuaXtueahOWTjeW6lOWHveaVsAogICAqIEByZXR1cm5zIHtib29sZWFufQogICAqLwogIG9mZiAodGFyZ2V0LCB0eXBlLCBsaXN0ZW5lcikgewogICAgY29uc3QgdCA9IHRoaXM7CiAgICBpZiAoIXRhcmdldCB8fCAhdHlwZSB8fCAhbGlzdGVuZXIgfHwgIXQuX21vdXNlT2JzZXJ2ZXJfIHx8ICF0Ll9tb3VzZU9ic2VydmVyX1t0eXBlXSB8fCAhdGFyZ2V0Lk1vdXNlT2JzZXJ2ZXJFdmVudCB8fCAhdGFyZ2V0Lk1vdXNlT2JzZXJ2ZXJFdmVudFt0eXBlXSkgcmV0dXJuIGZhbHNlCgogICAgY29uc3QgbmV3TGlzdGVuZXJMaXN0ID0gW107CiAgICBjb25zdCBsaXN0ZW5lckxpc3QgPSB0Ll9tb3VzZU9ic2VydmVyX1t0eXBlXTsKICAgIGxldCBpc01hdGNoID0gZmFsc2U7CiAgICBsaXN0ZW5lckxpc3QuZm9yRWFjaCgobGlzdGVuZXJJdGVtKSA9PiB7CiAgICAgIGlmIChsaXN0ZW5lckl0ZW0gPT09IGxpc3RlbmVyKSB7CiAgICAgICAgaXNNYXRjaCA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbmV3TGlzdGVuZXJMaXN0LnB1c2gobGlzdGVuZXJJdGVtKTsKICAgICAgfQogICAgfSk7CgogICAgaWYgKGlzTWF0Y2gpIHsKICAgICAgdC5fbW91c2VPYnNlcnZlcl9bdHlwZV0gPSBuZXdMaXN0ZW5lckxpc3Q7CgogICAgICAvKiDkvqblkKzlmajlt7Looqvlrozlhajnp7vpmaQgKi8KICAgICAgaWYgKG5ld0xpc3RlbmVyTGlzdC5sZW5ndGggPT09IDApIHsKICAgICAgICBkZWxldGUgdGFyZ2V0Lk1vdXNlT2JzZXJ2ZXJFdmVudFt0eXBlXTsKICAgICAgfQoKICAgICAgLyog5b2TTW91c2VPYnNlcnZlckV2ZW505Li656m65a+56LGh5pe256e76Zmk6KeC5rWL5a+56LGhICovCiAgICAgIGlmIChKU09OLnN0cmluZ2lmeSh0YXJnZXQuTW91c2VPYnNlcnZlckV2ZW50W3R5cGVdKSA9PT0gJ3t9JykgewogICAgICAgIHQuX3Vub2JzZXJ2ZSh0YXJnZXQpOwogICAgICB9CiAgICB9CiAgfQp9CgovKioKICog566A5Y2V55qEaTE4buW6kwogKi8KCmNsYXNzIEkxOG4gewogIGNvbnN0cnVjdG9yIChjb25maWcpIHsKICAgIHRoaXMuX2xhbmd1YWdlcyA9IHt9OwogICAgdGhpcy5fbG9jYWxlID0gdGhpcy5nZXRDbGllbnRMYW5nKCk7CiAgICB0aGlzLl9kZWZhdWx0TGFuZ3VhZ2UgPSAnJzsKICAgIHRoaXMuaW5pdChjb25maWcpOwogIH0KCiAgaW5pdCAoY29uZmlnKSB7CiAgICBpZiAoIWNvbmZpZykgcmV0dXJuIGZhbHNlCgogICAgY29uc3QgdCA9IHRoaXM7CiAgICB0Ll9sb2NhbGUgPSBjb25maWcubG9jYWxlIHx8IHQuX2xvY2FsZTsKICAgIC8qIOaMh+WumuW9k+WJjeimgeaYr+S9v+eUqOeahOivreiogOeOr+Wig++8jOm7mOiupOaXoOmcgOaMh+Wumu+8jOS8muiHquWKqOivu+WPliAqLwogICAgdC5fbGFuZ3VhZ2VzID0gY29uZmlnLmxhbmd1YWdlcyB8fCB0Ll9sYW5ndWFnZXM7CiAgICB0Ll9kZWZhdWx0TGFuZ3VhZ2UgPSBjb25maWcuZGVmYXVsdExhbmd1YWdlIHx8IHQuX2RlZmF1bHRMYW5ndWFnZTsKICB9CgogIHVzZSAoKSB7fQoKICB0IChwYXRoKSB7CiAgICBjb25zdCB0ID0gdGhpczsKICAgIGxldCByZXN1bHQgPSB0LmdldFZhbEJ5UGF0aCh0Ll9sYW5ndWFnZXNbdC5fbG9jYWxlXSB8fCB7fSwgcGF0aCk7CgogICAgLyog54mI5pys5Zue6YCAICovCiAgICBpZiAoIXJlc3VsdCAmJiB0Ll9sb2NhbGUgIT09IHQuX2RlZmF1bHRMYW5ndWFnZSkgewogICAgICByZXN1bHQgPSB0LmdldFZhbEJ5UGF0aCh0Ll9sYW5ndWFnZXNbdC5fZGVmYXVsdExhbmd1YWdlXSB8fCB7fSwgcGF0aCk7CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdCB8fCAnJwogIH0KCiAgLyog5b2T5YmN6K+t6KiA5YC8ICovCiAgbGFuZ3VhZ2UgKCkgewogICAgcmV0dXJuIHRoaXMuX2xvY2FsZQogIH0KCiAgbGFuZ3VhZ2VzICgpIHsKICAgIHJldHVybiB0aGlzLl9sYW5ndWFnZXMKICB9CgogIGNoYW5nZUxhbmd1YWdlIChsb2NhbGUpIHsKICAgIGlmICh0aGlzLl9sYW5ndWFnZXNbbG9jYWxlXSkgewogICAgICB0aGlzLl9sb2NhbGUgPSBsb2NhbGU7CiAgICAgIHJldHVybiBsb2NhbGUKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBmYWxzZQogICAgfQogIH0KCiAgLyoqCiAgICog57uZ5Ye654m55a6a55qE6K+t6KiA546v5aKD77yM5Yik5pat5piv5ZCm5Yy56YWN5b2T5YmN6K6+5a6a55qE6K+t6KiA546v5aKDCiAgICogQHBhcmFtIHtTdHJpbmcgfCBBcnJheX0gbGFuZyAt5b+F6YCJIOivreiogOeOr+WigwogICAqLwogIGlzTWF0Y2hDdXJMYW5nIChsYW5nKSB7CiAgICBjb25zdCBjdXJMYW5nID0gdGhpcy5sYW5ndWFnZSgpIHx8ICcnOwoKICAgIC8qIOWFvOWuueWQhOenjeWPr+iDveeahOivreiogOmFjee9ruWGmeazle+8jOWBh+WmguW9k+WJjeiuvuWumuS4uu+8mnpoLUNO77yM5YiZ57uZ5a6a55qEbGFuZ+S4reWMheWQq3poLUNO44CBemhDTuOAgXpoX0NO44CBemjvvIzpg73orqTkuLrmmK/ljLnphY3nmoQgKi8KICAgIGNvbnN0IGN1ckxhbmcyID0gY3VyTGFuZy5yZXBsYWNlKCctJywgJycpOwogICAgY29uc3QgY3VyTGFuZzMgPSBjdXJMYW5nLnJlcGxhY2UoJy0nLCAnXycpOwogICAgY29uc3QgY3VyTGFuZzQgPSBjdXJMYW5nLnNwbGl0KCctJylbMF07CgogICAgaWYgKGxhbmcgJiYgIUFycmF5LmlzQXJyYXkobGFuZykpIHsgbGFuZyA9IFtsYW5nXTsgfQogICAgcmV0dXJuIGxhbmcuaW5jbHVkZXMoY3VyTGFuZykgfHwgbGFuZy5pbmNsdWRlcyhjdXJMYW5nMikgfHwgbGFuZy5pbmNsdWRlcyhjdXJMYW5nMykgfHwgbGFuZy5pbmNsdWRlcyhjdXJMYW5nNCkKICB9CgogIC8qKgogICAqIOagueaNruaWh+acrOi3r+W+hOiOt+WPluWvueixoemHjOmdoueahOWAvAogICAqIEBwYXJhbSBvYmoge09iamVjdH0gLeW/hemAiSDopoHmk43kvZznmoTlr7nosaEKICAgKiBAcGFyYW0gcGF0aCB7U3RyaW5nfSAt5b+F6YCJIOi3r+W+hOS/oeaBrwogICAqIEByZXR1cm5zIHsqfQogICAqLwogIGdldFZhbEJ5UGF0aCAob2JqLCBwYXRoKSB7CiAgICBwYXRoID0gcGF0aCB8fCAnJzsKICAgIGNvbnN0IHBhdGhBcnIgPSBwYXRoLnNwbGl0KCcuJyk7CiAgICBsZXQgcmVzdWx0ID0gb2JqOwoKICAgIC8qIOmAkuW9kuaPkOWPlue7k+aenOWAvCAqLwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXRoQXJyLmxlbmd0aDsgaSsrKSB7CiAgICAgIGlmICghcmVzdWx0KSBicmVhawogICAgICByZXN1bHQgPSByZXN1bHRbcGF0aEFycltpXV07CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdAogIH0KCiAgLyog6I635Y+W5a6i5oi356uv5b2T5YmN55qE6K+t6KiA546v5aKDICovCiAgZ2V0Q2xpZW50TGFuZyAoKSB7CiAgICByZXR1cm4gbmF2aWdhdG9yLmxhbmd1YWdlcyA/IG5hdmlnYXRvci5sYW5ndWFnZXNbMF0gOiBuYXZpZ2F0b3IubGFuZ3VhZ2UKICB9Cn0KCnZhciB6aENOID0gewogIHdlYnNpdGU6ICfwn4+g6ISa5pys5a6Y572RJywKICBhYm91dDogJ+WFs+S6jicsCiAgaXNzdWVzOiAn6Zeu6aKY5Y+N6aaIJywKICBmYXE6ICfluLjop4Hpl67popgnLAogIHNldHRpbmc6ICforr7nva4nLAogIGhvdGtleXM6ICflv6vmjbfplK4nLAogIGtleWJvYXJkQ29udHJvbDogJ+mUruebmOaOp+WIticsCiAgbW91c2VDb250cm9sOiAn6byg5qCH5o6n5Yi2JywKICBob3RrZXlzRG9jczogJ+W/q+aNt+mUruaWh+ahoycsCiAgZW5hYmxlOiAn5ZCv55SoJywKICBkaXNhYmxlOiAn56aB55SoJywKICB0b2dnbGVTdGF0ZXM6ICflkK/nlKgv56aB55SoJywKICBkaXNhYmxlSG90a2V5c1RlbXBvcmFyaWx5OiAn5Li05pe256aB55So5b+r5o236ZSuJywKICB0b2dnbGVIb3RrZXlzVGVtcG9yYXJpbHk6ICfkuLTml7blkK/nlKgv56aB55So5b+r5o236ZSuJywKICBlbmFibGVIb3RrZXlzOiAn5ZCv55So5b+r5o236ZSuJywKICBkaXNhYmxlSG90a2V5czogJ+emgeeUqOW/q+aNt+mUricsCiAgZW5hYmxlTW91c2VDb250cm9sOiAn5ZCv55So6byg5qCH5o6n5Yi2JywKICBkaXNhYmxlTW91c2VDb250cm9sOiAn56aB55So6byg5qCH5o6n5Yi2JywKICBkb25hdGU6ICfwn5GN6K+35L2c6ICF5Zad5p2v5ZKW5ZWhJywKICBhYm91dERvbmF0ZTogJzEwMOS4h+e6p+WuieijhemHj+eahOS9nOWTge+8jOacieWkmuWwkeaJk+i1j++8nycsCiAgYWJvdXRBdXRob3I6ICflhbPkuo7kvZzogIUnLAogIHJlY29tbWVuZDogJ+KdpO+4jyDlhY3otLlDaGF0R1BULTQg4p2k77iPJywKICBlbmFibGVTY3JpcHQ6ICflkK/nlKjohJrmnKwnLAogIGRpc2FibGVTY3JpcHQ6ICfnpoHnlKjohJrmnKwnLAogIGRpc2FibGVDdXJyZW50SW5zdGFuY2VHVUk6ICflhbPpl63lvZPliY3lm77lvaLnlKjmiLfnlYzpnaInLAogIGRpc2FibGVHVUlUZW1wb3JhcmlseTogJ+S4tOaXtuemgeeUqOWbvuW9oueUqOaIt+eVjOmdoicsCiAgZW5hYmxlR1VJOiAn5ZCv55So5Zu+5b2i55So5oi355WM6Z2iJywKICBkaXNhYmxlR1VJOiAn56aB55So5Zu+5b2i55So5oi355WM6Z2iJywKICBncmFwaGljYWxJbnRlcmZhY2U6ICflm77lvaLnlYzpnaInLAogIGFsd2F5c1Nob3dHcmFwaGljYWxJbnRlcmZhY2U6ICflp4vnu4jmmL7npLrlm77lvaLnlYzpnaInLAogIG9wZW5Dcm9zc09yaWdpbkZyYW1lUGFnZTogJ+WNleeLrOaJk+W8gOi3qOWfn+eahOmhtemdoicsCiAgZGlzYWJsZUluaXRBdXRvUGxheTogJ+emgeatouWcqOatpOe9keermeiHquWKqOaSreaUvuinhumikScsCiAgZW5hYmxlSW5pdEF1dG9QbGF5OiAn5YWB6K645Zyo5q2k572R56uZ6Ieq5Yqo5pKt5pS+6KeG6aKRJywKICByZXN0b3JlQ29uZmlndXJhdGlvbjogJ+i/mOWOn+WFqOWxgOeahOm7mOiupOmFjee9ricsCiAgYmxvY2tTZXRQbGF5YmFja1JhdGU6ICfnpoHnlKjpu5jorqTpgJ/luqbosIPoioLpgLvovpEnLAogIGJsb2NrU2V0Q3VycmVudFRpbWU6ICfnpoHnlKjpu5jorqTmkq3mlL7ov5vluqbmjqfliLbpgLvovpEnLAogIGJsb2NrU2V0Vm9sdW1lOiAn56aB55So6buY6K6k6Z+z6YeP5o6n5Yi26YC76L6RJywKICB1bmJsb2NrU2V0UGxheWJhY2tSYXRlOiAn5YWB6K646buY6K6k6YCf5bqm6LCD6IqC6YC76L6RJywKICB1bmJsb2NrU2V0Q3VycmVudFRpbWU6ICflhYHorrjpu5jorqTmkq3mlL7ov5vluqbmjqfliLbpgLvovpEnLAogIHVuYmxvY2tTZXRWb2x1bWU6ICflhYHorrjpu5jorqTpn7Pph4/mjqfliLbpgLvovpEnLAogIGFsbG93QWNvdXN0aWNHYWluOiAn5byA5ZCv6Z+z6YeP5aKe55uK6IO95YqbJywKICBub3RBbGxvd0Fjb3VzdGljR2FpbjogJ+emgeeUqOmfs+mHj+WinuebiuiDveWKmycsCiAgYWxsb3dDcm9zc09yaWdpbkNvbnRyb2w6ICflvIDlkK/ot6jln5/mjqfliLbog73lipsnLAogIG5vdEFsbG93Q3Jvc3NPcmlnaW5Db250cm9sOiAn56aB55So6Leo5Z+f5o6n5Yi26IO95YqbJywKICBhbGxvd0V4cGVyaW1lbnRGZWF0dXJlczogJ+W8gOWQr+WunumqjOaAp+WKn+iDvScsCiAgbm90QWxsb3dFeHBlcmltZW50RmVhdHVyZXM6ICfnpoHnlKjlrp7pqozmgKflip/og70nLAogIGV4cGVyaW1lbnRGZWF0dXJlc1dhcm5pbmc6ICflrp7pqozmgKflip/og73lrrnmmJPpgKDmiJDkuIDkupvkuI3noa7lrprnmoTpl67popjvvIzor7fosKjmhY7lvIDlkK8nLAogIHVzZU1lZGlhRG93bmxvYWRUaXBzOiAn5L2/55So5LiL6L295Yqf6IO977yM6ZyA5byA5ZCv5a6e6aqM5oCn5Yqf6IO977yMXG7lrp7pqozmgKflip/og73lrrnmmJPpgKDmiJDkuIDkupvkuI3noa7lrprnmoTpl67popjvvIznoa7lrpropoHlvIDlkK/lkJfvvJ8nLAogIGFsbG93RXh0ZXJuYWxDdXN0b21Db25maWd1cmF0aW9uOiAn5byA5ZCv5aSW6YOo6Ieq5a6a5LmJ6IO95YqbJywKICBub3RBbGxvd0V4dGVybmFsQ3VzdG9tQ29uZmlndXJhdGlvbjogJ+WFs+mXreWklumDqOiHquWumuS5ieiDveWKmycsCiAgY2hhbmdlTG9nOiAn5pu05paw5pel5b+XJywKICBjdXJyZW50VmVyc2lvbjogJ+W9k+WJjeeJiOacrCcsCiAgY2hlY2tWZXJzaW9uOiAn5qOA5p+l5piv5ZCm5pyJ5paw54mI5pys77yfJywKICBjb25maWdGYWlsOiAn6YWN572u5aSx6LSlJywKICBnbG9iYWxTZXR0aW5nOiAn5YWo5bGA6K6+572uJywKICBvcGVuQ3VzdG9tQ29uZmlndXJhdGlvbkVkaXRvcjogJ+aJk+W8gOiHquWumuS5iemFjee9rue8lui+keWZqCcsCiAgbG9jYWxTZXR0aW5nOiAn5LuF55So5LqO5q2k572R56uZJywKICBvcGVuRGVidWdNb2RlOiAn5byA5ZCv6LCD6K+V5qih5byPJywKICBjbG9zZURlYnVnTW9kZTogJ+WFs+mXreiwg+ivleaooeW8jycsCiAgdW5mb2xkTWVudTogJ+WxleW8gOiPnOWNlScsCiAgZm9sZE1lbnU6ICfmipjlj6Doj5zljZUnLAogIGFkZEdyb3VwQ2hhdDogJ/Cfkqzmt7vliqDnvqTogYonLAogIHNwZWVkOiAn5YCN6YCfJywKICBjYXB0dXJlOiAn5oiq5Zu+JywKICBkb3dubG9hZDogJ+S4i+i9vScsCiAgbWVkaWFEb3dubG9hZDogewogICAgZW5hYmxlOiAn5byA5ZCv5aqS5L2T5LiL6L29JywKICAgIGRpc2FibGU6ICflhbPpl63lqpLkvZPkuIvovb0nLAogICAgZG93bmxvYWRPcHRpb25zOiAn5LiL6L296YCJ6aG5JywKICAgIGRvd25sb2FkaW5nOiAn5paH5Lu25q2j5Zyo5LiL6L295Lit77yM56Gu5a6a6YeN5aSN5omn6KGM5q2k5pON5L2c77yfJywKICAgIGhhc0Rvd25sb2FkOiAn5paH5Lu25bey57uP5LiL6L2977yM56Gu5a6a6YeN5aSN5omn6KGM5q2k5pON5L2c77yfJywKICAgIGNvbmZpcm1UaXRsZTogJ+ivt+i+k+WFpeaWh+S7tuWQjScsCiAgICBub3RTdXBwb3J0OiAn5b2T5YmN5aqS5L2T5paH5Lu25peg5rOV5LiL6L2977yM5LiL6L295Yqf6IO95b6F5LyY5YyW5a6M5ZaEJywKICAgIG5vdEVuZE9mU3RyZWFtOiAn5aqS5L2T5pWw5o2u6L+Y5rKh5a6M5YWo5bCx57uq77yM56Gu5a6a6KaB5omn6KGM5LiL6L295pON5L2c77yfJywKICAgIGNhbmNlbEF1dG9Eb3dubG9hZDogJ+aYr+WQpuWPlua2iOiHquWKqOS4i+i9ve+8nycsCiAgICBhdXRvRG93bmxvYWQ6ICflqpLkvZPmlbDmja7lrozlhajlsLHnu6rlkI7vvIzmmK/lkKboh6rliqjkuIvovb3vvJ8nLAogICAgbm90Rm91bmRNZWRpYVNvdXJjZTogJ+acquaJvuWIsOWvueW6lOeahOWqkuS9k+a1geaVsOaNru+8jOaVsOaNruWPr+iDveiiq+a4heeQhuaIluiAheWqkuS9k+WFg+e0oOW3sue7j+iiq+enu+mZpO+8jOW7uuiuruWIt+aWsOmhtemdouWQjumHjeivlScKICB9LAogIG1lbnU6ICfoj5zljZUnLAogIG1vcmU6ICfmm7TlpJonLAogIG1vcmVBY3Rpb25zOiAn5pu05aSa5pON5L2cJywKICB2aWRlb0ZpbHRlcjogJ+eUu+mdoua7pOmVnCcsCiAgcmVzZXRGaWx0ZXJBbmRUcmFuc2Zvcm06ICflm77lg4/lpI3kvY0nLAogIGJyaWdodG5lc3NVcDogJ+WinuWKoOS6ruW6picsCiAgYnJpZ2h0bmVzc0Rvd246ICflh4/lsJHkuq7luqYnLAogIGNvbnRyYXN0VXA6ICflop7liqDlr7nmr5TluqYnLAogIGNvbnRyYXN0RG93bjogJ+WHj+WwkeWvueavlOW6picsCiAgc2F0dXJhdGlvblVwOiAn5aKe5Yqg6aWx5ZKM5bqmJywKICBzYXR1cmF0aW9uRG93bjogJ+WHj+WwkemlseWSjOW6picsCiAgaHVlVXA6ICflop7liqDoibLnm7gnLAogIGh1ZURvd246ICflh4/lsJHoibLnm7gnLAogIGJsdXJVcDogJ+WinuWKoOaooeeziuW6picsCiAgYmx1ckRvd246ICflh4/lsJHmqKHns4rluqYnLAogIHJvdGF0ZUFuZE1pcnJvcjogJ+aXi+i9rOmVnOWDjycsCiAgcm90YXRlOTA6ICfnlLvpnaLml4vovawgOTAg5bqmJywKICBob3Jpem9udGFsTWlycm9yOiAn55S76Z2i5rC05bmz6ZWc5YOP57+76L2sJywKICB2ZXJ0aWNhbE1pcnJvcjogJ+eUu+mdouWeguebtOmVnOWDj+e/u+i9rCcsCiAgdmlkZW9UcmFuc2Zvcm06ICfnlLvpnaLkvY3np7snLAogIHRyYW5zbGF0ZVJpZ2h0OiAn55S76Z2i5ZCR5Y+z56e75YqoJywKICB0cmFuc2xhdGVMZWZ0OiAn55S76Z2i5ZCR5bem56e75YqoJywKICB0cmFuc2xhdGVVcDogJ+eUu+mdouWQkeS4iuenu+WKqCcsCiAgdHJhbnNsYXRlRG93bjogJ+eUu+mdouWQkeS4i+enu+WKqCcsCiAgbGFuZ3VhZ2VTZXR0aW5nczogJ+ivreiogOiuvue9ricsCiAgZGVmYXVsdDogJ+m7mOiupCcsCiAgYXV0b0Nob29zZTogJ+iHquWKqOmAieaLqScsCiAgY29taW5nU29vbjogJ+abtOWkmuWKn+iDveato+WcqOWujOWWhOS4re+8jOaVrOivt+acn+W+hScsCiAgZmZtcGVnU2NyaXB0OiAn6Z+z6KeG6aKR5ZCI5bm2L+i9rOaNouiEmuacrCcsCiAgYXV0b0dvdG9CdWZmZXJlZFRpbWU6ICfoh6rliqjot5/pmo/ot7PovazliLDnvJPlhrLljLrml7bpl7QnLAogIGRpc2FibGVBdXRvR290b0J1ZmZlcmVkVGltZTogJ+emgeeUqOiHquWKqOi3n+maj+i3s+i9rOWIsOe8k+WGsuWMuuaXtumXtCcsCiAgbW91c2U6IHsKICAgIGVuYWJsZTogJ+WQr+eUqOm8oOagh+aOp+WIticsCiAgICBkaXNhYmxlOiAn56aB55So6byg5qCH5o6n5Yi2JywKICAgIGxvbmdQcmVzc1RpbWU6ICfplb/mjInlpJrkuYXlk43lupTpvKDmoIfplb/mjInkuovku7YnCiAgfSwKICB0aXBzTXNnOiB7CiAgICBwbGF5c3BlZWQ6ICfmkq3mlL7pgJ/luqbvvJonLAogICAgZm9yd2FyZDogJ+WJjei/m++8micsCiAgICBiYWNrd2FyZDogJ+WQjumAgO+8micsCiAgICBzZWNvbmRzOiAn56eSJywKICAgIHZvbHVtZTogJ+mfs+mHj++8micsCiAgICBuZXh0ZnJhbWU6ICflrprkvY3vvJrkuIvkuIDluKcnLAogICAgcHJldmlvdXNmcmFtZTogJ+WumuS9je+8muS4iuS4gOW4pycsCiAgICBzdG9wZnJhbWU6ICflrprmoLzluKfnlLvpnaLvvJonLAogICAgcGxheTogJ+aSreaUvicsCiAgICBwYXVzZTogJ+aaguWBnCcsCiAgICBhcnBsOiAn5YWB6K646Ieq5Yqo5oGi5aSN5pKt5pS+6L+b5bqmJywKICAgIGRycGw6ICfnpoHmraLoh6rliqjmgaLlpI3mkq3mlL7ov5vluqYnLAogICAgYnJpZ2h0bmVzczogJ+WbvuWDj+S6ruW6pu+8micsCiAgICBjb250cmFzdDogJ+WbvuWDj+WvueavlOW6pu+8micsCiAgICBzYXR1cmF0aW9uOiAn5Zu+5YOP6aWx5ZKM5bqm77yaJywKICAgIGh1ZTogJ+WbvuWDj+iJsuebuO+8micsCiAgICBibHVyOiAn5Zu+5YOP5qih57OK5bqm77yaJywKICAgIGltZ2F0dHJyZXNldDogJ+WbvuWDj+WxnuaAp++8muWkjeS9jScsCiAgICBpbWdyb3RhdGU6ICfnlLvpnaLml4vovazvvJonLAogICAgb25wbHVnaW46ICflkK/nlKhoNVBsYXllcuaPkuS7ticsCiAgICBvZmZwbHVnaW46ICfnpoHnlKhoNVBsYXllcuaPkuS7ticsCiAgICBnbG9iYWxtb2RlOiAn5YWo5bGA5qih5byP77yaJywKICAgIHBsYXliYWNrcmVzdG9yZWQ6ICfkuLrkvaDmgaLlpI3kuIrmrKHmkq3mlL7ov5vluqYnLAogICAgcGxheWJhY2tyZXN0b3Jlb2ZmOiAn5oGi5aSN5pKt5pS+6L+b5bqm5Yqf6IO95bey56aB55So77yM5oyJIFNISUZUK1Ig5Y+v5byA5ZCv6K+l5Yqf6IO9JywKICAgIGhvcml6b250YWw6ICfmsLTlubPkvY3np7vvvJonLAogICAgdmVydGljYWw6ICflnoLnm7TkvY3np7vvvJonLAogICAgaG9yaXpvbnRhbE1pcnJvcjogJ+awtOW5s+mVnOWDjycsCiAgICB2ZXJ0aWNhbE1pcnJvcjogJ+WeguebtOmVnOWDjycsCiAgICB2aWRlb3pvb206ICfop4bpopHnvKnmlL7njofvvJonCiAgfSwKICBmYXFMaXN0OiB7CiAgICAvLwogIH0KfTsKCnZhciBlblVTID0gewogIHdlYnNpdGU6ICfwn4+gU2NyaXB0IEhvbWVwYWdlJywKICBhYm91dDogJ0Fib3V0JywKICBpc3N1ZXM6ICdJc3N1ZXMnLAogIGZhcTogJ0ZBUScsCiAgc2V0dGluZzogJ1NldHRpbmcnLAogIGhvdGtleXM6ICdIb3RrZXlzJywKICBrZXlib2FyZENvbnRyb2w6ICdLZXlib2FyZCBDb250cm9sJywKICBtb3VzZUNvbnRyb2w6ICdNb3VzZSBDb250cm9sJywKICBob3RrZXlzRG9jczogJ0hvdGtleXMgRG9jcycsCiAgZW5hYmxlOiAnRW5hYmxlJywKICBkaXNhYmxlOiAnRGlzYWJsZScsCiAgdG9nZ2xlU3RhdGVzOiAnRW5hYmxlL0Rpc2FibGUnLAogIGRpc2FibGVIb3RrZXlzVGVtcG9yYXJpbHk6ICdEaXNhYmxlIGhvdGtleXMgdGVtcG9yYXJpbHknLAogIHRvZ2dsZUhvdGtleXNUZW1wb3JhcmlseTogJ1RvZ2dsZSBob3RrZXlzIHRlbXBvcmFyaWx5JywKICBlbmFibGVIb3RrZXlzOiAnRW5hYmxlIGhvdGtleXMnLAogIGRpc2FibGVIb3RrZXlzOiAnRGlzYWJsZSBob3RrZXlzJywKICBkb25hdGU6ICfwn5GNRG9uYXRlJywKICBhYm91dERvbmF0ZTogJ0hvdyBtdWNoIHRoZSBhdXRob3IgaGFzIHJlY2VpdmVkPycsCiAgYWJvdXRBdXRob3I6ICdBYm91dCB0aGUgYXV0aG9yJywKICBlbmFibGVTY3JpcHQ6ICdFbmFibGUgc2NyaXB0JywKICBkaXNhYmxlU2NyaXB0OiAnRGlzYWJsZSBzY3JpcHQnLAogIGRpc2FibGVDdXJyZW50SW5zdGFuY2VHVUk6ICdDbG9zZSB0aGUgY3VycmVudCBncmFwaGljYWwgdXNlciBpbnRlcmZhY2UnLAogIGRpc2FibGVHVUlUZW1wb3JhcmlseTogJ1RlbXBvcmFyaWx5IGRpc2FibGUgdGhlIGdyYXBoaWNhbCBpbnRlcmZhY2UnLAogIGVuYWJsZUdVSTogJ0VuYWJsZSBHcmFwaGljYWwgVXNlciBJbnRlcmZhY2UnLAogIGRpc2FibGVHVUk6ICdEaXNhYmxlIEdyYXBoaWNhbCBVc2VyIEludGVyZmFjZScsCiAgZ3JhcGhpY2FsSW50ZXJmYWNlOiAnR3JhcGhpY2FsIEludGVyZmFjZScsCiAgYWx3YXlzU2hvd0dyYXBoaWNhbEludGVyZmFjZTogJ0Fsd2F5cyBzaG93IGdyYXBoaWNhbCBpbnRlcmZhY2UnLAogIG9wZW5Dcm9zc09yaWdpbkZyYW1lUGFnZTogJ09wZW4gY3Jvc3MtZG9tYWluIHBhZ2VzIGFsb25lJywKICBkaXNhYmxlSW5pdEF1dG9QbGF5OiAnUHJvaGliaXQgYXV0b3BsYXkgb2YgdmlkZW9zIG9uIHRoaXMgc2l0ZScsCiAgZW5hYmxlSW5pdEF1dG9QbGF5OiAnQWxsb3cgYXV0b3BsYXkgdmlkZW9zIG9uIHRoaXMgc2l0ZScsCiAgcmVzdG9yZUNvbmZpZ3VyYXRpb246ICdSZXN0b3JlIHRoZSBnbG9iYWwgZGVmYXVsdCBjb25maWd1cmF0aW9uJywKICBibG9ja1NldFBsYXliYWNrUmF0ZTogJ0Rpc2FibGUgZGVmYXVsdCBzcGVlZCByZWd1bGF0aW9uIGxvZ2ljJywKICBibG9ja1NldEN1cnJlbnRUaW1lOiAnRGlzYWJsZSBkZWZhdWx0IHBsYXliYWNrIHByb2dyZXNzIGNvbnRyb2wgbG9naWMnLAogIGJsb2NrU2V0Vm9sdW1lOiAnRGlzYWJsZSBkZWZhdWx0IHZvbHVtZSBjb250cm9sIGxvZ2ljJywKICB1bmJsb2NrU2V0UGxheWJhY2tSYXRlOiAnQWxsb3cgZGVmYXVsdCBzcGVlZCBhZGp1c3RtZW50IGxvZ2ljJywKICB1bmJsb2NrU2V0Q3VycmVudFRpbWU6ICdBbGxvdyBkZWZhdWx0IHBsYXliYWNrIHByb2dyZXNzIGNvbnRyb2wgbG9naWMnLAogIHVuYmxvY2tTZXRWb2x1bWU6ICdBbGxvdyBkZWZhdWx0IHZvbHVtZSBjb250cm9sIGxvZ2ljJywKICBhbGxvd0Fjb3VzdGljR2FpbjogJ1R1cm4gb24gdm9sdW1lIGJvb3N0JywKICBub3RBbGxvd0Fjb3VzdGljR2FpbjogJ0Rpc2FibGUgdm9sdW1lIGJvb3N0IGFiaWxpdHknLAogIGFsbG93Q3Jvc3NPcmlnaW5Db250cm9sOiAnRW5hYmxlIGNyb3NzLWRvbWFpbiBjb250cm9sIGNhcGFiaWxpdHknLAogIG5vdEFsbG93Q3Jvc3NPcmlnaW5Db250cm9sOiAnRGlzYWJsZSBjcm9zcy1kb21haW4gY29udHJvbCBjYXBhYmlsaXRpZXMnLAogIGFsbG93RXhwZXJpbWVudEZlYXR1cmVzOiAnVHVybiBvbiBleHBlcmltZW50YWwgZmVhdHVyZXMnLAogIG5vdEFsbG93RXhwZXJpbWVudEZlYXR1cmVzOiAnRGlzYWJsZSBleHBlcmltZW50YWwgZmVhdHVyZXMnLAogIGV4cGVyaW1lbnRGZWF0dXJlc1dhcm5pbmc6ICdFeHBlcmltZW50YWwgZmVhdHVyZXMgYXJlIGxpa2VseSB0byBjYXVzZSBzb21lIHVuY2VydGFpbiBwcm9ibGVtcywgcGxlYXNlIHR1cm4gb24gd2l0aCBjYXV0aW9uJywKICB1c2VNZWRpYURvd25sb2FkVGlwczogJ1RvIHVzZSB0aGUgZG93bmxvYWQgY2FwYWJpbGl0eSwgeW91IG5lZWQgdG8gZW5hYmxlIGV4cGVyaW1lbnRhbCBmZWF0dXJlcy5cbkV4cGVyaW1lbnRhbCBmZWF0dXJlcyBjYW4gZWFzaWx5IGNhdXNlIHNvbWUgdW5jZXJ0YWluIHByb2JsZW1zLiBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZW5hYmxlIGl0PycsCiAgYWxsb3dFeHRlcm5hbEN1c3RvbUNvbmZpZ3VyYXRpb246ICdFbmFibGUgZXh0ZXJuYWwgY3VzdG9taXphdGlvbiBjYXBhYmlsaXRpZXMnLAogIG5vdEFsbG93RXh0ZXJuYWxDdXN0b21Db25maWd1cmF0aW9uOiAnVHVybiBvZmYgZXh0ZXJuYWwgY3VzdG9taXphdGlvbiBjYXBhYmlsaXRpZXMnLAogIGNoYW5nZUxvZzogJ0NoYW5nZSBsb2cnLAogIGN1cnJlbnRWZXJzaW9uOiAnQ3VycmVudCB2ZXJzaW9uJywKICBjaGVja1ZlcnNpb246ICdDaGVjayBmb3IgbmV3IHZlcnNpb24gPycsCiAgY29uZmlnRmFpbDogJ0NvbmZpZ3VyYXRpb24gZmFpbGVkJywKICBnbG9iYWxTZXR0aW5nOiAnR2xvYmFsIFNldHRpbmdzJywKICBvcGVuQ3VzdG9tQ29uZmlndXJhdGlvbkVkaXRvcjogJ09wZW4gY3VzdG9tIGNvbmZpZ3VyYXRpb24gZWRpdG9yJywKICBsb2NhbFNldHRpbmc6ICdGb3IgdGhpcyBzaXRlIG9ubHknLAogIG9wZW5EZWJ1Z01vZGU6ICdFbmFibGUgZGVidWcgbW9kZScsCiAgY2xvc2VEZWJ1Z01vZGU6ICdUdXJuIG9mZiBkZWJ1ZyBtb2RlJywKICB1bmZvbGRNZW51OiAnRXhwYW5kIG1lbnUnLAogIGZvbGRNZW51OiAnQ29sbGFwc2UgbWVudScsCiAgYWRkR3JvdXBDaGF0OiAn8J+SrEFkZCBjaGF0IGdyb3VwJywKICBzcGVlZDogJ1NwZWVkJywKICBjYXB0dXJlOiAnQ2FwdHVyZScsCiAgZG93bmxvYWQ6ICdEb3dubG9hZCcsCiAgbWVkaWFEb3dubG9hZDogewogICAgZW5hYmxlOiAnRW5hYmxlIG1lZGlhIGRvd25sb2FkJywKICAgIGRpc2FibGU6ICdEaXNhYmxlIG1lZGlhIGRvd25sb2FkJywKICAgIGRvd25sb2FkT3B0aW9uczogJ0Rvd25sb2FkIG9wdGlvbnMnLAogICAgZG93bmxvYWRpbmc6ICdUaGUgZmlsZSBpcyBiZWluZyBkb3dubG9hZGVkLiBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZXhlY3V0ZSB0aGlzIG9wZXJhdGlvbiBhZ2Fpbj8nLAogICAgaGFzRG93bmxvYWQ6ICdUaGUgZmlsZSBoYXMgYmVlbiBkb3dubG9hZGVkLiBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZXhlY3V0ZSB0aGlzIG9wZXJhdGlvbiBhZ2Fpbj8nLAogICAgY29uZmlybVRpdGxlOiAnUGxlYXNlIGVudGVyIHRoZSBmaWxlIG5hbWUnLAogICAgbm90U3VwcG9ydDogJ1RoZSBjdXJyZW50IG1lZGlhIGZpbGUgY2Fubm90IGJlIGRvd25sb2FkZWQuIFRoZSBkb3dubG9hZCBmdW5jdGlvbiBuZWVkcyB0byBiZSBvcHRpbWl6ZWQgYW5kIGltcHJvdmVkJywKICAgIG5vdEVuZE9mU3RyZWFtOiAnVGhlIG1lZGlhIGRhdGEgaXMgbm90IGZ1bGx5IHJlYWR5LCBhcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZG93bmxvYWQgaXQ/JywKICAgIGNhbmNlbEF1dG9Eb3dubG9hZDogJ0NhbmNlbCBhdXRvbWF0aWMgZG93bmxvYWQ/JywKICAgIGF1dG9Eb3dubG9hZDogJ1RoZSBtZWRpYSBkYXRhIGlzIG5vdCBmdWxseSByZWFkeSwgZG8geW91IHdhbnQgdG8gYXV0b21hdGljYWxseSBkb3dubG9hZCBpdCB3aGVuIGl0IGlzIHJlYWR5PycsCiAgICBub3RGb3VuZE1lZGlhU291cmNlOiAnVGhlIGNvcnJlc3BvbmRpbmcgbWVkaWEgc3RyZWFtIGRhdGEgd2FzIG5vdCBmb3VuZCwgdGhlIGRhdGEgbWF5IGhhdmUgYmVlbiBjbGVhcmVkIG9yIHRoZSBtZWRpYSBlbGVtZW50IGhhcyBiZWVuIHJlbW92ZWQsIGl0IGlzIHJlY29tbWVuZGVkIHRvIHJlZnJlc2ggdGhlIHBhZ2UgYW5kIHRyeSBhZ2FpbicKICB9LAogIG1lbnU6ICdNZW51JywKICBtb3JlOiAnTW9yZScsCiAgbW9yZUFjdGlvbnM6ICdNb3JlIGFjdGlvbnMnLAogIHZpZGVvRmlsdGVyOiAnVmlkZW8gZmlsdGVyJywKICByZXNldEZpbHRlckFuZFRyYW5zZm9ybTogJ1Jlc2V0IGZpbHRlciBhbmQgdHJhbnNmb3JtJywKICBicmlnaHRuZXNzVXA6ICdJbmNyZWFzZSBicmlnaHRuZXNzJywKICBicmlnaHRuZXNzRG93bjogJ0RlY3JlYXNlIGJyaWdodG5lc3MnLAogIGNvbnRyYXN0VXA6ICdJbmNyZWFzZSBjb250cmFzdCcsCiAgY29udHJhc3REb3duOiAnRGVjcmVhc2UgY29udHJhc3QnLAogIHNhdHVyYXRpb25VcDogJ0luY3JlYXNlIHNhdHVyYXRpb24nLAogIHNhdHVyYXRpb25Eb3duOiAnRGVjcmVhc2Ugc2F0dXJhdGlvbicsCiAgaHVlVXA6ICdJbmNyZWFzZSBodWUnLAogIGh1ZURvd246ICdEZWNyZWFzZSBodWUnLAogIGJsdXJVcDogJ0luY3JlYXNlIGJsdXInLAogIGJsdXJEb3duOiAnRGVjcmVhc2UgYmx1cicsCiAgcm90YXRlQW5kTWlycm9yOiAnUm90YXRlIGFuZCBtaXJyb3InLAogIHJvdGF0ZTkwOiAnUm90YXRlIDkwIGRlZ3JlZXMnLAogIGhvcml6b250YWxNaXJyb3I6ICdIb3Jpem9udGFsIG1pcnJvciBmbGlwJywKICB2ZXJ0aWNhbE1pcnJvcjogJ1ZlcnRpY2FsIG1pcnJvciBmbGlwJywKICB2aWRlb1RyYW5zZm9ybTogJ1ZpZGVvIGRpc3BsYWNlbWVudCcsCiAgdHJhbnNsYXRlUmlnaHQ6ICdNb3ZlIHRoZSBzY3JlZW4gdG8gdGhlIHJpZ2h0JywKICB0cmFuc2xhdGVMZWZ0OiAnTW92ZSB0aGUgc2NyZWVuIHRvIHRoZSBsZWZ0JywKICB0cmFuc2xhdGVVcDogJ01vdmUgdGhlIHNjcmVlbiB1cCcsCiAgdHJhbnNsYXRlRG93bjogJ01vdmUgdGhlIHNjcmVlbiBkb3duJywKICBsYW5ndWFnZVNldHRpbmdzOiAnTGFuZ3VhZ2Ugc2V0dGluZ3MnLAogIGRlZmF1bHQ6ICdEZWZhdWx0JywKICBhdXRvQ2hvb3NlOiAnQXV0byBjaG9vc2UnLAogIGNvbWluZ1Nvb246ICdNb3JlIGZlYXR1cmVzIGFyZSBiZWluZyBpbXByb3ZlZCwgc3RheSB0dW5lZCcsCiAgZmZtcGVnU2NyaXB0OiAnQXVkaW8gYW5kIHZpZGVvIG1lcmdlL2NvbnZlcnQgc2NyaXB0JywKICBhdXRvR290b0J1ZmZlcmVkVGltZTogJ0F1dG9tYXRpY2FsbHkganVtcCB0byB0aGUgYnVmZmVyZWQgdGltZScsCiAgZGlzYWJsZUF1dG9Hb3RvQnVmZmVyZWRUaW1lOiAnRGlzYWJsZSBhdXRvbWF0aWMganVtcCB0byB0aGUgYnVmZmVyZWQgdGltZScsCiAgbW91c2U6IHsKICAgIGVuYWJsZTogJ0VuYWJsZSBtb3VzZSBjb250cm9sJywKICAgIGRpc2FibGU6ICdEaXNhYmxlIG1vdXNlIGNvbnRyb2wnLAogICAgbG9uZ1ByZXNzVGltZTogJ0hvdyBsb25nIHRvIHJlc3BvbmQgdG8gbW91c2UgbG9uZyBwcmVzcyBldmVudHMnCiAgfSwKICB0aXBzTXNnOiB7CiAgICBwbGF5c3BlZWQ6ICdTcGVlZDogJywKICAgIGZvcndhcmQ6ICdGb3J3YXJkOiAnLAogICAgYmFja3dhcmQ6ICdCYWNrd2FyZDogJywKICAgIHNlY29uZHM6ICdzZWMnLAogICAgdm9sdW1lOiAnVm9sdW1lOiAnLAogICAgbmV4dGZyYW1lOiAnTmV4dCBmcmFtZScsCiAgICBwcmV2aW91c2ZyYW1lOiAnUHJldmlvdXMgZnJhbWUnLAogICAgc3RvcGZyYW1lOiAnU3RvcGZyYW1lOiAnLAogICAgcGxheTogJ1BsYXknLAogICAgcGF1c2U6ICdQYXVzZScsCiAgICBhcnBsOiAnQWxsb3cgYXV0byByZXN1bWUgcGxheWJhY2sgcHJvZ3Jlc3MnLAogICAgZHJwbDogJ0Rpc2FibGUgYXV0byByZXN1bWUgcGxheWJhY2sgcHJvZ3Jlc3MnLAogICAgYnJpZ2h0bmVzczogJ0JyaWdodG5lc3M6ICcsCiAgICBjb250cmFzdDogJ0NvbnRyYXN0OiAnLAogICAgc2F0dXJhdGlvbjogJ1NhdHVyYXRpb246ICcsCiAgICBodWU6ICdIVUU6ICcsCiAgICBibHVyOiAnQmx1cjogJywKICAgIGltZ2F0dHJyZXNldDogJ0F0dHJpYnV0ZXM6IHJlc2V0JywKICAgIGltZ3JvdGF0ZTogJ1BpY3R1cmUgcm90YXRpb246ICcsCiAgICBvbnBsdWdpbjogJ09OIGg1UGxheWVyIHBsdWdpbicsCiAgICBvZmZwbHVnaW46ICdPRkYgaDVQbGF5ZXIgcGx1Z2luJywKICAgIGdsb2JhbG1vZGU6ICdHbG9iYWwgbW9kZTogJywKICAgIHBsYXliYWNrcmVzdG9yZWQ6ICdSZXN0b3JlZCB0aGUgbGFzdCBwbGF5YmFjayBwcm9ncmVzcyBmb3IgeW91JywKICAgIHBsYXliYWNrcmVzdG9yZW9mZjogJ1RoZSBmdW5jdGlvbiBvZiByZXN0b3JpbmcgdGhlIHBsYXliYWNrIHByb2dyZXNzIGlzIGRpc2FibGVkLiBQcmVzcyBTSElGVCtSIHRvIHR1cm4gb24gdGhlIGZ1bmN0aW9uJywKICAgIGhvcml6b250YWw6ICdIb3Jpem9udGFsIGRpc3BsYWNlbWVudDogJywKICAgIHZlcnRpY2FsOiAnVmVydGljYWwgZGlzcGxhY2VtZW50OiAnLAogICAgaG9yaXpvbnRhbE1pcnJvcjogJ0hvcml6b250YWwgbWlycm9yJywKICAgIHZlcnRpY2FsTWlycm9yOiAndmVydGljYWwgbWlycm9yJywKICAgIHZpZGVvem9vbTogJ1ZpZGVvIHpvb206ICcKICB9LAogIGRlbW86ICdkZW1vLXRlc3QnCn07Cgp2YXIgcnUgPSB7CiAgd2Vic2l0ZTogJ/Cfj6DQvtGE0LjRhtC40LDQu9GM0L3Ri9C5INGB0LDQudGCINGB0LrRgNC40L/RgtCwJywKICBhYm91dDogJ9C+0LrQvtC70L4nLAogIGlzc3VlczogJ9C+0LHRgNCw0YLQvdCw0Y8g0YHQstGP0LfRjCcsCiAgZmFxOiAn0YfQsNGB0YLQviDQt9Cw0LTQsNCy0LDQtdC80YvQtSDQstC+0L/RgNC+0YHRiycsCiAgc2V0dGluZzogJ9GD0YHRgtCw0L3QvtCy0LrQsCcsCiAgaG90a2V5czogJ9Cz0L7RgNGP0YfQuNC1INC60LvQsNCy0LjRiNC4JywKICBrZXlib2FyZENvbnRyb2w6ICfRg9C/0YDQsNCy0LvQtdC90LjQtSDQutC70LDQstC40LDRgtGD0YDQvtC5JywKICBtb3VzZUNvbnRyb2w6ICfRg9C/0YDQsNCy0LvQtdC90LjQtSDQvNGL0YjRjNGOJywKICBob3RrZXlzRG9jczogJ9C00L7QutGD0LzQtdC90YLRiyDQs9C+0YDRj9GH0LjRhSDQutC70LDQstC40YgnLAogIGVuYWJsZTogJ9Cy0LrQu9GO0YfQuNGC0YwnLAogIGRpc2FibGU6ICfQvtGC0LrQu9GO0YfQuNGC0YwnLAogIHRvZ2dsZVN0YXRlczogJ9Cy0LrQu9GO0YfQuNGC0Ywv0L7RgtC60LvRjtGH0LjRgtGMJywKICBkaXNhYmxlSG90a2V5c1RlbXBvcmFyaWx5OiAn0LLRgNC10LzQtdC90L3QviDQvtGC0LrQu9GO0YfQuNGC0Ywg0LPQvtGA0Y/Rh9C40LUg0LrQu9Cw0LLQuNGI0LgnLAogIHRvZ2dsZUhvdGtleXNUZW1wb3JhcmlseTogJ9Cy0YDQtdC80LXQvdC90L4g0LLQutC70Y7Rh9C40YLRjC/QvtGC0LrQu9GO0YfQuNGC0Ywg0LPQvtGA0Y/Rh9C40LUg0LrQu9Cw0LLQuNGI0LgnLAogIGVuYWJsZUhvdGtleXM6ICfQstC60LvRjtGH0LjRgtGMINCz0L7RgNGP0YfQuNC1INC60LvQsNCy0LjRiNC4JywKICBkaXNhYmxlSG90a2V5czogJ9C+0YLQutC70Y7Rh9C40YLRjCDQs9C+0YDRj9GH0LjQtSDQutC70LDQstC40YjQuCcsCiAgZG9uYXRlOiAn8J+RjdC/0L7QttC10YDRgtCy0L7QstCw0YLRjCcsCiAgYWJvdXREb25hdGU6ICfQodC60L7Qu9GM0LrQviDQsNCy0YLQvtGAINC/0L7Qu9GD0YfQuNC7PycsCiAgYWJvdXRBdXRob3I6ICfQviDQsNCy0YLQvtGA0LUnLAogIGVuYWJsZVNjcmlwdDogJ9Cy0LrQu9GO0YfQuNGC0Ywg0YHQutGA0LjQv9GCJywKICBkaXNhYmxlU2NyaXB0OiAn0L7RgtC60LvRjtGH0LjRgtGMINGB0LrRgNC40L/RgicsCiAgZGlzYWJsZUN1cnJlbnRJbnN0YW5jZUdVSTogJ9C+0YLQutC70Y7Rh9C40YLRjCDRgtC10LrRg9GJ0LjQuSDQs9GA0LDRhNC40YfQtdGB0LrQuNC5INC40L3RgtC10YDRhNC10LnRgSDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y8nLAogIGRpc2FibGVHVUlUZW1wb3JhcmlseTogJ9CS0YDQtdC80LXQvdC90L4g0L7RgtC60LvRjtGH0LjRgtGMINCz0YDQsNGE0LjRh9C10YHQutC40Lkg0LjQvdGC0LXRgNGE0LXQudGBINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjycsCiAgZW5hYmxlR1VJOiAn0JLQutC70Y7Rh9C40YLRjCDQs9GA0LDRhNC40YfQtdGB0LrQuNC5INC40L3RgtC10YDRhNC10LnRgSDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y8nLAogIGRpc2FibGVHVUk6ICfQntGC0LrQu9GO0YfQuNGC0Ywg0LPRgNCw0YTQuNGH0LXRgdC60LjQuSDQuNC90YLQtdGA0YTQtdC50YEg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPJywKICBncmFwaGljYWxJbnRlcmZhY2U6ICfQk9GA0LDRhNC40YfQtdGB0LrQuNC5INC40L3RgtC10YDRhNC10LnRgScsCiAgYWx3YXlzU2hvd0dyYXBoaWNhbEludGVyZmFjZTogJ9CS0YHQtdCz0LTQsCDQv9C+0LrQsNC30YvQstCw0YLRjCDQs9GA0LDRhNC40YfQtdGB0LrQuNC5INC40L3RgtC10YDRhNC10LnRgScsCiAgb3BlbkNyb3NzT3JpZ2luRnJhbWVQYWdlOiAn0J7RgtC60YDRi9Cy0LDRgtGMINGC0L7Qu9GM0LrQviDQvNC10LbQtNC+0LzQtdC90L3Ri9C1INGB0YLRgNCw0L3QuNGG0YsnLAogIGRpc2FibGVJbml0QXV0b1BsYXk6ICfQl9Cw0L/RgNC10YLQuNGC0Ywg0LDQstGC0L7QstC+0YHQv9GA0L7QuNC30LLQtdC00LXQvdC40LUg0LLQuNC00LXQviDQvdCwINGN0YLQvtC8INGB0LDQudGC0LUnLAogIGVuYWJsZUluaXRBdXRvUGxheTogJ9Cg0LDQt9GA0LXRiNC40YLRjCDQsNCy0YLQvtC80LDRgtC40YfQtdGB0LrQvtC1INCy0L7RgdC/0YDQvtC40LfQstC10LTQtdC90LjQtSDQstC40LTQtdC+INC90LAg0Y3RgtC+0Lwg0YHQsNC50YLQtScsCiAgcmVzdG9yZUNvbmZpZ3VyYXRpb246ICfQktC+0YHRgdGC0LDQvdC+0LLQuNGC0Ywg0LPQu9C+0LHQsNC70YzQvdGD0Y4g0LrQvtC90YTQuNCz0YPRgNCw0YbQuNGOINC/0L4g0YPQvNC+0LvRh9Cw0L3QuNGOJywKICBibG9ja1NldFBsYXliYWNrUmF0ZTogJ9Ce0YLQutC70Y7Rh9C40YLRjCDQu9C+0LPQuNC60YMg0YDQtdCz0YPQu9C40YDQvtCy0LDQvdC40Y8g0YHQutC+0YDQvtGB0YLQuCDQv9C+INGD0LzQvtC70YfQsNC90LjRjicsCiAgYmxvY2tTZXRDdXJyZW50VGltZTogJ9Ce0YLQutC70Y7Rh9C40YLRjCDQu9C+0LPQuNC60YMg0YPQv9GA0LDQstC70LXQvdC40Y8g0YXQvtC00L7QvCDQstC+0YHQv9GA0L7QuNC30LLQtdC00LXQvdC40Y8g0L/QviDRg9C80L7Qu9GH0LDQvdC40Y4nLAogIGJsb2NrU2V0Vm9sdW1lOiAn0J7RgtC60LvRjtGH0LjRgtGMINC70L7Qs9C40LrRgyDRg9C/0YDQsNCy0LvQtdC90LjRjyDQs9GA0L7QvNC60L7RgdGC0YzRjiDQv9C+INGD0LzQvtC70YfQsNC90LjRjicsCiAgdW5ibG9ja1NldFBsYXliYWNrUmF0ZTogJ9Cg0LDQt9GA0LXRiNC40YLRjCDQu9C+0LPQuNC60YMg0YDQtdCz0YPQu9C40YDQvtCy0LrQuCDRgdC60L7RgNC+0YHRgtC4INC/0L4g0YPQvNC+0LvRh9Cw0L3QuNGOJywKICB1bmJsb2NrU2V0Q3VycmVudFRpbWU6ICfQoNCw0LfRgNC10YjQuNGC0Ywg0LvQvtCz0LjQutGDINGD0L/RgNCw0LLQu9C10L3QuNGPINGF0L7QtNC+0Lwg0LLQvtGB0L/RgNC+0LjQt9Cy0LXQtNC10L3QuNGPINC/0L4g0YPQvNC+0LvRh9Cw0L3QuNGOJywKICB1bmJsb2NrU2V0Vm9sdW1lOiAn0KDQsNC30YDQtdGI0LjRgtGMINC70L7Qs9C40LrRgyDRg9C/0YDQsNCy0LvQtdC90LjRjyDQs9GA0L7QvNC60L7RgdGC0YzRjiDQv9C+INGD0LzQvtC70YfQsNC90LjRjicsCiAgYWxsb3dBY291c3RpY0dhaW46ICfQktC60LvRjtGH0LjRgtC1INGD0YHQuNC70LXQvdC40LUg0LPRgNC+0LzQutC+0YHRgtC4JywKICBub3RBbGxvd0Fjb3VzdGljR2FpbjogJ9Ce0YLQutC70Y7Rh9C40YLRjCDQstC+0LfQvNC+0LbQvdC+0YHRgtGMINGD0LLQtdC70LjRh9C10L3QuNGPINCz0YDQvtC80LrQvtGB0YLQuCcsCiAgYWxsb3dDcm9zc09yaWdpbkNvbnRyb2w6ICfQktC60LvRjtGH0LjRgtGMINCy0L7Qt9C80L7QttC90L7RgdGC0Ywg0LzQtdC20LTQvtC80LXQvdC90L7Qs9C+INC60L7QvdGC0YDQvtC70Y8nLAogIG5vdEFsbG93Q3Jvc3NPcmlnaW5Db250cm9sOiAn0J7RgtC60LvRjtGH0LjRgtGMINCy0L7Qt9C80L7QttC90L7RgdGC0Lgg0LzQtdC20LTQvtC80LXQvdC90L7Qs9C+INC60L7QvdGC0YDQvtC70Y8nLAogIGFsbG93RXhwZXJpbWVudEZlYXR1cmVzOiAn0JLQutC70Y7Rh9C40YLRjCDRjdC60YHQv9C10YDQuNC80LXQvdGC0LDQu9GM0L3Ri9C1INGE0YPQvdC60YbQuNC4JywKICBub3RBbGxvd0V4cGVyaW1lbnRGZWF0dXJlczogJ9Ce0YLQutC70Y7Rh9C40YLRjCDRjdC60YHQv9C10YDQuNC80LXQvdGC0LDQu9GM0L3Ri9C1INGE0YPQvdC60YbQuNC4JywKICBleHBlcmltZW50RmVhdHVyZXNXYXJuaW5nOiAn0K3QutGB0L/QtdGA0LjQvNC10L3RgtCw0LvRjNC90YvQtSDRhNGD0L3QutGG0LjQuCDQvNC+0LPRg9GCINCy0YvQt9Cy0LDRgtGMINC+0L/RgNC10LTQtdC70LXQvdC90YvQtSDQv9GA0L7QsdC70LXQvNGLLCDQstC60LvRjtGH0LDQudGC0LUg0LjRhSDRgSDQvtGB0YLQvtGA0L7QttC90L7RgdGC0YzRji4nLAogIHVzZU1lZGlhRG93bmxvYWRUaXBzOiAn0KfRgtC+0LHRiyDQuNGB0L/QvtC70YzQt9C+0LLQsNGC0Ywg0YTRg9C90LrRhtC40Y4g0LfQsNCz0YDRg9C30LrQuCwg0LLQsNC8INC90LXQvtCx0YXQvtC00LjQvNC+INCy0LrQu9GO0YfQuNGC0Ywg0Y3QutGB0L/QtdGA0LjQvNC10L3RgtCw0LvRjNC90YPRjiDRhNGD0L3QutGG0LjRji5cbtCt0LrRgdC/0LXRgNC40LzQtdC90YLQsNC70YzQvdGL0LUg0YTRg9C90LrRhtC40Lgg0LzQvtCz0YPRgiDQu9C10LPQutC+INCy0YvQt9Cy0LDRgtGMINC90LXQutC+0YLQvtGA0YvQtSDQvdC10L7Qv9GA0LXQtNC10LvQtdC90L3Ri9C1INC/0YDQvtCx0LvQtdC80YsuINCS0Ysg0YPQstC10YDQtdC90YssINGH0YLQviDRhdC+0YLQuNGC0LUg0LLQutC70Y7Rh9C40YLRjCDQtdC1PycsCiAgYWxsb3dFeHRlcm5hbEN1c3RvbUNvbmZpZ3VyYXRpb246ICfQktC60LvRjtGH0LjRgtGMINCy0L7Qt9C80L7QttC90L7RgdGC0Lgg0LLQvdC10YjQvdC10Lkg0L3QsNGB0YLRgNC+0LnQutC4JywKICBub3RBbGxvd0V4dGVybmFsQ3VzdG9tQ29uZmlndXJhdGlvbjogJ9Ce0YLQutC70Y7Rh9C40YLRjCDQstC+0LfQvNC+0LbQvdC+0YHRgtC4INCy0L3QtdGI0L3QtdC5INC90LDRgdGC0YDQvtC50LrQuCcsCiAgY2hhbmdlTG9nOiAn0JbRg9GA0L3QsNC7INC40LfQvNC10L3QtdC90LjQuScsCiAgY3VycmVudFZlcnNpb246ICfQotC10LrRg9GJ0LDRjyDQstC10YDRgdC40Y8nLAogIGNoZWNrVmVyc2lvbjogJ9Cf0YDQvtCy0LXRgNC40YLRjCDQvdCw0LvQuNGH0LjQtSDQvdC+0LLQvtC5INCy0LXRgNGB0LjQuCA/JywKICBjb25maWdGYWlsOiAn0J7RiNC40LHQutCwINC60L7QvdGE0LjQs9GD0YDQsNGG0LjQuCcsCiAgZ2xvYmFsU2V0dGluZzogJ9CT0LvQvtCx0LDQu9GM0L3Ri9C1INC90LDRgdGC0YDQvtC50LrQuCcsCiAgb3BlbkN1c3RvbUNvbmZpZ3VyYXRpb25FZGl0b3I6ICfQntGC0LrRgNGL0YLRjCDRgNC10LTQsNC60YLQvtGAINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjNGB0LrQvtC5INC60L7QvdGE0LjQs9GD0YDQsNGG0LjQuCcsCiAgbG9jYWxTZXR0aW5nOiAn0YLQvtC70YzQutC+INC00LvRjyDRjdGC0L7Qs9C+INGB0LDQudGC0LAnLAogIG9wZW5EZWJ1Z01vZGU6ICfQktC60LvRjtGH0LjRgtGMINGA0LXQttC40Lwg0L7RgtC70LDQtNC60LgnLAogIGNsb3NlRGVidWdNb2RlOiAn0L7RgtC60LvRjtGH0LjRgtGMINGA0LXQttC40Lwg0L7RgtC70LDQtNC60LgnLAogIHVuZm9sZE1lbnU6ICfRgNCw0LfQstC10YDQvdGD0YLRjCDQvNC10L3RjicsCiAgZm9sZE1lbnU6ICfRgdCy0LXRgNC90YPRgtGMINC80LXQvdGOJywKICBhZGRHcm91cENoYXQ6ICfwn5Ks0JTQvtCx0LDQstC40YLRjCDQs9GA0YPQv9C/0YMg0YfQsNGC0LAnLAogIHNwZWVkOiAn0KHQutC+0YDQvtGB0YLRjCcsCiAgY2FwdHVyZTogJ9CX0LDRhdCy0LDRgicsCiAgZG93bmxvYWQ6ICfQodC60LDRh9Cw0YLRjCcsCiAgbWVkaWFEb3dubG9hZDogewogICAgZW5hYmxlOiAn0JLQutC70Y7Rh9C40YLRjCDQt9Cw0LPRgNGD0LfQutGDINC80LXQtNC40LDRhNCw0LnQu9C+0LInLAogICAgZGlzYWJsZTogJ9Ce0YLQutC70Y7Rh9C40YLRjCDQt9Cw0LPRgNGD0LfQutGDINC80LXQtNC40LDRhNCw0LnQu9C+0LInLAogICAgZG93bmxvYWRPcHRpb25zOiAn0J7Qv9GG0LjQuCDQt9Cw0LPRgNGD0LfQutC4JywKICAgIGRvd25sb2FkaW5nOiAn0JjQtNC10YIg0YHQutCw0YfQuNCy0LDQvdC40LUg0YTQsNC50LvQsC4g0JLRiyDRg9Cy0LXRgNC10L3Riywg0YfRgtC+INGF0L7RgtC40YLQtSDQv9C+0LLRgtC+0YDQuNGC0Ywg0Y3RgtGDINC+0L/QtdGA0LDRhtC40Y4/JywKICAgIGhhc0Rvd25sb2FkOiAn0KTQsNC50Lsg0YHQutCw0YfQsNC9LiDQktGLINGD0LLQtdGA0LXQvdGLLCDRh9GC0L4g0YXQvtGC0LjRgtC1INC/0L7QstGC0L7RgNC40YLRjCDRjdGC0YMg0L7Qv9C10YDQsNGG0LjRjj8nLAogICAgY29uZmlybVRpdGxlOiAn0J/QvtC20LDQu9GD0LnRgdGC0LAsINCy0LLQtdC00LjRgtC1INC40LzRjyDRhNCw0LnQu9CwJywKICAgIG5vdFN1cHBvcnQ6ICfQotC10LrRg9GJ0LjQuSDQvNC10LTQuNCw0YTQsNC50Lsg0L3QtdCy0L7Qt9C80L7QttC90L4g0LfQsNCz0YDRg9C30LjRgtGMLCDQsCDRhNGD0L3QutGG0LjRjiDQt9Cw0LPRgNGD0LfQutC4INC90LXQvtCx0YXQvtC00LjQvNC+INC+0L/RgtC40LzQuNC30LjRgNC+0LLQsNGC0Ywg0Lgg0YPQu9GD0YfRiNC40YLRjC4nLAogICAgbm90RW5kT2ZTdHJlYW06ICfQnNC10LTQuNCw0LTQsNC90L3Ri9C1INC10YnQtSDQvdC1INC/0L7Qu9C90L7RgdGC0YzRjiDQs9C+0YLQvtCy0YsuINCS0Ysg0YPQstC10YDQtdC90YssINGH0YLQviDRhdC+0YLQuNGC0LUg0LjRhSDRgdC60LDRh9Cw0YLRjD8nLAogICAgY2FuY2VsQXV0b0Rvd25sb2FkOiAn0J7RgtC80LXQvdC40YLRjCDQsNCy0YLQvtC80LDRgtC40YfQtdGB0LrRg9GOINC30LDQs9GA0YPQt9C60YM/JywKICAgIGF1dG9Eb3dubG9hZDogJ9CR0YPQtNGD0YIg0LvQuCDQvNC10LTQuNCw0LTQsNC90L3Ri9C1INC30LDQs9GA0YPQttCw0YLRjNGB0Y8g0LDQstGC0L7QvNCw0YLQuNGH0LXRgdC60Lgg0L/QvtGB0LvQtSDQuNGFINC/0L7Qu9C90L7QuSDQs9C+0YLQvtCy0L3QvtGB0YLQuD8nLAogICAgbm90Rm91bmRNZWRpYVNvdXJjZTogJ9Ch0L7QvtGC0LLQtdGC0YHRgtCy0YPRjtGJ0LjQtSDQtNCw0L3QvdGL0LUg0LzQtdC00LjQsNC/0L7RgtC+0LrQsCDQvdC1INC90LDQudC00LXQvdGLLiDQktC+0LfQvNC+0LbQvdC+LCDQtNCw0L3QvdGL0LUg0LHRi9C70Lgg0L7Rh9C40YnQtdC90Ysg0LjQu9C4INC80LXQtNC40LAt0Y3Qu9C10LzQtdC90YLRiyDRg9C00LDQu9C10L3Riy4g0KDQtdC60L7QvNC10L3QtNGD0LXRgtGB0Y8g0L7QsdC90L7QstC40YLRjCDRgdGC0YDQsNC90LjRhtGDINC4INC/0L7QstGC0L7RgNC40YLRjCDQv9C+0L/Ri9GC0LrRgy4nCiAgfSwKICBtZW51OiAn0JzQtdC90Y4nLAogIG1vcmU6ICfQkdC+0LvRjNGI0LUnLAogIG1vcmVBY3Rpb25zOiAn0JTQvtC/0L7Qu9C90LjRgtC10LvRjNC90YvQtSDQtNC10LnRgdGC0LLQuNGPJywKICB2aWRlb0ZpbHRlcjogJ9CS0LjQtNC10L7RhNC40LvRjNGC0YAnLAogIHJlc2V0RmlsdGVyQW5kVHJhbnNmb3JtOiAn0KHQsdGA0L7RgdC40YLRjCDRhNC40LvRjNGC0YAg0Lgg0YLRgNCw0L3RgdGE0L7RgNC80LDRhtC40Y4nLAogIGJyaWdodG5lc3NVcDogJ9Cj0LLQtdC70LjRh9C40YLRjCDRj9GA0LrQvtGB0YLRjCcsCiAgYnJpZ2h0bmVzc0Rvd246ICfQo9C80LXQvdGM0YjQuNGC0Ywg0Y/RgNC60L7RgdGC0YwnLAogIGNvbnRyYXN0VXA6ICfQo9Cy0LXQu9C40YfQuNGC0Ywg0LrQvtC90YLRgNCw0YHRgicsCiAgY29udHJhc3REb3duOiAn0KPQvNC10L3RjNGI0LjRgtGMINC60L7QvdGC0YDQsNGB0YInLAogIHNhdHVyYXRpb25VcDogJ9Cj0LLQtdC70LjRh9C40YLRjCDQvdCw0YHRi9GJ0LXQvdC90L7RgdGC0YwnLAogIHNhdHVyYXRpb25Eb3duOiAn0KPQvNC10L3RjNGI0LjRgtGMINC90LDRgdGL0YnQtdC90L3QvtGB0YLRjCcsCiAgaHVlVXA6ICfQo9Cy0LXQu9C40YfQuNGC0Ywg0L7RgtGC0LXQvdC+0LonLAogIGh1ZURvd246ICfQo9C80LXQvdGM0YjQuNGC0Ywg0L7RgtGC0LXQvdC+0LonLAogIGJsdXJVcDogJ9Cj0LLQtdC70LjRh9C40YLRjCDRgNCw0LfQvNGL0YLQuNC1JywKICBibHVyRG93bjogJ9Cj0LzQtdC90YzRiNC40YLRjCDRgNCw0LfQvNGL0YLQuNC1JywKICByb3RhdGVBbmRNaXJyb3I6ICfQn9C+0LLQtdGA0L3Rg9GC0Ywg0Lgg0L7RgtGA0LDQt9C40YLRjCcsCiAgcm90YXRlOTA6ICfQn9C+0LLQtdGA0L3Rg9GC0Ywg0LjQt9C+0LHRgNCw0LbQtdC90LjQtSDQvdCwIDkwINCz0YDQsNC00YPRgdC+0LInLAogIGhvcml6b250YWxNaXJyb3I6ICfQk9C+0YDQuNC30L7QvdGC0LDQu9GM0L3QvtC1INC+0YLRgNCw0LbQtdC90LjQtSDQuNC30L7QsdGA0LDQttC10L3QuNGPJywKICB2ZXJ0aWNhbE1pcnJvcjogJ9CS0LXRgNGC0LjQutCw0LvRjNC90L7QtSDQvtGC0YDQsNC20LXQvdC40LUg0LjQt9C+0LHRgNCw0LbQtdC90LjRjycsCiAgdmlkZW9UcmFuc2Zvcm06ICfQktC40LTQtdC+INGC0YDQsNC90YHRhNC+0YDQvNCw0YbQuNGPJywKICB0cmFuc2xhdGVSaWdodDogJ9Ch0LTQstC40L3Rg9GC0Ywg0Y3QutGA0LDQvSDQstC/0YDQsNCy0L4nLAogIHRyYW5zbGF0ZUxlZnQ6ICfQodC00LLQuNC90YPRgtGMINGN0LrRgNCw0L0g0LLQu9C10LLQvicsCiAgdHJhbnNsYXRlVXA6ICfQodC00LLQuNC90YPRgtGMINGN0LrRgNCw0L0g0LLQstC10YDRhScsCiAgdHJhbnNsYXRlRG93bjogJ9Ch0LTQstC40L3Rg9GC0Ywg0Y3QutGA0LDQvSDQstC90LjQtycsCiAgbGFuZ3VhZ2VTZXR0aW5nczogJ9Cd0LDRgdGC0YDQvtC50LrQuCDRj9C30YvQutCwJywKICBkZWZhdWx0OiAn0J/QviDRg9C80L7Qu9GH0LDQvdC40Y4nLAogIGF1dG9DaG9vc2U6ICfQkNCy0YLQvtC80LDRgtC40YfQtdGB0LrQuNC5INCy0YvQsdC+0YAnLAogIGNvbWluZ1Nvb246ICfQkdC+0LvRjNGI0LUg0YTRg9C90LrRhtC40Lkg0L3QsNGF0L7QtNC40YLRgdGPINCyINC/0YDQvtGG0LXRgdGB0LUg0YPQu9GD0YfRiNC10L3QuNGPLCDRgdC70LXQtNC40YLQtSDQt9CwINC+0LHQvdC+0LLQu9C10L3QuNGP0LzQuCcsCiAgZmZtcGVnU2NyaXB0OiAn0KHQutGA0LjQv9GCINGB0LvQuNGP0L3QuNGPL9C/0YDQtdC+0LHRgNCw0LfQvtCy0LDQvdC40Y8g0LDRg9C00LjQviDQuCDQstC40LTQtdC+JywKICBhdXRvR290b0J1ZmZlcmVkVGltZTogJ9CQ0LLRgtC+0LzQsNGC0LjRh9C10YHQutC4INC/0LXRgNC10LnRgtC4INC6INCy0YDQtdC80LXQvdC4INCx0YPRhNC10YDQsCcsCiAgZGlzYWJsZUF1dG9Hb3RvQnVmZmVyZWRUaW1lOiAn0J7RgtC60LvRjtGH0LjRgtGMINCw0LLRgtC+0LzQsNGC0LjRh9C10YHQutC40Lkg0L/QtdGA0LXRhdC+0LQg0Log0LLRgNC10LzQtdC90Lgg0LHRg9GE0LXRgNCwJywKICBtb3VzZTogewogICAgZW5hYmxlOiAn0JLQutC70Y7Rh9C40YLRjCDRg9C/0YDQsNCy0LvQtdC90LjQtSDQvNGL0YjRjNGOJywKICAgIGRpc2FibGU6ICfQntGC0LrQu9GO0YfQuNGC0Ywg0YPQv9GA0LDQstC70LXQvdC40LUg0LzRi9GI0YzRjicsCiAgICBsb25nUHJlc3NUaW1lOiAn0JrQsNC6INC00L7Qu9Cz0L4g0YDQtdCw0LPQuNGA0L7QstCw0YLRjCDQvdCwINC00L7Qu9Cz0LjQtSDQvdCw0LbQsNGC0LjRjyDQvNGL0YjQuCcKICB9LAogIHRpcHNNc2c6IHsKICAgIHBsYXlzcGVlZDogJ9Ch0LrQvtGA0L7RgdGC0Yw6ICcsCiAgICBmb3J3YXJkOiAn0JLQv9C10YDRkdC0OiAnLAogICAgYmFja3dhcmQ6ICfQndCw0LfQsNC0OiAnLAogICAgc2Vjb25kczogJyDRgdC10LonLAogICAgdm9sdW1lOiAn0JPRgNC+0LzQutC+0YHRgtGMOiAnLAogICAgbmV4dGZyYW1lOiAn0KHQu9C10LTRg9GO0YnQuNC5INC60LDQtNGAJywKICAgIHByZXZpb3VzZnJhbWU6ICfQn9GA0LXQtNGL0LTRg9GJ0LjQuSDQutCw0LTRgCcsCiAgICBzdG9wZnJhbWU6ICfQodGC0L7Qvy3QutCw0LTRgDogJywKICAgIHBsYXk6ICfQl9Cw0L/Rg9GB0LonLAogICAgcGF1c2U6ICfQn9Cw0YPQt9CwJywKICAgIGFycGw6ICfQoNCw0LfRgNC10YjQuNGC0Ywg0LDQstGC0L7QvNCw0YLQuNGH0LXRgdC60L7QtSDQstC+0LfQvtCx0L3QvtCy0LvQtdC90LjQtSDQv9GA0L7Qs9GA0LXRgdGB0LAg0LLQvtGB0L/RgNC+0LjQt9Cy0LXQtNC10L3QuNGPJywKICAgIGRycGw6ICfQl9Cw0L/RgNC10YLQuNGC0Ywg0LDQstGC0L7QvNCw0YLQuNGH0LXRgdC60L7QtSDQstC+0LfQvtCx0L3QvtCy0LvQtdC90LjQtSDQv9GA0L7Qs9GA0LXRgdGB0LAg0LLQvtGB0L/RgNC+0LjQt9Cy0LXQtNC10L3QuNGPJywKICAgIGJyaWdodG5lc3M6ICfQr9GA0LrQvtGB0YLRjDogJywKICAgIGNvbnRyYXN0OiAn0JrQvtC90YLRgNCw0YHRgjogJywKICAgIHNhdHVyYXRpb246ICfQndCw0YHRi9GJ0LXQvdC90L7RgdGC0Yw6ICcsCiAgICBodWU6ICfQntGC0YLQtdC90L7QujogJywKICAgIGJsdXI6ICfQoNCw0LfQvNGL0YLQuNC1OiAnLAogICAgaW1nYXR0cnJlc2V0OiAn0JDRgtGA0LjQsdGD0YLRizog0YHQsdGA0L7RgScsCiAgICBpbWdyb3RhdGU6ICfQn9C+0LLQvtGA0L7RgiDQuNC30L7QsdGA0LDQttC10L3QuNGPOiAnLAogICAgb25wbHVnaW46ICfQktCa0Js6INC/0LvQsNCz0LjQvSDQstC+0YHQv9GA0L7QuNC30LLQtdC00LXQvdC40Y8nLAogICAgb2ZmcGx1Z2luOiAn0JLQq9Ca0Js6INC/0LvQsNCz0LjQvSDQstC+0YHQv9GA0L7QuNC30LLQtdC00LXQvdC40Y8nLAogICAgZ2xvYmFsbW9kZTogJ9CT0LvQvtCx0LDQu9GM0L3Ri9C5INGA0LXQttC40Lw6JywKICAgIHBsYXliYWNrcmVzdG9yZWQ6ICfQktC+0YHRgdGC0LDQvdC+0LLQu9C10L0g0L/QvtGB0LvQtdC00L3QuNC5INC/0YDQvtCz0YDQtdGB0YEg0LLQvtGB0L/RgNC+0LjQt9Cy0LXQtNC10L3QuNGPJywKICAgIHBsYXliYWNrcmVzdG9yZW9mZjogJ9Ck0YPQvdC60YbQuNGPINCy0L7RgdGB0YLQsNC90L7QstC70LXQvdC40Y8g0L/RgNC+0LPRgNC10YHRgdCwINCy0L7RgdC/0YDQvtC40LfQstC10LTQtdC90LjRjyDQvtGC0LrQu9GO0YfQtdC90LAuINCd0LDQttC80LjRgtC1IFNISUZUICsgUiwg0YfRgtC+0LHRiyDQstC60LvRjtGH0LjRgtGMINGE0YPQvdC60YbQuNGOJywKICAgIGhvcml6b250YWw6ICfQk9C+0YDQuNC30L7QvdGC0LDQu9GM0L3QvtC1INGB0LzQtdGJ0LXQvdC40LU6ICcsCiAgICB2ZXJ0aWNhbDogJ9CS0LXRgNGC0LjQutCw0LvRjNC90L7QtSDRgdC80LXRidC10L3QuNC1OiAnLAogICAgaG9yaXpvbnRhbE1pcnJvcjogJ9CT0L7RgNC40LfQvtC90YLQsNC70YzQvdC+0LUg0LfQtdGA0LrQsNC70L4nLAogICAgdmVydGljYWxNaXJyb3I6ICfQstC10YDRgtC40LrQsNC70YzQvdC+0LUg0LfQtdGA0LrQsNC70L4nLAogICAgdmlkZW96b29tOiAn0KPQstC10LvQuNGH0LjRgtGMINCy0LjQtNC10L46ICcKICB9Cn07Cgp2YXIgemhUVyA9IHsKICB3ZWJzaXRlOiAn8J+PoOiFs+acrOWumOe2sicsCiAgYWJvdXQ6ICfpl5zmlrwnLAogIGlzc3VlczogJ+WPjemliycsCiAgZmFxOiAn5bi46KaL5ZWP6aGMJywKICBzZXR0aW5nOiAn6Kit572uJywKICBob3RrZXlzOiAn5b+r5o236Y21JywKICBrZXlib2FyZENvbnRyb2w6ICfpjbXnm6TmjqfliLYnLAogIG1vdXNlQ29udHJvbDogJ+m8oOaomeaOp+WIticsCiAgaG90a2V5c0RvY3M6ICflv6vmjbfpjbXmlofmqpQnLAogIGVuYWJsZTogJ+WVn+eUqCcsCiAgZGlzYWJsZTogJ+emgeeUqCcsCiAgdG9nZ2xlU3RhdGVzOiAn5ZWf55SoL+emgeeUqCcsCiAgZGlzYWJsZUhvdGtleXNUZW1wb3JhcmlseTogJ+iHqOaZguemgeeUqOW/q+aNt+mNtScsCiAgdG9nZ2xlSG90a2V5c1RlbXBvcmFyaWx5OiAn6Ieo5pmC5ZWf55SoL+emgeeUqOW/q+aNt+mNtScsCiAgZW5hYmxlSG90a2V5czogJ+WVn+eUqOW/q+aNt+mNtScsCiAgZGlzYWJsZUhvdGtleXM6ICfnpoHnlKjlv6vmjbfpjbUnLAogIGRvbmF0ZTogJ/CfkY3orpros54nLAogIGFib3V0RG9uYXRlOiAnMTAw6JCs57Sa5a6J6KOd6YeP55qE5L2c5ZOB77yM5pyJ5aSa5bCR5omT6LOe77yfJywKICBhYm91dEF1dGhvcjogJ+mXnOaWvOS9nOiAhScsCiAgZW5hYmxlU2NyaXB0OiAn5ZWf55So6IWz5pysJywKICBkaXNhYmxlU2NyaXB0OiAn56aB55So6IWz5pysJywKICBkaXNhYmxlQ3VycmVudEluc3RhbmNlR1VJOiAn6Zec6ZaJ55W25YmN5ZyW5b2i55So5oi255WM6Z2iJywKICBkaXNhYmxlR1VJVGVtcG9yYXJpbHk6ICfoh6jmmYLnpoHnlKjlnJblvaLnlKjmiLbnlYzpnaInLAogIGVuYWJsZUdVSTogJ+WVn+eUqOWcluW9oueUqOaItueVjOmdoicsCiAgZGlzYWJsZUdVSTogJ+emgeeUqOWcluW9oueUqOaItueVjOmdoicsCiAgZ3JhcGhpY2FsSW50ZXJmYWNlOiAn5ZyW5b2i55WM6Z2iJywKICBhbHdheXNTaG93R3JhcGhpY2FsSW50ZXJmYWNlOiAn5aeL57WC6aGv56S65ZyW5b2i55WM6Z2iJywKICBvcGVuQ3Jvc3NPcmlnaW5GcmFtZVBhZ2U6ICfllq7njajmiZPplovot6jln5/nmoTpoIHpnaInLAogIGRpc2FibGVJbml0QXV0b1BsYXk6ICfnpoHmraLlnKjmraTntrLnq5noh6rli5Xmkq3mlL7oppbpoLsnLAogIGVuYWJsZUluaXRBdXRvUGxheTogJ+WFgeioseWcqOatpOe2suermeiHquWLleaSreaUvuimlumguycsCiAgcmVzdG9yZUNvbmZpZ3VyYXRpb246ICfpgoTljp/lhajlsYDnmoTpu5joqo3phY3nva4nLAogIGJsb2NrU2V0UGxheWJhY2tSYXRlOiAn56aB55So6buY6KqN6YCf5bqm6Kq/56+A6YKP6LyvJywKICBibG9ja1NldEN1cnJlbnRUaW1lOiAn56aB55So6buY6KqN5pKt5pS+6YCy5bqm5o6n5Yi26YKP6LyvJywKICBibG9ja1NldFZvbHVtZTogJ+emgeeUqOm7mOiqjemfs+mHj+aOp+WItumCj+i8rycsCiAgdW5ibG9ja1NldFBsYXliYWNrUmF0ZTogJ+WFgeiosem7mOiqjemAn+W6puiqv+evgOmCj+i8rycsCiAgdW5ibG9ja1NldEN1cnJlbnRUaW1lOiAn5YWB6Kix6buY6KqN5pKt5pS+6YCy5bqm5o6n5Yi26YKP6LyvJywKICB1bmJsb2NrU2V0Vm9sdW1lOiAn5YWB6Kix6buY6KqN6Z+z6YeP5o6n5Yi26YKP6LyvJywKICBhbGxvd0Fjb3VzdGljR2FpbjogJ+mWi+WVn+mfs+mHj+WinuebiuiDveWKmycsCiAgbm90QWxsb3dBY291c3RpY0dhaW46ICfnpoHnlKjpn7Pph4/lop7nm4rog73lipsnLAogIGFsbG93Q3Jvc3NPcmlnaW5Db250cm9sOiAn6ZaL5ZWf6Leo5Z+f5o6n5Yi26IO95YqbJywKICBub3RBbGxvd0Nyb3NzT3JpZ2luQ29udHJvbDogJ+emgeeUqOi3qOWfn+aOp+WItuiDveWKmycsCiAgYWxsb3dFeHBlcmltZW50RmVhdHVyZXM6ICfplovllZ/lr6bpqZfmgKflip/og70nLAogIG5vdEFsbG93RXhwZXJpbWVudEZlYXR1cmVzOiAn56aB55So5a+m6amX5oCn5Yqf6IO9JywKICBleHBlcmltZW50RmVhdHVyZXNXYXJuaW5nOiAn5a+m6amX5oCn5Yqf6IO95a655piT6YCg5oiQ5LiA5Lqb5LiN56K65a6a55qE5ZWP6aGM77yM6KuL6Ky55oWO6ZaL5ZWfJywKICB1c2VNZWRpYURvd25sb2FkVGlwczogJ+S9v+eUqOS4i+i8ieWKn+iDve+8jOmcgOmWi+WVn+Wvpumpl+WKn+iDve+8jFxu5a+m6amX5Yqf6IO95a655piT6YCg5oiQ5LiA5Lqb5LiN56K65a6a55qE5ZWP6aGM77yM56K65a6a6KaB6ZaL5ZWf5ZeO77yfJywKICBhbGxvd0V4dGVybmFsQ3VzdG9tQ29uZmlndXJhdGlvbjogJ+mWi+WVn+WklumDqOiHquWumue+qeiDveWKmycsCiAgbm90QWxsb3dFeHRlcm5hbEN1c3RvbUNvbmZpZ3VyYXRpb246ICfpl5zplonlpJbpg6joh6rlrprnvqnog73lipsnLAogIGNoYW5nZUxvZzogJ+abtOaWsOaXpeiqjCcsCiAgY3VycmVudFZlcnNpb246ICfnlbbliY3niYjmnKwnLAogIGNoZWNrVmVyc2lvbjogJ+aqouafpeaYr+WQpuacieaWsOeJiOacrO+8nycsCiAgY29uZmlnRmFpbDogJ+mFjee9ruWkseaVlycsCiAgZ2xvYmFsU2V0dGluZzogJ+WFqOWxgOioree9ricsCiAgb3BlbkN1c3RvbUNvbmZpZ3VyYXRpb25FZGl0b3I6ICfmiZPplovoh6rlrprnvqnphY3nva7nt6jovK/lmagnLAogIGxvY2FsU2V0dGluZzogJ+WDheeUqOaWvOatpOe2suermScsCiAgb3BlbkRlYnVnTW9kZTogJ+mWi+WVn+iqv+ippuaooeW8jycsCiAgY2xvc2VEZWJ1Z01vZGU6ICfpl5zplonoqr/oqabmqKHlvI8nLAogIHVuZm9sZE1lbnU6ICflsZXplovoj5zllq4nLAogIGZvbGRNZW51OiAn5oqY55aK6I+c5ZauJywKICBhZGRHcm91cENoYXQ6ICfwn5Ks5paw5aKe576k6IGKJywKICBzcGVlZDogJ+WAjemAnycsCiAgY2FwdHVyZTogJ+aIquWclicsCiAgZG93bmxvYWQ6ICfkuIvovIknLAogIG1lZGlhRG93bmxvYWQ6IHsKICAgIGVuYWJsZTogJ+mWi+WVn+WqkumrlOS4i+i8iScsCiAgICBkaXNhYmxlOiAn6Zec6ZaJ5aqS6auU5LiL6LyJJywKICAgIGRvd25sb2FkT3B0aW9uczogJ+S4i+i8iemBuOmghScsCiAgICBkb3dubG9hZGluZzogJ+aWh+S7tuato+WcqOS4i+i8ieS4re+8jOeiuuWumumHjeikh+Wft+ihjOatpOaTjeS9nO+8nycsCiAgICBoYXNEb3dubG9hZDogJ+aWh+S7tuW3sue2k+S4i+i8ie+8jOeiuuWumumHjeikh+Wft+ihjOatpOaTjeS9nO+8nycsCiAgICBjb25maXJtVGl0bGU6ICfoq4vovLjlhaXmlofku7blkI0nLAogICAgbm90U3VwcG9ydDogJ+ebruWJjeWqkumrlOaqlOahiOeEoeazleS4i+i8ie+8jOS4i+i8ieWKn+iDveimgeWEquWMluWujOWWhCcsCiAgICBub3RFbmRPZlN0cmVhbTogJ+WqkumrlOizh+aWmemChOaykuWujOWFqOWwsee3ku+8jOeiuuWumuimgeWft+ihjOS4i+i8ieaTjeS9nO+8nycsCiAgICBjYW5jZWxBdXRvRG93bmxvYWQ6ICfmmK/lkKblj5bmtojoh6rli5XkuIvovInvvJ8nLAogICAgYXV0b0Rvd25sb2FkOiAn5aqS6auU6LOH5paZ5a6M5YWo5bCx57eS5b6M77yM5piv5ZCm6Ieq5YuV5LiL6LyJ77yfJywKICAgIG5vdEZvdW5kTWVkaWFTb3VyY2U6ICfmnKrmib7liLDlsI3mh4nnmoTlqpLpq5TmtYHmlbjmk5rvvIzmlbjmk5rlj6/og73ooqvmuIXnkIbmiJblqpLpq5TlhYPntKDlt7LntpPooqvnp7vpmaTvvIzlu7rorbDliLfmlrDpoIHpnaLlvozph43oqaYnCiAgfSwKICBtZW51OiAn6I+c5ZauJywKICBtb3JlOiAn5pu05aSaJywKICBtb3JlQWN0aW9uczogJ+abtOWkmuaTjeS9nCcsCiAgdmlkZW9GaWx0ZXI6ICfoppbpoLvmv77pj6EnLAogIHJlc2V0RmlsdGVyQW5kVHJhbnNmb3JtOiAn5ZyW5YOP5b6p5L2NJywKICBicmlnaHRuZXNzVXA6ICflop7liqDkuq7luqYnLAogIGJyaWdodG5lc3NEb3duOiAn5rib5bCR5Lqu5bqmJywKICBjb250cmFzdFVwOiAn5aKe5Yqg5bCN5q+U5bqmJywKICBjb250cmFzdERvd246ICfmuJvlsJHlsI3mr5TluqYnLAogIHNhdHVyYXRpb25VcDogJ+WinuWKoOmjveWSjOW6picsCiAgc2F0dXJhdGlvbkRvd246ICfmuJvlsJHpo73lkozluqYnLAogIGh1ZVVwOiAn5aKe5Yqg6Imy55u4JywKICBodWVEb3duOiAn5rib5bCR6Imy55u4JywKICBibHVyVXA6ICflop7liqDmqKHns4rluqYnLAogIGJsdXJEb3duOiAn5rib5bCR5qih57OK5bqmJywKICByb3RhdGVBbmRNaXJyb3I6ICfml4vovYnlkozpj6Hlg48nLAogIHJvdGF0ZTkwOiAn55Wr6Z2i5peL6L2JIDkwIOW6picsCiAgaG9yaXpvbnRhbE1pcnJvcjogJ+eVq+mdouawtOW5s+mPoeWDj+e/u+i9iScsCiAgdmVydGljYWxNaXJyb3I6ICfnlavpnaLlnoLnm7Tpj6Hlg4/nv7vovYknLAogIHZpZGVvVHJhbnNmb3JtOiAn55Wr6Z2i5L2N56e7JywKICB0cmFuc2xhdGVSaWdodDogJ+eVq+mdouWQkeWPs+enu+WLlScsCiAgdHJhbnNsYXRlTGVmdDogJ+eVq+mdouWQkeW3puenu+WLlScsCiAgdHJhbnNsYXRlVXA6ICfnlavpnaLlkJHkuIrnp7vli5UnLAogIHRyYW5zbGF0ZURvd246ICfnlavpnaLlkJHkuIvnp7vli5UnLAogIGxhbmd1YWdlU2V0dGluZ3M6ICfoqp7oqIDoqK3nva4nLAogIGRlZmF1bHQ6ICfpu5joqo0nLAogIGF1dG9DaG9vc2U6ICfoh6rli5Xpgbjmk4cnLAogIGNvbWluZ1Nvb246ICfmm7TlpJrlip/og73mraPlnKjlrozlloTkuK3vvIzmlazoq4vmnJ/lvoUnLAogIGZmbXBlZ1NjcmlwdDogJ+mfs+imlumgu+WQiOS9tS/ovYnmj5vohbPmnKwnLAogIGF1dG9Hb3RvQnVmZmVyZWRUaW1lOiAn6Ieq5YuV6Lef6Zqo6Lez6L2J5Yiw57ep6KGd5Y2A5pmC6ZaTJywKICBkaXNhYmxlQXV0b0dvdG9CdWZmZXJlZFRpbWU6ICfnpoHnlKjoh6rli5Xot5/pmqjot7PovYnliLDnt6nooZ3ljYDmmYLplpMnLAogIG1vdXNlOiB7CiAgICBlbmFibGU6ICfllZ/nlKjpvKDmqJnmjqfliLYnLAogICAgZGlzYWJsZTogJ+emgeeUqOm8oOaomeaOp+WIticsCiAgICBsb25nUHJlc3NUaW1lOiAn6ZW35oyJ5aSa5LmF6Z+/5oeJ6byg5qiZ6ZW35oyJ5LqL5Lu2JwogIH0sCiAgdGlwc01zZzogewogICAgcGxheXNwZWVkOiAn5pKt5pS+6YCf5bqm77yaJywKICAgIGZvcndhcmQ6ICflkJHliY3vvJonLAogICAgYmFja3dhcmQ6ICflkJHlvozvvJonLAogICAgc2Vjb25kczogJ+enkicsCiAgICB2b2x1bWU6ICfpn7Pph4/vvJonLAogICAgbmV4dGZyYW1lOiAn5a6a5L2N77ya5LiL5LiA5bmAJywKICAgIHByZXZpb3VzZnJhbWU6ICflrprkvY3vvJrkuIrkuIDluYAnLAogICAgc3RvcGZyYW1lOiAn5a6a5qC85bmA55Wr6Z2i77yaJywKICAgIHBsYXk6ICfmkq3mlL4nLAogICAgcGF1c2U6ICfmmqvlgZwnLAogICAgYXJwbDogJ+WFgeioseiHquWLleaBouW+qeaSreaUvumAsuW6picsCiAgICBkcnBsOiAn56aB5q2i6Ieq5YuV5oGi5b6p5pKt5pS+6YCy5bqmJywKICAgIGJyaWdodG5lc3M6ICflnJblg4/kuq7luqbvvJonLAogICAgY29udHJhc3Q6ICflnJblg4/lsI3mr5TluqbvvJonLAogICAgc2F0dXJhdGlvbjogJ+WcluWDj+mjveWSjOW6pu+8micsCiAgICBodWU6ICflnJblg4/oibLnm7jvvJonLAogICAgYmx1cjogJ+WcluWDj+aooeeziuW6pu+8micsCiAgICBpbWdhdHRycmVzZXQ6ICflnJblg4/lsazmgKfvvJrlvqnkvY0nLAogICAgaW1ncm90YXRlOiAn55Wr6Z2i5peL6L2J77yaJywKICAgIG9ucGx1Z2luOiAn5ZWf55SoaDVQbGF5ZXLmj5Lku7YnLAogICAgb2ZmcGx1Z2luOiAn56aB55SoaDVQbGF5ZXLmj5Lku7YnLAogICAgZ2xvYmFsbW9kZTogJ+WFqOWxgOaooeW8j++8micsCiAgICBwbGF5YmFja3Jlc3RvcmVkOiAn54K65L2g5oGi5b6p5LiK5qyh5pKt5pS+6YCy5bqmJywKICAgIHBsYXliYWNrcmVzdG9yZW9mZjogJ+aBouW+qeaSreaUvumAsuW6puWKn+iDveW3suemgeeUqO+8jOaMiSBTSElGVCtSIOWPr+mWi+WVn+ipsuWKn+iDvScsCiAgICBob3Jpem9udGFsOiAn5rC05bmz5L2N56e777yaJywKICAgIHZlcnRpY2FsOiAn5Z6C55u05L2N56e777yaJywKICAgIGhvcml6b250YWxNaXJyb3I6ICfmsLTlubPpj6Hlg48nLAogICAgdmVydGljYWxNaXJyb3I6ICflnoLnm7Tpj6Hlg48nLAogICAgdmlkZW96b29tOiAn6KaW6aC757iu5pS+546H77yaJwogIH0KfTsKCmNvbnN0IG1lc3NhZ2VzID0gewogICd6aC1DTic6IHpoQ04sCiAgemg6IHpoQ04sCiAgJ3poLUhLJzogemhUVywKICAnemgtVFcnOiB6aFRXLAogICdlbi1VUyc6IGVuVVMsCiAgZW46IGVuVVMsCiAgcnUKfTsKCmNvbnN0IGkxOG4gPSBuZXcgSTE4bih7CiAgZGVmYXVsdExhbmd1YWdlOiAnZW4nLAogIC8qIOaMh+WumuW9k+WJjeimgeaYr+S9v+eUqOeahOivreiogOeOr+Wig++8jOm7mOiupOaXoOmcgOaMh+Wumu+8jOS8muiHquWKqOivu+WPliAqLwogIC8vIGxvY2FsZTogJ3poLVRXJywKICBsYW5ndWFnZXM6IG1lc3NhZ2VzCn0pOwoKY29uc3QgbGFuZyA9IGNvbmZpZ01hbmFnZXIuZ2V0KCdsYW5ndWFnZScpOwpsYW5nICYmIGkxOG4uY2hhbmdlTGFuZ3VhZ2UobGFuZyk7CgovKiDnlKjkuo7ojrflj5blhajlsYDllK/kuIDnmoRpZCAqLwpsZXQgX19nbG9iYWxJZF9fID0gMDsKZnVuY3Rpb24gZ2V0SWQgKCkgewogIGlmICh3aW5kb3cuR01fZ2V0VmFsdWUgJiYgd2luZG93LkdNX3NldFZhbHVlKSB7CiAgICBsZXQgZ0lEID0gd2luZG93LkdNX2dldFZhbHVlKCdfZ2xvYmFsX2lkXycpOwogICAgaWYgKCFnSUQpIGdJRCA9IDA7CiAgICBnSUQgPSBOdW1iZXIoZ0lEKSArIDE7CiAgICB3aW5kb3cuR01fc2V0VmFsdWUoJ19nbG9iYWxfaWRfJywgZ0lEKTsKICAgIHJldHVybiBnSUQKICB9IGVsc2UgewogICAgLyog5aaC5p6c5LiN5aSE5LqO5rK554y05o+S5Lu25LiL77yM5YiZ6K+laWTkuLrpobXpnaLoh6rlt7Hni6zkuqvnmoRpZCAqLwogICAgX19nbG9iYWxJZF9fID0gTnVtYmVyKF9fZ2xvYmFsSWRfXykgKyAxOwogICAgcmV0dXJuIF9fZ2xvYmFsSWRfXwogIH0KfQoKbGV0IGN1clRhYklkID0gbnVsbDsKCi8qKgogKiDojrflj5blvZPliY1UQULmoIfnrb7nmoRJZOWPt++8jOWPr+eUqOS6jmlmcmFtZeehruWumuiHquW3seaYr+WQpuWkhOS6juWQjOS4gFRBQuagh+etvuS4iwogKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQogKi8KZnVuY3Rpb24gZ2V0VGFiSWQgKCkgewogIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICBpZiAod2luZG93LkdNX2dldFRhYiBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7CiAgICAgIHdpbmRvdy5HTV9nZXRUYWIoZnVuY3Rpb24gKG9iaikgewogICAgICAgIGlmICghb2JqLnRhYklkKSB7CiAgICAgICAgICBvYmoudGFiSWQgPSBnZXRJZCgpOwogICAgICAgICAgd2luZG93LkdNX3NhdmVUYWIob2JqKTsKICAgICAgICB9CiAgICAgICAgLyog5q+P5qyh6I635Y+W6YO95pu05paw5b2T5YmNVGFi55qEaWTlj7cgKi8KICAgICAgICBjdXJUYWJJZCA9IG9iai50YWJJZDsKICAgICAgICByZXNvbHZlKG9iai50YWJJZCk7CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgLyog6Z2e5rK554y05o+S5Lu25LiL77yM5peg5rOV56Gu5a6aaWZyYW1l5piv5ZCm5aSE5LqO5ZCM5LiA5LiqdGFi5LiLICovCiAgICAgIHJlc29sdmUoRGF0ZS5ub3coKSk7CiAgICB9CiAgfSkKfQoKLyog5LiA5byA5aeL5bCx5Yid5aeL5YyW5aW9Y3VyVGFiSWTvvIzov5nmoLflkI7nu63lsLHkuI3pnIDopoHlvILmraXojrflj5ZUYWJpZO+8jOmDqOWIhuWcuuaZr+S4i+mcgOimgeeUqOWIsCAqLwpnZXRUYWJJZCgpOwoKLyohCiAqIEBuYW1lICAgICAgbW9ua2V5TXNnLmpzCiAqIEB2ZXJzaW9uICAgMC4wLjEKICogQGF1dGhvciAgICBCbGF6ZQogKiBAZGF0ZSAgICAgIDIwMTkvOS8yMSAxNDoyMgogKi8KLy8gaW1wb3J0IGRlYnVnIGZyb20gJy4vZGVidWcnCgovKioKICog5bCG5a+56LGh5pWw5o2u6YeM6Z2i5Y+v5a2Y5YKo5YiwR01fc2V0VmFsdWXph4zpnaLnmoTlgLzmj5Dlj5blh7rmnaUKICogQHBhcmFtIG9iaiB7b2JqY2V0fSAt5b+F6YCJIOaJk+eul+imgeWtmOWCqOeahOWvueixoeaVsOaNrgogKiBAcGFyYW0gZGVlcCB7bnVtYmVyfSAt5Y+v6YCJIOWmguaenOWvueixoeWxgue6p+mdnuW4uOa3se+8jOWImemhu+mZkOWumumAkuW9kueahOWxgue6p++8jOm7mOiupOacgOmrmOS4jeiDvei2hei/hzPnuqcKICogQHJldHVybnMge3t9fQogKi8KZnVuY3Rpb24gZXh0cmFjdERhdGFmcm9tT2IgKG9iaiwgZGVlcCkgewogIGRlZXAgPSBkZWVwIHx8IDE7CiAgaWYgKGRlZXAgPiAzKSByZXR1cm4ge30KCiAgY29uc3QgcmVzdWx0ID0ge307CiAgaWYgKHR5cGVvZiBvYmogPT09ICdvYmplY3QnKSB7CiAgICBmb3IgKGNvbnN0IGtleSBpbiBvYmopIHsKICAgICAgY29uc3QgdmFsID0gb2JqW2tleV07CiAgICAgIGNvbnN0IHZhbFR5cGUgPSB0eXBlb2YgdmFsOwogICAgICBpZiAodmFsVHlwZSA9PT0gJ251bWJlcicgfHwgdmFsVHlwZSA9PT0gJ3N0cmluZycgfHwgdmFsVHlwZSA9PT0gJ2Jvb2xlYW4nKSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHJlc3VsdCwga2V5LCB7CiAgICAgICAgICB2YWx1ZTogdmFsLAogICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAodmFsVHlwZSA9PT0gJ29iamVjdCcgJiYgT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgIC8qIOi/m+ihjOmAkuW9kuaPkOWPliAqLwogICAgICAgIHJlc3VsdFtrZXldID0gZXh0cmFjdERhdGFmcm9tT2IodmFsLCBkZWVwICsgMSk7CiAgICAgIH0gZWxzZSBpZiAodmFsVHlwZSA9PT0gJ2FycmF5JykgewogICAgICAgIHJlc3VsdFtrZXldID0gdmFsOwogICAgICB9IGVsc2UgOwogICAgfQogIH0KICByZXR1cm4gcmVzdWx0Cn0KCmNvbnN0IG1vbmtleU1zZyA9IHsKICAvKioKICAgKiDlj5HpgIHmtojmga/vvIzpmaTkuobmraPluLjlj5HpgIHkv6Hmga/lpJbvvIzov5jkvJrooaXlhYXlkITnsbvlv4XopoHnmoTkv6Hmga8KICAgKiBAcGFyYW0gbmFtZSB7c3RyaW5nfSAt5b+F6YCJIOimgeWPkemAgee7memCo+S4quWtl+aute+8jOaOpeaUtuaXtuimgeS4gOiHtOaJjeiDveebkeWQrOeahOato+ehrgogICAqIEBwYXJhbSBkYXRhIHtBbnl9IC3lv4XpgIkg6KaB5Y+R6YCB55qE5pWw5o2uCiAgICogQHBhcmFtIHRocm90dGxlSW50ZXJ2YWwgLeWPr+mAie+8jOWboOS4uuS8muWHuueOsOiOq+WQjeWlh+WmmeeahOmHjeWkjeWPkemAgeaDheWGte+8jOS4uuS6hua2iOmZpOmHjeWkjeWPkemAgeW4puadpeeahOWJr+S9nOeUqO+8jOaJgOS7peW8leWFpeiKgua1gemZkOWItumAu+i+ke+8jOWNs+mZkOWItuafkOS4quaXtumXtOmXtOmalOWGheWPquiDveWPkemAgeS4gOasoe+8jOWkmuS9meeahOasoeaVsOiHquWKqOaKm+W8g+aOie+8jOm7mOiupDgwbXMKICAgKiBAcmV0dXJucyB7UHJvbWlzZTx2b2lkPn0KICAgKi8KICBzZW5kIChuYW1lLCBkYXRhLCB0aHJvdHRsZUludGVydmFsID0gODApIHsKICAgIGlmICghd2luZG93LkdNX2dldFZhbHVlIHx8ICF3aW5kb3cuR01fc2V0VmFsdWUpIHsKICAgICAgcmV0dXJuIGZhbHNlCiAgICB9CgogICAgLyog6Zi75q2i6aKR57mB5Y+R6YCB5L+u5pS55LqL5Lu2ICovCiAgICBjb25zdCBvbGRNc2cgPSB3aW5kb3cuR01fZ2V0VmFsdWUobmFtZSk7CiAgICBpZiAob2xkTXNnICYmIG9sZE1zZy51cGRhdGVUaW1lKSB7CiAgICAgIGNvbnN0IGludGVydmFsID0gTWF0aC5hYnMoRGF0ZS5ub3coKSAtIG9sZE1zZy51cGRhdGVUaW1lKTsKICAgICAgaWYgKGludGVydmFsIDwgdGhyb3R0bGVJbnRlcnZhbCkgewogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CiAgICB9CgogICAgY29uc3QgbXNnID0gewogICAgICAvKiDlj5HpgIHov4fmnaXnmoTmlbDmja4gKi8KICAgICAgZGF0YSwKICAgICAgLyog6KGl5YWF5qCH562+SUTvvIznlKjkuo7liKTmlq3mmK/lkKblkIzlpITkuIDkuKp0YWLmoIfnrb7kuIsgKi8KICAgICAgdGFiSWQ6IGN1clRhYklkIHx8ICd1bmRlZmluZWQnLAogICAgICAvKiDooaXlhYXmtojmga/nmoTpobXpnaLmnaXmupDnmoTmoIfpopjkv6Hmga8gKi8KICAgICAgdGl0bGU6IGRvY3VtZW50LnRpdGxlLAogICAgICAvKiDooaXlhYXmtojmga/nmoTpobXpnaLmnaXmupDkv6Hmga8gKi8KICAgICAgcmVmZXJyZXI6IGV4dHJhY3REYXRhZnJvbU9iKHdpbmRvdy5sb2NhdGlvbiksCiAgICAgIC8qIOacgOi/keS4gOasoeabtOaWsOivpeaVsOaNrueahOaXtumXtCAqLwogICAgICB1cGRhdGVUaW1lOiBEYXRlLm5vdygpCiAgICB9OwogICAgaWYgKHR5cGVvZiBkYXRhID09PSAnb2JqZWN0JykgewogICAgICBtc2cuZGF0YSA9IGV4dHJhY3REYXRhZnJvbU9iKGRhdGEpOwogICAgfQogICAgd2luZG93LkdNX3NldFZhbHVlKG5hbWUsIG1zZyk7CgogICAgLy8gZGVidWcuaW5mbyhgW21vbmtleU1zZy1zZW5kXVske25hbWV9XWAsIG1zZykKICB9LAogIHNldDogKG5hbWUsIGRhdGEpID0+IG1vbmtleU1zZy5zZW5kKG5hbWUsIGRhdGEpLAogIGdldDogKG5hbWUpID0+IHdpbmRvdy5HTV9nZXRWYWx1ZSAmJiB3aW5kb3cuR01fZ2V0VmFsdWUobmFtZSksCiAgb246IChuYW1lLCBmbikgPT4gd2luZG93LkdNX2FkZFZhbHVlQ2hhbmdlTGlzdGVuZXIgJiYgd2luZG93LkdNX2FkZFZhbHVlQ2hhbmdlTGlzdGVuZXIobmFtZSwgZnVuY3Rpb24gKG5hbWUsIG9sZFZhbCwgbmV3VmFsLCByZW1vdGUpIHsKICAgIC8vIGRlYnVnLmluZm8oYFttb25rZXlNc2ctb25dWyR7bmFtZX1dYCwgb2xkVmFsLCBuZXdWYWwsIHJlbW90ZSkKCiAgICAvKiDooaXlhYXmtojmga/mnaXmupDmmK/lkKblh7roh6rlkIzkuIDkuKpUYWLnmoTliKTmlq3lrZfmrrUgKi8KICAgIG5ld1ZhbC5vcmlnaW5UYWIgPSBuZXdWYWwudGFiSWQgPT09IGN1clRhYklkOwoKICAgIGZuIGluc3RhbmNlb2YgRnVuY3Rpb24gJiYgZm4uYXBwbHkobnVsbCwgYXJndW1lbnRzKTsKICB9KSwKICBvZmY6IChsaXN0ZW5lcklkKSA9PiB3aW5kb3cuR01fcmVtb3ZlVmFsdWVDaGFuZ2VMaXN0ZW5lciAmJiB3aW5kb3cuR01fcmVtb3ZlVmFsdWVDaGFuZ2VMaXN0ZW5lcihsaXN0ZW5lcklkKSwKCiAgLyoqCiAgICog6L+b6KGMbW9ua2V5TXNn55qE5raI5oGv5bm/5pKt77yM6K+l5bm/5pKt5q+P5Lik56eS6ZKf5Y+R6YCB5LiA5qyh77yM5YW25a6D5Lu75oSP6aG16Z2i5Y+v6YCa5o6l5pS25Yiw55qE5bm/5pKt5L+h5oGv5p2l5pu05paw5LiA5Lqb5Y+Y6YeP5L+h5oGvCiAgICog5Li76KaB55So5Lul6Kej5Yaz6YCa6L+Hc2V0SW50ZXJ2YWzmiJZzZXRUaW1lb3V05Zug6aG16Z2i5Y+v6KeG54q25oCB5ZKM5oCn6IO9562W55Wl5a+86Ie055qE5LiN6L+Q6KGM5oiW5omn6KGM6aKR546H5byC5bi46ICM5LiN6IO95q2j56Gu5pu05paw5Y+Y6YeP54q25oCB55qE6Zeu6aKYCiAgICog6KeB77yaIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL3poLUNOL2RvY3MvV2ViL0FQSS9QYWdlX1Zpc2liaWxpdHlfQVBJCiAgICog5bm/5pKt5Lmf5LiN6IO9MTAwJeS/neivgeS4jeWPl+aAp+iDveetlueVpeeahOW9seWTje+8jOS9huWPquimgeacieS4gOS4que9kemhteWkhOS6juWJjeWPsOi/kOihjO+8jOWImeWwseiDveato+W4uOW3peS9nAogICAqIEBwYXJhbSBoYW5kbGVyIHtGdW5jdGlvbn0gLeW/hemAiSDmjqXmlLbliLDlub/mkq3kv6Hmga/ml7bnmoTlm57osIPlh73mlbAKICAgKiBAcmV0dXJucwogICAqLwogIGJyb2FkY2FzdCAoaGFuZGxlcikgewogICAgY29uc3QgYnJvYWRjYXN0TmFtZSA9ICdfX21vbmtleU1zZ0Jyb2FkY2FzdF9fJzsKICAgIG1vbmtleU1zZy5fbW9ua2V5TXNnQnJvYWRjYXN0SGFuZGxlcl8gPSBtb25rZXlNc2cuX21vbmtleU1zZ0Jyb2FkY2FzdEhhbmRsZXJfIHx8IFtdOwogICAgaGFuZGxlciBpbnN0YW5jZW9mIEZ1bmN0aW9uICYmIG1vbmtleU1zZy5fbW9ua2V5TXNnQnJvYWRjYXN0SGFuZGxlcl8ucHVzaChoYW5kbGVyKTsKCiAgICBpZiAobW9ua2V5TXNnLl9oYXNNb25rZXlNc2dCcm9hZGNhc3RfKSB7CiAgICAgIHJldHVybiBicm9hZGNhc3ROYW1lCiAgICB9CgogICAgbW9ua2V5TXNnLm9uKGJyb2FkY2FzdE5hbWUsIGZ1bmN0aW9uICgpIHsKICAgICAgbW9ua2V5TXNnLl9tb25rZXlNc2dCcm9hZGNhc3RIYW5kbGVyXy5mb3JFYWNoKGhhbmRsZXIgPT4gewogICAgICAgIGhhbmRsZXIuYXBwbHkobnVsbCwgYXJndW1lbnRzKTsKICAgICAgfSk7CiAgICB9KTsKCiAgICBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgIC8qIOmAmui/h+mZkOWumuaXtumXtOmXtOmalOadpemYsuatouWkmuS4qumhtemdouaJuemHj+WPkei1t+W5v+aSreS/oeaBryAqLwogICAgICBjb25zdCBkYXRhID0gbW9ua2V5TXNnLmdldChicm9hZGNhc3ROYW1lKTsKICAgICAgaWYgKGRhdGEgJiYgRGF0ZS5ub3coKSAtIGRhdGEudXBkYXRlVGltZSA8IDEwMDAgKiAyKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KCiAgICAgIG1vbmtleU1zZy5zZW5kKGJyb2FkY2FzdE5hbWUsIHt9KTsKICAgIH0sIDEwMDAgKiAyKTsKCiAgICByZXR1cm4gYnJvYWRjYXN0TmFtZQogIH0KfTsKCi8qIQogKiBAbmFtZSAgICAgICAgIGNyb3NzVGFiQ3RsLmpzCiAqIEBkZXNjcmlwdGlvbiAg6LeoVGFi5o6n5Yi26ISa5pys6YC76L6RCiAqIEB2ZXJzaW9uICAgICAgMC4wLjEKICogQGF1dGhvciAgICAgICBCbGF6ZQogKiBAZGF0ZSAgICAgICAgIDIwMTkvMTEvMjEg5LiK5Y2IMTE6NTYKICogQGdpdGh1YiAgICAgICBodHRwczovL2dpdGh1Yi5jb20veHh4aWx5CiAqLwoKCmNvbnN0IGNyb3NzVGFiQ3RsID0gewogIC8qIOWcqOi/m+ihjOi3qFRhYuaOp+WItuaXtu+8jOaOkumZpOi9rOWPkeeahOW/q+aNt+mUru+8jOS7peWHj+WwkeWvuemHjeimgeW/q+aNt+mUrueahOW5suaJsCAqLwogIGV4Y2x1ZGVTaG9ydGN1dHMgKGV2ZW50KSB7CiAgICBpZiAoIWV2ZW50IHx8IHR5cGVvZiBldmVudC5rZXlDb2RlID09PSAndW5kZWZpbmVkJykgewogICAgICByZXR1cm4gZmFsc2UKICAgIH0KCiAgICBjb25zdCBleGNsdWRlS2V5Q29kZSA9IFsnYycsICd2JywgJ2YnLCAnZCddOwoKICAgIGlmIChldmVudC5jdHJsS2V5IHx8IGV2ZW50Lm1ldGFLZXkpIHsKICAgICAgY29uc3Qga2V5ID0gZXZlbnQua2V5LnRvTG93ZXJDYXNlKCk7CiAgICAgIGlmIChleGNsdWRlS2V5Q29kZS5pbmNsdWRlcyhrZXkpKSB7CiAgICAgICAgcmV0dXJuIHRydWUKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGZhbHNlCiAgICB9CiAgfSwKICAvKiDmhI/lpJbpgIDlh7rnmoTml7blgJlsZWF2ZXBpY3R1cmVpbnBpY3R1cmXkuovku7blubbkuI3kvJrooqvosIPnlKjvvIzmiYDku6Xlj6rog73pgJrov4fova7or6LmnaXmm7TmlrDnlLvkuK3nlLvkv6Hmga8gKi8KICB1cGRhdGVQaWN0dXJlSW5QaWN0dXJlSW5mbyAoKSB7CiAgICBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChkb2N1bWVudC5waWN0dXJlSW5QaWN0dXJlRWxlbWVudCkgewogICAgICAgIG1vbmtleU1zZy5zZW5kKCdnbG9iYWxQaWN0dXJlSW5QaWN0dXJlSW5mbycsIHsKICAgICAgICAgIHVzZVBpY3R1cmVJblBpY3R1cmU6IHRydWUKICAgICAgICB9KTsKICAgICAgfQogICAgfSwgMTAwMCAqIDEuNSk7CgogICAgLyoqCiAgICAgKiDpgJrov4dzZXRJbnRlcnZhbOadpeabtOaWsGdsb2JhbFBpY3R1cmVJblBpY3R1cmVJbmZv5Lya5Y+X6aG16Z2i5Y+v6KeB5oCn5ZKM5oCn6IO9562W55Wl5b2x5ZON6ICM5b6X5LiN5Yiw5pu05pawCiAgICAgKiDop4HvvJogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvQVBJL1BhZ2VfVmlzaWJpbGl0eV9BUEkKICAgICAqIOaJgOS7pemAmui/h+WinuWKoG1vbmtleU1zZ+W5v+aSreacuuWItuadpeagoeWHhmdsb2JhbFBpY3R1cmVJblBpY3R1cmVJbmZv54q25oCBCiAgICAgKi8KICAgIG1vbmtleU1zZy5icm9hZGNhc3QoZnVuY3Rpb24gKCkgewogICAgICAvLyBjb25zb2xlLmxvZygnW21vbmtleU1zZ11bYnJvYWRjYXN0XScsIC4uLmFyZ3VtZW50cykKICAgICAgaWYgKGRvY3VtZW50LnBpY3R1cmVJblBpY3R1cmVFbGVtZW50KSB7CiAgICAgICAgbW9ua2V5TXNnLnNlbmQoJ2dsb2JhbFBpY3R1cmVJblBpY3R1cmVJbmZvJywgewogICAgICAgICAgdXNlUGljdHVyZUluUGljdHVyZTogdHJ1ZQogICAgICAgIH0pOwogICAgICB9CiAgICB9KTsKICB9LAogIC8qIOWIpOaWreW9k+WJjeaYr+WQpuW8gOWQr+S6hueUu+S4reeUu+WKn+iDvSAqLwogIGhhc09wZW5QaWN0dXJlSW5QaWN0dXJlICgpIHsKICAgIGNvbnN0IGRhdGEgPSBtb25rZXlNc2cuZ2V0KCdnbG9iYWxQaWN0dXJlSW5QaWN0dXJlSW5mbycpOwoKICAgIC8qIOeUu+S4reeUu+eahOWFqOWxgOS/oeaBr+abtOaWsOaXtumXtOW3ruWcqDNz5YaF77yM5omN6K6k5Li65b2T5YmN5byA5ZCv5LqG55S75Lit55S75qih5byP77yM5ZCm5YiZ5pyJ5Y+v6IO95oSP5aSW6YCA5Ye677yM6ICM5rKh5L+u5pS5dXNlUGljdHVyZUluUGljdHVyZeeahOWAvO+8jOmAoOaIkOivr+WIpCAqLwogICAgaWYgKGRhdGEgJiYgZGF0YS5kYXRhKSB7CiAgICAgIGlmIChkYXRhLmRhdGEudXNlUGljdHVyZUluUGljdHVyZSkgewogICAgICAgIHJldHVybiBNYXRoLmFicyhEYXRlLm5vdygpIC0gZGF0YS51cGRhdGVUaW1lKSA8IDEwMDAgKiAzCiAgICAgIH0gZWxzZSB7CiAgICAgICAgLyoqCiAgICAgICAgICog5qOA5rWL5Yiw55S75Lit55S75bey57uP6KKr5YWz6Zet77yM5L2G6L+Y5rKh5YWz6Zet5aSq5LmF55qE6K+d77yM5YWB6K645pyJ5Liq55+t5pqC55qE5pe26Ze05q615YaF6K6p55So5oi36LeoVEFC5o6n5Yi26KeG6aKRCiAgICAgICAgICog5L6L5aaC77ya5pqC5YGc6KeG6aKR5pKt5pS+CiAgICAgICAgICovCiAgICAgICAgcmV0dXJuIE1hdGguYWJzKERhdGUubm93KCkgLSBkYXRhLnVwZGF0ZVRpbWUpIDwgMTAwMCAqIDE1CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZmFsc2UKICB9LAogIC8qKgogICAqIOWIpOaWreaYr+WQpumcgOimgeWPkemAgei3qFRhYuaOp+WItuaMiemUruS/oeaBrwogICAqLwogIGlzTmVlZFNlbmRDcm9zc1RhYkN0bEV2ZW50ICgpIHsKICAgIGNvbnN0IHQgPSBjcm9zc1RhYkN0bDsKCiAgICAvKiDnlLvkuK3nlLvlvIDlkK/lkI7vvIzliKTmlq3kuI3lnKjlkIzkuIDkuKpUYWLmiY3lj5HpgIHkuovku7YgKi8KICAgIGNvbnN0IGRhdGEgPSBtb25rZXlNc2cuZ2V0KCdnbG9iYWxQaWN0dXJlSW5QaWN0dXJlSW5mbycpOwogICAgaWYgKHQuaGFzT3BlblBpY3R1cmVJblBpY3R1cmUoKSAmJiBkYXRhLnRhYklkICE9PSBjdXJUYWJJZCkgewogICAgICByZXR1cm4gdHJ1ZQogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGZhbHNlCiAgICB9CiAgfSwKICBjcm9zc1RhYktleWRvd25FdmVudCAoZXZlbnQpIHsKICAgIGNvbnN0IHQgPSBjcm9zc1RhYkN0bDsKICAgIC8qIOWkhOS6juWPr+e8lui+keWFg+e0oOS4reS4jeaJp+ihjOS7u+S9leW/q+aNt+mUriAqLwogICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQuY29tcG9zZWRQYXRoID8gZXZlbnQuY29tcG9zZWRQYXRoKClbMF0gfHwgZXZlbnQudGFyZ2V0IDogZXZlbnQudGFyZ2V0OwogICAgaWYgKGlzRWRpdGFibGVUYXJnZXQodGFyZ2V0KSkgcmV0dXJuCiAgICBpZiAodC5pc05lZWRTZW5kQ3Jvc3NUYWJDdGxFdmVudCgpICYmIGlzUmVnaXN0ZXJLZXkoZXZlbnQpICYmICF0LmV4Y2x1ZGVTaG9ydGN1dHMoZXZlbnQpKSB7CiAgICAgIC8vIOmYu+atouS6i+S7tuWGkuazoeWSjOm7mOiupOS6i+S7tgogICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKCiAgICAgIC8qIOW5v+aSreaMiemUrua2iOaBr++8jOi/m+ihjOi3qFRhYuaOp+WItiAqLwogICAgICAvLyBrZXlkb3duRXZlbnTph4zlt7Lnu4/ljIXlkKvkuoZnbG9iYWxLZXlkb3duRXZlbnTkuovku7YKICAgICAgLy8gbW9ua2V5TXNnLnNlbmQoJ2dsb2JhbEtleWRvd25FdmVudCcsIGV2ZW50KQoKICAgICAgcmV0dXJuIHRydWUKICAgIH0KICB9LAogIGJpbmRDcm9zc1RhYkV2ZW50ICgpIHsKICAgIGNvbnN0IHQgPSBjcm9zc1RhYkN0bDsKICAgIGlmICh0Ll9oYXNCaW5kRXZlbnRfKSByZXR1cm4KICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0LmNyb3NzVGFiS2V5ZG93bkV2ZW50KTsKICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0LmNyb3NzVGFiS2V5ZG93bkV2ZW50LCB0cnVlKTsKICAgIHQuX2hhc0JpbmRFdmVudF8gPSB0cnVlOwogIH0sCiAgaW5pdCAoKSB7CiAgICBjb25zdCB0ID0gY3Jvc3NUYWJDdGw7CiAgICB0LnVwZGF0ZVBpY3R1cmVJblBpY3R1cmVJbmZvKCk7CiAgICB0LmJpbmRDcm9zc1RhYkV2ZW50KCk7CiAgfQp9OwoKLyohCiAqIEBuYW1lICAgICAgICAgaW5kZXguanMKICogQGRlc2NyaXB0aW9uICBob29rSnMgSlMgQU9Q5YiH6Z2i57yW56iL6L6F5Yqp5bqTCiAqIEB2ZXJzaW9uICAgICAgMC4wLjEKICogQGF1dGhvciAgICAgICBCbGF6ZQogKiBAZGF0ZSAgICAgICAgIDIwMjAvMTAvMjIgMTc6NDAKICogQGdpdGh1YiAgICAgICBodHRwczovL2dpdGh1Yi5jb20veHh4aWx5CiAqLwoKY29uc3Qgd2luID0gdHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcgPyBnbG9iYWwgOiB3aW5kb3c7CmNvbnN0IHRvU3RyID0gRnVuY3Rpb24ucHJvdG90eXBlLmNhbGwuYmluZChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nKTsKLyog54m55q6K5Zy65pmv77yM5aaC5p6c5oqKQm9vbGVhbuS5n2hvb2vkuobvvIzlvojlrrnmmJPlr7zoh7TosIPnlKjmuqLlh7rvvIzmiYDku6XmmK/pnIDopoHkvb/nlKjljp/nlJ9Cb29sZWFuICovCmNvbnN0IHRvQm9vbGVhbiA9IEJvb2xlYW4ub3JpZ2luTWV0aG9kID8gQm9vbGVhbi5vcmlnaW5NZXRob2QgOiBCb29sZWFuOwpjb25zdCB1dGlsID0gewogIHRvU3RyLAogIGlzT2JqOiBvYmogPT4gdG9TdHIob2JqKSA9PT0gJ1tvYmplY3QgT2JqZWN0XScsCiAgLyog5Yik5pat5piv5ZCm5Li65byV55So57G75Z6L77yM55So5LqO5pu05a695rOb55qE5Zy65pmvICovCiAgaXNSZWY6IG9iaiA9PiB0eXBlb2Ygb2JqID09PSAnb2JqZWN0JywKICBpc1JlZzogb2JqID0+IHRvU3RyKG9iaikgPT09ICdbb2JqZWN0IFJlZ0V4cF0nLAogIGlzRm46IG9iaiA9PiBvYmogaW5zdGFuY2VvZiBGdW5jdGlvbiwKICBpc0FzeW5jRm46IGZuID0+IHRvU3RyKGZuKSA9PT0gJ1tvYmplY3QgQXN5bmNGdW5jdGlvbl0nLAogIGlzUHJvbWlzZTogb2JqID0+IHRvU3RyKG9iaikgPT09ICdbb2JqZWN0IFByb21pc2VdJywKICBmaXJzdFVwcGVyQ2FzZTogc3RyID0+IHN0ci5yZXBsYWNlKC9eXFMvLCBzID0+IHMudG9VcHBlckNhc2UoKSksCiAgdG9BcnI6IGFyZyA9PiBBcnJheS5mcm9tKEFycmF5LmlzQXJyYXkoYXJnKSA/IGFyZyA6IFthcmddKSwKCiAgZGVidWc6IHsKICAgIGxvZyAoKSB7CiAgICAgIGxldCBsb2cgPSB3aW4uY29uc29sZS5sb2c7CiAgICAgIC8qIOWmguaenGxvZ+S5n+iiq2hvb2vkuobvvIzliJnkvb/nlKjmnKrooqtob29r5YmN55qEbG9n5Ye95pWwICovCiAgICAgIGlmIChsb2cub3JpZ2luTWV0aG9kKSB7IGxvZyA9IGxvZy5vcmlnaW5NZXRob2Q7IH0KICAgICAgaWYgKHdpbi5fZGVidWdNb2RlXykgewogICAgICAgIGxvZy5hcHBseSh3aW4uY29uc29sZSwgYXJndW1lbnRzKTsKICAgICAgfQogICAgfQogIH0sCiAgLyog6I635Y+W5YyF5ZCr6Ieq6Lqr44CB57un5om/44CB5Y+v5p6a5Li+44CB5LiN5Y+v5p6a5Li+55qE6ZSu5ZCNICovCiAgZ2V0QWxsS2V5cyAob2JqKSB7CiAgICBjb25zdCB0bXBBcnIgPSBbXTsKICAgIGZvciAoY29uc3Qga2V5IGluIG9iaikgeyB0bXBBcnIucHVzaChrZXkpOyB9CiAgICBjb25zdCBhbGxLZXlzID0gQXJyYXkuZnJvbShuZXcgU2V0KHRtcEFyci5jb25jYXQoUmVmbGVjdC5vd25LZXlzKG9iaikpKSk7CiAgICByZXR1cm4gYWxsS2V5cwogIH0KfTsKCmNsYXNzIEhvb2tKcyB7CiAgY29uc3RydWN0b3IgKHVzZVByb3h5KSB7CiAgICB0aGlzLnVzZVByb3h5ID0gdXNlUHJveHkgfHwgZmFsc2U7CiAgICB0aGlzLmhvb2tQcm9wZXJ0aWVzS2V5TmFtZSA9ICdfaG9va1Byb3BlcnRpZXMnICsgRGF0ZS5ub3coKTsKICB9CgogIGhvb2tKc1BybyAoKSB7CiAgICByZXR1cm4gbmV3IEhvb2tKcyh0cnVlKQogIH0KCiAgX2FkZEhvb2sgKGhvb2tNZXRob2QsIGZuLCB0eXBlLCBjbGFzc0hvb2spIHsKICAgIGNvbnN0IGhvb2tLZXlOYW1lID0gdHlwZSArICdIb29rcyc7CiAgICBjb25zdCBob29rTWV0aG9kUHJvcGVydGllcyA9IGhvb2tNZXRob2RbdGhpcy5ob29rUHJvcGVydGllc0tleU5hbWVdOwogICAgaWYgKCFob29rTWV0aG9kUHJvcGVydGllc1tob29rS2V5TmFtZV0pIHsKICAgICAgaG9va01ldGhvZFByb3BlcnRpZXNbaG9va0tleU5hbWVdID0gW107CiAgICB9CgogICAgLyog5rOo5YaM77yI5YKo5a2Y77yJ6KaB6KKr6LCD55So55qEaG9va+WHveaVsO+8jOWQjOaXtumYsuatoumHjeWkjeazqOWGjCAqLwogICAgbGV0IGhhc1NhbWVIb29rID0gZmFsc2U7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGhvb2tNZXRob2RQcm9wZXJ0aWVzW2hvb2tLZXlOYW1lXS5sZW5ndGg7IGkrKykgewogICAgICBpZiAoZm4gPT09IGhvb2tNZXRob2RQcm9wZXJ0aWVzW2hvb2tLZXlOYW1lXVtpXSkgewogICAgICAgIGhhc1NhbWVIb29rID0gdHJ1ZTsKICAgICAgICBicmVhawogICAgICB9CiAgICB9CgogICAgaWYgKCFoYXNTYW1lSG9vaykgewogICAgICBmbi5jbGFzc0hvb2sgPSBjbGFzc0hvb2sgfHwgZmFsc2U7CiAgICAgIGhvb2tNZXRob2RQcm9wZXJ0aWVzW2hvb2tLZXlOYW1lXS5wdXNoKGZuKTsKICAgIH0KICB9CgogIF9ydW5Ib29rcyAocGFyZW50T2JqLCBtZXRob2ROYW1lLCBvcmlnaW5NZXRob2QsIGhvb2tNZXRob2QsIHRhcmdldCwgY3R4LCBhcmdzLCBjbGFzc0hvb2ssIGhvb2tQcm9wZXJ0aWVzS2V5TmFtZSkgewogICAgY29uc3QgaG9va01ldGhvZFByb3BlcnRpZXMgPSBob29rTWV0aG9kW2hvb2tQcm9wZXJ0aWVzS2V5TmFtZV07CiAgICBjb25zdCBiZWZvcmVIb29rcyA9IGhvb2tNZXRob2RQcm9wZXJ0aWVzLmJlZm9yZUhvb2tzIHx8IFtdOwogICAgY29uc3QgYWZ0ZXJIb29rcyA9IGhvb2tNZXRob2RQcm9wZXJ0aWVzLmFmdGVySG9va3MgfHwgW107CiAgICBjb25zdCBlcnJvckhvb2tzID0gaG9va01ldGhvZFByb3BlcnRpZXMuZXJyb3JIb29rcyB8fCBbXTsKICAgIGNvbnN0IGhhbmdVcEhvb2tzID0gaG9va01ldGhvZFByb3BlcnRpZXMuaGFuZ1VwSG9va3MgfHwgW107CiAgICBjb25zdCByZXBsYWNlSG9va3MgPSBob29rTWV0aG9kUHJvcGVydGllcy5yZXBsYWNlSG9va3MgfHwgW107CiAgICBjb25zdCBleGVjSW5mbyA9IHsKICAgICAgcmVzdWx0OiBudWxsLAogICAgICBlcnJvcjogbnVsbCwKICAgICAgYXJncywKICAgICAgdHlwZTogJycKICAgIH07CgogICAgZnVuY3Rpb24gcnVuSG9va3MgKGhvb2tzLCB0eXBlKSB7CiAgICAgIGxldCBob29rUmVzdWx0ID0gbnVsbDsKICAgICAgZXhlY0luZm8udHlwZSA9IHR5cGUgfHwgJyc7CiAgICAgIGlmIChBcnJheS5pc0FycmF5KGhvb2tzKSkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaG9va3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNvbnN0IGZuID0gaG9va3NbaV07CiAgICAgICAgICBpZiAodXRpbC5pc0ZuKGZuKSAmJiBjbGFzc0hvb2sgPT09IGZuLmNsYXNzSG9vaykgewogICAgICAgICAgICBob29rUmVzdWx0ID0gZm4oYXJncywgcGFyZW50T2JqLCBtZXRob2ROYW1lLCBvcmlnaW5NZXRob2QsIGV4ZWNJbmZvLCBjdHgpOwogICAgICAgICAgICBpZiAoaG9va1Jlc3VsdCA9PT0gJ1NUT1AtSU5WT0tFJykgewogICAgICAgICAgICAgIHJldHVybiBob29rUmVzdWx0CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGhvb2tSZXN1bHQKICAgIH0KCiAgICBjb25zdCBydW5UYXJnZXQgPSBjbGFzc0hvb2sKICAgICAgPyBmdW5jdGlvbiAoKSB7IHJldHVybiBuZXcgdGFyZ2V0KC4uLmFyZ3MpIH0KICAgICAgOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0YXJnZXQuYXBwbHkoY3R4LCBhcmdzKSB9OwoKICAgIGNvbnN0IGJlZm9yZUhvb2tzUmVzdWx0ID0gcnVuSG9va3MoYmVmb3JlSG9va3MsICdiZWZvcmUnKTsKICAgIGlmIChiZWZvcmVIb29rc1Jlc3VsdCA9PT0gJ1NUT1AtSU5WT0tFJykgewogICAgICByZXR1cm4gYmVmb3JlSG9va3NSZXN1bHQKICAgIH0KCiAgICBpZiAoaGFuZ1VwSG9va3MubGVuZ3RoIHx8IHJlcGxhY2VIb29rcy5sZW5ndGgpIHsKICAgICAgLyoqCiAgICAgICAqIOW9k+WtmOWcqGhhbmdVcEhvb2tz5oiWcmVwbGFjZUhvb2tz55qE5pe25YCZ5piv5LiN5Lya6Kem5Y+R5Y6f5p2l5Ye95pWw55qECiAgICAgICAqIOacrOi0qOS4iuadpeivtGhhbmdVcEhvb2tz5ZKMcmVwbGFjZUhvb2tz5piv5LiA5qC355qE77yM5Y+q5piv5aSW6YOo55qE5a6a5LmJ5o+P6L+w5LiN5LiA6Ie05ZKM5YiG57G75LiN5LiA6Ie06ICM5beyCiAgICAgICAqLwogICAgICBydW5Ib29rcyhoYW5nVXBIb29rcywgJ2hhbmdVcCcpOwogICAgICBydW5Ib29rcyhyZXBsYWNlSG9va3MsICdyZXBsYWNlJyk7CiAgICB9IGVsc2UgewogICAgICBpZiAoZXJyb3JIb29rcy5sZW5ndGgpIHsKICAgICAgICB0cnkgewogICAgICAgICAgZXhlY0luZm8ucmVzdWx0ID0gcnVuVGFyZ2V0KCk7CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBleGVjSW5mby5lcnJvciA9IGVycjsKICAgICAgICAgIGNvbnN0IGVycm9ySG9va3NSZXN1bHQgPSBydW5Ib29rcyhlcnJvckhvb2tzLCAnZXJyb3InKTsKICAgICAgICAgIGlmIChlcnJvckhvb2tzUmVzdWx0ICE9PSAnU0tJUC1FUlJPUicpIHsKICAgICAgICAgICAgdGhyb3cgZXJyCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGV4ZWNJbmZvLnJlc3VsdCA9IHJ1blRhcmdldCgpOwogICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiDmiafooYxhZnRlckhvb2tz77yM5aaC5p6c6L+U5Zue55qE5pivUHJvbWlzZe+8jOeQhuiuuuS4iuW6lOivpei/m+ihjOi/m+S4gOatpeeahOe7huWIhuWkhOeQhgogICAgICog5L2G5re75Yqg57uG5YiG5aSE55CG6YC76L6R5ZCO5Y+R546w5oCn6IO95LiL6ZmN5b6X5q+U6L6D5Y6J5a6z77yM5LiU5a655piT5Ye6546w5ZCE56eN5byC5bi477yM5omA5Lul5Yaz5a6a5LiN5ZyoaG9va+mHjOWkhOeQhlByb21pc2Xmg4XlhrUKICAgICAqIOS4i+mdouaYr+WOn1Byb21pc2XlpITnkIbpgLvovpHvvIzmt7vliqDlkI7kvJrlr7zoh7Tku6XkuIvnvZHnq5nljaHmrbvmiJbml6Dms5Xorr/pl67vvJoKICAgICAqIHdlbmt1LmJhaWR1LmNvbQogICAgICogaHR0cHM6Ly9wdWJzLnJzYy5vcmcvZW4vY29udGVudC9hcnRpY2xlbGFuZGluZy8yMDIxL3NjL2Qxc2MwMTg4MWcjIWRpdkFic3RyYWN0CiAgICAgKiBodHRwczovL3d3dy5lbHNldmllci5jb20vY29ubmVjdC9jb3JvbmF2aXJ1cy1pbmZvcm1hdGlvbi1jZW50ZXIKICAgICAqLwogICAgLy8gaWYgKGV4ZWNJbmZvLnJlc3VsdCAmJiBleGVjSW5mby5yZXN1bHQudGhlbiAmJiB1dGlsLmlzUHJvbWlzZShleGVjSW5mby5yZXN1bHQpKSB7CiAgICAvLyAgIGV4ZWNJbmZvLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAvLyAgICAgZXhlY0luZm8ucmVzdWx0ID0gZGF0YQogICAgLy8gICAgIHJ1bkhvb2tzKGFmdGVySG9va3MsICdhZnRlcicpCiAgICAvLyAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZS5hcHBseShjdHgsIGFyZ3VtZW50cykKICAgIC8vICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgLy8gICAgIGV4ZWNJbmZvLmVycm9yID0gZXJyCiAgICAvLyAgICAgcnVuSG9va3MoZXJyb3JIb29rcywgJ2Vycm9yJykKICAgIC8vICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QuYXBwbHkoY3R4LCBhcmd1bWVudHMpCiAgICAvLyAgIH0pCiAgICAvLyB9CgogICAgcnVuSG9va3MoYWZ0ZXJIb29rcywgJ2FmdGVyJyk7CgogICAgcmV0dXJuIGV4ZWNJbmZvLnJlc3VsdAogIH0KCiAgX3Byb3h5TWV0aG9kY0dlbmVyYXRvciAocGFyZW50T2JqLCBtZXRob2ROYW1lLCBvcmlnaW5NZXRob2QsIGNsYXNzSG9vaywgY29udGV4dCwgcHJveHlIYW5kbGVyKSB7CiAgICBjb25zdCB0ID0gdGhpczsKICAgIGNvbnN0IHVzZVByb3h5ID0gdC51c2VQcm94eTsKICAgIGxldCBob29rTWV0aG9kID0gbnVsbDsKCiAgICAvKiDlrZjlnKjnvJPlrZjliJnkvb/nlKjnvJPlrZjnmoRob29rTWV0aG9kICovCiAgICBpZiAodC5pc0hvb2sob3JpZ2luTWV0aG9kKSkgewogICAgICBob29rTWV0aG9kID0gb3JpZ2luTWV0aG9kOwogICAgfSBlbHNlIGlmIChvcmlnaW5NZXRob2RbdC5ob29rUHJvcGVydGllc0tleU5hbWVdICYmIHQuaXNIb29rKG9yaWdpbk1ldGhvZFt0Lmhvb2tQcm9wZXJ0aWVzS2V5TmFtZV0uaG9va01ldGhvZCkpIHsKICAgICAgaG9va01ldGhvZCA9IG9yaWdpbk1ldGhvZFt0Lmhvb2tQcm9wZXJ0aWVzS2V5TmFtZV0uaG9va01ldGhvZDsKICAgIH0KCiAgICBpZiAoaG9va01ldGhvZCkgewogICAgICBpZiAoIWhvb2tNZXRob2RbdC5ob29rUHJvcGVydGllc0tleU5hbWVdLmlzSG9vaykgewogICAgICAgIC8qIOmHjeaWsOagh+azqOiiq2hvb2vnirbmgIEgKi8KICAgICAgICBob29rTWV0aG9kW3QuaG9va1Byb3BlcnRpZXNLZXlOYW1lXS5pc0hvb2sgPSB0cnVlOwogICAgICAgIHV0aWwuZGVidWcubG9nKGBbaG9vayBtZXRob2RdICR7dXRpbC50b1N0cihwYXJlbnRPYmopfSAke21ldGhvZE5hbWV9YCk7CiAgICAgIH0KICAgICAgcmV0dXJuIGhvb2tNZXRob2QKICAgIH0KCiAgICAvKiDkvb/nlKhQcm94eeaooeW8j+i/m+ihjGhvb2vlj6/ku6Xojrflvpfmm7TlpJrnibnmgKfvvIzkvYbmgKfog73kuZ/kvJrnqI3lt67kuIDkupsgKi8KICAgIGlmICh1c2VQcm94eSAmJiBQcm94eSkgewogICAgICAvKiDms6jmhI/vvJrkvb/nlKhQcm94eeS7o+eQhu+8jGhvb2tNZXRob2TlkoxvcmlnaW5NZXRob2TlsIblhbHnlKjlkIzkuIDlr7nosaEgKi8KICAgICAgY29uc3QgaGFuZGxlciA9IHsgLi4ucHJveHlIYW5kbGVyIH07CgogICAgICAvKiDkuIvpnaLnmoTlhpnms5Xnoa7lrprkuoZwcm94eUhhbmRsZXLmmK/ml6Dms5Xopobnm5Zjb25zdHJ1Y3TlkoxhcHBseeaTjeS9nOeahCAqLwogICAgICBpZiAoY2xhc3NIb29rKSB7CiAgICAgICAgaGFuZGxlci5jb25zdHJ1Y3QgPSBmdW5jdGlvbiAodGFyZ2V0LCBhcmdzLCBuZXdUYXJnZXQpIHsKICAgICAgICAgIGNvbnRleHQgPSBjb250ZXh0IHx8IHRoaXM7CiAgICAgICAgICByZXR1cm4gdC5fcnVuSG9va3MocGFyZW50T2JqLCBtZXRob2ROYW1lLCBvcmlnaW5NZXRob2QsIGhvb2tNZXRob2QsIHRhcmdldCwgY29udGV4dCwgYXJncywgdHJ1ZSwgdC5ob29rUHJvcGVydGllc0tleU5hbWUpCiAgICAgICAgfTsKICAgICAgfSBlbHNlIHsKICAgICAgICBoYW5kbGVyLmFwcGx5ID0gZnVuY3Rpb24gKHRhcmdldCwgY3R4LCBhcmdzKSB7CiAgICAgICAgICBjdHggPSBjb250ZXh0IHx8IGN0eDsKICAgICAgICAgIHJldHVybiB0Ll9ydW5Ib29rcyhwYXJlbnRPYmosIG1ldGhvZE5hbWUsIG9yaWdpbk1ldGhvZCwgaG9va01ldGhvZCwgdGFyZ2V0LCBjdHgsIGFyZ3MsIGZhbHNlLCB0Lmhvb2tQcm9wZXJ0aWVzS2V5TmFtZSkKICAgICAgICB9OwogICAgICB9CgogICAgICBob29rTWV0aG9kID0gbmV3IFByb3h5KG9yaWdpbk1ldGhvZCwgaGFuZGxlcik7CiAgICB9IGVsc2UgewogICAgICBob29rTWV0aG9kID0gZnVuY3Rpb24gKCkgewogICAgICAgIC8qKgogICAgICAgICAqIOazqOaEj+atpOWkhOS4jeiDvemAmui/hyBjb250ZXh0ID0gY29udGV4dCB8fCB0aGlzCiAgICAgICAgICog54S25ZCO6YCa6L+H5oqKY29udGV4dOW9k2N0eOS8oOmAkui/h+WOuwogICAgICAgICAqIOi/meWwhuWvvOiHtGN0eOW8leeUqOmUmeivrwogICAgICAgICAqLwogICAgICAgIGNvbnN0IGN0eCA9IGNvbnRleHQgfHwgdGhpczsKICAgICAgICByZXR1cm4gdC5fcnVuSG9va3MocGFyZW50T2JqLCBtZXRob2ROYW1lLCBvcmlnaW5NZXRob2QsIGhvb2tNZXRob2QsIG9yaWdpbk1ldGhvZCwgY3R4LCBhcmd1bWVudHMsIGNsYXNzSG9vaywgdC5ob29rUHJvcGVydGllc0tleU5hbWUpCiAgICAgIH07CgogICAgICAvKiDnoa7kv53lrZDlr7nosaHlkozljp/lnovpk77ot59vcmlnaW5NZXRob2Tkv53mjIHkuIDoh7QgKi8KICAgICAgY29uc3Qga2V5cyA9IFJlZmxlY3Qub3duS2V5cyhvcmlnaW5NZXRob2QpOwogICAgICBrZXlzLmZvckVhY2goa2V5TmFtZSA9PiB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShob29rTWV0aG9kLCBrZXlOYW1lLCB7CiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJldHVybiBvcmlnaW5NZXRob2Rba2V5TmFtZV0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgICAgICAgb3JpZ2luTWV0aG9kW2tleU5hbWVdID0gdmFsOwogICAgICAgICAgICB9LAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUKICAgICAgICAgIH0pOwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgLy8g6K6+572uZGVmaW5lUHJvcGVydHnnmoTml7blgJnlh7rnjrDlvILluLjvvIzlj6/og73lr7zoh7Rob29rTWV0aG9k6YOo5YiG5Yqf6IO957y65aSx77yM5Lmf5Y+v6IO95LiN5Y+X5b2x5ZONCiAgICAgICAgICB1dGlsLmRlYnVnLmxvZyhgW3Byb3h5TWV0aG9kY0dlbmVyYXRvcl0gaG9va01ldGhvZCBkZWZpbmVQcm9wZXJ0eSBhYm5vcm1hbC4gIGhvb2tNZXRob2Q6JHttZXRob2ROYW1lfSwgZGVmaW5lUHJvcGVydHlOYW1lOiR7a2V5TmFtZX1gLCBlcnIpOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIGhvb2tNZXRob2QucHJvdG90eXBlID0gb3JpZ2luTWV0aG9kLnByb3RvdHlwZTsKICAgIH0KCiAgICBjb25zdCBob29rTWV0aG9kUHJvcGVydGllcyA9IGhvb2tNZXRob2RbdC5ob29rUHJvcGVydGllc0tleU5hbWVdID0ge307CgogICAgaG9va01ldGhvZFByb3BlcnRpZXMub3JpZ2luTWV0aG9kID0gb3JpZ2luTWV0aG9kOwogICAgaG9va01ldGhvZFByb3BlcnRpZXMuaG9va01ldGhvZCA9IGhvb2tNZXRob2Q7CiAgICBob29rTWV0aG9kUHJvcGVydGllcy5pc0hvb2sgPSB0cnVlOwogICAgaG9va01ldGhvZFByb3BlcnRpZXMuY2xhc3NIb29rID0gY2xhc3NIb29rOwoKICAgIHV0aWwuZGVidWcubG9nKGBbaG9vayBtZXRob2RdICR7dXRpbC50b1N0cihwYXJlbnRPYmopfSAke21ldGhvZE5hbWV9YCk7CgogICAgcmV0dXJuIGhvb2tNZXRob2QKICB9CgogIF9nZXRPYmpLZXlzQnlSdWxlIChvYmosIHJ1bGUpIHsKICAgIGxldCBleGNsdWRlUnVsZSA9IG51bGw7CiAgICBsZXQgcmVzdWx0ID0gcnVsZTsKCiAgICBpZiAodXRpbC5pc09iaihydWxlKSAmJiBydWxlLmluY2x1ZGUpIHsKICAgICAgZXhjbHVkZVJ1bGUgPSBydWxlLmV4Y2x1ZGU7CiAgICAgIHJ1bGUgPSBydWxlLmluY2x1ZGU7CiAgICAgIHJlc3VsdCA9IHJ1bGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBmb3IgaW7jgIFPYmplY3Qua2V5c+S4jlJlZmxlY3Qub3duS2V5c+eahOWMuuWIq+inge+8mgogICAgICogaHR0cHM6Ly9lczYucnVhbnlpZmVuZy5jb20vI2RvY3Mvb2JqZWN0IyVFNSVCMSU5RSVFNiU4MCVBNyVFNyU5QSU4NCVFOSU4MSU4RCVFNSU4RSU4NgogICAgICovCiAgICBpZiAocnVsZSA9PT0gJyonKSB7CiAgICAgIHJlc3VsdCA9IE9iamVjdC5rZXlzKG9iaik7CiAgICB9IGVsc2UgaWYgKHJ1bGUgPT09ICcqKicpIHsKICAgICAgcmVzdWx0ID0gUmVmbGVjdC5vd25LZXlzKG9iaik7CiAgICB9IGVsc2UgaWYgKHJ1bGUgPT09ICcqKionKSB7CiAgICAgIHJlc3VsdCA9IHV0aWwuZ2V0QWxsS2V5cyhvYmopOwogICAgfSBlbHNlIGlmICh1dGlsLmlzUmVnKHJ1bGUpKSB7CiAgICAgIHJlc3VsdCA9IHV0aWwuZ2V0QWxsS2V5cyhvYmopLmZpbHRlcihrZXlOYW1lID0+IHJ1bGUudGVzdChrZXlOYW1lKSk7CiAgICB9CgogICAgLyog5aaC5p6c5a2Y5Zyo5o6S6Zmk6KeE5YiZ77yM5YiZ6ZyA6KaB6L+b6KGM5o6S6ZmkICovCiAgICBpZiAoZXhjbHVkZVJ1bGUpIHsKICAgICAgcmVzdWx0ID0gQXJyYXkuaXNBcnJheShyZXN1bHQpID8gcmVzdWx0IDogW3Jlc3VsdF07CiAgICAgIGlmICh1dGlsLmlzUmVnKGV4Y2x1ZGVSdWxlKSkgewogICAgICAgIHJlc3VsdCA9IHJlc3VsdC5maWx0ZXIoa2V5TmFtZSA9PiAhZXhjbHVkZVJ1bGUudGVzdChrZXlOYW1lKSk7CiAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShleGNsdWRlUnVsZSkpIHsKICAgICAgICByZXN1bHQgPSByZXN1bHQuZmlsdGVyKGtleU5hbWUgPT4gIWV4Y2x1ZGVSdWxlLmluY2x1ZGVzKGtleU5hbWUpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXN1bHQgPSByZXN1bHQuZmlsdGVyKGtleU5hbWUgPT4gZXhjbHVkZVJ1bGUgIT09IGtleU5hbWUpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHV0aWwudG9BcnIocmVzdWx0KQogIH0KCiAgLyoqCiAgICog5Yik5pat5p+Q5Liq5Ye95pWw5piv5ZCm5bey57uP6KKraG9vawogICAqIEBwYXJhbSBmbiB7RnVuY3Rpb259IC3lv4XpgIkg6KaB5Yik5pat55qE5Ye95pWwCiAgICogQHJldHVybnMge2Jvb2xlYW59CiAgICovCiAgaXNIb29rIChmbikgewogICAgaWYgKCFmbiB8fCAhZm5bdGhpcy5ob29rUHJvcGVydGllc0tleU5hbWVdKSB7CiAgICAgIHJldHVybiBmYWxzZQogICAgfQogICAgY29uc3QgaG9va01ldGhvZFByb3BlcnRpZXMgPSBmblt0aGlzLmhvb2tQcm9wZXJ0aWVzS2V5TmFtZV07CiAgICByZXR1cm4gdXRpbC5pc0ZuKGhvb2tNZXRob2RQcm9wZXJ0aWVzLm9yaWdpbk1ldGhvZCkgJiYgZm4gIT09IGhvb2tNZXRob2RQcm9wZXJ0aWVzLm9yaWdpbk1ldGhvZAogIH0KCiAgLyoqCiAgICog5Yik5pat5a+56LGh5LiL55qE5p+Q5Liq5YC85piv5ZCm5YW35aSHaG9va+eahOadoeS7tgogICAqIOazqOaEj++8muWFt+Wkh2hvb2vmnaHku7blkozog73lkKbnm7TmjqXkv67mlLnlgLzmmK/kuKTlm57kuovvvIwKICAgKiDlnKjov5vooYxob29r55qE5pe25YCZ6L+Y6KaB5qOA5p+lZGVzY3JpcHRvci53cml0YWJsZeaYr+WQpuS4umZhbHNlCiAgICog5aaC5p6c5Li6ZmFsc2XliJnopoHkv67mlLnmiJB0cnVl5omN6IO9aG9va+aIkOWKnwogICAqIEBwYXJhbSBwYXJlbnRPYmoKICAgKiBAcGFyYW0ga2V5TmFtZQogICAqIEByZXR1cm5zIHtib29sZWFufQogICAqLwogIGlzQWxsb3dIb29rIChwYXJlbnRPYmosIGtleU5hbWUpIHsKICAgIC8qIOacieS6m+WvueixoeS8muiuvue9rmdldHRlcu+8jOiuqeivu+WPluWAvOeahOaXtuWAmeWwseaKm+mUme+8jOaJgOS7pemcgOimgXRyeSBjYXRjaCDliKTmlq3og73lkKbmraPluLjor7vlj5blsZ7mgKcgKi8KICAgIHRyeSB7IGlmICghcGFyZW50T2JqW2tleU5hbWVdKSByZXR1cm4gZmFsc2UgfSBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2UgfQogICAgY29uc3QgZGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocGFyZW50T2JqLCBrZXlOYW1lKTsKICAgIHJldHVybiAhKGRlc2NyaXB0b3IgJiYgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPT09IGZhbHNlKQogIH0KCiAgLyoqCiAgICogaG9vayDmoLjlv4Plh73mlbAKICAgKiBAcGFyYW0gcGFyZW50T2JqIHtPYmplY3R9IC3lv4XpgIkg6KKraG9va+WHveaVsOS+nei1lueahOeItuWvueixoQogICAqIEBwYXJhbSBob29rTWV0aG9kcyB7T2JqZWN0fEFycmF5fFJlZ0V4cHxzdHJpbmd9IC3lv4XpgIkg6KKraG9va+WHveaVsOeahOWHveaVsOWQjeaIluWHveaVsOWQjeeahOWMuemFjeinhOWImQogICAqIEBwYXJhbSBmbiB7RnVuY3Rpb259IC3lv4XpgIkgaG9va+S5i+WQjueahOWbnuiwg+aWueazlQogICAqIEBwYXJhbSB0eXBlIHtTdHJpbmd9IC3lj6/pgIkg6buY6K6kYmVmb3Jl77yM5oyH5a6a6L+Q6KGMaG9va+WHveaVsOWbnuiwg+eahOaXtuacuu+8jOWPr+mAieWtl+espuS4su+8mmJlZm9yZeOAgWFmdGVy44CBcmVwbGFjZeOAgWVycm9y44CBaGFuZ1VwCiAgICogQHBhcmFtIGNsYXNzSG9vayB7Qm9vbGVhbn0gLeWPr+mAiSDpu5jorqRmYWxzZe+8jOaMh+WumuaYr+WQpuS4uumSiOWvuW5ld++8iGNsYXNz77yJ5pON5L2c55qEaG9vawogICAqIEBwYXJhbSBjb250ZXh0IHtPYmplY3R9IC3lj6/pgIkg5oyH5a6a6L+Q6KGM6KKraG9va+WHveaVsOaXtueahOS4iuS4i+aWh+WvueixoQogICAqIEBwYXJhbSBwcm94eUhhbmRsZXIge09iamVjdH0gLeWPr+mAiSDku4XlvZPnlKhQcm94eei/m+ihjGhvb2vml7bmnInmlYjvvIzpu5jorqTkvb/nlKjnmoTmmK9Qcm94eeeahGFwcGx5IGhhbmRsZXLov5vooYxob29r77yM5aaC5p6c5L2g5pyJ54m55q6K6ZyA5rGC5Lmf5Y+v5Lul6YWN572u6Ieq5bex55qEaGFuZGxlcuS7peWunueOsOabtOWkjeadgueahOWKn+iDvQogICAqIOmZhOazqO+8muS4jeS9v+eUqFByb3h56L+b6KGMaG9va++8jOWPr+S7peiOt+W+l+abtOmrmOaAp+iDve+8jOS9huS5n+aEj+WRs+edgOmAmueUqOaAp+abtOW3ruS6m++8jOWvueS6juimgWhvb2sgSFRNTEVsZW1lbnQucHJvdG90eXBl44CBRXZlbnRUYXJnZXQucHJvdG90eXBl6L+Z5Lqb5a+56LGh6YeM6Z2i55qE6Z2e5a6e5L6L55qE5Ye95pWw5b6A5b6A5Lya5aSx6LSl6ICM5a+86Ie06KKraG9va+WHveaVsOaJp+ihjOWHuumUmQogICAqIEByZXR1cm5zIHtib29sZWFufQogICAqLwogIGhvb2sgKHBhcmVudE9iaiwgaG9va01ldGhvZHMsIGZuLCB0eXBlLCBjbGFzc0hvb2ssIGNvbnRleHQsIHByb3h5SGFuZGxlcikgewogICAgLyog5pSv5oyB5a+56LGh5b2i5byP55qE5Lyg5Y+CICovCiAgICBjb25zdCBvcHRzID0gYXJndW1lbnRzWzBdOwogICAgaWYgKHV0aWwuaXNPYmoob3B0cykgJiYgb3B0cy5wYXJlbnRPYmogJiYgb3B0cy5ob29rTWV0aG9kcykgewogICAgICBwYXJlbnRPYmogPSBvcHRzLnBhcmVudE9iajsKICAgICAgaG9va01ldGhvZHMgPSBvcHRzLmhvb2tNZXRob2RzOwogICAgICBmbiA9IG9wdHMuZm47CiAgICAgIHR5cGUgPSBvcHRzLnR5cGU7CiAgICAgIGNsYXNzSG9vayA9IG9wdHMuY2xhc3NIb29rOwogICAgICBjb250ZXh0ID0gb3B0cy5jb250ZXh0OwogICAgICBwcm94eUhhbmRsZXIgPSBvcHRzLnByb3h5SGFuZGxlcjsKICAgIH0KCiAgICBjbGFzc0hvb2sgPSB0b0Jvb2xlYW4oY2xhc3NIb29rKTsKICAgIHR5cGUgPSB0eXBlIHx8ICdiZWZvcmUnOwoKICAgIGlmICgoIXV0aWwuaXNSZWYocGFyZW50T2JqKSAmJiAhdXRpbC5pc0ZuKHBhcmVudE9iaikpIHx8ICF1dGlsLmlzRm4oZm4pIHx8ICFob29rTWV0aG9kcykgewogICAgICByZXR1cm4gZmFsc2UKICAgIH0KCiAgICBjb25zdCB0ID0gdGhpczsKCiAgICBob29rTWV0aG9kcyA9IHQuX2dldE9iaktleXNCeVJ1bGUocGFyZW50T2JqLCBob29rTWV0aG9kcyk7CiAgICBob29rTWV0aG9kcy5mb3JFYWNoKG1ldGhvZE5hbWUgPT4gewogICAgICBpZiAoIXQuaXNBbGxvd0hvb2socGFyZW50T2JqLCBtZXRob2ROYW1lKSkgewogICAgICAgIHV0aWwuZGVidWcubG9nKGAke3V0aWwudG9TdHIocGFyZW50T2JqKX0gWyR7bWV0aG9kTmFtZX1dIGRvZXMgbm90IHN1cHBvcnQgbW9kaWZpY2F0aW9uYCk7CiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KCiAgICAgIGNvbnN0IGRlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHBhcmVudE9iaiwgbWV0aG9kTmFtZSk7CiAgICAgIGlmIChkZXNjcmlwdG9yICYmIGRlc2NyaXB0b3Iud3JpdGFibGUgPT09IGZhbHNlKSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudE9iaiwgbWV0aG9kTmFtZSwgeyB3cml0YWJsZTogdHJ1ZSB9KTsKICAgICAgfQoKICAgICAgY29uc3Qgb3JpZ2luTWV0aG9kID0gcGFyZW50T2JqW21ldGhvZE5hbWVdOwogICAgICBsZXQgaG9va01ldGhvZCA9IG51bGw7CgogICAgICAvKiDpnZ7lh73mlbDml6Dms5Xov5vooYxob29r5pON5L2cICovCiAgICAgIGlmICghdXRpbC5pc0ZuKG9yaWdpbk1ldGhvZCkpIHsKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfQoKICAgICAgaG9va01ldGhvZCA9IHQuX3Byb3h5TWV0aG9kY0dlbmVyYXRvcihwYXJlbnRPYmosIG1ldGhvZE5hbWUsIG9yaWdpbk1ldGhvZCwgY2xhc3NIb29rLCBjb250ZXh0LCBwcm94eUhhbmRsZXIpOwoKICAgICAgY29uc3QgaG9va01ldGhvZFByb3BlcnRpZXMgPSBob29rTWV0aG9kW3QuaG9va1Byb3BlcnRpZXNLZXlOYW1lXTsKICAgICAgaWYgKGhvb2tNZXRob2RQcm9wZXJ0aWVzLmNsYXNzSG9vayAhPT0gY2xhc3NIb29rKSB7CiAgICAgICAgdXRpbC5kZWJ1Zy5sb2coYCR7dXRpbC50b1N0cihwYXJlbnRPYmopfSBbJHttZXRob2ROYW1lfV0gQ2Fubm90IHN1cHBvcnQgZnVuY3Rpb25zIGhvb2sgYW5kIGNsYXNzZXMgaG9vayBhdCB0aGUgc2FtZSB0aW1lIGApOwogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CgogICAgICAvKiDkvb/nlKhob29rTWV0aG9k5o6l566h6ZyA6KaB6KKraG9va+eahOaWueazlSAqLwogICAgICBpZiAocGFyZW50T2JqW21ldGhvZE5hbWVdICE9PSBob29rTWV0aG9kKSB7CiAgICAgICAgcGFyZW50T2JqW21ldGhvZE5hbWVdID0gaG9va01ldGhvZDsKICAgICAgfQoKICAgICAgdC5fYWRkSG9vayhob29rTWV0aG9kLCBmbiwgdHlwZSwgY2xhc3NIb29rKTsKICAgIH0pOwogIH0KCiAgLyog5LiT6Zeo6ZKI5a+5bmV35pON5L2c55qEaG9va++8jOacrOi0qOS4iuaYr2hvb2vlh73mlbDnmoTliKvlkI3vvIzlj6/ku6XlsJHkvKBjbGFzc0hvb2vov5nkuKrlj4LmlbDvvIzlubbkuJTmmI7noa7or63kuYkgKi8KICBob29rQ2xhc3MgKHBhcmVudE9iaiwgaG9va01ldGhvZHMsIGZuLCB0eXBlLCBjb250ZXh0LCBwcm94eUhhbmRsZXIpIHsKICAgIHJldHVybiB0aGlzLmhvb2socGFyZW50T2JqLCBob29rTWV0aG9kcywgZm4sIHR5cGUsIHRydWUsIGNvbnRleHQsIHByb3h5SGFuZGxlcikKICB9CgogIC8qKgogICAqIOWPlua2iOWvueafkOS4quWHveaVsOeahGhvb2sKICAgKiBAcGFyYW0gcGFyZW50T2JqIHtPYmplY3R9IC3lv4XpgIkg6KaB5Y+W5raI6KKraG9va+WHveaVsOS+nei1lueahOeItuWvueixoQogICAqIEBwYXJhbSBob29rTWV0aG9kcyB7T2JqZWN0fEFycmF5fFJlZ0V4cHxzdHJpbmd9IC3lv4XpgIkg6KaB5Y+W5raI6KKraG9va+WHveaVsOeahOWHveaVsOWQjeaIluWHveaVsOWQjeeahOWMuemFjeinhOWImQogICAqIEBwYXJhbSB0eXBlIHtTdHJpbmd9IC3lj6/pgIkg6buY6K6kYmVmb3Jl77yM5oyH5a6a6KaB5Y+W5raI55qEaG9va+exu+Wei++8jOWPr+mAieWtl+espuS4su+8mmJlZm9yZeOAgWFmdGVy44CBcmVwbGFjZeOAgWVycm9y44CBaGFuZ1Vw77yM5aaC5p6c5LiN5oyH5a6a6K+l6YCJ6aG55YiZ5Y+W5raI5omA5pyJ57G75Z6L5LiL55qE5omA5pyJ5Zue6LCDCiAgICogQHBhcmFtIGZuIHtGdW5jdGlvbn0gLeW/hemAiSDlj5bmtojmjIflrprnmoRob29r5Zue6LCD5Ye95pWw77yM5aaC5p6c5LiN5oyH5a6a6K+l6YCJ6aG55YiZ5Y+W5raI5a+55bqUdHlwZeexu+Wei+S4i+eahOaJgOacieWbnuiwgwogICAqIEByZXR1cm5zIHtib29sZWFufQogICAqLwogIHVuSG9vayAocGFyZW50T2JqLCBob29rTWV0aG9kcywgdHlwZSwgZm4pIHsKICAgIGlmICghdXRpbC5pc1JlZihwYXJlbnRPYmopIHx8ICFob29rTWV0aG9kcykgewogICAgICByZXR1cm4gZmFsc2UKICAgIH0KCiAgICBjb25zdCB0ID0gdGhpczsKICAgIGhvb2tNZXRob2RzID0gdC5fZ2V0T2JqS2V5c0J5UnVsZShwYXJlbnRPYmosIGhvb2tNZXRob2RzKTsKICAgIGhvb2tNZXRob2RzLmZvckVhY2gobWV0aG9kTmFtZSA9PiB7CiAgICAgIGlmICghdC5pc0FsbG93SG9vayhwYXJlbnRPYmosIG1ldGhvZE5hbWUpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KCiAgICAgIGNvbnN0IGhvb2tNZXRob2QgPSBwYXJlbnRPYmpbbWV0aG9kTmFtZV07CgogICAgICBpZiAoIXQuaXNIb29rKGhvb2tNZXRob2QpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KCiAgICAgIGNvbnN0IGhvb2tNZXRob2RQcm9wZXJ0aWVzID0gaG9va01ldGhvZFt0Lmhvb2tQcm9wZXJ0aWVzS2V5TmFtZV07CiAgICAgIGNvbnN0IG9yaWdpbk1ldGhvZCA9IGhvb2tNZXRob2RQcm9wZXJ0aWVzLm9yaWdpbk1ldGhvZDsKCiAgICAgIGlmICh0eXBlKSB7CiAgICAgICAgY29uc3QgaG9va0tleU5hbWUgPSB0eXBlICsgJ0hvb2tzJzsKICAgICAgICBjb25zdCBob29rcyA9IGhvb2tNZXRob2RQcm9wZXJ0aWVzW2hvb2tLZXlOYW1lXSB8fCBbXTsKCiAgICAgICAgaWYgKGZuKSB7CiAgICAgICAgICAvKiDliKDpmaTmjIflrprnsbvlnovkuIvnmoTmjIflrppob29r5Ye95pWwICovCiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGhvb2tzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChmbiA9PT0gaG9va3NbaV0pIHsKICAgICAgICAgICAgICAvKiDnp7vpmaRob29r5Ye95pWw5LiK55qEY2xhc3NIb29r5qCH6K6wICovCiAgICAgICAgICAgICAgZGVsZXRlIGZuLmNsYXNzSG9vazsKICAgICAgICAgICAgICBob29rTWV0aG9kUHJvcGVydGllc1tob29rS2V5TmFtZV0uc3BsaWNlKGksIDEpOwogICAgICAgICAgICAgIHV0aWwuZGVidWcubG9nKGBbdW5Ib29rICR7aG9va0tleU5hbWV9IGZ1bmNdICR7dXRpbC50b1N0cihwYXJlbnRPYmopfSAke21ldGhvZE5hbWV9YCwgZm4pOwogICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICAvKiDlpoLmnpzmiYDmnInnsbvlnovnmoRob29rc+mDveS4uuepuu+8jOWImeWujOWFqOi/mOWOn+WOn+Wni+aWueazlSAqLwogICAgICAgICAgY29uc3QgaGFzSG9va3MgPSBbJ2JlZm9yZUhvb2tzJywgJ2FmdGVySG9va3MnLCAnZXJyb3JIb29rcycsICdoYW5nVXBIb29rcycsICdyZXBsYWNlSG9va3MnXS5zb21lKGtleSA9PiB7CiAgICAgICAgICAgIHJldHVybiBBcnJheS5pc0FycmF5KGhvb2tNZXRob2RQcm9wZXJ0aWVzW2tleV0pICYmIGhvb2tNZXRob2RQcm9wZXJ0aWVzW2tleV0ubGVuZ3RoID4gMAogICAgICAgICAgfSk7CgogICAgICAgICAgaWYgKCFoYXNIb29rcykgewogICAgICAgICAgICBwYXJlbnRPYmpbbWV0aG9kTmFtZV0gPSBvcmlnaW5NZXRob2Q7CiAgICAgICAgICAgIGRlbGV0ZSBwYXJlbnRPYmpbbWV0aG9kTmFtZV1bdC5ob29rUHJvcGVydGllc0tleU5hbWVdOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvKiDliKDpmaTmjIflrprnsbvlnovkuIvnmoTmiYDmnIlob29r5Ye95pWwICovCiAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShob29rTWV0aG9kUHJvcGVydGllc1tob29rS2V5TmFtZV0pKSB7CiAgICAgICAgICAgIC8qIOenu+mZpOaJgOaciWhvb2vlh73mlbDkuIrnmoRjbGFzc0hvb2vmoIforrAgKi8KICAgICAgICAgICAgaG9va01ldGhvZFByb3BlcnRpZXNbaG9va0tleU5hbWVdLmZvckVhY2goaG9vayA9PiB7CiAgICAgICAgICAgICAgZGVsZXRlIGhvb2suY2xhc3NIb29rOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgaG9va01ldGhvZFByb3BlcnRpZXNbaG9va0tleU5hbWVdID0gW107CiAgICAgICAgICAgIHV0aWwuZGVidWcubG9nKGBbdW5Ib29rIGFsbCAke2hvb2tLZXlOYW1lfV0gJHt1dGlsLnRvU3RyKHBhcmVudE9iail9ICR7bWV0aG9kTmFtZX1gKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLyog5b275bqV6L+Y5Y6f6KKraG9va+eahOWHveaVsCAqLwogICAgICAgIGlmICh1dGlsLmlzRm4ob3JpZ2luTWV0aG9kKSkgewogICAgICAgICAgLyog56e76Zmk5omA5pyJ57G75Z6L5LiL55qE5omA5pyJaG9va+WHveaVsOeahGNsYXNzSG9va+agh+iusCAqLwogICAgICAgICAgWydiZWZvcmVIb29rcycsICdhZnRlckhvb2tzJywgJ2Vycm9ySG9va3MnLCAnaGFuZ1VwSG9va3MnLCAncmVwbGFjZUhvb2tzJ10uZm9yRWFjaChrZXkgPT4gewogICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShob29rTWV0aG9kUHJvcGVydGllc1trZXldKSkgewogICAgICAgICAgICAgIGhvb2tNZXRob2RQcm9wZXJ0aWVzW2tleV0uZm9yRWFjaChob29rID0+IHsKICAgICAgICAgICAgICAgIGRlbGV0ZSBob29rLmNsYXNzSG9vazsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBob29rTWV0aG9kUHJvcGVydGllc1trZXldID0gW107CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwoKICAgICAgICAgIHBhcmVudE9ialttZXRob2ROYW1lXSA9IG9yaWdpbk1ldGhvZDsKICAgICAgICAgIGRlbGV0ZSBwYXJlbnRPYmpbbWV0aG9kTmFtZV1bdC5ob29rUHJvcGVydGllc0tleU5hbWVdOwoKICAgICAgICAgIC8vIE9iamVjdC5rZXlzKGhvb2tNZXRob2QpLmZvckVhY2goa2V5TmFtZSA9PiB7CiAgICAgICAgICAvLyAgIGlmICgvSG9va3MkLy50ZXN0KGtleU5hbWUpICYmIEFycmF5LmlzQXJyYXkoaG9va01ldGhvZFtrZXlOYW1lXSkpIHsKICAgICAgICAgIC8vICAgICBob29rTWV0aG9kW2tleU5hbWVdID0gW10KICAgICAgICAgIC8vICAgfQogICAgICAgICAgLy8gfSkKICAgICAgICAgIC8vCiAgICAgICAgICAvLyBob29rTWV0aG9kLmlzSG9vayA9IGZhbHNlCiAgICAgICAgICAvLyBwYXJlbnRPYmpbbWV0aG9kTmFtZV0gPSBvcmlnaW5NZXRob2QKICAgICAgICAgIC8vIGRlbGV0ZSBwYXJlbnRPYmpbbWV0aG9kTmFtZV0ub3JpZ2luTWV0aG9kCiAgICAgICAgICAvLyBkZWxldGUgcGFyZW50T2JqW21ldGhvZE5hbWVdLmhvb2tNZXRob2QKICAgICAgICAgIC8vIGRlbGV0ZSBwYXJlbnRPYmpbbWV0aG9kTmFtZV0uaXNIb29rCiAgICAgICAgICAvLyBkZWxldGUgcGFyZW50T2JqW21ldGhvZE5hbWVdLmlzQ2xhc3NIb29rCgogICAgICAgICAgdXRpbC5kZWJ1Zy5sb2coYFt1bkhvb2sgbWV0aG9kXSAke3V0aWwudG9TdHIocGFyZW50T2JqKX0gJHttZXRob2ROYW1lfWApOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgfQoKICBfaG9vayAoYXJncywgdHlwZSkgewogICAgY29uc3QgdCA9IHRoaXM7CiAgICByZXR1cm4gZnVuY3Rpb24gKG9iaiwgaG9va01ldGhvZHMsIGZuLCBjbGFzc0hvb2ssIGNvbnRleHQsIHByb3h5SGFuZGxlcikgewogICAgICBjb25zdCBvcHRzID0gYXJnc1swXTsKICAgICAgaWYgKHV0aWwuaXNPYmoob3B0cykgJiYgb3B0cy5wYXJlbnRPYmogJiYgb3B0cy5ob29rTWV0aG9kcykgewogICAgICAgIG9wdHMudHlwZSA9IHR5cGU7CiAgICAgIH0KICAgICAgcmV0dXJuIHQuaG9vay5hcHBseSh0LCBhcmdzKQogICAgfQogIH0KCiAgLyog5rqQ5Ye95pWw6L+Q6KGM5YmN55qEaG9vayAqLwogIGJlZm9yZSAob2JqLCBob29rTWV0aG9kcywgZm4sIGNsYXNzSG9vaywgY29udGV4dCwgcHJveHlIYW5kbGVyKSB7CiAgICByZXR1cm4gdGhpcy5ob29rKG9iaiwgaG9va01ldGhvZHMsIGZuLCAnYmVmb3JlJywgY2xhc3NIb29rLCBjb250ZXh0LCBwcm94eUhhbmRsZXIpCiAgfQoKICAvKiDmupDlh73mlbDov5DooYzlkI7nmoRob29rICovCiAgYWZ0ZXIgKG9iaiwgaG9va01ldGhvZHMsIGZuLCBjbGFzc0hvb2ssIGNvbnRleHQsIHByb3h5SGFuZGxlcikgewogICAgcmV0dXJuIHRoaXMuaG9vayhvYmosIGhvb2tNZXRob2RzLCBmbiwgJ2FmdGVyJywgY2xhc3NIb29rLCBjb250ZXh0LCBwcm94eUhhbmRsZXIpCiAgfQoKICAvKiDmm7/mjaLmjonopoFob29r55qE5Ye95pWw77yM5LiN5YaN6L+Q6KGM5rqQ5Ye95pWw77yM5o2i5oiQ6L+Q6KGM5YW25LuW6YC76L6RICovCiAgcmVwbGFjZSAob2JqLCBob29rTWV0aG9kcywgZm4sIGNsYXNzSG9vaywgY29udGV4dCwgcHJveHlIYW5kbGVyKSB7CiAgICByZXR1cm4gdGhpcy5ob29rKG9iaiwgaG9va01ldGhvZHMsIGZuLCAncmVwbGFjZScsIGNsYXNzSG9vaywgY29udGV4dCwgcHJveHlIYW5kbGVyKQogIH0KCiAgLyog5rqQ5Ye95pWw6L+Q6KGM5Ye66ZSZ5pe255qEaG9vayAqLwogIGVycm9yIChvYmosIGhvb2tNZXRob2RzLCBmbiwgY2xhc3NIb29rLCBjb250ZXh0LCBwcm94eUhhbmRsZXIpIHsKICAgIHJldHVybiB0aGlzLmhvb2sob2JqLCBob29rTWV0aG9kcywgZm4sICdlcnJvcicsIGNsYXNzSG9vaywgY29udGV4dCwgcHJveHlIYW5kbGVyKQogIH0KCiAgLyog5bqV5bGC5a6e546w6YC76L6R5LiOcmVwbGFjZeS4gOagt++8jOmDveaYr+abv+aNouaOieimgWhvb2vnmoTlh73mlbDvvIzkuI3lho3ov5DooYzmupDlh73mlbDvvIzlj6rkuI3ov4fmmK/kuLrkuobmmI7noa7or63kuYnvvIzlsIbmupDlh73mlbDmjILotbfkuI3lho3miafooYzvvIzljp/liJnkuIrkuZ/kuI3lho3miafooYzlhbbku5bpgLvovpHvvIzlpoLmnpzopoHmiafooYzlhbbku5bpgLvovpHor7fkvb/nlKhyZXBsYWNlIGhvb2sgKi8KICBoYW5nVXAgKG9iaiwgaG9va01ldGhvZHMsIGZuLCBjbGFzc0hvb2ssIGNvbnRleHQsIHByb3h5SGFuZGxlcikgewogICAgcmV0dXJuIHRoaXMuaG9vayhvYmosIGhvb2tNZXRob2RzLCBmbiwgJ2hhbmdVcCcsIGNsYXNzSG9vaywgY29udGV4dCwgcHJveHlIYW5kbGVyKQogIH0KfQoKY29uc3QgaG9va0pzID0gbmV3IEhvb2tKcyh0cnVlKTsKCi8qKgogKiDnpoHmraLlr7lwbGF5YmFja1JhdGXov5vooYzplIHlrpoKICog6YOo5YiG5pKt5pS+5Zmo5Lya6Zi75q2i5L+u5pS5cGxheWJhY2tSYXRlCiAqIOmAmui/h2hhY2tEZWZpbmVQcm9wZXJ0eeadpeWPjemYu+atonBsYXliYWNrUmF0ZeeahOS/ruaUuQogKiDlj4LogIPvvJogaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy96aC1DTi9zY3JpcHRzLzM3MjY3MwogKi8KCmZ1bmN0aW9uIGhhY2tEZWZpbmVQcm9wZXJDb3JlICh0YXJnZXQsIGtleSwgb3B0aW9uKSB7CiAgaWYgKG9wdGlvbiAmJiB0YXJnZXQgJiYgdGFyZ2V0IGluc3RhbmNlb2YgRWxlbWVudCAmJiB0eXBlb2Yga2V5ID09PSAnc3RyaW5nJyAmJiBrZXkuaW5kZXhPZignb24nKSA+PSAwKSB7CiAgICBvcHRpb24uY29uZmlndXJhYmxlID0gdHJ1ZTsKICB9CgogIGlmICh0YXJnZXQgaW5zdGFuY2VvZiBIVE1MVmlkZW9FbGVtZW50KSB7CiAgICBjb25zdCB1bkxvY2tQcm9wZXJ0aWVzID0gWydwbGF5YmFja1JhdGUnLCAnY3VycmVudFRpbWUnLCAndm9sdW1lJywgJ211dGVkJ107CiAgICBpZiAodW5Mb2NrUHJvcGVydGllcy5pbmNsdWRlcyhrZXkpKSB7CiAgICAgIHRyeSB7CiAgICAgICAgZGVidWcubG9nKGDnpoHmraLlr7kke2tleX3ov5vooYzplIHlrppgKTsKICAgICAgICBvcHRpb24uY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgICAgICBrZXkgPSBrZXkgKyAnX2hhY2snOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgZGVidWcuZXJyb3IoYOemgeatoumUgeWumiR7a2V5feWksei0pe+8gWAsIGUpOwogICAgICB9CiAgICB9CiAgfQoKICByZXR1cm4gW3RhcmdldCwga2V5LCBvcHRpb25dCn0KCmZ1bmN0aW9uIGhhY2tEZWZpbmVQcm9wZXJPbkVycm9yIChhcmdzLCBwYXJlbnRPYmosIG1ldGhvZE5hbWUsIG9yaWdpbk1ldGhvZCwgZXhlY0luZm8sIGN0eCkgewogIGRlYnVnLmVycm9yKGAke21ldGhvZE5hbWV9IGVycm9yOmAsIGV4ZWNJbmZvLmVycm9yKTsKCiAgLyog5b+955Wl5omn6KGM5byC5bi4ICovCiAgcmV0dXJuICdTS0lQLUVSUk9SJwp9CgpmdW5jdGlvbiBoYWNrRGVmaW5lUHJvcGVydHkgKCkgewogIGhvb2tKcy5iZWZvcmUoT2JqZWN0LCAnZGVmaW5lUHJvcGVydHknLCBmdW5jdGlvbiAoYXJncywgcGFyZW50T2JqLCBtZXRob2ROYW1lLCBvcmlnaW5NZXRob2QsIGV4ZWNJbmZvLCBjdHgpIHsKICAgIGNvbnN0IG9wdGlvbiA9IGFyZ3NbMl07CiAgICBjb25zdCBlbGUgPSBhcmdzWzBdOwogICAgY29uc3Qga2V5ID0gYXJnc1sxXTsKICAgIGNvbnN0IGFmdGVyQXJncyA9IGhhY2tEZWZpbmVQcm9wZXJDb3JlKGVsZSwga2V5LCBvcHRpb24pOwogICAgYWZ0ZXJBcmdzLmZvckVhY2goKGFyZywgaSkgPT4gewogICAgICBhcmdzW2ldID0gYXJnOwogICAgfSk7CiAgfSk7CgogIGhvb2tKcy5iZWZvcmUoT2JqZWN0LCAnZGVmaW5lUHJvcGVydGllcycsIGZ1bmN0aW9uIChhcmdzLCBwYXJlbnRPYmosIG1ldGhvZE5hbWUsIG9yaWdpbk1ldGhvZCwgZXhlY0luZm8sIGN0eCkgewogICAgY29uc3QgcHJvcGVydGllcyA9IGFyZ3NbMV07CiAgICBjb25zdCBlbGUgPSBhcmdzWzBdOwogICAgaWYgKGVsZSAmJiBlbGUgaW5zdGFuY2VvZiBFbGVtZW50KSB7CiAgICAgIE9iamVjdC5rZXlzKHByb3BlcnRpZXMpLmZvckVhY2goa2V5ID0+IHsKICAgICAgICBjb25zdCBvcHRpb24gPSBwcm9wZXJ0aWVzW2tleV07CiAgICAgICAgY29uc3QgYWZ0ZXJBcmdzID0gaGFja0RlZmluZVByb3BlckNvcmUoZWxlLCBrZXksIG9wdGlvbik7CiAgICAgICAgYXJnc1swXSA9IGFmdGVyQXJnc1swXTsKICAgICAgICBkZWxldGUgcHJvcGVydGllc1trZXldOwogICAgICAgIHByb3BlcnRpZXNbYWZ0ZXJBcmdzWzFdXSA9IGFmdGVyQXJnc1syXTsKICAgICAgfSk7CiAgICB9CiAgfSk7CgogIGhvb2tKcy5lcnJvcihPYmplY3QsICdkZWZpbmVQcm9wZXJ0eScsIGhhY2tEZWZpbmVQcm9wZXJPbkVycm9yKTsKICBob29rSnMuZXJyb3IoT2JqZWN0LCAnZGVmaW5lUHJvcGVydGllcycsIGhhY2tEZWZpbmVQcm9wZXJPbkVycm9yKTsKfQoKLyohCiAqIEBuYW1lICAgICAgbWVudUNvbW1hbmQuanMKICogQHZlcnNpb24gICAwLjAuMQogKiBAYXV0aG9yICAgIEJsYXplCiAqIEBkYXRlICAgICAgMjAxOS85LzIxIDE0OjIyCiAqLwoKY29uc3QgbW9ua2V5TWVudSA9IHsKICBtZW51SWRzOiB7fSwKICBvbiAodGl0bGUsIGZuLCBhY2Nlc3NLZXkpIHsKICAgIGlmICh0aXRsZSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7CiAgICAgIHRpdGxlID0gdGl0bGUoKTsKICAgIH0KCiAgICBpZiAod2luZG93LkdNX3JlZ2lzdGVyTWVudUNvbW1hbmQpIHsKICAgICAgY29uc3QgbWVudUlkID0gd2luZG93LkdNX3JlZ2lzdGVyTWVudUNvbW1hbmQodGl0bGUsIGZuLCBhY2Nlc3NLZXkpOwoKICAgICAgdGhpcy5tZW51SWRzW21lbnVJZF0gPSB7CiAgICAgICAgdGl0bGUsCiAgICAgICAgZm4sCiAgICAgICAgYWNjZXNzS2V5CiAgICAgIH07CgogICAgICByZXR1cm4gbWVudUlkCiAgICB9CiAgfSwKCiAgb2ZmIChpZCkgewogICAgaWYgKHdpbmRvdy5HTV91bnJlZ2lzdGVyTWVudUNvbW1hbmQpIHsKICAgICAgZGVsZXRlIHRoaXMubWVudUlkc1tpZF07CgogICAgICAvKioKICAgICAgICog5om56YeP56e76Zmk5bey5rOo5YaM55qE5oyJ6ZKu5pe277yM5Zyo5p+Q5Lqb5oCn6IO96L6D5beu55qE5py65a2Q5LiK5Lya55WZ5LiL5pWw5a2XdGl0bGXnmoToj5zljZXmrovnlZkKICAgICAgICog5bqU6K+l5bGe5LqO5o+S5Lu26Ieq6Lqr5a+86Ie055qEQlVH77yM5pqC5pe25peg5rOV6Kej5YazCiAgICAgICAqIOaJgOS7peatpOWkhOaaguaXtuS4jei/m+ihjOiPnOWNleenu+mZpO+8jHRhbXBlcm1vbmtleeS8muiHquWKqOWvueWQjOWQjeiPnOWNlei/m+ihjOWQiOW5tgogICAgICAgKi8KICAgICAgLy8gcmV0dXJuIHdpbmRvdy5HTV91bnJlZ2lzdGVyTWVudUNvbW1hbmQoaWQpCiAgICB9CiAgfSwKCiAgY2xlYXIgKCkgewogICAgT2JqZWN0LmtleXModGhpcy5tZW51SWRzKS5mb3JFYWNoKGlkID0+IHsKICAgICAgdGhpcy5vZmYoaWQpOwogICAgfSk7CiAgfSwKCiAgLyoqCiAgICog6YCa6L+H6I+c5Y2V6YWN572u6L+b6KGM5om56YeP5rOo5YaM77yM5rOo5YaM5YmN5Lya5riF56m65LmL5YmN5rOo5YaM6L+H55qE5omA5pyJ6I+c5Y2VCiAgICogQHBhcmFtIHthcnJheXxmdW5jdGlvbn0gbWVudU9wdHMg6I+c5Y2V6YWN572u77yM5aaC5p6c5piv5Ye95pWw5YiZ5Lya6LCD55So6K+l5Ye95pWw6I635Y+W6I+c5Y2V6YWN572u77yM5bm25LiU5b2T6I+c5Y2V6KKr54K55Ye75ZCO5Lya6YeN5paw5Yib5bu66I+c5Y2V77yM5a6e546w6I+c5Y2V55qE5Yqo5oCB5pu05pawCiAgICovCiAgYnVpbGQgKG1lbnVPcHRzKSB7CiAgICB0aGlzLmNsZWFyKCk7CgogICAgaWYgKEFycmF5LmlzQXJyYXkobWVudU9wdHMpKSB7CiAgICAgIG1lbnVPcHRzLmZvckVhY2gobWVudSA9PiB7CiAgICAgICAgaWYgKG1lbnUuZGlzYWJsZSA9PT0gdHJ1ZSkgeyByZXR1cm4gfQogICAgICAgIHRoaXMub24obWVudS50aXRsZSwgbWVudS5mbiwgbWVudS5hY2Nlc3NLZXkpOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAobWVudU9wdHMgaW5zdGFuY2VvZiBGdW5jdGlvbikgewogICAgICBjb25zdCBtZW51TGlzdCA9IG1lbnVPcHRzKCk7CiAgICAgIGlmIChBcnJheS5pc0FycmF5KG1lbnVMaXN0KSkgewogICAgICAgIHRoaXMuX21lbnVCdWlsZGVyXyA9IG1lbnVPcHRzOwoKICAgICAgICBtZW51TGlzdC5mb3JFYWNoKG1lbnUgPT4gewogICAgICAgICAgaWYgKG1lbnUuZGlzYWJsZSA9PT0gdHJ1ZSkgeyByZXR1cm4gfQoKICAgICAgICAgIGNvbnN0IG1lbnVGbiA9ICgpID0+IHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBtZW51LmZuLmFwcGx5KG1lbnUsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbbW9ua2V5TWVudV0nLCBtZW51LnRpdGxlLCBlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8g5q+P5qyh6I+c5Y2V54K55Ye75ZCO77yM6YeN5paw5rOo5YaM6I+c5Y2V77yM6L+Z5qC35Y+v5Lul56Gu5L+d6I+c5Y2V55qE54q25oCB5piv5pyA5paw55qECiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdbbW9ua2V5TWVudSByZWJ1aWxkXScsIG1lbnUudGl0bGUpCiAgICAgICAgICAgICAgdGhpcy5idWlsZCh0aGlzLl9tZW51QnVpbGRlcl8pOwogICAgICAgICAgICB9LCAxMDApOwogICAgICAgICAgfTsKCiAgICAgICAgICB0aGlzLm9uKG1lbnUudGl0bGUsIG1lbnVGbiwgbWVudS5hY2Nlc3NLZXkpOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ21vbmtleU1lbnUgYnVpbGQgZXJyb3IsIG5vIG1lbnVMaXN0IHJldHVybicsIG1lbnVPcHRzKTsKICAgICAgfQogICAgfQogIH0KfTsKCmNvbnN0IHZlcnNpb24gPSAnNC4yLjcnOwoKZnVuY3Rpb24gcmVmcmVzaFBhZ2UgKG1zZykgewogIG1zZyA9IG1zZyB8fCAn6YWN572u5bey5pu05pS577yM6ams5LiK5Yi35paw6aG16Z2i6K6p6YWN572u55Sf5pWI77yfJzsKICBjb25zdCBzdGF0dXMgPSBjb25maXJtKG1zZyk7CiAgaWYgKHN0YXR1cykgewogICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOwogIH0KfQoKY29uc3QgaXNDaGluZXNlID0gKCkgPT4gaTE4bi5sYW5ndWFnZSgpLmluZGV4T2YoJ3poJykgPiAtMTsKCmZ1bmN0aW9uIGdldEhvbWVQYWdlICgpIHsKICBjb25zdCBob21lUGFnZUxpbmtzID0gWwogICAgJ2h0dHBzOi8vaDVwbGF5ZXIuYW56ei5zaXRlL3poLycsCiAgICAnaHR0cHM6Ly9oNXBsYXllci5hbnp6LnRvcCcKICBdOwoKICAvKiDku45ob21lUGFnZUxpbmtz5Lit6ZqP5py66YCJ5Y+W5LiA5Liq6ZO+5o6l6L+U5ZueICovCiAgcmV0dXJuIGlzQ2hpbmVzZSgpID8gaG9tZVBhZ2VMaW5rc1swXSA6IGhvbWVQYWdlTGlua3NbMV0KfQoKZnVuY3Rpb24gb3BlbkRvY3NCeVBhdGggKHBhdGgpIHsKICBpZiAodHlwZW9mIHBhdGggIT09ICdzdHJpbmcnIHx8IHBhdGguc3RhcnRzV2l0aCgnaHR0cCcpID09PSB0cnVlKSB7CiAgICByZXR1cm4gZmFsc2UKICB9CgogIGlmICghcGF0aC5zdGFydHNXaXRoKCcvJykpIHsKICAgIHBhdGggPSAnLycgKyBwYXRoOwogIH0KCiAgY29uc3QgY2hpbmVzZSA9IGlzQ2hpbmVzZSgpOwogIGNvbnN0IGJhc2VQYXRoID0gY2hpbmVzZSA/ICdodHRwczovL2g1cGxheWVyLmFuenouc2l0ZScgOiAnaHR0cHM6Ly9oNXBsYXllci5hbnp6LnRvcCc7CiAgbGV0IHVybCA9IGJhc2VQYXRoICsgcGF0aDsKCiAgLyog5Yik5pat5piv5ZCm5Li65Lit5paH546v5aKD77yM5LiUbGlua+S4jeaYry96aOW8gOWktO+8jOWImeiHquWKqOWKoOS4ii96aOWJjee8gCAqLwogIGlmIChjaGluZXNlICYmICFwYXRoLnN0YXJ0c1dpdGgoJy96aCcpKSB7CiAgICB1cmwgPSBiYXNlUGF0aCArICcvemgnICsgcGF0aDsKICB9CgogIG9wZW5JblRhYih1cmwpOwp9CgovKioKICog5YWo5bGA5Y+v6LCD55So55qE5Yqf6IO977yM5Lya5o+Q5L6b57uZbW9ua2V5TWVudeiwg+eUqOWSjFVJ55WM6Z2i55qE55u45YWz5L2N572u6L+b6KGM6LCD55SoCiAqIOS4uuS6huS+v+S6juiwg+eUqOe8luaOkuaJgOS7peS9v+eUqOWvueixoeeahOaWueW8j+i/m+ihjOeuoeeQhgogKi8KY29uc3QgZ2xvYmFsRnVuY3Rpb25hbCA9IHsKICBvcGVuSW5UYWIsCiAgZ2V0SG9tZVBhZ2VMaW5rOiB7CiAgICB0aXRsZTogaTE4bi50KCd3ZWJzaXRlJyksCiAgICBkZXNjOiBpMThuLnQoJ3dlYnNpdGUnKSwKICAgIGZuOiAoKSA9PiBnZXRIb21lUGFnZSgpCiAgfSwKCiAgLyog5omT5byA5a6Y572RICovCiAgb3BlbldlYnNpdGU6IHsKICAgIHRpdGxlOiBpMThuLnQoJ3dlYnNpdGUnKSwKICAgIGRlc2M6IGkxOG4udCgnd2Vic2l0ZScpLAogICAgZm46ICgpID0+IG9wZW5JblRhYihnZXRIb21lUGFnZSgpKQogIH0sCiAgb3BlbkF1dGhvckhvbWVQYWdlOiB7CiAgICB0aXRsZTogaTE4bi50KCdhYm91dEF1dGhvcicpLAogICAgZGVzYzogaTE4bi50KCdhYm91dEF1dGhvcicpLAogICAgZm46ICgpID0+IHsgb3BlbkluVGFiKCdodHRwczovL2dpdGh1Yi5jb20veHh4aWx5Jyk7IH0KICB9LAogIG9wZW5Ib3RrZXlzUGFnZTogewogICAgdGl0bGU6IGkxOG4udCgnaG90a2V5c0RvY3MnKSwKICAgIGRlc2M6IGkxOG4udCgnaG90a2V5c0RvY3MnKSwKICAgIGZuOiAoKSA9PiB7CiAgICAgIGNvbnN0IGhvdGtleXNEb2NzID0gWwogICAgICAgICdodHRwczovL2g1cGxheWVyLmFuenouc2l0ZS96aC9ob21lL3F1aWNrU3RhcnQjJUU1JUJGJUFCJUU2JThEJUI3JUU5JTk0JUFFJUU1JTg4JTk3JUU4JUExJUE4JywKICAgICAgICAnaHR0cHM6Ly9oNXBsYXllci5hbnp6LnRvcC9ob21lL3F1aWNrU3RhcnQjc2hvcnRjdXQta2V5LWxpc3QnCiAgICAgIF07CiAgICAgIG9wZW5JblRhYihpc0NoaW5lc2UoKSA/IGhvdGtleXNEb2NzWzBdIDogaG90a2V5c0RvY3NbMV0pOwogICAgfQogIH0sCiAgb3BlblByb2plY3RHaXRodWI6IHsKICAgIHRpdGxlOiAnR2l0SHViJywKICAgIGRlc2M6ICdHaXRIdWInLAogICAgZm46ICgpID0+IG9wZW5JblRhYignaHR0cHM6Ly9naXRodWIuY29tL3h4eGlseS9oNXBsYXllcicpCiAgfSwKICBvcGVuSXNzdWVzUGFnZTogewogICAgdGl0bGU6IGkxOG4udCgnaXNzdWVzJyksCiAgICBkZXNjOiBpMThuLnQoJ2lzc3VlcycpLAogICAgZm46ICgpID0+IG9wZW5JblRhYignaHR0cHM6Ly9naXRodWIuY29tL3h4eGlseS9oNXBsYXllci9pc3N1ZXMnKQogIH0sCiAgb3BlbkRvbmF0ZVBhZ2U6IHsKICAgIHRpdGxlOiBpMThuLnQoJ2RvbmF0ZScpLAogICAgZGVzYzogaTE4bi50KCdkb25hdGUnKSwKICAgIGZuOiAoKSA9PiBvcGVuRG9jc0J5UGF0aCgnL2hvbWUvcmV3YXJkVGhlQXV0aG9yJykKICB9LAogIG9wZW5BYm91dERvbmF0ZVBhZ2U6IHsKICAgIHRpdGxlOiBpMThuLnQoJ2Fib3V0RG9uYXRlJyksCiAgICBkZXNjOiBpMThuLnQoJ2Fib3V0RG9uYXRlJyksCiAgICBmbjogKCkgPT4gb3BlbkRvY3NCeVBhdGgoJy9ob21lL2Fib3V0RG9uYXRlJykKICB9LAogIG9wZW5BZGRHcm91cENoYXRQYWdlOiB7CiAgICB0aXRsZTogaTE4bi50KCdhZGRHcm91cENoYXQnKSwKICAgIGRlc2M6IGkxOG4udCgnYWRkR3JvdXBDaGF0JyksCiAgICBmbjogKCkgPT4gewogICAgICBjb25zdCBncm91cENoYXRVcmwgPSBpc0NoaW5lc2UoKSA/ICdodHRwczovL2g1cGxheWVyLmFuenouc2l0ZS96aC9ob21lL3F1aWNrU3RhcnQjJUU0JUJBJUE0JUU2JUI1JTgxJUU3JUJFJUE0JyA6ICdodHRwczovL2g1cGxheWVyLmFuenoudG9wL2hvbWUvcXVpY2tTdGFydCNkaXNjdXNzaW9uLWdyb3Vwcyc7CiAgICAgIG9wZW5JblRhYihncm91cENoYXRVcmwpOwogICAgfQogIH0sCiAgb3BlbkNoYW5nZUxvZ1BhZ2U6IHsKICAgIHRpdGxlOiBpMThuLnQoJ2NoYW5nZUxvZycpLAogICAgZGVzYzogaTE4bi50KCdjaGFuZ2VMb2cnKSwKICAgIGZuOiAoKSA9PiBvcGVuRG9jc0J5UGF0aCgnL2hvbWUvY2hhbmdlTG9nJykKICB9LAogIG9wZW5DaGVja1ZlcnNpb25QYWdlOiB7CiAgICB0aXRsZTogaTE4bi50KCdjaGVja1ZlcnNpb24nKSwKICAgIGRlc2M6IGkxOG4udCgnY2hlY2tWZXJzaW9uJyksCiAgICBmbjogKCkgPT4gewogICAgICBjb25zdCBjb25maXJtID0gd2luZG93LmNvbmZpcm0oYCR7aTE4bi50KCdjdXJyZW50VmVyc2lvbicpfeOAjCR7dmVyc2lvbn3jgI1cbiR7aTE4bi50KCdjaGVja1ZlcnNpb24nKX1gKTsKICAgICAgaWYgKGNvbmZpcm0pIHsKICAgICAgICBvcGVuSW5UYWIoJ2h0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvemgtQ04vc2NyaXB0cy8zODE2ODIvdmVyc2lvbnMnKTsKICAgICAgfQogICAgfQogIH0sCiAgb3BlblJlY29tbWVuZFBhZ2U6IHsKICAgIHRpdGxlOiBpMThuLnQoJ3JlY29tbWVuZCcpLAogICAgZGVzYzogaTE4bi50KCdyZWNvbW1lbmQnKSwKICAgIGZuOiAoKSA9PiB7CiAgICAgIGZ1bmN0aW9uIHJhbmRvbVplcm9Pck9uZSAoKSB7CiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIpCiAgICAgIH0KCiAgICAgIGlmIChyYW5kb21aZXJvT3JPbmUoKSkgewogICAgICAgIG9wZW5JblRhYignaHR0cHM6Ly9oZWxsby1haS5hbnp6LnRvcC9ob21lLycpOwogICAgICB9IGVsc2UgewogICAgICAgIG9wZW5JblRhYignaHR0cHM6Ly9naXRodWIuY29tL3h4eGlseS9oZWxsby1haScpOwogICAgICB9CiAgICB9CiAgfSwKICBvcGVuQ3VzdG9tQ29uZmlndXJhdGlvbkVkaXRvcjogewogICAgdGl0bGU6IGkxOG4udCgnb3BlbkN1c3RvbUNvbmZpZ3VyYXRpb25FZGl0b3InKSwKICAgIGRlc2M6IGkxOG4udCgnb3BlbkN1c3RvbUNvbmZpZ3VyYXRpb25FZGl0b3InKSwKICAgIGZuOiAoKSA9PiB7CiAgICAgIGNvbnN0IGpzb25lZGl0b3JVcmwgPSBpc0NoaW5lc2UoKQogICAgICAgID8gJ2h0dHBzOi8vaDVwbGF5ZXIuYW56ei5zaXRlL3Rvb2xzL2pzb24tZWRpdG9yL2luZGV4Lmh0bWw/bW9kZT10cmVlJnNhdmVIYW5kbGVyTmFtZT1zYXZlSDVQbGF5ZXJDb25maWcmZXhwYW5kQWxsPXRydWUmanNvbj0nCiAgICAgICAgOiAnaHR0cHM6Ly9oNXBsYXllci5hbnp6LnRvcC90b29scy9qc29uLWVkaXRvci9pbmRleC5odG1sP21vZGU9dHJlZSZzYXZlSGFuZGxlck5hbWU9c2F2ZUg1UGxheWVyQ29uZmlnJmV4cGFuZEFsbD10cnVlJmpzb249JzsKICAgICAgb3BlbkluVGFiKGpzb25lZGl0b3JVcmwpOwogICAgfQogIH0sCgogIG9wZW5Eb2NzTGluazogewogICAgdGl0bGU6IGkxOG4udCgnb3BlbkRvY3NMaW5rJyksCiAgICBkZXNjOiBpMThuLnQoJ29wZW5Eb2NzTGluaycpLAogICAgZm46IChwYXRoKSA9PiBvcGVuRG9jc0J5UGF0aChwYXRoKQogIH0sCgogIC8qIOWIh+aNonRhbXBlcm1vbmtleeiPnOWNleeahOWxleW8gOaIluaKmOWPoOeKtuaAgSAqLwogIHRvZ2dsZUV4cGFuZGVkT3JDb2xsYXBzZWRTdGF0ZU9mTW9ua2V5TWVudTogewogICAgdGl0bGU6IGAke2NvbmZpZ01hbmFnZXIuZ2V0KCdlbmhhbmNlLnVuZm9sZE1lbnUnKSA/IGkxOG4udCgnZm9sZE1lbnUnKSA6IGkxOG4udCgndW5mb2xkTWVudScpfSDjgIwke2kxOG4udCgnZ2xvYmFsU2V0dGluZycpfeOAjWAsCiAgICBkZXNjOiBgJHtjb25maWdNYW5hZ2VyLmdldCgnZW5oYW5jZS51bmZvbGRNZW51JykgPyBpMThuLnQoJ2ZvbGRNZW51JykgOiBpMThuLnQoJ3VuZm9sZE1lbnUnKX0g44CMJHtpMThuLnQoJ2dsb2JhbFNldHRpbmcnKX3jgI1gLAogICAgZm46ICgpID0+IHsKICAgICAgY29uc3QgY29uZmlybSA9IHdpbmRvdy5jb25maXJtKGNvbmZpZ01hbmFnZXIuZ2V0KCdlbmhhbmNlLnVuZm9sZE1lbnUnKSA/IGkxOG4udCgnZm9sZE1lbnUnKSA6IGkxOG4udCgndW5mb2xkTWVudScpKTsKICAgICAgaWYgKGNvbmZpcm0pIHsKICAgICAgICBjb25maWdNYW5hZ2VyLnNldEdsb2JhbFN0b3JhZ2UoJ2VuaGFuY2UudW5mb2xkTWVudScsICFjb25maWdNYW5hZ2VyLmdldCgnZW5oYW5jZS51bmZvbGRNZW51JykpOwogICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgfQogICAgfQogIH0sCiAgLyog5YiH5o2i6ISa5pys55qE5ZCv55So5oiW56aB55So54q25oCBICovCiAgdG9nZ2xlU2NyaXB0RW5hYmxlU3RhdGU6IHsKICAgIHRpdGxlOiBgJHsoY29uZmlnTWFuYWdlci5nZXQoJ2JsYWNrbGlzdC5kb21haW5zJykgfHwgW10pLmluY2x1ZGVzKGxvY2F0aW9uLmhvc3QpID8gaTE4bi50KCdlbmFibGVTY3JpcHQnKSA6IGkxOG4udCgnZGlzYWJsZVNjcmlwdCcpfSDjgIwke2kxOG4udCgnbG9jYWxTZXR0aW5nJyl944CNYCwKICAgIGRlc2M6IGAkeyhjb25maWdNYW5hZ2VyLmdldCgnYmxhY2tsaXN0LmRvbWFpbnMnKSB8fCBbXSkuaW5jbHVkZXMobG9jYXRpb24uaG9zdCkgPyBpMThuLnQoJ2VuYWJsZVNjcmlwdCcpIDogaTE4bi50KCdkaXNhYmxlU2NyaXB0Jyl9IOOAjCR7aTE4bi50KCdsb2NhbFNldHRpbmcnKX3jgI1gLAogICAgZm46ICgpID0+IHsKICAgICAgY29uc3QgYmxhY2tEb21haW5MaXN0ID0gY29uZmlnTWFuYWdlci5nZXQoJ2JsYWNrbGlzdC5kb21haW5zJykgfHwgW107CiAgICAgIGNvbnN0IGlzSW5CbGFja2xpc3QgPSBibGFja0RvbWFpbkxpc3QuaW5jbHVkZXMobG9jYXRpb24uaG9zdCk7CiAgICAgIGNvbnN0IGNvbmZpcm0gPSB3aW5kb3cuY29uZmlybShpc0luQmxhY2tsaXN0ID8gaTE4bi50KCdlbmFibGVTY3JpcHQnKSA6IGkxOG4udCgnZGlzYWJsZVNjcmlwdCcpKTsKICAgICAgaWYgKGNvbmZpcm0pIHsKICAgICAgICBpZiAoaXNJbkJsYWNrbGlzdCkgewogICAgICAgICAgY29uZmlnTWFuYWdlci5zZXRHbG9iYWxTdG9yYWdlKCdibGFja2xpc3QuZG9tYWlucycsIGJsYWNrRG9tYWluTGlzdC5maWx0ZXIoaXRlbSA9PiBpdGVtICE9PSBsb2NhdGlvbi5ob3N0KSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbmZpZ01hbmFnZXIuc2V0R2xvYmFsU3RvcmFnZSgnYmxhY2tsaXN0LmRvbWFpbnMnLCBibGFja0RvbWFpbkxpc3QuY29uY2F0KGxvY2F0aW9uLmhvc3QpKTsKICAgICAgICB9CgogICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgfQogICAgfQogIH0sCiAgLyog5YiH5o2i6buY6K6k5pKt5pS+6L+b5bqm55qE5o6n5Yi26YC76L6RICovCiAgdG9nZ2xlU2V0Q3VycmVudFRpbWVGdW5jdGlvbmFsOiB7CiAgICAvKiDmoIfpopjkvb/nlKjlh73mlbDmmK/kuLrkuobkuIvmrKHosIPnlKjnmoTml7blgJnor7vlj5bliLDmnIDmlrDnmoTnirbmgIHkv6Hmga8gKi8KICAgIHRpdGxlOiAoKSA9PiBgJHtjb25maWdNYW5hZ2VyLmdldCgnZW5oYW5jZS5ibG9ja1NldEN1cnJlbnRUaW1lJykgPyBpMThuLnQoJ3VuYmxvY2tTZXRDdXJyZW50VGltZScpIDogaTE4bi50KCdibG9ja1NldEN1cnJlbnRUaW1lJyl9IOOAjCR7aTE4bi50KCdsb2NhbFNldHRpbmcnKX3jgI1gLAogICAgZGVzYzogKCkgPT4gYCR7Y29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UuYmxvY2tTZXRDdXJyZW50VGltZScpID8gaTE4bi50KCd1bmJsb2NrU2V0Q3VycmVudFRpbWUnKSA6IGkxOG4udCgnYmxvY2tTZXRDdXJyZW50VGltZScpfSDjgIwke2kxOG4udCgnbG9jYWxTZXR0aW5nJyl944CNYCwKICAgIGZuOiAoKSA9PiB7CiAgICAgIGNvbnN0IGNvbmZpcm0gPSB3aW5kb3cuY29uZmlybShjb25maWdNYW5hZ2VyLmdldCgnZW5oYW5jZS5ibG9ja1NldEN1cnJlbnRUaW1lJykgPyBpMThuLnQoJ3VuYmxvY2tTZXRDdXJyZW50VGltZScpIDogaTE4bi50KCdibG9ja1NldEN1cnJlbnRUaW1lJykpOwogICAgICBpZiAoY29uZmlybSkgewogICAgICAgIGNvbmZpZ01hbmFnZXIuc2V0TG9jYWxTdG9yYWdlKCdlbmhhbmNlLmJsb2NrU2V0Q3VycmVudFRpbWUnLCAhY29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UuYmxvY2tTZXRDdXJyZW50VGltZScpKTsKICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgICAgIH0KICAgIH0KICB9LAogIHRvZ2dsZVNldFZvbHVtZUZ1bmN0aW9uYWw6IHsKICAgIHRpdGxlOiAoKSA9PiBgJHtjb25maWdNYW5hZ2VyLmdldCgnZW5oYW5jZS5ibG9ja1NldFZvbHVtZScpID8gaTE4bi50KCd1bmJsb2NrU2V0Vm9sdW1lJykgOiBpMThuLnQoJ2Jsb2NrU2V0Vm9sdW1lJyl9IOOAjCR7aTE4bi50KCdsb2NhbFNldHRpbmcnKX3jgI1gLAogICAgZGVzYzogKCkgPT4gYCR7Y29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UuYmxvY2tTZXRWb2x1bWUnKSA/IGkxOG4udCgndW5ibG9ja1NldFZvbHVtZScpIDogaTE4bi50KCdibG9ja1NldFZvbHVtZScpfSDjgIwke2kxOG4udCgnbG9jYWxTZXR0aW5nJyl944CNYCwKICAgIGZuOiAoKSA9PiB7CiAgICAgIGNvbnN0IGNvbmZpcm0gPSB3aW5kb3cuY29uZmlybShjb25maWdNYW5hZ2VyLmdldCgnZW5oYW5jZS5ibG9ja1NldFZvbHVtZScpID8gaTE4bi50KCd1bmJsb2NrU2V0Vm9sdW1lJykgOiBpMThuLnQoJ2Jsb2NrU2V0Vm9sdW1lJykpOwogICAgICBpZiAoY29uZmlybSkgewogICAgICAgIGNvbmZpZ01hbmFnZXIuc2V0TG9jYWxTdG9yYWdlKCdlbmhhbmNlLmJsb2NrU2V0Vm9sdW1lJywgIWNvbmZpZ01hbmFnZXIuZ2V0KCdlbmhhbmNlLmJsb2NrU2V0Vm9sdW1lJykpOwogICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgfQogICAgfQogIH0sCiAgdG9nZ2xlU2V0UGxheWJhY2tSYXRlRnVuY3Rpb25hbDogewogICAgdGl0bGU6ICgpID0+IGAke2NvbmZpZ01hbmFnZXIuZ2V0KCdlbmhhbmNlLmJsb2NrU2V0UGxheWJhY2tSYXRlJykgPyBpMThuLnQoJ3VuYmxvY2tTZXRQbGF5YmFja1JhdGUnKSA6IGkxOG4udCgnYmxvY2tTZXRQbGF5YmFja1JhdGUnKX0g44CMJHtpMThuLnQoJ2dsb2JhbFNldHRpbmcnKX3jgI1gLAogICAgZGVzYzogKCkgPT4gYCR7Y29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UuYmxvY2tTZXRQbGF5YmFja1JhdGUnKSA/IGkxOG4udCgndW5ibG9ja1NldFBsYXliYWNrUmF0ZScpIDogaTE4bi50KCdibG9ja1NldFBsYXliYWNrUmF0ZScpfSDjgIwke2kxOG4udCgnZ2xvYmFsU2V0dGluZycpfeOAjWAsCiAgICBmbjogKCkgPT4gewogICAgICBjb25zdCBjb25maXJtID0gd2luZG93LmNvbmZpcm0oY29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UuYmxvY2tTZXRQbGF5YmFja1JhdGUnKSA/IGkxOG4udCgndW5ibG9ja1NldFBsYXliYWNrUmF0ZScpIDogaTE4bi50KCdibG9ja1NldFBsYXliYWNrUmF0ZScpKTsKICAgICAgaWYgKGNvbmZpcm0pIHsKICAgICAgICAvKiDlgI3pgJ/lj4LmlbDvvIzlj6rog73lhajlsYDorr7nva4gKi8KICAgICAgICBjb25maWdNYW5hZ2VyLnNldEdsb2JhbFN0b3JhZ2UoJ2VuaGFuY2UuYmxvY2tTZXRQbGF5YmFja1JhdGUnLCAhY29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UuYmxvY2tTZXRQbGF5YmFja1JhdGUnKSk7CiAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOwogICAgICB9CiAgICB9CiAgfSwKICB0b2dnbGVBY291c3RpY0dhaW5GdW5jdGlvbmFsOiB7CiAgICB0aXRsZTogKCkgPT4gYCR7Y29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UuYWxsb3dBY291c3RpY0dhaW4nKSA/IGkxOG4udCgnbm90QWxsb3dBY291c3RpY0dhaW4nKSA6IGkxOG4udCgnYWxsb3dBY291c3RpY0dhaW4nKX0g44CMJHtpMThuLnQoJ2dsb2JhbFNldHRpbmcnKX3jgI1gLAogICAgZGVzYzogKCkgPT4gYCR7Y29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UuYWxsb3dBY291c3RpY0dhaW4nKSA/IGkxOG4udCgnbm90QWxsb3dBY291c3RpY0dhaW4nKSA6IGkxOG4udCgnYWxsb3dBY291c3RpY0dhaW4nKX0g44CMJHtpMThuLnQoJ2dsb2JhbFNldHRpbmcnKX3jgI1gLAogICAgZm46ICgpID0+IHsKICAgICAgY29uc3QgY29uZmlybSA9IHdpbmRvdy5jb25maXJtKGNvbmZpZ01hbmFnZXIuZ2V0KCdlbmhhbmNlLmFsbG93QWNvdXN0aWNHYWluJykgPyBpMThuLnQoJ25vdEFsbG93QWNvdXN0aWNHYWluJykgOiBpMThuLnQoJ2FsbG93QWNvdXN0aWNHYWluJykpOwogICAgICBpZiAoY29uZmlybSkgewogICAgICAgIGNvbmZpZ01hbmFnZXIuc2V0R2xvYmFsU3RvcmFnZSgnZW5oYW5jZS5hbGxvd0Fjb3VzdGljR2FpbicsICFjb25maWdNYW5hZ2VyLmdldEdsb2JhbFN0b3JhZ2UoJ2VuaGFuY2UuYWxsb3dBY291c3RpY0dhaW4nKSk7CiAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOwogICAgICB9CiAgICB9CiAgfSwKICB0b2dnbGVDcm9zc09yaWdpbkNvbnRyb2xGdW5jdGlvbmFsOiB7CiAgICB0aXRsZTogKCkgPT4gYCR7Y29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UuYWxsb3dDcm9zc09yaWdpbkNvbnRyb2wnKSA/IGkxOG4udCgnbm90QWxsb3dDcm9zc09yaWdpbkNvbnRyb2wnKSA6IGkxOG4udCgnYWxsb3dDcm9zc09yaWdpbkNvbnRyb2wnKX0g44CMJHtpMThuLnQoJ2dsb2JhbFNldHRpbmcnKX3jgI1gLAogICAgZGVzYzogKCkgPT4gYCR7Y29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UuYWxsb3dDcm9zc09yaWdpbkNvbnRyb2wnKSA/IGkxOG4udCgnbm90QWxsb3dDcm9zc09yaWdpbkNvbnRyb2wnKSA6IGkxOG4udCgnYWxsb3dDcm9zc09yaWdpbkNvbnRyb2wnKX0g44CMJHtpMThuLnQoJ2dsb2JhbFNldHRpbmcnKX3jgI1gLAogICAgZm46ICgpID0+IHsKICAgICAgY29uc3QgY29uZmlybSA9IHdpbmRvdy5jb25maXJtKGNvbmZpZ01hbmFnZXIuZ2V0KCdlbmhhbmNlLmFsbG93Q3Jvc3NPcmlnaW5Db250cm9sJykgPyBpMThuLnQoJ25vdEFsbG93Q3Jvc3NPcmlnaW5Db250cm9sJykgOiBpMThuLnQoJ2FsbG93Q3Jvc3NPcmlnaW5Db250cm9sJykpOwogICAgICBpZiAoY29uZmlybSkgewogICAgICAgIGNvbmZpZ01hbmFnZXIuc2V0R2xvYmFsU3RvcmFnZSgnZW5oYW5jZS5hbGxvd0Nyb3NzT3JpZ2luQ29udHJvbCcsICFjb25maWdNYW5hZ2VyLmdldEdsb2JhbFN0b3JhZ2UoJ2VuaGFuY2UuYWxsb3dDcm9zc09yaWdpbkNvbnRyb2wnKSk7CiAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOwogICAgICB9CiAgICB9CiAgfSwKICB0b2dnbGVFeHBlcmltZW50RmVhdHVyZXM6IHsKICAgIHRpdGxlOiAoKSA9PiBgJHtjb25maWdNYW5hZ2VyLmdldCgnZW5oYW5jZS5hbGxvd0V4cGVyaW1lbnRGZWF0dXJlcycpID8gaTE4bi50KCdub3RBbGxvd0V4cGVyaW1lbnRGZWF0dXJlcycpIDogaTE4bi50KCdhbGxvd0V4cGVyaW1lbnRGZWF0dXJlcycpfSDjgIwke2kxOG4udCgnZ2xvYmFsU2V0dGluZycpfeOAjWAsCiAgICBkZXNjOiAoKSA9PiBgJHtjb25maWdNYW5hZ2VyLmdldCgnZW5oYW5jZS5hbGxvd0V4cGVyaW1lbnRGZWF0dXJlcycpID8gaTE4bi50KCdub3RBbGxvd0V4cGVyaW1lbnRGZWF0dXJlcycpIDogaTE4bi50KCdhbGxvd0V4cGVyaW1lbnRGZWF0dXJlcycpfSDjgIwke2kxOG4udCgnZ2xvYmFsU2V0dGluZycpfeOAjWAsCiAgICBmbjogKCkgPT4gewogICAgICBjb25zdCBjb25maXJtID0gd2luZG93LmNvbmZpcm0oY29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UuYWxsb3dFeHBlcmltZW50RmVhdHVyZXMnKSA/IGkxOG4udCgnbm90QWxsb3dFeHBlcmltZW50RmVhdHVyZXMnKSA6IGkxOG4udCgnZXhwZXJpbWVudEZlYXR1cmVzV2FybmluZycpKTsKICAgICAgaWYgKGNvbmZpcm0pIHsKICAgICAgICBjb25maWdNYW5hZ2VyLnNldEdsb2JhbFN0b3JhZ2UoJ2VuaGFuY2UuYWxsb3dFeHBlcmltZW50RmVhdHVyZXMnLCAhY29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UuYWxsb3dFeHBlcmltZW50RmVhdHVyZXMnKSk7CiAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOwogICAgICB9CiAgICB9CiAgfSwKICB0b2dnbGVFeHRlcm5hbEN1c3RvbUNvbmZpZ3VyYXRpb246IHsKICAgIHRpdGxlOiAoKSA9PiBgJHtjb25maWdNYW5hZ2VyLmdldCgnZW5oYW5jZS5hbGxvd0V4dGVybmFsQ3VzdG9tQ29uZmlndXJhdGlvbicpID8gaTE4bi50KCdub3RBbGxvd0V4dGVybmFsQ3VzdG9tQ29uZmlndXJhdGlvbicpIDogaTE4bi50KCdhbGxvd0V4dGVybmFsQ3VzdG9tQ29uZmlndXJhdGlvbicpfSDjgIwke2kxOG4udCgnZ2xvYmFsU2V0dGluZycpfeOAjWAsCiAgICBkZXNjOiAoKSA9PiBgJHtjb25maWdNYW5hZ2VyLmdldCgnZW5oYW5jZS5hbGxvd0V4dGVybmFsQ3VzdG9tQ29uZmlndXJhdGlvbicpID8gaTE4bi50KCdub3RBbGxvd0V4dGVybmFsQ3VzdG9tQ29uZmlndXJhdGlvbicpIDogaTE4bi50KCdhbGxvd0V4dGVybmFsQ3VzdG9tQ29uZmlndXJhdGlvbicpfSDjgIwke2kxOG4udCgnZ2xvYmFsU2V0dGluZycpfeOAjWAsCiAgICBmbjogKCkgPT4gewogICAgICBjb25zdCBjb25maXJtID0gd2luZG93LmNvbmZpcm0oY29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UuYWxsb3dFeHRlcm5hbEN1c3RvbUNvbmZpZ3VyYXRpb24nKSA/IGkxOG4udCgnbm90QWxsb3dFeHRlcm5hbEN1c3RvbUNvbmZpZ3VyYXRpb24nKSA6IGkxOG4udCgnYWxsb3dFeHRlcm5hbEN1c3RvbUNvbmZpZ3VyYXRpb24nKSk7CiAgICAgIGlmIChjb25maXJtKSB7CiAgICAgICAgY29uZmlnTWFuYWdlci5zZXRHbG9iYWxTdG9yYWdlKCdlbmhhbmNlLmFsbG93RXh0ZXJuYWxDdXN0b21Db25maWd1cmF0aW9uJywgIWNvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgnZW5oYW5jZS5hbGxvd0V4dGVybmFsQ3VzdG9tQ29uZmlndXJhdGlvbicpKTsKICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgICAgIH0KICAgIH0KICB9LAogIHRvZ2dsZURlYnVnTW9kZTogewogICAgdGl0bGU6ICgpID0+IGAke2NvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgnZGVidWcnKSA/IGkxOG4udCgnY2xvc2VEZWJ1Z01vZGUnKSA6IGkxOG4udCgnb3BlbkRlYnVnTW9kZScpfSDjgIwke2kxOG4udCgnZ2xvYmFsU2V0dGluZycpfeOAjWAsCiAgICBkZXNjOiAoKSA9PiBgJHtjb25maWdNYW5hZ2VyLmdldEdsb2JhbFN0b3JhZ2UoJ2RlYnVnJykgPyBpMThuLnQoJ2Nsb3NlRGVidWdNb2RlJykgOiBpMThuLnQoJ29wZW5EZWJ1Z01vZGUnKX0g44CMJHtpMThuLnQoJ2dsb2JhbFNldHRpbmcnKX3jgI1gLAogICAgZm46ICgpID0+IHsKICAgICAgY29uc3QgY29uZmlybSA9IHdpbmRvdy5jb25maXJtKGNvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgnZGVidWcnKSA/IGkxOG4udCgnY2xvc2VEZWJ1Z01vZGUnKSA6IGkxOG4udCgnb3BlbkRlYnVnTW9kZScpKTsKICAgICAgaWYgKGNvbmZpcm0pIHsKICAgICAgICBjb25maWdNYW5hZ2VyLnNldEdsb2JhbFN0b3JhZ2UoJ2RlYnVnJywgIWNvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgnZGVidWcnKSk7CiAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOwogICAgICB9CiAgICB9CiAgfSwKCiAgLyog6L+Y5Y6f5YWo5bGA55qE6buY6K6k6YWN572uICovCiAgcmVzdG9yZUdsb2JhbENvbmZpZ3VyYXRpb246IHsKICAgIHRpdGxlOiBpMThuLnQoJ3Jlc3RvcmVDb25maWd1cmF0aW9uJyksCiAgICBkZXNjOiBpMThuLnQoJ3Jlc3RvcmVDb25maWd1cmF0aW9uJyksCiAgICBmbjogKCkgPT4gewogICAgICBjb25maWdNYW5hZ2VyLmNsZWFyKCk7CiAgICAgIHJlZnJlc2hQYWdlKCk7CiAgICB9CiAgfSwKICBvcGVuQ3Jvc3NPcmlnaW5GcmFtZVBhZ2U6IHsKICAgIHRpdGxlOiBpMThuLnQoJ29wZW5Dcm9zc09yaWdpbkZyYW1lUGFnZScpLAogICAgZGVzYzogaTE4bi50KCdvcGVuQ3Jvc3NPcmlnaW5GcmFtZVBhZ2UnKSwKICAgIGZuOiAoKSA9PiB7CiAgICAgIG9wZW5JblRhYihsb2NhdGlvbi5ocmVmKTsKICAgIH0KICB9LAoKICAvKiDliIfmjaLohJrmnKxVSeeVjOmdoueahOaYvuekuuaIlumakOiXj+eKtuaAge+8jOazqOaEj++8muWPquacieaYjuehruS4umZhc2xl5omN6ZqQ6JePR1VJ77yM5YW25a6D5oOF5Ya16YO96KaB5pi+56S6R1VJ77yM5L6L5aaCbnVsbOOAgXVuZGVmaW5lZOetiemDveato+W4uOaYvuekukdVSSAqLwogIHRvZ2dsZUdVSVN0YXR1czogewogICAgdGl0bGU6ICgpID0+IGAke2NvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgndWkuZW5hYmxlJykgPT09IGZhbHNlID8gaTE4bi50KCdlbmFibGVHVUknKSA6IGkxOG4udCgnZGlzYWJsZUdVSScpfSDjgIwke2kxOG4udCgnZ2xvYmFsU2V0dGluZycpfeOAjWAsCiAgICBkZXNjOiAoKSA9PiBgJHtjb25maWdNYW5hZ2VyLmdldEdsb2JhbFN0b3JhZ2UoJ3VpLmVuYWJsZScpID09PSBmYWxzZSA/IGkxOG4udCgnZW5hYmxlR1VJJykgOiBpMThuLnQoJ2Rpc2FibGVHVUknKX0g44CMJHtpMThuLnQoJ2dsb2JhbFNldHRpbmcnKX3jgI1gLAogICAgZm46ICgpID0+IHsKICAgICAgY29uc3QgY29uZmlybSA9IHdpbmRvdy5jb25maXJtKGAke2NvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgndWkuZW5hYmxlJykgPT09IGZhbHNlID8gaTE4bi50KCdlbmFibGVHVUknKSA6IGkxOG4udCgnZGlzYWJsZUdVSScpfSDjgIwke2kxOG4udCgnZ2xvYmFsU2V0dGluZycpfeOAjWApOwogICAgICBpZiAoY29uZmlybSkgewogICAgICAgIGNvbmZpZ01hbmFnZXIuc2V0R2xvYmFsU3RvcmFnZSgndWkuZW5hYmxlJywgIWNvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgndWkuZW5hYmxlJykpOwogICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgfQogICAgfQogIH0sCgogIC8qIOWIh+aNouW9k+WJjee9keermeS4i+eahOiEmuacrFVJ55WM6Z2i55qE5pi+56S65oiW6ZqQ6JeP54q25oCBICovCiAgdG9nZ2xlR1VJU3RhdHVzVW5kZXJDdXJyZW50U2l0ZTogewogICAgdGl0bGU6ICgpID0+IGAke2NvbmZpZ01hbmFnZXIuZ2V0TG9jYWxTdG9yYWdlKCd1aS5lbmFibGUnKSA9PT0gZmFsc2UgPyBpMThuLnQoJ2VuYWJsZUdVSScpIDogaTE4bi50KCdkaXNhYmxlR1VJJyl9IOOAjCR7aTE4bi50KCdsb2NhbFNldHRpbmcnKX3jgI1gLAogICAgZGVzYzogKCkgPT4gYCR7Y29uZmlnTWFuYWdlci5nZXRMb2NhbFN0b3JhZ2UoJ3VpLmVuYWJsZScpID09PSBmYWxzZSA/IGkxOG4udCgnZW5hYmxlR1VJJykgOiBpMThuLnQoJ2Rpc2FibGVHVUknKX0g44CMJHtpMThuLnQoJ2xvY2FsU2V0dGluZycpfeOAjWAsCiAgICBmbjogKCkgPT4gewogICAgICBjb25zdCBjb25maXJtID0gd2luZG93LmNvbmZpcm0oYCR7Y29uZmlnTWFuYWdlci5nZXRMb2NhbFN0b3JhZ2UoJ3VpLmVuYWJsZScpID09PSBmYWxzZSA/IGkxOG4udCgnZW5hYmxlR1VJJykgOiBpMThuLnQoJ2Rpc2FibGVHVUknKX0g44CMJHtpMThuLnQoJ2xvY2FsU2V0dGluZycpfeOAjWApOwogICAgICBpZiAoY29uZmlybSkgewogICAgICAgIGNvbmZpZ01hbmFnZXIuc2V0TG9jYWxTdG9yYWdlKCd1aS5lbmFibGUnLCAhY29uZmlnTWFuYWdlci5nZXRMb2NhbFN0b3JhZ2UoJ3VpLmVuYWJsZScpKTsKICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgICAgIH0KICAgIH0KICB9LAogIGFsd2F5c1Nob3dHcmFwaGljYWxJbnRlcmZhY2U6IHsKICAgIHRpdGxlOiBgJHtpMThuLnQoJ3RvZ2dsZVN0YXRlcycpfSR7aTE4bi50KCdhbHdheXNTaG93R3JhcGhpY2FsSW50ZXJmYWNlJyl9IOOAjCR7aTE4bi50KCdnbG9iYWxTZXR0aW5nJyl944CNYCwKICAgIGRlc2M6IGAke2kxOG4udCgndG9nZ2xlU3RhdGVzJyl9JHtpMThuLnQoJ2Fsd2F5c1Nob3dHcmFwaGljYWxJbnRlcmZhY2UnKX0g44CMJHtpMThuLnQoJ2dsb2JhbFNldHRpbmcnKX3jgI1gLAogICAgZm46ICgpID0+IHsKICAgICAgY29uc3QgYWx3YXlzU2hvdyA9IGNvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgndWkuYWx3YXlzU2hvdycpOwogICAgICBjb25zdCBjb25maXJtID0gd2luZG93LmNvbmZpcm0oYWx3YXlzU2hvdyA9PT0gdHJ1ZSA/IGAke2kxOG4udCgnZGlzYWJsZScpfSR7aTE4bi50KCdhbHdheXNTaG93R3JhcGhpY2FsSW50ZXJmYWNlJyl9IOOAjCR7aTE4bi50KCdnbG9iYWxTZXR0aW5nJyl944CNYCA6IGAke2kxOG4udCgnYWx3YXlzU2hvd0dyYXBoaWNhbEludGVyZmFjZScpfSDjgIwke2kxOG4udCgnZ2xvYmFsU2V0dGluZycpfeOAjWApOwogICAgICBpZiAoY29uZmlybSkgewogICAgICAgIGNvbmZpZ01hbmFnZXIuc2V0R2xvYmFsU3RvcmFnZSgndWkuYWx3YXlzU2hvdycsICFhbHdheXNTaG93KTsKICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgICAgIH0KICAgIH0KICB9LAoKICB0b2dnbGVIb3RrZXlzU3RhdHVzOiB7CiAgICB0aXRsZTogKCkgPT4gYCR7Y29uZmlnTWFuYWdlci5nZXRHbG9iYWxTdG9yYWdlKCdlbmFibGVIb3RrZXlzJykgPT09IGZhbHNlID8gaTE4bi50KCdlbmFibGVIb3RrZXlzJykgOiBpMThuLnQoJ2Rpc2FibGVIb3RrZXlzJyl9IOOAjCR7aTE4bi50KCdnbG9iYWxTZXR0aW5nJyl944CNYCwKICAgIGRlc2M6ICgpID0+IGAke2NvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgnZW5hYmxlSG90a2V5cycpID09PSBmYWxzZSA/IGkxOG4udCgnZW5hYmxlSG90a2V5cycpIDogaTE4bi50KCdkaXNhYmxlSG90a2V5cycpfSDjgIwke2kxOG4udCgnZ2xvYmFsU2V0dGluZycpfeOAjWAsCiAgICBmbjogKCkgPT4gewogICAgICBjb25zdCBjb25maXJtID0gd2luZG93LmNvbmZpcm0oYCR7Y29uZmlnTWFuYWdlci5nZXRHbG9iYWxTdG9yYWdlKCdlbmFibGVIb3RrZXlzJykgPT09IGZhbHNlID8gaTE4bi50KCdlbmFibGVIb3RrZXlzJykgOiBpMThuLnQoJ2Rpc2FibGVIb3RrZXlzJyl9IOOAjCR7aTE4bi50KCdnbG9iYWxTZXR0aW5nJyl944CNYCk7CiAgICAgIGlmIChjb25maXJtKSB7CiAgICAgICAgY29uZmlnTWFuYWdlci5zZXRHbG9iYWxTdG9yYWdlKCdlbmFibGVIb3RrZXlzJywgIWNvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgnZW5hYmxlSG90a2V5cycpKTsKICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgICAgIH0KICAgIH0KICB9LAoKICB0b2dnbGVIb3RrZXlzU3RhdHVzVW5kZXJDdXJyZW50U2l0ZTogewogICAgdGl0bGU6ICgpID0+IGAke2NvbmZpZ01hbmFnZXIuZ2V0TG9jYWxTdG9yYWdlKCdlbmFibGVIb3RrZXlzJykgPT09IGZhbHNlID8gaTE4bi50KCdlbmFibGVIb3RrZXlzJykgOiBpMThuLnQoJ2Rpc2FibGVIb3RrZXlzJyl9IOOAjCR7aTE4bi50KCdsb2NhbFNldHRpbmcnKX3jgI1gLAogICAgZGVzYzogKCkgPT4gYCR7Y29uZmlnTWFuYWdlci5nZXRMb2NhbFN0b3JhZ2UoJ2VuYWJsZUhvdGtleXMnKSA9PT0gZmFsc2UgPyBpMThuLnQoJ2VuYWJsZUhvdGtleXMnKSA6IGkxOG4udCgnZGlzYWJsZUhvdGtleXMnKX0g44CMJHtpMThuLnQoJ2xvY2FsU2V0dGluZycpfeOAjWAsCiAgICBmbjogKCkgPT4gewogICAgICBjb25zdCBjb25maXJtID0gd2luZG93LmNvbmZpcm0oYCR7Y29uZmlnTWFuYWdlci5nZXRMb2NhbFN0b3JhZ2UoJ2VuYWJsZUhvdGtleXMnKSA9PT0gZmFsc2UgPyBpMThuLnQoJ2VuYWJsZUhvdGtleXMnKSA6IGkxOG4udCgnZGlzYWJsZUhvdGtleXMnKX0g44CMJHtpMThuLnQoJ2xvY2FsU2V0dGluZycpfeOAjWApOwogICAgICBpZiAoY29uZmlybSkgewogICAgICAgIGNvbmZpZ01hbmFnZXIuc2V0TG9jYWxTdG9yYWdlKCdlbmFibGVIb3RrZXlzJywgIWNvbmZpZ01hbmFnZXIuZ2V0TG9jYWxTdG9yYWdlKCdlbmFibGVIb3RrZXlzJykpOwogICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgfQogICAgfQogIH0sCgogIHRvZ2dsZU1vdXNlQ29udHJvbDogewogICAgdGl0bGU6ICgpID0+IGAke2NvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgnbW91c2UuZW5hYmxlJykgPT09IGZhbHNlID8gaTE4bi50KCdtb3VzZS5lbmFibGUnKSA6IGkxOG4udCgnbW91c2UuZGlzYWJsZScpfSDjgIwke2kxOG4udCgnZ2xvYmFsU2V0dGluZycpfeOAjWAsCiAgICBkZXNjOiAoKSA9PiBgJHtjb25maWdNYW5hZ2VyLmdldEdsb2JhbFN0b3JhZ2UoJ21vdXNlLmVuYWJsZScpID09PSBmYWxzZSA/IGkxOG4udCgnbW91c2UuZW5hYmxlJykgOiBpMThuLnQoJ21vdXNlLmRpc2FibGUnKX0g44CMJHtpMThuLnQoJ2dsb2JhbFNldHRpbmcnKX3jgI1gLAogICAgZm46ICgpID0+IHsKICAgICAgY29uc3QgY29uZmlybSA9IHdpbmRvdy5jb25maXJtKGAke2NvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgnbW91c2UuZW5hYmxlJykgPT09IGZhbHNlID8gaTE4bi50KCdtb3VzZS5lbmFibGUnKSA6IGkxOG4udCgnbW91c2UuZGlzYWJsZScpfSDjgIwke2kxOG4udCgnZ2xvYmFsU2V0dGluZycpfeOAjWApOwogICAgICBpZiAoY29uZmlybSkgewogICAgICAgIGNvbmZpZ01hbmFnZXIuc2V0R2xvYmFsU3RvcmFnZSgnbW91c2UuZW5hYmxlJywgIWNvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgnbW91c2UuZW5hYmxlJykpOwogICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgfQogICAgfQogIH0sCgogIHRvZ2dsZU1vdXNlQ29udHJvbFVuZGVyQ3VycmVudFNpdGU6IHsKICAgIHRpdGxlOiAoKSA9PiBgJHtjb25maWdNYW5hZ2VyLmdldExvY2FsU3RvcmFnZSgnbW91c2UuZW5hYmxlJykgPT09IGZhbHNlID8gaTE4bi50KCdtb3VzZS5lbmFibGUnKSA6IGkxOG4udCgnbW91c2UuZGlzYWJsZScpfSDjgIwke2kxOG4udCgnbG9jYWxTZXR0aW5nJyl944CNYCwKICAgIGRlc2M6ICgpID0+IGAke2NvbmZpZ01hbmFnZXIuZ2V0TG9jYWxTdG9yYWdlKCdtb3VzZS5lbmFibGUnKSA9PT0gZmFsc2UgPyBpMThuLnQoJ21vdXNlLmVuYWJsZScpIDogaTE4bi50KCdtb3VzZS5kaXNhYmxlJyl9IOOAjCR7aTE4bi50KCdsb2NhbFNldHRpbmcnKX3jgI1gLAogICAgZm46ICgpID0+IHsKICAgICAgY29uc3QgY29uZmlybSA9IHdpbmRvdy5jb25maXJtKGAke2NvbmZpZ01hbmFnZXIuZ2V0TG9jYWxTdG9yYWdlKCdtb3VzZS5lbmFibGUnKSA9PT0gZmFsc2UgPyBpMThuLnQoJ21vdXNlLmVuYWJsZScpIDogaTE4bi50KCdtb3VzZS5kaXNhYmxlJyl9IOOAjCR7aTE4bi50KCdsb2NhbFNldHRpbmcnKX3jgI1gKTsKICAgICAgaWYgKGNvbmZpcm0pIHsKICAgICAgICBjb25maWdNYW5hZ2VyLnNldExvY2FsU3RvcmFnZSgnbW91c2UuZW5hYmxlJywgIWNvbmZpZ01hbmFnZXIuZ2V0TG9jYWxTdG9yYWdlKCdtb3VzZS5lbmFibGUnKSk7CiAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOwogICAgICB9CiAgICB9CiAgfSwKCiAgc2V0TW91c2VMb25nUHJlc3NUaW1lOiB7CiAgICB0aXRsZTogYCR7aTE4bi50KCdtb3VzZS5sb25nUHJlc3NUaW1lJyl944CMJHtpMThuLnQoJ2dsb2JhbFNldHRpbmcnKX3jgI1gLAogICAgZGVzYzogYCR7aTE4bi50KCdtb3VzZS5sb25nUHJlc3NUaW1lJyl944CMJHtpMThuLnQoJ2dsb2JhbFNldHRpbmcnKX3jgI1gLAogICAgZm46ICgpID0+IHsKICAgICAgY29uc3QgbG9uZ1ByZXNzVGltZSA9IHByb21wdChgJHtpMThuLnQoJ21vdXNlLmxvbmdQcmVzc1RpbWUnKX3jgIwke2kxOG4udCgnZ2xvYmFsU2V0dGluZycpfeOAjWAsIGNvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgnbW91c2UubG9uZ1ByZXNzVGltZScpIHx8IDYwMCk7CiAgICAgIGlmIChsb25nUHJlc3NUaW1lKSB7CiAgICAgICAgY29uZmlnTWFuYWdlci5zZXRHbG9iYWxTdG9yYWdlKCdtb3VzZS5sb25nUHJlc3NUaW1lJywgTnVtYmVyKGxvbmdQcmVzc1RpbWUpKTsKICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgICAgIH0KICAgIH0KICB9LAoKICB0b2dnbGVEb3dubG9hZENvbnRyb2w6IHsKICAgIHRpdGxlOiAoKSA9PiBgJHtjb25maWdNYW5hZ2VyLmdldEdsb2JhbFN0b3JhZ2UoJ2Rvd25sb2FkLmVuYWJsZScpID09PSBmYWxzZSA/IGkxOG4udCgnbWVkaWFEb3dubG9hZC5lbmFibGUnKSA6IGkxOG4udCgnbWVkaWFEb3dubG9hZC5kaXNhYmxlJyl9IOOAjCR7aTE4bi50KCdnbG9iYWxTZXR0aW5nJyl944CNYCwKICAgIGRlc2M6ICgpID0+IGAke2NvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgnZG93bmxvYWQuZW5hYmxlJykgPT09IGZhbHNlID8gaTE4bi50KCdtZWRpYURvd25sb2FkLmVuYWJsZScpIDogaTE4bi50KCdtZWRpYURvd25sb2FkLmRpc2FibGUnKX0g44CMJHtpMThuLnQoJ2dsb2JhbFNldHRpbmcnKX3jgI1gLAogICAgZm46ICgpID0+IHsKICAgICAgY29uc3QgY29uZmlybSA9IHdpbmRvdy5jb25maXJtKGAke2NvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgnZG93bmxvYWQuZW5hYmxlJykgPT09IGZhbHNlID8gaTE4bi50KCdtZWRpYURvd25sb2FkLmVuYWJsZScpIDogaTE4bi50KCdtZWRpYURvd25sb2FkLmRpc2FibGUnKX0g44CMJHtpMThuLnQoJ2dsb2JhbFNldHRpbmcnKX3jgI1gKTsKICAgICAgaWYgKGNvbmZpcm0pIHsKICAgICAgICBjb25maWdNYW5hZ2VyLnNldEdsb2JhbFN0b3JhZ2UoJ2Rvd25sb2FkLmVuYWJsZScsICFjb25maWdNYW5hZ2VyLmdldEdsb2JhbFN0b3JhZ2UoJ2Rvd25sb2FkLmVuYWJsZScpKTsKICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgICAgIH0KICAgIH0KICB9LAoKICB0b2dnbGVEb3dubG9hZENvbnRyb2xVbmRlckN1cnJlbnRTaXRlOiB7CiAgICB0aXRsZTogKCkgPT4gYCR7Y29uZmlnTWFuYWdlci5nZXRMb2NhbFN0b3JhZ2UoJ2Rvd25sb2FkLmVuYWJsZScpID09PSBmYWxzZSA/IGkxOG4udCgnbWVkaWFEb3dubG9hZC5lbmFibGUnKSA6IGkxOG4udCgnbWVkaWFEb3dubG9hZC5kaXNhYmxlJyl9IOOAjCR7aTE4bi50KCdsb2NhbFNldHRpbmcnKX3jgI1gLAogICAgZGVzYzogKCkgPT4gYCR7Y29uZmlnTWFuYWdlci5nZXRMb2NhbFN0b3JhZ2UoJ2Rvd25sb2FkLmVuYWJsZScpID09PSBmYWxzZSA/IGkxOG4udCgnbWVkaWFEb3dubG9hZC5lbmFibGUnKSA6IGkxOG4udCgnbWVkaWFEb3dubG9hZC5kaXNhYmxlJyl9IOOAjCR7aTE4bi50KCdsb2NhbFNldHRpbmcnKX3jgI1gLAogICAgZm46ICgpID0+IHsKICAgICAgY29uc3QgY29uZmlybSA9IHdpbmRvdy5jb25maXJtKGAke2NvbmZpZ01hbmFnZXIuZ2V0TG9jYWxTdG9yYWdlKCdkb3dubG9hZC5lbmFibGUnKSA9PT0gZmFsc2UgPyBpMThuLnQoJ21lZGlhRG93bmxvYWQuZW5hYmxlJykgOiBpMThuLnQoJ21lZGlhRG93bmxvYWQuZGlzYWJsZScpfSDjgIwke2kxOG4udCgnbG9jYWxTZXR0aW5nJyl944CNYCk7CiAgICAgIGlmIChjb25maXJtKSB7CiAgICAgICAgY29uZmlnTWFuYWdlci5zZXRMb2NhbFN0b3JhZ2UoJ2Rvd25sb2FkLmVuYWJsZScsICFjb25maWdNYW5hZ2VyLmdldExvY2FsU3RvcmFnZSgnZG93bmxvYWQuZW5hYmxlJykpOwogICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgfQogICAgfQogIH0sCgogIHNldExhbmd1YWdlOiB7CiAgICB0aXRsZTogYCR7aTE4bi50KCdsYW5ndWFnZVNldHRpbmdzJyl944CMJHtpMThuLnQoJ2dsb2JhbFNldHRpbmcnKX3jgI1gLAogICAgZGVzYzogYCR7aTE4bi50KCdsYW5ndWFnZVNldHRpbmdzJyl944CMJHtpMThuLnQoJ2dsb2JhbFNldHRpbmcnKX3jgI1gLAogICAgZm46IChsYW5nKSA9PiB7CiAgICAgIGNvbnN0IGNvbmZpcm0gPSB3aW5kb3cuY29uZmlybShgJHtpMThuLnQoJ2xhbmd1YWdlU2V0dGluZ3MnKX1bJHtsYW5nfV0gP2ApOwogICAgICBpZiAoY29uZmlybSkgewogICAgICAgIGlmIChsYW5nID09PSAnYXV0bycgfHwgaTE4bi5sYW5ndWFnZXMoKVtsYW5nXSkgewogICAgICAgICAgY29uZmlnTWFuYWdlci5zZXRHbG9iYWxTdG9yYWdlKCdsYW5ndWFnZScsIGxhbmcpOwogICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhbGVydCgnTGFuZ3VhZ2Ugbm90IGZvdW5kJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwKCiAgY2xlYW5SZW1vdGVIZWxwZXJJbmZvOiB7CiAgICB0aXRsZTogaTE4bi50KCdjbGVhblJlbW90ZUhlbHBlckluZm8nKSwKICAgIGRlc2M6IGkxOG4udCgnY2xlYW5SZW1vdGVIZWxwZXJJbmZvJyksCiAgICBmbjogKCkgPT4gewogICAgICBjb25maWdNYW5hZ2VyLnNldEdsb2JhbFN0b3JhZ2UoJ3JlY29tbWVuZExpc3QnLCBmYWxzZSk7CiAgICAgIGNvbmZpZ01hbmFnZXIuc2V0R2xvYmFsU3RvcmFnZSgnY29udGFjdFJlbW90ZUhlbHBlclN1Y2Nlc3NUaW1lJywgZmFsc2UpOwogICAgICBjb25maWdNYW5hZ2VyLnNldEdsb2JhbFN0b3JhZ2UoJ2xhc3RDb250YWN0UmVtb3RlSGVscGVyVGltZScsIGZhbHNlKTsKICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOwogICAgfQogIH0KfTsKCi8qIQogKiBAbmFtZSAgICAgICAgIG1lbnVNYW5hZ2VyLmpzCiAqIEBkZXNjcmlwdGlvbiAg6I+c5Y2V566h55CG5ZmoCiAqIEB2ZXJzaW9uICAgICAgMC4wLjEKICogQGF1dGhvciAgICAgICB4eHhpbHkKICogQGRhdGUgICAgICAgICAyMDIyLzA4LzExIDEwOjA1CiAqIEBnaXRodWIgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL3h4eGlseQogKi8KCmxldCBtb25rZXlNZW51TGlzdCA9IFsKICB7IC4uLmdsb2JhbEZ1bmN0aW9uYWwub3BlbldlYnNpdGUgfSwKICAvLyB7IC4uLmdsb2JhbEZ1bmN0aW9uYWwub3BlbkhvdGtleXNQYWdlIH0sCiAgewogICAgLi4uZ2xvYmFsRnVuY3Rpb25hbC5vcGVuSXNzdWVzUGFnZSwKICAgIGRpc2FibGU6ICFjb25maWdNYW5hZ2VyLmdldCgnZW5oYW5jZS51bmZvbGRNZW51JykKICB9LAogIHsgLi4uZ2xvYmFsRnVuY3Rpb25hbC5vcGVuRG9uYXRlUGFnZSB9LAogIHsKICAgIC4uLmdsb2JhbEZ1bmN0aW9uYWwudG9nZ2xlU2NyaXB0RW5hYmxlU3RhdGUKICB9LAogIHsKICAgIC4uLmdsb2JhbEZ1bmN0aW9uYWwudG9nZ2xlR1VJU3RhdHVzVW5kZXJDdXJyZW50U2l0ZSwKICAgIGRpc2FibGU6IGNvbmZpZ01hbmFnZXIuZ2V0TG9jYWxTdG9yYWdlKCd1aS5lbmFibGUnKSAhPT0gZmFsc2UKICB9LAogIHsKICAgIC4uLmdsb2JhbEZ1bmN0aW9uYWwudG9nZ2xlR1VJU3RhdHVzLAogICAgZGlzYWJsZTogY29uZmlnTWFuYWdlci5nZXRHbG9iYWxTdG9yYWdlKCd1aS5lbmFibGUnKSA9PT0gZmFsc2UgPyBmYWxzZSA6ICFjb25maWdNYW5hZ2VyLmdldCgnZW5oYW5jZS51bmZvbGRNZW51JykKICB9LAogIHsKICAgIC4uLmdsb2JhbEZ1bmN0aW9uYWwudG9nZ2xlSG90a2V5c1N0YXR1c1VuZGVyQ3VycmVudFNpdGUsCiAgICBkaXNhYmxlOiBjb25maWdNYW5hZ2VyLmdldExvY2FsU3RvcmFnZSgnZW5hYmxlSG90a2V5cycpICE9PSBmYWxzZQogIH0sCiAgewogICAgLi4uZ2xvYmFsRnVuY3Rpb25hbC50b2dnbGVIb3RrZXlzU3RhdHVzLAogICAgZGlzYWJsZTogY29uZmlnTWFuYWdlci5nZXQoJ2VuYWJsZUhvdGtleXMnKSAhPT0gZmFsc2UKICB9LAogIHsgLi4uZ2xvYmFsRnVuY3Rpb25hbC5vcGVuQ3VzdG9tQ29uZmlndXJhdGlvbkVkaXRvciB9LAogIC8qIOWxleW8gOaIluaUtui1t+iPnOWNlSAqLwogIHsgLi4uZ2xvYmFsRnVuY3Rpb25hbC50b2dnbGVFeHBhbmRlZE9yQ29sbGFwc2VkU3RhdGVPZk1vbmtleU1lbnUgfSwKICB7CiAgICAuLi5nbG9iYWxGdW5jdGlvbmFsLnJlc3RvcmVHbG9iYWxDb25maWd1cmF0aW9uLAogICAgZGlzYWJsZTogIWNvbmZpZ01hbmFnZXIuZ2V0KCdlbmhhbmNlLnVuZm9sZE1lbnUnKQogIH0KXTsKCi8qIOiPnOWNleaehOmAoOWHveaVsO+8iOW/hemhu+aYr+WHveaVsOaJjeiDveWcqOeCueWHu+WQjuWKqOaAgeabtOaWsOiPnOWNleeKtuaAge+8iSAqLwpmdW5jdGlvbiBtZW51QnVpbGRlciAoKSB7CiAgcmV0dXJuIG1vbmtleU1lbnVMaXN0Cn0KCi8qIOazqOWGjOWKqOaAgeiPnOWNlSAqLwpmdW5jdGlvbiBtZW51UmVnaXN0ZXIgKCkgewogIG1vbmtleU1lbnUuYnVpbGQobWVudUJ1aWxkZXIpOwp9CgovKioKICog5aKe5Yqg6I+c5Y2V6aG5CiAqIEBwYXJhbSB7T2JqZWN0fEFycmF5fSBtZW51T3B0cyDoj5zljZXnmoTphY3nva7pobnnm67vvIzlpJrkuKrphY3nva7pobnnm67nlKjmlbDnu4TooajnpLoKICovCmZ1bmN0aW9uIGFkZE1lbnUgKG1lbnVPcHRzLCBiZWZvcmUpIHsKICBtZW51T3B0cyA9IEFycmF5LmlzQXJyYXkobWVudU9wdHMpID8gbWVudU9wdHMgOiBbbWVudU9wdHNdOwogIG1lbnVPcHRzID0gbWVudU9wdHMuZmlsdGVyKGl0ZW0gPT4gaXRlbS50aXRsZSAmJiAhaXRlbS5kaXNhYmxlZCk7CgogIGlmIChiZWZvcmUpIHsKICAgIC8qIOWwhuiPnOWNlei/veWKoOWIsOWFtuWug+iPnOWNleeahOWJjemdoiAqLwogICAgbW9ua2V5TWVudUxpc3QgPSBtZW51T3B0cy5jb25jYXQobW9ua2V5TWVudUxpc3QpOwogIH0gZWxzZSB7CiAgICBtb25rZXlNZW51TGlzdCA9IG1vbmtleU1lbnVMaXN0LmNvbmNhdChtZW51T3B0cyk7CiAgfQoKICAvKiDph43mlrDms6jlhozoj5zljZUgKi8KICBtZW51UmVnaXN0ZXIoKTsKfQoKLyoqCiAqIOazqOWGjOi3n2g1cGxheWVy55u45YWz55qE6I+c5Y2V77yM5Y+q5pyJ5qOA5rWL5Yiw5a2Y5Zyo5aqS5L2T5qCH562+5LqG5omN5Lya5rOo5YaMCiAqLwpmdW5jdGlvbiByZWdpc3Rlckg1cGxheWVyTWVudXMgKGg1cGxheWVyKSB7CiAgY29uc3QgdCA9IGg1cGxheWVyOwogIGNvbnN0IHBsYXllciA9IHQucGxheWVyKCk7CiAgY29uc3QgZm9sZE1lbnUgPSAhY29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UudW5mb2xkTWVudScpOwoKICBpZiAocGxheWVyICYmICF0Ll9oYXNSZWdpc3Rlckg1cGxheWVyTWVudXNfKSB7CiAgICBjb25zdCBtZW51cyA9IFsKICAgICAgewogICAgICAgIC4uLmdsb2JhbEZ1bmN0aW9uYWwub3BlbkNyb3NzT3JpZ2luRnJhbWVQYWdlLAogICAgICAgIGRpc2FibGU6IGZvbGRNZW51IHx8ICFpc0luQ3Jvc3NPcmlnaW5GcmFtZSgpCiAgICAgIH0sCiAgICAgIHsKICAgICAgICAuLi5nbG9iYWxGdW5jdGlvbmFsLnRvZ2dsZVNldEN1cnJlbnRUaW1lRnVuY3Rpb25hbCwKICAgICAgICB0eXBlOiAnbG9jYWwnLAogICAgICAgIGRpc2FibGU6IGZvbGRNZW51CiAgICAgIH0sCiAgICAgIHsKICAgICAgICAuLi5nbG9iYWxGdW5jdGlvbmFsLnRvZ2dsZVNldFZvbHVtZUZ1bmN0aW9uYWwsCiAgICAgICAgdHlwZTogJ2xvY2FsJywKICAgICAgICBkaXNhYmxlOiBmb2xkTWVudQogICAgICB9LAogICAgICB7CiAgICAgICAgLi4uZ2xvYmFsRnVuY3Rpb25hbC50b2dnbGVTZXRQbGF5YmFja1JhdGVGdW5jdGlvbmFsLAogICAgICAgIHR5cGU6ICdnbG9iYWwnLAogICAgICAgIGRpc2FibGU6IGZvbGRNZW51CiAgICAgIH0sCiAgICAgIHsKICAgICAgICAuLi5nbG9iYWxGdW5jdGlvbmFsLnRvZ2dsZUFjb3VzdGljR2FpbkZ1bmN0aW9uYWwsCiAgICAgICAgdHlwZTogJ2dsb2JhbCcsCiAgICAgICAgZGlzYWJsZTogZm9sZE1lbnUKICAgICAgfSwKICAgICAgewogICAgICAgIC4uLmdsb2JhbEZ1bmN0aW9uYWwudG9nZ2xlQ3Jvc3NPcmlnaW5Db250cm9sRnVuY3Rpb25hbCwKICAgICAgICB0eXBlOiAnZ2xvYmFsJywKICAgICAgICBkaXNhYmxlOiBmb2xkTWVudQogICAgICB9LAogICAgICB7CiAgICAgICAgLi4uZ2xvYmFsRnVuY3Rpb25hbC50b2dnbGVFeHBlcmltZW50RmVhdHVyZXMsCiAgICAgICAgdHlwZTogJ2dsb2JhbCcsCiAgICAgICAgZGlzYWJsZTogZm9sZE1lbnUKICAgICAgfSwKICAgICAgewogICAgICAgIC4uLmdsb2JhbEZ1bmN0aW9uYWwudG9nZ2xlRXh0ZXJuYWxDdXN0b21Db25maWd1cmF0aW9uLAogICAgICAgIHR5cGU6ICdnbG9iYWwnLAogICAgICAgIGRpc2FibGU6IGZvbGRNZW51CiAgICAgIH0sCiAgICAgIHsKICAgICAgICAuLi5nbG9iYWxGdW5jdGlvbmFsLnRvZ2dsZURlYnVnTW9kZSwKICAgICAgICBkaXNhYmxlOiBmb2xkTWVudQogICAgICB9CiAgICBdOwoKICAgIGxldCB0aXRsZVByZWZpeCA9ICcnOwogICAgaWYgKGlzSW5JZnJhbWUoKSkgewogICAgICB0aXRsZVByZWZpeCA9IGBbJHtsb2NhdGlvbi5ob3N0bmFtZX1dYDsKCiAgICAgIC8qIOihpeWFhXRpdGxl5YmN57yAICovCiAgICAgIG1lbnVzLmZvckVhY2gobWVudSA9PiB7CiAgICAgICAgY29uc3QgdGl0bGVGbiA9IG1lbnUudGl0bGU7CiAgICAgICAgaWYgKHRpdGxlRm4gaW5zdGFuY2VvZiBGdW5jdGlvbiAmJiBtZW51LnR5cGUgPT09ICdsb2NhbCcpIHsKICAgICAgICAgIG1lbnUudGl0bGUgPSAoKSA9PiB0aXRsZVByZWZpeCArIHRpdGxlRm4oKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKICAgIGFkZE1lbnUobWVudXMpOwoKICAgIHQuX2hhc1JlZ2lzdGVySDVwbGF5ZXJNZW51c18gPSB0cnVlOwogIH0KfQoKLyoqCiAgICog5Luj55CG6KeG6aKR5pKt5pS+5Zmo55qE5LqL5Lu25rOo5YaM5ZKM5Y+W5raI5rOo5YaM55qE5Ye95pWw77yM5Lul5a+55rOo5YaM5LqL5Lu26L+b6KGM6LCD6K+V5oiW6Zi75patCiAgICogQHBhcmFtIHsqfSBwbGF5ZXIKICAgKiBAcmV0dXJucwogICAqLwpmdW5jdGlvbiBwcm94eUhUTUxNZWRpYUVsZW1lbnRFdmVudCAoKSB7CiAgaWYgKEhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLl9yYXdBZGRFdmVudExpc3RlbmVyXykgewogICAgcmV0dXJuIGZhbHNlCiAgfQoKICBIVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZS5fcmF3QWRkRXZlbnRMaXN0ZW5lcl8gPSBIVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyOwogIEhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLl9yYXdSZW1vdmVFdmVudExpc3RlbmVyXyA9IEhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXI7CgogIEhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIgPSBuZXcgUHJveHkoSFRNTE1lZGlhRWxlbWVudC5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lciwgewogICAgYXBwbHkgKHRhcmdldCwgY3R4LCBhcmdzKSB7CiAgICAgIGNvbnN0IGV2ZW50TmFtZSA9IGFyZ3NbMF07CiAgICAgIGNvbnN0IGxpc3RlbmVyID0gYXJnc1sxXTsKICAgICAgaWYgKGxpc3RlbmVyIGluc3RhbmNlb2YgRnVuY3Rpb24gJiYgZXZlbnROYW1lID09PSAncmF0ZWNoYW5nZScpIHsKICAgICAgICAvKiDlr7nms6jlhozkuoZyYXRlY2hhbmdl5LqL5Lu26L+b6KGM5qOA5rWL77yM5aaC5p6c5a2Y5Zyo5byC5bi46KGM5Li677yM5YiZ5bCd6K+V5oyC6LW35LqL5Lu2ICovCgogICAgICAgIGFyZ3NbMV0gPSBuZXcgUHJveHkobGlzdGVuZXIsIHsKICAgICAgICAgIGFwcGx5ICh0YXJnZXQsIGN0eCwgYXJncykgewogICAgICAgICAgICBpZiAoY3R4KSB7CiAgICAgICAgICAgICAgLyog6Zi75q2i6LCD6YCf5qOA5rWL77yM5bm26L+b6KGM5Y+N6Zi75q2iICovCiAgICAgICAgICAgICAgaWYgKGN0eC5wbGF5YmFja1JhdGUgJiYgZXZlbnROYW1lID09PSAncmF0ZWNoYW5nZScpIHsKICAgICAgICAgICAgICAgIGlmIChjdHguX2hhc0Jsb2NrUmF0ZWNoYW5nZUV2ZW50XykgewogICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNvbnN0IG9sZFJhdGUgPSBjdHgucGxheWJhY2tSYXRlOwogICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTsKCiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB0YXJnZXQuYXBwbHkoY3R4LCBhcmdzKTsKCiAgICAgICAgICAgICAgICAvKioKICAgICAgICAgICAgICAgICAqIOmAmui/h+WIpOaWreaJp+ihjHJhdGVjaGFuZ2XliY3lkI7nmoTpgJ/njofmmK/lkKbooqvmlLnlj5jvvIwKICAgICAgICAgICAgICAgICAqIOS7peWPiuaYr+WQpuWHuueOsOS6hui2hemVv+eahOaJp+ihjOaXtumXtO+8iOWPr+iDveWHuueOsOS6hmFsZXJ05by556qX77yJ5p2l5qOA5rWL5piv5ZCm5Y+v6IO95a2Y5Zyo6Zi75q2i6LCD6YCf55qE6KGM5Li6CiAgICAgICAgICAgICAgICAgKiDlhbbku5bmo4DmtYvmiYvmrrXlvoXooaXlhYUKICAgICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgICAgY29uc3QgYmxvY2tSYXRlY2hhbmdlQmVoYXZlMSA9IG9sZFJhdGUgIT09IGN0eC5wbGF5YmFja1JhdGUgfHwgRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSA+IDEwMDA7CiAgICAgICAgICAgICAgICBjb25zdCBibG9ja1JhdGVjaGFuZ2VCZWhhdmUyID0gY3R4Ll9zZXRQbGF5YmFja1JhdGVfICYmIGN0eC5fc2V0UGxheWJhY2tSYXRlXy52YWx1ZSAhPT0gY3R4LnBsYXliYWNrUmF0ZTsKICAgICAgICAgICAgICAgIGlmIChibG9ja1JhdGVjaGFuZ2VCZWhhdmUxIHx8IGJsb2NrUmF0ZWNoYW5nZUJlaGF2ZTIpIHsKICAgICAgICAgICAgICAgICAgZGVidWcuaW5mbyhgW2V4ZWNWaWRlb0V2ZW50XVske2V2ZW50TmFtZX1d5qOA5rWL5Yiw5Y+v6IO95a2Y5Zyo6Zi75q2i6LCD6YCf55qE6KGM5Li677yM5bey56aB5q2iJHtldmVudE5hbWV95LqL5Lu255qE5omn6KGMYCwgbGlzdGVuZXIpOwogICAgICAgICAgICAgICAgICBjdHguX2hhc0Jsb2NrUmF0ZWNoYW5nZUV2ZW50XyA9IHRydWU7CiAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHJldHVybiB0YXJnZXQuYXBwbHkoY3R4LCBhcmdzKQogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgZGVidWcuZXJyb3IoYFtwcm94eVBsYXllckV2ZW50XVske2V2ZW50TmFtZX1dYCwgbGlzdGVuZXIsIGUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQuYXBwbHkoY3R4LCBhcmdzKQogICAgfQogIH0pOwp9Cgpjb25zdCBtZWRpYVNvdXJjZSA9IChmdW5jdGlvbiAoKSB7CiAgbGV0IGhhc01lZGlhU291cmNlSW5pdCA9IGZhbHNlOwogIGNvbnN0IG9yaWdpbk1ldGhvZHMgPSB7fTsKICBjb25zdCBvcmlnaW5VUkxNZXRob2RzID0ge307CiAgY29uc3QgbWVkaWFTb3VyY2VNYXAgPSBuZXcgb3JpZ2luYWwuTWFwKCk7CiAgY29uc3Qgb2JqZWN0VVJMTWFwID0gbmV3IG9yaWdpbmFsLk1hcCgpOwoKICBmdW5jdGlvbiBjb25uZWN0TWVkaWFTb3VyY2VXaXRoTWVkaWFFbGVtZW50IChtZWRpYUVsKSB7CiAgICBjb25zdCBjdXJTcmMgPSBtZWRpYUVsLmN1cnJlbnRTcmMgfHwgbWVkaWFFbC5zcmM7CgogICAgaWYgKCFjdXJTcmMpIHsgcmV0dXJuIGZhbHNlIH0KCiAgICBtZWRpYVNvdXJjZU1hcC5mb3JFYWNoKG1lZGlhU291cmNlSW5mbyA9PiB7CiAgICAgIGlmIChtZWRpYVNvdXJjZUluZm8ubWVkaWFTb3VyY2UuX19vYmpVUkxfXyAmJiBjdXJTcmMgPT09IG1lZGlhU291cmNlSW5mby5tZWRpYVNvdXJjZS5fX29ialVSTF9fKSB7CiAgICAgICAgbWVkaWFTb3VyY2VJbmZvLm1lZGlhRWxlbWVudCA9IG1lZGlhRWw7CiAgICAgIH0KICAgIH0pOwogIH0KCiAgLyog5aaC5p6cbWVkaWFTb3VyY2VNYXDkuK3lhbPogZTnmoRtZWRpYUVs5qOA5rWL5Yiw5LiN5a2Y5Zyo5LqG77yM5YiZ5riF55CGbWVkaWFTb3VyY2VNYXDkuK3nmoTmlbDmja7vvIzlh4/lsJHlhoXlrZjljaDnlKggKi8KICBmdW5jdGlvbiBjbGVhbk1lZGlhU291cmNlRGF0YSAoKSB7CiAgICBmdW5jdGlvbiByZW1vdmVNZWRpYVNvdXJjZURhdGEgKG1lZGlhU291cmNlSW5mbykgewogICAgICBjb25zb2xlLmxvZygnW2NsZWFuTWVkaWFTb3VyY2VEYXRhXVtyZW1vdmVNZWRpYVNvdXJjZURhdGFdJywgbWVkaWFTb3VyY2VJbmZvLm1lZGlhVXJsIHx8IG1lZGlhU291cmNlSW5mby5tZWRpYVNvdXJjZS5fX29ialVSTF9fKTsKCiAgICAgIC8qIOa4heeQhnNvdXJjZUJ1ZmZlcuebuOWFs+aVsOaNriAqLwogICAgICBpZiAobWVkaWFTb3VyY2VJbmZvLnNvdXJjZUJ1ZmZlciAmJiBtZWRpYVNvdXJjZUluZm8uc291cmNlQnVmZmVyLmxlbmd0aCkgewogICAgICAgIG1lZGlhU291cmNlSW5mby5zb3VyY2VCdWZmZXIuZm9yRWFjaChzb3VyY2VCdWZmZXJJdGVtID0+IHsKICAgICAgICAgIC8qIOa4heepumJ1ZmZlcuaVsOaNriAqLwogICAgICAgICAgc291cmNlQnVmZmVySXRlbS5idWZmZXJEYXRhID0gW107CiAgICAgICAgICAvKiDnp7vpmaTljp/lp4thcHBlbmRCdWZmZXLnmoTlvJXnlKggKi8KICAgICAgICAgIHNvdXJjZUJ1ZmZlckl0ZW0ub3JpZ2luQXBwZW5kQnVmZmVyID0gbnVsbDsKICAgICAgICB9KTsKICAgICAgICBtZWRpYVNvdXJjZUluZm8uc291cmNlQnVmZmVyID0gW107CiAgICAgIH0KCiAgICAgIC8qIOenu+mZpOWvuW1lZGlhRWxlbWVudOeahOW8leeUqCAqLwogICAgICBtZWRpYVNvdXJjZUluZm8ubWVkaWFFbGVtZW50ID0gbnVsbDsKCiAgICAgIG9yaWdpbmFsLm1hcC5kZWxldGUuY2FsbChtZWRpYVNvdXJjZU1hcCwgbWVkaWFTb3VyY2VJbmZvLm1lZGlhU291cmNlKTsKICAgICAgb3JpZ2luYWwubWFwLmRlbGV0ZS5jYWxsKG9iamVjdFVSTE1hcCwgbWVkaWFTb3VyY2VJbmZvLm1lZGlhU291cmNlKTsKICAgIH0KCiAgICBtZWRpYVNvdXJjZU1hcC5mb3JFYWNoKChtZWRpYVNvdXJjZUluZm8pID0+IHsKICAgICAgaWYgKCFtZWRpYVNvdXJjZUluZm8ubWVkaWFFbGVtZW50IHx8ICEobWVkaWFTb3VyY2VJbmZvLm1lZGlhRWxlbWVudCBpbnN0YW5jZW9mIEhUTUxNZWRpYUVsZW1lbnQpKSB7CiAgICAgICAgcmVtb3ZlTWVkaWFTb3VyY2VEYXRhKG1lZGlhU291cmNlSW5mbyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKGlzT3V0T2ZEb2N1bWVudChtZWRpYVNvdXJjZUluZm8ubWVkaWFFbGVtZW50KSkgewogICAgICAgICAgcmVtb3ZlTWVkaWFTb3VyY2VEYXRhKG1lZGlhU291cmNlSW5mbyk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICB9CgogIGZ1bmN0aW9uIHByb3h5TWVkaWFTb3VyY2VNZXRob2QgKCkgewogICAgaWYgKCFvcmlnaW5NZXRob2RzLmFkZFNvdXJjZUJ1ZmZlciB8fCAhb3JpZ2luTWV0aG9kcy5lbmRPZlN0cmVhbSkgewogICAgICByZXR1cm4gZmFsc2UKICAgIH0KCiAgICAvLyBUT0RPIOivpeS7o+eQhuWcqOS4iuWxguiwg+eUqOeUn+aViOWPr+iDveWtmOWcqOW7tui/n++8jOWOn+WboOW+heeglOeptgogICAgb3JpZ2luVVJMTWV0aG9kcy5jcmVhdGVPYmplY3RVUkwgPSBvcmlnaW5VUkxNZXRob2RzLmNyZWF0ZU9iamVjdFVSTCB8fCBVUkwucHJvdG90eXBlLmNvbnN0cnVjdG9yLmNyZWF0ZU9iamVjdFVSTDsKICAgIFVSTC5wcm90b3R5cGUuY29uc3RydWN0b3IuY3JlYXRlT2JqZWN0VVJMID0gbmV3IG9yaWdpbmFsLlByb3h5KG9yaWdpblVSTE1ldGhvZHMuY3JlYXRlT2JqZWN0VVJMLCB7CiAgICAgIGFwcGx5ICh0YXJnZXQsIGN0eCwgYXJncykgewogICAgICAgIGNvbnN0IG9iamVjdCA9IGFyZ3NbMF07CiAgICAgICAgY29uc3Qgb2JqZWN0VVJMID0gdGFyZ2V0LmFwcGx5KGN0eCwgYXJncyk7CgogICAgICAgIGlmIChvYmplY3QgaW5zdGFuY2VvZiBNZWRpYVNvdXJjZSAmJiAhb3JpZ2luYWwubWFwLmhhcy5jYWxsKG9iamVjdFVSTE1hcCwgb2JqZWN0KSkgewogICAgICAgICAgb2JqZWN0Ll9fb2JqVVJMX18gPSBvYmplY3RVUkw7CiAgICAgICAgICBvcmlnaW5hbC5tYXAuc2V0LmNhbGwob2JqZWN0VVJMTWFwLCBvYmplY3QsIG9iamVjdFVSTCk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gb2JqZWN0VVJMCiAgICAgIH0KICAgIH0pOwoKICAgIE1lZGlhU291cmNlLnByb3RvdHlwZS5hZGRTb3VyY2VCdWZmZXIgPSBuZXcgb3JpZ2luYWwuUHJveHkob3JpZ2luTWV0aG9kcy5hZGRTb3VyY2VCdWZmZXIsIHsKICAgICAgYXBwbHkgKHRhcmdldCwgY3R4LCBhcmdzKSB7CiAgICAgICAgaWYgKCFvcmlnaW5hbC5tYXAuaGFzLmNhbGwobWVkaWFTb3VyY2VNYXAsIGN0eCkpIHsKICAgICAgICAgIG9yaWdpbmFsLm1hcC5zZXQuY2FsbChtZWRpYVNvdXJjZU1hcCwgY3R4LCB7CiAgICAgICAgICAgIG1lZGlhU291cmNlOiBjdHgsCiAgICAgICAgICAgIGNyZWF0ZVRpbWU6IERhdGUubm93KCksCiAgICAgICAgICAgIHNvdXJjZUJ1ZmZlcjogW10sCiAgICAgICAgICAgIGVuZE9mU3RyZWFtOiBmYWxzZQogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBtZWRpYVNvdXJjZUluZm8gPSBvcmlnaW5hbC5tYXAuZ2V0LmNhbGwobWVkaWFTb3VyY2VNYXAsIGN0eCk7CiAgICAgICAgY29uc3QgbWltZUNvZGVjcyA9IGFyZ3NbMF0gfHwgJyc7CiAgICAgICAgY29uc3Qgc291cmNlQnVmZmVyID0gdGFyZ2V0LmFwcGx5KGN0eCwgYXJncyk7CgogICAgICAgIGNvbnN0IHNvdXJjZUJ1ZmZlckl0ZW0gPSB7CiAgICAgICAgICBtaW1lQ29kZWNzLAogICAgICAgICAgb3JpZ2luQXBwZW5kQnVmZmVyOiBzb3VyY2VCdWZmZXIuYXBwZW5kQnVmZmVyLAogICAgICAgICAgYnVmZmVyRGF0YTogW10sCiAgICAgICAgICBtZWRpYUluZm86IHt9CiAgICAgICAgfTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIC8vIG1pbWVDb2RlY3PlrZfnrKbkuLLnpLrkvovvvJondmlkZW8vbXA0OyBjb2RlY3M9ImF2YzEuNDJFMDFFLCBtcDRhLjQwLjIiJwogICAgICAgICAgY29uc3QgbWVkaWFJbmZvID0gc291cmNlQnVmZmVySXRlbS5tZWRpYUluZm87CiAgICAgICAgICBjb25zdCB0bXBBcnIgPSBzb3VyY2VCdWZmZXJJdGVtLm1pbWVDb2RlY3Muc3BsaXQoJzsnKTsKCiAgICAgICAgICBtZWRpYUluZm8udHlwZSA9IHRtcEFyclswXS5zcGxpdCgnLycpWzBdOwogICAgICAgICAgbWVkaWFJbmZvLmZvcm1hdCA9IHRtcEFyclswXS5zcGxpdCgnLycpWzFdOwogICAgICAgICAgbWVkaWFJbmZvLmNvZGVjcyA9IHRtcEFyclsxXS50cmltKCkucmVwbGFjZSgnY29kZWNzPScsICcnKS5yZXBsYWNlKC9bIiddL2csICcnKTsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICBvcmlnaW5hbC5jb25zb2xlLmVycm9yKCdbYWRkU291cmNlQnVmZmVyXVttZWRpYUluZm9dIOWqkuS9k+S/oeaBr+ino+aekOWHuumUmScsIHNvdXJjZUJ1ZmZlckl0ZW0sIGUpOwogICAgICAgIH0KCiAgICAgICAgbWVkaWFTb3VyY2VJbmZvLnNvdXJjZUJ1ZmZlci5wdXNoKHNvdXJjZUJ1ZmZlckl0ZW0pOwoKICAgICAgICAvKiDku6PnkIZzb3VyY2VCdWZmZXIuYXBwZW5kQnVmZmVy5Ye95pWw77yM5bm25bCGYnVmZmVy5a2Y5LiA5Lu95YiwbWVkaWFTb3VyY2VJbmZv6YeMICovCiAgICAgICAgc291cmNlQnVmZmVyLmFwcGVuZEJ1ZmZlciA9IG5ldyBvcmlnaW5hbC5Qcm94eShzb3VyY2VCdWZmZXJJdGVtLm9yaWdpbkFwcGVuZEJ1ZmZlciwgewogICAgICAgICAgYXBwbHkgKGJ1ZlRhcmdldCwgYnVmQ3R4LCBidWZBcmdzKSB7CiAgICAgICAgICAgIGNvbnN0IGJ1ZmZlciA9IGJ1ZkFyZ3NbMF07CgogICAgICAgICAgICBpZiAoIW1lZGlhU291cmNlSW5mby5lbmRPZlN0cmVhbSkgewogICAgICAgICAgICAgIHNvdXJjZUJ1ZmZlckl0ZW0uYnVmZmVyRGF0YS5wdXNoKGJ1ZmZlcik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8qIOehruS/nW1lZGlhVXJs55qE5a2Y5Zyo5ZKM5a+55bqUICovCiAgICAgICAgICAgIGlmIChvcmlnaW5hbC5tYXAuZ2V0LmNhbGwob2JqZWN0VVJMTWFwLCBjdHgpKSB7CiAgICAgICAgICAgICAgbWVkaWFTb3VyY2VJbmZvLm1lZGlhVXJsID0gb3JpZ2luYWwubWFwLmdldC5jYWxsKG9iamVjdFVSTE1hcCwgY3R4KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLyog5aaC5p6cYXBwZW5kQnVmZmVy5L6d54S25rS76LeD77yM5L2G5a+55bqU55qEbWVkaWFTb3VyY2XljbTooqvmuIXnkIbkuobvvIzliJnlsJ3or5Xph43mlrDlsIbmlbDmja7lhbPogZTlm57ljrsgKi8KICAgICAgICAgICAgaWYgKCFvcmlnaW5hbC5tYXAuZ2V0LmNhbGwobWVkaWFTb3VyY2VNYXAsIGN0eCkpIHsKICAgICAgICAgICAgICBvcmlnaW5hbC5tYXAuc2V0LmNhbGwobWVkaWFTb3VyY2VNYXAsIGN0eCwgbWVkaWFTb3VyY2VJbmZvKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIGJ1ZlRhcmdldC5hcHBseShidWZDdHgsIGJ1ZkFyZ3MpCiAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIHJldHVybiBzb3VyY2VCdWZmZXIKICAgICAgfQogICAgfSk7CgogICAgTWVkaWFTb3VyY2UucHJvdG90eXBlLmVuZE9mU3RyZWFtID0gbmV3IG9yaWdpbmFsLlByb3h5KG9yaWdpbk1ldGhvZHMuZW5kT2ZTdHJlYW0sIHsKICAgICAgYXBwbHkgKHRhcmdldCwgY3R4LCBhcmdzKSB7CiAgICAgICAgLyog5qCH6K+G5b2T5YmN5aqS5L2T5rWB5bey5Yqg6L295a6M5oiQICovCiAgICAgICAgY29uc3QgbWVkaWFTb3VyY2VJbmZvID0gb3JpZ2luYWwubWFwLmdldC5jYWxsKG1lZGlhU291cmNlTWFwLCBjdHgpOwogICAgICAgIGlmIChtZWRpYVNvdXJjZUluZm8pIHsKICAgICAgICAgIG1lZGlhU291cmNlSW5mby5lbmRPZlN0cmVhbSA9IHRydWU7CgogICAgICAgICAgaWYgKG1lZGlhU291cmNlSW5mby5tZWRpYUVsZW1lbnQgJiYgbWVkaWFTb3VyY2VJbmZvLmF1dG9Eb3dubG9hZCAmJiAhbWVkaWFTb3VyY2VJbmZvLmhhc0Rvd25sb2FkKSB7CiAgICAgICAgICAgIGRvd25sb2FkTWVkaWFTb3VyY2UobWVkaWFTb3VyY2VJbmZvLm1lZGlhRWxlbWVudCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdGFyZ2V0LmFwcGx5KGN0eCwgYXJncykKICAgICAgfQogICAgfSk7CiAgfQoKICAvKioKICAgKiDkuIvovb3lqpLkvZPotYTmupDvvIzkuIvovb3ku6PnoIHlj4LogIPvvJpodHRwczovL2p1ZWppbi5jbi9wb3N0LzY4NzMyNjcwNzM2NzQzNzkyNzcKICAgKi8KICBmdW5jdGlvbiBkb3dubG9hZE1lZGlhU291cmNlIChtZWRpYUVsLCB0aXRsZSkgewogICAgLy8gY29uc3Qgc3JjTGlzdCA9IG1lZGlhRWwuc3JjTGlzdCB8fCBbXQogICAgY29uc3QgY3VyU3JjID0gbWVkaWFFbC5jdXJyZW50U3JjIHx8IG1lZGlhRWwuc3JjOwoKICAgIGlmICghY3VyU3JjKSB7CiAgICAgIG9yaWdpbmFsLmFsZXJ0KGkxOG4udCgnbWVkaWFEb3dubG9hZC5ub3RTdXBwb3J0JykpOwogICAgICByZXR1cm4gZmFsc2UKICAgIH0KCiAgICBsZXQgaGFzRmluZE1lZGlhU291cmNlID0gZmFsc2U7CiAgICBtZWRpYVNvdXJjZU1hcC5mb3JFYWNoKG1lZGlhU291cmNlSW5mbyA9PiB7CiAgICAgIGNvbnN0IG1lZGlhU291cmNlID0gbWVkaWFTb3VyY2VJbmZvLm1lZGlhU291cmNlOwogICAgICBpZiAoIW1lZGlhU291cmNlLl9fb2JqVVJMX18pIHsKICAgICAgICBjb25zb2xlLmVycm9yKCdubyBvYmpVUkwnLCBtZWRpYVNvdXJjZSwgbWVkaWFTb3VyY2VJbmZvKTsKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfQoKICAgICAgLyog5o6S6Zmk6Z2e5b2T5YmN5aqS5L2T5YWD57Sg55qE5aqS5L2T5rWBICovCiAgICAgIC8vIGlmIChzcmNMaXN0Lmxlbmd0aCA+IDAgJiYgIXNyY0xpc3QuaW5jbHVkZXMobWVkaWFTb3VyY2UuX19vYmpVUkxfXykpIHsKICAgICAgLy8gICByZXR1cm4gZmFsc2UKICAgICAgLy8gfQogICAgICBpZiAoY3VyU3JjICE9PSBtZWRpYVNvdXJjZS5fX29ialVSTF9fKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KCiAgICAgIGhhc0ZpbmRNZWRpYVNvdXJjZSA9IHRydWU7CiAgICAgIG1lZGlhU291cmNlSW5mby5tZWRpYUVsZW1lbnQgPSBtZWRpYUVsOwoKICAgICAgLy8gb3JpZ2luYWwuY29uc29sZS5sb2coJ1tkb3dubG9hZE1lZGlhU291cmNlXVttZWRpYVNvdXJjZUluZm9dJywgbWVkaWFTb3VyY2VJbmZvKQoKICAgICAgaWYgKG1lZGlhU291cmNlSW5mby5oYXNEb3dubG9hZCkgewogICAgICAgIGNvbnN0IGNvbmZpcm0gPSBvcmlnaW5hbC5jb25maXJtKGkxOG4udCgnbWVkaWFEb3dubG9hZC5oYXNEb3dubG9hZCcpKTsKICAgICAgICBpZiAoIWNvbmZpcm0pIHsKICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKCFtZWRpYVNvdXJjZUluZm8uaGFzRG93bmxvYWQgJiYgIW1lZGlhU291cmNlSW5mby5lbmRPZlN0cmVhbSkgewogICAgICAgIC8vIG9yaWdpbmFsLmNvbnNvbGUubG9nKCdbZG93bmxvYWRNZWRpYVNvdXJjZV0g5aqS5L2T5pWw5o2u6L+Y5rKh5a6M5YWo5bCx57uqJywgbWVkaWFTb3VyY2VJbmZvKQoKICAgICAgICBjb25zdCBjb25maXJtID0gb3JpZ2luYWwuY29uZmlybShpMThuLnQoJ21lZGlhRG93bmxvYWQubm90RW5kT2ZTdHJlYW0nKSk7CiAgICAgICAgaWYgKCFjb25maXJtKSB7CiAgICAgICAgICBpZiAobWVkaWFTb3VyY2VJbmZvLmF1dG9Eb3dubG9hZCkgewogICAgICAgICAgICBjb25zdCBjYW5jZWxBdXRvRG93bmxvYWQgPSBvcmlnaW5hbC5jb25maXJtKGkxOG4udCgnbWVkaWFEb3dubG9hZC5jYW5jZWxBdXRvRG93bmxvYWQnKSk7CiAgICAgICAgICAgIGlmIChjYW5jZWxBdXRvRG93bmxvYWQpIHsKICAgICAgICAgICAgICBtZWRpYVNvdXJjZUluZm8uYXV0b0Rvd25sb2FkID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IGF1dG9Eb3dubG9hZCA9IG9yaWdpbmFsLmNvbmZpcm0oaTE4bi50KCdtZWRpYURvd25sb2FkLmF1dG9Eb3dubG9hZCcpKTsKICAgICAgICAgICAgaWYgKGF1dG9Eb3dubG9hZCkgewogICAgICAgICAgICAgIG1lZGlhU291cmNlSW5mby5hdXRvRG93bmxvYWQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgfQogICAgICB9CgogICAgICBsZXQgbWVkaWFTb3VyY2VUaXRsZSA9IG51bGw7CiAgICAgIG1lZGlhU291cmNlSW5mby5zb3VyY2VCdWZmZXIuZm9yRWFjaChzb3VyY2VCdWZmZXJJdGVtID0+IHsKICAgICAgICBpZiAoIXNvdXJjZUJ1ZmZlckl0ZW0ubWltZUNvZGVjcyB8fCBzb3VyY2VCdWZmZXJJdGVtLm1pbWVDb2RlY3MudG9TdHJpbmcoKS5pbmRleE9mKCc7JykgPT09IC0xKSB7CiAgICAgICAgICBjb25zdCBtc2cgPSAnW2Rvd25sb2FkTWVkaWFTb3VyY2VdW21pbWVDb2RlY3NdW2Vycm9yXSBtaW1lQ29kZWNz5LiN5a2Y5Zyo5oiW5L+h5oGv5byC5bi477yM5peg5rOV5LiL6L29JzsKICAgICAgICAgIG9yaWdpbmFsLmNvbnNvbGUuZXJyb3IobXNnLCBzb3VyY2VCdWZmZXJJdGVtKTsKICAgICAgICAgIG9yaWdpbmFsLmFsZXJ0KG1zZyk7CiAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICB9CgogICAgICAgIHRyeSB7CiAgICAgICAgICBsZXQgbWVkaWFUaXRsZSA9IGAke21lZGlhU291cmNlVGl0bGUgfHwgc291cmNlQnVmZmVySXRlbS5tZWRpYUluZm8udGl0bGUgfHwgdGl0bGUgfHwgbWVkaWFFbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGl0bGUnKSB8fCBkb2N1bWVudC50aXRsZSB8fCBEYXRlLm5vdygpfWA7CgogICAgICAgICAgaWYgKCFtZWRpYVNvdXJjZVRpdGxlICYmICFzb3VyY2VCdWZmZXJJdGVtLm1lZGlhSW5mby50aXRsZSkgewogICAgICAgICAgICBtZWRpYVRpdGxlID0gb3JpZ2luYWwucHJvbXB0KGkxOG4udCgnbWVkaWFEb3dubG9hZC5jb25maXJtVGl0bGUnKSwgbWVkaWFUaXRsZSk7CgogICAgICAgICAgICBpZiAoIW1lZGlhVGl0bGUpIHsgcmV0dXJuIGZhbHNlIH0KCiAgICAgICAgICAgIHNvdXJjZUJ1ZmZlckl0ZW0ubWVkaWFJbmZvLnRpdGxlID0gbWVkaWFUaXRsZTsKICAgICAgICAgIH0KCiAgICAgICAgICBtZWRpYVNvdXJjZVRpdGxlID0gbWVkaWFUaXRsZTsKCiAgICAgICAgICAvKiDoh6rliqjooaXlhYXlqpLkvZPnsbvlnovlkozmlofku7blkI7nvIAgKi8KICAgICAgICAgIG1lZGlhVGl0bGUgPSBgJHttZWRpYVRpdGxlfV8ke3NvdXJjZUJ1ZmZlckl0ZW0ubWVkaWFJbmZvLnR5cGV9LiR7c291cmNlQnVmZmVySXRlbS5tZWRpYUluZm8uZm9ybWF0fWA7CgogICAgICAgICAgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgICAgIGNvbnN0IGJsb2JVcmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKG5ldyBCbG9iKHNvdXJjZUJ1ZmZlckl0ZW0uYnVmZmVyRGF0YSkpOwogICAgICAgICAgYS5ocmVmID0gYmxvYlVybDsKICAgICAgICAgIGEuZG93bmxvYWQgPSBtZWRpYVRpdGxlOwoKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGEuY2xpY2soKTsKICAgICAgICAgICAgbWVkaWFTb3VyY2VJbmZvLmhhc0Rvd25sb2FkID0gdHJ1ZTsKICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIC8qIOehruS/neaXoOiuuuS4i+i9veaYr+WQpuaIkOWKn+mDvemHiuaUvmJsb2IgVVJMICovCiAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwoYmxvYlVybCk7CiAgICAgICAgICAgIC8qIOS4i+i9veWujOaIkOWQjua4heepumJ1ZmZlcuaVsOaNriAqLwogICAgICAgICAgICBzb3VyY2VCdWZmZXJJdGVtLmJ1ZmZlckRhdGEgPSBbXTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICBtZWRpYVNvdXJjZUluZm8uaGFzRG93bmxvYWQgPSBmYWxzZTsKICAgICAgICAgIGNvbnN0IG1zZyA9ICdbZG93bmxvYWRNZWRpYVNvdXJjZV1bZXJyb3JdJzsKICAgICAgICAgIG9yaWdpbmFsLmNvbnNvbGUuZXJyb3IobXNnLCBlKTsKICAgICAgICAgIG9yaWdpbmFsLmFsZXJ0KG1zZyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwoKICAgIGlmICghaGFzRmluZE1lZGlhU291cmNlKSB7CiAgICAgIG9yaWdpbmFsLmFsZXJ0KGkxOG4udCgnbWVkaWFEb3dubG9hZC5ub3RGb3VuZE1lZGlhU291cmNlJykpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gaGFzSW5pdCAoKSB7CiAgICByZXR1cm4gaGFzTWVkaWFTb3VyY2VJbml0CiAgfQoKICBmdW5jdGlvbiBpbml0ICgpIHsKICAgIGlmIChoYXNNZWRpYVNvdXJjZUluaXQpIHsKICAgICAgcmV0dXJuIGZhbHNlCiAgICB9CgogICAgaWYgKCF3aW5kb3cuTWVkaWFTb3VyY2UpIHsKICAgICAgcmV0dXJuIGZhbHNlCiAgICB9CgogICAgT2JqZWN0LmtleXMoTWVkaWFTb3VyY2UucHJvdG90eXBlKS5mb3JFYWNoKGtleSA9PiB7CiAgICAgIHRyeSB7CiAgICAgICAgaWYgKE1lZGlhU291cmNlLnByb3RvdHlwZVtrZXldIGluc3RhbmNlb2YgRnVuY3Rpb24pIHsKICAgICAgICAgIG9yaWdpbk1ldGhvZHNba2V5XSA9IE1lZGlhU291cmNlLnByb3RvdHlwZVtrZXldOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZSkgeyB9CiAgICB9KTsKCiAgICBwcm94eU1lZGlhU291cmNlTWV0aG9kKCk7CgogICAgaGFzTWVkaWFTb3VyY2VJbml0ID0gdHJ1ZTsKICB9CgogIHJldHVybiB7CiAgICBpbml0LAogICAgaGFzSW5pdCwKICAgIG9yaWdpbk1ldGhvZHMsCiAgICBvcmlnaW5VUkxNZXRob2RzLAogICAgbWVkaWFTb3VyY2VNYXAsCiAgICBvYmplY3RVUkxNYXAsCiAgICBkb3dubG9hZE1lZGlhU291cmNlLAogICAgY2xlYW5NZWRpYVNvdXJjZURhdGEsCiAgICBjb25uZWN0TWVkaWFTb3VyY2VXaXRoTWVkaWFFbGVtZW50CiAgfQp9KSgpOwoKLyohCiAqIEBuYW1lICAgICAgICAgaG90a2V5c1J1bm5lci5qcwogKiBAZGVzY3JpcHRpb24gIOeDremUrui/kOihjOWZqO+8jOWunueOsOexu+S8vHZzY29kZeeahOeDremUrumFjee9ruaWueW8jwogKiBAdmVyc2lvbiAgICAgIDAuMC4xCiAqIEBhdXRob3IgICAgICAgeHh4aWx5CiAqIEBkYXRlICAgICAgICAgMjAyMi8xMS8yMyAxODoyMgogKiBAZ2l0aHViICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS94eHhpbHkKICovCgpjb25zdCBNYXAkMSA9IHdpbmRvdy5NYXA7CmNvbnN0IFdlYWtNYXAkMSA9IHdpbmRvdy5XZWFrTWFwOwpmdW5jdGlvbiBpc09iaiAob2JqKSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSA9PT0gJ1tvYmplY3QgT2JqZWN0XScgfQoKZnVuY3Rpb24gZ2V0VmFsQnlQYXRoIChvYmosIHBhdGgpIHsKICBwYXRoID0gcGF0aCB8fCAnJzsKICBjb25zdCBwYXRoQXJyID0gcGF0aC5zcGxpdCgnLicpOwogIGxldCByZXN1bHQgPSBvYmo7CgogIC8qIOmAkuW9kuaPkOWPlue7k+aenOWAvCAqLwogIGZvciAobGV0IGkgPSAwOyBpIDwgcGF0aEFyci5sZW5ndGg7IGkrKykgewogICAgaWYgKCFyZXN1bHQpIGJyZWFrCiAgICByZXN1bHQgPSByZXN1bHRbcGF0aEFycltpXV07CiAgfQoKICByZXR1cm4gcmVzdWx0Cn0KCmZ1bmN0aW9uIHRvQXJyQXJncyAoYXJncykgewogIHJldHVybiBBcnJheS5pc0FycmF5KGFyZ3MpID8gYXJncyA6ICh0eXBlb2YgYXJncyA9PT0gJ3VuZGVmaW5lZCcgPyBbXSA6IFthcmdzXSkKfQoKZnVuY3Rpb24gaXNNb2RpZmllcktleSAoa2V5KSB7CiAgcmV0dXJuIFsKICAgICdjdHJsJywgJ2NvbnRyb2xsZWZ0JywgJ2NvbnRyb2xyaWdodCcsCiAgICAnc2hpZnQnLCAnc2hpZnRsZWZ0JywgJ3NoaWZ0cmlnaHQnLAogICAgJ2FsdCcsICdhbHRsZWZ0JywgJ2FsdHJpZ2h0JywKICAgICdtZXRhJywgJ21ldGFsZWZ0JywgJ21ldGFyaWdodCcsCiAgICAnY2Fwc0xvY2snXS5pbmNsdWRlcyhrZXkudG9Mb3dlckNhc2UoKSkKfQoKY29uc3Qga2V5QWxpYXMgPSB7CiAgQ29udHJvbExlZnQ6ICdjdHJsJywKICBDb250cm9sUmlnaHQ6ICdjdHJsJywKICBTaGlmdExlZnQ6ICdzaGlmdCcsCiAgU2hpZnRSaWdodDogJ3NoaWZ0JywKICBBbHRMZWZ0OiAnYWx0JywKICBBbHRSaWdodDogJ2FsdCcsCiAgTWV0YUxlZnQ6ICdtZXRhJywKICBNZXRhUmlnaHQ6ICdtZXRhJwp9OwoKY29uc3QgY29tYmluYXRpb25LZXlzTW9uaXRvciA9IChmdW5jdGlvbiAoKSB7CiAgY29uc3QgY29tYmluYXRpb25LZXlzU3RhdGUgPSBuZXcgTWFwJDEoKTsKCiAgY29uc3QgaGFzSW5pdCA9IG5ldyBXZWFrTWFwJDEoKTsKCiAgZnVuY3Rpb24gaW5pdCAod2luID0gd2luZG93KSB7CiAgICBpZiAoIXdpbiB8fCB3aW4gIT09IHdpbi5zZWxmIHx8ICF3aW4uYWRkRXZlbnRMaXN0ZW5lciB8fCBoYXNJbml0LmdldCh3aW4pKSB7CiAgICAgIHJldHVybiBmYWxzZQogICAgfQoKICAgIGNvbnN0IHRpbWVycyA9IHt9OwoKICAgIGZ1bmN0aW9uIGFjdGl2ZUNvbWJpbmF0aW9uS2V5c1N0YXRlIChldmVudCkgewogICAgICBpc01vZGlmaWVyS2V5KGV2ZW50LmNvZGUpICYmIGNvbWJpbmF0aW9uS2V5c1N0YXRlLnNldChldmVudC5jb2RlLCB0cnVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBpbmFjdGl2YXRlQ29tYmluYXRpb25LZXlzU3RhdGUgKGV2ZW50KSB7CiAgICAgIGlmICghKGV2ZW50IGluc3RhbmNlb2YgS2V5Ym9hcmRFdmVudCkpIHsKICAgICAgICBjb21iaW5hdGlvbktleXNTdGF0ZS5mb3JFYWNoKCh2YWwsIGtleSkgPT4gewogICAgICAgICAgY29tYmluYXRpb25LZXlzU3RhdGUuc2V0KGtleSwgZmFsc2UpOwogICAgICAgIH0pOwogICAgICAgIHJldHVybiB0cnVlCiAgICAgIH0KCiAgICAgIC8qKgogICAgICAgKiBjb21iaW5hdGlvbktleXNTdGF0ZeeKtuaAgeW/hemhu+S/neeVmeS4gOauteaXtumXtO+8jOWQpuWImeW9k+WklumDqOWumuS5ieeahOaYr2tleXVw5LqL5Lu25pe25YCZ77yM55Sx5LqO6L+Z5Liq5YWI5rOo5YaM5Lmf5YWI5omn6KGM77yMCiAgICAgICAqIOmprOS4iuabtOaUuWNvbWJpbmF0aW9uS2V5c1N0YXRl54q25oCB77yM5Lya5a+86Ie05ZCO6Z2i5a6a5LmJ55qE5LqL5Lu25ou/5Yiw55qE5piv5pyq5r+A5rS757uE5ZCI6ZSu55qE54q25oCBCiAgICAgICAqLwogICAgICBpZiAoaXNNb2RpZmllcktleShldmVudC5jb2RlKSkgewogICAgICAgIGNsZWFyVGltZW91dCh0aW1lcnNbZXZlbnQuY29kZV0pOwogICAgICAgIHRpbWVyc1tldmVudC5jb2RlXSA9IHNldFRpbWVvdXQoKCkgPT4geyBjb21iaW5hdGlvbktleXNTdGF0ZS5zZXQoZXZlbnQuY29kZSwgZmFsc2UpOyB9LCA1MCk7CiAgICAgIH0KICAgIH0KCiAgICB3aW4uYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGFjdGl2ZUNvbWJpbmF0aW9uS2V5c1N0YXRlLCB0cnVlKTsKICAgIHdpbi5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIGFjdGl2ZUNvbWJpbmF0aW9uS2V5c1N0YXRlLCB0cnVlKTsKICAgIHdpbi5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGluYWN0aXZhdGVDb21iaW5hdGlvbktleXNTdGF0ZSwgdHJ1ZSk7CiAgICB3aW4uYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIGluYWN0aXZhdGVDb21iaW5hdGlvbktleXNTdGF0ZSwgdHJ1ZSk7CgogICAgaGFzSW5pdC5zZXQod2luLCB0cnVlKTsKICB9CgogIGZ1bmN0aW9uIGdldENvbWJpbmF0aW9uS2V5cyAoKSB7CiAgICBjb25zdCByZXN1bHQgPSBuZXcgTWFwJDEoKTsKICAgIGNvbWJpbmF0aW9uS2V5c1N0YXRlLmZvckVhY2goKHZhbCwga2V5KSA9PiB7CiAgICAgIGlmICh2YWwgPT09IHRydWUpIHsKICAgICAgICByZXN1bHQuc2V0KGtleSwgdmFsKTsKICAgICAgfQogICAgfSk7CiAgICByZXR1cm4gcmVzdWx0CiAgfQoKICByZXR1cm4gewogICAgY29tYmluYXRpb25LZXlzU3RhdGUsCiAgICBnZXRDb21iaW5hdGlvbktleXMsCiAgICBpbml0CiAgfQp9KSgpOwoKY2xhc3MgSG90a2V5c1J1bm5lciB7CiAgY29uc3RydWN0b3IgKGhvdGtleXMsIHdpbiA9IHdpbmRvdykgewogICAgdGhpcy53aW5kb3cgPSB3aW47CiAgICB0aGlzLndpbmRvd0xpc3QgPSBbd2luXTsKICAgIC8qIE1hY+WSjHdpbmRvd+S9v+eUqOeahOS/rumlsOespuaYr+S4jeS4gOagt+eahCAqLwogICAgdGhpcy5NT0QgPSB0eXBlb2YgbmF2aWdhdG9yID09PSAnb2JqZWN0JyAmJiAvTWFjfGlQb2R8aVBob25lfGlQYWQvLnRlc3QobmF2aWdhdG9yLnBsYXRmb3JtKSA/ICdNZXRhJyA6ICdDdHJsJzsKICAgIC8vICdDb250cm9sJywgJ1NoaWZ0JywgJ0FsdCcsICdNZXRhJwoKICAgIHRoaXMucHJldlByZXNzID0gbnVsbDsKICAgIHRoaXMuX3ByZXZUaW1lcl8gPSBudWxsOwoKICAgIHRoaXMuc2V0SG90a2V5cyhob3RrZXlzKTsKICAgIGNvbWJpbmF0aW9uS2V5c01vbml0b3IuaW5pdCh3aW4pOwogIH0KCiAgLyog6K6+572u5YW25a6Dd2luZG935a+56LGh55qE57uE5ZCI6ZSu55uR5o6n6YC76L6RICovCiAgc2V0Q29tYmluYXRpb25LZXlzTW9uaXRvciAod2luKSB7CiAgICB0aGlzLndpbmRvdyA9IHdpbjsKCiAgICBpZiAoIXRoaXMud2luZG93TGlzdC5pbmNsdWRlcyh3aW4pKSB7CiAgICAgIHRoaXMud2luZG93TGlzdC5wdXNoKHdpbik7CiAgICB9CgogICAgY29tYmluYXRpb25LZXlzTW9uaXRvci5pbml0KHdpbik7CiAgfQoKICAvKiDmlbDmja7pooTlpITnkIYgKi8KICBob3RrZXlzUHJlcHJvY2VzcyAoaG90a2V5cykgewogICAgaWYgKCFBcnJheS5pc0FycmF5KGhvdGtleXMpKSB7CiAgICAgIHJldHVybiBmYWxzZQogICAgfQoKICAgIGhvdGtleXMuZm9yRWFjaCgoY29uZmlnKSA9PiB7CiAgICAgIGlmICghaXNPYmooY29uZmlnKSB8fCAhY29uZmlnLmtleSB8fCB0eXBlb2YgY29uZmlnLmtleSAhPT0gJ3N0cmluZycpIHsKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfQoKICAgICAgY29uc3Qga2V5TmFtZSA9IGNvbmZpZy5rZXkudHJpbSgpLnRvTG93ZXJDYXNlKCk7CiAgICAgIGNvbnN0IG1vZCA9IHRoaXMuTU9ELnRvTG93ZXJDYXNlKCk7CgogICAgICAvKiDlop7liqDmoLzlvI/ljJblkI7nmoRob3RrZXlz5pWw57uEICovCiAgICAgIGNvbmZpZy5rZXlCaW5kaW5ncyA9IGtleU5hbWUuc3BsaXQoJyAnKS5tYXAocHJlc3MgPT4gewogICAgICAgIGNvbnN0IGtleXMgPSBwcmVzcy5zcGxpdCgvXGJcKy8pOwogICAgICAgIGNvbnN0IG1vZHMgPSBbXTsKICAgICAgICBsZXQga2V5ID0gJyc7CgogICAgICAgIGtleXMuZm9yRWFjaCgoaykgPT4gewogICAgICAgICAgayA9IGsgPT09ICckbW9kJyA/IG1vZCA6IGs7CgogICAgICAgICAgaWYgKGlzTW9kaWZpZXJLZXkoaykpIHsKICAgICAgICAgICAgbW9kcy5wdXNoKGspOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAga2V5ID0gazsKICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgcmV0dXJuIFttb2RzLCBrZXldCiAgICAgIH0pOwogICAgfSk7CgogICAgcmV0dXJuIGhvdGtleXMKICB9CgogIHNldEhvdGtleXMgKGhvdGtleXMpIHsKICAgIHRoaXMuaG90a2V5cyA9IHRoaXMuaG90a2V5c1ByZXByb2Nlc3MoaG90a2V5cykgfHwgW107CiAgfQoKICAvKioKICAgKiDliKTmlq3lvZPliY3mj5DkvpvnmoTplK7nm5jkuovku7blkozpooTmnJ/nmoTng63plK7phY3nva7mmK/lkKbljLnphY0KICAgKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGV2ZW50CiAgICogQHBhcmFtIHtBcnJheX0gcHJlc3Mg5L6L5aaC77yaW1snYWx0JywgJ3NoaWZ0J10sICdzJ10KICAgKiBAcGFyYW0ge09iamVjdH0gcHJldkNvbWJpbmF0aW9uS2V5cwogICAqIEByZXR1cm5zCiAgICovCiAgaXNNYXRjaCAoZXZlbnQsIHByZXNzKSB7CiAgICBpZiAoIWV2ZW50IHx8ICFBcnJheS5pc0FycmF5KHByZXNzKSkgeyByZXR1cm4gZmFsc2UgfQoKICAgIGNvbnN0IGNvbWJpbmF0aW9uS2V5cyA9IGV2ZW50LmNvbWJpbmF0aW9uS2V5cyB8fCBjb21iaW5hdGlvbktleXNNb25pdG9yLmdldENvbWJpbmF0aW9uS2V5cygpOwogICAgY29uc3QgbW9kcyA9IHByZXNzWzBdOwogICAgY29uc3Qga2V5ID0gcHJlc3NbMV07CgogICAgLyog5L+u6aWw56ym5Liq5pWw5LiN5Yy56YWNICovCiAgICBpZiAobW9kcy5sZW5ndGggIT09IGNvbWJpbmF0aW9uS2V5cy5zaXplKSB7CiAgICAgIHJldHVybiBmYWxzZQogICAgfQoKICAgIC8qIOW9k+WJjeaMieS4i+eahOmUruS9jeWSjOmihOacn+eahOmUruS9jeS4jeWMuemFjSAqLwogICAgaWYgKGtleSAmJiBldmVudC5rZXkudG9Mb3dlckNhc2UoKSAhPT0ga2V5ICYmIGV2ZW50LmNvZGUudG9Mb3dlckNhc2UoKSAhPT0ga2V5KSB7CiAgICAgIHJldHVybiBmYWxzZQogICAgfQoKICAgIC8qIOW9k+WJjeaMieS4i+eahOS/rumlsOespuWSjOmihOacn+eahOS/rumlsOespuS4jeWMuemFjSAqLwogICAgbGV0IHJlc3VsdCA9IHRydWU7CiAgICBjb25zdCBtb2RzS2V5ID0gbmV3IE1hcCQxKCk7CiAgICBjb21iaW5hdGlvbktleXMuZm9yRWFjaCgodmFsLCBrZXkpID0+IHsKICAgICAgLyog6KGl5YWF5ZCE56eN5Y+v6IO95oOF5Ya155qE5qCH6K+GICovCiAgICAgIG1vZHNLZXkuc2V0KGtleSwgdmFsKTsKICAgICAgbW9kc0tleS5zZXQoa2V5LnRvTG93ZXJDYXNlKCksIHZhbCk7CiAgICAgIGtleUFsaWFzW2tleV0gJiYgbW9kc0tleS5zZXQoa2V5QWxpYXNba2V5XSwgdmFsKTsKICAgIH0pOwoKICAgIG1vZHMuZm9yRWFjaCgoa2V5KSA9PiB7CiAgICAgIGlmICghbW9kc0tleS5oYXMoa2V5KSkgewogICAgICAgIHJlc3VsdCA9IGZhbHNlOwogICAgICB9CiAgICB9KTsKCiAgICByZXR1cm4gcmVzdWx0CiAgfQoKICBpc01hdGNoUHJldlByZXNzIChwcmVzcykgeyByZXR1cm4gdGhpcy5pc01hdGNoKHRoaXMucHJldlByZXNzLCBwcmVzcykgfQoKICBydW4gKG9wdHMgPSB7fSkgewogICAgLy8g6L+Z6YeM5Y+q5a+55Y2V5Liqd2luZG935pyJ5pWICiAgICAvLyBjb25zdCBLZXlib2FyZEV2ZW50ID0gdGhpcy53aW5kb3cuS2V5Ym9hcmRFdmVudAogICAgLy8gaWYgKCEob3B0cy5ldmVudCBpbnN0YW5jZW9mIEtleWJvYXJkRXZlbnQpKSB7IHJldHVybiBmYWxzZSB9CgogICAgY29uc3QgS2V5Ym9hcmRFdmVudExpc3QgPSB0aGlzLndpbmRvd0xpc3QubWFwKHdpbiA9PiB3aW4uS2V5Ym9hcmRFdmVudCk7CiAgICBpZiAoIUtleWJvYXJkRXZlbnRMaXN0LmluY2x1ZGVzKG9wdHMuZXZlbnQuY29uc3RydWN0b3IpKSB7CiAgICAgIHJldHVybiBmYWxzZQogICAgfQoKICAgIGNvbnN0IGV2ZW50ID0gb3B0cy5ldmVudDsKICAgIGNvbnN0IHRhcmdldCA9IG9wdHMudGFyZ2V0IHx8IG51bGw7CiAgICBjb25zdCBjb25kaXRpb25IYW5kbGVyID0gb3B0cy5jb25kaXRpb25IYW5kbGVyIHx8IG9wdHMud2hlbkhhbmRsZXI7CgogICAgbGV0IG1hdGNoUmVzdWx0ID0gbnVsbDsKCiAgICB0aGlzLmhvdGtleXMuZm9yRWFjaChob3RrZXlDb25mID0+IHsKICAgICAgaWYgKGhvdGtleUNvbmYuZGlzYWJsZWQgfHwgIWhvdGtleUNvbmYua2V5QmluZGluZ3MpIHsKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfQoKICAgICAgbGV0IHByZXNzID0gaG90a2V5Q29uZi5rZXlCaW5kaW5nc1swXTsKCiAgICAgIC8qIOW9k+WtmOWcqHByZXZQcmVzc++8jOWImeS4jeWGjeWTjeW6lOS4jnByZXZQcmVzc+S4jeWMuemFjeeahOWFtuWug+W/q+aNt+mUriAqLwogICAgICBpZiAodGhpcy5wcmV2UHJlc3MgJiYgKGhvdGtleUNvbmYua2V5QmluZGluZ3MubGVuZ3RoIDw9IDEgfHwgIXRoaXMuaXNNYXRjaFByZXZQcmVzcyhwcmVzcykpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KCiAgICAgIC8qIOWmguaenOWtmOWcqOS4iuS4gOi9rueahOaTjeS9nOW/q+aNt+mUruiusOW9le+8jOS4lOS5i+WJjeeahOW/q+aNt+mUruS4juesrOS4gOS4qmtleUJpbmRpbmdz5a6a5LmJ55qE5b+r5o236ZSu5Yy56YWN77yM5YiZ5Y675Yy56YWN56ys5LqM5Liqa2V5QmluZGluZ3MgKi8KICAgICAgaWYgKHRoaXMucHJldlByZXNzICYmIGhvdGtleUNvbmYua2V5QmluZGluZ3MubGVuZ3RoID4gMSAmJiB0aGlzLmlzTWF0Y2hQcmV2UHJlc3MocHJlc3MpKSB7CiAgICAgICAgcHJlc3MgPSBob3RrZXlDb25mLmtleUJpbmRpbmdzWzFdOwogICAgICB9CgogICAgICBjb25zdCBpc01hdGNoID0gdGhpcy5pc01hdGNoKGV2ZW50LCBwcmVzcyk7CiAgICAgIGlmICghaXNNYXRjaCkgeyByZXR1cm4gZmFsc2UgfQoKICAgICAgbWF0Y2hSZXN1bHQgPSBob3RrZXlDb25mOwoKICAgICAgLyog5piv5ZCm6Zi75q2i5LqL5Lu25YaS5rOh5ZKM6Zi75q2i6buY6K6k5LqL5Lu2ICovCiAgICAgIGNvbnN0IHN0b3BQcm9wYWdhdGlvbiA9IG9wdHMuc3RvcFByb3BhZ2F0aW9uIHx8IGhvdGtleUNvbmYuc3RvcFByb3BhZ2F0aW9uOwogICAgICBjb25zdCBwcmV2ZW50RGVmYXVsdCA9IG9wdHMucHJldmVudERlZmF1bHQgfHwgaG90a2V5Q29uZi5wcmV2ZW50RGVmYXVsdDsKICAgICAgc3RvcFByb3BhZ2F0aW9uICYmIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICBwcmV2ZW50RGVmYXVsdCAmJiBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgLyog6K6w5b2V5LiK5LiA5qyh5pON5L2c55qE5b+r5o236ZSu77yM5LiU5LiA5q615pe26Ze05ZCO5riF56m66K+l5pON5L2c55qE6K6w5b2VICovCiAgICAgIGlmIChwcmVzcyA9PT0gaG90a2V5Q29uZi5rZXlCaW5kaW5nc1swXSAmJiBob3RrZXlDb25mLmtleUJpbmRpbmdzLmxlbmd0aCA+IDEpIHsKICAgICAgICAvKiDlsIZwcmV2UHJlc3Plj5jmiJDkuIDkuKrlhbfmnIlldmVudOebuOWFs+Wtl+auteeahOWvueixoSAqLwogICAgICAgIHRoaXMucHJldlByZXNzID0gewogICAgICAgICAgY29tYmluYXRpb25LZXlzOiBjb21iaW5hdGlvbktleXNNb25pdG9yLmdldENvbWJpbmF0aW9uS2V5cygpLAogICAgICAgICAgY29kZTogZXZlbnQuY29kZSwKICAgICAgICAgIGtleTogZXZlbnQua2V5LAogICAgICAgICAga2V5Q29kZTogZXZlbnQua2V5Q29kZSwKICAgICAgICAgIGFsdEtleTogZXZlbnQuYWx0S2V5LAogICAgICAgICAgc2hpZnRLZXk6IGV2ZW50LnNoaWZ0S2V5LAogICAgICAgICAgY3RybEtleTogZXZlbnQuY3RybEtleSwKICAgICAgICAgIG1ldGFLZXk6IGV2ZW50Lm1ldGFLZXkKICAgICAgICB9OwoKICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5fcHJldlRpbWVyXyk7CiAgICAgICAgdGhpcy5fcHJldlRpbWVyXyA9IHNldFRpbWVvdXQoKCkgPT4geyB0aGlzLnByZXZQcmVzcyA9IG51bGw7IH0sIDEwMDApOwoKICAgICAgICByZXR1cm4gdHJ1ZQogICAgICB9CgogICAgICAvKiDlpoLmnpzlvZPliY3ljLnphY3liLDkuobnrKzkuozkuKrlv6vmjbfplK7vvIzliJnlvZNmb3JFYWNo5b6q546v57uT5p2f5ZCO77yM6ams5LiK5rOo6ZSAcHJldlByZXNz77yM57uZ5YW25a6D5b+r5o236ZSu6K6p6KGMICovCiAgICAgIGlmIChob3RrZXlDb25mLmtleUJpbmRpbmdzLmxlbmd0aCA+IDEgJiYgcHJlc3MgIT09IGhvdGtleUNvbmYua2V5QmluZGluZ3NbMF0pIHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsgdGhpcy5wcmV2UHJlc3MgPSBudWxsOyB9LCAwKTsKICAgICAgfQoKICAgICAgLyog5omn6KGMaG90a2V5Q29uZi5jb21tYW5k5a+55bqU55qE5Ye95pWw5oiW5ZG95LukICovCiAgICAgIGNvbnN0IGFyZ3MgPSB0b0FyckFyZ3MoaG90a2V5Q29uZi5hcmdzKTsKICAgICAgbGV0IGNvbW1hbmRGdW5jID0gaG90a2V5Q29uZi5jb21tYW5kOwogICAgICBpZiAodGFyZ2V0ICYmIHR5cGVvZiBob3RrZXlDb25mLmNvbW1hbmQgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgY29tbWFuZEZ1bmMgPSBnZXRWYWxCeVBhdGgodGFyZ2V0LCBob3RrZXlDb25mLmNvbW1hbmQpOwogICAgICB9CgogICAgICBpZiAoIShjb21tYW5kRnVuYyBpbnN0YW5jZW9mIEZ1bmN0aW9uKSAmJiB0YXJnZXQpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFtob3RrZXlzUnVubmVyXSDmnKrmib7liLBjb21tYW5kOiAke2hvdGtleUNvbmYuY29tbWFuZH0g5a+55bqU55qE5Ye95pWwYCkKICAgICAgfQoKICAgICAgaWYgKGhvdGtleUNvbmYud2hlbiAmJiBjb25kaXRpb25IYW5kbGVyIGluc3RhbmNlb2YgRnVuY3Rpb24pIHsKICAgICAgICBjb25zdCBpc01hdGNoQ29uZGl0aW9uID0gY29uZGl0aW9uSGFuZGxlci5hcHBseSh0YXJnZXQsIHRvQXJyQXJncyhob3RrZXlDb25mLndoZW4pKTsKICAgICAgICBpZiAoaXNNYXRjaENvbmRpdGlvbiA9PT0gdHJ1ZSkgewogICAgICAgICAgY29tbWFuZEZ1bmMuYXBwbHkodGFyZ2V0LCBhcmdzKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29tbWFuZEZ1bmMuYXBwbHkodGFyZ2V0LCBhcmdzKTsKICAgICAgfQogICAgfSk7CgogICAgcmV0dXJuIG1hdGNoUmVzdWx0CiAgfQoKICBiaW5kaW5nIChvcHRzID0ge30pIHsKICAgIGlmICghaXNPYmoob3B0cykgfHwgIUFycmF5LmlzQXJyYXkob3B0cy5ob3RrZXlzKSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tob3RrZXlzUnVubmVyXSDmj5Dkvpvnu5liaW5kaW5n55qE5Y+C5pWw5LiN5q2j56GuJykKICAgIH0KCiAgICBvcHRzLmVsID0gb3B0cy5lbCB8fCB0aGlzLndpbmRvdzsKICAgIG9wdHMudHlwZSA9IG9wdHMudHlwZSB8fCAna2V5ZG93bic7CiAgICBvcHRzLmRlYnVnICYmICh0aGlzLmRlYnVnID0gdHJ1ZSk7CgogICAgdGhpcy5zZXRIb3RrZXlzKG9wdHMuaG90a2V5cyk7CgogICAgaWYgKHR5cGVvZiBvcHRzLmVsID09PSAnc3RyaW5nJykgewogICAgICBvcHRzLmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihvcHRzLmVsKTsKICAgIH0KCiAgICBvcHRzLmVsLmFkZEV2ZW50TGlzdGVuZXIob3B0cy50eXBlLCAoZXZlbnQpID0+IHsKICAgICAgb3B0cy5ldmVudCA9IGV2ZW50OwogICAgICB0aGlzLnJ1bihvcHRzKTsKICAgIH0sIHRydWUpOwogIH0KfQoKLyogZXNsaW50LWRpc2FibGUgY2FtZWxjYXNlICovCgovKioKICogQGxpY2Vuc2UgQ29weXJpZ2h0IDIwMTcgLSBDaHJpcyBXZXN0IC0gTUlUIExpY2Vuc2VkCiAqIFByb3RvdHlwZSB0byBlYXNpbHkgc2V0IHRoZSB2b2x1bWUgKGFjdHVhbCBhbmQgcGVyY2VpdmVkKSwgbG91ZG5lc3MsCiAqIGRlY2liZWxzLCBhbmQgZ2FpbiB2YWx1ZS4KICogaHR0cHM6Ly9jd2VzdGJsb2cuY29tLzIwMTcvMDgvMjIvd2ViLWF1ZGlvLWFwaS1jb250cm9sbGluZy1hdWRpby12aWRlby1sb3VkbmVzcy8KICovCmZ1bmN0aW9uIE1lZGlhRWxlbWVudEFtcGxpZmllciAobWVkaWFFbGVtKSB7CiAgdGhpcy5fY29udGV4dCA9IG5ldyAod2luZG93LkF1ZGlvQ29udGV4dCB8fCB3aW5kb3cud2Via2l0QXVkaW9Db250ZXh0KSgpOwogIHRoaXMuX3NvdXJjZSA9IHRoaXMuX2NvbnRleHQuY3JlYXRlTWVkaWFFbGVtZW50U291cmNlKHRoaXMuX2VsZW1lbnQgPSBtZWRpYUVsZW0pOwogIHRoaXMuX3NvdXJjZS5jb25uZWN0KHRoaXMuX2dhaW4gPSB0aGlzLl9jb250ZXh0LmNyZWF0ZUdhaW4oKSk7CiAgdGhpcy5fZ2Fpbi5jb25uZWN0KHRoaXMuX2NvbnRleHQuZGVzdGluYXRpb24pOwp9ClsKICAnZ2V0Q29udGV4dCcsCiAgJ2dldFNvdXJjZScsCiAgJ2dldEdhaW4nLAogICdnZXRFbGVtZW50JywKICBbCiAgICAnZ2V0Vm9sdW1lJywKICAgIGZ1bmN0aW9uIChvcHRfZ2V0UGVyY2VpdmVkKSB7CiAgICAgIHJldHVybiAob3B0X2dldFBlcmNlaXZlZCA/IHRoaXMuZ2V0TG91ZG5lc3MoKSA6IDEpICogdGhpcy5fZWxlbWVudC52b2x1bWUKICAgIH0KICBdLAogIFsKICAgICdzZXRWb2x1bWUnLAogICAgZnVuY3Rpb24gKHZhbHVlLCBvcHRfc2V0UGVyY2VpdmVkKSB7CiAgICAgIHZhciB2b2x1bWUgPSB2YWx1ZSAvIChvcHRfc2V0UGVyY2VpdmVkID8gdGhpcy5nZXRMb3VkbmVzcygpIDogMSk7CiAgICAgIGlmICh2b2x1bWUgPiAxKSB7CiAgICAgICAgdGhpcy5zZXRMb3VkbmVzcyh0aGlzLmdldExvdWRuZXNzKCkgKiB2b2x1bWUpOwogICAgICAgIHZvbHVtZSA9IDE7CiAgICAgIH0KICAgICAgdGhpcy5fZWxlbWVudC52b2x1bWUgPSB2b2x1bWU7CiAgICB9CiAgXSwKICBbJ2dldEdhaW5WYWx1ZScsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX2dhaW4uZ2Fpbi52YWx1ZSB9XSwKICBbJ3NldEdhaW5WYWx1ZScsIGZ1bmN0aW9uICh2YWx1ZSkgeyB0aGlzLl9nYWluLmdhaW4udmFsdWUgPSB2YWx1ZTsgfV0sCiAgWydnZXREZWNpYmVscycsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIDIwICogTWF0aC5sb2cxMCh0aGlzLmdldEdhaW5WYWx1ZSgpKSB9XSwKICBbJ3NldERlY2liZWxzJywgZnVuY3Rpb24gKHZhbHVlKSB7IHRoaXMuc2V0R2FpblZhbHVlKE1hdGgucG93KDEwLCB2YWx1ZSAvIDIwKSk7IH1dLAogIFsnZ2V0TG91ZG5lc3MnLCBmdW5jdGlvbiAoKSB7IHJldHVybiBNYXRoLnBvdygyLCB0aGlzLmdldERlY2liZWxzKCkgLyAxMCkgfV0sCiAgWydzZXRMb3VkbmVzcycsIGZ1bmN0aW9uICh2YWx1ZSkgeyB0aGlzLnNldERlY2liZWxzKDEwICogTWF0aC5sb2cyKHZhbHVlKSk7IH1dCl0uZm9yRWFjaChmdW5jdGlvbiAobmFtZSwgZm4pIHsKICBpZiAodHlwZW9mIG5hbWUgPT09ICdzdHJpbmcnKSB7CiAgICBmbiA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXNbbmFtZS5yZXBsYWNlKCdnZXQnLCAnJykudG9Mb3dlckNhc2UoKV0gfTsKICB9IGVsc2UgewogICAgZm4gPSBuYW1lWzFdOwogICAgbmFtZSA9IG5hbWVbMF07CiAgfQogIE1lZGlhRWxlbWVudEFtcGxpZmllci5wcm90b3R5cGVbbmFtZV0gPSBmbjsKfSk7Cgpjb25zdCBkb3dubG9hZFN0YXRlID0gbmV3IE1hcCgpOwoKZnVuY3Rpb24gZG93bmxvYWQgKHVybCwgdGl0bGUpIHsKICBjb25zdCBkb3dubG9hZEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogIGRvd25sb2FkRWwuaHJlZiA9IHVybDsKICBkb3dubG9hZEVsLnRhcmdldCA9ICdfYmxhbmsnOwogIGRvd25sb2FkRWwuZG93bmxvYWQgPSB0aXRsZTsKICBkb3dubG9hZEVsLmNsaWNrKCk7Cn0KCmZ1bmN0aW9uIG1lZGlhRG93bmxvYWQgKG1lZGlhRWwsIHRpdGxlLCBkb3dubG9hZFR5cGUpIHsKICAvKioKICAgKiDlvZPlqpLkvZPljIXlkKtzb3VyY2XmoIfnrb7ml7bvvIzlqpLkvZPmoIfnrb7nmoTnnJ/lrp7lnLDlnYDlsIbkvJrmmK9jdXJyZW50U3JjCiAgICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0hUTUxNZWRpYUVsZW1lbnQvY3VycmVudFNyYwogICAqLwogIGNvbnN0IG1lZGlhVXJsID0gbWVkaWFFbC5zcmMgfHwgbWVkaWFFbC5jdXJyZW50U3JjOwogIGNvbnN0IG1lZGlhU3RhdGUgPSBkb3dubG9hZFN0YXRlLmdldChtZWRpYVVybCkgfHwge307CgogIGlmIChtZWRpYUVsICYmIG1lZGlhVXJsICYmICFtZWRpYVVybC5zdGFydHNXaXRoKCdibG9iOicpKSB7CiAgICBjb25zdCBtZWRpYUluZm8gPSB7CiAgICAgIHR5cGU6IG1lZGlhRWwgaW5zdGFuY2VvZiBIVE1MVmlkZW9FbGVtZW50ID8gJ3ZpZGVvJyA6ICdhdWRpbycsCiAgICAgIGZvcm1hdDogbWVkaWFFbCBpbnN0YW5jZW9mIEhUTUxWaWRlb0VsZW1lbnQgPyAnbXA0JyA6ICdtcDMnCiAgICB9OwogICAgbGV0IG1lZGlhVGl0bGUgPSBgJHt0aXRsZSB8fCBtZWRpYUVsLmdldEF0dHJpYnV0ZSgnZGF0YS10aXRsZScpIHx8IGRvY3VtZW50LnRpdGxlIHx8IERhdGUubm93KCl9XyR7bWVkaWFJbmZvLnR5cGV9LiR7bWVkaWFJbmZvLmZvcm1hdH1gOwoKICAgIC8qIOWwj+S6jjXliIbpkp/nmoTlqpLkvZPmlofku7bvvIzlsJ3or5XpgJrov4dmZXRjaOS4i+i9vSAqLwogICAgaWYgKGRvd25sb2FkVHlwZSA9PT0gJ2Jsb2InIHx8IG1lZGlhRWwuZHVyYXRpb24gPCA2MCAqIDUpIHsKICAgICAgaWYgKG1lZGlhU3RhdGUuZG93bmxvYWRpbmcpIHsKICAgICAgICAvKiDot53kuIrmrKHngrnkuIvovb3lsI/kuo4xc+eahOaDheWGteebtOaOpeS4jeWTjeW6lOS7u+S9leaTjeS9nCAqLwogICAgICAgIGlmIChEYXRlLm5vdygpIC0gbWVkaWFTdGF0ZS5kb3dubG9hZGluZyA8IDEwMDAgKiAxKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3QgY29uZmlybSA9IG9yaWdpbmFsLmNvbmZpcm0oaTE4bi50KCdtZWRpYURvd25sb2FkLmRvd25sb2FkaW5nJykpOwogICAgICAgICAgaWYgKCFjb25maXJtKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKG1lZGlhU3RhdGUuaGFzRG93bmxvYWQpIHsKICAgICAgICBjb25zdCBjb25maXJtID0gb3JpZ2luYWwuY29uZmlybShpMThuLnQoJ21lZGlhRG93bmxvYWQuaGFzRG93bmxvYWQnKSk7CiAgICAgICAgaWYgKCFjb25maXJtKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICB9CiAgICAgIH0KCiAgICAgIG1lZGlhVGl0bGUgPSBvcmlnaW5hbC5wcm9tcHQoaTE4bi50KCdtZWRpYURvd25sb2FkLmNvbmZpcm1UaXRsZScpLCBtZWRpYVRpdGxlKTsKICAgICAgaWYgKCFtZWRpYVRpdGxlKSB7IHJldHVybiBmYWxzZSB9CgogICAgICBpZiAoIW1lZGlhVGl0bGUuZW5kc1dpdGgobWVkaWFJbmZvLmZvcm1hdCkpIHsKICAgICAgICBtZWRpYVRpdGxlID0gbWVkaWFUaXRsZSArICcuJyArIG1lZGlhSW5mby5mb3JtYXQ7CiAgICAgIH0KCiAgICAgIGxldCBmZXRjaFVybCA9IG1lZGlhVXJsOwogICAgICBpZiAobWVkaWFVcmwuc3RhcnRzV2l0aCgnaHR0cDovLycpICYmIGxvY2F0aW9uLmhyZWYuc3RhcnRzV2l0aCgnaHR0cHM6Ly8nKSkgewogICAgICAgIC8qIOWcqGh0dHBz6YeMZmV0Y2ggaHR0cOi1hOa6kOS8muWvvOiHtCBibG9jazptaXhlZC1jb250ZW50IOmUmeivr++8jOaJgOS7peWwneivleWwhuWcsOWdgOe7n+S4gOaIkGh0dHBz5byA5aS0ICovCiAgICAgICAgZmV0Y2hVcmwgPSBtZWRpYVVybC5yZXBsYWNlKCdodHRwOi8vJywgJ2h0dHBzOi8vJyk7CiAgICAgIH0KCiAgICAgIG1lZGlhU3RhdGUuZG93bmxvYWRpbmcgPSBEYXRlLm5vdygpOwogICAgICBkb3dubG9hZFN0YXRlLnNldChtZWRpYVVybCwgbWVkaWFTdGF0ZSk7CiAgICAgIGZldGNoKGZldGNoVXJsKS50aGVuKHJlcyA9PiB7CiAgICAgICAgcmVzLmJsb2IoKS50aGVuKGJsb2IgPT4gewogICAgICAgICAgY29uc3QgYmxvYlVybCA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOwogICAgICAgICAgZG93bmxvYWQoYmxvYlVybCwgbWVkaWFUaXRsZSk7CgogICAgICAgICAgbWVkaWFTdGF0ZS5oYXNEb3dubG9hZCA9IHRydWU7CiAgICAgICAgICBkZWxldGUgbWVkaWFTdGF0ZS5kb3dubG9hZGluZzsKICAgICAgICAgIGRvd25sb2FkU3RhdGUuc2V0KG1lZGlhVXJsLCBtZWRpYVN0YXRlKTsKICAgICAgICAgIHdpbmRvdy5VUkwucmV2b2tlT2JqZWN0VVJMKGJsb2JVcmwpOwogICAgICAgIH0pOwogICAgICB9KS5jYXRjaChlcnIgPT4gewogICAgICAgIG9yaWdpbmFsLmNvbnNvbGUuZXJyb3IoJ2ZldGNo5LiL6L295pON5L2c5aSx6LSlOicsIGVycik7CgogICAgICAgIC8qIOS4i+i9veWFnOW6lSAqLwogICAgICAgIGRvd25sb2FkKG1lZGlhVXJsLCBtZWRpYVRpdGxlKTsKCiAgICAgICAgZGVsZXRlIG1lZGlhU3RhdGUuZG93bmxvYWRpbmc7CiAgICAgICAgbWVkaWFTdGF0ZS5oYXNEb3dubG9hZCA9IHRydWU7CiAgICAgICAgZG93bmxvYWRTdGF0ZS5zZXQobWVkaWFVcmwsIG1lZGlhU3RhdGUpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGRvd25sb2FkKG1lZGlhVXJsLCBtZWRpYVRpdGxlKTsKICAgIH0KICB9IGVsc2UgaWYgKG1lZGlhU291cmNlLmhhc0luaXQoKSkgewogICAgLyog5LiL6L296YCa6L+HTWVkaWFTb3VyY2XnrqHnkIbnmoTlqpLkvZPmlofku7YgKi8KICAgIG1lZGlhU291cmNlLmRvd25sb2FkTWVkaWFTb3VyY2UobWVkaWFFbCwgdGl0bGUpOwogIH0gZWxzZSB7CiAgICBvcmlnaW5hbC5hbGVydChpMThuLnQoJ21lZGlhRG93bmxvYWQubm90U3VwcG9ydCcpKTsKICB9Cn0KCmNvbnN0IGRldmljZSA9IHsKICBpc01vYmlsZTogKCkgPT4gewogICAgcmV0dXJuIC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KQogIH0sCiAgaXNUYWJsZXQ6ICgpID0+IHsKICAgIHJldHVybiAvaVBhZC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkKICB9LAogIGlzRGVza3RvcDogKCkgPT4gewogICAgcmV0dXJuICFkZXZpY2UuaXNNb2JpbGUoKSAmJiAhZGV2aWNlLmlzVGFibGV0KCkKICB9LAogIGlzQ2hyb21lOiAoKSA9PiB7CiAgICByZXR1cm4gL0Nocm9tZS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkKICB9LAogIGlzRmlyZWZveDogKCkgPT4gewogICAgcmV0dXJuIC9GaXJlZm94L2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KQogIH0sCiAgaXNTYWZhcmk6ICgpID0+IHsKICAgIHJldHVybiAvU2FmYXJpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KQogIH0sCiAgaXNFZGdlOiAoKSA9PiB7CiAgICByZXR1cm4gL0VkZ2UvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpCiAgfQp9OwoKLyoqCiAqIOaPkOS+m+S4gOS6m+i3n2g1cGxheWVy5YWx5Lqr55qE5YWo5bGA5pa55rOV77yM5YeP5bCR6YeN5aSN5Luj56CB77yM5ZKM5YWx5Lqr5LiA5Lqb6ZyA6KaB5o+Q5YmN5omn6KGM5omN6IO96I635Y+W5b6X5Yiw5b6X5a+56LGhCiAqLwoKCmNvbnN0IGg1cGxheWVyVUlQcm92aWRlciA9IHsKICB2ZXJzaW9uLAogIG9yaWdpbmFsTWV0aG9kcywKICBwYXJzZUhUTUwsCiAgb2JzZXJ2ZVZpc2liaWxpdHksCiAgaXNPdXRPZkRvY3VtZW50LAogIGkxOG4sCiAgZGVidWcsCiAgY29uZmlnTWFuYWdlciwKICBnbG9iYWxGdW5jdGlvbmFsLAogIGRldmljZQp9OwoKLyoqCiAqIOmAmui/h3Byb3h55Yib5bu65Liqd2luZG9355qE5rKZ55uS5Lyg6YCS57uZaDVwbGF5ZXJVaVdyYXBlcgogKiDnm67nmoTmmK/lj6/ku6Xmj5DkvpvkuIDkupvlubLlh4DnmoTlhajlsYDlr7nosaHnu5nliLBoNXBsYXllclVJCiAqIOWPpuWkluaYr+mBv+WFjWg1cGxheWVyVUnkuK3nmoTku6PnoIHmsaHmn5PliLDlrp7pmYXnmoR3aW5kb3flr7nosaEKICovCgpjb25zdCB3aW5kb3dTYW5kYm94ID0gbmV3IFByb3h5KHt9LCB7CiAgZ2V0OiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsKICAgIGlmIChrZXkgPT09ICdoNXBsYXllclVJUHJvdmlkZXInKSB7CiAgICAgIHJldHVybiBoNXBsYXllclVJUHJvdmlkZXIKICAgIH0KCiAgICBpZiAoa2V5ID09PSAnSFRNTEVsZW1lbnQnKSB7CiAgICAgIHJldHVybiBvcmlnaW5hbE1ldGhvZHMuSFRNTEVsZW1lbnQKICAgIH0KCiAgICByZXR1cm4gd2luZG93W2tleV0KICB9Cn0pOwoKLyoqCiAqIOi3n+WumOe9kei/m+ihjOS6kuWKqO+8jOS7peWunueOsOS7peS4i+WKn+iDvQogKiAx44CB5paw54mI5pys5qOA5rWLICjlvoXlrp7njrApCiAqIDLjgIHohJrmnKzlronoo4Xkvb/nlKjmg4XlhrXnu5/orqEKICogM+OAgeiOt+WPluacgOaWsOeahOaOqOiNkOS/oeaBrwogKi8KCgpjb25zdCByZW1vdGVIZWxwZXJVcmwgPSAnaHR0cHM6Ly9oNXBsYXllci5hbnp6LnNpdGUvaDVwLWhlbHBlci9pbmRleC5odG1sJzsKCmNvbnN0IHJlbW90ZUhlbHBlciA9IHsKICBpbml0ICgpIHsKICAgIHRoaXMucmVtb3RlSGFuZGxlcigpOwoKICAgIC8qIOWHj+WwkemHjeWkjeWKoOi9veWSjOmYsuatouW+queOr+W1jOWllyAqLwogICAgaWYgKGlzSW5JZnJhbWUoKSkgeyByZXR1cm4gZmFsc2UgfQoKICAgIGlmICghY29uZmlnTWFuYWdlci5pc0dsb2JhbFN0b3JhZ2VVc2FibGUoKSkgeyByZXR1cm4gZmFsc2UgfQoKICAgIGNvbnN0IGNvbnRhY3RSZW1vdGVIZWxwZXJTdWNjZXNzVGltZSA9IGNvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgnY29udGFjdFJlbW90ZUhlbHBlclN1Y2Nlc3NUaW1lJyk7CiAgICBsZXQgbGFzdENvbnRhY3RSZW1vdGVIZWxwZXJUaW1lID0gY29uZmlnTWFuYWdlci5nZXRHbG9iYWxTdG9yYWdlKCdsYXN0Q29udGFjdFJlbW90ZUhlbHBlclRpbWUnKTsKICAgIGlmICghbGFzdENvbnRhY3RSZW1vdGVIZWxwZXJUaW1lKSB7CiAgICAgIGNvbmZpZ01hbmFnZXIuc2V0R2xvYmFsU3RvcmFnZSgnbGFzdENvbnRhY3RSZW1vdGVIZWxwZXJUaW1lJywgRGF0ZS5ub3coKSk7CiAgICAgIGxhc3RDb250YWN0UmVtb3RlSGVscGVyVGltZSA9IERhdGUubm93KCk7CiAgICB9CgogICAgLyoqCiAgICAgKiDlh4/lsJHot5/ov5znqIvliqnmiYvnmoTmj6HmiYvmrKHmlbAKICAgICAqIDEy5bCP5pe25YaF5pyJ5oiQ5Yqf5o+h5omL6L+H55qE6K+d77yM5bCx5LiN5YaN6YeN5aSN5o+h5omLCiAgICAgKiDmnIDlsJHpl7TpmpQx5YiG6ZKf5omN6L+b6KGM5LiL5LiA5qyh5o+h5omLCiAgICAgKi8KICAgIGNvbnN0IHN5bmNJbnRlcnZhbCA9IGNvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgncmVtb3RlSGVscGVyU3luY0ludGVydmFsJykgfHwgMTAwMCAqIDYwICogNjAgKiAxMjsKICAgIGlmIChjb250YWN0UmVtb3RlSGVscGVyU3VjY2Vzc1RpbWUgJiYgRGF0ZS5ub3coKSAtIGNvbnRhY3RSZW1vdGVIZWxwZXJTdWNjZXNzVGltZSA8IHN5bmNJbnRlcnZhbCkgeyByZXR1cm4gZmFsc2UgfQogICAgaWYgKERhdGUubm93KCkgLSBsYXN0Q29udGFjdFJlbW90ZUhlbHBlclRpbWUgPCAxMDAwICogNjApIHsgcmV0dXJuIGZhbHNlIH0KCiAgICB0aGlzLmVzdGFibGlzaFJlbW90ZUNvbm5lY3Rpb24oKTsKICB9LAoKICBlc3RhYmxpc2hSZW1vdGVDb25uZWN0aW9uICgpIHsKICAgIGNvbnN0IGxhc3RTdWNUaW1lID0gY29uZmlnTWFuYWdlci5nZXRHbG9iYWxTdG9yYWdlKCdjb250YWN0UmVtb3RlSGVscGVyU3VjY2Vzc1RpbWUnKSB8fCAnMCc7CiAgICBjb25zdCB0aW1lU3RyID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF0ucmVwbGFjZSgvLS9nLCAnJykgKyBuZXcgRGF0ZSgpLmdldEhvdXJzKCkgKyAnJyArIG5ldyBEYXRlKCkuZ2V0TWludXRlcygpOwogICAgY29uc3QgaWZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7CiAgICBpZnJhbWUuc3JjID0gYCR7cmVtb3RlSGVscGVyVXJsfT90PSR7dGltZVN0cn0mdj0ke3ZlcnNpb259JmxzdD0ke2xhc3RTdWNUaW1lfWA7CiAgICBpZnJhbWUuc3R5bGUuY3NzVGV4dCA9ICd3aWR0aDowOyBoZWlnaHQ6MDsgYm9yZGVyOm5vbmU7IHZpc2liaWxpdHk6aGlkZGVuOyBvcGFjaXR5OjA7JzsKICAgIGNvbnN0IGluc2VydElmcmFtZSA9ICgpID0+IHsKICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpZnJhbWUpOwogICAgICBjb25maWdNYW5hZ2VyLnNldEdsb2JhbFN0b3JhZ2UoJ2xhc3RDb250YWN0UmVtb3RlSGVscGVyVGltZScsIERhdGUubm93KCkpOwogICAgfTsKCiAgICBpZiAoIWRvY3VtZW50LmJvZHkgfHwgIWRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQpIHsKICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBpbnNlcnRJZnJhbWUsIHsgb25jZTogdHJ1ZSB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGluc2VydElmcmFtZSgpOwogICAgfQoKICAgIC8qIOS4jeeuoeaPoeaJi+aIkOWKn+S4juWQpu+8jDEw56eS5ZCO56e76ZmkaWZyYW1l77yM5Li75Yqo57uI5q2i6Lef6L+c56iL5Yqp5omL55qE6L+e5o6lICovCiAgICBzZXRUaW1lb3V0KCgpID0+IHsgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChpZnJhbWUpOyB9LCAxMDAwMCk7CiAgfSwKCiAgYXN5bmMgcmVtb3RlSGFuZGxlciAoKSB7CiAgICBpZiAoIWxvY2F0aW9uLmhyZWYuc3RhcnRzV2l0aChyZW1vdGVIZWxwZXJVcmwpIHx8ICFjb25maWdNYW5hZ2VyLmlzR2xvYmFsU3RvcmFnZVVzYWJsZSgpKSB7IHJldHVybiBmYWxzZSB9CgogICAgZnVuY3Rpb24gc3luY1JlbW90ZURhdGEgKHBhZ2VXaW5kb3cpIHsKICAgICAgaWYgKHBhZ2VXaW5kb3cucmVjb21tZW5kTGlzdCkgewogICAgICAgIGNvbmZpZ01hbmFnZXIuc2V0R2xvYmFsU3RvcmFnZSgncmVjb21tZW5kTGlzdCcsIHBhZ2VXaW5kb3cucmVjb21tZW5kTGlzdCk7CiAgICAgIH0KCiAgICAgIC8qIOW+heWinuWKoOeJiOacrOWvueavlOWIpOaWremAu+i+kSAqLwogICAgICBpZiAocGFnZVdpbmRvdy5yZW1vdGVWZXJzaW9uKSB7CiAgICAgICAgY29uZmlnTWFuYWdlci5zZXRHbG9iYWxTdG9yYWdlKCdyZW1vdGVWZXJzaW9uJywgcGFnZVdpbmRvdy5yZW1vdGVWZXJzaW9uKTsKICAgICAgfQoKICAgICAgaWYgKHBhZ2VXaW5kb3cucmVtb3RlSGVscGVyU3luY0ludGVydmFsKSB7CiAgICAgICAgY29uZmlnTWFuYWdlci5zZXRHbG9iYWxTdG9yYWdlKCdyZW1vdGVIZWxwZXJTeW5jSW50ZXJ2YWwnLCBwYWdlV2luZG93LnJlbW90ZUhlbHBlclN5bmNJbnRlcnZhbCk7CiAgICAgIH0KCiAgICAgIGNvbmZpZ01hbmFnZXIuc2V0R2xvYmFsU3RvcmFnZSgnY29udGFjdFJlbW90ZUhlbHBlclN1Y2Nlc3NUaW1lJywgRGF0ZS5ub3coKSk7CiAgICB9CgogICAgbGV0IGNoZWNrQ291bnQgPSAwOwogICAgZnVuY3Rpb24gY2hlY2tSZW1vdGVIZWxwZXJTdGF0dXMgKHBhZ2VXaW5kb3cpIHsKICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHBhZ2VXaW5kb3cucmVjb21tZW5kTGlzdCkpIHsKICAgICAgICBpZiAoY2hlY2tDb3VudCA8IDMwKSB7CiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgY2hlY2tDb3VudCsrOwogICAgICAgICAgICBjaGVja1JlbW90ZUhlbHBlclN0YXR1cyhwYWdlV2luZG93KTsKICAgICAgICAgIH0sIDIwMCk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4KICAgICAgfQoKICAgICAgc3luY1JlbW90ZURhdGEocGFnZVdpbmRvdyk7CiAgICB9CgogICAgY29uc3QgcGFnZVdpbmRvdyA9IGF3YWl0IGdldFBhZ2VXaW5kb3coKTsKICAgIHBhZ2VXaW5kb3cgJiYgY2hlY2tSZW1vdGVIZWxwZXJTdGF0dXMocGFnZVdpbmRvdyk7CiAgfQp9OwoKLyoqCiAgKiDmo4DmtYvlvZPliY3pobXpnaLmmK/lkKbkuLogQ2xvdWRmbGFyZSDnmoQgY2hhbGxlbmdlIOmhtemdogogICogQHJldHVybnMge2Jvb2xlYW59IOWmguaenOaYryBDbG91ZGZsYXJlIGNoYWxsZW5nZSDpobXpnaLliJnov5Tlm54gdHJ1Ze+8jOWQpuWImei/lOWbniBmYWxzZQogICovCmZ1bmN0aW9uIGlzQ2xvdWRmbGFyZUNoYWxsZW5nZVBhZ2UgKCkgewogIC8vIOeJueW+gTE6IOajgOafpemhtemdouagh+mimOaYr+WQpuWMheWQq+eJueWumuaWh+acrAogIGNvbnN0IHRpdGxlQ2hlY2sgPSBkb2N1bWVudC50aXRsZS5pbmNsdWRlcygnSnVzdCBhIG1vbWVudCcpIHx8CiAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnRpdGxlLmluY2x1ZGVzKCdDbG91ZGZsYXJlJykgfHwKICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQudGl0bGUuaW5jbHVkZXMoJ2NoYWxsZW5nZScpOwoKICAvLyDnibnlvoEyOiDmo4Dmn6XmmK/lkKblrZjlnKjnibnlrprnmoQgbWV0YSDmoIfnrb4KICBjb25zdCBtZXRhUmVmcmVzaEV4aXN0cyA9ICEhZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbWV0YVtodHRwLWVxdWl2PSJyZWZyZXNoIl0nKTsKICBjb25zdCByb2JvdHNOb2luZGV4RXhpc3RzID0gISFkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtZXRhW25hbWU9InJvYm90cyJdW2NvbnRlbnQqPSJub2luZGV4Il0nKTsKCiAgLy8g54m55b6BMzog5qOA5p+l6aG16Z2i5LiK5piv5ZCm5pyJ54m55a6a55qEIERPTSDlhYPntKDmiJbnsbvlkI0KICBjb25zdCBtYWluV3JhcHBlckV4aXN0cyA9ICEhZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1haW4td3JhcHBlcltyb2xlPSJtYWluIl0nKTsKICBjb25zdCBjaGFsbGVuZ2VFcnJvckV4aXN0cyA9ICEhZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NoYWxsZW5nZS1lcnJvci10ZXh0Jyk7CiAgY29uc3QgYm9keU5vSnNDbGFzcyA9IGRvY3VtZW50LmJvZHkgJiYgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QgPyBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5jb250YWlucygnbm8tanMnKSA6IGZhbHNlOwoKICAvLyDnibnlvoE0OiDmo4Dmn6XpobXpnaLmoLflvI/kuK3mmK/lkKbljIXlkKvnibnlrprnmoQgQ2xvdWRmbGFyZSDnm7jlhbPmoLflvI8KICBjb25zdCBoYXNDbG91ZGZsYXJlU3R5bGluZyA9IGRvY3VtZW50LnN0eWxlU2hlZXRzLmxlbmd0aCA+IDAgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5pbm5lckhUTUwuaW5jbHVkZXMoJ2JhY2tncm91bmQtaW1hZ2U6IHVybChkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LCcpIHx8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuaW5uZXJIVE1MLmluY2x1ZGVzKCdjaGFsbGVuZ2UnKSk7CgogIC8vIOiHs+Wwkea7oei2s+S7peS4i+adoeS7tue7hOWQiOS5i+S4gOaJjeWIpOWumuS4uiBDbG91ZGZsYXJlIGNoYWxsZW5nZSDpobXpnaI6CiAgLy8gMS4g5qCH6aKY54m55b6BICsg6Iez5bCR5LiA5LiqIG1ldGEg54m55b6BCiAgLy8gMi4g5qCH6aKY54m55b6BICsg6Iez5bCR5LiA5LiqIERPTSDnibnlvoEKICAvLyAzLiDoh7PlsJHkuKTkuKogRE9NIOeJueW+gSArIOiHs+WwkeS4gOS4qiBtZXRhIOeJueW+gQogIC8vIDQuIOagt+W8j+eJueW+gSArIOiHs+WwkeS4gOS4quWFtuS7luexu+Wei+eahOeJueW+gQoKICBjb25zdCBtZXRhRmVhdHVyZXMgPSBtZXRhUmVmcmVzaEV4aXN0cyB8fCByb2JvdHNOb2luZGV4RXhpc3RzOwogIGNvbnN0IGRvbUZlYXR1cmVzID0gbWFpbldyYXBwZXJFeGlzdHMgfHwgY2hhbGxlbmdlRXJyb3JFeGlzdHMgfHwgYm9keU5vSnNDbGFzczsKCiAgcmV0dXJuICh0aXRsZUNoZWNrICYmIG1ldGFGZWF0dXJlcykgfHwKICAgICAgICAgKHRpdGxlQ2hlY2sgJiYgZG9tRmVhdHVyZXMpIHx8CiAgICAgICAgICgoZG9tRmVhdHVyZXMgJiYgKG1haW5XcmFwcGVyRXhpc3RzICsgY2hhbGxlbmdlRXJyb3JFeGlzdHMgKyAoYm9keU5vSnNDbGFzcyA/IDEgOiAwKSA+PSAyKSkgJiYgbWV0YUZlYXR1cmVzKSB8fAogICAgICAgICAoaGFzQ2xvdWRmbGFyZVN0eWxpbmcgJiYgKHRpdGxlQ2hlY2sgfHwgbWV0YUZlYXR1cmVzIHx8IGRvbUZlYXR1cmVzKSkKfQoKZnVuY3Rpb24gcmVnaXN0ZXJNb3VzZUV2ZW50IChoNXBsYXllcikgewogIGNvbnN0IHQgPSBoNXBsYXllcjsKCiAgY29uc3QgbG9uZ1ByZXNzVGltZSA9IGNvbmZpZ01hbmFnZXIuZ2V0KCdtb3VzZS5sb25nUHJlc3NUaW1lJykgfHwgNjAwOwogIGxldCBtb3VzZUV2ZW50VGltZXIgPSBudWxsOwogIGxldCBoYXNIYW5kbGVFdmVudCA9IGZhbHNlOwogIGxldCBpc1BhdXNlZCA9IGZhbHNlOwogIGxldCBvbGRQbGF5YmFja1JhdGUgPSAxOwoKICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgIGNvbnN0IHBsYXllciA9IHQucGxheWVyKCk7CgogICAgaWYgKCFwbGF5ZXIgfHwgIShwbGF5ZXIgaW5zdGFuY2VvZiBIVE1MVmlkZW9FbGVtZW50KSkgeyByZXR1cm4gfQoKICAgIGlzUGF1c2VkID0gcGxheWVyLnBhdXNlZDsKCiAgICBpZiAoIWlzQ29vcmRpbmF0ZUluRWxlbWVudChldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZLCBwbGF5ZXIpKSB7IHJldHVybiB9CgogICAgLyog6aKE55WZ5Ye65bqV6YOoODBweOeahOWMuuWfn++8jOmBv+WFjeWvvOiHtOW3peWFt+agj+eahOaTjeS9nOW8guW4uCAqLwogICAgY29uc3QgcmVjdCA9IHBsYXllci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIGlmIChldmVudC5jbGllbnRZID4gcmVjdC5ib3R0b20gLSA4MCkgeyByZXR1cm4gfQoKICAgIC8qIOm8oOagh+W3pumUruS6i+S7tiAqLwogICAgaWYgKGV2ZW50LmJ1dHRvbiA9PT0gMCkgewogICAgICBtb3VzZUV2ZW50VGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICBoYXNIYW5kbGVFdmVudCA9IHRydWU7CiAgICAgICAgb2xkUGxheWJhY2tSYXRlID0gdC5nZXRQbGF5YmFja1JhdGUoKTsKICAgICAgICB0LnVuTG9ja1BsYXliYWNrUmF0ZSgpOwogICAgICAgIHQuc2V0UGxheWJhY2tSYXRlKDMpOwogICAgICAgIHQubG9ja1BsYXliYWNrUmF0ZSg4MDApOwoKICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICB9LCBsb25nUHJlc3NUaW1lKTsKICAgIH0KICB9LCB0cnVlKTsKCiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIGZ1bmN0aW9uIChldmVudCkgewogICAgbW91c2VFdmVudFRpbWVyICYmIGNsZWFyVGltZW91dChtb3VzZUV2ZW50VGltZXIpOwoKICAgIGlmIChoYXNIYW5kbGVFdmVudCkgewogICAgICBoYXNIYW5kbGVFdmVudCA9IGZhbHNlOwogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKCiAgICAgIGlmIChpc1BhdXNlZCkgewogICAgICAgIHQubWVkaWFQbHVzQXBpLmxvY2tQbGF5KDYwMCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdC5tZWRpYVBsdXNBcGkubG9ja1BhdXNlKDYwMCk7CiAgICAgIH0KCiAgICAgIHQudW5Mb2NrUGxheWJhY2tSYXRlKCk7CiAgICAgIHQuc2V0UGxheWJhY2tSYXRlKG9sZFBsYXliYWNrUmF0ZSk7CiAgICAgIHQubG9ja1BsYXliYWNrUmF0ZSg4MDApOwogICAgfQogIH0sIHRydWUpOwp9Cgpjb25zdCBoNXBsYXllclVJID0gZnVuY3Rpb24gKHdpbmRvdykge3ZhciBoNXBsYXllclVJID0gKGZ1bmN0aW9uICgpIHsKCiAgY29uc3Qgc2hlZXQgPSBuZXcgQ1NTU3R5bGVTaGVldCgpO3NoZWV0LnJlcGxhY2VTeW5jKCI6cm9vdCxcbjpob3N0LFxuLnNsLXRoZW1lLWxpZ2h0IHtcbiAgY29sb3Itc2NoZW1lOiBsaWdodDtcblxuICAtLXNsLWNvbG9yLWdyYXktNTA6IGhzbCgwIDAlIDk3LjUlKTtcbiAgLS1zbC1jb2xvci1ncmF5LTEwMDogaHNsKDI0MCA0LjglIDk1LjklKTtcbiAgLS1zbC1jb2xvci1ncmF5LTIwMDogaHNsKDI0MCA1LjklIDkwJSk7XG4gIC0tc2wtY29sb3ItZ3JheS0zMDA6IGhzbCgyNDAgNC45JSA4My45JSk7XG4gIC0tc2wtY29sb3ItZ3JheS00MDA6IGhzbCgyNDAgNSUgNjQuOSUpO1xuICAtLXNsLWNvbG9yLWdyYXktNTAwOiBoc2woMjQwIDMuOCUgNDYuMSUpO1xuICAtLXNsLWNvbG9yLWdyYXktNjAwOiBoc2woMjQwIDUuMiUgMzMuOSUpO1xuICAtLXNsLWNvbG9yLWdyYXktNzAwOiBoc2woMjQwIDUuMyUgMjYuMSUpO1xuICAtLXNsLWNvbG9yLWdyYXktODAwOiBoc2woMjQwIDMuNyUgMTUuOSUpO1xuICAtLXNsLWNvbG9yLWdyYXktOTAwOiBoc2woMjQwIDUuOSUgMTAlKTtcbiAgLS1zbC1jb2xvci1ncmF5LTk1MDogaHNsKDI0MCA3LjMlIDglKTtcblxuICAtLXNsLWNvbG9yLXJlZC01MDogaHNsKDAgODUuNyUgOTcuMyUpO1xuICAtLXNsLWNvbG9yLXJlZC0xMDA6IGhzbCgwIDkzLjMlIDk0LjElKTtcbiAgLS1zbC1jb2xvci1yZWQtMjAwOiBoc2woMCA5Ni4zJSA4OS40JSk7XG4gIC0tc2wtY29sb3ItcmVkLTMwMDogaHNsKDAgOTMuNSUgODEuOCUpO1xuICAtLXNsLWNvbG9yLXJlZC00MDA6IGhzbCgwIDkwLjYlIDcwLjglKTtcbiAgLS1zbC1jb2xvci1yZWQtNTAwOiBoc2woMCA4NC4yJSA2MC4yJSk7XG4gIC0tc2wtY29sb3ItcmVkLTYwMDogaHNsKDAgNzIuMiUgNTAuNiUpO1xuICAtLXNsLWNvbG9yLXJlZC03MDA6IGhzbCgwIDczLjclIDQxLjglKTtcbiAgLS1zbC1jb2xvci1yZWQtODAwOiBoc2woMCA3MCUgMzUuMyUpO1xuICAtLXNsLWNvbG9yLXJlZC05MDA6IGhzbCgwIDYyLjglIDMwLjYlKTtcbiAgLS1zbC1jb2xvci1yZWQtOTUwOiBoc2woMCA2MCUgMTkuNiUpO1xuXG4gIC0tc2wtY29sb3Itb3JhbmdlLTUwOiBoc2woMzMuMyAxMDAlIDk2LjUlKTtcbiAgLS1zbC1jb2xvci1vcmFuZ2UtMTAwOiBoc2woMzQuMyAxMDAlIDkxLjglKTtcbiAgLS1zbC1jb2xvci1vcmFuZ2UtMjAwOiBoc2woMzIuMSA5Ny43JSA4My4xJSk7XG4gIC0tc2wtY29sb3Itb3JhbmdlLTMwMDogaHNsKDMwLjcgOTcuMiUgNzIuNCUpO1xuICAtLXNsLWNvbG9yLW9yYW5nZS00MDA6IGhzbCgyNyA5NiUgNjElKTtcbiAgLS1zbC1jb2xvci1vcmFuZ2UtNTAwOiBoc2woMjQuNiA5NSUgNTMuMSUpO1xuICAtLXNsLWNvbG9yLW9yYW5nZS02MDA6IGhzbCgyMC41IDkwLjIlIDQ4LjIlKTtcbiAgLS1zbC1jb2xvci1vcmFuZ2UtNzAwOiBoc2woMTcuNSA4OC4zJSA0MC40JSk7XG4gIC0tc2wtY29sb3Itb3JhbmdlLTgwMDogaHNsKDE1IDc5LjElIDMzLjclKTtcbiAgLS1zbC1jb2xvci1vcmFuZ2UtOTAwOiBoc2woMTUuMyA3NC42JSAyNy44JSk7XG4gIC0tc2wtY29sb3Itb3JhbmdlLTk1MDogaHNsKDE1LjIgNjkuMSUgMTklKTtcblxuICAtLXNsLWNvbG9yLWFtYmVyLTUwOiBoc2woNDggMTAwJSA5Ni4xJSk7XG4gIC0tc2wtY29sb3ItYW1iZXItMTAwOiBoc2woNDggOTYuNSUgODguOCUpO1xuICAtLXNsLWNvbG9yLWFtYmVyLTIwMDogaHNsKDQ4IDk2LjYlIDc2LjclKTtcbiAgLS1zbC1jb2xvci1hbWJlci0zMDA6IGhzbCg0NS45IDk2LjclIDY0LjUlKTtcbiAgLS1zbC1jb2xvci1hbWJlci00MDA6IGhzbCg0My4zIDk2LjQlIDU2LjMlKTtcbiAgLS1zbC1jb2xvci1hbWJlci01MDA6IGhzbCgzNy43IDkyLjElIDUwLjIlKTtcbiAgLS1zbC1jb2xvci1hbWJlci02MDA6IGhzbCgzMi4xIDk0LjYlIDQzLjclKTtcbiAgLS1zbC1jb2xvci1hbWJlci03MDA6IGhzbCgyNiA5MC41JSAzNy4xJSk7XG4gIC0tc2wtY29sb3ItYW1iZXItODAwOiBoc2woMjIuNyA4Mi41JSAzMS40JSk7XG4gIC0tc2wtY29sb3ItYW1iZXItOTAwOiBoc2woMjEuNyA3Ny44JSAyNi41JSk7XG4gIC0tc2wtY29sb3ItYW1iZXItOTUwOiBoc2woMjIuOSA3NC4xJSAxNi43JSk7XG5cbiAgLS1zbC1jb2xvci15ZWxsb3ctNTA6IGhzbCg1NC41IDkxLjclIDk1LjMlKTtcbiAgLS1zbC1jb2xvci15ZWxsb3ctMTAwOiBoc2woNTQuOSA5Ni43JSA4OCUpO1xuICAtLXNsLWNvbG9yLXllbGxvdy0yMDA6IGhzbCg1Mi44IDk4LjMlIDc2LjklKTtcbiAgLS1zbC1jb2xvci15ZWxsb3ctMzAwOiBoc2woNTAuNCA5Ny44JSA2My41JSk7XG4gIC0tc2wtY29sb3IteWVsbG93LTQwMDogaHNsKDQ3LjkgOTUuOCUgNTMuMSUpO1xuICAtLXNsLWNvbG9yLXllbGxvdy01MDA6IGhzbCg0NS40IDkzLjQlIDQ3LjUlKTtcbiAgLS1zbC1jb2xvci15ZWxsb3ctNjAwOiBoc2woNDAuNiA5Ni4xJSA0MC40JSk7XG4gIC0tc2wtY29sb3IteWVsbG93LTcwMDogaHNsKDM1LjUgOTEuNyUgMzIuOSUpO1xuICAtLXNsLWNvbG9yLXllbGxvdy04MDA6IGhzbCgzMS44IDgxJSAyOC44JSk7XG4gIC0tc2wtY29sb3IteWVsbG93LTkwMDogaHNsKDI4LjQgNzIuNSUgMjUuNyUpO1xuICAtLXNsLWNvbG9yLXllbGxvdy05NTA6IGhzbCgzMy4xIDY5JSAxMy45JSk7XG5cbiAgLS1zbC1jb2xvci1saW1lLTUwOiBoc2woNzguMyA5MiUgOTUuMSUpO1xuICAtLXNsLWNvbG9yLWxpbWUtMTAwOiBoc2woNzkuNiA4OS4xJSA4OS4yJSk7XG4gIC0tc2wtY29sb3ItbGltZS0yMDA6IGhzbCg4MC45IDg4LjUlIDc5LjYlKTtcbiAgLS1zbC1jb2xvci1saW1lLTMwMDogaHNsKDgyIDg0LjUlIDY3LjElKTtcbiAgLS1zbC1jb2xvci1saW1lLTQwMDogaHNsKDgyLjcgNzglIDU1LjUlKTtcbiAgLS1zbC1jb2xvci1saW1lLTUwMDogaHNsKDgzLjcgODAuNSUgNDQuMyUpO1xuICAtLXNsLWNvbG9yLWxpbWUtNjAwOiBoc2woODQuOCA4NS4yJSAzNC41JSk7XG4gIC0tc2wtY29sb3ItbGltZS03MDA6IGhzbCg4NS45IDc4LjQlIDI3LjMlKTtcbiAgLS1zbC1jb2xvci1saW1lLTgwMDogaHNsKDg2LjMgNjklIDIyLjclKTtcbiAgLS1zbC1jb2xvci1saW1lLTkwMDogaHNsKDg3LjYgNjEuMiUgMjAuMiUpO1xuICAtLXNsLWNvbG9yLWxpbWUtOTUwOiBoc2woODYuNSA2MC42JSAxMy45JSk7XG5cbiAgLS1zbC1jb2xvci1ncmVlbi01MDogaHNsKDEzOC41IDc2LjUlIDk2LjclKTtcbiAgLS1zbC1jb2xvci1ncmVlbi0xMDA6IGhzbCgxNDAuNiA4NC4yJSA5Mi41JSk7XG4gIC0tc2wtY29sb3ItZ3JlZW4tMjAwOiBoc2woMTQxIDc4LjklIDg1LjElKTtcbiAgLS1zbC1jb2xvci1ncmVlbi0zMDA6IGhzbCgxNDEuNyA3Ni42JSA3My4xJSk7XG4gIC0tc2wtY29sb3ItZ3JlZW4tNDAwOiBoc2woMTQxLjkgNjkuMiUgNTglKTtcbiAgLS1zbC1jb2xvci1ncmVlbi01MDA6IGhzbCgxNDIuMSA3MC42JSA0NS4zJSk7XG4gIC0tc2wtY29sb3ItZ3JlZW4tNjAwOiBoc2woMTQyLjEgNzYuMiUgMzYuMyUpO1xuICAtLXNsLWNvbG9yLWdyZWVuLTcwMDogaHNsKDE0Mi40IDcxLjglIDI5LjIlKTtcbiAgLS1zbC1jb2xvci1ncmVlbi04MDA6IGhzbCgxNDIuOCA2NC4yJSAyNC4xJSk7XG4gIC0tc2wtY29sb3ItZ3JlZW4tOTAwOiBoc2woMTQzLjggNjEuMiUgMjAuMiUpO1xuICAtLXNsLWNvbG9yLWdyZWVuLTk1MDogaHNsKDE0NC4zIDYwLjclIDEyJSk7XG5cbiAgLS1zbC1jb2xvci1lbWVyYWxkLTUwOiBoc2woMTUxLjggODElIDk1LjklKTtcbiAgLS1zbC1jb2xvci1lbWVyYWxkLTEwMDogaHNsKDE0OS4zIDgwLjQlIDkwJSk7XG4gIC0tc2wtY29sb3ItZW1lcmFsZC0yMDA6IGhzbCgxNTIuNCA3NiUgODAuNCUpO1xuICAtLXNsLWNvbG9yLWVtZXJhbGQtMzAwOiBoc2woMTU2LjIgNzEuNiUgNjYuOSUpO1xuICAtLXNsLWNvbG9yLWVtZXJhbGQtNDAwOiBoc2woMTU4LjEgNjQuNCUgNTEuNiUpO1xuICAtLXNsLWNvbG9yLWVtZXJhbGQtNTAwOiBoc2woMTYwLjEgODQuMSUgMzkuNCUpO1xuICAtLXNsLWNvbG9yLWVtZXJhbGQtNjAwOiBoc2woMTYxLjQgOTMuNSUgMzAuNCUpO1xuICAtLXNsLWNvbG9yLWVtZXJhbGQtNzAwOiBoc2woMTYyLjkgOTMuNSUgMjQuMyUpO1xuICAtLXNsLWNvbG9yLWVtZXJhbGQtODAwOiBoc2woMTYzLjEgODguMSUgMTkuOCUpO1xuICAtLXNsLWNvbG9yLWVtZXJhbGQtOTAwOiBoc2woMTY0LjIgODUuNyUgMTYuNSUpO1xuICAtLXNsLWNvbG9yLWVtZXJhbGQtOTUwOiBoc2woMTY0LjMgODcuNSUgOS40JSk7XG5cbiAgLS1zbC1jb2xvci10ZWFsLTUwOiBoc2woMTY2LjIgNzYuNSUgOTYuNyUpO1xuICAtLXNsLWNvbG9yLXRlYWwtMTAwOiBoc2woMTY3LjIgODUuNSUgODkuMiUpO1xuICAtLXNsLWNvbG9yLXRlYWwtMjAwOiBoc2woMTY4LjQgODMuOCUgNzguMiUpO1xuICAtLXNsLWNvbG9yLXRlYWwtMzAwOiBoc2woMTcwLjYgNzYuOSUgNjQuMyUpO1xuICAtLXNsLWNvbG9yLXRlYWwtNDAwOiBoc2woMTcyLjUgNjYlIDUwLjQlKTtcbiAgLS1zbC1jb2xvci10ZWFsLTUwMDogaHNsKDE3My40IDgwLjQlIDQwJSk7XG4gIC0tc2wtY29sb3ItdGVhbC02MDA6IGhzbCgxNzQuNyA4My45JSAzMS42JSk7XG4gIC0tc2wtY29sb3ItdGVhbC03MDA6IGhzbCgxNzUuMyA3Ny40JSAyNi4xJSk7XG4gIC0tc2wtY29sb3ItdGVhbC04MDA6IGhzbCgxNzYuMSA2OS40JSAyMS44JSk7XG4gIC0tc2wtY29sb3ItdGVhbC05MDA6IGhzbCgxNzUuOSA2MC44JSAxOSUpO1xuICAtLXNsLWNvbG9yLXRlYWwtOTUwOiBoc2woMTc2LjUgNTguNiUgMTEuNCUpO1xuXG4gIC0tc2wtY29sb3ItY3lhbi01MDogaHNsKDE4My4yIDEwMCUgOTYuMyUpO1xuICAtLXNsLWNvbG9yLWN5YW4tMTAwOiBoc2woMTg1LjEgOTUuOSUgOTAuNCUpO1xuICAtLXNsLWNvbG9yLWN5YW4tMjAwOiBoc2woMTg2LjIgOTMuNSUgODEuOCUpO1xuICAtLXNsLWNvbG9yLWN5YW4tMzAwOiBoc2woMTg3IDkyLjQlIDY5JSk7XG4gIC0tc2wtY29sb3ItY3lhbi00MDA6IGhzbCgxODcuOSA4NS43JSA1My4zJSk7XG4gIC0tc2wtY29sb3ItY3lhbi01MDA6IGhzbCgxODguNyA5NC41JSA0Mi43JSk7XG4gIC0tc2wtY29sb3ItY3lhbi02MDA6IGhzbCgxOTEuNiA5MS40JSAzNi41JSk7XG4gIC0tc2wtY29sb3ItY3lhbi03MDA6IGhzbCgxOTIuOSA4Mi4zJSAzMSUpO1xuICAtLXNsLWNvbG9yLWN5YW4tODAwOiBoc2woMTk0LjQgNjkuNiUgMjcuMSUpO1xuICAtLXNsLWNvbG9yLWN5YW4tOTAwOiBoc2woMTk2LjQgNjMuNiUgMjMuNyUpO1xuICAtLXNsLWNvbG9yLWN5YW4tOTUwOiBoc2woMTk2LjggNjElIDE2LjElKTtcblxuICAtLXNsLWNvbG9yLXNreS01MDogaHNsKDIwNCAxMDAlIDk3LjElKTtcbiAgLS1zbC1jb2xvci1za3ktMTAwOiBoc2woMjA0IDkzLjglIDkzLjclKTtcbiAgLS1zbC1jb2xvci1za3ktMjAwOiBoc2woMjAwLjYgOTQuNCUgODYuMSUpO1xuICAtLXNsLWNvbG9yLXNreS0zMDA6IGhzbCgxOTkuNCA5NS41JSA3My45JSk7XG4gIC0tc2wtY29sb3Itc2t5LTQwMDogaHNsKDE5OC40IDkzLjIlIDU5LjYlKTtcbiAgLS1zbC1jb2xvci1za3ktNTAwOiBoc2woMTk4LjYgODguNyUgNDguNCUpO1xuICAtLXNsLWNvbG9yLXNreS02MDA6IGhzbCgyMDAuNCA5OCUgMzkuNCUpO1xuICAtLXNsLWNvbG9yLXNreS03MDA6IGhzbCgyMDEuMyA5Ni4zJSAzMi4yJSk7XG4gIC0tc2wtY29sb3Itc2t5LTgwMDogaHNsKDIwMSA5MCUgMjcuNSUpO1xuICAtLXNsLWNvbG9yLXNreS05MDA6IGhzbCgyMDIgODAuMyUgMjMuOSUpO1xuICAtLXNsLWNvbG9yLXNreS05NTA6IGhzbCgyMDIuMyA3My44JSAxNi41JSk7XG5cbiAgLS1zbC1jb2xvci1ibHVlLTUwOiBoc2woMjEzLjggMTAwJSA5Ni45JSk7XG4gIC0tc2wtY29sb3ItYmx1ZS0xMDA6IGhzbCgyMTQuMyA5NC42JSA5Mi43JSk7XG4gIC0tc2wtY29sb3ItYmx1ZS0yMDA6IGhzbCgyMTMuMyA5Ni45JSA4Ny4zJSk7XG4gIC0tc2wtY29sb3ItYmx1ZS0zMDA6IGhzbCgyMTEuNyA5Ni40JSA3OC40JSk7XG4gIC0tc2wtY29sb3ItYmx1ZS00MDA6IGhzbCgyMTMuMSA5My45JSA2Ny44JSk7XG4gIC0tc2wtY29sb3ItYmx1ZS01MDA6IGhzbCgyMTcuMiA5MS4yJSA1OS44JSk7XG4gIC0tc2wtY29sb3ItYmx1ZS02MDA6IGhzbCgyMjEuMiA4My4yJSA1My4zJSk7XG4gIC0tc2wtY29sb3ItYmx1ZS03MDA6IGhzbCgyMjQuMyA3Ni4zJSA0OCUpO1xuICAtLXNsLWNvbG9yLWJsdWUtODAwOiBoc2woMjI1LjkgNzAuNyUgNDAuMiUpO1xuICAtLXNsLWNvbG9yLWJsdWUtOTAwOiBoc2woMjI0LjQgNjQuMyUgMzIuOSUpO1xuICAtLXNsLWNvbG9yLWJsdWUtOTUwOiBoc2woMjI2LjIgNTUuMyUgMTguNCUpO1xuXG4gIC0tc2wtY29sb3ItaW5kaWdvLTUwOiBoc2woMjI1LjkgMTAwJSA5Ni43JSk7XG4gIC0tc2wtY29sb3ItaW5kaWdvLTEwMDogaHNsKDIyNi41IDEwMCUgOTMuOSUpO1xuICAtLXNsLWNvbG9yLWluZGlnby0yMDA6IGhzbCgyMjggOTYuNSUgODguOCUpO1xuICAtLXNsLWNvbG9yLWluZGlnby0zMDA6IGhzbCgyMjkuNyA5My41JSA4MS44JSk7XG4gIC0tc2wtY29sb3ItaW5kaWdvLTQwMDogaHNsKDIzNC41IDg5LjUlIDczLjklKTtcbiAgLS1zbC1jb2xvci1pbmRpZ28tNTAwOiBoc2woMjM4LjcgODMuNSUgNjYuNyUpO1xuICAtLXNsLWNvbG9yLWluZGlnby02MDA6IGhzbCgyNDMuNCA3NS40JSA1OC42JSk7XG4gIC0tc2wtY29sb3ItaW5kaWdvLTcwMDogaHNsKDI0NC41IDU3LjklIDUwLjYlKTtcbiAgLS1zbC1jb2xvci1pbmRpZ28tODAwOiBoc2woMjQzLjcgNTQuNSUgNDEuNCUpO1xuICAtLXNsLWNvbG9yLWluZGlnby05MDA6IGhzbCgyNDIuMiA0Ny40JSAzNC4zJSk7XG4gIC0tc2wtY29sb3ItaW5kaWdvLTk1MDogaHNsKDI0My41IDQzLjYlIDIyLjklKTtcblxuICAtLXNsLWNvbG9yLXZpb2xldC01MDogaHNsKDI1MCAxMDAlIDk3LjYlKTtcbiAgLS1zbC1jb2xvci12aW9sZXQtMTAwOiBoc2woMjUxLjQgOTEuMyUgOTUuNSUpO1xuICAtLXNsLWNvbG9yLXZpb2xldC0yMDA6IGhzbCgyNTAuNSA5NS4yJSA5MS44JSk7XG4gIC0tc2wtY29sb3ItdmlvbGV0LTMwMDogaHNsKDI1Mi41IDk0LjclIDg1LjElKTtcbiAgLS1zbC1jb2xvci12aW9sZXQtNDAwOiBoc2woMjU1LjEgOTEuNyUgNzYuMyUpO1xuICAtLXNsLWNvbG9yLXZpb2xldC01MDA6IGhzbCgyNTguMyA4OS41JSA2Ni4zJSk7XG4gIC0tc2wtY29sb3ItdmlvbGV0LTYwMDogaHNsKDI2Mi4xIDgzLjMlIDU3LjglKTtcbiAgLS1zbC1jb2xvci12aW9sZXQtNzAwOiBoc2woMjYzLjQgNzAlIDUwLjQlKTtcbiAgLS1zbC1jb2xvci12aW9sZXQtODAwOiBoc2woMjYzLjQgNjkuMyUgNDIuMiUpO1xuICAtLXNsLWNvbG9yLXZpb2xldC05MDA6IGhzbCgyNjMuNSA2Ny40JSAzNC45JSk7XG4gIC0tc2wtY29sb3ItdmlvbGV0LTk1MDogaHNsKDI2NS4xIDYxLjUlIDIxLjQlKTtcblxuICAtLXNsLWNvbG9yLXB1cnBsZS01MDogaHNsKDI3MCAxMDAlIDk4JSk7XG4gIC0tc2wtY29sb3ItcHVycGxlLTEwMDogaHNsKDI2OC43IDEwMCUgOTUuNSUpO1xuICAtLXNsLWNvbG9yLXB1cnBsZS0yMDA6IGhzbCgyNjguNiAxMDAlIDkxLjglKTtcbiAgLS1zbC1jb2xvci1wdXJwbGUtMzAwOiBoc2woMjY5LjIgOTcuNCUgODUuMSUpO1xuICAtLXNsLWNvbG9yLXB1cnBsZS00MDA6IGhzbCgyNzAgOTUuMiUgNzUuMyUpO1xuICAtLXNsLWNvbG9yLXB1cnBsZS01MDA6IGhzbCgyNzAuNyA5MSUgNjUuMSUpO1xuICAtLXNsLWNvbG9yLXB1cnBsZS02MDA6IGhzbCgyNzEuNSA4MS4zJSA1NS45JSk7XG4gIC0tc2wtY29sb3ItcHVycGxlLTcwMDogaHNsKDI3Mi4xIDcxLjclIDQ3LjElKTtcbiAgLS1zbC1jb2xvci1wdXJwbGUtODAwOiBoc2woMjcyLjkgNjcuMiUgMzkuNCUpO1xuICAtLXNsLWNvbG9yLXB1cnBsZS05MDA6IGhzbCgyNzMuNiA2NS42JSAzMiUpO1xuICAtLXNsLWNvbG9yLXB1cnBsZS05NTA6IGhzbCgyNzYgNTkuNSUgMTYuNSUpO1xuXG4gIC0tc2wtY29sb3ItZnVjaHNpYS01MDogaHNsKDI4OS4xIDEwMCUgOTcuOCUpO1xuICAtLXNsLWNvbG9yLWZ1Y2hzaWEtMTAwOiBoc2woMjg3IDEwMCUgOTUuNSUpO1xuICAtLXNsLWNvbG9yLWZ1Y2hzaWEtMjAwOiBoc2woMjg4LjMgOTUuOCUgOTAuNiUpO1xuICAtLXNsLWNvbG9yLWZ1Y2hzaWEtMzAwOiBoc2woMjkxLjEgOTMuMSUgODIuOSUpO1xuICAtLXNsLWNvbG9yLWZ1Y2hzaWEtNDAwOiBoc2woMjkyIDkxLjQlIDcyLjUlKTtcbiAgLS1zbC1jb2xvci1mdWNoc2lhLTUwMDogaHNsKDI5Mi4yIDg0LjElIDYwLjYlKTtcbiAgLS1zbC1jb2xvci1mdWNoc2lhLTYwMDogaHNsKDI5My40IDY5LjUlIDQ4LjglKTtcbiAgLS1zbC1jb2xvci1mdWNoc2lhLTcwMDogaHNsKDI5NC43IDcyLjQlIDM5LjglKTtcbiAgLS1zbC1jb2xvci1mdWNoc2lhLTgwMDogaHNsKDI5NS40IDcwLjIlIDMyLjklKTtcbiAgLS1zbC1jb2xvci1mdWNoc2lhLTkwMDogaHNsKDI5Ni43IDYzLjYlIDI4JSk7XG4gIC0tc2wtY29sb3ItZnVjaHNpYS05NTA6IGhzbCgyOTcuMSA1Ni44JSAxNC41JSk7XG5cbiAgLS1zbC1jb2xvci1waW5rLTUwOiBoc2woMzI3LjMgNzMuMyUgOTcuMSUpO1xuICAtLXNsLWNvbG9yLXBpbmstMTAwOiBoc2woMzI1LjcgNzcuOCUgOTQuNyUpO1xuICAtLXNsLWNvbG9yLXBpbmstMjAwOiBoc2woMzI1LjkgODQuNiUgODkuOCUpO1xuICAtLXNsLWNvbG9yLXBpbmstMzAwOiBoc2woMzI3LjQgODcuMSUgODEuOCUpO1xuICAtLXNsLWNvbG9yLXBpbmstNDAwOiBoc2woMzI4LjYgODUuNSUgNzAuMiUpO1xuICAtLXNsLWNvbG9yLXBpbmstNTAwOiBoc2woMzMwLjQgODEuMiUgNjAuNCUpO1xuICAtLXNsLWNvbG9yLXBpbmstNjAwOiBoc2woMzMzLjMgNzEuNCUgNTAuNiUpO1xuICAtLXNsLWNvbG9yLXBpbmstNzAwOiBoc2woMzM1LjEgNzcuNiUgNDIlKTtcbiAgLS1zbC1jb2xvci1waW5rLTgwMDogaHNsKDMzNS44IDc0LjQlIDM1LjMlKTtcbiAgLS1zbC1jb2xvci1waW5rLTkwMDogaHNsKDMzNS45IDY5JSAzMC40JSk7XG4gIC0tc2wtY29sb3ItcGluay05NTA6IGhzbCgzMzYuMiA2NS40JSAxNS45JSk7XG5cbiAgLS1zbC1jb2xvci1yb3NlLTUwOiBoc2woMzU1LjcgMTAwJSA5Ny4zJSk7XG4gIC0tc2wtY29sb3Itcm9zZS0xMDA6IGhzbCgzNTUuNiAxMDAlIDk0LjclKTtcbiAgLS1zbC1jb2xvci1yb3NlLTIwMDogaHNsKDM1Mi43IDk2LjElIDkwJSk7XG4gIC0tc2wtY29sb3Itcm9zZS0zMDA6IGhzbCgzNTIuNiA5NS43JSA4MS44JSk7XG4gIC0tc2wtY29sb3Itcm9zZS00MDA6IGhzbCgzNTEuMyA5NC41JSA3MS40JSk7XG4gIC0tc2wtY29sb3Itcm9zZS01MDA6IGhzbCgzNDkuNyA4OS4yJSA2MC4yJSk7XG4gIC0tc2wtY29sb3Itcm9zZS02MDA6IGhzbCgzNDYuOCA3Ny4yJSA0OS44JSk7XG4gIC0tc2wtY29sb3Itcm9zZS03MDA6IGhzbCgzNDUuMyA4Mi43JSA0MC44JSk7XG4gIC0tc2wtY29sb3Itcm9zZS04MDA6IGhzbCgzNDMuNCA3OS43JSAzNC43JSk7XG4gIC0tc2wtY29sb3Itcm9zZS05MDA6IGhzbCgzNDEuNSA3NS41JSAzMC40JSk7XG4gIC0tc2wtY29sb3Itcm9zZS05NTA6IGhzbCgzNDEuMyA3MC4xJSAxNy4xJSk7XG5cbiAgLS1zbC1jb2xvci1wcmltYXJ5LTUwOiB2YXIoLS1zbC1jb2xvci1za3ktNTApO1xuICAtLXNsLWNvbG9yLXByaW1hcnktMTAwOiB2YXIoLS1zbC1jb2xvci1za3ktMTAwKTtcbiAgLS1zbC1jb2xvci1wcmltYXJ5LTIwMDogdmFyKC0tc2wtY29sb3Itc2t5LTIwMCk7XG4gIC0tc2wtY29sb3ItcHJpbWFyeS0zMDA6IHZhcigtLXNsLWNvbG9yLXNreS0zMDApO1xuICAtLXNsLWNvbG9yLXByaW1hcnktNDAwOiB2YXIoLS1zbC1jb2xvci1za3ktNDAwKTtcbiAgLS1zbC1jb2xvci1wcmltYXJ5LTUwMDogdmFyKC0tc2wtY29sb3Itc2t5LTUwMCk7XG4gIC0tc2wtY29sb3ItcHJpbWFyeS02MDA6IHZhcigtLXNsLWNvbG9yLXNreS02MDApO1xuICAtLXNsLWNvbG9yLXByaW1hcnktNzAwOiB2YXIoLS1zbC1jb2xvci1za3ktNzAwKTtcbiAgLS1zbC1jb2xvci1wcmltYXJ5LTgwMDogdmFyKC0tc2wtY29sb3Itc2t5LTgwMCk7XG4gIC0tc2wtY29sb3ItcHJpbWFyeS05MDA6IHZhcigtLXNsLWNvbG9yLXNreS05MDApO1xuICAtLXNsLWNvbG9yLXByaW1hcnktOTUwOiB2YXIoLS1zbC1jb2xvci1za3ktOTUwKTtcblxuICAtLXNsLWNvbG9yLXN1Y2Nlc3MtNTA6IHZhcigtLXNsLWNvbG9yLWdyZWVuLTUwKTtcbiAgLS1zbC1jb2xvci1zdWNjZXNzLTEwMDogdmFyKC0tc2wtY29sb3ItZ3JlZW4tMTAwKTtcbiAgLS1zbC1jb2xvci1zdWNjZXNzLTIwMDogdmFyKC0tc2wtY29sb3ItZ3JlZW4tMjAwKTtcbiAgLS1zbC1jb2xvci1zdWNjZXNzLTMwMDogdmFyKC0tc2wtY29sb3ItZ3JlZW4tMzAwKTtcbiAgLS1zbC1jb2xvci1zdWNjZXNzLTQwMDogdmFyKC0tc2wtY29sb3ItZ3JlZW4tNDAwKTtcbiAgLS1zbC1jb2xvci1zdWNjZXNzLTUwMDogdmFyKC0tc2wtY29sb3ItZ3JlZW4tNTAwKTtcbiAgLS1zbC1jb2xvci1zdWNjZXNzLTYwMDogdmFyKC0tc2wtY29sb3ItZ3JlZW4tNjAwKTtcbiAgLS1zbC1jb2xvci1zdWNjZXNzLTcwMDogdmFyKC0tc2wtY29sb3ItZ3JlZW4tNzAwKTtcbiAgLS1zbC1jb2xvci1zdWNjZXNzLTgwMDogdmFyKC0tc2wtY29sb3ItZ3JlZW4tODAwKTtcbiAgLS1zbC1jb2xvci1zdWNjZXNzLTkwMDogdmFyKC0tc2wtY29sb3ItZ3JlZW4tOTAwKTtcbiAgLS1zbC1jb2xvci1zdWNjZXNzLTk1MDogdmFyKC0tc2wtY29sb3ItZ3JlZW4tOTUwKTtcblxuICAtLXNsLWNvbG9yLXdhcm5pbmctNTA6IHZhcigtLXNsLWNvbG9yLWFtYmVyLTUwKTtcbiAgLS1zbC1jb2xvci13YXJuaW5nLTEwMDogdmFyKC0tc2wtY29sb3ItYW1iZXItMTAwKTtcbiAgLS1zbC1jb2xvci13YXJuaW5nLTIwMDogdmFyKC0tc2wtY29sb3ItYW1iZXItMjAwKTtcbiAgLS1zbC1jb2xvci13YXJuaW5nLTMwMDogdmFyKC0tc2wtY29sb3ItYW1iZXItMzAwKTtcbiAgLS1zbC1jb2xvci13YXJuaW5nLTQwMDogdmFyKC0tc2wtY29sb3ItYW1iZXItNDAwKTtcbiAgLS1zbC1jb2xvci13YXJuaW5nLTUwMDogdmFyKC0tc2wtY29sb3ItYW1iZXItNTAwKTtcbiAgLS1zbC1jb2xvci13YXJuaW5nLTYwMDogdmFyKC0tc2wtY29sb3ItYW1iZXItNjAwKTtcbiAgLS1zbC1jb2xvci13YXJuaW5nLTcwMDogdmFyKC0tc2wtY29sb3ItYW1iZXItNzAwKTtcbiAgLS1zbC1jb2xvci13YXJuaW5nLTgwMDogdmFyKC0tc2wtY29sb3ItYW1iZXItODAwKTtcbiAgLS1zbC1jb2xvci13YXJuaW5nLTkwMDogdmFyKC0tc2wtY29sb3ItYW1iZXItOTAwKTtcbiAgLS1zbC1jb2xvci13YXJuaW5nLTk1MDogdmFyKC0tc2wtY29sb3ItYW1iZXItOTUwKTtcblxuICAtLXNsLWNvbG9yLWRhbmdlci01MDogdmFyKC0tc2wtY29sb3ItcmVkLTUwKTtcbiAgLS1zbC1jb2xvci1kYW5nZXItMTAwOiB2YXIoLS1zbC1jb2xvci1yZWQtMTAwKTtcbiAgLS1zbC1jb2xvci1kYW5nZXItMjAwOiB2YXIoLS1zbC1jb2xvci1yZWQtMjAwKTtcbiAgLS1zbC1jb2xvci1kYW5nZXItMzAwOiB2YXIoLS1zbC1jb2xvci1yZWQtMzAwKTtcbiAgLS1zbC1jb2xvci1kYW5nZXItNDAwOiB2YXIoLS1zbC1jb2xvci1yZWQtNDAwKTtcbiAgLS1zbC1jb2xvci1kYW5nZXItNTAwOiB2YXIoLS1zbC1jb2xvci1yZWQtNTAwKTtcbiAgLS1zbC1jb2xvci1kYW5nZXItNjAwOiB2YXIoLS1zbC1jb2xvci1yZWQtNjAwKTtcbiAgLS1zbC1jb2xvci1kYW5nZXItNzAwOiB2YXIoLS1zbC1jb2xvci1yZWQtNzAwKTtcbiAgLS1zbC1jb2xvci1kYW5nZXItODAwOiB2YXIoLS1zbC1jb2xvci1yZWQtODAwKTtcbiAgLS1zbC1jb2xvci1kYW5nZXItOTAwOiB2YXIoLS1zbC1jb2xvci1yZWQtOTAwKTtcbiAgLS1zbC1jb2xvci1kYW5nZXItOTUwOiB2YXIoLS1zbC1jb2xvci1yZWQtOTUwKTtcblxuICAtLXNsLWNvbG9yLW5ldXRyYWwtNTA6IHZhcigtLXNsLWNvbG9yLWdyYXktNTApO1xuICAtLXNsLWNvbG9yLW5ldXRyYWwtMTAwOiB2YXIoLS1zbC1jb2xvci1ncmF5LTEwMCk7XG4gIC0tc2wtY29sb3ItbmV1dHJhbC0yMDA6IHZhcigtLXNsLWNvbG9yLWdyYXktMjAwKTtcbiAgLS1zbC1jb2xvci1uZXV0cmFsLTMwMDogdmFyKC0tc2wtY29sb3ItZ3JheS0zMDApO1xuICAtLXNsLWNvbG9yLW5ldXRyYWwtNDAwOiB2YXIoLS1zbC1jb2xvci1ncmF5LTQwMCk7XG4gIC0tc2wtY29sb3ItbmV1dHJhbC01MDA6IHZhcigtLXNsLWNvbG9yLWdyYXktNTAwKTtcbiAgLS1zbC1jb2xvci1uZXV0cmFsLTYwMDogdmFyKC0tc2wtY29sb3ItZ3JheS02MDApO1xuICAtLXNsLWNvbG9yLW5ldXRyYWwtNzAwOiB2YXIoLS1zbC1jb2xvci1ncmF5LTcwMCk7XG4gIC0tc2wtY29sb3ItbmV1dHJhbC04MDA6IHZhcigtLXNsLWNvbG9yLWdyYXktODAwKTtcbiAgLS1zbC1jb2xvci1uZXV0cmFsLTkwMDogdmFyKC0tc2wtY29sb3ItZ3JheS05MDApO1xuICAtLXNsLWNvbG9yLW5ldXRyYWwtOTUwOiB2YXIoLS1zbC1jb2xvci1ncmF5LTk1MCk7XG5cbiAgLS1zbC1jb2xvci1uZXV0cmFsLTA6IGhzbCgwLCAwJSwgMTAwJSk7XG4gIC0tc2wtY29sb3ItbmV1dHJhbC0xMDAwOiBoc2woMCwgMCUsIDAlKTtcblxuICAtLXNsLWJvcmRlci1yYWRpdXMtc21hbGw6IDAuMTg3NXJlbTtcbiAgLS1zbC1ib3JkZXItcmFkaXVzLW1lZGl1bTogMC4yNXJlbTtcbiAgLS1zbC1ib3JkZXItcmFkaXVzLWxhcmdlOiAwLjVyZW07XG4gIC0tc2wtYm9yZGVyLXJhZGl1cy14LWxhcmdlOiAxcmVtO1xuXG4gIC0tc2wtYm9yZGVyLXJhZGl1cy1jaXJjbGU6IDUwJTtcbiAgLS1zbC1ib3JkZXItcmFkaXVzLXBpbGw6IDk5OTlweDtcblxuICAtLXNsLXNoYWRvdy14LXNtYWxsOiAwIDFweCAycHggaHNsKDI0MCAzLjglIDQ2LjElIC8gNiUpO1xuICAtLXNsLXNoYWRvdy1zbWFsbDogMCAxcHggMnB4IGhzbCgyNDAgMy44JSA0Ni4xJSAvIDEyJSk7XG4gIC0tc2wtc2hhZG93LW1lZGl1bTogMCAycHggNHB4IGhzbCgyNDAgMy44JSA0Ni4xJSAvIDEyJSk7XG4gIC0tc2wtc2hhZG93LWxhcmdlOiAwIDJweCA4cHggaHNsKDI0MCAzLjglIDQ2LjElIC8gMTIlKTtcbiAgLS1zbC1zaGFkb3cteC1sYXJnZTogMCA0cHggMTZweCBoc2woMjQwIDMuOCUgNDYuMSUgLyAxMiUpO1xuXG4gIC0tc2wtc3BhY2luZy0zeC1zbWFsbDogMC4xMjVyZW07XG4gIC0tc2wtc3BhY2luZy0yeC1zbWFsbDogMC4yNXJlbTtcbiAgLS1zbC1zcGFjaW5nLXgtc21hbGw6IDAuNXJlbTtcbiAgLS1zbC1zcGFjaW5nLXNtYWxsOiAwLjc1cmVtO1xuICAtLXNsLXNwYWNpbmctbWVkaXVtOiAxcmVtO1xuICAtLXNsLXNwYWNpbmctbGFyZ2U6IDEuMjVyZW07XG4gIC0tc2wtc3BhY2luZy14LWxhcmdlOiAxLjc1cmVtO1xuICAtLXNsLXNwYWNpbmctMngtbGFyZ2U6IDIuMjVyZW07XG4gIC0tc2wtc3BhY2luZy0zeC1sYXJnZTogM3JlbTtcbiAgLS1zbC1zcGFjaW5nLTR4LWxhcmdlOiA0LjVyZW07XG5cbiAgLS1zbC10cmFuc2l0aW9uLXgtc2xvdzogMTAwMG1zO1xuICAtLXNsLXRyYW5zaXRpb24tc2xvdzogNTAwbXM7XG4gIC0tc2wtdHJhbnNpdGlvbi1tZWRpdW06IDI1MG1zO1xuICAtLXNsLXRyYW5zaXRpb24tZmFzdDogMTUwbXM7XG4gIC0tc2wtdHJhbnNpdGlvbi14LWZhc3Q6IDUwbXM7XG5cbiAgLS1zbC1mb250LW1vbm86IFNGTW9uby1SZWd1bGFyLCBDb25zb2xhcywgXCJMaWJlcmF0aW9uIE1vbm9cIiwgTWVubG8sIG1vbm9zcGFjZTtcbiAgLS1zbC1mb250LXNhbnM6IC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgXCJTZWdvZSBVSVwiLCBSb2JvdG8sXG4gICAgSGVsdmV0aWNhLCBBcmlhbCwgc2Fucy1zZXJpZiwgXCJBcHBsZSBDb2xvciBFbW9qaVwiLCBcIlNlZ29lIFVJIEVtb2ppXCIsXG4gICAgXCJTZWdvZSBVSSBTeW1ib2xcIjtcbiAgLS1zbC1mb250LXNlcmlmOiBHZW9yZ2lhLCBcIlRpbWVzIE5ldyBSb21hblwiLCBzZXJpZjtcblxuICAtLXNsLWZvbnQtc2l6ZS0yeC1zbWFsbDogMC42MjVyZW07XG4gIC0tc2wtZm9udC1zaXplLXgtc21hbGw6IDAuNzVyZW07XG4gIC0tc2wtZm9udC1zaXplLXNtYWxsOiAwLjg3NXJlbTtcbiAgLS1zbC1mb250LXNpemUtbWVkaXVtOiAxcmVtO1xuICAtLXNsLWZvbnQtc2l6ZS1sYXJnZTogMS4yNXJlbTtcbiAgLS1zbC1mb250LXNpemUteC1sYXJnZTogMS41cmVtO1xuICAtLXNsLWZvbnQtc2l6ZS0yeC1sYXJnZTogMi4yNXJlbTtcbiAgLS1zbC1mb250LXNpemUtM3gtbGFyZ2U6IDNyZW07XG4gIC0tc2wtZm9udC1zaXplLTR4LWxhcmdlOiA0LjVyZW07XG5cbiAgLS1zbC1mb250LXdlaWdodC1saWdodDogMzAwO1xuICAtLXNsLWZvbnQtd2VpZ2h0LW5vcm1hbDogNDAwO1xuICAtLXNsLWZvbnQtd2VpZ2h0LXNlbWlib2xkOiA1MDA7XG4gIC0tc2wtZm9udC13ZWlnaHQtYm9sZDogNzAwO1xuXG4gIC0tc2wtbGV0dGVyLXNwYWNpbmctZGVuc2VyOiAtMC4wM2VtO1xuICAtLXNsLWxldHRlci1zcGFjaW5nLWRlbnNlOiAtMC4wMTVlbTtcbiAgLS1zbC1sZXR0ZXItc3BhY2luZy1ub3JtYWw6IG5vcm1hbDtcbiAgLS1zbC1sZXR0ZXItc3BhY2luZy1sb29zZTogMC4wNzVlbTtcbiAgLS1zbC1sZXR0ZXItc3BhY2luZy1sb29zZXI6IDAuMTVlbTtcblxuICAtLXNsLWxpbmUtaGVpZ2h0LWRlbnNlcjogMTtcbiAgLS1zbC1saW5lLWhlaWdodC1kZW5zZTogMS40O1xuICAtLXNsLWxpbmUtaGVpZ2h0LW5vcm1hbDogMS44O1xuICAtLXNsLWxpbmUtaGVpZ2h0LWxvb3NlOiAyLjI7XG4gIC0tc2wtbGluZS1oZWlnaHQtbG9vc2VyOiAyLjY7XG5cbiAgLS1zbC1mb2N1cy1yaW5nLWNvbG9yOiB2YXIoLS1zbC1jb2xvci1wcmltYXJ5LTYwMCk7XG4gIC0tc2wtZm9jdXMtcmluZy1zdHlsZTogc29saWQ7XG4gIC0tc2wtZm9jdXMtcmluZy13aWR0aDogM3B4O1xuICAtLXNsLWZvY3VzLXJpbmc6IHZhcigtLXNsLWZvY3VzLXJpbmctc3R5bGUpIHZhcigtLXNsLWZvY3VzLXJpbmctd2lkdGgpXG4gICAgdmFyKC0tc2wtZm9jdXMtcmluZy1jb2xvcik7XG4gIC0tc2wtZm9jdXMtcmluZy1vZmZzZXQ6IDFweDtcblxuICAtLXNsLWJ1dHRvbi1mb250LXNpemUtc21hbGw6IHZhcigtLXNsLWZvbnQtc2l6ZS14LXNtYWxsKTtcbiAgLS1zbC1idXR0b24tZm9udC1zaXplLW1lZGl1bTogdmFyKC0tc2wtZm9udC1zaXplLXNtYWxsKTtcbiAgLS1zbC1idXR0b24tZm9udC1zaXplLWxhcmdlOiB2YXIoLS1zbC1mb250LXNpemUtbWVkaXVtKTtcblxuICAtLXNsLWlucHV0LWhlaWdodC1zbWFsbDogMS44NzVyZW07XG4gIC0tc2wtaW5wdXQtaGVpZ2h0LW1lZGl1bTogMi41cmVtO1xuICAtLXNsLWlucHV0LWhlaWdodC1sYXJnZTogMy4xMjVyZW07XG5cbiAgLS1zbC1pbnB1dC1iYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1zbC1jb2xvci1uZXV0cmFsLTApO1xuICAtLXNsLWlucHV0LWJhY2tncm91bmQtY29sb3ItaG92ZXI6IHZhcigtLXNsLWlucHV0LWJhY2tncm91bmQtY29sb3IpO1xuICAtLXNsLWlucHV0LWJhY2tncm91bmQtY29sb3ItZm9jdXM6IHZhcigtLXNsLWlucHV0LWJhY2tncm91bmQtY29sb3IpO1xuICAtLXNsLWlucHV0LWJhY2tncm91bmQtY29sb3ItZGlzYWJsZWQ6IHZhcigtLXNsLWNvbG9yLW5ldXRyYWwtMTAwKTtcbiAgLS1zbC1pbnB1dC1ib3JkZXItY29sb3I6IHZhcigtLXNsLWNvbG9yLW5ldXRyYWwtMzAwKTtcbiAgLS1zbC1pbnB1dC1ib3JkZXItY29sb3ItaG92ZXI6IHZhcigtLXNsLWNvbG9yLW5ldXRyYWwtNDAwKTtcbiAgLS1zbC1pbnB1dC1ib3JkZXItY29sb3ItZm9jdXM6IHZhcigtLXNsLWNvbG9yLXByaW1hcnktNTAwKTtcbiAgLS1zbC1pbnB1dC1ib3JkZXItY29sb3ItZGlzYWJsZWQ6IHZhcigtLXNsLWNvbG9yLW5ldXRyYWwtMzAwKTtcbiAgLS1zbC1pbnB1dC1ib3JkZXItd2lkdGg6IDFweDtcbiAgLS1zbC1pbnB1dC1yZXF1aXJlZC1jb250ZW50OiBcIipcIjtcbiAgLS1zbC1pbnB1dC1yZXF1aXJlZC1jb250ZW50LW9mZnNldDogLTJweDtcbiAgLS1zbC1pbnB1dC1yZXF1aXJlZC1jb250ZW50LWNvbG9yOiB2YXIoLS1zbC1pbnB1dC1sYWJlbC1jb2xvcik7XG5cbiAgLS1zbC1pbnB1dC1ib3JkZXItcmFkaXVzLXNtYWxsOiB2YXIoLS1zbC1ib3JkZXItcmFkaXVzLW1lZGl1bSk7XG4gIC0tc2wtaW5wdXQtYm9yZGVyLXJhZGl1cy1tZWRpdW06IHZhcigtLXNsLWJvcmRlci1yYWRpdXMtbWVkaXVtKTtcbiAgLS1zbC1pbnB1dC1ib3JkZXItcmFkaXVzLWxhcmdlOiB2YXIoLS1zbC1ib3JkZXItcmFkaXVzLW1lZGl1bSk7XG5cbiAgLS1zbC1pbnB1dC1mb250LWZhbWlseTogdmFyKC0tc2wtZm9udC1zYW5zKTtcbiAgLS1zbC1pbnB1dC1mb250LXdlaWdodDogdmFyKC0tc2wtZm9udC13ZWlnaHQtbm9ybWFsKTtcbiAgLS1zbC1pbnB1dC1mb250LXNpemUtc21hbGw6IHZhcigtLXNsLWZvbnQtc2l6ZS1zbWFsbCk7XG4gIC0tc2wtaW5wdXQtZm9udC1zaXplLW1lZGl1bTogdmFyKC0tc2wtZm9udC1zaXplLW1lZGl1bSk7XG4gIC0tc2wtaW5wdXQtZm9udC1zaXplLWxhcmdlOiB2YXIoLS1zbC1mb250LXNpemUtbGFyZ2UpO1xuICAtLXNsLWlucHV0LWxldHRlci1zcGFjaW5nOiB2YXIoLS1zbC1sZXR0ZXItc3BhY2luZy1ub3JtYWwpO1xuXG4gIC0tc2wtaW5wdXQtY29sb3I6IHZhcigtLXNsLWNvbG9yLW5ldXRyYWwtNzAwKTtcbiAgLS1zbC1pbnB1dC1jb2xvci1ob3ZlcjogdmFyKC0tc2wtY29sb3ItbmV1dHJhbC03MDApO1xuICAtLXNsLWlucHV0LWNvbG9yLWZvY3VzOiB2YXIoLS1zbC1jb2xvci1uZXV0cmFsLTcwMCk7XG4gIC0tc2wtaW5wdXQtY29sb3ItZGlzYWJsZWQ6IHZhcigtLXNsLWNvbG9yLW5ldXRyYWwtOTAwKTtcbiAgLS1zbC1pbnB1dC1pY29uLWNvbG9yOiB2YXIoLS1zbC1jb2xvci1uZXV0cmFsLTUwMCk7XG4gIC0tc2wtaW5wdXQtaWNvbi1jb2xvci1ob3ZlcjogdmFyKC0tc2wtY29sb3ItbmV1dHJhbC02MDApO1xuICAtLXNsLWlucHV0LWljb24tY29sb3ItZm9jdXM6IHZhcigtLXNsLWNvbG9yLW5ldXRyYWwtNjAwKTtcbiAgLS1zbC1pbnB1dC1wbGFjZWhvbGRlci1jb2xvcjogdmFyKC0tc2wtY29sb3ItbmV1dHJhbC01MDApO1xuICAtLXNsLWlucHV0LXBsYWNlaG9sZGVyLWNvbG9yLWRpc2FibGVkOiB2YXIoLS1zbC1jb2xvci1uZXV0cmFsLTYwMCk7XG4gIC0tc2wtaW5wdXQtc3BhY2luZy1zbWFsbDogdmFyKC0tc2wtc3BhY2luZy1zbWFsbCk7XG4gIC0tc2wtaW5wdXQtc3BhY2luZy1tZWRpdW06IHZhcigtLXNsLXNwYWNpbmctbWVkaXVtKTtcbiAgLS1zbC1pbnB1dC1zcGFjaW5nLWxhcmdlOiB2YXIoLS1zbC1zcGFjaW5nLWxhcmdlKTtcblxuICAtLXNsLWlucHV0LWZvY3VzLXJpbmctY29sb3I6IGhzbCgxOTguNiA4OC43JSA0OC40JSAvIDQwJSk7XG4gIC0tc2wtaW5wdXQtZm9jdXMtcmluZy1vZmZzZXQ6IDA7XG5cbiAgLS1zbC1pbnB1dC1maWxsZWQtYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tc2wtY29sb3ItbmV1dHJhbC0xMDApO1xuICAtLXNsLWlucHV0LWZpbGxlZC1iYWNrZ3JvdW5kLWNvbG9yLWhvdmVyOiB2YXIoLS1zbC1jb2xvci1uZXV0cmFsLTEwMCk7XG4gIC0tc2wtaW5wdXQtZmlsbGVkLWJhY2tncm91bmQtY29sb3ItZm9jdXM6IHZhcigtLXNsLWNvbG9yLW5ldXRyYWwtMTAwKTtcbiAgLS1zbC1pbnB1dC1maWxsZWQtYmFja2dyb3VuZC1jb2xvci1kaXNhYmxlZDogdmFyKC0tc2wtY29sb3ItbmV1dHJhbC0xMDApO1xuICAtLXNsLWlucHV0LWZpbGxlZC1jb2xvcjogdmFyKC0tc2wtY29sb3ItbmV1dHJhbC04MDApO1xuICAtLXNsLWlucHV0LWZpbGxlZC1jb2xvci1ob3ZlcjogdmFyKC0tc2wtY29sb3ItbmV1dHJhbC04MDApO1xuICAtLXNsLWlucHV0LWZpbGxlZC1jb2xvci1mb2N1czogdmFyKC0tc2wtY29sb3ItbmV1dHJhbC03MDApO1xuICAtLXNsLWlucHV0LWZpbGxlZC1jb2xvci1kaXNhYmxlZDogdmFyKC0tc2wtY29sb3ItbmV1dHJhbC04MDApO1xuXG4gIC0tc2wtaW5wdXQtbGFiZWwtZm9udC1zaXplLXNtYWxsOiB2YXIoLS1zbC1mb250LXNpemUtc21hbGwpO1xuICAtLXNsLWlucHV0LWxhYmVsLWZvbnQtc2l6ZS1tZWRpdW06IHZhcigtLXNsLWZvbnQtc2l6ZS1tZWRpdW0pO1xuICAtLXNsLWlucHV0LWxhYmVsLWZvbnQtc2l6ZS1sYXJnZTogdmFyKC0tc2wtZm9udC1zaXplLWxhcmdlKTtcbiAgLS1zbC1pbnB1dC1sYWJlbC1jb2xvcjogaW5oZXJpdDtcblxuICAtLXNsLWlucHV0LWhlbHAtdGV4dC1mb250LXNpemUtc21hbGw6IHZhcigtLXNsLWZvbnQtc2l6ZS14LXNtYWxsKTtcbiAgLS1zbC1pbnB1dC1oZWxwLXRleHQtZm9udC1zaXplLW1lZGl1bTogdmFyKC0tc2wtZm9udC1zaXplLXNtYWxsKTtcbiAgLS1zbC1pbnB1dC1oZWxwLXRleHQtZm9udC1zaXplLWxhcmdlOiB2YXIoLS1zbC1mb250LXNpemUtbWVkaXVtKTtcbiAgLS1zbC1pbnB1dC1oZWxwLXRleHQtY29sb3I6IHZhcigtLXNsLWNvbG9yLW5ldXRyYWwtNTAwKTtcblxuICAtLXNsLXRvZ2dsZS1zaXplLXNtYWxsOiAwLjg3NXJlbTtcbiAgLS1zbC10b2dnbGUtc2l6ZS1tZWRpdW06IDEuMTI1cmVtO1xuICAtLXNsLXRvZ2dsZS1zaXplLWxhcmdlOiAxLjM3NXJlbTtcblxuICAtLXNsLW92ZXJsYXktYmFja2dyb3VuZC1jb2xvcjogaHNsKDI0MCAzLjglIDQ2LjElIC8gMzMlKTtcblxuICAtLXNsLXBhbmVsLWJhY2tncm91bmQtY29sb3I6IHZhcigtLXNsLWNvbG9yLW5ldXRyYWwtMCk7XG4gIC0tc2wtcGFuZWwtYm9yZGVyLWNvbG9yOiB2YXIoLS1zbC1jb2xvci1uZXV0cmFsLTIwMCk7XG4gIC0tc2wtcGFuZWwtYm9yZGVyLXdpZHRoOiAxcHg7XG5cbiAgLS1zbC10b29sdGlwLWJvcmRlci1yYWRpdXM6IHZhcigtLXNsLWJvcmRlci1yYWRpdXMtbWVkaXVtKTtcbiAgLS1zbC10b29sdGlwLWJhY2tncm91bmQtY29sb3I6IHZhcigtLXNsLWNvbG9yLW5ldXRyYWwtODAwKTtcbiAgLS1zbC10b29sdGlwLWNvbG9yOiB2YXIoLS1zbC1jb2xvci1uZXV0cmFsLTApO1xuICAtLXNsLXRvb2x0aXAtZm9udC1mYW1pbHk6IHZhcigtLXNsLWZvbnQtc2Fucyk7XG4gIC0tc2wtdG9vbHRpcC1mb250LXdlaWdodDogdmFyKC0tc2wtZm9udC13ZWlnaHQtbm9ybWFsKTtcbiAgLS1zbC10b29sdGlwLWZvbnQtc2l6ZTogdmFyKC0tc2wtZm9udC1zaXplLXNtYWxsKTtcbiAgLS1zbC10b29sdGlwLWxpbmUtaGVpZ2h0OiB2YXIoLS1zbC1saW5lLWhlaWdodC1kZW5zZSk7XG4gIC0tc2wtdG9vbHRpcC1wYWRkaW5nOiB2YXIoLS1zbC1zcGFjaW5nLTJ4LXNtYWxsKSB2YXIoLS1zbC1zcGFjaW5nLXgtc21hbGwpO1xuICAtLXNsLXRvb2x0aXAtYXJyb3ctc2l6ZTogNnB4O1xuXG4gIC0tc2wtei1pbmRleC1kcmF3ZXI6IDk5OTcwMDtcbiAgLS1zbC16LWluZGV4LWRpYWxvZzogOTk5ODAwO1xuICAtLXNsLXotaW5kZXgtZHJvcGRvd246IDk5OTkwMDtcbiAgLS1zbC16LWluZGV4LXRvYXN0OiA5OTk5NTA7XG4gIC0tc2wtei1pbmRleC10b29sdGlwOiA5OTkxMDAwO1xufVxuXG4uc2wtc2Nyb2xsLWxvY2sge1xuICBwYWRkaW5nLXJpZ2h0OiB2YXIoLS1zbC1zY3JvbGwtbG9jay1zaXplKSAhaW1wb3J0YW50O1xuICBvdmVyZmxvdzogaGlkZGVuICFpbXBvcnRhbnQ7XG59XG5cbi5zbC10b2FzdC1zdGFjayB7XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgdG9wOiAwO1xuICBpbnNldC1pbmxpbmUtZW5kOiAwO1xuICB6LWluZGV4OiB2YXIoLS1zbC16LWluZGV4LXRvYXN0KTtcbiAgd2lkdGg6IDI4cmVtO1xuICBtYXgtd2lkdGg6IDEwMCU7XG4gIG1heC1oZWlnaHQ6IDEwMCU7XG4gIG92ZXJmbG93OiBhdXRvO1xufVxuXG4uc2wtdG9hc3Qtc3RhY2sgc2wtYWxlcnQge1xuICBtYXJnaW46IHZhcigtLXNsLXNwYWNpbmctbWVkaXVtKTtcbn1cblxuLnNsLXRvYXN0LXN0YWNrIHNsLWFsZXJ0OjpwYXJ0KGJhc2UpIHtcbiAgYm94LXNoYWRvdzogdmFyKC0tc2wtc2hhZG93LWxhcmdlKTtcbn1cblxuc2wtZHJhd2VyOjpwYXJ0KGJhc2UpIHtcbiAgY29sb3I6IHZhcigtLXNsLWNvbG9yLW5ldXRyYWwtODAwKSAhaW1wb3J0YW50O1xufVxuXG4uaDVwbGF5ZXItcG9wdXAtd3JhcCB7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgei1pbmRleDogOTk5OTk5OTk7XG4gIG9wYWNpdHk6IDA7XG59XG5cbi5oNXBsYXllci1wb3B1cC13cmFwIHNsLXBvcHVwIHtcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xufVxuXG4uaDVwbGF5ZXItcG9wdXAtd3JhcCAuaDVwbGF5ZXItcG9wdXAtY29udGVudCB7XG4gIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC45KTtcbiAgY29sb3I6ICNmZmY7XG4gIGZvbnQtc2l6ZTogMTZweDtcbiAgbWluLXdpZHRoOiAyMjBweDtcbiAgaGVpZ2h0OiA0OHB4O1xuICBsaW5lLWhlaWdodDogNDhweDtcbiAgZGlzcGxheTogZmxleDtcbiAgcGFkZGluZzogMCAxNnB4O1xuICBib3JkZXItcmFkaXVzOiA2cHggNnB4IDAgMDtcbiAgYm9yZGVyLWJvdHRvbTogMnB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTtcblxuICAvKiDngbDoibLlkJHkuIvnmoTov4fluqbpmLTlvbEgKi9cbiAgYm94LXNoYWRvdzogMCA2cHggMTRweCByZ2JhKDAsIDAsIDAsIDAuNyk7XG5cbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xufVxuXG5Aa2V5ZnJhbWVzIHRleHQtbHVtb3Mge1xuICAwJSwxMDAleyBjb2xvcjojZmZmOyB9XG5cdDUwJXsgY29sb3I6I2NjYzsgfVxufVxuXG4uaDVwbGF5ZXItcG9wdXAtY29udGVudCAuaDVwLWxvZ28tbW9kIHtcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgZm9udC13ZWlnaHQ6IDUwMDtcbiAgdGV4dC1zaGFkb3c6IDBweCAwcHggMnB4ICM2NjYsIDAgMCAzMHB4ICM2NjY7XG4gIGFuaW1hdGlvbjogdGV4dC1sdW1vcyA1cyBpbmZpbml0ZTtcbn1cblxuLmg1cGxheWVyLXBvcHVwLWNvbnRlbnQgLmg1cC1tZW51LXdyYXAge31cblxuLmg1cGxheWVyLXBvcHVwLWNvbnRlbnQgLmg1cC1hY3Rpb24tbW9kIHtcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xufVxuXG4uaDVwbGF5ZXItcG9wdXAtY29udGVudCAuaDVwLWFjdGlvbi1idG4ge1xuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgZm9udC1zaXplOiAxNHB4O1xuICBwYWRkaW5nOiAwIDhweDtcbiAgY3Vyc29yOiBwb2ludGVyO1xuICB3aGl0ZS1zcGFjZTogbm93cmFwO1xufVxuXG4uaDVwbGF5ZXItcG9wdXAtY29udGVudCAuaDVwLWFjdGlvbi1idG46aG92ZXIge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMik7XG59XG5cbi5oNXBsYXllci1wb3B1cC1jb250ZW50IC5oNXAtYWN0aW9uLWJ0biBzbC1pY29uIHtcbiAgcGFkZGluZzogMCA0cHg7XG59XG5cbi8qIOa/gOa0u+aAgSAqL1xuLmg1cGxheWVyLXBvcHVwLWFjdGl2ZSB7XG4gIG9wYWNpdHk6IDAuODtcbiAgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjJzO1xufVxuXG4uaDVwbGF5ZXItcG9wdXAtY29udGVudCBhLCAuaDVwbGF5ZXItcG9wdXAtY29udGVudCBhOnZpc2l0ZWR7XG4gIGNvbG9yOiAjZmZmO1xuICBjdXJzb3I6IHBvaW50ZXI7XG4gIHRleHQtZGVjb3JhdGlvbjogbm9uZTtcbn1cblxuLmg1cGxheWVyLXBvcHVwLXdyYXA6aG92ZXIsIC5oNXBsYXllci1wb3B1cC1mdWxsLWFjdGl2ZSB7XG4gIG9wYWNpdHk6IDEgIWltcG9ydGFudDtcbiAgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjJzO1xufVxuXG4uaDVwbGF5ZXItcG9wdXAtd3JhcDpob3ZlciAuaDVwbGF5ZXItcG9wdXAtY29udGVudCwgLmg1cGxheWVyLXBvcHVwLWZ1bGwtYWN0aXZlIC5oNXBsYXllci1wb3B1cC1jb250ZW50IHtcbiAgYm9yZGVyLWJvdHRvbTogMnB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC42KTtcbn1cblxuLmg1cGxheWVyLXBvcHVwLWNvbnRlbnQgLmg1cC1hY3Rpb24tbW9kIHNsLW1lbnUge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuOSk7XG4gIGNvbG9yOiAjZmZmO1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIHBhZGRpbmc6IDVweCAwO1xufVxuXG4uaDVwbGF5ZXItcG9wdXAtY29udGVudCAuaDVwLWFjdGlvbi1tb2Qgc2wtbWVudS1pdGVtOjpwYXJ0KGJhc2UpIHtcbiAgLyogYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjkpOyAqL1xuICBjb2xvcjogI2ZmZjtcbiAgZm9udC1zaXplOiAxNHB4O1xuICBwYWRkaW5nOiAycHggMDtcbn1cblxuLmg1cGxheWVyLXBvcHVwLWNvbnRlbnQgLmg1cC1hY3Rpb24tbW9kIHNsLW1lbnUtaXRlbTo6cGFydChiYXNlKTpob3ZlciB7XG4gIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXNsLWNvbG9yLXByaW1hcnktNTAwKTtcbiAgY29sb3I6ICNmZmY7XG59XG5cbi5oNXBsYXllci1wb3B1cC1jb250ZW50IC5oNXAtcmVjb21tZW5kLXdyYXAge1xuICBmbGV4LWdyb3c6IDE7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIG1hcmdpbjogMCAyMHB4O1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gIGZvbnQtc2l6ZTogMTRweDtcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcblxuICBkaXNwbGF5OiBmbGV4O1xuICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kO1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBwb3NpdGlvbjogcmVsYXRpdmU7XG59XG5cbkBrZXlmcmFtZXMgdGV4dC1tYXJxdWVlIHtcbiAgMCUgeyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMCk7IH1cbiAgMTAwJSB7IHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtMTAwJSk7IH1cbn1cblxuLmg1cGxheWVyLXBvcHVwLWNvbnRlbnQgLmg1cC1yZWNvbW1lbmQtbW9kIHtcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICB3b3JkLWJyZWFrOiBrZWVwLWFsbDtcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgLyog5peg6ZmQ5b6q546v5rua5Yqo55qE5Yqo55S75pWI5p6cICovXG4gIC8qIHBhZGRpbmctbGVmdDogMTAwJTsgKi9cbiAgLyogYW5pbWF0aW9uOiB0ZXh0LW1hcnF1ZWUgMTVzIGxpbmVhciBpbmZpbml0ZTsgKi9cbn1cbi5oNXBsYXllci1wb3B1cC1jb250ZW50IC5oNXAtcmVjb21tZW5kLWl0ZW0ge1xuICB3b3JkLWJyZWFrOiBrZWVwLWFsbDtcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcblxuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogMDtcbiAgcmlnaHQ6IDA7XG4gIHBvaW50ZXItZXZlbnRzOiBub25lO1xuICBvcGFjaXR5OiAwO1xuICB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuNHM7XG59XG5cbi5oNXBsYXllci1wb3B1cC1jb250ZW50IC5oNXAtcmVjb21tZW5kLWl0ZW1fX2FjdGl2ZSB7XG4gIG9wYWNpdHk6IDE7XG4gIHotaW5kZXg6IDk5O1xuICBwb2ludGVyLWV2ZW50czogYXV0bztcbn1cblxuLmg1cGxheWVyLXBvcHVwLWNvbnRlbnQgLmg1cC1yZWNvbW1lbmQtd3JhcD5kaXYge1xuICBvcGFjaXR5OiAwLjU7XG59XG4uaDVwbGF5ZXItcG9wdXAtY29udGVudCAuaDVwLXJlY29tbWVuZC13cmFwPmRpdjpob3ZlcntcbiAgb3BhY2l0eTogMTtcbn1cbi5oNXBsYXllci1wb3B1cC1jb250ZW50IC5oNXAtcmVjb21tZW5kLXdyYXA+ZGl2OmhvdmVyIC5oNXAtcmVjb21tZW5kLW1vZCB7XG4gIGFuaW1hdGlvbi1wbGF5LXN0YXRlOiBwYXVzZWQ7XG59Iik7CgogIC8qKgogICAqIEBsaWNlbnNlCiAgICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQwogICAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBCU0QtMy1DbGF1c2UKICAgKi8KICBjb25zdCB0JDI9Z2xvYmFsVGhpcyxlJDg9dCQyLlNoYWRvd1Jvb3QmJih2b2lkIDA9PT10JDIuU2hhZHlDU1N8fHQkMi5TaGFkeUNTUy5uYXRpdmVTaGFkb3cpJiYiYWRvcHRlZFN0eWxlU2hlZXRzImluIERvY3VtZW50LnByb3RvdHlwZSYmInJlcGxhY2UiaW4gQ1NTU3R5bGVTaGVldC5wcm90b3R5cGUscyQzPVN5bWJvbCgpLG8kNT1uZXcgV2Vha01hcDtsZXQgbiQ1ID0gY2xhc3Mgbntjb25zdHJ1Y3Rvcih0LGUsbyl7aWYodGhpcy5fJGNzc1Jlc3VsdCQ9ITAsbyE9PXMkMyl0aHJvdyBFcnJvcigiQ1NTUmVzdWx0IGlzIG5vdCBjb25zdHJ1Y3RhYmxlLiBVc2UgYHVuc2FmZUNTU2Agb3IgYGNzc2AgaW5zdGVhZC4iKTt0aGlzLmNzc1RleHQ9dCx0aGlzLnQ9ZTt9Z2V0IHN0eWxlU2hlZXQoKXtsZXQgdD10aGlzLm87Y29uc3Qgcz10aGlzLnQ7aWYoZSQ4JiZ2b2lkIDA9PT10KXtjb25zdCBlPXZvaWQgMCE9PXMmJjE9PT1zLmxlbmd0aDtlJiYodD1vJDUuZ2V0KHMpKSx2b2lkIDA9PT10JiYoKHRoaXMubz10PW5ldyBDU1NTdHlsZVNoZWV0KS5yZXBsYWNlU3luYyh0aGlzLmNzc1RleHQpLGUmJm8kNS5zZXQocyx0KSk7fXJldHVybiB0fXRvU3RyaW5nKCl7cmV0dXJuIHRoaXMuY3NzVGV4dH19O2NvbnN0IHIkNj10PT5uZXcgbiQ1KCJzdHJpbmciPT10eXBlb2YgdD90OnQrIiIsdm9pZCAwLHMkMyksaSQzPSh0LC4uLmUpPT57Y29uc3Qgbz0xPT09dC5sZW5ndGg/dFswXTplLnJlZHVjZSgoKGUscyxvKT0+ZSsodD0+e2lmKCEwPT09dC5fJGNzc1Jlc3VsdCQpcmV0dXJuIHQuY3NzVGV4dDtpZigibnVtYmVyIj09dHlwZW9mIHQpcmV0dXJuIHQ7dGhyb3cgRXJyb3IoIlZhbHVlIHBhc3NlZCB0byAnY3NzJyBmdW5jdGlvbiBtdXN0IGJlIGEgJ2NzcycgZnVuY3Rpb24gcmVzdWx0OiAiK3QrIi4gVXNlICd1bnNhZmVDU1MnIHRvIHBhc3Mgbm9uLWxpdGVyYWwgdmFsdWVzLCBidXQgdGFrZSBjYXJlIHRvIGVuc3VyZSBwYWdlIHNlY3VyaXR5LiIpfSkocykrdFtvKzFdKSx0WzBdKTtyZXR1cm4gbmV3IG4kNShvLHQscyQzKX0sUyQxPShzLG8pPT57aWYoZSQ4KXMuYWRvcHRlZFN0eWxlU2hlZXRzPW8ubWFwKCh0PT50IGluc3RhbmNlb2YgQ1NTU3R5bGVTaGVldD90OnQuc3R5bGVTaGVldCkpO2Vsc2UgZm9yKGNvbnN0IGUgb2Ygbyl7Y29uc3Qgbz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzdHlsZSIpLG49dCQyLmxpdE5vbmNlO3ZvaWQgMCE9PW4mJm8uc2V0QXR0cmlidXRlKCJub25jZSIsbiksby50ZXh0Q29udGVudD1lLmNzc1RleHQscy5hcHBlbmRDaGlsZChvKTt9fSxjJDM9ZSQ4P3Q9PnQ6dD0+dCBpbnN0YW5jZW9mIENTU1N0eWxlU2hlZXQ/KHQ9PntsZXQgZT0iIjtmb3IoY29uc3QgcyBvZiB0LmNzc1J1bGVzKWUrPXMuY3NzVGV4dDtyZXR1cm4gciQ2KGUpfSkodCk6dDsKCiAgLyoqCiAgICogQGxpY2Vuc2UKICAgKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDCiAgICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEJTRC0zLUNsYXVzZQogICAqL2NvbnN0e2lzOmkkMixkZWZpbmVQcm9wZXJ0eTplJDcsZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOnIkNSxnZXRPd25Qcm9wZXJ0eU5hbWVzOmgkMyxnZXRPd25Qcm9wZXJ0eVN5bWJvbHM6byQ0LGdldFByb3RvdHlwZU9mOm4kNH09T2JqZWN0LGEkMT1nbG9iYWxUaGlzLGMkMj1hJDEudHJ1c3RlZFR5cGVzLGwkMT1jJDI/YyQyLmVtcHR5U2NyaXB0OiIiLHAkMT1hJDEucmVhY3RpdmVFbGVtZW50UG9seWZpbGxTdXBwb3J0LGQkMT0odCxzKT0+dCx1JDE9e3RvQXR0cmlidXRlKHQscyl7c3dpdGNoKHMpe2Nhc2UgQm9vbGVhbjp0PXQ/bCQxOm51bGw7YnJlYWs7Y2FzZSBPYmplY3Q6Y2FzZSBBcnJheTp0PW51bGw9PXQ/dDpKU09OLnN0cmluZ2lmeSh0KTt9cmV0dXJuIHR9LGZyb21BdHRyaWJ1dGUodCxzKXtsZXQgaT10O3N3aXRjaChzKXtjYXNlIEJvb2xlYW46aT1udWxsIT09dDticmVhaztjYXNlIE51bWJlcjppPW51bGw9PT10P251bGw6TnVtYmVyKHQpO2JyZWFrO2Nhc2UgT2JqZWN0OmNhc2UgQXJyYXk6dHJ5e2k9SlNPTi5wYXJzZSh0KTt9Y2F0Y2godCl7aT1udWxsO319cmV0dXJuIGl9fSxmJDM9KHQscyk9PiFpJDIodCxzKSx5JDE9e2F0dHJpYnV0ZTohMCx0eXBlOlN0cmluZyxjb252ZXJ0ZXI6dSQxLHJlZmxlY3Q6ITEsaGFzQ2hhbmdlZDpmJDN9O1N5bWJvbC5tZXRhZGF0YT8/PVN5bWJvbCgibWV0YWRhdGEiKSxhJDEubGl0UHJvcGVydHlNZXRhZGF0YT8/PW5ldyBXZWFrTWFwO2NsYXNzIGIgZXh0ZW5kcyBIVE1MRWxlbWVudHtzdGF0aWMgYWRkSW5pdGlhbGl6ZXIodCl7dGhpcy5fJEVpKCksKHRoaXMubD8/PVtdKS5wdXNoKHQpO31zdGF0aWMgZ2V0IG9ic2VydmVkQXR0cmlidXRlcygpe3JldHVybiB0aGlzLmZpbmFsaXplKCksdGhpcy5fJEVoJiZbLi4udGhpcy5fJEVoLmtleXMoKV19c3RhdGljIGNyZWF0ZVByb3BlcnR5KHQscz15JDEpe2lmKHMuc3RhdGUmJihzLmF0dHJpYnV0ZT0hMSksdGhpcy5fJEVpKCksdGhpcy5lbGVtZW50UHJvcGVydGllcy5zZXQodCxzKSwhcy5ub0FjY2Vzc29yKXtjb25zdCBpPVN5bWJvbCgpLHI9dGhpcy5nZXRQcm9wZXJ0eURlc2NyaXB0b3IodCxpLHMpO3ZvaWQgMCE9PXImJmUkNyh0aGlzLnByb3RvdHlwZSx0LHIpO319c3RhdGljIGdldFByb3BlcnR5RGVzY3JpcHRvcih0LHMsaSl7Y29uc3R7Z2V0OmUsc2V0Omh9PXIkNSh0aGlzLnByb3RvdHlwZSx0KT8/e2dldCgpe3JldHVybiB0aGlzW3NdfSxzZXQodCl7dGhpc1tzXT10O319O3JldHVybiB7Z2V0KCl7cmV0dXJuIGU/LmNhbGwodGhpcyl9LHNldChzKXtjb25zdCByPWU/LmNhbGwodGhpcyk7aC5jYWxsKHRoaXMscyksdGhpcy5yZXF1ZXN0VXBkYXRlKHQscixpKTt9LGNvbmZpZ3VyYWJsZTohMCxlbnVtZXJhYmxlOiEwfX1zdGF0aWMgZ2V0UHJvcGVydHlPcHRpb25zKHQpe3JldHVybiB0aGlzLmVsZW1lbnRQcm9wZXJ0aWVzLmdldCh0KT8/eSQxfXN0YXRpYyBfJEVpKCl7aWYodGhpcy5oYXNPd25Qcm9wZXJ0eShkJDEoImVsZW1lbnRQcm9wZXJ0aWVzIikpKXJldHVybjtjb25zdCB0PW4kNCh0aGlzKTt0LmZpbmFsaXplKCksdm9pZCAwIT09dC5sJiYodGhpcy5sPVsuLi50LmxdKSx0aGlzLmVsZW1lbnRQcm9wZXJ0aWVzPW5ldyBNYXAodC5lbGVtZW50UHJvcGVydGllcyk7fXN0YXRpYyBmaW5hbGl6ZSgpe2lmKHRoaXMuaGFzT3duUHJvcGVydHkoZCQxKCJmaW5hbGl6ZWQiKSkpcmV0dXJuO2lmKHRoaXMuZmluYWxpemVkPSEwLHRoaXMuXyRFaSgpLHRoaXMuaGFzT3duUHJvcGVydHkoZCQxKCJwcm9wZXJ0aWVzIikpKXtjb25zdCB0PXRoaXMucHJvcGVydGllcyxzPVsuLi5oJDModCksLi4ubyQ0KHQpXTtmb3IoY29uc3QgaSBvZiBzKXRoaXMuY3JlYXRlUHJvcGVydHkoaSx0W2ldKTt9Y29uc3QgdD10aGlzW1N5bWJvbC5tZXRhZGF0YV07aWYobnVsbCE9PXQpe2NvbnN0IHM9bGl0UHJvcGVydHlNZXRhZGF0YS5nZXQodCk7aWYodm9pZCAwIT09cylmb3IoY29uc3RbdCxpXW9mIHMpdGhpcy5lbGVtZW50UHJvcGVydGllcy5zZXQodCxpKTt9dGhpcy5fJEVoPW5ldyBNYXA7Zm9yKGNvbnN0W3Qsc11vZiB0aGlzLmVsZW1lbnRQcm9wZXJ0aWVzKXtjb25zdCBpPXRoaXMuXyRFdSh0LHMpO3ZvaWQgMCE9PWkmJnRoaXMuXyRFaC5zZXQoaSx0KTt9dGhpcy5lbGVtZW50U3R5bGVzPXRoaXMuZmluYWxpemVTdHlsZXModGhpcy5zdHlsZXMpO31zdGF0aWMgZmluYWxpemVTdHlsZXMocyl7Y29uc3QgaT1bXTtpZihBcnJheS5pc0FycmF5KHMpKXtjb25zdCBlPW5ldyBTZXQocy5mbGF0KDEvMCkucmV2ZXJzZSgpKTtmb3IoY29uc3QgcyBvZiBlKWkudW5zaGlmdChjJDMocykpO31lbHNlIHZvaWQgMCE9PXMmJmkucHVzaChjJDMocykpO3JldHVybiBpfXN0YXRpYyBfJEV1KHQscyl7Y29uc3QgaT1zLmF0dHJpYnV0ZTtyZXR1cm4gITE9PT1pP3ZvaWQgMDoic3RyaW5nIj09dHlwZW9mIGk/aToic3RyaW5nIj09dHlwZW9mIHQ/dC50b0xvd2VyQ2FzZSgpOnZvaWQgMH1jb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5fJEVwPXZvaWQgMCx0aGlzLmlzVXBkYXRlUGVuZGluZz0hMSx0aGlzLmhhc1VwZGF0ZWQ9ITEsdGhpcy5fJEVtPW51bGwsdGhpcy5fJEV2KCk7fV8kRXYoKXt0aGlzLl8kRWc9bmV3IFByb21pc2UoKHQ9PnRoaXMuZW5hYmxlVXBkYXRpbmc9dCkpLHRoaXMuXyRBTD1uZXcgTWFwLHRoaXMuXyRFUygpLHRoaXMucmVxdWVzdFVwZGF0ZSgpLHRoaXMuY29uc3RydWN0b3IubD8uZm9yRWFjaCgodD0+dCh0aGlzKSkpO31hZGRDb250cm9sbGVyKHQpeyh0aGlzLl8kRV8/Pz1uZXcgU2V0KS5hZGQodCksdm9pZCAwIT09dGhpcy5yZW5kZXJSb290JiZ0aGlzLmlzQ29ubmVjdGVkJiZ0Lmhvc3RDb25uZWN0ZWQ/LigpO31yZW1vdmVDb250cm9sbGVyKHQpe3RoaXMuXyRFXz8uZGVsZXRlKHQpO31fJEVTKCl7Y29uc3QgdD1uZXcgTWFwLHM9dGhpcy5jb25zdHJ1Y3Rvci5lbGVtZW50UHJvcGVydGllcztmb3IoY29uc3QgaSBvZiBzLmtleXMoKSl0aGlzLmhhc093blByb3BlcnR5KGkpJiYodC5zZXQoaSx0aGlzW2ldKSxkZWxldGUgdGhpc1tpXSk7dC5zaXplPjAmJih0aGlzLl8kRXA9dCk7fWNyZWF0ZVJlbmRlclJvb3QoKXtjb25zdCB0PXRoaXMuc2hhZG93Um9vdD8/dGhpcy5hdHRhY2hTaGFkb3codGhpcy5jb25zdHJ1Y3Rvci5zaGFkb3dSb290T3B0aW9ucyk7cmV0dXJuIFMkMSh0LHRoaXMuY29uc3RydWN0b3IuZWxlbWVudFN0eWxlcyksdH1jb25uZWN0ZWRDYWxsYmFjaygpe3RoaXMucmVuZGVyUm9vdD8/PXRoaXMuY3JlYXRlUmVuZGVyUm9vdCgpLHRoaXMuZW5hYmxlVXBkYXRpbmcoITApLHRoaXMuXyRFXz8uZm9yRWFjaCgodD0+dC5ob3N0Q29ubmVjdGVkPy4oKSkpO31lbmFibGVVcGRhdGluZyh0KXt9ZGlzY29ubmVjdGVkQ2FsbGJhY2soKXt0aGlzLl8kRV8/LmZvckVhY2goKHQ9PnQuaG9zdERpc2Nvbm5lY3RlZD8uKCkpKTt9YXR0cmlidXRlQ2hhbmdlZENhbGxiYWNrKHQscyxpKXt0aGlzLl8kQUsodCxpKTt9XyRFTyh0LHMpe2NvbnN0IGk9dGhpcy5jb25zdHJ1Y3Rvci5lbGVtZW50UHJvcGVydGllcy5nZXQodCksZT10aGlzLmNvbnN0cnVjdG9yLl8kRXUodCxpKTtpZih2b2lkIDAhPT1lJiYhMD09PWkucmVmbGVjdCl7Y29uc3Qgcj0odm9pZCAwIT09aS5jb252ZXJ0ZXI/LnRvQXR0cmlidXRlP2kuY29udmVydGVyOnUkMSkudG9BdHRyaWJ1dGUocyxpLnR5cGUpO3RoaXMuXyRFbT10LG51bGw9PXI/dGhpcy5yZW1vdmVBdHRyaWJ1dGUoZSk6dGhpcy5zZXRBdHRyaWJ1dGUoZSxyKSx0aGlzLl8kRW09bnVsbDt9fV8kQUsodCxzKXtjb25zdCBpPXRoaXMuY29uc3RydWN0b3IsZT1pLl8kRWguZ2V0KHQpO2lmKHZvaWQgMCE9PWUmJnRoaXMuXyRFbSE9PWUpe2NvbnN0IHQ9aS5nZXRQcm9wZXJ0eU9wdGlvbnMoZSkscj0iZnVuY3Rpb24iPT10eXBlb2YgdC5jb252ZXJ0ZXI/e2Zyb21BdHRyaWJ1dGU6dC5jb252ZXJ0ZXJ9OnZvaWQgMCE9PXQuY29udmVydGVyPy5mcm9tQXR0cmlidXRlP3QuY29udmVydGVyOnUkMTt0aGlzLl8kRW09ZSx0aGlzW2VdPXIuZnJvbUF0dHJpYnV0ZShzLHQudHlwZSksdGhpcy5fJEVtPW51bGw7fX1yZXF1ZXN0VXBkYXRlKHQscyxpKXtpZih2b2lkIDAhPT10KXtpZihpPz89dGhpcy5jb25zdHJ1Y3Rvci5nZXRQcm9wZXJ0eU9wdGlvbnModCksIShpLmhhc0NoYW5nZWQ/P2YkMykodGhpc1t0XSxzKSlyZXR1cm47dGhpcy5DKHQscyxpKTt9ITE9PT10aGlzLmlzVXBkYXRlUGVuZGluZyYmKHRoaXMuXyRFZz10aGlzLl8kRVAoKSk7fUModCxzLGkpe3RoaXMuXyRBTC5oYXModCl8fHRoaXMuXyRBTC5zZXQodCxzKSwhMD09PWkucmVmbGVjdCYmdGhpcy5fJEVtIT09dCYmKHRoaXMuXyRFVD8/PW5ldyBTZXQpLmFkZCh0KTt9YXN5bmMgXyRFUCgpe3RoaXMuaXNVcGRhdGVQZW5kaW5nPSEwO3RyeXthd2FpdCB0aGlzLl8kRWc7fWNhdGNoKHQpe1Byb21pc2UucmVqZWN0KHQpO31jb25zdCB0PXRoaXMuc2NoZWR1bGVVcGRhdGUoKTtyZXR1cm4gbnVsbCE9dCYmYXdhaXQgdCwhdGhpcy5pc1VwZGF0ZVBlbmRpbmd9c2NoZWR1bGVVcGRhdGUoKXtyZXR1cm4gdGhpcy5wZXJmb3JtVXBkYXRlKCl9cGVyZm9ybVVwZGF0ZSgpe2lmKCF0aGlzLmlzVXBkYXRlUGVuZGluZylyZXR1cm47aWYoIXRoaXMuaGFzVXBkYXRlZCl7aWYodGhpcy5yZW5kZXJSb290Pz89dGhpcy5jcmVhdGVSZW5kZXJSb290KCksdGhpcy5fJEVwKXtmb3IoY29uc3RbdCxzXW9mIHRoaXMuXyRFcCl0aGlzW3RdPXM7dGhpcy5fJEVwPXZvaWQgMDt9Y29uc3QgdD10aGlzLmNvbnN0cnVjdG9yLmVsZW1lbnRQcm9wZXJ0aWVzO2lmKHQuc2l6ZT4wKWZvcihjb25zdFtzLGldb2YgdCkhMCE9PWkud3JhcHBlZHx8dGhpcy5fJEFMLmhhcyhzKXx8dm9pZCAwPT09dGhpc1tzXXx8dGhpcy5DKHMsdGhpc1tzXSxpKTt9bGV0IHQ9ITE7Y29uc3Qgcz10aGlzLl8kQUw7dHJ5e3Q9dGhpcy5zaG91bGRVcGRhdGUocyksdD8odGhpcy53aWxsVXBkYXRlKHMpLHRoaXMuXyRFXz8uZm9yRWFjaCgodD0+dC5ob3N0VXBkYXRlPy4oKSkpLHRoaXMudXBkYXRlKHMpKTp0aGlzLl8kRWooKTt9Y2F0Y2gocyl7dGhyb3cgdD0hMSx0aGlzLl8kRWooKSxzfXQmJnRoaXMuXyRBRShzKTt9d2lsbFVwZGF0ZSh0KXt9XyRBRSh0KXt0aGlzLl8kRV8/LmZvckVhY2goKHQ9PnQuaG9zdFVwZGF0ZWQ/LigpKSksdGhpcy5oYXNVcGRhdGVkfHwodGhpcy5oYXNVcGRhdGVkPSEwLHRoaXMuZmlyc3RVcGRhdGVkKHQpKSx0aGlzLnVwZGF0ZWQodCk7fV8kRWooKXt0aGlzLl8kQUw9bmV3IE1hcCx0aGlzLmlzVXBkYXRlUGVuZGluZz0hMTt9Z2V0IHVwZGF0ZUNvbXBsZXRlKCl7cmV0dXJuIHRoaXMuZ2V0VXBkYXRlQ29tcGxldGUoKX1nZXRVcGRhdGVDb21wbGV0ZSgpe3JldHVybiB0aGlzLl8kRWd9c2hvdWxkVXBkYXRlKHQpe3JldHVybiAhMH11cGRhdGUodCl7dGhpcy5fJEVUJiY9dGhpcy5fJEVULmZvckVhY2goKHQ9PnRoaXMuXyRFTyh0LHRoaXNbdF0pKSksdGhpcy5fJEVqKCk7fXVwZGF0ZWQodCl7fWZpcnN0VXBkYXRlZCh0KXt9fWIuZWxlbWVudFN0eWxlcz1bXSxiLnNoYWRvd1Jvb3RPcHRpb25zPXttb2RlOiJvcGVuIn0sYltkJDEoImVsZW1lbnRQcm9wZXJ0aWVzIildPW5ldyBNYXAsYltkJDEoImZpbmFsaXplZCIpXT1uZXcgTWFwLHAkMT8uKHtSZWFjdGl2ZUVsZW1lbnQ6Yn0pLChhJDEucmVhY3RpdmVFbGVtZW50VmVyc2lvbnM/Pz1bXSkucHVzaCgiMi4wLjMiKTsKCiAgLyoqCiAgICogQGxpY2Vuc2UKICAgKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDCiAgICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEJTRC0zLUNsYXVzZQogICAqLwogIGNvbnN0IHQkMT1nbG9iYWxUaGlzLGkkMT10JDEudHJ1c3RlZFR5cGVzLHMkMj1pJDE/aSQxLmNyZWF0ZVBvbGljeSgibGl0LWh0bWwiLHtjcmVhdGVIVE1MOnQ9PnR9KTp2b2lkIDAsZSQ2PSIkbGl0JCIsaCQyPWBsaXQkJHsoTWF0aC5yYW5kb20oKSsiIikuc2xpY2UoOSl9JGAsbyQzPSI/IitoJDIsbiQzPWA8JHtvJDN9PmAsciQ0PWRvY3VtZW50LGw9KCk9PnIkNC5jcmVhdGVDb21tZW50KCIiKSxjJDE9dD0+bnVsbD09PXR8fCJvYmplY3QiIT10eXBlb2YgdCYmImZ1bmN0aW9uIiE9dHlwZW9mIHQsYT1BcnJheS5pc0FycmF5LHU9dD0+YSh0KXx8ImZ1bmN0aW9uIj09dHlwZW9mIHQ/LltTeW1ib2wuaXRlcmF0b3JdLGQ9IlsgXHRcblxmXHJdIixmJDI9LzwoPzooIS0tfFwvW15hLXpBLVpdKXwoXC8/W2EtekEtWl1bXj5cc10qKXwoXC8/JCkpL2csdj0vLS0+L2csXz0vPi9nLG09UmVnRXhwKGA+fCR7ZH0oPzooW15cXHMiJz49L10rKSgke2R9Kj0ke2R9Kig/OlteIFx0XG5cZlxyIidcYDw+PV18KCJ8Jyl8KSl8JClgLCJnIikscD0vJy9nLGc9LyIvZywkPS9eKD86c2NyaXB0fHN0eWxlfHRleHRhcmVhfHRpdGxlKSQvaSx5PXQ9PihpLC4uLnMpPT4oe18kbGl0VHlwZSQ6dCxzdHJpbmdzOmksdmFsdWVzOnN9KSx4PXkoMSksdz1TeW1ib2wuZm9yKCJsaXQtbm9DaGFuZ2UiKSxUPVN5bWJvbC5mb3IoImxpdC1ub3RoaW5nIiksQT1uZXcgV2Vha01hcCxFPXIkNC5jcmVhdGVUcmVlV2Fsa2VyKHIkNCwxMjkpO2Z1bmN0aW9uIEModCxpKXtpZighQXJyYXkuaXNBcnJheSh0KXx8IXQuaGFzT3duUHJvcGVydHkoInJhdyIpKXRocm93IEVycm9yKCJpbnZhbGlkIHRlbXBsYXRlIHN0cmluZ3MgYXJyYXkiKTtyZXR1cm4gdm9pZCAwIT09cyQyP3MkMi5jcmVhdGVIVE1MKGkpOml9Y29uc3QgUD0odCxpKT0+e2NvbnN0IHM9dC5sZW5ndGgtMSxvPVtdO2xldCByLGw9Mj09PWk/Ijxzdmc+IjoiIixjPWYkMjtmb3IobGV0IGk9MDtpPHM7aSsrKXtjb25zdCBzPXRbaV07bGV0IGEsdSxkPS0xLHk9MDtmb3IoO3k8cy5sZW5ndGgmJihjLmxhc3RJbmRleD15LHU9Yy5leGVjKHMpLG51bGwhPT11KTspeT1jLmxhc3RJbmRleCxjPT09ZiQyPyIhLS0iPT09dVsxXT9jPXY6dm9pZCAwIT09dVsxXT9jPV86dm9pZCAwIT09dVsyXT8oJC50ZXN0KHVbMl0pJiYocj1SZWdFeHAoIjwvIit1WzJdLCJnIikpLGM9bSk6dm9pZCAwIT09dVszXSYmKGM9bSk6Yz09PW0/Ij4iPT09dVswXT8oYz1yPz9mJDIsZD0tMSk6dm9pZCAwPT09dVsxXT9kPS0yOihkPWMubGFzdEluZGV4LXVbMl0ubGVuZ3RoLGE9dVsxXSxjPXZvaWQgMD09PXVbM10/bTonIic9PT11WzNdP2c6cCk6Yz09PWd8fGM9PT1wP2M9bTpjPT09dnx8Yz09PV8/Yz1mJDI6KGM9bSxyPXZvaWQgMCk7Y29uc3QgeD1jPT09bSYmdFtpKzFdLnN0YXJ0c1dpdGgoIi8+Iik/IiAiOiIiO2wrPWM9PT1mJDI/cytuJDM6ZD49MD8oby5wdXNoKGEpLHMuc2xpY2UoMCxkKStlJDYrcy5zbGljZShkKStoJDIreCk6cytoJDIrKC0yPT09ZD9pOngpO31yZXR1cm4gW0ModCxsKyh0W3NdfHwiPD8+IikrKDI9PT1pPyI8L3N2Zz4iOiIiKSksb119O2NsYXNzIFZ7Y29uc3RydWN0b3Ioe3N0cmluZ3M6dCxfJGxpdFR5cGUkOnN9LG4pe2xldCByO3RoaXMucGFydHM9W107bGV0IGM9MCxhPTA7Y29uc3QgdT10Lmxlbmd0aC0xLGQ9dGhpcy5wYXJ0cyxbZix2XT1QKHQscyk7aWYodGhpcy5lbD1WLmNyZWF0ZUVsZW1lbnQoZixuKSxFLmN1cnJlbnROb2RlPXRoaXMuZWwuY29udGVudCwyPT09cyl7Y29uc3QgdD10aGlzLmVsLmNvbnRlbnQuZmlyc3RDaGlsZDt0LnJlcGxhY2VXaXRoKC4uLnQuY2hpbGROb2Rlcyk7fWZvcig7bnVsbCE9PShyPUUubmV4dE5vZGUoKSkmJmQubGVuZ3RoPHU7KXtpZigxPT09ci5ub2RlVHlwZSl7aWYoci5oYXNBdHRyaWJ1dGVzKCkpZm9yKGNvbnN0IHQgb2Ygci5nZXRBdHRyaWJ1dGVOYW1lcygpKWlmKHQuZW5kc1dpdGgoZSQ2KSl7Y29uc3QgaT12W2ErK10scz1yLmdldEF0dHJpYnV0ZSh0KS5zcGxpdChoJDIpLGU9LyhbLj9AXSk/KC4qKS8uZXhlYyhpKTtkLnB1c2goe3R5cGU6MSxpbmRleDpjLG5hbWU6ZVsyXSxzdHJpbmdzOnMsY3RvcjoiLiI9PT1lWzFdP2s6Ij8iPT09ZVsxXT9IOiJAIj09PWVbMV0/STpSfSksci5yZW1vdmVBdHRyaWJ1dGUodCk7fWVsc2UgdC5zdGFydHNXaXRoKGgkMikmJihkLnB1c2goe3R5cGU6NixpbmRleDpjfSksci5yZW1vdmVBdHRyaWJ1dGUodCkpO2lmKCQudGVzdChyLnRhZ05hbWUpKXtjb25zdCB0PXIudGV4dENvbnRlbnQuc3BsaXQoaCQyKSxzPXQubGVuZ3RoLTE7aWYocz4wKXtyLnRleHRDb250ZW50PWkkMT9pJDEuZW1wdHlTY3JpcHQ6IiI7Zm9yKGxldCBpPTA7aTxzO2krKylyLmFwcGVuZCh0W2ldLGwoKSksRS5uZXh0Tm9kZSgpLGQucHVzaCh7dHlwZToyLGluZGV4OisrY30pO3IuYXBwZW5kKHRbc10sbCgpKTt9fX1lbHNlIGlmKDg9PT1yLm5vZGVUeXBlKWlmKHIuZGF0YT09PW8kMylkLnB1c2goe3R5cGU6MixpbmRleDpjfSk7ZWxzZSB7bGV0IHQ9LTE7Zm9yKDstMSE9PSh0PXIuZGF0YS5pbmRleE9mKGgkMix0KzEpKTspZC5wdXNoKHt0eXBlOjcsaW5kZXg6Y30pLHQrPWgkMi5sZW5ndGgtMTt9YysrO319c3RhdGljIGNyZWF0ZUVsZW1lbnQodCxpKXtjb25zdCBzPXIkNC5jcmVhdGVFbGVtZW50KCJ0ZW1wbGF0ZSIpO3JldHVybiBzLmlubmVySFRNTD10LHN9fWZ1bmN0aW9uIE4odCxpLHM9dCxlKXtpZihpPT09dylyZXR1cm4gaTtsZXQgaD12b2lkIDAhPT1lP3MuXyRDbz8uW2VdOnMuXyRDbDtjb25zdCBvPWMkMShpKT92b2lkIDA6aS5fJGxpdERpcmVjdGl2ZSQ7cmV0dXJuIGg/LmNvbnN0cnVjdG9yIT09byYmKGg/Ll8kQU8/LighMSksdm9pZCAwPT09bz9oPXZvaWQgMDooaD1uZXcgbyh0KSxoLl8kQVQodCxzLGUpKSx2b2lkIDAhPT1lPyhzLl8kQ28/Pz1bXSlbZV09aDpzLl8kQ2w9aCksdm9pZCAwIT09aCYmKGk9Tih0LGguXyRBUyh0LGkudmFsdWVzKSxoLGUpKSxpfWNsYXNzIFN7Y29uc3RydWN0b3IodCxpKXt0aGlzLl8kQVY9W10sdGhpcy5fJEFOPXZvaWQgMCx0aGlzLl8kQUQ9dCx0aGlzLl8kQU09aTt9Z2V0IHBhcmVudE5vZGUoKXtyZXR1cm4gdGhpcy5fJEFNLnBhcmVudE5vZGV9Z2V0IF8kQVUoKXtyZXR1cm4gdGhpcy5fJEFNLl8kQVV9dSh0KXtjb25zdHtlbDp7Y29udGVudDppfSxwYXJ0czpzfT10aGlzLl8kQUQsZT0odD8uY3JlYXRpb25TY29wZT8/ciQ0KS5pbXBvcnROb2RlKGksITApO0UuY3VycmVudE5vZGU9ZTtsZXQgaD1FLm5leHROb2RlKCksbz0wLG49MCxsPXNbMF07Zm9yKDt2b2lkIDAhPT1sOyl7aWYobz09PWwuaW5kZXgpe2xldCBpOzI9PT1sLnR5cGU/aT1uZXcgTShoLGgubmV4dFNpYmxpbmcsdGhpcyx0KToxPT09bC50eXBlP2k9bmV3IGwuY3RvcihoLGwubmFtZSxsLnN0cmluZ3MsdGhpcyx0KTo2PT09bC50eXBlJiYoaT1uZXcgTChoLHRoaXMsdCkpLHRoaXMuXyRBVi5wdXNoKGkpLGw9c1srK25dO31vIT09bD8uaW5kZXgmJihoPUUubmV4dE5vZGUoKSxvKyspO31yZXR1cm4gRS5jdXJyZW50Tm9kZT1yJDQsZX1wKHQpe2xldCBpPTA7Zm9yKGNvbnN0IHMgb2YgdGhpcy5fJEFWKXZvaWQgMCE9PXMmJih2b2lkIDAhPT1zLnN0cmluZ3M/KHMuXyRBSSh0LHMsaSksaSs9cy5zdHJpbmdzLmxlbmd0aC0yKTpzLl8kQUkodFtpXSkpLGkrKzt9fWNsYXNzIE17Z2V0IF8kQVUoKXtyZXR1cm4gdGhpcy5fJEFNPy5fJEFVPz90aGlzLl8kQ3Z9Y29uc3RydWN0b3IodCxpLHMsZSl7dGhpcy50eXBlPTIsdGhpcy5fJEFIPVQsdGhpcy5fJEFOPXZvaWQgMCx0aGlzLl8kQUE9dCx0aGlzLl8kQUI9aSx0aGlzLl8kQU09cyx0aGlzLm9wdGlvbnM9ZSx0aGlzLl8kQ3Y9ZT8uaXNDb25uZWN0ZWQ/PyEwO31nZXQgcGFyZW50Tm9kZSgpe2xldCB0PXRoaXMuXyRBQS5wYXJlbnROb2RlO2NvbnN0IGk9dGhpcy5fJEFNO3JldHVybiB2b2lkIDAhPT1pJiYxMT09PXQ/Lm5vZGVUeXBlJiYodD1pLnBhcmVudE5vZGUpLHR9Z2V0IHN0YXJ0Tm9kZSgpe3JldHVybiB0aGlzLl8kQUF9Z2V0IGVuZE5vZGUoKXtyZXR1cm4gdGhpcy5fJEFCfV8kQUkodCxpPXRoaXMpe3Q9Tih0aGlzLHQsaSksYyQxKHQpP3Q9PT1UfHxudWxsPT10fHwiIj09PXQ/KHRoaXMuXyRBSCE9PVQmJnRoaXMuXyRBUigpLHRoaXMuXyRBSD1UKTp0IT09dGhpcy5fJEFIJiZ0IT09dyYmdGhpcy5fKHQpOnZvaWQgMCE9PXQuXyRsaXRUeXBlJD90aGlzLmcodCk6dm9pZCAwIT09dC5ub2RlVHlwZT90aGlzLiQodCk6dSh0KT90aGlzLlQodCk6dGhpcy5fKHQpO31rKHQpe3JldHVybiB0aGlzLl8kQUEucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUodCx0aGlzLl8kQUIpfSQodCl7dGhpcy5fJEFIIT09dCYmKHRoaXMuXyRBUigpLHRoaXMuXyRBSD10aGlzLmsodCkpO31fKHQpe3RoaXMuXyRBSCE9PVQmJmMkMSh0aGlzLl8kQUgpP3RoaXMuXyRBQS5uZXh0U2libGluZy5kYXRhPXQ6dGhpcy4kKHIkNC5jcmVhdGVUZXh0Tm9kZSh0KSksdGhpcy5fJEFIPXQ7fWcodCl7Y29uc3R7dmFsdWVzOmksXyRsaXRUeXBlJDpzfT10LGU9Im51bWJlciI9PXR5cGVvZiBzP3RoaXMuXyRBQyh0KToodm9pZCAwPT09cy5lbCYmKHMuZWw9Vi5jcmVhdGVFbGVtZW50KEMocy5oLHMuaFswXSksdGhpcy5vcHRpb25zKSkscyk7aWYodGhpcy5fJEFIPy5fJEFEPT09ZSl0aGlzLl8kQUgucChpKTtlbHNlIHtjb25zdCB0PW5ldyBTKGUsdGhpcykscz10LnUodGhpcy5vcHRpb25zKTt0LnAoaSksdGhpcy4kKHMpLHRoaXMuXyRBSD10O319XyRBQyh0KXtsZXQgaT1BLmdldCh0LnN0cmluZ3MpO3JldHVybiB2b2lkIDA9PT1pJiZBLnNldCh0LnN0cmluZ3MsaT1uZXcgVih0KSksaX1UKHQpe2EodGhpcy5fJEFIKXx8KHRoaXMuXyRBSD1bXSx0aGlzLl8kQVIoKSk7Y29uc3QgaT10aGlzLl8kQUg7bGV0IHMsZT0wO2Zvcihjb25zdCBoIG9mIHQpZT09PWkubGVuZ3RoP2kucHVzaChzPW5ldyBNKHRoaXMuayhsKCkpLHRoaXMuayhsKCkpLHRoaXMsdGhpcy5vcHRpb25zKSk6cz1pW2VdLHMuXyRBSShoKSxlKys7ZTxpLmxlbmd0aCYmKHRoaXMuXyRBUihzJiZzLl8kQUIubmV4dFNpYmxpbmcsZSksaS5sZW5ndGg9ZSk7fV8kQVIodD10aGlzLl8kQUEubmV4dFNpYmxpbmcsaSl7Zm9yKHRoaXMuXyRBUD8uKCExLCEwLGkpO3QmJnQhPT10aGlzLl8kQUI7KXtjb25zdCBpPXQubmV4dFNpYmxpbmc7dC5yZW1vdmUoKSx0PWk7fX1zZXRDb25uZWN0ZWQodCl7dm9pZCAwPT09dGhpcy5fJEFNJiYodGhpcy5fJEN2PXQsdGhpcy5fJEFQPy4odCkpO319Y2xhc3MgUntnZXQgdGFnTmFtZSgpe3JldHVybiB0aGlzLmVsZW1lbnQudGFnTmFtZX1nZXQgXyRBVSgpe3JldHVybiB0aGlzLl8kQU0uXyRBVX1jb25zdHJ1Y3Rvcih0LGkscyxlLGgpe3RoaXMudHlwZT0xLHRoaXMuXyRBSD1ULHRoaXMuXyRBTj12b2lkIDAsdGhpcy5lbGVtZW50PXQsdGhpcy5uYW1lPWksdGhpcy5fJEFNPWUsdGhpcy5vcHRpb25zPWgscy5sZW5ndGg+Mnx8IiIhPT1zWzBdfHwiIiE9PXNbMV0/KHRoaXMuXyRBSD1BcnJheShzLmxlbmd0aC0xKS5maWxsKG5ldyBTdHJpbmcpLHRoaXMuc3RyaW5ncz1zKTp0aGlzLl8kQUg9VDt9XyRBSSh0LGk9dGhpcyxzLGUpe2NvbnN0IGg9dGhpcy5zdHJpbmdzO2xldCBvPSExO2lmKHZvaWQgMD09PWgpdD1OKHRoaXMsdCxpLDApLG89IWMkMSh0KXx8dCE9PXRoaXMuXyRBSCYmdCE9PXcsbyYmKHRoaXMuXyRBSD10KTtlbHNlIHtjb25zdCBlPXQ7bGV0IG4scjtmb3IodD1oWzBdLG49MDtuPGgubGVuZ3RoLTE7bisrKXI9Tih0aGlzLGVbcytuXSxpLG4pLHI9PT13JiYocj10aGlzLl8kQUhbbl0pLG98fD0hYyQxKHIpfHxyIT09dGhpcy5fJEFIW25dLHI9PT1UP3Q9VDp0IT09VCYmKHQrPShyPz8iIikraFtuKzFdKSx0aGlzLl8kQUhbbl09cjt9byYmIWUmJnRoaXMuTyh0KTt9Tyh0KXt0PT09VD90aGlzLmVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKHRoaXMubmFtZSk6dGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZSh0aGlzLm5hbWUsdD8/IiIpO319Y2xhc3MgayBleHRlbmRzIFJ7Y29uc3RydWN0b3IoKXtzdXBlciguLi5hcmd1bWVudHMpLHRoaXMudHlwZT0zO31PKHQpe3RoaXMuZWxlbWVudFt0aGlzLm5hbWVdPXQ9PT1UP3ZvaWQgMDp0O319Y2xhc3MgSCBleHRlbmRzIFJ7Y29uc3RydWN0b3IoKXtzdXBlciguLi5hcmd1bWVudHMpLHRoaXMudHlwZT00O31PKHQpe3RoaXMuZWxlbWVudC50b2dnbGVBdHRyaWJ1dGUodGhpcy5uYW1lLCEhdCYmdCE9PVQpO319Y2xhc3MgSSBleHRlbmRzIFJ7Y29uc3RydWN0b3IodCxpLHMsZSxoKXtzdXBlcih0LGkscyxlLGgpLHRoaXMudHlwZT01O31fJEFJKHQsaT10aGlzKXtpZigodD1OKHRoaXMsdCxpLDApPz9UKT09PXcpcmV0dXJuO2NvbnN0IHM9dGhpcy5fJEFILGU9dD09PVQmJnMhPT1UfHx0LmNhcHR1cmUhPT1zLmNhcHR1cmV8fHQub25jZSE9PXMub25jZXx8dC5wYXNzaXZlIT09cy5wYXNzaXZlLGg9dCE9PVQmJihzPT09VHx8ZSk7ZSYmdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5uYW1lLHRoaXMscyksaCYmdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIodGhpcy5uYW1lLHRoaXMsdCksdGhpcy5fJEFIPXQ7fWhhbmRsZUV2ZW50KHQpeyJmdW5jdGlvbiI9PXR5cGVvZiB0aGlzLl8kQUg/dGhpcy5fJEFILmNhbGwodGhpcy5vcHRpb25zPy5ob3N0Pz90aGlzLmVsZW1lbnQsdCk6dGhpcy5fJEFILmhhbmRsZUV2ZW50KHQpO319Y2xhc3MgTHtjb25zdHJ1Y3Rvcih0LGkscyl7dGhpcy5lbGVtZW50PXQsdGhpcy50eXBlPTYsdGhpcy5fJEFOPXZvaWQgMCx0aGlzLl8kQU09aSx0aGlzLm9wdGlvbnM9czt9Z2V0IF8kQVUoKXtyZXR1cm4gdGhpcy5fJEFNLl8kQVV9XyRBSSh0KXtOKHRoaXMsdCk7fX1jb25zdCBaPXQkMS5saXRIdG1sUG9seWZpbGxTdXBwb3J0O1o/LihWLE0pLCh0JDEubGl0SHRtbFZlcnNpb25zPz89W10pLnB1c2goIjMuMS4xIik7Y29uc3Qgaj0odCxpLHMpPT57Y29uc3QgZT1zPy5yZW5kZXJCZWZvcmU/P2k7bGV0IGg9ZS5fJGxpdFBhcnQkO2lmKHZvaWQgMD09PWgpe2NvbnN0IHQ9cz8ucmVuZGVyQmVmb3JlPz9udWxsO2UuXyRsaXRQYXJ0JD1oPW5ldyBNKGkuaW5zZXJ0QmVmb3JlKGwoKSx0KSx0LHZvaWQgMCxzPz97fSk7fXJldHVybiBoLl8kQUkodCksaH07CgogIC8qKgogICAqIEBsaWNlbnNlCiAgICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQwogICAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBCU0QtMy1DbGF1c2UKICAgKi9sZXQgcyQxID0gY2xhc3MgcyBleHRlbmRzIGJ7Y29uc3RydWN0b3IoKXtzdXBlciguLi5hcmd1bWVudHMpLHRoaXMucmVuZGVyT3B0aW9ucz17aG9zdDp0aGlzfSx0aGlzLl8kRG89dm9pZCAwO31jcmVhdGVSZW5kZXJSb290KCl7Y29uc3QgdD1zdXBlci5jcmVhdGVSZW5kZXJSb290KCk7cmV0dXJuIHRoaXMucmVuZGVyT3B0aW9ucy5yZW5kZXJCZWZvcmU/Pz10LmZpcnN0Q2hpbGQsdH11cGRhdGUodCl7Y29uc3QgaT10aGlzLnJlbmRlcigpO3RoaXMuaGFzVXBkYXRlZHx8KHRoaXMucmVuZGVyT3B0aW9ucy5pc0Nvbm5lY3RlZD10aGlzLmlzQ29ubmVjdGVkKSxzdXBlci51cGRhdGUodCksdGhpcy5fJERvPWooaSx0aGlzLnJlbmRlclJvb3QsdGhpcy5yZW5kZXJPcHRpb25zKTt9Y29ubmVjdGVkQ2FsbGJhY2soKXtzdXBlci5jb25uZWN0ZWRDYWxsYmFjaygpLHRoaXMuXyREbz8uc2V0Q29ubmVjdGVkKCEwKTt9ZGlzY29ubmVjdGVkQ2FsbGJhY2soKXtzdXBlci5kaXNjb25uZWN0ZWRDYWxsYmFjaygpLHRoaXMuXyREbz8uc2V0Q29ubmVjdGVkKCExKTt9cmVuZGVyKCl7cmV0dXJuIHd9fTtzJDEuXyRsaXRFbGVtZW50JD0hMCxzJDFbKCJmaW5hbGl6ZWQiKV09ITAsZ2xvYmFsVGhpcy5saXRFbGVtZW50SHlkcmF0ZVN1cHBvcnQ/Lih7TGl0RWxlbWVudDpzJDF9KTtjb25zdCByJDM9Z2xvYmFsVGhpcy5saXRFbGVtZW50UG9seWZpbGxTdXBwb3J0O3IkMz8uKHtMaXRFbGVtZW50OnMkMX0pOyhnbG9iYWxUaGlzLmxpdEVsZW1lbnRWZXJzaW9ucz8/PVtdKS5wdXNoKCI0LjAuMyIpOwoKICAvLyBzcmMvc3R5bGVzL2NvbXBvbmVudC5zdHlsZXMudHMKICB2YXIgY29tcG9uZW50X3N0eWxlc19kZWZhdWx0ID0gaSQzYAogIDpob3N0IHsKICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgfQoKICA6aG9zdCAqLAogIDpob3N0ICo6OmJlZm9yZSwKICA6aG9zdCAqOjphZnRlciB7CiAgICBib3gtc2l6aW5nOiBpbmhlcml0OwogIH0KCiAgW2hpZGRlbl0gewogICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50OwogIH0KYDsKCiAgdmFyIHBvcHVwX3N0eWxlc19kZWZhdWx0ID0gaSQzYAogICR7Y29tcG9uZW50X3N0eWxlc19kZWZhdWx0fQoKICA6aG9zdCB7CiAgICAtLWFycm93LWNvbG9yOiB2YXIoLS1zbC1jb2xvci1uZXV0cmFsLTEwMDApOwogICAgLS1hcnJvdy1zaXplOiA2cHg7CgogICAgLyoKICAgICAqIFRoZXNlIHByb3BlcnRpZXMgYXJlIGNvbXB1dGVkIHRvIGFjY291bnQgZm9yIHRoZSBhcnJvdydzIGRpbWVuc2lvbnMgYWZ0ZXIgYmVpbmcgcm90YXRlZCA0NcK6LiBUaGUgY29uc3RhbnQKICAgICAqIDAuNzA3MSBpcyBkZXJpdmVkIGZyb20gc2luKDQ1KSwgd2hpY2ggaXMgdGhlIGRpYWdvbmFsIHNpemUgb2YgdGhlIGFycm93J3MgY29udGFpbmVyIGFmdGVyIHJvdGF0aW5nLgogICAgICovCiAgICAtLWFycm93LXNpemUtZGlhZ29uYWw6IGNhbGModmFyKC0tYXJyb3ctc2l6ZSkgKiAwLjcwNzEpOwogICAgLS1hcnJvdy1wYWRkaW5nLW9mZnNldDogY2FsYyh2YXIoLS1hcnJvdy1zaXplLWRpYWdvbmFsKSAtIHZhcigtLWFycm93LXNpemUpKTsKCiAgICBkaXNwbGF5OiBjb250ZW50czsKICB9CgogIC5wb3B1cCB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICBpc29sYXRpb246IGlzb2xhdGU7CiAgICBtYXgtd2lkdGg6IHZhcigtLWF1dG8tc2l6ZS1hdmFpbGFibGUtd2lkdGgsIG5vbmUpOwogICAgbWF4LWhlaWdodDogdmFyKC0tYXV0by1zaXplLWF2YWlsYWJsZS1oZWlnaHQsIG5vbmUpOwogIH0KCiAgLnBvcHVwLS1maXhlZCB7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgfQoKICAucG9wdXA6bm90KC5wb3B1cC0tYWN0aXZlKSB7CiAgICBkaXNwbGF5OiBub25lOwogIH0KCiAgLnBvcHVwX19hcnJvdyB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB3aWR0aDogY2FsYyh2YXIoLS1hcnJvdy1zaXplLWRpYWdvbmFsKSAqIDIpOwogICAgaGVpZ2h0OiBjYWxjKHZhcigtLWFycm93LXNpemUtZGlhZ29uYWwpICogMik7CiAgICByb3RhdGU6IDQ1ZGVnOwogICAgYmFja2dyb3VuZDogdmFyKC0tYXJyb3ctY29sb3IpOwogICAgei1pbmRleDogLTE7CiAgfQpgOwoKICB2YXIgX19kZWZQcm9wID0gT2JqZWN0LmRlZmluZVByb3BlcnR5OwogIHZhciBfX2RlZlByb3BzID0gT2JqZWN0LmRlZmluZVByb3BlcnRpZXM7CiAgdmFyIF9fZ2V0T3duUHJvcERlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOwogIHZhciBfX2dldE93blByb3BEZXNjcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzOwogIHZhciBfX2dldE93blByb3BTeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9sczsKICB2YXIgX19oYXNPd25Qcm9wID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTsKICB2YXIgX19wcm9wSXNFbnVtID0gT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZTsKICB2YXIgX19kZWZOb3JtYWxQcm9wID0gKG9iaiwga2V5LCB2YWx1ZSkgPT4ga2V5IGluIG9iaiA/IF9fZGVmUHJvcChvYmosIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlLCB2YWx1ZSB9KSA6IG9ialtrZXldID0gdmFsdWU7CiAgdmFyIF9fc3ByZWFkVmFsdWVzID0gKGEsIGIpID0+IHsKICAgIGZvciAodmFyIHByb3AgaW4gYiB8fCAoYiA9IHt9KSkKICAgICAgaWYgKF9faGFzT3duUHJvcC5jYWxsKGIsIHByb3ApKQogICAgICAgIF9fZGVmTm9ybWFsUHJvcChhLCBwcm9wLCBiW3Byb3BdKTsKICAgIGlmIChfX2dldE93blByb3BTeW1ib2xzKQogICAgICBmb3IgKHZhciBwcm9wIG9mIF9fZ2V0T3duUHJvcFN5bWJvbHMoYikpIHsKICAgICAgICBpZiAoX19wcm9wSXNFbnVtLmNhbGwoYiwgcHJvcCkpCiAgICAgICAgICBfX2RlZk5vcm1hbFByb3AoYSwgcHJvcCwgYltwcm9wXSk7CiAgICAgIH0KICAgIHJldHVybiBhOwogIH07CiAgdmFyIF9fc3ByZWFkUHJvcHMgPSAoYSwgYikgPT4gX19kZWZQcm9wcyhhLCBfX2dldE93blByb3BEZXNjcyhiKSk7CiAgdmFyIF9fZGVjb3JhdGVDbGFzcyA9IChkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwga2luZCkgPT4gewogICAgdmFyIHJlc3VsdCA9IGtpbmQgPiAxID8gdm9pZCAwIDoga2luZCA/IF9fZ2V0T3duUHJvcERlc2ModGFyZ2V0LCBrZXkpIDogdGFyZ2V0OwogICAgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMSwgZGVjb3JhdG9yOyBpID49IDA7IGktLSkKICAgICAgaWYgKGRlY29yYXRvciA9IGRlY29yYXRvcnNbaV0pCiAgICAgICAgcmVzdWx0ID0gKGtpbmQgPyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHJlc3VsdCkgOiBkZWNvcmF0b3IocmVzdWx0KSkgfHwgcmVzdWx0OwogICAgaWYgKGtpbmQgJiYgcmVzdWx0KQogICAgICBfX2RlZlByb3AodGFyZ2V0LCBrZXksIHJlc3VsdCk7CiAgICByZXR1cm4gcmVzdWx0OwogIH07CgogIC8qKgogICAqIEBsaWNlbnNlCiAgICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQwogICAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBCU0QtMy1DbGF1c2UKICAgKi9jb25zdCBvJDI9e2F0dHJpYnV0ZTohMCx0eXBlOlN0cmluZyxjb252ZXJ0ZXI6dSQxLHJlZmxlY3Q6ITEsaGFzQ2hhbmdlZDpmJDN9LHIkMj0odD1vJDIsZSxyKT0+e2NvbnN0e2tpbmQ6bixtZXRhZGF0YTppfT1yO2xldCBzPWdsb2JhbFRoaXMubGl0UHJvcGVydHlNZXRhZGF0YS5nZXQoaSk7aWYodm9pZCAwPT09cyYmZ2xvYmFsVGhpcy5saXRQcm9wZXJ0eU1ldGFkYXRhLnNldChpLHM9bmV3IE1hcCkscy5zZXQoci5uYW1lLHQpLCJhY2Nlc3NvciI9PT1uKXtjb25zdHtuYW1lOm99PXI7cmV0dXJuIHtzZXQocil7Y29uc3Qgbj1lLmdldC5jYWxsKHRoaXMpO2Uuc2V0LmNhbGwodGhpcyxyKSx0aGlzLnJlcXVlc3RVcGRhdGUobyxuLHQpO30saW5pdChlKXtyZXR1cm4gdm9pZCAwIT09ZSYmdGhpcy5DKG8sdm9pZCAwLHQpLGV9fX1pZigic2V0dGVyIj09PW4pe2NvbnN0e25hbWU6b309cjtyZXR1cm4gZnVuY3Rpb24ocil7Y29uc3Qgbj10aGlzW29dO2UuY2FsbCh0aGlzLHIpLHRoaXMucmVxdWVzdFVwZGF0ZShvLG4sdCk7fX10aHJvdyBFcnJvcigiVW5zdXBwb3J0ZWQgZGVjb3JhdG9yIGxvY2F0aW9uOiAiK24pfTtmdW5jdGlvbiBuJDIodCl7cmV0dXJuIChlLG8pPT4ib2JqZWN0Ij09dHlwZW9mIG8/ciQyKHQsZSxvKTooKHQsZSxvKT0+e2NvbnN0IHI9ZS5oYXNPd25Qcm9wZXJ0eShvKTtyZXR1cm4gZS5jb25zdHJ1Y3Rvci5jcmVhdGVQcm9wZXJ0eShvLHI/ey4uLnQsd3JhcHBlZDohMH06dCkscj9PYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsbyk6dm9pZCAwfSkodCxlLG8pfQoKICAvKioKICAgKiBAbGljZW5zZQogICAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTEMKICAgKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogQlNELTMtQ2xhdXNlCiAgICovZnVuY3Rpb24gciQxKHIpe3JldHVybiBuJDIoey4uLnIsc3RhdGU6ITAsYXR0cmlidXRlOiExfSl9CgogIC8qKgogICAqIEBsaWNlbnNlCiAgICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQwogICAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBCU0QtMy1DbGF1c2UKICAgKi8KICBjb25zdCBlJDU9KGUsdCxjKT0+KGMuY29uZmlndXJhYmxlPSEwLGMuZW51bWVyYWJsZT0hMCxSZWZsZWN0LmRlY29yYXRlJiYib2JqZWN0IiE9dHlwZW9mIHQmJk9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQsYyksYyk7CgogIC8qKgogICAqIEBsaWNlbnNlCiAgICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQwogICAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBCU0QtMy1DbGF1c2UKICAgKi9mdW5jdGlvbiBlJDQoZSxyKXtyZXR1cm4gKG4scyxpKT0+e2NvbnN0IG89dD0+dC5yZW5kZXJSb290Py5xdWVyeVNlbGVjdG9yKGUpPz9udWxsO2lmKHIpe2NvbnN0e2dldDplLHNldDpyfT0ib2JqZWN0Ij09dHlwZW9mIHM/bjppPz8oKCk9Pntjb25zdCB0PVN5bWJvbCgpO3JldHVybiB7Z2V0KCl7cmV0dXJuIHRoaXNbdF19LHNldChlKXt0aGlzW3RdPWU7fX19KSgpO3JldHVybiBlJDUobixzLHtnZXQoKXtsZXQgdD1lLmNhbGwodGhpcyk7cmV0dXJuIHZvaWQgMD09PXQmJih0PW8odGhpcyksKG51bGwhPT10fHx0aGlzLmhhc1VwZGF0ZWQpJiZyLmNhbGwodGhpcyx0KSksdH19KX1yZXR1cm4gZSQ1KG4scyx7Z2V0KCl7cmV0dXJuIG8odGhpcyl9fSl9fQoKICB2YXIgU2hvZWxhY2VFbGVtZW50ID0gY2xhc3MgZXh0ZW5kcyBzJDEgewogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHN1cGVyKCk7CiAgICAgIE9iamVjdC5lbnRyaWVzKHRoaXMuY29uc3RydWN0b3IuZGVwZW5kZW5jaWVzKS5mb3JFYWNoKChbbmFtZSwgY29tcG9uZW50XSkgPT4gewogICAgICAgIHRoaXMuY29uc3RydWN0b3IuZGVmaW5lKG5hbWUsIGNvbXBvbmVudCk7CiAgICAgIH0pOwogICAgfQogICAgZW1pdChuYW1lLCBvcHRpb25zKSB7CiAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KG5hbWUsIF9fc3ByZWFkVmFsdWVzKHsKICAgICAgICBidWJibGVzOiB0cnVlLAogICAgICAgIGNhbmNlbGFibGU6IGZhbHNlLAogICAgICAgIGNvbXBvc2VkOiB0cnVlLAogICAgICAgIGRldGFpbDoge30KICAgICAgfSwgb3B0aW9ucykpOwogICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICByZXR1cm4gZXZlbnQ7CiAgICB9CiAgICAvKiBlc2xpbnQtZW5hYmxlICovCiAgICBzdGF0aWMgZGVmaW5lKG5hbWUsIGVsZW1lbnRDb25zdHJ1Y3RvciA9IHRoaXMsIG9wdGlvbnMgPSB7fSkgewogICAgICBjb25zdCBjdXJyZW50bHlSZWdpc3RlcmVkQ29uc3RydWN0b3IgPSBjdXN0b21FbGVtZW50cy5nZXQobmFtZSk7CiAgICAgIGlmICghY3VycmVudGx5UmVnaXN0ZXJlZENvbnN0cnVjdG9yKSB7CiAgICAgICAgY3VzdG9tRWxlbWVudHMuZGVmaW5lKG5hbWUsIGNsYXNzIGV4dGVuZHMgZWxlbWVudENvbnN0cnVjdG9yIHsKICAgICAgICB9LCBvcHRpb25zKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbGV0IG5ld1ZlcnNpb24gPSAiICh1bmtub3duIHZlcnNpb24pIjsKICAgICAgbGV0IGV4aXN0aW5nVmVyc2lvbiA9IG5ld1ZlcnNpb247CiAgICAgIGlmICgidmVyc2lvbiIgaW4gZWxlbWVudENvbnN0cnVjdG9yICYmIGVsZW1lbnRDb25zdHJ1Y3Rvci52ZXJzaW9uKSB7CiAgICAgICAgbmV3VmVyc2lvbiA9ICIgdiIgKyBlbGVtZW50Q29uc3RydWN0b3IudmVyc2lvbjsKICAgICAgfQogICAgICBpZiAoInZlcnNpb24iIGluIGN1cnJlbnRseVJlZ2lzdGVyZWRDb25zdHJ1Y3RvciAmJiBjdXJyZW50bHlSZWdpc3RlcmVkQ29uc3RydWN0b3IudmVyc2lvbikgewogICAgICAgIGV4aXN0aW5nVmVyc2lvbiA9ICIgdiIgKyBjdXJyZW50bHlSZWdpc3RlcmVkQ29uc3RydWN0b3IudmVyc2lvbjsKICAgICAgfQogICAgICBpZiAobmV3VmVyc2lvbiAmJiBleGlzdGluZ1ZlcnNpb24gJiYgbmV3VmVyc2lvbiA9PT0gZXhpc3RpbmdWZXJzaW9uKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnNvbGUud2FybigKICAgICAgICBgQXR0ZW1wdGVkIHRvIHJlZ2lzdGVyIDwke25hbWV9PiR7bmV3VmVyc2lvbn0sIGJ1dCA8JHtuYW1lfT4ke2V4aXN0aW5nVmVyc2lvbn0gaGFzIGFscmVhZHkgYmVlbiByZWdpc3RlcmVkLmAKICAgICAgKTsKICAgIH0KICB9OwogIC8qIGVzbGludC1kaXNhYmxlICovCiAgLy8gQHRzLWV4cGVjdC1lcnJvciBUaGlzIGlzIGF1dG8taW5qZWN0ZWQgYXQgYnVpbGQgdGltZS4KICBTaG9lbGFjZUVsZW1lbnQudmVyc2lvbiA9ICIyLjEyLjAiOwogIFNob2VsYWNlRWxlbWVudC5kZXBlbmRlbmNpZXMgPSB7fTsKICBfX2RlY29yYXRlQ2xhc3MoWwogICAgbiQyKCkKICBdLCBTaG9lbGFjZUVsZW1lbnQucHJvdG90eXBlLCAiZGlyIiwgMik7CiAgX19kZWNvcmF0ZUNsYXNzKFsKICAgIG4kMigpCiAgXSwgU2hvZWxhY2VFbGVtZW50LnByb3RvdHlwZSwgImxhbmciLCAyKTsKCiAgLyoqCiAgICogQ3VzdG9tIHBvc2l0aW9uaW5nIHJlZmVyZW5jZSBlbGVtZW50LgogICAqIEBzZWUgaHR0cHM6Ly9mbG9hdGluZy11aS5jb20vZG9jcy92aXJ0dWFsLWVsZW1lbnRzCiAgICovCgogIGNvbnN0IG1pbiA9IE1hdGgubWluOwogIGNvbnN0IG1heCA9IE1hdGgubWF4OwogIGNvbnN0IHJvdW5kID0gTWF0aC5yb3VuZDsKICBjb25zdCBmbG9vciA9IE1hdGguZmxvb3I7CiAgY29uc3QgY3JlYXRlQ29vcmRzID0gdiA9PiAoewogICAgeDogdiwKICAgIHk6IHYKICB9KTsKICBjb25zdCBvcHBvc2l0ZVNpZGVNYXAgPSB7CiAgICBsZWZ0OiAncmlnaHQnLAogICAgcmlnaHQ6ICdsZWZ0JywKICAgIGJvdHRvbTogJ3RvcCcsCiAgICB0b3A6ICdib3R0b20nCiAgfTsKICBjb25zdCBvcHBvc2l0ZUFsaWdubWVudE1hcCA9IHsKICAgIHN0YXJ0OiAnZW5kJywKICAgIGVuZDogJ3N0YXJ0JwogIH07CiAgZnVuY3Rpb24gY2xhbXAoc3RhcnQsIHZhbHVlLCBlbmQpIHsKICAgIHJldHVybiBtYXgoc3RhcnQsIG1pbih2YWx1ZSwgZW5kKSk7CiAgfQogIGZ1bmN0aW9uIGV2YWx1YXRlKHZhbHVlLCBwYXJhbSkgewogICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJyA/IHZhbHVlKHBhcmFtKSA6IHZhbHVlOwogIH0KICBmdW5jdGlvbiBnZXRTaWRlKHBsYWNlbWVudCkgewogICAgcmV0dXJuIHBsYWNlbWVudC5zcGxpdCgnLScpWzBdOwogIH0KICBmdW5jdGlvbiBnZXRBbGlnbm1lbnQocGxhY2VtZW50KSB7CiAgICByZXR1cm4gcGxhY2VtZW50LnNwbGl0KCctJylbMV07CiAgfQogIGZ1bmN0aW9uIGdldE9wcG9zaXRlQXhpcyhheGlzKSB7CiAgICByZXR1cm4gYXhpcyA9PT0gJ3gnID8gJ3knIDogJ3gnOwogIH0KICBmdW5jdGlvbiBnZXRBeGlzTGVuZ3RoKGF4aXMpIHsKICAgIHJldHVybiBheGlzID09PSAneScgPyAnaGVpZ2h0JyA6ICd3aWR0aCc7CiAgfQogIGZ1bmN0aW9uIGdldFNpZGVBeGlzKHBsYWNlbWVudCkgewogICAgcmV0dXJuIFsndG9wJywgJ2JvdHRvbSddLmluY2x1ZGVzKGdldFNpZGUocGxhY2VtZW50KSkgPyAneScgOiAneCc7CiAgfQogIGZ1bmN0aW9uIGdldEFsaWdubWVudEF4aXMocGxhY2VtZW50KSB7CiAgICByZXR1cm4gZ2V0T3Bwb3NpdGVBeGlzKGdldFNpZGVBeGlzKHBsYWNlbWVudCkpOwogIH0KICBmdW5jdGlvbiBnZXRBbGlnbm1lbnRTaWRlcyhwbGFjZW1lbnQsIHJlY3RzLCBydGwpIHsKICAgIGlmIChydGwgPT09IHZvaWQgMCkgewogICAgICBydGwgPSBmYWxzZTsKICAgIH0KICAgIGNvbnN0IGFsaWdubWVudCA9IGdldEFsaWdubWVudChwbGFjZW1lbnQpOwogICAgY29uc3QgYWxpZ25tZW50QXhpcyA9IGdldEFsaWdubWVudEF4aXMocGxhY2VtZW50KTsKICAgIGNvbnN0IGxlbmd0aCA9IGdldEF4aXNMZW5ndGgoYWxpZ25tZW50QXhpcyk7CiAgICBsZXQgbWFpbkFsaWdubWVudFNpZGUgPSBhbGlnbm1lbnRBeGlzID09PSAneCcgPyBhbGlnbm1lbnQgPT09IChydGwgPyAnZW5kJyA6ICdzdGFydCcpID8gJ3JpZ2h0JyA6ICdsZWZ0JyA6IGFsaWdubWVudCA9PT0gJ3N0YXJ0JyA/ICdib3R0b20nIDogJ3RvcCc7CiAgICBpZiAocmVjdHMucmVmZXJlbmNlW2xlbmd0aF0gPiByZWN0cy5mbG9hdGluZ1tsZW5ndGhdKSB7CiAgICAgIG1haW5BbGlnbm1lbnRTaWRlID0gZ2V0T3Bwb3NpdGVQbGFjZW1lbnQobWFpbkFsaWdubWVudFNpZGUpOwogICAgfQogICAgcmV0dXJuIFttYWluQWxpZ25tZW50U2lkZSwgZ2V0T3Bwb3NpdGVQbGFjZW1lbnQobWFpbkFsaWdubWVudFNpZGUpXTsKICB9CiAgZnVuY3Rpb24gZ2V0RXhwYW5kZWRQbGFjZW1lbnRzKHBsYWNlbWVudCkgewogICAgY29uc3Qgb3Bwb3NpdGVQbGFjZW1lbnQgPSBnZXRPcHBvc2l0ZVBsYWNlbWVudChwbGFjZW1lbnQpOwogICAgcmV0dXJuIFtnZXRPcHBvc2l0ZUFsaWdubWVudFBsYWNlbWVudChwbGFjZW1lbnQpLCBvcHBvc2l0ZVBsYWNlbWVudCwgZ2V0T3Bwb3NpdGVBbGlnbm1lbnRQbGFjZW1lbnQob3Bwb3NpdGVQbGFjZW1lbnQpXTsKICB9CiAgZnVuY3Rpb24gZ2V0T3Bwb3NpdGVBbGlnbm1lbnRQbGFjZW1lbnQocGxhY2VtZW50KSB7CiAgICByZXR1cm4gcGxhY2VtZW50LnJlcGxhY2UoL3N0YXJ0fGVuZC9nLCBhbGlnbm1lbnQgPT4gb3Bwb3NpdGVBbGlnbm1lbnRNYXBbYWxpZ25tZW50XSk7CiAgfQogIGZ1bmN0aW9uIGdldFNpZGVMaXN0KHNpZGUsIGlzU3RhcnQsIHJ0bCkgewogICAgY29uc3QgbHIgPSBbJ2xlZnQnLCAncmlnaHQnXTsKICAgIGNvbnN0IHJsID0gWydyaWdodCcsICdsZWZ0J107CiAgICBjb25zdCB0YiA9IFsndG9wJywgJ2JvdHRvbSddOwogICAgY29uc3QgYnQgPSBbJ2JvdHRvbScsICd0b3AnXTsKICAgIHN3aXRjaCAoc2lkZSkgewogICAgICBjYXNlICd0b3AnOgogICAgICBjYXNlICdib3R0b20nOgogICAgICAgIGlmIChydGwpIHJldHVybiBpc1N0YXJ0ID8gcmwgOiBscjsKICAgICAgICByZXR1cm4gaXNTdGFydCA/IGxyIDogcmw7CiAgICAgIGNhc2UgJ2xlZnQnOgogICAgICBjYXNlICdyaWdodCc6CiAgICAgICAgcmV0dXJuIGlzU3RhcnQgPyB0YiA6IGJ0OwogICAgICBkZWZhdWx0OgogICAgICAgIHJldHVybiBbXTsKICAgIH0KICB9CiAgZnVuY3Rpb24gZ2V0T3Bwb3NpdGVBeGlzUGxhY2VtZW50cyhwbGFjZW1lbnQsIGZsaXBBbGlnbm1lbnQsIGRpcmVjdGlvbiwgcnRsKSB7CiAgICBjb25zdCBhbGlnbm1lbnQgPSBnZXRBbGlnbm1lbnQocGxhY2VtZW50KTsKICAgIGxldCBsaXN0ID0gZ2V0U2lkZUxpc3QoZ2V0U2lkZShwbGFjZW1lbnQpLCBkaXJlY3Rpb24gPT09ICdzdGFydCcsIHJ0bCk7CiAgICBpZiAoYWxpZ25tZW50KSB7CiAgICAgIGxpc3QgPSBsaXN0Lm1hcChzaWRlID0+IHNpZGUgKyAiLSIgKyBhbGlnbm1lbnQpOwogICAgICBpZiAoZmxpcEFsaWdubWVudCkgewogICAgICAgIGxpc3QgPSBsaXN0LmNvbmNhdChsaXN0Lm1hcChnZXRPcHBvc2l0ZUFsaWdubWVudFBsYWNlbWVudCkpOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gbGlzdDsKICB9CiAgZnVuY3Rpb24gZ2V0T3Bwb3NpdGVQbGFjZW1lbnQocGxhY2VtZW50KSB7CiAgICByZXR1cm4gcGxhY2VtZW50LnJlcGxhY2UoL2xlZnR8cmlnaHR8Ym90dG9tfHRvcC9nLCBzaWRlID0+IG9wcG9zaXRlU2lkZU1hcFtzaWRlXSk7CiAgfQogIGZ1bmN0aW9uIGV4cGFuZFBhZGRpbmdPYmplY3QocGFkZGluZykgewogICAgcmV0dXJuIHsKICAgICAgdG9wOiAwLAogICAgICByaWdodDogMCwKICAgICAgYm90dG9tOiAwLAogICAgICBsZWZ0OiAwLAogICAgICAuLi5wYWRkaW5nCiAgICB9OwogIH0KICBmdW5jdGlvbiBnZXRQYWRkaW5nT2JqZWN0KHBhZGRpbmcpIHsKICAgIHJldHVybiB0eXBlb2YgcGFkZGluZyAhPT0gJ251bWJlcicgPyBleHBhbmRQYWRkaW5nT2JqZWN0KHBhZGRpbmcpIDogewogICAgICB0b3A6IHBhZGRpbmcsCiAgICAgIHJpZ2h0OiBwYWRkaW5nLAogICAgICBib3R0b206IHBhZGRpbmcsCiAgICAgIGxlZnQ6IHBhZGRpbmcKICAgIH07CiAgfQogIGZ1bmN0aW9uIHJlY3RUb0NsaWVudFJlY3QocmVjdCkgewogICAgcmV0dXJuIHsKICAgICAgLi4ucmVjdCwKICAgICAgdG9wOiByZWN0LnksCiAgICAgIGxlZnQ6IHJlY3QueCwKICAgICAgcmlnaHQ6IHJlY3QueCArIHJlY3Qud2lkdGgsCiAgICAgIGJvdHRvbTogcmVjdC55ICsgcmVjdC5oZWlnaHQKICAgIH07CiAgfQoKICBmdW5jdGlvbiBjb21wdXRlQ29vcmRzRnJvbVBsYWNlbWVudChfcmVmLCBwbGFjZW1lbnQsIHJ0bCkgewogICAgbGV0IHsKICAgICAgcmVmZXJlbmNlLAogICAgICBmbG9hdGluZwogICAgfSA9IF9yZWY7CiAgICBjb25zdCBzaWRlQXhpcyA9IGdldFNpZGVBeGlzKHBsYWNlbWVudCk7CiAgICBjb25zdCBhbGlnbm1lbnRBeGlzID0gZ2V0QWxpZ25tZW50QXhpcyhwbGFjZW1lbnQpOwogICAgY29uc3QgYWxpZ25MZW5ndGggPSBnZXRBeGlzTGVuZ3RoKGFsaWdubWVudEF4aXMpOwogICAgY29uc3Qgc2lkZSA9IGdldFNpZGUocGxhY2VtZW50KTsKICAgIGNvbnN0IGlzVmVydGljYWwgPSBzaWRlQXhpcyA9PT0gJ3knOwogICAgY29uc3QgY29tbW9uWCA9IHJlZmVyZW5jZS54ICsgcmVmZXJlbmNlLndpZHRoIC8gMiAtIGZsb2F0aW5nLndpZHRoIC8gMjsKICAgIGNvbnN0IGNvbW1vblkgPSByZWZlcmVuY2UueSArIHJlZmVyZW5jZS5oZWlnaHQgLyAyIC0gZmxvYXRpbmcuaGVpZ2h0IC8gMjsKICAgIGNvbnN0IGNvbW1vbkFsaWduID0gcmVmZXJlbmNlW2FsaWduTGVuZ3RoXSAvIDIgLSBmbG9hdGluZ1thbGlnbkxlbmd0aF0gLyAyOwogICAgbGV0IGNvb3JkczsKICAgIHN3aXRjaCAoc2lkZSkgewogICAgICBjYXNlICd0b3AnOgogICAgICAgIGNvb3JkcyA9IHsKICAgICAgICAgIHg6IGNvbW1vblgsCiAgICAgICAgICB5OiByZWZlcmVuY2UueSAtIGZsb2F0aW5nLmhlaWdodAogICAgICAgIH07CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2JvdHRvbSc6CiAgICAgICAgY29vcmRzID0gewogICAgICAgICAgeDogY29tbW9uWCwKICAgICAgICAgIHk6IHJlZmVyZW5jZS55ICsgcmVmZXJlbmNlLmhlaWdodAogICAgICAgIH07CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3JpZ2h0JzoKICAgICAgICBjb29yZHMgPSB7CiAgICAgICAgICB4OiByZWZlcmVuY2UueCArIHJlZmVyZW5jZS53aWR0aCwKICAgICAgICAgIHk6IGNvbW1vblkKICAgICAgICB9OwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdsZWZ0JzoKICAgICAgICBjb29yZHMgPSB7CiAgICAgICAgICB4OiByZWZlcmVuY2UueCAtIGZsb2F0aW5nLndpZHRoLAogICAgICAgICAgeTogY29tbW9uWQogICAgICAgIH07CiAgICAgICAgYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgY29vcmRzID0gewogICAgICAgICAgeDogcmVmZXJlbmNlLngsCiAgICAgICAgICB5OiByZWZlcmVuY2UueQogICAgICAgIH07CiAgICB9CiAgICBzd2l0Y2ggKGdldEFsaWdubWVudChwbGFjZW1lbnQpKSB7CiAgICAgIGNhc2UgJ3N0YXJ0JzoKICAgICAgICBjb29yZHNbYWxpZ25tZW50QXhpc10gLT0gY29tbW9uQWxpZ24gKiAocnRsICYmIGlzVmVydGljYWwgPyAtMSA6IDEpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdlbmQnOgogICAgICAgIGNvb3Jkc1thbGlnbm1lbnRBeGlzXSArPSBjb21tb25BbGlnbiAqIChydGwgJiYgaXNWZXJ0aWNhbCA/IC0xIDogMSk7CiAgICAgICAgYnJlYWs7CiAgICB9CiAgICByZXR1cm4gY29vcmRzOwogIH0KCiAgLyoqCiAgICogQ29tcHV0ZXMgdGhlIGB4YCBhbmQgYHlgIGNvb3JkaW5hdGVzIHRoYXQgd2lsbCBwbGFjZSB0aGUgZmxvYXRpbmcgZWxlbWVudAogICAqIG5leHQgdG8gYSBnaXZlbiByZWZlcmVuY2UgZWxlbWVudC4KICAgKgogICAqIFRoaXMgZXhwb3J0IGRvZXMgbm90IGhhdmUgYW55IGBwbGF0Zm9ybWAgaW50ZXJmYWNlIGxvZ2ljLiBZb3Ugd2lsbCBuZWVkIHRvCiAgICogd3JpdGUgb25lIGZvciB0aGUgcGxhdGZvcm0geW91IGFyZSB1c2luZyBGbG9hdGluZyBVSSB3aXRoLgogICAqLwogIGNvbnN0IGNvbXB1dGVQb3NpdGlvbiQxID0gYXN5bmMgKHJlZmVyZW5jZSwgZmxvYXRpbmcsIGNvbmZpZykgPT4gewogICAgY29uc3QgewogICAgICBwbGFjZW1lbnQgPSAnYm90dG9tJywKICAgICAgc3RyYXRlZ3kgPSAnYWJzb2x1dGUnLAogICAgICBtaWRkbGV3YXJlID0gW10sCiAgICAgIHBsYXRmb3JtCiAgICB9ID0gY29uZmlnOwogICAgY29uc3QgdmFsaWRNaWRkbGV3YXJlID0gbWlkZGxld2FyZS5maWx0ZXIoQm9vbGVhbik7CiAgICBjb25zdCBydGwgPSBhd2FpdCAocGxhdGZvcm0uaXNSVEwgPT0gbnVsbCA/IHZvaWQgMCA6IHBsYXRmb3JtLmlzUlRMKGZsb2F0aW5nKSk7CiAgICBsZXQgcmVjdHMgPSBhd2FpdCBwbGF0Zm9ybS5nZXRFbGVtZW50UmVjdHMoewogICAgICByZWZlcmVuY2UsCiAgICAgIGZsb2F0aW5nLAogICAgICBzdHJhdGVneQogICAgfSk7CiAgICBsZXQgewogICAgICB4LAogICAgICB5CiAgICB9ID0gY29tcHV0ZUNvb3Jkc0Zyb21QbGFjZW1lbnQocmVjdHMsIHBsYWNlbWVudCwgcnRsKTsKICAgIGxldCBzdGF0ZWZ1bFBsYWNlbWVudCA9IHBsYWNlbWVudDsKICAgIGxldCBtaWRkbGV3YXJlRGF0YSA9IHt9OwogICAgbGV0IHJlc2V0Q291bnQgPSAwOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2YWxpZE1pZGRsZXdhcmUubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgewogICAgICAgIG5hbWUsCiAgICAgICAgZm4KICAgICAgfSA9IHZhbGlkTWlkZGxld2FyZVtpXTsKICAgICAgY29uc3QgewogICAgICAgIHg6IG5leHRYLAogICAgICAgIHk6IG5leHRZLAogICAgICAgIGRhdGEsCiAgICAgICAgcmVzZXQKICAgICAgfSA9IGF3YWl0IGZuKHsKICAgICAgICB4LAogICAgICAgIHksCiAgICAgICAgaW5pdGlhbFBsYWNlbWVudDogcGxhY2VtZW50LAogICAgICAgIHBsYWNlbWVudDogc3RhdGVmdWxQbGFjZW1lbnQsCiAgICAgICAgc3RyYXRlZ3ksCiAgICAgICAgbWlkZGxld2FyZURhdGEsCiAgICAgICAgcmVjdHMsCiAgICAgICAgcGxhdGZvcm0sCiAgICAgICAgZWxlbWVudHM6IHsKICAgICAgICAgIHJlZmVyZW5jZSwKICAgICAgICAgIGZsb2F0aW5nCiAgICAgICAgfQogICAgICB9KTsKICAgICAgeCA9IG5leHRYICE9IG51bGwgPyBuZXh0WCA6IHg7CiAgICAgIHkgPSBuZXh0WSAhPSBudWxsID8gbmV4dFkgOiB5OwogICAgICBtaWRkbGV3YXJlRGF0YSA9IHsKICAgICAgICAuLi5taWRkbGV3YXJlRGF0YSwKICAgICAgICBbbmFtZV06IHsKICAgICAgICAgIC4uLm1pZGRsZXdhcmVEYXRhW25hbWVdLAogICAgICAgICAgLi4uZGF0YQogICAgICAgIH0KICAgICAgfTsKICAgICAgaWYgKHJlc2V0ICYmIHJlc2V0Q291bnQgPD0gNTApIHsKICAgICAgICByZXNldENvdW50Kys7CiAgICAgICAgaWYgKHR5cGVvZiByZXNldCA9PT0gJ29iamVjdCcpIHsKICAgICAgICAgIGlmIChyZXNldC5wbGFjZW1lbnQpIHsKICAgICAgICAgICAgc3RhdGVmdWxQbGFjZW1lbnQgPSByZXNldC5wbGFjZW1lbnQ7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAocmVzZXQucmVjdHMpIHsKICAgICAgICAgICAgcmVjdHMgPSByZXNldC5yZWN0cyA9PT0gdHJ1ZSA/IGF3YWl0IHBsYXRmb3JtLmdldEVsZW1lbnRSZWN0cyh7CiAgICAgICAgICAgICAgcmVmZXJlbmNlLAogICAgICAgICAgICAgIGZsb2F0aW5nLAogICAgICAgICAgICAgIHN0cmF0ZWd5CiAgICAgICAgICAgIH0pIDogcmVzZXQucmVjdHM7CiAgICAgICAgICB9CiAgICAgICAgICAoewogICAgICAgICAgICB4LAogICAgICAgICAgICB5CiAgICAgICAgICB9ID0gY29tcHV0ZUNvb3Jkc0Zyb21QbGFjZW1lbnQocmVjdHMsIHN0YXRlZnVsUGxhY2VtZW50LCBydGwpKTsKICAgICAgICB9CiAgICAgICAgaSA9IC0xOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gewogICAgICB4LAogICAgICB5LAogICAgICBwbGFjZW1lbnQ6IHN0YXRlZnVsUGxhY2VtZW50LAogICAgICBzdHJhdGVneSwKICAgICAgbWlkZGxld2FyZURhdGEKICAgIH07CiAgfTsKCiAgLyoqCiAgICogUmVzb2x2ZXMgd2l0aCBhbiBvYmplY3Qgb2Ygb3ZlcmZsb3cgc2lkZSBvZmZzZXRzIHRoYXQgZGV0ZXJtaW5lIGhvdyBtdWNoIHRoZQogICAqIGVsZW1lbnQgaXMgb3ZlcmZsb3dpbmcgYSBnaXZlbiBjbGlwcGluZyBib3VuZGFyeSBvbiBlYWNoIHNpZGUuCiAgICogLSBwb3NpdGl2ZSA9IG92ZXJmbG93aW5nIHRoZSBib3VuZGFyeSBieSB0aGF0IG51bWJlciBvZiBwaXhlbHMKICAgKiAtIG5lZ2F0aXZlID0gaG93IG1hbnkgcGl4ZWxzIGxlZnQgYmVmb3JlIGl0IHdpbGwgb3ZlcmZsb3cKICAgKiAtIDAgPSBsaWVzIGZsdXNoIHdpdGggdGhlIGJvdW5kYXJ5CiAgICogQHNlZSBodHRwczovL2Zsb2F0aW5nLXVpLmNvbS9kb2NzL2RldGVjdE92ZXJmbG93CiAgICovCiAgYXN5bmMgZnVuY3Rpb24gZGV0ZWN0T3ZlcmZsb3coc3RhdGUsIG9wdGlvbnMpIHsKICAgIHZhciBfYXdhaXQkcGxhdGZvcm0kaXNFbGU7CiAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgIG9wdGlvbnMgPSB7fTsKICAgIH0KICAgIGNvbnN0IHsKICAgICAgeCwKICAgICAgeSwKICAgICAgcGxhdGZvcm0sCiAgICAgIHJlY3RzLAogICAgICBlbGVtZW50cywKICAgICAgc3RyYXRlZ3kKICAgIH0gPSBzdGF0ZTsKICAgIGNvbnN0IHsKICAgICAgYm91bmRhcnkgPSAnY2xpcHBpbmdBbmNlc3RvcnMnLAogICAgICByb290Qm91bmRhcnkgPSAndmlld3BvcnQnLAogICAgICBlbGVtZW50Q29udGV4dCA9ICdmbG9hdGluZycsCiAgICAgIGFsdEJvdW5kYXJ5ID0gZmFsc2UsCiAgICAgIHBhZGRpbmcgPSAwCiAgICB9ID0gZXZhbHVhdGUob3B0aW9ucywgc3RhdGUpOwogICAgY29uc3QgcGFkZGluZ09iamVjdCA9IGdldFBhZGRpbmdPYmplY3QocGFkZGluZyk7CiAgICBjb25zdCBhbHRDb250ZXh0ID0gZWxlbWVudENvbnRleHQgPT09ICdmbG9hdGluZycgPyAncmVmZXJlbmNlJyA6ICdmbG9hdGluZyc7CiAgICBjb25zdCBlbGVtZW50ID0gZWxlbWVudHNbYWx0Qm91bmRhcnkgPyBhbHRDb250ZXh0IDogZWxlbWVudENvbnRleHRdOwogICAgY29uc3QgY2xpcHBpbmdDbGllbnRSZWN0ID0gcmVjdFRvQ2xpZW50UmVjdChhd2FpdCBwbGF0Zm9ybS5nZXRDbGlwcGluZ1JlY3QoewogICAgICBlbGVtZW50OiAoKF9hd2FpdCRwbGF0Zm9ybSRpc0VsZSA9IGF3YWl0IChwbGF0Zm9ybS5pc0VsZW1lbnQgPT0gbnVsbCA/IHZvaWQgMCA6IHBsYXRmb3JtLmlzRWxlbWVudChlbGVtZW50KSkpICE9IG51bGwgPyBfYXdhaXQkcGxhdGZvcm0kaXNFbGUgOiB0cnVlKSA/IGVsZW1lbnQgOiBlbGVtZW50LmNvbnRleHRFbGVtZW50IHx8IChhd2FpdCAocGxhdGZvcm0uZ2V0RG9jdW1lbnRFbGVtZW50ID09IG51bGwgPyB2b2lkIDAgOiBwbGF0Zm9ybS5nZXREb2N1bWVudEVsZW1lbnQoZWxlbWVudHMuZmxvYXRpbmcpKSksCiAgICAgIGJvdW5kYXJ5LAogICAgICByb290Qm91bmRhcnksCiAgICAgIHN0cmF0ZWd5CiAgICB9KSk7CiAgICBjb25zdCByZWN0ID0gZWxlbWVudENvbnRleHQgPT09ICdmbG9hdGluZycgPyB7CiAgICAgIC4uLnJlY3RzLmZsb2F0aW5nLAogICAgICB4LAogICAgICB5CiAgICB9IDogcmVjdHMucmVmZXJlbmNlOwogICAgY29uc3Qgb2Zmc2V0UGFyZW50ID0gYXdhaXQgKHBsYXRmb3JtLmdldE9mZnNldFBhcmVudCA9PSBudWxsID8gdm9pZCAwIDogcGxhdGZvcm0uZ2V0T2Zmc2V0UGFyZW50KGVsZW1lbnRzLmZsb2F0aW5nKSk7CiAgICBjb25zdCBvZmZzZXRTY2FsZSA9IChhd2FpdCAocGxhdGZvcm0uaXNFbGVtZW50ID09IG51bGwgPyB2b2lkIDAgOiBwbGF0Zm9ybS5pc0VsZW1lbnQob2Zmc2V0UGFyZW50KSkpID8gKGF3YWl0IChwbGF0Zm9ybS5nZXRTY2FsZSA9PSBudWxsID8gdm9pZCAwIDogcGxhdGZvcm0uZ2V0U2NhbGUob2Zmc2V0UGFyZW50KSkpIHx8IHsKICAgICAgeDogMSwKICAgICAgeTogMQogICAgfSA6IHsKICAgICAgeDogMSwKICAgICAgeTogMQogICAgfTsKICAgIGNvbnN0IGVsZW1lbnRDbGllbnRSZWN0ID0gcmVjdFRvQ2xpZW50UmVjdChwbGF0Zm9ybS5jb252ZXJ0T2Zmc2V0UGFyZW50UmVsYXRpdmVSZWN0VG9WaWV3cG9ydFJlbGF0aXZlUmVjdCA/IGF3YWl0IHBsYXRmb3JtLmNvbnZlcnRPZmZzZXRQYXJlbnRSZWxhdGl2ZVJlY3RUb1ZpZXdwb3J0UmVsYXRpdmVSZWN0KHsKICAgICAgcmVjdCwKICAgICAgb2Zmc2V0UGFyZW50LAogICAgICBzdHJhdGVneQogICAgfSkgOiByZWN0KTsKICAgIHJldHVybiB7CiAgICAgIHRvcDogKGNsaXBwaW5nQ2xpZW50UmVjdC50b3AgLSBlbGVtZW50Q2xpZW50UmVjdC50b3AgKyBwYWRkaW5nT2JqZWN0LnRvcCkgLyBvZmZzZXRTY2FsZS55LAogICAgICBib3R0b206IChlbGVtZW50Q2xpZW50UmVjdC5ib3R0b20gLSBjbGlwcGluZ0NsaWVudFJlY3QuYm90dG9tICsgcGFkZGluZ09iamVjdC5ib3R0b20pIC8gb2Zmc2V0U2NhbGUueSwKICAgICAgbGVmdDogKGNsaXBwaW5nQ2xpZW50UmVjdC5sZWZ0IC0gZWxlbWVudENsaWVudFJlY3QubGVmdCArIHBhZGRpbmdPYmplY3QubGVmdCkgLyBvZmZzZXRTY2FsZS54LAogICAgICByaWdodDogKGVsZW1lbnRDbGllbnRSZWN0LnJpZ2h0IC0gY2xpcHBpbmdDbGllbnRSZWN0LnJpZ2h0ICsgcGFkZGluZ09iamVjdC5yaWdodCkgLyBvZmZzZXRTY2FsZS54CiAgICB9OwogIH0KCiAgLyoqCiAgICogUHJvdmlkZXMgZGF0YSB0byBwb3NpdGlvbiBhbiBpbm5lciBlbGVtZW50IG9mIHRoZSBmbG9hdGluZyBlbGVtZW50IHNvIHRoYXQgaXQKICAgKiBhcHBlYXJzIGNlbnRlcmVkIHRvIHRoZSByZWZlcmVuY2UgZWxlbWVudC4KICAgKiBAc2VlIGh0dHBzOi8vZmxvYXRpbmctdWkuY29tL2RvY3MvYXJyb3cKICAgKi8KICBjb25zdCBhcnJvdyQxID0gb3B0aW9ucyA9PiAoewogICAgbmFtZTogJ2Fycm93JywKICAgIG9wdGlvbnMsCiAgICBhc3luYyBmbihzdGF0ZSkgewogICAgICBjb25zdCB7CiAgICAgICAgeCwKICAgICAgICB5LAogICAgICAgIHBsYWNlbWVudCwKICAgICAgICByZWN0cywKICAgICAgICBwbGF0Zm9ybSwKICAgICAgICBlbGVtZW50cywKICAgICAgICBtaWRkbGV3YXJlRGF0YQogICAgICB9ID0gc3RhdGU7CiAgICAgIC8vIFNpbmNlIGBlbGVtZW50YCBpcyByZXF1aXJlZCwgd2UgZG9uJ3QgUGFydGlhbDw+IHRoZSB0eXBlLgogICAgICBjb25zdCB7CiAgICAgICAgZWxlbWVudCwKICAgICAgICBwYWRkaW5nID0gMAogICAgICB9ID0gZXZhbHVhdGUob3B0aW9ucywgc3RhdGUpIHx8IHt9OwogICAgICBpZiAoZWxlbWVudCA9PSBudWxsKSB7CiAgICAgICAgcmV0dXJuIHt9OwogICAgICB9CiAgICAgIGNvbnN0IHBhZGRpbmdPYmplY3QgPSBnZXRQYWRkaW5nT2JqZWN0KHBhZGRpbmcpOwogICAgICBjb25zdCBjb29yZHMgPSB7CiAgICAgICAgeCwKICAgICAgICB5CiAgICAgIH07CiAgICAgIGNvbnN0IGF4aXMgPSBnZXRBbGlnbm1lbnRBeGlzKHBsYWNlbWVudCk7CiAgICAgIGNvbnN0IGxlbmd0aCA9IGdldEF4aXNMZW5ndGgoYXhpcyk7CiAgICAgIGNvbnN0IGFycm93RGltZW5zaW9ucyA9IGF3YWl0IHBsYXRmb3JtLmdldERpbWVuc2lvbnMoZWxlbWVudCk7CiAgICAgIGNvbnN0IGlzWUF4aXMgPSBheGlzID09PSAneSc7CiAgICAgIGNvbnN0IG1pblByb3AgPSBpc1lBeGlzID8gJ3RvcCcgOiAnbGVmdCc7CiAgICAgIGNvbnN0IG1heFByb3AgPSBpc1lBeGlzID8gJ2JvdHRvbScgOiAncmlnaHQnOwogICAgICBjb25zdCBjbGllbnRQcm9wID0gaXNZQXhpcyA/ICdjbGllbnRIZWlnaHQnIDogJ2NsaWVudFdpZHRoJzsKICAgICAgY29uc3QgZW5kRGlmZiA9IHJlY3RzLnJlZmVyZW5jZVtsZW5ndGhdICsgcmVjdHMucmVmZXJlbmNlW2F4aXNdIC0gY29vcmRzW2F4aXNdIC0gcmVjdHMuZmxvYXRpbmdbbGVuZ3RoXTsKICAgICAgY29uc3Qgc3RhcnREaWZmID0gY29vcmRzW2F4aXNdIC0gcmVjdHMucmVmZXJlbmNlW2F4aXNdOwogICAgICBjb25zdCBhcnJvd09mZnNldFBhcmVudCA9IGF3YWl0IChwbGF0Zm9ybS5nZXRPZmZzZXRQYXJlbnQgPT0gbnVsbCA/IHZvaWQgMCA6IHBsYXRmb3JtLmdldE9mZnNldFBhcmVudChlbGVtZW50KSk7CiAgICAgIGxldCBjbGllbnRTaXplID0gYXJyb3dPZmZzZXRQYXJlbnQgPyBhcnJvd09mZnNldFBhcmVudFtjbGllbnRQcm9wXSA6IDA7CgogICAgICAvLyBET00gcGxhdGZvcm0gY2FuIHJldHVybiBgd2luZG93YCBhcyB0aGUgYG9mZnNldFBhcmVudGAuCiAgICAgIGlmICghY2xpZW50U2l6ZSB8fCAhKGF3YWl0IChwbGF0Zm9ybS5pc0VsZW1lbnQgPT0gbnVsbCA/IHZvaWQgMCA6IHBsYXRmb3JtLmlzRWxlbWVudChhcnJvd09mZnNldFBhcmVudCkpKSkgewogICAgICAgIGNsaWVudFNpemUgPSBlbGVtZW50cy5mbG9hdGluZ1tjbGllbnRQcm9wXSB8fCByZWN0cy5mbG9hdGluZ1tsZW5ndGhdOwogICAgICB9CiAgICAgIGNvbnN0IGNlbnRlclRvUmVmZXJlbmNlID0gZW5kRGlmZiAvIDIgLSBzdGFydERpZmYgLyAyOwoKICAgICAgLy8gSWYgdGhlIHBhZGRpbmcgaXMgbGFyZ2UgZW5vdWdoIHRoYXQgaXQgY2F1c2VzIHRoZSBhcnJvdyB0byBubyBsb25nZXIgYmUKICAgICAgLy8gY2VudGVyZWQsIG1vZGlmeSB0aGUgcGFkZGluZyBzbyB0aGF0IGl0IGlzIGNlbnRlcmVkLgogICAgICBjb25zdCBsYXJnZXN0UG9zc2libGVQYWRkaW5nID0gY2xpZW50U2l6ZSAvIDIgLSBhcnJvd0RpbWVuc2lvbnNbbGVuZ3RoXSAvIDIgLSAxOwogICAgICBjb25zdCBtaW5QYWRkaW5nID0gbWluKHBhZGRpbmdPYmplY3RbbWluUHJvcF0sIGxhcmdlc3RQb3NzaWJsZVBhZGRpbmcpOwogICAgICBjb25zdCBtYXhQYWRkaW5nID0gbWluKHBhZGRpbmdPYmplY3RbbWF4UHJvcF0sIGxhcmdlc3RQb3NzaWJsZVBhZGRpbmcpOwoKICAgICAgLy8gTWFrZSBzdXJlIHRoZSBhcnJvdyBkb2Vzbid0IG92ZXJmbG93IHRoZSBmbG9hdGluZyBlbGVtZW50IGlmIHRoZSBjZW50ZXIKICAgICAgLy8gcG9pbnQgaXMgb3V0c2lkZSB0aGUgZmxvYXRpbmcgZWxlbWVudCdzIGJvdW5kcy4KICAgICAgY29uc3QgbWluJDEgPSBtaW5QYWRkaW5nOwogICAgICBjb25zdCBtYXggPSBjbGllbnRTaXplIC0gYXJyb3dEaW1lbnNpb25zW2xlbmd0aF0gLSBtYXhQYWRkaW5nOwogICAgICBjb25zdCBjZW50ZXIgPSBjbGllbnRTaXplIC8gMiAtIGFycm93RGltZW5zaW9uc1tsZW5ndGhdIC8gMiArIGNlbnRlclRvUmVmZXJlbmNlOwogICAgICBjb25zdCBvZmZzZXQgPSBjbGFtcChtaW4kMSwgY2VudGVyLCBtYXgpOwoKICAgICAgLy8gSWYgdGhlIHJlZmVyZW5jZSBpcyBzbWFsbCBlbm91Z2ggdGhhdCB0aGUgYXJyb3cncyBwYWRkaW5nIGNhdXNlcyBpdCB0bwogICAgICAvLyB0byBwb2ludCB0byBub3RoaW5nIGZvciBhbiBhbGlnbmVkIHBsYWNlbWVudCwgYWRqdXN0IHRoZSBvZmZzZXQgb2YgdGhlCiAgICAgIC8vIGZsb2F0aW5nIGVsZW1lbnQgaXRzZWxmLiBUbyBlbnN1cmUgYHNoaWZ0KClgIGNvbnRpbnVlcyB0byB0YWtlIGFjdGlvbiwKICAgICAgLy8gYSBzaW5nbGUgcmVzZXQgaXMgcGVyZm9ybWVkIHdoZW4gdGhpcyBpcyB0cnVlLgogICAgICBjb25zdCBzaG91bGRBZGRPZmZzZXQgPSAhbWlkZGxld2FyZURhdGEuYXJyb3cgJiYgZ2V0QWxpZ25tZW50KHBsYWNlbWVudCkgIT0gbnVsbCAmJiBjZW50ZXIgIT0gb2Zmc2V0ICYmIHJlY3RzLnJlZmVyZW5jZVtsZW5ndGhdIC8gMiAtIChjZW50ZXIgPCBtaW4kMSA/IG1pblBhZGRpbmcgOiBtYXhQYWRkaW5nKSAtIGFycm93RGltZW5zaW9uc1tsZW5ndGhdIC8gMiA8IDA7CiAgICAgIGNvbnN0IGFsaWdubWVudE9mZnNldCA9IHNob3VsZEFkZE9mZnNldCA/IGNlbnRlciA8IG1pbiQxID8gY2VudGVyIC0gbWluJDEgOiBjZW50ZXIgLSBtYXggOiAwOwogICAgICByZXR1cm4gewogICAgICAgIFtheGlzXTogY29vcmRzW2F4aXNdICsgYWxpZ25tZW50T2Zmc2V0LAogICAgICAgIGRhdGE6IHsKICAgICAgICAgIFtheGlzXTogb2Zmc2V0LAogICAgICAgICAgY2VudGVyT2Zmc2V0OiBjZW50ZXIgLSBvZmZzZXQgLSBhbGlnbm1lbnRPZmZzZXQsCiAgICAgICAgICAuLi4oc2hvdWxkQWRkT2Zmc2V0ICYmIHsKICAgICAgICAgICAgYWxpZ25tZW50T2Zmc2V0CiAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgcmVzZXQ6IHNob3VsZEFkZE9mZnNldAogICAgICB9OwogICAgfQogIH0pOwoKICAvKioKICAgKiBPcHRpbWl6ZXMgdGhlIHZpc2liaWxpdHkgb2YgdGhlIGZsb2F0aW5nIGVsZW1lbnQgYnkgZmxpcHBpbmcgdGhlIGBwbGFjZW1lbnRgCiAgICogaW4gb3JkZXIgdG8ga2VlcCBpdCBpbiB2aWV3IHdoZW4gdGhlIHByZWZlcnJlZCBwbGFjZW1lbnQocykgd2lsbCBvdmVyZmxvdyB0aGUKICAgKiBjbGlwcGluZyBib3VuZGFyeS4gQWx0ZXJuYXRpdmUgdG8gYGF1dG9QbGFjZW1lbnRgLgogICAqIEBzZWUgaHR0cHM6Ly9mbG9hdGluZy11aS5jb20vZG9jcy9mbGlwCiAgICovCiAgY29uc3QgZmxpcCQxID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsKICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgb3B0aW9ucyA9IHt9OwogICAgfQogICAgcmV0dXJuIHsKICAgICAgbmFtZTogJ2ZsaXAnLAogICAgICBvcHRpb25zLAogICAgICBhc3luYyBmbihzdGF0ZSkgewogICAgICAgIHZhciBfbWlkZGxld2FyZURhdGEkYXJyb3csIF9taWRkbGV3YXJlRGF0YSRmbGlwOwogICAgICAgIGNvbnN0IHsKICAgICAgICAgIHBsYWNlbWVudCwKICAgICAgICAgIG1pZGRsZXdhcmVEYXRhLAogICAgICAgICAgcmVjdHMsCiAgICAgICAgICBpbml0aWFsUGxhY2VtZW50LAogICAgICAgICAgcGxhdGZvcm0sCiAgICAgICAgICBlbGVtZW50cwogICAgICAgIH0gPSBzdGF0ZTsKICAgICAgICBjb25zdCB7CiAgICAgICAgICBtYWluQXhpczogY2hlY2tNYWluQXhpcyA9IHRydWUsCiAgICAgICAgICBjcm9zc0F4aXM6IGNoZWNrQ3Jvc3NBeGlzID0gdHJ1ZSwKICAgICAgICAgIGZhbGxiYWNrUGxhY2VtZW50czogc3BlY2lmaWVkRmFsbGJhY2tQbGFjZW1lbnRzLAogICAgICAgICAgZmFsbGJhY2tTdHJhdGVneSA9ICdiZXN0Rml0JywKICAgICAgICAgIGZhbGxiYWNrQXhpc1NpZGVEaXJlY3Rpb24gPSAnbm9uZScsCiAgICAgICAgICBmbGlwQWxpZ25tZW50ID0gdHJ1ZSwKICAgICAgICAgIC4uLmRldGVjdE92ZXJmbG93T3B0aW9ucwogICAgICAgIH0gPSBldmFsdWF0ZShvcHRpb25zLCBzdGF0ZSk7CgogICAgICAgIC8vIElmIGEgcmVzZXQgYnkgdGhlIGFycm93IHdhcyBjYXVzZWQgZHVlIHRvIGFuIGFsaWdubWVudCBvZmZzZXQgYmVpbmcKICAgICAgICAvLyBhZGRlZCwgd2Ugc2hvdWxkIHNraXAgYW55IGxvZ2ljIG5vdyBzaW5jZSBgZmxpcCgpYCBoYXMgYWxyZWFkeSBkb25lIGl0cwogICAgICAgIC8vIHdvcmsuCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2Zsb2F0aW5nLXVpL2Zsb2F0aW5nLXVpL2lzc3Vlcy8yNTQ5I2lzc3VlY29tbWVudC0xNzE5NjAxNjQzCiAgICAgICAgaWYgKChfbWlkZGxld2FyZURhdGEkYXJyb3cgPSBtaWRkbGV3YXJlRGF0YS5hcnJvdykgIT0gbnVsbCAmJiBfbWlkZGxld2FyZURhdGEkYXJyb3cuYWxpZ25tZW50T2Zmc2V0KSB7CiAgICAgICAgICByZXR1cm4ge307CiAgICAgICAgfQogICAgICAgIGNvbnN0IHNpZGUgPSBnZXRTaWRlKHBsYWNlbWVudCk7CiAgICAgICAgY29uc3QgaXNCYXNlUGxhY2VtZW50ID0gZ2V0U2lkZShpbml0aWFsUGxhY2VtZW50KSA9PT0gaW5pdGlhbFBsYWNlbWVudDsKICAgICAgICBjb25zdCBydGwgPSBhd2FpdCAocGxhdGZvcm0uaXNSVEwgPT0gbnVsbCA/IHZvaWQgMCA6IHBsYXRmb3JtLmlzUlRMKGVsZW1lbnRzLmZsb2F0aW5nKSk7CiAgICAgICAgY29uc3QgZmFsbGJhY2tQbGFjZW1lbnRzID0gc3BlY2lmaWVkRmFsbGJhY2tQbGFjZW1lbnRzIHx8IChpc0Jhc2VQbGFjZW1lbnQgfHwgIWZsaXBBbGlnbm1lbnQgPyBbZ2V0T3Bwb3NpdGVQbGFjZW1lbnQoaW5pdGlhbFBsYWNlbWVudCldIDogZ2V0RXhwYW5kZWRQbGFjZW1lbnRzKGluaXRpYWxQbGFjZW1lbnQpKTsKICAgICAgICBpZiAoIXNwZWNpZmllZEZhbGxiYWNrUGxhY2VtZW50cyAmJiBmYWxsYmFja0F4aXNTaWRlRGlyZWN0aW9uICE9PSAnbm9uZScpIHsKICAgICAgICAgIGZhbGxiYWNrUGxhY2VtZW50cy5wdXNoKC4uLmdldE9wcG9zaXRlQXhpc1BsYWNlbWVudHMoaW5pdGlhbFBsYWNlbWVudCwgZmxpcEFsaWdubWVudCwgZmFsbGJhY2tBeGlzU2lkZURpcmVjdGlvbiwgcnRsKSk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IHBsYWNlbWVudHMgPSBbaW5pdGlhbFBsYWNlbWVudCwgLi4uZmFsbGJhY2tQbGFjZW1lbnRzXTsKICAgICAgICBjb25zdCBvdmVyZmxvdyA9IGF3YWl0IGRldGVjdE92ZXJmbG93KHN0YXRlLCBkZXRlY3RPdmVyZmxvd09wdGlvbnMpOwogICAgICAgIGNvbnN0IG92ZXJmbG93cyA9IFtdOwogICAgICAgIGxldCBvdmVyZmxvd3NEYXRhID0gKChfbWlkZGxld2FyZURhdGEkZmxpcCA9IG1pZGRsZXdhcmVEYXRhLmZsaXApID09IG51bGwgPyB2b2lkIDAgOiBfbWlkZGxld2FyZURhdGEkZmxpcC5vdmVyZmxvd3MpIHx8IFtdOwogICAgICAgIGlmIChjaGVja01haW5BeGlzKSB7CiAgICAgICAgICBvdmVyZmxvd3MucHVzaChvdmVyZmxvd1tzaWRlXSk7CiAgICAgICAgfQogICAgICAgIGlmIChjaGVja0Nyb3NzQXhpcykgewogICAgICAgICAgY29uc3Qgc2lkZXMgPSBnZXRBbGlnbm1lbnRTaWRlcyhwbGFjZW1lbnQsIHJlY3RzLCBydGwpOwogICAgICAgICAgb3ZlcmZsb3dzLnB1c2gob3ZlcmZsb3dbc2lkZXNbMF1dLCBvdmVyZmxvd1tzaWRlc1sxXV0pOwogICAgICAgIH0KICAgICAgICBvdmVyZmxvd3NEYXRhID0gWy4uLm92ZXJmbG93c0RhdGEsIHsKICAgICAgICAgIHBsYWNlbWVudCwKICAgICAgICAgIG92ZXJmbG93cwogICAgICAgIH1dOwoKICAgICAgICAvLyBPbmUgb3IgbW9yZSBzaWRlcyBpcyBvdmVyZmxvd2luZy4KICAgICAgICBpZiAoIW92ZXJmbG93cy5ldmVyeShzaWRlID0+IHNpZGUgPD0gMCkpIHsKICAgICAgICAgIHZhciBfbWlkZGxld2FyZURhdGEkZmxpcDIsIF9vdmVyZmxvd3NEYXRhJGZpbHRlcjsKICAgICAgICAgIGNvbnN0IG5leHRJbmRleCA9ICgoKF9taWRkbGV3YXJlRGF0YSRmbGlwMiA9IG1pZGRsZXdhcmVEYXRhLmZsaXApID09IG51bGwgPyB2b2lkIDAgOiBfbWlkZGxld2FyZURhdGEkZmxpcDIuaW5kZXgpIHx8IDApICsgMTsKICAgICAgICAgIGNvbnN0IG5leHRQbGFjZW1lbnQgPSBwbGFjZW1lbnRzW25leHRJbmRleF07CiAgICAgICAgICBpZiAobmV4dFBsYWNlbWVudCkgewogICAgICAgICAgICAvLyBUcnkgbmV4dCBwbGFjZW1lbnQgYW5kIHJlLXJ1biB0aGUgbGlmZWN5Y2xlLgogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgIGluZGV4OiBuZXh0SW5kZXgsCiAgICAgICAgICAgICAgICBvdmVyZmxvd3M6IG92ZXJmbG93c0RhdGEKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHJlc2V0OiB7CiAgICAgICAgICAgICAgICBwbGFjZW1lbnQ6IG5leHRQbGFjZW1lbnQKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgICB9CgogICAgICAgICAgLy8gRmlyc3QsIGZpbmQgdGhlIGNhbmRpZGF0ZXMgdGhhdCBmaXQgb24gdGhlIG1haW5BeGlzIHNpZGUgb2Ygb3ZlcmZsb3csCiAgICAgICAgICAvLyB0aGVuIGZpbmQgdGhlIHBsYWNlbWVudCB0aGF0IGZpdHMgdGhlIGJlc3Qgb24gdGhlIG1haW4gY3Jvc3NBeGlzIHNpZGUuCiAgICAgICAgICBsZXQgcmVzZXRQbGFjZW1lbnQgPSAoX292ZXJmbG93c0RhdGEkZmlsdGVyID0gb3ZlcmZsb3dzRGF0YS5maWx0ZXIoZCA9PiBkLm92ZXJmbG93c1swXSA8PSAwKS5zb3J0KChhLCBiKSA9PiBhLm92ZXJmbG93c1sxXSAtIGIub3ZlcmZsb3dzWzFdKVswXSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9vdmVyZmxvd3NEYXRhJGZpbHRlci5wbGFjZW1lbnQ7CgogICAgICAgICAgLy8gT3RoZXJ3aXNlIGZhbGxiYWNrLgogICAgICAgICAgaWYgKCFyZXNldFBsYWNlbWVudCkgewogICAgICAgICAgICBzd2l0Y2ggKGZhbGxiYWNrU3RyYXRlZ3kpIHsKICAgICAgICAgICAgICBjYXNlICdiZXN0Rml0JzoKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgdmFyIF9vdmVyZmxvd3NEYXRhJG1hcCRzbzsKICAgICAgICAgICAgICAgICAgY29uc3QgcGxhY2VtZW50ID0gKF9vdmVyZmxvd3NEYXRhJG1hcCRzbyA9IG92ZXJmbG93c0RhdGEubWFwKGQgPT4gW2QucGxhY2VtZW50LCBkLm92ZXJmbG93cy5maWx0ZXIob3ZlcmZsb3cgPT4gb3ZlcmZsb3cgPiAwKS5yZWR1Y2UoKGFjYywgb3ZlcmZsb3cpID0+IGFjYyArIG92ZXJmbG93LCAwKV0pLnNvcnQoKGEsIGIpID0+IGFbMV0gLSBiWzFdKVswXSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9vdmVyZmxvd3NEYXRhJG1hcCRzb1swXTsKICAgICAgICAgICAgICAgICAgaWYgKHBsYWNlbWVudCkgewogICAgICAgICAgICAgICAgICAgIHJlc2V0UGxhY2VtZW50ID0gcGxhY2VtZW50OwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGNhc2UgJ2luaXRpYWxQbGFjZW1lbnQnOgogICAgICAgICAgICAgICAgcmVzZXRQbGFjZW1lbnQgPSBpbml0aWFsUGxhY2VtZW50OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGlmIChwbGFjZW1lbnQgIT09IHJlc2V0UGxhY2VtZW50KSB7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgcmVzZXQ6IHsKICAgICAgICAgICAgICAgIHBsYWNlbWVudDogcmVzZXRQbGFjZW1lbnQKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB7fTsKICAgICAgfQogICAgfTsKICB9OwoKICAvLyBGb3IgdHlwZSBiYWNrd2FyZHMtY29tcGF0aWJpbGl0eSwgdGhlIGBPZmZzZXRPcHRpb25zYCB0eXBlIHdhcyBhbHNvCiAgLy8gRGVyaXZhYmxlLgoKICBhc3luYyBmdW5jdGlvbiBjb252ZXJ0VmFsdWVUb0Nvb3JkcyhzdGF0ZSwgb3B0aW9ucykgewogICAgY29uc3QgewogICAgICBwbGFjZW1lbnQsCiAgICAgIHBsYXRmb3JtLAogICAgICBlbGVtZW50cwogICAgfSA9IHN0YXRlOwogICAgY29uc3QgcnRsID0gYXdhaXQgKHBsYXRmb3JtLmlzUlRMID09IG51bGwgPyB2b2lkIDAgOiBwbGF0Zm9ybS5pc1JUTChlbGVtZW50cy5mbG9hdGluZykpOwogICAgY29uc3Qgc2lkZSA9IGdldFNpZGUocGxhY2VtZW50KTsKICAgIGNvbnN0IGFsaWdubWVudCA9IGdldEFsaWdubWVudChwbGFjZW1lbnQpOwogICAgY29uc3QgaXNWZXJ0aWNhbCA9IGdldFNpZGVBeGlzKHBsYWNlbWVudCkgPT09ICd5JzsKICAgIGNvbnN0IG1haW5BeGlzTXVsdGkgPSBbJ2xlZnQnLCAndG9wJ10uaW5jbHVkZXMoc2lkZSkgPyAtMSA6IDE7CiAgICBjb25zdCBjcm9zc0F4aXNNdWx0aSA9IHJ0bCAmJiBpc1ZlcnRpY2FsID8gLTEgOiAxOwogICAgY29uc3QgcmF3VmFsdWUgPSBldmFsdWF0ZShvcHRpb25zLCBzdGF0ZSk7CgogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1jb25zdAogICAgbGV0IHsKICAgICAgbWFpbkF4aXMsCiAgICAgIGNyb3NzQXhpcywKICAgICAgYWxpZ25tZW50QXhpcwogICAgfSA9IHR5cGVvZiByYXdWYWx1ZSA9PT0gJ251bWJlcicgPyB7CiAgICAgIG1haW5BeGlzOiByYXdWYWx1ZSwKICAgICAgY3Jvc3NBeGlzOiAwLAogICAgICBhbGlnbm1lbnRBeGlzOiBudWxsCiAgICB9IDogewogICAgICBtYWluQXhpczogMCwKICAgICAgY3Jvc3NBeGlzOiAwLAogICAgICBhbGlnbm1lbnRBeGlzOiBudWxsLAogICAgICAuLi5yYXdWYWx1ZQogICAgfTsKICAgIGlmIChhbGlnbm1lbnQgJiYgdHlwZW9mIGFsaWdubWVudEF4aXMgPT09ICdudW1iZXInKSB7CiAgICAgIGNyb3NzQXhpcyA9IGFsaWdubWVudCA9PT0gJ2VuZCcgPyBhbGlnbm1lbnRBeGlzICogLTEgOiBhbGlnbm1lbnRBeGlzOwogICAgfQogICAgcmV0dXJuIGlzVmVydGljYWwgPyB7CiAgICAgIHg6IGNyb3NzQXhpcyAqIGNyb3NzQXhpc011bHRpLAogICAgICB5OiBtYWluQXhpcyAqIG1haW5BeGlzTXVsdGkKICAgIH0gOiB7CiAgICAgIHg6IG1haW5BeGlzICogbWFpbkF4aXNNdWx0aSwKICAgICAgeTogY3Jvc3NBeGlzICogY3Jvc3NBeGlzTXVsdGkKICAgIH07CiAgfQoKICAvKioKICAgKiBNb2RpZmllcyB0aGUgcGxhY2VtZW50IGJ5IHRyYW5zbGF0aW5nIHRoZSBmbG9hdGluZyBlbGVtZW50IGFsb25nIHRoZQogICAqIHNwZWNpZmllZCBheGVzLgogICAqIEEgbnVtYmVyIChzaG9ydGhhbmQgZm9yIGBtYWluQXhpc2Agb3IgZGlzdGFuY2UpLCBvciBhbiBheGVzIGNvbmZpZ3VyYXRpb24KICAgKiBvYmplY3QgbWF5IGJlIHBhc3NlZC4KICAgKiBAc2VlIGh0dHBzOi8vZmxvYXRpbmctdWkuY29tL2RvY3Mvb2Zmc2V0CiAgICovCiAgY29uc3Qgb2Zmc2V0ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsKICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgb3B0aW9ucyA9IDA7CiAgICB9CiAgICByZXR1cm4gewogICAgICBuYW1lOiAnb2Zmc2V0JywKICAgICAgb3B0aW9ucywKICAgICAgYXN5bmMgZm4oc3RhdGUpIHsKICAgICAgICB2YXIgX21pZGRsZXdhcmVEYXRhJG9mZnNlLCBfbWlkZGxld2FyZURhdGEkYXJyb3c7CiAgICAgICAgY29uc3QgewogICAgICAgICAgeCwKICAgICAgICAgIHksCiAgICAgICAgICBwbGFjZW1lbnQsCiAgICAgICAgICBtaWRkbGV3YXJlRGF0YQogICAgICAgIH0gPSBzdGF0ZTsKICAgICAgICBjb25zdCBkaWZmQ29vcmRzID0gYXdhaXQgY29udmVydFZhbHVlVG9Db29yZHMoc3RhdGUsIG9wdGlvbnMpOwoKICAgICAgICAvLyBJZiB0aGUgcGxhY2VtZW50IGlzIHRoZSBzYW1lIGFuZCB0aGUgYXJyb3cgY2F1c2VkIGFuIGFsaWdubWVudCBvZmZzZXQKICAgICAgICAvLyB0aGVuIHdlIGRvbid0IG5lZWQgdG8gY2hhbmdlIHRoZSBwb3NpdGlvbmluZyBjb29yZGluYXRlcy4KICAgICAgICBpZiAocGxhY2VtZW50ID09PSAoKF9taWRkbGV3YXJlRGF0YSRvZmZzZSA9IG1pZGRsZXdhcmVEYXRhLm9mZnNldCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9taWRkbGV3YXJlRGF0YSRvZmZzZS5wbGFjZW1lbnQpICYmIChfbWlkZGxld2FyZURhdGEkYXJyb3cgPSBtaWRkbGV3YXJlRGF0YS5hcnJvdykgIT0gbnVsbCAmJiBfbWlkZGxld2FyZURhdGEkYXJyb3cuYWxpZ25tZW50T2Zmc2V0KSB7CiAgICAgICAgICByZXR1cm4ge307CiAgICAgICAgfQogICAgICAgIHJldHVybiB7CiAgICAgICAgICB4OiB4ICsgZGlmZkNvb3Jkcy54LAogICAgICAgICAgeTogeSArIGRpZmZDb29yZHMueSwKICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgLi4uZGlmZkNvb3JkcywKICAgICAgICAgICAgcGxhY2VtZW50CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfQogICAgfTsKICB9OwoKICAvKioKICAgKiBPcHRpbWl6ZXMgdGhlIHZpc2liaWxpdHkgb2YgdGhlIGZsb2F0aW5nIGVsZW1lbnQgYnkgc2hpZnRpbmcgaXQgaW4gb3JkZXIgdG8KICAgKiBrZWVwIGl0IGluIHZpZXcgd2hlbiBpdCB3aWxsIG92ZXJmbG93IHRoZSBjbGlwcGluZyBib3VuZGFyeS4KICAgKiBAc2VlIGh0dHBzOi8vZmxvYXRpbmctdWkuY29tL2RvY3Mvc2hpZnQKICAgKi8KICBjb25zdCBzaGlmdCQxID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsKICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgb3B0aW9ucyA9IHt9OwogICAgfQogICAgcmV0dXJuIHsKICAgICAgbmFtZTogJ3NoaWZ0JywKICAgICAgb3B0aW9ucywKICAgICAgYXN5bmMgZm4oc3RhdGUpIHsKICAgICAgICBjb25zdCB7CiAgICAgICAgICB4LAogICAgICAgICAgeSwKICAgICAgICAgIHBsYWNlbWVudAogICAgICAgIH0gPSBzdGF0ZTsKICAgICAgICBjb25zdCB7CiAgICAgICAgICBtYWluQXhpczogY2hlY2tNYWluQXhpcyA9IHRydWUsCiAgICAgICAgICBjcm9zc0F4aXM6IGNoZWNrQ3Jvc3NBeGlzID0gZmFsc2UsCiAgICAgICAgICBsaW1pdGVyID0gewogICAgICAgICAgICBmbjogX3JlZiA9PiB7CiAgICAgICAgICAgICAgbGV0IHsKICAgICAgICAgICAgICAgIHgsCiAgICAgICAgICAgICAgICB5CiAgICAgICAgICAgICAgfSA9IF9yZWY7CiAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIHgsCiAgICAgICAgICAgICAgICB5CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIC4uLmRldGVjdE92ZXJmbG93T3B0aW9ucwogICAgICAgIH0gPSBldmFsdWF0ZShvcHRpb25zLCBzdGF0ZSk7CiAgICAgICAgY29uc3QgY29vcmRzID0gewogICAgICAgICAgeCwKICAgICAgICAgIHkKICAgICAgICB9OwogICAgICAgIGNvbnN0IG92ZXJmbG93ID0gYXdhaXQgZGV0ZWN0T3ZlcmZsb3coc3RhdGUsIGRldGVjdE92ZXJmbG93T3B0aW9ucyk7CiAgICAgICAgY29uc3QgY3Jvc3NBeGlzID0gZ2V0U2lkZUF4aXMoZ2V0U2lkZShwbGFjZW1lbnQpKTsKICAgICAgICBjb25zdCBtYWluQXhpcyA9IGdldE9wcG9zaXRlQXhpcyhjcm9zc0F4aXMpOwogICAgICAgIGxldCBtYWluQXhpc0Nvb3JkID0gY29vcmRzW21haW5BeGlzXTsKICAgICAgICBsZXQgY3Jvc3NBeGlzQ29vcmQgPSBjb29yZHNbY3Jvc3NBeGlzXTsKICAgICAgICBpZiAoY2hlY2tNYWluQXhpcykgewogICAgICAgICAgY29uc3QgbWluU2lkZSA9IG1haW5BeGlzID09PSAneScgPyAndG9wJyA6ICdsZWZ0JzsKICAgICAgICAgIGNvbnN0IG1heFNpZGUgPSBtYWluQXhpcyA9PT0gJ3knID8gJ2JvdHRvbScgOiAncmlnaHQnOwogICAgICAgICAgY29uc3QgbWluID0gbWFpbkF4aXNDb29yZCArIG92ZXJmbG93W21pblNpZGVdOwogICAgICAgICAgY29uc3QgbWF4ID0gbWFpbkF4aXNDb29yZCAtIG92ZXJmbG93W21heFNpZGVdOwogICAgICAgICAgbWFpbkF4aXNDb29yZCA9IGNsYW1wKG1pbiwgbWFpbkF4aXNDb29yZCwgbWF4KTsKICAgICAgICB9CiAgICAgICAgaWYgKGNoZWNrQ3Jvc3NBeGlzKSB7CiAgICAgICAgICBjb25zdCBtaW5TaWRlID0gY3Jvc3NBeGlzID09PSAneScgPyAndG9wJyA6ICdsZWZ0JzsKICAgICAgICAgIGNvbnN0IG1heFNpZGUgPSBjcm9zc0F4aXMgPT09ICd5JyA/ICdib3R0b20nIDogJ3JpZ2h0JzsKICAgICAgICAgIGNvbnN0IG1pbiA9IGNyb3NzQXhpc0Nvb3JkICsgb3ZlcmZsb3dbbWluU2lkZV07CiAgICAgICAgICBjb25zdCBtYXggPSBjcm9zc0F4aXNDb29yZCAtIG92ZXJmbG93W21heFNpZGVdOwogICAgICAgICAgY3Jvc3NBeGlzQ29vcmQgPSBjbGFtcChtaW4sIGNyb3NzQXhpc0Nvb3JkLCBtYXgpOwogICAgICAgIH0KICAgICAgICBjb25zdCBsaW1pdGVkQ29vcmRzID0gbGltaXRlci5mbih7CiAgICAgICAgICAuLi5zdGF0ZSwKICAgICAgICAgIFttYWluQXhpc106IG1haW5BeGlzQ29vcmQsCiAgICAgICAgICBbY3Jvc3NBeGlzXTogY3Jvc3NBeGlzQ29vcmQKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gewogICAgICAgICAgLi4ubGltaXRlZENvb3JkcywKICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgeDogbGltaXRlZENvb3Jkcy54IC0geCwKICAgICAgICAgICAgeTogbGltaXRlZENvb3Jkcy55IC0geQogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0KICAgIH07CiAgfTsKCiAgLyoqCiAgICogUHJvdmlkZXMgZGF0YSB0aGF0IGFsbG93cyB5b3UgdG8gY2hhbmdlIHRoZSBzaXplIG9mIHRoZSBmbG9hdGluZyBlbGVtZW50IOKAlAogICAqIGZvciBpbnN0YW5jZSwgcHJldmVudCBpdCBmcm9tIG92ZXJmbG93aW5nIHRoZSBjbGlwcGluZyBib3VuZGFyeSBvciBtYXRjaCB0aGUKICAgKiB3aWR0aCBvZiB0aGUgcmVmZXJlbmNlIGVsZW1lbnQuCiAgICogQHNlZSBodHRwczovL2Zsb2F0aW5nLXVpLmNvbS9kb2NzL3NpemUKICAgKi8KICBjb25zdCBzaXplJDEgPSBmdW5jdGlvbiAob3B0aW9ucykgewogICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICBvcHRpb25zID0ge307CiAgICB9CiAgICByZXR1cm4gewogICAgICBuYW1lOiAnc2l6ZScsCiAgICAgIG9wdGlvbnMsCiAgICAgIGFzeW5jIGZuKHN0YXRlKSB7CiAgICAgICAgY29uc3QgewogICAgICAgICAgcGxhY2VtZW50LAogICAgICAgICAgcmVjdHMsCiAgICAgICAgICBwbGF0Zm9ybSwKICAgICAgICAgIGVsZW1lbnRzCiAgICAgICAgfSA9IHN0YXRlOwogICAgICAgIGNvbnN0IHsKICAgICAgICAgIGFwcGx5ID0gKCkgPT4ge30sCiAgICAgICAgICAuLi5kZXRlY3RPdmVyZmxvd09wdGlvbnMKICAgICAgICB9ID0gZXZhbHVhdGUob3B0aW9ucywgc3RhdGUpOwogICAgICAgIGNvbnN0IG92ZXJmbG93ID0gYXdhaXQgZGV0ZWN0T3ZlcmZsb3coc3RhdGUsIGRldGVjdE92ZXJmbG93T3B0aW9ucyk7CiAgICAgICAgY29uc3Qgc2lkZSA9IGdldFNpZGUocGxhY2VtZW50KTsKICAgICAgICBjb25zdCBhbGlnbm1lbnQgPSBnZXRBbGlnbm1lbnQocGxhY2VtZW50KTsKICAgICAgICBjb25zdCBpc1lBeGlzID0gZ2V0U2lkZUF4aXMocGxhY2VtZW50KSA9PT0gJ3knOwogICAgICAgIGNvbnN0IHsKICAgICAgICAgIHdpZHRoLAogICAgICAgICAgaGVpZ2h0CiAgICAgICAgfSA9IHJlY3RzLmZsb2F0aW5nOwogICAgICAgIGxldCBoZWlnaHRTaWRlOwogICAgICAgIGxldCB3aWR0aFNpZGU7CiAgICAgICAgaWYgKHNpZGUgPT09ICd0b3AnIHx8IHNpZGUgPT09ICdib3R0b20nKSB7CiAgICAgICAgICBoZWlnaHRTaWRlID0gc2lkZTsKICAgICAgICAgIHdpZHRoU2lkZSA9IGFsaWdubWVudCA9PT0gKChhd2FpdCAocGxhdGZvcm0uaXNSVEwgPT0gbnVsbCA/IHZvaWQgMCA6IHBsYXRmb3JtLmlzUlRMKGVsZW1lbnRzLmZsb2F0aW5nKSkpID8gJ3N0YXJ0JyA6ICdlbmQnKSA/ICdsZWZ0JyA6ICdyaWdodCc7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHdpZHRoU2lkZSA9IHNpZGU7CiAgICAgICAgICBoZWlnaHRTaWRlID0gYWxpZ25tZW50ID09PSAnZW5kJyA/ICd0b3AnIDogJ2JvdHRvbSc7CiAgICAgICAgfQogICAgICAgIGNvbnN0IG92ZXJmbG93QXZhaWxhYmxlSGVpZ2h0ID0gaGVpZ2h0IC0gb3ZlcmZsb3dbaGVpZ2h0U2lkZV07CiAgICAgICAgY29uc3Qgb3ZlcmZsb3dBdmFpbGFibGVXaWR0aCA9IHdpZHRoIC0gb3ZlcmZsb3dbd2lkdGhTaWRlXTsKICAgICAgICBjb25zdCBub1NoaWZ0ID0gIXN0YXRlLm1pZGRsZXdhcmVEYXRhLnNoaWZ0OwogICAgICAgIGxldCBhdmFpbGFibGVIZWlnaHQgPSBvdmVyZmxvd0F2YWlsYWJsZUhlaWdodDsKICAgICAgICBsZXQgYXZhaWxhYmxlV2lkdGggPSBvdmVyZmxvd0F2YWlsYWJsZVdpZHRoOwogICAgICAgIGlmIChpc1lBeGlzKSB7CiAgICAgICAgICBjb25zdCBtYXhpbXVtQ2xpcHBpbmdXaWR0aCA9IHdpZHRoIC0gb3ZlcmZsb3cubGVmdCAtIG92ZXJmbG93LnJpZ2h0OwogICAgICAgICAgYXZhaWxhYmxlV2lkdGggPSBhbGlnbm1lbnQgfHwgbm9TaGlmdCA/IG1pbihvdmVyZmxvd0F2YWlsYWJsZVdpZHRoLCBtYXhpbXVtQ2xpcHBpbmdXaWR0aCkgOiBtYXhpbXVtQ2xpcHBpbmdXaWR0aDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3QgbWF4aW11bUNsaXBwaW5nSGVpZ2h0ID0gaGVpZ2h0IC0gb3ZlcmZsb3cudG9wIC0gb3ZlcmZsb3cuYm90dG9tOwogICAgICAgICAgYXZhaWxhYmxlSGVpZ2h0ID0gYWxpZ25tZW50IHx8IG5vU2hpZnQgPyBtaW4ob3ZlcmZsb3dBdmFpbGFibGVIZWlnaHQsIG1heGltdW1DbGlwcGluZ0hlaWdodCkgOiBtYXhpbXVtQ2xpcHBpbmdIZWlnaHQ7CiAgICAgICAgfQogICAgICAgIGlmIChub1NoaWZ0ICYmICFhbGlnbm1lbnQpIHsKICAgICAgICAgIGNvbnN0IHhNaW4gPSBtYXgob3ZlcmZsb3cubGVmdCwgMCk7CiAgICAgICAgICBjb25zdCB4TWF4ID0gbWF4KG92ZXJmbG93LnJpZ2h0LCAwKTsKICAgICAgICAgIGNvbnN0IHlNaW4gPSBtYXgob3ZlcmZsb3cudG9wLCAwKTsKICAgICAgICAgIGNvbnN0IHlNYXggPSBtYXgob3ZlcmZsb3cuYm90dG9tLCAwKTsKICAgICAgICAgIGlmIChpc1lBeGlzKSB7CiAgICAgICAgICAgIGF2YWlsYWJsZVdpZHRoID0gd2lkdGggLSAyICogKHhNaW4gIT09IDAgfHwgeE1heCAhPT0gMCA/IHhNaW4gKyB4TWF4IDogbWF4KG92ZXJmbG93LmxlZnQsIG92ZXJmbG93LnJpZ2h0KSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhdmFpbGFibGVIZWlnaHQgPSBoZWlnaHQgLSAyICogKHlNaW4gIT09IDAgfHwgeU1heCAhPT0gMCA/IHlNaW4gKyB5TWF4IDogbWF4KG92ZXJmbG93LnRvcCwgb3ZlcmZsb3cuYm90dG9tKSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGF3YWl0IGFwcGx5KHsKICAgICAgICAgIC4uLnN0YXRlLAogICAgICAgICAgYXZhaWxhYmxlV2lkdGgsCiAgICAgICAgICBhdmFpbGFibGVIZWlnaHQKICAgICAgICB9KTsKICAgICAgICBjb25zdCBuZXh0RGltZW5zaW9ucyA9IGF3YWl0IHBsYXRmb3JtLmdldERpbWVuc2lvbnMoZWxlbWVudHMuZmxvYXRpbmcpOwogICAgICAgIGlmICh3aWR0aCAhPT0gbmV4dERpbWVuc2lvbnMud2lkdGggfHwgaGVpZ2h0ICE9PSBuZXh0RGltZW5zaW9ucy5oZWlnaHQpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHJlc2V0OiB7CiAgICAgICAgICAgICAgcmVjdHM6IHRydWUKICAgICAgICAgICAgfQogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHt9OwogICAgICB9CiAgICB9OwogIH07CgogIGZ1bmN0aW9uIGdldE5vZGVOYW1lKG5vZGUpIHsKICAgIGlmIChpc05vZGUobm9kZSkpIHsKICAgICAgcmV0dXJuIChub2RlLm5vZGVOYW1lIHx8ICcnKS50b0xvd2VyQ2FzZSgpOwogICAgfQogICAgLy8gTW9ja2VkIG5vZGVzIGluIHRlc3RpbmcgZW52aXJvbm1lbnRzIG1heSBub3QgYmUgaW5zdGFuY2VzIG9mIE5vZGUuIEJ5CiAgICAvLyByZXR1cm5pbmcgYCNkb2N1bWVudGAgYW4gaW5maW5pdGUgbG9vcCB3b24ndCBvY2N1ci4KICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9mbG9hdGluZy11aS9mbG9hdGluZy11aS9pc3N1ZXMvMjMxNwogICAgcmV0dXJuICcjZG9jdW1lbnQnOwogIH0KICBmdW5jdGlvbiBnZXRXaW5kb3cobm9kZSkgewogICAgdmFyIF9ub2RlJG93bmVyRG9jdW1lbnQ7CiAgICByZXR1cm4gKG5vZGUgPT0gbnVsbCB8fCAoX25vZGUkb3duZXJEb2N1bWVudCA9IG5vZGUub3duZXJEb2N1bWVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9ub2RlJG93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcpIHx8IHdpbmRvdzsKICB9CiAgZnVuY3Rpb24gZ2V0RG9jdW1lbnRFbGVtZW50KG5vZGUpIHsKICAgIHZhciBfcmVmOwogICAgcmV0dXJuIChfcmVmID0gKGlzTm9kZShub2RlKSA/IG5vZGUub3duZXJEb2N1bWVudCA6IG5vZGUuZG9jdW1lbnQpIHx8IHdpbmRvdy5kb2N1bWVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9yZWYuZG9jdW1lbnRFbGVtZW50OwogIH0KICBmdW5jdGlvbiBpc05vZGUodmFsdWUpIHsKICAgIHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIE5vZGUgfHwgdmFsdWUgaW5zdGFuY2VvZiBnZXRXaW5kb3codmFsdWUpLk5vZGU7CiAgfQogIGZ1bmN0aW9uIGlzRWxlbWVudCh2YWx1ZSkgewogICAgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgRWxlbWVudCB8fCB2YWx1ZSBpbnN0YW5jZW9mIGdldFdpbmRvdyh2YWx1ZSkuRWxlbWVudDsKICB9CiAgZnVuY3Rpb24gaXNIVE1MRWxlbWVudCh2YWx1ZSkgewogICAgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQgfHwgdmFsdWUgaW5zdGFuY2VvZiBnZXRXaW5kb3codmFsdWUpLkhUTUxFbGVtZW50OwogIH0KICBmdW5jdGlvbiBpc1NoYWRvd1Jvb3QodmFsdWUpIHsKICAgIC8vIEJyb3dzZXJzIHdpdGhvdXQgYFNoYWRvd1Jvb3RgIHN1cHBvcnQuCiAgICBpZiAodHlwZW9mIFNoYWRvd1Jvb3QgPT09ICd1bmRlZmluZWQnKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFNoYWRvd1Jvb3QgfHwgdmFsdWUgaW5zdGFuY2VvZiBnZXRXaW5kb3codmFsdWUpLlNoYWRvd1Jvb3Q7CiAgfQogIGZ1bmN0aW9uIGlzT3ZlcmZsb3dFbGVtZW50KGVsZW1lbnQpIHsKICAgIGNvbnN0IHsKICAgICAgb3ZlcmZsb3csCiAgICAgIG92ZXJmbG93WCwKICAgICAgb3ZlcmZsb3dZLAogICAgICBkaXNwbGF5CiAgICB9ID0gZ2V0Q29tcHV0ZWRTdHlsZSQxKGVsZW1lbnQpOwogICAgcmV0dXJuIC9hdXRvfHNjcm9sbHxvdmVybGF5fGhpZGRlbnxjbGlwLy50ZXN0KG92ZXJmbG93ICsgb3ZlcmZsb3dZICsgb3ZlcmZsb3dYKSAmJiAhWydpbmxpbmUnLCAnY29udGVudHMnXS5pbmNsdWRlcyhkaXNwbGF5KTsKICB9CiAgZnVuY3Rpb24gaXNUYWJsZUVsZW1lbnQoZWxlbWVudCkgewogICAgcmV0dXJuIFsndGFibGUnLCAndGQnLCAndGgnXS5pbmNsdWRlcyhnZXROb2RlTmFtZShlbGVtZW50KSk7CiAgfQogIGZ1bmN0aW9uIGlzQ29udGFpbmluZ0Jsb2NrKGVsZW1lbnQpIHsKICAgIGNvbnN0IHdlYmtpdCA9IGlzV2ViS2l0KCk7CiAgICBjb25zdCBjc3MgPSBnZXRDb21wdXRlZFN0eWxlJDEoZWxlbWVudCk7CgogICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQ1NTL0NvbnRhaW5pbmdfYmxvY2sjaWRlbnRpZnlpbmdfdGhlX2NvbnRhaW5pbmdfYmxvY2sKICAgIHJldHVybiBjc3MudHJhbnNmb3JtICE9PSAnbm9uZScgfHwgY3NzLnBlcnNwZWN0aXZlICE9PSAnbm9uZScgfHwgKGNzcy5jb250YWluZXJUeXBlID8gY3NzLmNvbnRhaW5lclR5cGUgIT09ICdub3JtYWwnIDogZmFsc2UpIHx8ICF3ZWJraXQgJiYgKGNzcy5iYWNrZHJvcEZpbHRlciA/IGNzcy5iYWNrZHJvcEZpbHRlciAhPT0gJ25vbmUnIDogZmFsc2UpIHx8ICF3ZWJraXQgJiYgKGNzcy5maWx0ZXIgPyBjc3MuZmlsdGVyICE9PSAnbm9uZScgOiBmYWxzZSkgfHwgWyd0cmFuc2Zvcm0nLCAncGVyc3BlY3RpdmUnLCAnZmlsdGVyJ10uc29tZSh2YWx1ZSA9PiAoY3NzLndpbGxDaGFuZ2UgfHwgJycpLmluY2x1ZGVzKHZhbHVlKSkgfHwgWydwYWludCcsICdsYXlvdXQnLCAnc3RyaWN0JywgJ2NvbnRlbnQnXS5zb21lKHZhbHVlID0+IChjc3MuY29udGFpbiB8fCAnJykuaW5jbHVkZXModmFsdWUpKTsKICB9CiAgZnVuY3Rpb24gZ2V0Q29udGFpbmluZ0Jsb2NrKGVsZW1lbnQpIHsKICAgIGxldCBjdXJyZW50Tm9kZSA9IGdldFBhcmVudE5vZGUoZWxlbWVudCk7CiAgICB3aGlsZSAoaXNIVE1MRWxlbWVudChjdXJyZW50Tm9kZSkgJiYgIWlzTGFzdFRyYXZlcnNhYmxlTm9kZShjdXJyZW50Tm9kZSkpIHsKICAgICAgaWYgKGlzQ29udGFpbmluZ0Jsb2NrKGN1cnJlbnROb2RlKSkgewogICAgICAgIHJldHVybiBjdXJyZW50Tm9kZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjdXJyZW50Tm9kZSA9IGdldFBhcmVudE5vZGUoY3VycmVudE5vZGUpOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gbnVsbDsKICB9CiAgZnVuY3Rpb24gaXNXZWJLaXQoKSB7CiAgICBpZiAodHlwZW9mIENTUyA9PT0gJ3VuZGVmaW5lZCcgfHwgIUNTUy5zdXBwb3J0cykgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIENTUy5zdXBwb3J0cygnLXdlYmtpdC1iYWNrZHJvcC1maWx0ZXInLCAnbm9uZScpOwogIH0KICBmdW5jdGlvbiBpc0xhc3RUcmF2ZXJzYWJsZU5vZGUobm9kZSkgewogICAgcmV0dXJuIFsnaHRtbCcsICdib2R5JywgJyNkb2N1bWVudCddLmluY2x1ZGVzKGdldE5vZGVOYW1lKG5vZGUpKTsKICB9CiAgZnVuY3Rpb24gZ2V0Q29tcHV0ZWRTdHlsZSQxKGVsZW1lbnQpIHsKICAgIHJldHVybiBnZXRXaW5kb3coZWxlbWVudCkuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KTsKICB9CiAgZnVuY3Rpb24gZ2V0Tm9kZVNjcm9sbChlbGVtZW50KSB7CiAgICBpZiAoaXNFbGVtZW50KGVsZW1lbnQpKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgc2Nyb2xsTGVmdDogZWxlbWVudC5zY3JvbGxMZWZ0LAogICAgICAgIHNjcm9sbFRvcDogZWxlbWVudC5zY3JvbGxUb3AKICAgICAgfTsKICAgIH0KICAgIHJldHVybiB7CiAgICAgIHNjcm9sbExlZnQ6IGVsZW1lbnQucGFnZVhPZmZzZXQsCiAgICAgIHNjcm9sbFRvcDogZWxlbWVudC5wYWdlWU9mZnNldAogICAgfTsKICB9CiAgZnVuY3Rpb24gZ2V0UGFyZW50Tm9kZShub2RlKSB7CiAgICBpZiAoZ2V0Tm9kZU5hbWUobm9kZSkgPT09ICdodG1sJykgewogICAgICByZXR1cm4gbm9kZTsKICAgIH0KICAgIGNvbnN0IHJlc3VsdCA9CiAgICAvLyBTdGVwIGludG8gdGhlIHNoYWRvdyBET00gb2YgdGhlIHBhcmVudCBvZiBhIHNsb3R0ZWQgbm9kZS4KICAgIG5vZGUuYXNzaWduZWRTbG90IHx8CiAgICAvLyBET00gRWxlbWVudCBkZXRlY3RlZC4KICAgIG5vZGUucGFyZW50Tm9kZSB8fAogICAgLy8gU2hhZG93Um9vdCBkZXRlY3RlZC4KICAgIGlzU2hhZG93Um9vdChub2RlKSAmJiBub2RlLmhvc3QgfHwKICAgIC8vIEZhbGxiYWNrLgogICAgZ2V0RG9jdW1lbnRFbGVtZW50KG5vZGUpOwogICAgcmV0dXJuIGlzU2hhZG93Um9vdChyZXN1bHQpID8gcmVzdWx0Lmhvc3QgOiByZXN1bHQ7CiAgfQogIGZ1bmN0aW9uIGdldE5lYXJlc3RPdmVyZmxvd0FuY2VzdG9yKG5vZGUpIHsKICAgIGNvbnN0IHBhcmVudE5vZGUgPSBnZXRQYXJlbnROb2RlKG5vZGUpOwogICAgaWYgKGlzTGFzdFRyYXZlcnNhYmxlTm9kZShwYXJlbnROb2RlKSkgewogICAgICByZXR1cm4gbm9kZS5vd25lckRvY3VtZW50ID8gbm9kZS5vd25lckRvY3VtZW50LmJvZHkgOiBub2RlLmJvZHk7CiAgICB9CiAgICBpZiAoaXNIVE1MRWxlbWVudChwYXJlbnROb2RlKSAmJiBpc092ZXJmbG93RWxlbWVudChwYXJlbnROb2RlKSkgewogICAgICByZXR1cm4gcGFyZW50Tm9kZTsKICAgIH0KICAgIHJldHVybiBnZXROZWFyZXN0T3ZlcmZsb3dBbmNlc3RvcihwYXJlbnROb2RlKTsKICB9CiAgZnVuY3Rpb24gZ2V0T3ZlcmZsb3dBbmNlc3RvcnMobm9kZSwgbGlzdCwgdHJhdmVyc2VJZnJhbWVzKSB7CiAgICB2YXIgX25vZGUkb3duZXJEb2N1bWVudDI7CiAgICBpZiAobGlzdCA9PT0gdm9pZCAwKSB7CiAgICAgIGxpc3QgPSBbXTsKICAgIH0KICAgIGlmICh0cmF2ZXJzZUlmcmFtZXMgPT09IHZvaWQgMCkgewogICAgICB0cmF2ZXJzZUlmcmFtZXMgPSB0cnVlOwogICAgfQogICAgY29uc3Qgc2Nyb2xsYWJsZUFuY2VzdG9yID0gZ2V0TmVhcmVzdE92ZXJmbG93QW5jZXN0b3Iobm9kZSk7CiAgICBjb25zdCBpc0JvZHkgPSBzY3JvbGxhYmxlQW5jZXN0b3IgPT09ICgoX25vZGUkb3duZXJEb2N1bWVudDIgPSBub2RlLm93bmVyRG9jdW1lbnQpID09IG51bGwgPyB2b2lkIDAgOiBfbm9kZSRvd25lckRvY3VtZW50Mi5ib2R5KTsKICAgIGNvbnN0IHdpbiA9IGdldFdpbmRvdyhzY3JvbGxhYmxlQW5jZXN0b3IpOwogICAgaWYgKGlzQm9keSkgewogICAgICByZXR1cm4gbGlzdC5jb25jYXQod2luLCB3aW4udmlzdWFsVmlld3BvcnQgfHwgW10sIGlzT3ZlcmZsb3dFbGVtZW50KHNjcm9sbGFibGVBbmNlc3RvcikgPyBzY3JvbGxhYmxlQW5jZXN0b3IgOiBbXSwgd2luLmZyYW1lRWxlbWVudCAmJiB0cmF2ZXJzZUlmcmFtZXMgPyBnZXRPdmVyZmxvd0FuY2VzdG9ycyh3aW4uZnJhbWVFbGVtZW50KSA6IFtdKTsKICAgIH0KICAgIHJldHVybiBsaXN0LmNvbmNhdChzY3JvbGxhYmxlQW5jZXN0b3IsIGdldE92ZXJmbG93QW5jZXN0b3JzKHNjcm9sbGFibGVBbmNlc3RvciwgW10sIHRyYXZlcnNlSWZyYW1lcykpOwogIH0KCiAgZnVuY3Rpb24gZ2V0Q3NzRGltZW5zaW9ucyhlbGVtZW50KSB7CiAgICBjb25zdCBjc3MgPSBnZXRDb21wdXRlZFN0eWxlJDEoZWxlbWVudCk7CiAgICAvLyBJbiB0ZXN0aW5nIGVudmlyb25tZW50cywgdGhlIGB3aWR0aGAgYW5kIGBoZWlnaHRgIHByb3BlcnRpZXMgYXJlIGVtcHR5CiAgICAvLyBzdHJpbmdzIGZvciBTVkcgZWxlbWVudHMsIHJldHVybmluZyBOYU4uIEZhbGxiYWNrIHRvIGAwYCBpbiB0aGlzIGNhc2UuCiAgICBsZXQgd2lkdGggPSBwYXJzZUZsb2F0KGNzcy53aWR0aCkgfHwgMDsKICAgIGxldCBoZWlnaHQgPSBwYXJzZUZsb2F0KGNzcy5oZWlnaHQpIHx8IDA7CiAgICBjb25zdCBoYXNPZmZzZXQgPSBpc0hUTUxFbGVtZW50KGVsZW1lbnQpOwogICAgY29uc3Qgb2Zmc2V0V2lkdGggPSBoYXNPZmZzZXQgPyBlbGVtZW50Lm9mZnNldFdpZHRoIDogd2lkdGg7CiAgICBjb25zdCBvZmZzZXRIZWlnaHQgPSBoYXNPZmZzZXQgPyBlbGVtZW50Lm9mZnNldEhlaWdodCA6IGhlaWdodDsKICAgIGNvbnN0IHNob3VsZEZhbGxiYWNrID0gcm91bmQod2lkdGgpICE9PSBvZmZzZXRXaWR0aCB8fCByb3VuZChoZWlnaHQpICE9PSBvZmZzZXRIZWlnaHQ7CiAgICBpZiAoc2hvdWxkRmFsbGJhY2spIHsKICAgICAgd2lkdGggPSBvZmZzZXRXaWR0aDsKICAgICAgaGVpZ2h0ID0gb2Zmc2V0SGVpZ2h0OwogICAgfQogICAgcmV0dXJuIHsKICAgICAgd2lkdGgsCiAgICAgIGhlaWdodCwKICAgICAgJDogc2hvdWxkRmFsbGJhY2sKICAgIH07CiAgfQoKICBmdW5jdGlvbiB1bndyYXBFbGVtZW50KGVsZW1lbnQpIHsKICAgIHJldHVybiAhaXNFbGVtZW50KGVsZW1lbnQpID8gZWxlbWVudC5jb250ZXh0RWxlbWVudCA6IGVsZW1lbnQ7CiAgfQoKICBmdW5jdGlvbiBnZXRTY2FsZShlbGVtZW50KSB7CiAgICBjb25zdCBkb21FbGVtZW50ID0gdW53cmFwRWxlbWVudChlbGVtZW50KTsKICAgIGlmICghaXNIVE1MRWxlbWVudChkb21FbGVtZW50KSkgewogICAgICByZXR1cm4gY3JlYXRlQ29vcmRzKDEpOwogICAgfQogICAgY29uc3QgcmVjdCA9IGRvbUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICBjb25zdCB7CiAgICAgIHdpZHRoLAogICAgICBoZWlnaHQsCiAgICAgICQKICAgIH0gPSBnZXRDc3NEaW1lbnNpb25zKGRvbUVsZW1lbnQpOwogICAgbGV0IHggPSAoJCA/IHJvdW5kKHJlY3Qud2lkdGgpIDogcmVjdC53aWR0aCkgLyB3aWR0aDsKICAgIGxldCB5ID0gKCQgPyByb3VuZChyZWN0LmhlaWdodCkgOiByZWN0LmhlaWdodCkgLyBoZWlnaHQ7CgogICAgLy8gMCwgTmFOLCBvciBJbmZpbml0eSBzaG91bGQgYWx3YXlzIGZhbGxiYWNrIHRvIDEuCgogICAgaWYgKCF4IHx8ICFOdW1iZXIuaXNGaW5pdGUoeCkpIHsKICAgICAgeCA9IDE7CiAgICB9CiAgICBpZiAoIXkgfHwgIU51bWJlci5pc0Zpbml0ZSh5KSkgewogICAgICB5ID0gMTsKICAgIH0KICAgIHJldHVybiB7CiAgICAgIHgsCiAgICAgIHkKICAgIH07CiAgfQoKICBjb25zdCBub09mZnNldHMgPSAvKiNfX1BVUkVfXyovY3JlYXRlQ29vcmRzKDApOwogIGZ1bmN0aW9uIGdldFZpc3VhbE9mZnNldHMoZWxlbWVudCkgewogICAgY29uc3Qgd2luID0gZ2V0V2luZG93KGVsZW1lbnQpOwogICAgaWYgKCFpc1dlYktpdCgpIHx8ICF3aW4udmlzdWFsVmlld3BvcnQpIHsKICAgICAgcmV0dXJuIG5vT2Zmc2V0czsKICAgIH0KICAgIHJldHVybiB7CiAgICAgIHg6IHdpbi52aXN1YWxWaWV3cG9ydC5vZmZzZXRMZWZ0LAogICAgICB5OiB3aW4udmlzdWFsVmlld3BvcnQub2Zmc2V0VG9wCiAgICB9OwogIH0KICBmdW5jdGlvbiBzaG91bGRBZGRWaXN1YWxPZmZzZXRzKGVsZW1lbnQsIGlzRml4ZWQsIGZsb2F0aW5nT2Zmc2V0UGFyZW50KSB7CiAgICBpZiAoaXNGaXhlZCA9PT0gdm9pZCAwKSB7CiAgICAgIGlzRml4ZWQgPSBmYWxzZTsKICAgIH0KICAgIGlmICghZmxvYXRpbmdPZmZzZXRQYXJlbnQgfHwgaXNGaXhlZCAmJiBmbG9hdGluZ09mZnNldFBhcmVudCAhPT0gZ2V0V2luZG93KGVsZW1lbnQpKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHJldHVybiBpc0ZpeGVkOwogIH0KCiAgZnVuY3Rpb24gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KGVsZW1lbnQsIGluY2x1ZGVTY2FsZSwgaXNGaXhlZFN0cmF0ZWd5LCBvZmZzZXRQYXJlbnQpIHsKICAgIGlmIChpbmNsdWRlU2NhbGUgPT09IHZvaWQgMCkgewogICAgICBpbmNsdWRlU2NhbGUgPSBmYWxzZTsKICAgIH0KICAgIGlmIChpc0ZpeGVkU3RyYXRlZ3kgPT09IHZvaWQgMCkgewogICAgICBpc0ZpeGVkU3RyYXRlZ3kgPSBmYWxzZTsKICAgIH0KICAgIGNvbnN0IGNsaWVudFJlY3QgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgY29uc3QgZG9tRWxlbWVudCA9IHVud3JhcEVsZW1lbnQoZWxlbWVudCk7CiAgICBsZXQgc2NhbGUgPSBjcmVhdGVDb29yZHMoMSk7CiAgICBpZiAoaW5jbHVkZVNjYWxlKSB7CiAgICAgIGlmIChvZmZzZXRQYXJlbnQpIHsKICAgICAgICBpZiAoaXNFbGVtZW50KG9mZnNldFBhcmVudCkpIHsKICAgICAgICAgIHNjYWxlID0gZ2V0U2NhbGUob2Zmc2V0UGFyZW50KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2NhbGUgPSBnZXRTY2FsZShlbGVtZW50KTsKICAgICAgfQogICAgfQogICAgY29uc3QgdmlzdWFsT2Zmc2V0cyA9IHNob3VsZEFkZFZpc3VhbE9mZnNldHMoZG9tRWxlbWVudCwgaXNGaXhlZFN0cmF0ZWd5LCBvZmZzZXRQYXJlbnQpID8gZ2V0VmlzdWFsT2Zmc2V0cyhkb21FbGVtZW50KSA6IGNyZWF0ZUNvb3JkcygwKTsKICAgIGxldCB4ID0gKGNsaWVudFJlY3QubGVmdCArIHZpc3VhbE9mZnNldHMueCkgLyBzY2FsZS54OwogICAgbGV0IHkgPSAoY2xpZW50UmVjdC50b3AgKyB2aXN1YWxPZmZzZXRzLnkpIC8gc2NhbGUueTsKICAgIGxldCB3aWR0aCA9IGNsaWVudFJlY3Qud2lkdGggLyBzY2FsZS54OwogICAgbGV0IGhlaWdodCA9IGNsaWVudFJlY3QuaGVpZ2h0IC8gc2NhbGUueTsKICAgIGlmIChkb21FbGVtZW50KSB7CiAgICAgIGNvbnN0IHdpbiA9IGdldFdpbmRvdyhkb21FbGVtZW50KTsKICAgICAgY29uc3Qgb2Zmc2V0V2luID0gb2Zmc2V0UGFyZW50ICYmIGlzRWxlbWVudChvZmZzZXRQYXJlbnQpID8gZ2V0V2luZG93KG9mZnNldFBhcmVudCkgOiBvZmZzZXRQYXJlbnQ7CiAgICAgIGxldCBjdXJyZW50SUZyYW1lID0gd2luLmZyYW1lRWxlbWVudDsKICAgICAgd2hpbGUgKGN1cnJlbnRJRnJhbWUgJiYgb2Zmc2V0UGFyZW50ICYmIG9mZnNldFdpbiAhPT0gd2luKSB7CiAgICAgICAgY29uc3QgaWZyYW1lU2NhbGUgPSBnZXRTY2FsZShjdXJyZW50SUZyYW1lKTsKICAgICAgICBjb25zdCBpZnJhbWVSZWN0ID0gY3VycmVudElGcmFtZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICBjb25zdCBjc3MgPSBnZXRDb21wdXRlZFN0eWxlJDEoY3VycmVudElGcmFtZSk7CiAgICAgICAgY29uc3QgbGVmdCA9IGlmcmFtZVJlY3QubGVmdCArIChjdXJyZW50SUZyYW1lLmNsaWVudExlZnQgKyBwYXJzZUZsb2F0KGNzcy5wYWRkaW5nTGVmdCkpICogaWZyYW1lU2NhbGUueDsKICAgICAgICBjb25zdCB0b3AgPSBpZnJhbWVSZWN0LnRvcCArIChjdXJyZW50SUZyYW1lLmNsaWVudFRvcCArIHBhcnNlRmxvYXQoY3NzLnBhZGRpbmdUb3ApKSAqIGlmcmFtZVNjYWxlLnk7CiAgICAgICAgeCAqPSBpZnJhbWVTY2FsZS54OwogICAgICAgIHkgKj0gaWZyYW1lU2NhbGUueTsKICAgICAgICB3aWR0aCAqPSBpZnJhbWVTY2FsZS54OwogICAgICAgIGhlaWdodCAqPSBpZnJhbWVTY2FsZS55OwogICAgICAgIHggKz0gbGVmdDsKICAgICAgICB5ICs9IHRvcDsKICAgICAgICBjdXJyZW50SUZyYW1lID0gZ2V0V2luZG93KGN1cnJlbnRJRnJhbWUpLmZyYW1lRWxlbWVudDsKICAgICAgfQogICAgfQogICAgcmV0dXJuIHJlY3RUb0NsaWVudFJlY3QoewogICAgICB3aWR0aCwKICAgICAgaGVpZ2h0LAogICAgICB4LAogICAgICB5CiAgICB9KTsKICB9CgogIGZ1bmN0aW9uIGNvbnZlcnRPZmZzZXRQYXJlbnRSZWxhdGl2ZVJlY3RUb1ZpZXdwb3J0UmVsYXRpdmVSZWN0KF9yZWYpIHsKICAgIGxldCB7CiAgICAgIHJlY3QsCiAgICAgIG9mZnNldFBhcmVudCwKICAgICAgc3RyYXRlZ3kKICAgIH0gPSBfcmVmOwogICAgY29uc3QgaXNPZmZzZXRQYXJlbnRBbkVsZW1lbnQgPSBpc0hUTUxFbGVtZW50KG9mZnNldFBhcmVudCk7CiAgICBjb25zdCBkb2N1bWVudEVsZW1lbnQgPSBnZXREb2N1bWVudEVsZW1lbnQob2Zmc2V0UGFyZW50KTsKICAgIGlmIChvZmZzZXRQYXJlbnQgPT09IGRvY3VtZW50RWxlbWVudCkgewogICAgICByZXR1cm4gcmVjdDsKICAgIH0KICAgIGxldCBzY3JvbGwgPSB7CiAgICAgIHNjcm9sbExlZnQ6IDAsCiAgICAgIHNjcm9sbFRvcDogMAogICAgfTsKICAgIGxldCBzY2FsZSA9IGNyZWF0ZUNvb3JkcygxKTsKICAgIGNvbnN0IG9mZnNldHMgPSBjcmVhdGVDb29yZHMoMCk7CiAgICBpZiAoaXNPZmZzZXRQYXJlbnRBbkVsZW1lbnQgfHwgIWlzT2Zmc2V0UGFyZW50QW5FbGVtZW50ICYmIHN0cmF0ZWd5ICE9PSAnZml4ZWQnKSB7CiAgICAgIGlmIChnZXROb2RlTmFtZShvZmZzZXRQYXJlbnQpICE9PSAnYm9keScgfHwgaXNPdmVyZmxvd0VsZW1lbnQoZG9jdW1lbnRFbGVtZW50KSkgewogICAgICAgIHNjcm9sbCA9IGdldE5vZGVTY3JvbGwob2Zmc2V0UGFyZW50KTsKICAgICAgfQogICAgICBpZiAoaXNIVE1MRWxlbWVudChvZmZzZXRQYXJlbnQpKSB7CiAgICAgICAgY29uc3Qgb2Zmc2V0UmVjdCA9IGdldEJvdW5kaW5nQ2xpZW50UmVjdChvZmZzZXRQYXJlbnQpOwogICAgICAgIHNjYWxlID0gZ2V0U2NhbGUob2Zmc2V0UGFyZW50KTsKICAgICAgICBvZmZzZXRzLnggPSBvZmZzZXRSZWN0LnggKyBvZmZzZXRQYXJlbnQuY2xpZW50TGVmdDsKICAgICAgICBvZmZzZXRzLnkgPSBvZmZzZXRSZWN0LnkgKyBvZmZzZXRQYXJlbnQuY2xpZW50VG9wOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gewogICAgICB3aWR0aDogcmVjdC53aWR0aCAqIHNjYWxlLngsCiAgICAgIGhlaWdodDogcmVjdC5oZWlnaHQgKiBzY2FsZS55LAogICAgICB4OiByZWN0LnggKiBzY2FsZS54IC0gc2Nyb2xsLnNjcm9sbExlZnQgKiBzY2FsZS54ICsgb2Zmc2V0cy54LAogICAgICB5OiByZWN0LnkgKiBzY2FsZS55IC0gc2Nyb2xsLnNjcm9sbFRvcCAqIHNjYWxlLnkgKyBvZmZzZXRzLnkKICAgIH07CiAgfQoKICBmdW5jdGlvbiBnZXRDbGllbnRSZWN0cyhlbGVtZW50KSB7CiAgICByZXR1cm4gQXJyYXkuZnJvbShlbGVtZW50LmdldENsaWVudFJlY3RzKCkpOwogIH0KCiAgZnVuY3Rpb24gZ2V0V2luZG93U2Nyb2xsQmFyWChlbGVtZW50KSB7CiAgICAvLyBJZiA8aHRtbD4gaGFzIGEgQ1NTIHdpZHRoIGdyZWF0ZXIgdGhhbiB0aGUgdmlld3BvcnQsIHRoZW4gdGhpcyB3aWxsIGJlCiAgICAvLyBpbmNvcnJlY3QgZm9yIFJUTC4KICAgIHJldHVybiBnZXRCb3VuZGluZ0NsaWVudFJlY3QoZ2V0RG9jdW1lbnRFbGVtZW50KGVsZW1lbnQpKS5sZWZ0ICsgZ2V0Tm9kZVNjcm9sbChlbGVtZW50KS5zY3JvbGxMZWZ0OwogIH0KCiAgLy8gR2V0cyB0aGUgZW50aXJlIHNpemUgb2YgdGhlIHNjcm9sbGFibGUgZG9jdW1lbnQgYXJlYSwgZXZlbiBleHRlbmRpbmcgb3V0c2lkZQogIC8vIG9mIHRoZSBgPGh0bWw+YCBhbmQgYDxib2R5PmAgcmVjdCBib3VuZHMgaWYgaG9yaXpvbnRhbGx5IHNjcm9sbGFibGUuCiAgZnVuY3Rpb24gZ2V0RG9jdW1lbnRSZWN0KGVsZW1lbnQpIHsKICAgIGNvbnN0IGh0bWwgPSBnZXREb2N1bWVudEVsZW1lbnQoZWxlbWVudCk7CiAgICBjb25zdCBzY3JvbGwgPSBnZXROb2RlU2Nyb2xsKGVsZW1lbnQpOwogICAgY29uc3QgYm9keSA9IGVsZW1lbnQub3duZXJEb2N1bWVudC5ib2R5OwogICAgY29uc3Qgd2lkdGggPSBtYXgoaHRtbC5zY3JvbGxXaWR0aCwgaHRtbC5jbGllbnRXaWR0aCwgYm9keS5zY3JvbGxXaWR0aCwgYm9keS5jbGllbnRXaWR0aCk7CiAgICBjb25zdCBoZWlnaHQgPSBtYXgoaHRtbC5zY3JvbGxIZWlnaHQsIGh0bWwuY2xpZW50SGVpZ2h0LCBib2R5LnNjcm9sbEhlaWdodCwgYm9keS5jbGllbnRIZWlnaHQpOwogICAgbGV0IHggPSAtc2Nyb2xsLnNjcm9sbExlZnQgKyBnZXRXaW5kb3dTY3JvbGxCYXJYKGVsZW1lbnQpOwogICAgY29uc3QgeSA9IC1zY3JvbGwuc2Nyb2xsVG9wOwogICAgaWYgKGdldENvbXB1dGVkU3R5bGUkMShib2R5KS5kaXJlY3Rpb24gPT09ICdydGwnKSB7CiAgICAgIHggKz0gbWF4KGh0bWwuY2xpZW50V2lkdGgsIGJvZHkuY2xpZW50V2lkdGgpIC0gd2lkdGg7CiAgICB9CiAgICByZXR1cm4gewogICAgICB3aWR0aCwKICAgICAgaGVpZ2h0LAogICAgICB4LAogICAgICB5CiAgICB9OwogIH0KCiAgZnVuY3Rpb24gZ2V0Vmlld3BvcnRSZWN0KGVsZW1lbnQsIHN0cmF0ZWd5KSB7CiAgICBjb25zdCB3aW4gPSBnZXRXaW5kb3coZWxlbWVudCk7CiAgICBjb25zdCBodG1sID0gZ2V0RG9jdW1lbnRFbGVtZW50KGVsZW1lbnQpOwogICAgY29uc3QgdmlzdWFsVmlld3BvcnQgPSB3aW4udmlzdWFsVmlld3BvcnQ7CiAgICBsZXQgd2lkdGggPSBodG1sLmNsaWVudFdpZHRoOwogICAgbGV0IGhlaWdodCA9IGh0bWwuY2xpZW50SGVpZ2h0OwogICAgbGV0IHggPSAwOwogICAgbGV0IHkgPSAwOwogICAgaWYgKHZpc3VhbFZpZXdwb3J0KSB7CiAgICAgIHdpZHRoID0gdmlzdWFsVmlld3BvcnQud2lkdGg7CiAgICAgIGhlaWdodCA9IHZpc3VhbFZpZXdwb3J0LmhlaWdodDsKICAgICAgY29uc3QgdmlzdWFsVmlld3BvcnRCYXNlZCA9IGlzV2ViS2l0KCk7CiAgICAgIGlmICghdmlzdWFsVmlld3BvcnRCYXNlZCB8fCB2aXN1YWxWaWV3cG9ydEJhc2VkICYmIHN0cmF0ZWd5ID09PSAnZml4ZWQnKSB7CiAgICAgICAgeCA9IHZpc3VhbFZpZXdwb3J0Lm9mZnNldExlZnQ7CiAgICAgICAgeSA9IHZpc3VhbFZpZXdwb3J0Lm9mZnNldFRvcDsKICAgICAgfQogICAgfQogICAgcmV0dXJuIHsKICAgICAgd2lkdGgsCiAgICAgIGhlaWdodCwKICAgICAgeCwKICAgICAgeQogICAgfTsKICB9CgogIC8vIFJldHVybnMgdGhlIGlubmVyIGNsaWVudCByZWN0LCBzdWJ0cmFjdGluZyBzY3JvbGxiYXJzIGlmIHByZXNlbnQuCiAgZnVuY3Rpb24gZ2V0SW5uZXJCb3VuZGluZ0NsaWVudFJlY3QoZWxlbWVudCwgc3RyYXRlZ3kpIHsKICAgIGNvbnN0IGNsaWVudFJlY3QgPSBnZXRCb3VuZGluZ0NsaWVudFJlY3QoZWxlbWVudCwgdHJ1ZSwgc3RyYXRlZ3kgPT09ICdmaXhlZCcpOwogICAgY29uc3QgdG9wID0gY2xpZW50UmVjdC50b3AgKyBlbGVtZW50LmNsaWVudFRvcDsKICAgIGNvbnN0IGxlZnQgPSBjbGllbnRSZWN0LmxlZnQgKyBlbGVtZW50LmNsaWVudExlZnQ7CiAgICBjb25zdCBzY2FsZSA9IGlzSFRNTEVsZW1lbnQoZWxlbWVudCkgPyBnZXRTY2FsZShlbGVtZW50KSA6IGNyZWF0ZUNvb3JkcygxKTsKICAgIGNvbnN0IHdpZHRoID0gZWxlbWVudC5jbGllbnRXaWR0aCAqIHNjYWxlLng7CiAgICBjb25zdCBoZWlnaHQgPSBlbGVtZW50LmNsaWVudEhlaWdodCAqIHNjYWxlLnk7CiAgICBjb25zdCB4ID0gbGVmdCAqIHNjYWxlLng7CiAgICBjb25zdCB5ID0gdG9wICogc2NhbGUueTsKICAgIHJldHVybiB7CiAgICAgIHdpZHRoLAogICAgICBoZWlnaHQsCiAgICAgIHgsCiAgICAgIHkKICAgIH07CiAgfQogIGZ1bmN0aW9uIGdldENsaWVudFJlY3RGcm9tQ2xpcHBpbmdBbmNlc3RvcihlbGVtZW50LCBjbGlwcGluZ0FuY2VzdG9yLCBzdHJhdGVneSkgewogICAgbGV0IHJlY3Q7CiAgICBpZiAoY2xpcHBpbmdBbmNlc3RvciA9PT0gJ3ZpZXdwb3J0JykgewogICAgICByZWN0ID0gZ2V0Vmlld3BvcnRSZWN0KGVsZW1lbnQsIHN0cmF0ZWd5KTsKICAgIH0gZWxzZSBpZiAoY2xpcHBpbmdBbmNlc3RvciA9PT0gJ2RvY3VtZW50JykgewogICAgICByZWN0ID0gZ2V0RG9jdW1lbnRSZWN0KGdldERvY3VtZW50RWxlbWVudChlbGVtZW50KSk7CiAgICB9IGVsc2UgaWYgKGlzRWxlbWVudChjbGlwcGluZ0FuY2VzdG9yKSkgewogICAgICByZWN0ID0gZ2V0SW5uZXJCb3VuZGluZ0NsaWVudFJlY3QoY2xpcHBpbmdBbmNlc3Rvciwgc3RyYXRlZ3kpOwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgdmlzdWFsT2Zmc2V0cyA9IGdldFZpc3VhbE9mZnNldHMoZWxlbWVudCk7CiAgICAgIHJlY3QgPSB7CiAgICAgICAgLi4uY2xpcHBpbmdBbmNlc3RvciwKICAgICAgICB4OiBjbGlwcGluZ0FuY2VzdG9yLnggLSB2aXN1YWxPZmZzZXRzLngsCiAgICAgICAgeTogY2xpcHBpbmdBbmNlc3Rvci55IC0gdmlzdWFsT2Zmc2V0cy55CiAgICAgIH07CiAgICB9CiAgICByZXR1cm4gcmVjdFRvQ2xpZW50UmVjdChyZWN0KTsKICB9CiAgZnVuY3Rpb24gaGFzRml4ZWRQb3NpdGlvbkFuY2VzdG9yKGVsZW1lbnQsIHN0b3BOb2RlKSB7CiAgICBjb25zdCBwYXJlbnROb2RlID0gZ2V0UGFyZW50Tm9kZShlbGVtZW50KTsKICAgIGlmIChwYXJlbnROb2RlID09PSBzdG9wTm9kZSB8fCAhaXNFbGVtZW50KHBhcmVudE5vZGUpIHx8IGlzTGFzdFRyYXZlcnNhYmxlTm9kZShwYXJlbnROb2RlKSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICByZXR1cm4gZ2V0Q29tcHV0ZWRTdHlsZSQxKHBhcmVudE5vZGUpLnBvc2l0aW9uID09PSAnZml4ZWQnIHx8IGhhc0ZpeGVkUG9zaXRpb25BbmNlc3RvcihwYXJlbnROb2RlLCBzdG9wTm9kZSk7CiAgfQoKICAvLyBBICJjbGlwcGluZyBhbmNlc3RvciIgaXMgYW4gYG92ZXJmbG93YCBlbGVtZW50IHdpdGggdGhlIGNoYXJhY3RlcmlzdGljIG9mCiAgLy8gY2xpcHBpbmcgKG9yIGhpZGluZykgY2hpbGQgZWxlbWVudHMuIFRoaXMgcmV0dXJucyBhbGwgY2xpcHBpbmcgYW5jZXN0b3JzCiAgLy8gb2YgdGhlIGdpdmVuIGVsZW1lbnQgdXAgdGhlIHRyZWUuCiAgZnVuY3Rpb24gZ2V0Q2xpcHBpbmdFbGVtZW50QW5jZXN0b3JzKGVsZW1lbnQsIGNhY2hlKSB7CiAgICBjb25zdCBjYWNoZWRSZXN1bHQgPSBjYWNoZS5nZXQoZWxlbWVudCk7CiAgICBpZiAoY2FjaGVkUmVzdWx0KSB7CiAgICAgIHJldHVybiBjYWNoZWRSZXN1bHQ7CiAgICB9CiAgICBsZXQgcmVzdWx0ID0gZ2V0T3ZlcmZsb3dBbmNlc3RvcnMoZWxlbWVudCwgW10sIGZhbHNlKS5maWx0ZXIoZWwgPT4gaXNFbGVtZW50KGVsKSAmJiBnZXROb2RlTmFtZShlbCkgIT09ICdib2R5Jyk7CiAgICBsZXQgY3VycmVudENvbnRhaW5pbmdCbG9ja0NvbXB1dGVkU3R5bGUgPSBudWxsOwogICAgY29uc3QgZWxlbWVudElzRml4ZWQgPSBnZXRDb21wdXRlZFN0eWxlJDEoZWxlbWVudCkucG9zaXRpb24gPT09ICdmaXhlZCc7CiAgICBsZXQgY3VycmVudE5vZGUgPSBlbGVtZW50SXNGaXhlZCA/IGdldFBhcmVudE5vZGUoZWxlbWVudCkgOiBlbGVtZW50OwoKICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0NTUy9Db250YWluaW5nX2Jsb2NrI2lkZW50aWZ5aW5nX3RoZV9jb250YWluaW5nX2Jsb2NrCiAgICB3aGlsZSAoaXNFbGVtZW50KGN1cnJlbnROb2RlKSAmJiAhaXNMYXN0VHJhdmVyc2FibGVOb2RlKGN1cnJlbnROb2RlKSkgewogICAgICBjb25zdCBjb21wdXRlZFN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZSQxKGN1cnJlbnROb2RlKTsKICAgICAgY29uc3QgY3VycmVudE5vZGVJc0NvbnRhaW5pbmcgPSBpc0NvbnRhaW5pbmdCbG9jayhjdXJyZW50Tm9kZSk7CiAgICAgIGlmICghY3VycmVudE5vZGVJc0NvbnRhaW5pbmcgJiYgY29tcHV0ZWRTdHlsZS5wb3NpdGlvbiA9PT0gJ2ZpeGVkJykgewogICAgICAgIGN1cnJlbnRDb250YWluaW5nQmxvY2tDb21wdXRlZFN0eWxlID0gbnVsbDsKICAgICAgfQogICAgICBjb25zdCBzaG91bGREcm9wQ3VycmVudE5vZGUgPSBlbGVtZW50SXNGaXhlZCA/ICFjdXJyZW50Tm9kZUlzQ29udGFpbmluZyAmJiAhY3VycmVudENvbnRhaW5pbmdCbG9ja0NvbXB1dGVkU3R5bGUgOiAhY3VycmVudE5vZGVJc0NvbnRhaW5pbmcgJiYgY29tcHV0ZWRTdHlsZS5wb3NpdGlvbiA9PT0gJ3N0YXRpYycgJiYgISFjdXJyZW50Q29udGFpbmluZ0Jsb2NrQ29tcHV0ZWRTdHlsZSAmJiBbJ2Fic29sdXRlJywgJ2ZpeGVkJ10uaW5jbHVkZXMoY3VycmVudENvbnRhaW5pbmdCbG9ja0NvbXB1dGVkU3R5bGUucG9zaXRpb24pIHx8IGlzT3ZlcmZsb3dFbGVtZW50KGN1cnJlbnROb2RlKSAmJiAhY3VycmVudE5vZGVJc0NvbnRhaW5pbmcgJiYgaGFzRml4ZWRQb3NpdGlvbkFuY2VzdG9yKGVsZW1lbnQsIGN1cnJlbnROb2RlKTsKICAgICAgaWYgKHNob3VsZERyb3BDdXJyZW50Tm9kZSkgewogICAgICAgIC8vIERyb3Agbm9uLWNvbnRhaW5pbmcgYmxvY2tzLgogICAgICAgIHJlc3VsdCA9IHJlc3VsdC5maWx0ZXIoYW5jZXN0b3IgPT4gYW5jZXN0b3IgIT09IGN1cnJlbnROb2RlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBSZWNvcmQgbGFzdCBjb250YWluaW5nIGJsb2NrIGZvciBuZXh0IGl0ZXJhdGlvbi4KICAgICAgICBjdXJyZW50Q29udGFpbmluZ0Jsb2NrQ29tcHV0ZWRTdHlsZSA9IGNvbXB1dGVkU3R5bGU7CiAgICAgIH0KICAgICAgY3VycmVudE5vZGUgPSBnZXRQYXJlbnROb2RlKGN1cnJlbnROb2RlKTsKICAgIH0KICAgIGNhY2hlLnNldChlbGVtZW50LCByZXN1bHQpOwogICAgcmV0dXJuIHJlc3VsdDsKICB9CgogIC8vIEdldHMgdGhlIG1heGltdW0gYXJlYSB0aGF0IHRoZSBlbGVtZW50IGlzIHZpc2libGUgaW4gZHVlIHRvIGFueSBudW1iZXIgb2YKICAvLyBjbGlwcGluZyBhbmNlc3RvcnMuCiAgZnVuY3Rpb24gZ2V0Q2xpcHBpbmdSZWN0KF9yZWYpIHsKICAgIGxldCB7CiAgICAgIGVsZW1lbnQsCiAgICAgIGJvdW5kYXJ5LAogICAgICByb290Qm91bmRhcnksCiAgICAgIHN0cmF0ZWd5CiAgICB9ID0gX3JlZjsKICAgIGNvbnN0IGVsZW1lbnRDbGlwcGluZ0FuY2VzdG9ycyA9IGJvdW5kYXJ5ID09PSAnY2xpcHBpbmdBbmNlc3RvcnMnID8gZ2V0Q2xpcHBpbmdFbGVtZW50QW5jZXN0b3JzKGVsZW1lbnQsIHRoaXMuX2MpIDogW10uY29uY2F0KGJvdW5kYXJ5KTsKICAgIGNvbnN0IGNsaXBwaW5nQW5jZXN0b3JzID0gWy4uLmVsZW1lbnRDbGlwcGluZ0FuY2VzdG9ycywgcm9vdEJvdW5kYXJ5XTsKICAgIGNvbnN0IGZpcnN0Q2xpcHBpbmdBbmNlc3RvciA9IGNsaXBwaW5nQW5jZXN0b3JzWzBdOwogICAgY29uc3QgY2xpcHBpbmdSZWN0ID0gY2xpcHBpbmdBbmNlc3RvcnMucmVkdWNlKChhY2NSZWN0LCBjbGlwcGluZ0FuY2VzdG9yKSA9PiB7CiAgICAgIGNvbnN0IHJlY3QgPSBnZXRDbGllbnRSZWN0RnJvbUNsaXBwaW5nQW5jZXN0b3IoZWxlbWVudCwgY2xpcHBpbmdBbmNlc3Rvciwgc3RyYXRlZ3kpOwogICAgICBhY2NSZWN0LnRvcCA9IG1heChyZWN0LnRvcCwgYWNjUmVjdC50b3ApOwogICAgICBhY2NSZWN0LnJpZ2h0ID0gbWluKHJlY3QucmlnaHQsIGFjY1JlY3QucmlnaHQpOwogICAgICBhY2NSZWN0LmJvdHRvbSA9IG1pbihyZWN0LmJvdHRvbSwgYWNjUmVjdC5ib3R0b20pOwogICAgICBhY2NSZWN0LmxlZnQgPSBtYXgocmVjdC5sZWZ0LCBhY2NSZWN0LmxlZnQpOwogICAgICByZXR1cm4gYWNjUmVjdDsKICAgIH0sIGdldENsaWVudFJlY3RGcm9tQ2xpcHBpbmdBbmNlc3RvcihlbGVtZW50LCBmaXJzdENsaXBwaW5nQW5jZXN0b3IsIHN0cmF0ZWd5KSk7CiAgICByZXR1cm4gewogICAgICB3aWR0aDogY2xpcHBpbmdSZWN0LnJpZ2h0IC0gY2xpcHBpbmdSZWN0LmxlZnQsCiAgICAgIGhlaWdodDogY2xpcHBpbmdSZWN0LmJvdHRvbSAtIGNsaXBwaW5nUmVjdC50b3AsCiAgICAgIHg6IGNsaXBwaW5nUmVjdC5sZWZ0LAogICAgICB5OiBjbGlwcGluZ1JlY3QudG9wCiAgICB9OwogIH0KCiAgZnVuY3Rpb24gZ2V0RGltZW5zaW9ucyhlbGVtZW50KSB7CiAgICBjb25zdCB7CiAgICAgIHdpZHRoLAogICAgICBoZWlnaHQKICAgIH0gPSBnZXRDc3NEaW1lbnNpb25zKGVsZW1lbnQpOwogICAgcmV0dXJuIHsKICAgICAgd2lkdGgsCiAgICAgIGhlaWdodAogICAgfTsKICB9CgogIGZ1bmN0aW9uIGdldFJlY3RSZWxhdGl2ZVRvT2Zmc2V0UGFyZW50KGVsZW1lbnQsIG9mZnNldFBhcmVudCwgc3RyYXRlZ3kpIHsKICAgIGNvbnN0IGlzT2Zmc2V0UGFyZW50QW5FbGVtZW50ID0gaXNIVE1MRWxlbWVudChvZmZzZXRQYXJlbnQpOwogICAgY29uc3QgZG9jdW1lbnRFbGVtZW50ID0gZ2V0RG9jdW1lbnRFbGVtZW50KG9mZnNldFBhcmVudCk7CiAgICBjb25zdCBpc0ZpeGVkID0gc3RyYXRlZ3kgPT09ICdmaXhlZCc7CiAgICBjb25zdCByZWN0ID0gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KGVsZW1lbnQsIHRydWUsIGlzRml4ZWQsIG9mZnNldFBhcmVudCk7CiAgICBsZXQgc2Nyb2xsID0gewogICAgICBzY3JvbGxMZWZ0OiAwLAogICAgICBzY3JvbGxUb3A6IDAKICAgIH07CiAgICBjb25zdCBvZmZzZXRzID0gY3JlYXRlQ29vcmRzKDApOwogICAgaWYgKGlzT2Zmc2V0UGFyZW50QW5FbGVtZW50IHx8ICFpc09mZnNldFBhcmVudEFuRWxlbWVudCAmJiAhaXNGaXhlZCkgewogICAgICBpZiAoZ2V0Tm9kZU5hbWUob2Zmc2V0UGFyZW50KSAhPT0gJ2JvZHknIHx8IGlzT3ZlcmZsb3dFbGVtZW50KGRvY3VtZW50RWxlbWVudCkpIHsKICAgICAgICBzY3JvbGwgPSBnZXROb2RlU2Nyb2xsKG9mZnNldFBhcmVudCk7CiAgICAgIH0KICAgICAgaWYgKGlzT2Zmc2V0UGFyZW50QW5FbGVtZW50KSB7CiAgICAgICAgY29uc3Qgb2Zmc2V0UmVjdCA9IGdldEJvdW5kaW5nQ2xpZW50UmVjdChvZmZzZXRQYXJlbnQsIHRydWUsIGlzRml4ZWQsIG9mZnNldFBhcmVudCk7CiAgICAgICAgb2Zmc2V0cy54ID0gb2Zmc2V0UmVjdC54ICsgb2Zmc2V0UGFyZW50LmNsaWVudExlZnQ7CiAgICAgICAgb2Zmc2V0cy55ID0gb2Zmc2V0UmVjdC55ICsgb2Zmc2V0UGFyZW50LmNsaWVudFRvcDsKICAgICAgfSBlbHNlIGlmIChkb2N1bWVudEVsZW1lbnQpIHsKICAgICAgICBvZmZzZXRzLnggPSBnZXRXaW5kb3dTY3JvbGxCYXJYKGRvY3VtZW50RWxlbWVudCk7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB7CiAgICAgIHg6IHJlY3QubGVmdCArIHNjcm9sbC5zY3JvbGxMZWZ0IC0gb2Zmc2V0cy54LAogICAgICB5OiByZWN0LnRvcCArIHNjcm9sbC5zY3JvbGxUb3AgLSBvZmZzZXRzLnksCiAgICAgIHdpZHRoOiByZWN0LndpZHRoLAogICAgICBoZWlnaHQ6IHJlY3QuaGVpZ2h0CiAgICB9OwogIH0KCiAgZnVuY3Rpb24gZ2V0VHJ1ZU9mZnNldFBhcmVudChlbGVtZW50LCBwb2x5ZmlsbCkgewogICAgaWYgKCFpc0hUTUxFbGVtZW50KGVsZW1lbnQpIHx8IGdldENvbXB1dGVkU3R5bGUkMShlbGVtZW50KS5wb3NpdGlvbiA9PT0gJ2ZpeGVkJykgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIGlmIChwb2x5ZmlsbCkgewogICAgICByZXR1cm4gcG9seWZpbGwoZWxlbWVudCk7CiAgICB9CiAgICByZXR1cm4gZWxlbWVudC5vZmZzZXRQYXJlbnQ7CiAgfQoKICAvLyBHZXRzIHRoZSBjbG9zZXN0IGFuY2VzdG9yIHBvc2l0aW9uZWQgZWxlbWVudC4gSGFuZGxlcyBzb21lIGVkZ2UgY2FzZXMsCiAgLy8gc3VjaCBhcyB0YWJsZSBhbmNlc3RvcnMgYW5kIGNyb3NzIGJyb3dzZXIgYnVncy4KICBmdW5jdGlvbiBnZXRPZmZzZXRQYXJlbnQoZWxlbWVudCwgcG9seWZpbGwpIHsKICAgIGNvbnN0IHdpbmRvdyA9IGdldFdpbmRvdyhlbGVtZW50KTsKICAgIGlmICghaXNIVE1MRWxlbWVudChlbGVtZW50KSkgewogICAgICByZXR1cm4gd2luZG93OwogICAgfQogICAgbGV0IG9mZnNldFBhcmVudCA9IGdldFRydWVPZmZzZXRQYXJlbnQoZWxlbWVudCwgcG9seWZpbGwpOwogICAgd2hpbGUgKG9mZnNldFBhcmVudCAmJiBpc1RhYmxlRWxlbWVudChvZmZzZXRQYXJlbnQpICYmIGdldENvbXB1dGVkU3R5bGUkMShvZmZzZXRQYXJlbnQpLnBvc2l0aW9uID09PSAnc3RhdGljJykgewogICAgICBvZmZzZXRQYXJlbnQgPSBnZXRUcnVlT2Zmc2V0UGFyZW50KG9mZnNldFBhcmVudCwgcG9seWZpbGwpOwogICAgfQogICAgaWYgKG9mZnNldFBhcmVudCAmJiAoZ2V0Tm9kZU5hbWUob2Zmc2V0UGFyZW50KSA9PT0gJ2h0bWwnIHx8IGdldE5vZGVOYW1lKG9mZnNldFBhcmVudCkgPT09ICdib2R5JyAmJiBnZXRDb21wdXRlZFN0eWxlJDEob2Zmc2V0UGFyZW50KS5wb3NpdGlvbiA9PT0gJ3N0YXRpYycgJiYgIWlzQ29udGFpbmluZ0Jsb2NrKG9mZnNldFBhcmVudCkpKSB7CiAgICAgIHJldHVybiB3aW5kb3c7CiAgICB9CiAgICByZXR1cm4gb2Zmc2V0UGFyZW50IHx8IGdldENvbnRhaW5pbmdCbG9jayhlbGVtZW50KSB8fCB3aW5kb3c7CiAgfQoKICBjb25zdCBnZXRFbGVtZW50UmVjdHMgPSBhc3luYyBmdW5jdGlvbiAoX3JlZikgewogICAgbGV0IHsKICAgICAgcmVmZXJlbmNlLAogICAgICBmbG9hdGluZywKICAgICAgc3RyYXRlZ3kKICAgIH0gPSBfcmVmOwogICAgY29uc3QgZ2V0T2Zmc2V0UGFyZW50Rm4gPSB0aGlzLmdldE9mZnNldFBhcmVudCB8fCBnZXRPZmZzZXRQYXJlbnQ7CiAgICBjb25zdCBnZXREaW1lbnNpb25zRm4gPSB0aGlzLmdldERpbWVuc2lvbnM7CiAgICByZXR1cm4gewogICAgICByZWZlcmVuY2U6IGdldFJlY3RSZWxhdGl2ZVRvT2Zmc2V0UGFyZW50KHJlZmVyZW5jZSwgYXdhaXQgZ2V0T2Zmc2V0UGFyZW50Rm4oZmxvYXRpbmcpLCBzdHJhdGVneSksCiAgICAgIGZsb2F0aW5nOiB7CiAgICAgICAgeDogMCwKICAgICAgICB5OiAwLAogICAgICAgIC4uLihhd2FpdCBnZXREaW1lbnNpb25zRm4oZmxvYXRpbmcpKQogICAgICB9CiAgICB9OwogIH07CgogIGZ1bmN0aW9uIGlzUlRMKGVsZW1lbnQpIHsKICAgIHJldHVybiBnZXRDb21wdXRlZFN0eWxlJDEoZWxlbWVudCkuZGlyZWN0aW9uID09PSAncnRsJzsKICB9CgogIGNvbnN0IHBsYXRmb3JtID0gewogICAgY29udmVydE9mZnNldFBhcmVudFJlbGF0aXZlUmVjdFRvVmlld3BvcnRSZWxhdGl2ZVJlY3QsCiAgICBnZXREb2N1bWVudEVsZW1lbnQsCiAgICBnZXRDbGlwcGluZ1JlY3QsCiAgICBnZXRPZmZzZXRQYXJlbnQsCiAgICBnZXRFbGVtZW50UmVjdHMsCiAgICBnZXRDbGllbnRSZWN0cywKICAgIGdldERpbWVuc2lvbnMsCiAgICBnZXRTY2FsZSwKICAgIGlzRWxlbWVudCwKICAgIGlzUlRMCiAgfTsKCiAgLy8gaHR0cHM6Ly9zYW10aG9yLmF1LzIwMjEvb2JzZXJ2aW5nLWRvbS8KICBmdW5jdGlvbiBvYnNlcnZlTW92ZShlbGVtZW50LCBvbk1vdmUpIHsKICAgIGxldCBpbyA9IG51bGw7CiAgICBsZXQgdGltZW91dElkOwogICAgY29uc3Qgcm9vdCA9IGdldERvY3VtZW50RWxlbWVudChlbGVtZW50KTsKICAgIGZ1bmN0aW9uIGNsZWFudXAoKSB7CiAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpOwogICAgICBpbyAmJiBpby5kaXNjb25uZWN0KCk7CiAgICAgIGlvID0gbnVsbDsKICAgIH0KICAgIGZ1bmN0aW9uIHJlZnJlc2goc2tpcCwgdGhyZXNob2xkKSB7CiAgICAgIGlmIChza2lwID09PSB2b2lkIDApIHsKICAgICAgICBza2lwID0gZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKHRocmVzaG9sZCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGhyZXNob2xkID0gMTsKICAgICAgfQogICAgICBjbGVhbnVwKCk7CiAgICAgIGNvbnN0IHsKICAgICAgICBsZWZ0LAogICAgICAgIHRvcCwKICAgICAgICB3aWR0aCwKICAgICAgICBoZWlnaHQKICAgICAgfSA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIGlmICghc2tpcCkgewogICAgICAgIG9uTW92ZSgpOwogICAgICB9CiAgICAgIGlmICghd2lkdGggfHwgIWhlaWdodCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBjb25zdCBpbnNldFRvcCA9IGZsb29yKHRvcCk7CiAgICAgIGNvbnN0IGluc2V0UmlnaHQgPSBmbG9vcihyb290LmNsaWVudFdpZHRoIC0gKGxlZnQgKyB3aWR0aCkpOwogICAgICBjb25zdCBpbnNldEJvdHRvbSA9IGZsb29yKHJvb3QuY2xpZW50SGVpZ2h0IC0gKHRvcCArIGhlaWdodCkpOwogICAgICBjb25zdCBpbnNldExlZnQgPSBmbG9vcihsZWZ0KTsKICAgICAgY29uc3Qgcm9vdE1hcmdpbiA9IC1pbnNldFRvcCArICJweCAiICsgLWluc2V0UmlnaHQgKyAicHggIiArIC1pbnNldEJvdHRvbSArICJweCAiICsgLWluc2V0TGVmdCArICJweCI7CiAgICAgIGNvbnN0IG9wdGlvbnMgPSB7CiAgICAgICAgcm9vdE1hcmdpbiwKICAgICAgICB0aHJlc2hvbGQ6IG1heCgwLCBtaW4oMSwgdGhyZXNob2xkKSkgfHwgMQogICAgICB9OwogICAgICBsZXQgaXNGaXJzdFVwZGF0ZSA9IHRydWU7CiAgICAgIGZ1bmN0aW9uIGhhbmRsZU9ic2VydmUoZW50cmllcykgewogICAgICAgIGNvbnN0IHJhdGlvID0gZW50cmllc1swXS5pbnRlcnNlY3Rpb25SYXRpbzsKICAgICAgICBpZiAocmF0aW8gIT09IHRocmVzaG9sZCkgewogICAgICAgICAgaWYgKCFpc0ZpcnN0VXBkYXRlKSB7CiAgICAgICAgICAgIHJldHVybiByZWZyZXNoKCk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoIXJhdGlvKSB7CiAgICAgICAgICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgIHJlZnJlc2goZmFsc2UsIDFlLTcpOwogICAgICAgICAgICB9LCAxMDApOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVmcmVzaChmYWxzZSwgcmF0aW8pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpc0ZpcnN0VXBkYXRlID0gZmFsc2U7CiAgICAgIH0KCiAgICAgIC8vIE9sZGVyIGJyb3dzZXJzIGRvbid0IHN1cHBvcnQgYSBgZG9jdW1lbnRgIGFzIHRoZSByb290IGFuZCB3aWxsIHRocm93IGFuCiAgICAgIC8vIGVycm9yLgogICAgICB0cnkgewogICAgICAgIGlvID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKGhhbmRsZU9ic2VydmUsIHsKICAgICAgICAgIC4uLm9wdGlvbnMsCiAgICAgICAgICAvLyBIYW5kbGUgPGlmcmFtZT5zCiAgICAgICAgICByb290OiByb290Lm93bmVyRG9jdW1lbnQKICAgICAgICB9KTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGlvID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKGhhbmRsZU9ic2VydmUsIG9wdGlvbnMpOwogICAgICB9CiAgICAgIGlvLm9ic2VydmUoZWxlbWVudCk7CiAgICB9CiAgICByZWZyZXNoKHRydWUpOwogICAgcmV0dXJuIGNsZWFudXA7CiAgfQoKICAvKioKICAgKiBBdXRvbWF0aWNhbGx5IHVwZGF0ZXMgdGhlIHBvc2l0aW9uIG9mIHRoZSBmbG9hdGluZyBlbGVtZW50IHdoZW4gbmVjZXNzYXJ5LgogICAqIFNob3VsZCBvbmx5IGJlIGNhbGxlZCB3aGVuIHRoZSBmbG9hdGluZyBlbGVtZW50IGlzIG1vdW50ZWQgb24gdGhlIERPTSBvcgogICAqIHZpc2libGUgb24gdGhlIHNjcmVlbi4KICAgKiBAcmV0dXJucyBjbGVhbnVwIGZ1bmN0aW9uIHRoYXQgc2hvdWxkIGJlIGludm9rZWQgd2hlbiB0aGUgZmxvYXRpbmcgZWxlbWVudCBpcwogICAqIHJlbW92ZWQgZnJvbSB0aGUgRE9NIG9yIGhpZGRlbiBmcm9tIHRoZSBzY3JlZW4uCiAgICogQHNlZSBodHRwczovL2Zsb2F0aW5nLXVpLmNvbS9kb2NzL2F1dG9VcGRhdGUKICAgKi8KICBmdW5jdGlvbiBhdXRvVXBkYXRlKHJlZmVyZW5jZSwgZmxvYXRpbmcsIHVwZGF0ZSwgb3B0aW9ucykgewogICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICBvcHRpb25zID0ge307CiAgICB9CiAgICBjb25zdCB7CiAgICAgIGFuY2VzdG9yU2Nyb2xsID0gdHJ1ZSwKICAgICAgYW5jZXN0b3JSZXNpemUgPSB0cnVlLAogICAgICBlbGVtZW50UmVzaXplID0gdHlwZW9mIFJlc2l6ZU9ic2VydmVyID09PSAnZnVuY3Rpb24nLAogICAgICBsYXlvdXRTaGlmdCA9IHR5cGVvZiBJbnRlcnNlY3Rpb25PYnNlcnZlciA9PT0gJ2Z1bmN0aW9uJywKICAgICAgYW5pbWF0aW9uRnJhbWUgPSBmYWxzZQogICAgfSA9IG9wdGlvbnM7CiAgICBjb25zdCByZWZlcmVuY2VFbCA9IHVud3JhcEVsZW1lbnQocmVmZXJlbmNlKTsKICAgIGNvbnN0IGFuY2VzdG9ycyA9IGFuY2VzdG9yU2Nyb2xsIHx8IGFuY2VzdG9yUmVzaXplID8gWy4uLihyZWZlcmVuY2VFbCA/IGdldE92ZXJmbG93QW5jZXN0b3JzKHJlZmVyZW5jZUVsKSA6IFtdKSwgLi4uZ2V0T3ZlcmZsb3dBbmNlc3RvcnMoZmxvYXRpbmcpXSA6IFtdOwogICAgYW5jZXN0b3JzLmZvckVhY2goYW5jZXN0b3IgPT4gewogICAgICBhbmNlc3RvclNjcm9sbCAmJiBhbmNlc3Rvci5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB1cGRhdGUsIHsKICAgICAgICBwYXNzaXZlOiB0cnVlCiAgICAgIH0pOwogICAgICBhbmNlc3RvclJlc2l6ZSAmJiBhbmNlc3Rvci5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB1cGRhdGUpOwogICAgfSk7CiAgICBjb25zdCBjbGVhbnVwSW8gPSByZWZlcmVuY2VFbCAmJiBsYXlvdXRTaGlmdCA/IG9ic2VydmVNb3ZlKHJlZmVyZW5jZUVsLCB1cGRhdGUpIDogbnVsbDsKICAgIGxldCByZW9ic2VydmVGcmFtZSA9IC0xOwogICAgbGV0IHJlc2l6ZU9ic2VydmVyID0gbnVsbDsKICAgIGlmIChlbGVtZW50UmVzaXplKSB7CiAgICAgIHJlc2l6ZU9ic2VydmVyID0gbmV3IFJlc2l6ZU9ic2VydmVyKF9yZWYgPT4gewogICAgICAgIGxldCBbZmlyc3RFbnRyeV0gPSBfcmVmOwogICAgICAgIGlmIChmaXJzdEVudHJ5ICYmIGZpcnN0RW50cnkudGFyZ2V0ID09PSByZWZlcmVuY2VFbCAmJiByZXNpemVPYnNlcnZlcikgewogICAgICAgICAgLy8gUHJldmVudCB1cGRhdGUgbG9vcHMgd2hlbiB1c2luZyB0aGUgYHNpemVgIG1pZGRsZXdhcmUuCiAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZmxvYXRpbmctdWkvZmxvYXRpbmctdWkvaXNzdWVzLzE3NDAKICAgICAgICAgIHJlc2l6ZU9ic2VydmVyLnVub2JzZXJ2ZShmbG9hdGluZyk7CiAgICAgICAgICBjYW5jZWxBbmltYXRpb25GcmFtZShyZW9ic2VydmVGcmFtZSk7CiAgICAgICAgICByZW9ic2VydmVGcmFtZSA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7CiAgICAgICAgICAgIHJlc2l6ZU9ic2VydmVyICYmIHJlc2l6ZU9ic2VydmVyLm9ic2VydmUoZmxvYXRpbmcpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHVwZGF0ZSgpOwogICAgICB9KTsKICAgICAgaWYgKHJlZmVyZW5jZUVsICYmICFhbmltYXRpb25GcmFtZSkgewogICAgICAgIHJlc2l6ZU9ic2VydmVyLm9ic2VydmUocmVmZXJlbmNlRWwpOwogICAgICB9CiAgICAgIHJlc2l6ZU9ic2VydmVyLm9ic2VydmUoZmxvYXRpbmcpOwogICAgfQogICAgbGV0IGZyYW1lSWQ7CiAgICBsZXQgcHJldlJlZlJlY3QgPSBhbmltYXRpb25GcmFtZSA/IGdldEJvdW5kaW5nQ2xpZW50UmVjdChyZWZlcmVuY2UpIDogbnVsbDsKICAgIGlmIChhbmltYXRpb25GcmFtZSkgewogICAgICBmcmFtZUxvb3AoKTsKICAgIH0KICAgIGZ1bmN0aW9uIGZyYW1lTG9vcCgpIHsKICAgICAgY29uc3QgbmV4dFJlZlJlY3QgPSBnZXRCb3VuZGluZ0NsaWVudFJlY3QocmVmZXJlbmNlKTsKICAgICAgaWYgKHByZXZSZWZSZWN0ICYmIChuZXh0UmVmUmVjdC54ICE9PSBwcmV2UmVmUmVjdC54IHx8IG5leHRSZWZSZWN0LnkgIT09IHByZXZSZWZSZWN0LnkgfHwgbmV4dFJlZlJlY3Qud2lkdGggIT09IHByZXZSZWZSZWN0LndpZHRoIHx8IG5leHRSZWZSZWN0LmhlaWdodCAhPT0gcHJldlJlZlJlY3QuaGVpZ2h0KSkgewogICAgICAgIHVwZGF0ZSgpOwogICAgICB9CiAgICAgIHByZXZSZWZSZWN0ID0gbmV4dFJlZlJlY3Q7CiAgICAgIGZyYW1lSWQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnJhbWVMb29wKTsKICAgIH0KICAgIHVwZGF0ZSgpOwogICAgcmV0dXJuICgpID0+IHsKICAgICAgYW5jZXN0b3JzLmZvckVhY2goYW5jZXN0b3IgPT4gewogICAgICAgIGFuY2VzdG9yU2Nyb2xsICYmIGFuY2VzdG9yLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHVwZGF0ZSk7CiAgICAgICAgYW5jZXN0b3JSZXNpemUgJiYgYW5jZXN0b3IucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdXBkYXRlKTsKICAgICAgfSk7CiAgICAgIGNsZWFudXBJbyAmJiBjbGVhbnVwSW8oKTsKICAgICAgcmVzaXplT2JzZXJ2ZXIgJiYgcmVzaXplT2JzZXJ2ZXIuZGlzY29ubmVjdCgpOwogICAgICByZXNpemVPYnNlcnZlciA9IG51bGw7CiAgICAgIGlmIChhbmltYXRpb25GcmFtZSkgewogICAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKGZyYW1lSWQpOwogICAgICB9CiAgICB9OwogIH0KCiAgLyoqCiAgICogT3B0aW1pemVzIHRoZSB2aXNpYmlsaXR5IG9mIHRoZSBmbG9hdGluZyBlbGVtZW50IGJ5IHNoaWZ0aW5nIGl0IGluIG9yZGVyIHRvCiAgICoga2VlcCBpdCBpbiB2aWV3IHdoZW4gaXQgd2lsbCBvdmVyZmxvdyB0aGUgY2xpcHBpbmcgYm91bmRhcnkuCiAgICogQHNlZSBodHRwczovL2Zsb2F0aW5nLXVpLmNvbS9kb2NzL3NoaWZ0CiAgICovCiAgY29uc3Qgc2hpZnQgPSBzaGlmdCQxOwoKICAvKioKICAgKiBPcHRpbWl6ZXMgdGhlIHZpc2liaWxpdHkgb2YgdGhlIGZsb2F0aW5nIGVsZW1lbnQgYnkgZmxpcHBpbmcgdGhlIGBwbGFjZW1lbnRgCiAgICogaW4gb3JkZXIgdG8ga2VlcCBpdCBpbiB2aWV3IHdoZW4gdGhlIHByZWZlcnJlZCBwbGFjZW1lbnQocykgd2lsbCBvdmVyZmxvdyB0aGUKICAgKiBjbGlwcGluZyBib3VuZGFyeS4gQWx0ZXJuYXRpdmUgdG8gYGF1dG9QbGFjZW1lbnRgLgogICAqIEBzZWUgaHR0cHM6Ly9mbG9hdGluZy11aS5jb20vZG9jcy9mbGlwCiAgICovCiAgY29uc3QgZmxpcCA9IGZsaXAkMTsKCiAgLyoqCiAgICogUHJvdmlkZXMgZGF0YSB0aGF0IGFsbG93cyB5b3UgdG8gY2hhbmdlIHRoZSBzaXplIG9mIHRoZSBmbG9hdGluZyBlbGVtZW50IOKAlAogICAqIGZvciBpbnN0YW5jZSwgcHJldmVudCBpdCBmcm9tIG92ZXJmbG93aW5nIHRoZSBjbGlwcGluZyBib3VuZGFyeSBvciBtYXRjaCB0aGUKICAgKiB3aWR0aCBvZiB0aGUgcmVmZXJlbmNlIGVsZW1lbnQuCiAgICogQHNlZSBodHRwczovL2Zsb2F0aW5nLXVpLmNvbS9kb2NzL3NpemUKICAgKi8KICBjb25zdCBzaXplID0gc2l6ZSQxOwoKICAvKioKICAgKiBQcm92aWRlcyBkYXRhIHRvIHBvc2l0aW9uIGFuIGlubmVyIGVsZW1lbnQgb2YgdGhlIGZsb2F0aW5nIGVsZW1lbnQgc28gdGhhdCBpdAogICAqIGFwcGVhcnMgY2VudGVyZWQgdG8gdGhlIHJlZmVyZW5jZSBlbGVtZW50LgogICAqIEBzZWUgaHR0cHM6Ly9mbG9hdGluZy11aS5jb20vZG9jcy9hcnJvdwogICAqLwogIGNvbnN0IGFycm93ID0gYXJyb3ckMTsKCiAgLyoqCiAgICogQ29tcHV0ZXMgdGhlIGB4YCBhbmQgYHlgIGNvb3JkaW5hdGVzIHRoYXQgd2lsbCBwbGFjZSB0aGUgZmxvYXRpbmcgZWxlbWVudAogICAqIG5leHQgdG8gYSBnaXZlbiByZWZlcmVuY2UgZWxlbWVudC4KICAgKi8KICBjb25zdCBjb21wdXRlUG9zaXRpb24gPSAocmVmZXJlbmNlLCBmbG9hdGluZywgb3B0aW9ucykgPT4gewogICAgLy8gVGhpcyBjYWNoZXMgdGhlIGV4cGVuc2l2ZSBgZ2V0Q2xpcHBpbmdFbGVtZW50QW5jZXN0b3JzYCBmdW5jdGlvbiBzbyB0aGF0CiAgICAvLyBtdWx0aXBsZSBsaWZlY3ljbGUgcmVzZXRzIHJlLXVzZSB0aGUgc2FtZSByZXN1bHQuIEl0IG9ubHkgbGl2ZXMgZm9yIGEKICAgIC8vIHNpbmdsZSBjYWxsLiBJZiBvdGhlciBmdW5jdGlvbnMgYmVjb21lIGV4cGVuc2l2ZSwgd2UgY2FuIGFkZCB0aGVtIGFzIHdlbGwuCiAgICBjb25zdCBjYWNoZSA9IG5ldyBNYXAoKTsKICAgIGNvbnN0IG1lcmdlZE9wdGlvbnMgPSB7CiAgICAgIHBsYXRmb3JtLAogICAgICAuLi5vcHRpb25zCiAgICB9OwogICAgY29uc3QgcGxhdGZvcm1XaXRoQ2FjaGUgPSB7CiAgICAgIC4uLm1lcmdlZE9wdGlvbnMucGxhdGZvcm0sCiAgICAgIF9jOiBjYWNoZQogICAgfTsKICAgIHJldHVybiBjb21wdXRlUG9zaXRpb24kMShyZWZlcmVuY2UsIGZsb2F0aW5nLCB7CiAgICAgIC4uLm1lcmdlZE9wdGlvbnMsCiAgICAgIHBsYXRmb3JtOiBwbGF0Zm9ybVdpdGhDYWNoZQogICAgfSk7CiAgfTsKCiAgLyoqCiAgICogQGxpY2Vuc2UKICAgKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDCiAgICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEJTRC0zLUNsYXVzZQogICAqLwogIGNvbnN0IHQ9e0FUVFJJQlVURToxLENISUxEOjIsUFJPUEVSVFk6MyxCT09MRUFOX0FUVFJJQlVURTo0LEVWRU5UOjUsRUxFTUVOVDo2fSxlJDM9dD0+KC4uLmUpPT4oe18kbGl0RGlyZWN0aXZlJDp0LHZhbHVlczplfSk7Y2xhc3MgaXtjb25zdHJ1Y3Rvcih0KXt9Z2V0IF8kQVUoKXtyZXR1cm4gdGhpcy5fJEFNLl8kQVV9XyRBVCh0LGUsaSl7dGhpcy5fJEN0PXQsdGhpcy5fJEFNPWUsdGhpcy5fJENpPWk7fV8kQVModCxlKXtyZXR1cm4gdGhpcy51cGRhdGUodCxlKX11cGRhdGUodCxlKXtyZXR1cm4gdGhpcy5yZW5kZXIoLi4uZSl9fQoKICAvKioKICAgKiBAbGljZW5zZQogICAqIENvcHlyaWdodCAyMDE4IEdvb2dsZSBMTEMKICAgKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogQlNELTMtQ2xhdXNlCiAgICovY29uc3QgZSQyPWUkMyhjbGFzcyBleHRlbmRzIGl7Y29uc3RydWN0b3IodCQxKXtpZihzdXBlcih0JDEpLHQkMS50eXBlIT09dC5BVFRSSUJVVEV8fCJjbGFzcyIhPT10JDEubmFtZXx8dCQxLnN0cmluZ3M/Lmxlbmd0aD4yKXRocm93IEVycm9yKCJgY2xhc3NNYXAoKWAgY2FuIG9ubHkgYmUgdXNlZCBpbiB0aGUgYGNsYXNzYCBhdHRyaWJ1dGUgYW5kIG11c3QgYmUgdGhlIG9ubHkgcGFydCBpbiB0aGUgYXR0cmlidXRlLiIpfXJlbmRlcih0KXtyZXR1cm4gIiAiK09iamVjdC5rZXlzKHQpLmZpbHRlcigocz0+dFtzXSkpLmpvaW4oIiAiKSsiICJ9dXBkYXRlKHMsW2ldKXtpZih2b2lkIDA9PT10aGlzLml0KXt0aGlzLml0PW5ldyBTZXQsdm9pZCAwIT09cy5zdHJpbmdzJiYodGhpcy5zdD1uZXcgU2V0KHMuc3RyaW5ncy5qb2luKCIgIikuc3BsaXQoL1xzLykuZmlsdGVyKCh0PT4iIiE9PXQpKSkpO2Zvcihjb25zdCB0IGluIGkpaVt0XSYmIXRoaXMuc3Q/Lmhhcyh0KSYmdGhpcy5pdC5hZGQodCk7cmV0dXJuIHRoaXMucmVuZGVyKGkpfWNvbnN0IHI9cy5lbGVtZW50LmNsYXNzTGlzdDtmb3IoY29uc3QgdCBvZiB0aGlzLml0KXQgaW4gaXx8KHIucmVtb3ZlKHQpLHRoaXMuaXQuZGVsZXRlKHQpKTtmb3IoY29uc3QgdCBpbiBpKXtjb25zdCBzPSEhaVt0XTtzPT09dGhpcy5pdC5oYXModCl8fHRoaXMuc3Q/Lmhhcyh0KXx8KHM/KHIuYWRkKHQpLHRoaXMuaXQuYWRkKHQpKTooci5yZW1vdmUodCksdGhpcy5pdC5kZWxldGUodCkpKTt9cmV0dXJuIHd9fSk7CgogIC8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHlwZXMgKi8KICBmdW5jdGlvbiBvZmZzZXRQYXJlbnQoZWxlbWVudCkgewogICAgICByZXR1cm4gb2Zmc2V0UGFyZW50UG9seWZpbGwoZWxlbWVudCk7CiAgfQogIGZ1bmN0aW9uIGZsYXRUcmVlUGFyZW50KGVsZW1lbnQpIHsKICAgICAgaWYgKGVsZW1lbnQuYXNzaWduZWRTbG90KSB7CiAgICAgICAgICByZXR1cm4gZWxlbWVudC5hc3NpZ25lZFNsb3Q7CiAgICAgIH0KICAgICAgaWYgKGVsZW1lbnQucGFyZW50Tm9kZSBpbnN0YW5jZW9mIFNoYWRvd1Jvb3QpIHsKICAgICAgICAgIHJldHVybiBlbGVtZW50LnBhcmVudE5vZGUuaG9zdDsKICAgICAgfQogICAgICByZXR1cm4gZWxlbWVudC5wYXJlbnROb2RlOwogIH0KICBmdW5jdGlvbiBvZmZzZXRQYXJlbnRQb2x5ZmlsbChlbGVtZW50KSB7CiAgICAgIC8vIERvIGFuIGluaXRpYWwgd2FsayB0byBjaGVjayBmb3IgZGlzcGxheTpub25lIGFuY2VzdG9ycy4KICAgICAgZm9yIChsZXQgYW5jZXN0b3IgPSBlbGVtZW50OyBhbmNlc3RvcjsgYW5jZXN0b3IgPSBmbGF0VHJlZVBhcmVudChhbmNlc3RvcikpIHsKICAgICAgICAgIGlmICghKGFuY2VzdG9yIGluc3RhbmNlb2YgRWxlbWVudCkpIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChnZXRDb21wdXRlZFN0eWxlKGFuY2VzdG9yKS5kaXNwbGF5ID09PSAnbm9uZScpIHsKICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIH0KICAgICAgfQogICAgICBmb3IgKGxldCBhbmNlc3RvciA9IGZsYXRUcmVlUGFyZW50KGVsZW1lbnQpOyBhbmNlc3RvcjsgYW5jZXN0b3IgPSBmbGF0VHJlZVBhcmVudChhbmNlc3RvcikpIHsKICAgICAgICAgIGlmICghKGFuY2VzdG9yIGluc3RhbmNlb2YgRWxlbWVudCkpIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IHN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShhbmNlc3Rvcik7CiAgICAgICAgICAvLyBEaXNwbGF5OmNvbnRlbnRzIG5vZGVzIGFyZW4ndCBpbiB0aGUgbGF5b3V0IHRyZWUgc28gdGhleSBzaG91bGQgYmUgc2tpcHBlZC4KICAgICAgICAgIGlmIChzdHlsZS5kaXNwbGF5ID09PSAnY29udGVudHMnKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoc3R5bGUucG9zaXRpb24gIT09ICdzdGF0aWMnIHx8IHN0eWxlLmZpbHRlciAhPT0gJ25vbmUnKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGFuY2VzdG9yOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGFuY2VzdG9yLnRhZ05hbWUgPT09ICdCT0RZJykgewogICAgICAgICAgICAgIHJldHVybiBhbmNlc3RvcjsKICAgICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gbnVsbDsKICB9CgogIGZ1bmN0aW9uIGlzVmlydHVhbEVsZW1lbnQoZSkgewogICAgcmV0dXJuIGUgIT09IG51bGwgJiYgdHlwZW9mIGUgPT09ICJvYmplY3QiICYmICJnZXRCb3VuZGluZ0NsaWVudFJlY3QiIGluIGU7CiAgfQogIHZhciBTbFBvcHVwID0gY2xhc3MgZXh0ZW5kcyBTaG9lbGFjZUVsZW1lbnQgewogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHN1cGVyKC4uLmFyZ3VtZW50cyk7CiAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7CiAgICAgIHRoaXMucGxhY2VtZW50ID0gInRvcCI7CiAgICAgIHRoaXMuc3RyYXRlZ3kgPSAiYWJzb2x1dGUiOwogICAgICB0aGlzLmRpc3RhbmNlID0gMDsKICAgICAgdGhpcy5za2lkZGluZyA9IDA7CiAgICAgIHRoaXMuYXJyb3cgPSBmYWxzZTsKICAgICAgdGhpcy5hcnJvd1BsYWNlbWVudCA9ICJhbmNob3IiOwogICAgICB0aGlzLmFycm93UGFkZGluZyA9IDEwOwogICAgICB0aGlzLmZsaXAgPSBmYWxzZTsKICAgICAgdGhpcy5mbGlwRmFsbGJhY2tQbGFjZW1lbnRzID0gIiI7CiAgICAgIHRoaXMuZmxpcEZhbGxiYWNrU3RyYXRlZ3kgPSAiYmVzdC1maXQiOwogICAgICB0aGlzLmZsaXBQYWRkaW5nID0gMDsKICAgICAgdGhpcy5zaGlmdCA9IGZhbHNlOwogICAgICB0aGlzLnNoaWZ0UGFkZGluZyA9IDA7CiAgICAgIHRoaXMuYXV0b1NpemVQYWRkaW5nID0gMDsKICAgIH0KICAgIGFzeW5jIGNvbm5lY3RlZENhbGxiYWNrKCkgewogICAgICBzdXBlci5jb25uZWN0ZWRDYWxsYmFjaygpOwogICAgICBhd2FpdCB0aGlzLnVwZGF0ZUNvbXBsZXRlOwogICAgICB0aGlzLnN0YXJ0KCk7CiAgICB9CiAgICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHsKICAgICAgc3VwZXIuZGlzY29ubmVjdGVkQ2FsbGJhY2soKTsKICAgICAgdGhpcy5zdG9wKCk7CiAgICB9CiAgICBhc3luYyB1cGRhdGVkKGNoYW5nZWRQcm9wcykgewogICAgICBzdXBlci51cGRhdGVkKGNoYW5nZWRQcm9wcyk7CiAgICAgIGlmIChjaGFuZ2VkUHJvcHMuaGFzKCJhY3RpdmUiKSkgewogICAgICAgIGlmICh0aGlzLmFjdGl2ZSkgewogICAgICAgICAgdGhpcy5zdGFydCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGNoYW5nZWRQcm9wcy5oYXMoImFuY2hvciIpKSB7CiAgICAgICAgdGhpcy5oYW5kbGVBbmNob3JDaGFuZ2UoKTsKICAgICAgfQogICAgICBpZiAodGhpcy5hY3RpdmUpIHsKICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZUNvbXBsZXRlOwogICAgICAgIHRoaXMucmVwb3NpdGlvbigpOwogICAgICB9CiAgICB9CiAgICBhc3luYyBoYW5kbGVBbmNob3JDaGFuZ2UoKSB7CiAgICAgIGF3YWl0IHRoaXMuc3RvcCgpOwogICAgICBpZiAodGhpcy5hbmNob3IgJiYgdHlwZW9mIHRoaXMuYW5jaG9yID09PSAic3RyaW5nIikgewogICAgICAgIGNvbnN0IHJvb3QgPSB0aGlzLmdldFJvb3ROb2RlKCk7CiAgICAgICAgdGhpcy5hbmNob3JFbCA9IHJvb3QuZ2V0RWxlbWVudEJ5SWQodGhpcy5hbmNob3IpOwogICAgICB9IGVsc2UgaWYgKHRoaXMuYW5jaG9yIGluc3RhbmNlb2YgRWxlbWVudCB8fCBpc1ZpcnR1YWxFbGVtZW50KHRoaXMuYW5jaG9yKSkgewogICAgICAgIHRoaXMuYW5jaG9yRWwgPSB0aGlzLmFuY2hvcjsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmFuY2hvckVsID0gdGhpcy5xdWVyeVNlbGVjdG9yKCdbc2xvdD0iYW5jaG9yIl0nKTsKICAgICAgfQogICAgICBpZiAodGhpcy5hbmNob3JFbCBpbnN0YW5jZW9mIEhUTUxTbG90RWxlbWVudCkgewogICAgICAgIHRoaXMuYW5jaG9yRWwgPSB0aGlzLmFuY2hvckVsLmFzc2lnbmVkRWxlbWVudHMoeyBmbGF0dGVuOiB0cnVlIH0pWzBdOwogICAgICB9CiAgICAgIGlmICh0aGlzLmFuY2hvckVsKSB7CiAgICAgICAgdGhpcy5zdGFydCgpOwogICAgICB9CiAgICB9CiAgICBzdGFydCgpIHsKICAgICAgaWYgKCF0aGlzLmFuY2hvckVsKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMuY2xlYW51cCA9IGF1dG9VcGRhdGUodGhpcy5hbmNob3JFbCwgdGhpcy5wb3B1cCwgKCkgPT4gewogICAgICAgIHRoaXMucmVwb3NpdGlvbigpOwogICAgICB9KTsKICAgIH0KICAgIGFzeW5jIHN0b3AoKSB7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gewogICAgICAgIGlmICh0aGlzLmNsZWFudXApIHsKICAgICAgICAgIHRoaXMuY2xlYW51cCgpOwogICAgICAgICAgdGhpcy5jbGVhbnVwID0gdm9pZCAwOwogICAgICAgICAgdGhpcy5yZW1vdmVBdHRyaWJ1dGUoImRhdGEtY3VycmVudC1wbGFjZW1lbnQiKTsKICAgICAgICAgIHRoaXMuc3R5bGUucmVtb3ZlUHJvcGVydHkoIi0tYXV0by1zaXplLWF2YWlsYWJsZS13aWR0aCIpOwogICAgICAgICAgdGhpcy5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgiLS1hdXRvLXNpemUtYXZhaWxhYmxlLWhlaWdodCIpOwogICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHJlc29sdmUoKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogICAgLyoqIEZvcmNlcyB0aGUgcG9wdXAgdG8gcmVjYWxjdWxhdGUgYW5kIHJlcG9zaXRpb24gaXRzZWxmLiAqLwogICAgcmVwb3NpdGlvbigpIHsKICAgICAgaWYgKCF0aGlzLmFjdGl2ZSB8fCAhdGhpcy5hbmNob3JFbCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBjb25zdCBtaWRkbGV3YXJlID0gWwogICAgICAgIC8vIFRoZSBvZmZzZXQgbWlkZGxld2FyZSBnb2VzIGZpcnN0CiAgICAgICAgb2Zmc2V0KHsgbWFpbkF4aXM6IHRoaXMuZGlzdGFuY2UsIGNyb3NzQXhpczogdGhpcy5za2lkZGluZyB9KQogICAgICBdOwogICAgICBpZiAodGhpcy5zeW5jKSB7CiAgICAgICAgbWlkZGxld2FyZS5wdXNoKAogICAgICAgICAgc2l6ZSh7CiAgICAgICAgICAgIGFwcGx5OiAoeyByZWN0cyB9KSA9PiB7CiAgICAgICAgICAgICAgY29uc3Qgc3luY1dpZHRoID0gdGhpcy5zeW5jID09PSAid2lkdGgiIHx8IHRoaXMuc3luYyA9PT0gImJvdGgiOwogICAgICAgICAgICAgIGNvbnN0IHN5bmNIZWlnaHQgPSB0aGlzLnN5bmMgPT09ICJoZWlnaHQiIHx8IHRoaXMuc3luYyA9PT0gImJvdGgiOwogICAgICAgICAgICAgIHRoaXMucG9wdXAuc3R5bGUud2lkdGggPSBzeW5jV2lkdGggPyBgJHtyZWN0cy5yZWZlcmVuY2Uud2lkdGh9cHhgIDogIiI7CiAgICAgICAgICAgICAgdGhpcy5wb3B1cC5zdHlsZS5oZWlnaHQgPSBzeW5jSGVpZ2h0ID8gYCR7cmVjdHMucmVmZXJlbmNlLmhlaWdodH1weGAgOiAiIjsKICAgICAgICAgICAgfQogICAgICAgICAgfSkKICAgICAgICApOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucG9wdXAuc3R5bGUud2lkdGggPSAiIjsKICAgICAgICB0aGlzLnBvcHVwLnN0eWxlLmhlaWdodCA9ICIiOwogICAgICB9CiAgICAgIGlmICh0aGlzLmZsaXApIHsKICAgICAgICBtaWRkbGV3YXJlLnB1c2goCiAgICAgICAgICBmbGlwKHsKICAgICAgICAgICAgYm91bmRhcnk6IHRoaXMuZmxpcEJvdW5kYXJ5LAogICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIC0gV2UncmUgY29udmVydGluZyBhIHN0cmluZyBhdHRyaWJ1dGUgdG8gYW4gYXJyYXkgaGVyZQogICAgICAgICAgICBmYWxsYmFja1BsYWNlbWVudHM6IHRoaXMuZmxpcEZhbGxiYWNrUGxhY2VtZW50cywKICAgICAgICAgICAgZmFsbGJhY2tTdHJhdGVneTogdGhpcy5mbGlwRmFsbGJhY2tTdHJhdGVneSA9PT0gImJlc3QtZml0IiA/ICJiZXN0Rml0IiA6ICJpbml0aWFsUGxhY2VtZW50IiwKICAgICAgICAgICAgcGFkZGluZzogdGhpcy5mbGlwUGFkZGluZwogICAgICAgICAgfSkKICAgICAgICApOwogICAgICB9CiAgICAgIGlmICh0aGlzLnNoaWZ0KSB7CiAgICAgICAgbWlkZGxld2FyZS5wdXNoKAogICAgICAgICAgc2hpZnQoewogICAgICAgICAgICBib3VuZGFyeTogdGhpcy5zaGlmdEJvdW5kYXJ5LAogICAgICAgICAgICBwYWRkaW5nOiB0aGlzLnNoaWZ0UGFkZGluZwogICAgICAgICAgfSkKICAgICAgICApOwogICAgICB9CiAgICAgIGlmICh0aGlzLmF1dG9TaXplKSB7CiAgICAgICAgbWlkZGxld2FyZS5wdXNoKAogICAgICAgICAgc2l6ZSh7CiAgICAgICAgICAgIGJvdW5kYXJ5OiB0aGlzLmF1dG9TaXplQm91bmRhcnksCiAgICAgICAgICAgIHBhZGRpbmc6IHRoaXMuYXV0b1NpemVQYWRkaW5nLAogICAgICAgICAgICBhcHBseTogKHsgYXZhaWxhYmxlV2lkdGgsIGF2YWlsYWJsZUhlaWdodCB9KSA9PiB7CiAgICAgICAgICAgICAgaWYgKHRoaXMuYXV0b1NpemUgPT09ICJ2ZXJ0aWNhbCIgfHwgdGhpcy5hdXRvU2l6ZSA9PT0gImJvdGgiKSB7CiAgICAgICAgICAgICAgICB0aGlzLnN0eWxlLnNldFByb3BlcnR5KCItLWF1dG8tc2l6ZS1hdmFpbGFibGUtaGVpZ2h0IiwgYCR7YXZhaWxhYmxlSGVpZ2h0fXB4YCk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuc3R5bGUucmVtb3ZlUHJvcGVydHkoIi0tYXV0by1zaXplLWF2YWlsYWJsZS1oZWlnaHQiKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKHRoaXMuYXV0b1NpemUgPT09ICJob3Jpem9udGFsIiB8fCB0aGlzLmF1dG9TaXplID09PSAiYm90aCIpIHsKICAgICAgICAgICAgICAgIHRoaXMuc3R5bGUuc2V0UHJvcGVydHkoIi0tYXV0by1zaXplLWF2YWlsYWJsZS13aWR0aCIsIGAke2F2YWlsYWJsZVdpZHRofXB4YCk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuc3R5bGUucmVtb3ZlUHJvcGVydHkoIi0tYXV0by1zaXplLWF2YWlsYWJsZS13aWR0aCIpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSkKICAgICAgICApOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc3R5bGUucmVtb3ZlUHJvcGVydHkoIi0tYXV0by1zaXplLWF2YWlsYWJsZS13aWR0aCIpOwogICAgICAgIHRoaXMuc3R5bGUucmVtb3ZlUHJvcGVydHkoIi0tYXV0by1zaXplLWF2YWlsYWJsZS1oZWlnaHQiKTsKICAgICAgfQogICAgICBpZiAodGhpcy5hcnJvdykgewogICAgICAgIG1pZGRsZXdhcmUucHVzaCgKICAgICAgICAgIGFycm93KHsKICAgICAgICAgICAgZWxlbWVudDogdGhpcy5hcnJvd0VsLAogICAgICAgICAgICBwYWRkaW5nOiB0aGlzLmFycm93UGFkZGluZwogICAgICAgICAgfSkKICAgICAgICApOwogICAgICB9CiAgICAgIGNvbnN0IGdldE9mZnNldFBhcmVudCA9IHRoaXMuc3RyYXRlZ3kgPT09ICJhYnNvbHV0ZSIgPyAoZWxlbWVudCkgPT4gcGxhdGZvcm0uZ2V0T2Zmc2V0UGFyZW50KGVsZW1lbnQsIG9mZnNldFBhcmVudCkgOiBwbGF0Zm9ybS5nZXRPZmZzZXRQYXJlbnQ7CiAgICAgIGNvbXB1dGVQb3NpdGlvbih0aGlzLmFuY2hvckVsLCB0aGlzLnBvcHVwLCB7CiAgICAgICAgcGxhY2VtZW50OiB0aGlzLnBsYWNlbWVudCwKICAgICAgICBtaWRkbGV3YXJlLAogICAgICAgIHN0cmF0ZWd5OiB0aGlzLnN0cmF0ZWd5LAogICAgICAgIHBsYXRmb3JtOiBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBwbGF0Zm9ybSksIHsKICAgICAgICAgIGdldE9mZnNldFBhcmVudAogICAgICAgIH0pCiAgICAgIH0pLnRoZW4oKHsgeCwgeSwgbWlkZGxld2FyZURhdGEsIHBsYWNlbWVudCB9KSA9PiB7CiAgICAgICAgY29uc3QgaXNSdGwgPSBnZXRDb21wdXRlZFN0eWxlKHRoaXMpLmRpcmVjdGlvbiA9PT0gInJ0bCI7CiAgICAgICAgY29uc3Qgc3RhdGljU2lkZSA9IHsgdG9wOiAiYm90dG9tIiwgcmlnaHQ6ICJsZWZ0IiwgYm90dG9tOiAidG9wIiwgbGVmdDogInJpZ2h0IiB9W3BsYWNlbWVudC5zcGxpdCgiLSIpWzBdXTsKICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZSgiZGF0YS1jdXJyZW50LXBsYWNlbWVudCIsIHBsYWNlbWVudCk7CiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLnBvcHVwLnN0eWxlLCB7CiAgICAgICAgICBsZWZ0OiBgJHt4fXB4YCwKICAgICAgICAgIHRvcDogYCR7eX1weGAKICAgICAgICB9KTsKICAgICAgICBpZiAodGhpcy5hcnJvdykgewogICAgICAgICAgY29uc3QgYXJyb3dYID0gbWlkZGxld2FyZURhdGEuYXJyb3cueDsKICAgICAgICAgIGNvbnN0IGFycm93WSA9IG1pZGRsZXdhcmVEYXRhLmFycm93Lnk7CiAgICAgICAgICBsZXQgdG9wID0gIiI7CiAgICAgICAgICBsZXQgcmlnaHQgPSAiIjsKICAgICAgICAgIGxldCBib3R0b20gPSAiIjsKICAgICAgICAgIGxldCBsZWZ0ID0gIiI7CiAgICAgICAgICBpZiAodGhpcy5hcnJvd1BsYWNlbWVudCA9PT0gInN0YXJ0IikgewogICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHR5cGVvZiBhcnJvd1ggPT09ICJudW1iZXIiID8gYGNhbGMoJHt0aGlzLmFycm93UGFkZGluZ31weCAtIHZhcigtLWFycm93LXBhZGRpbmctb2Zmc2V0KSlgIDogIiI7CiAgICAgICAgICAgIHRvcCA9IHR5cGVvZiBhcnJvd1kgPT09ICJudW1iZXIiID8gYGNhbGMoJHt0aGlzLmFycm93UGFkZGluZ31weCAtIHZhcigtLWFycm93LXBhZGRpbmctb2Zmc2V0KSlgIDogIiI7CiAgICAgICAgICAgIHJpZ2h0ID0gaXNSdGwgPyB2YWx1ZSA6ICIiOwogICAgICAgICAgICBsZWZ0ID0gaXNSdGwgPyAiIiA6IHZhbHVlOwogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFycm93UGxhY2VtZW50ID09PSAiZW5kIikgewogICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHR5cGVvZiBhcnJvd1ggPT09ICJudW1iZXIiID8gYGNhbGMoJHt0aGlzLmFycm93UGFkZGluZ31weCAtIHZhcigtLWFycm93LXBhZGRpbmctb2Zmc2V0KSlgIDogIiI7CiAgICAgICAgICAgIHJpZ2h0ID0gaXNSdGwgPyAiIiA6IHZhbHVlOwogICAgICAgICAgICBsZWZ0ID0gaXNSdGwgPyB2YWx1ZSA6ICIiOwogICAgICAgICAgICBib3R0b20gPSB0eXBlb2YgYXJyb3dZID09PSAibnVtYmVyIiA/IGBjYWxjKCR7dGhpcy5hcnJvd1BhZGRpbmd9cHggLSB2YXIoLS1hcnJvdy1wYWRkaW5nLW9mZnNldCkpYCA6ICIiOwogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFycm93UGxhY2VtZW50ID09PSAiY2VudGVyIikgewogICAgICAgICAgICBsZWZ0ID0gdHlwZW9mIGFycm93WCA9PT0gIm51bWJlciIgPyBgY2FsYyg1MCUgLSB2YXIoLS1hcnJvdy1zaXplLWRpYWdvbmFsKSlgIDogIiI7CiAgICAgICAgICAgIHRvcCA9IHR5cGVvZiBhcnJvd1kgPT09ICJudW1iZXIiID8gYGNhbGMoNTAlIC0gdmFyKC0tYXJyb3ctc2l6ZS1kaWFnb25hbCkpYCA6ICIiOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbGVmdCA9IHR5cGVvZiBhcnJvd1ggPT09ICJudW1iZXIiID8gYCR7YXJyb3dYfXB4YCA6ICIiOwogICAgICAgICAgICB0b3AgPSB0eXBlb2YgYXJyb3dZID09PSAibnVtYmVyIiA/IGAke2Fycm93WX1weGAgOiAiIjsKICAgICAgICAgIH0KICAgICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5hcnJvd0VsLnN0eWxlLCB7CiAgICAgICAgICAgIHRvcCwKICAgICAgICAgICAgcmlnaHQsCiAgICAgICAgICAgIGJvdHRvbSwKICAgICAgICAgICAgbGVmdCwKICAgICAgICAgICAgW3N0YXRpY1NpZGVdOiAiY2FsYyh2YXIoLS1hcnJvdy1zaXplLWRpYWdvbmFsKSAqIC0xKSIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHRoaXMuZW1pdCgic2wtcmVwb3NpdGlvbiIpOwogICAgfQogICAgcmVuZGVyKCkgewogICAgICByZXR1cm4geGAKICAgICAgPHNsb3QgbmFtZT0iYW5jaG9yIiBAc2xvdGNoYW5nZT0ke3RoaXMuaGFuZGxlQW5jaG9yQ2hhbmdlfT48L3Nsb3Q+CgogICAgICA8ZGl2CiAgICAgICAgcGFydD0icG9wdXAiCiAgICAgICAgY2xhc3M9JHtlJDIoewogICAgICBwb3B1cDogdHJ1ZSwKICAgICAgInBvcHVwLS1hY3RpdmUiOiB0aGlzLmFjdGl2ZSwKICAgICAgInBvcHVwLS1maXhlZCI6IHRoaXMuc3RyYXRlZ3kgPT09ICJmaXhlZCIsCiAgICAgICJwb3B1cC0taGFzLWFycm93IjogdGhpcy5hcnJvdwogICAgfSl9CiAgICAgID4KICAgICAgICA8c2xvdD48L3Nsb3Q+CiAgICAgICAgJHt0aGlzLmFycm93ID8geGA8ZGl2IHBhcnQ9ImFycm93IiBjbGFzcz0icG9wdXBfX2Fycm93IiByb2xlPSJwcmVzZW50YXRpb24iPjwvZGl2PmAgOiAiIn0KICAgICAgPC9kaXY+CiAgICBgOwogICAgfQogIH07CiAgU2xQb3B1cC5zdHlsZXMgPSBwb3B1cF9zdHlsZXNfZGVmYXVsdDsKICBfX2RlY29yYXRlQ2xhc3MoWwogICAgZSQ0KCIucG9wdXAiKQogIF0sIFNsUG9wdXAucHJvdG90eXBlLCAicG9wdXAiLCAyKTsKICBfX2RlY29yYXRlQ2xhc3MoWwogICAgZSQ0KCIucG9wdXBfX2Fycm93IikKICBdLCBTbFBvcHVwLnByb3RvdHlwZSwgImFycm93RWwiLCAyKTsKICBfX2RlY29yYXRlQ2xhc3MoWwogICAgbiQyKCkKICBdLCBTbFBvcHVwLnByb3RvdHlwZSwgImFuY2hvciIsIDIpOwogIF9fZGVjb3JhdGVDbGFzcyhbCiAgICBuJDIoeyB0eXBlOiBCb29sZWFuLCByZWZsZWN0OiB0cnVlIH0pCiAgXSwgU2xQb3B1cC5wcm90b3R5cGUsICJhY3RpdmUiLCAyKTsKICBfX2RlY29yYXRlQ2xhc3MoWwogICAgbiQyKHsgcmVmbGVjdDogdHJ1ZSB9KQogIF0sIFNsUG9wdXAucHJvdG90eXBlLCAicGxhY2VtZW50IiwgMik7CiAgX19kZWNvcmF0ZUNsYXNzKFsKICAgIG4kMih7IHJlZmxlY3Q6IHRydWUgfSkKICBdLCBTbFBvcHVwLnByb3RvdHlwZSwgInN0cmF0ZWd5IiwgMik7CiAgX19kZWNvcmF0ZUNsYXNzKFsKICAgIG4kMih7IHR5cGU6IE51bWJlciB9KQogIF0sIFNsUG9wdXAucHJvdG90eXBlLCAiZGlzdGFuY2UiLCAyKTsKICBfX2RlY29yYXRlQ2xhc3MoWwogICAgbiQyKHsgdHlwZTogTnVtYmVyIH0pCiAgXSwgU2xQb3B1cC5wcm90b3R5cGUsICJza2lkZGluZyIsIDIpOwogIF9fZGVjb3JhdGVDbGFzcyhbCiAgICBuJDIoeyB0eXBlOiBCb29sZWFuIH0pCiAgXSwgU2xQb3B1cC5wcm90b3R5cGUsICJhcnJvdyIsIDIpOwogIF9fZGVjb3JhdGVDbGFzcyhbCiAgICBuJDIoeyBhdHRyaWJ1dGU6ICJhcnJvdy1wbGFjZW1lbnQiIH0pCiAgXSwgU2xQb3B1cC5wcm90b3R5cGUsICJhcnJvd1BsYWNlbWVudCIsIDIpOwogIF9fZGVjb3JhdGVDbGFzcyhbCiAgICBuJDIoeyBhdHRyaWJ1dGU6ICJhcnJvdy1wYWRkaW5nIiwgdHlwZTogTnVtYmVyIH0pCiAgXSwgU2xQb3B1cC5wcm90b3R5cGUsICJhcnJvd1BhZGRpbmciLCAyKTsKICBfX2RlY29yYXRlQ2xhc3MoWwogICAgbiQyKHsgdHlwZTogQm9vbGVhbiB9KQogIF0sIFNsUG9wdXAucHJvdG90eXBlLCAiZmxpcCIsIDIpOwogIF9fZGVjb3JhdGVDbGFzcyhbCiAgICBuJDIoewogICAgICBhdHRyaWJ1dGU6ICJmbGlwLWZhbGxiYWNrLXBsYWNlbWVudHMiLAogICAgICBjb252ZXJ0ZXI6IHsKICAgICAgICBmcm9tQXR0cmlidXRlOiAodmFsdWUpID0+IHsKICAgICAgICAgIHJldHVybiB2YWx1ZS5zcGxpdCgiICIpLm1hcCgocCkgPT4gcC50cmltKCkpLmZpbHRlcigocCkgPT4gcCAhPT0gIiIpOwogICAgICAgIH0sCiAgICAgICAgdG9BdHRyaWJ1dGU6ICh2YWx1ZSkgPT4gewogICAgICAgICAgcmV0dXJuIHZhbHVlLmpvaW4oIiAiKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pCiAgXSwgU2xQb3B1cC5wcm90b3R5cGUsICJmbGlwRmFsbGJhY2tQbGFjZW1lbnRzIiwgMik7CiAgX19kZWNvcmF0ZUNsYXNzKFsKICAgIG4kMih7IGF0dHJpYnV0ZTogImZsaXAtZmFsbGJhY2stc3RyYXRlZ3kiIH0pCiAgXSwgU2xQb3B1cC5wcm90b3R5cGUsICJmbGlwRmFsbGJhY2tTdHJhdGVneSIsIDIpOwogIF9fZGVjb3JhdGVDbGFzcyhbCiAgICBuJDIoeyB0eXBlOiBPYmplY3QgfSkKICBdLCBTbFBvcHVwLnByb3RvdHlwZSwgImZsaXBCb3VuZGFyeSIsIDIpOwogIF9fZGVjb3JhdGVDbGFzcyhbCiAgICBuJDIoeyBhdHRyaWJ1dGU6ICJmbGlwLXBhZGRpbmciLCB0eXBlOiBOdW1iZXIgfSkKICBdLCBTbFBvcHVwLnByb3RvdHlwZSwgImZsaXBQYWRkaW5nIiwgMik7CiAgX19kZWNvcmF0ZUNsYXNzKFsKICAgIG4kMih7IHR5cGU6IEJvb2xlYW4gfSkKICBdLCBTbFBvcHVwLnByb3RvdHlwZSwgInNoaWZ0IiwgMik7CiAgX19kZWNvcmF0ZUNsYXNzKFsKICAgIG4kMih7IHR5cGU6IE9iamVjdCB9KQogIF0sIFNsUG9wdXAucHJvdG90eXBlLCAic2hpZnRCb3VuZGFyeSIsIDIpOwogIF9fZGVjb3JhdGVDbGFzcyhbCiAgICBuJDIoeyBhdHRyaWJ1dGU6ICJzaGlmdC1wYWRkaW5nIiwgdHlwZTogTnVtYmVyIH0pCiAgXSwgU2xQb3B1cC5wcm90b3R5cGUsICJzaGlmdFBhZGRpbmciLCAyKTsKICBfX2RlY29yYXRlQ2xhc3MoWwogICAgbiQyKHsgYXR0cmlidXRlOiAiYXV0by1zaXplIiB9KQogIF0sIFNsUG9wdXAucHJvdG90eXBlLCAiYXV0b1NpemUiLCAyKTsKICBfX2RlY29yYXRlQ2xhc3MoWwogICAgbiQyKCkKICBdLCBTbFBvcHVwLnByb3RvdHlwZSwgInN5bmMiLCAyKTsKICBfX2RlY29yYXRlQ2xhc3MoWwogICAgbiQyKHsgdHlwZTogT2JqZWN0IH0pCiAgXSwgU2xQb3B1cC5wcm90b3R5cGUsICJhdXRvU2l6ZUJvdW5kYXJ5IiwgMik7CiAgX19kZWNvcmF0ZUNsYXNzKFsKICAgIG4kMih7IGF0dHJpYnV0ZTogImF1dG8tc2l6ZS1wYWRkaW5nIiwgdHlwZTogTnVtYmVyIH0pCiAgXSwgU2xQb3B1cC5wcm90b3R5cGUsICJhdXRvU2l6ZVBhZGRpbmciLCAyKTsKCiAgU2xQb3B1cC5kZWZpbmUoInNsLXBvcHVwIik7CgogIHZhciBkcm9wZG93bl9zdHlsZXNfZGVmYXVsdCA9IGkkM2AKICAke2NvbXBvbmVudF9zdHlsZXNfZGVmYXVsdH0KCiAgOmhvc3QgewogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIH0KCiAgLmRyb3Bkb3duOjpwYXJ0KHBvcHVwKSB7CiAgICB6LWluZGV4OiB2YXIoLS1zbC16LWluZGV4LWRyb3Bkb3duKTsKICB9CgogIC5kcm9wZG93bltkYXRhLWN1cnJlbnQtcGxhY2VtZW50Xj0ndG9wJ106OnBhcnQocG9wdXApIHsKICAgIHRyYW5zZm9ybS1vcmlnaW46IGJvdHRvbTsKICB9CgogIC5kcm9wZG93bltkYXRhLWN1cnJlbnQtcGxhY2VtZW50Xj0nYm90dG9tJ106OnBhcnQocG9wdXApIHsKICAgIHRyYW5zZm9ybS1vcmlnaW46IHRvcDsKICB9CgogIC5kcm9wZG93bltkYXRhLWN1cnJlbnQtcGxhY2VtZW50Xj0nbGVmdCddOjpwYXJ0KHBvcHVwKSB7CiAgICB0cmFuc2Zvcm0tb3JpZ2luOiByaWdodDsKICB9CgogIC5kcm9wZG93bltkYXRhLWN1cnJlbnQtcGxhY2VtZW50Xj0ncmlnaHQnXTo6cGFydChwb3B1cCkgewogICAgdHJhbnNmb3JtLW9yaWdpbjogbGVmdDsKICB9CgogIC5kcm9wZG93bl9fdHJpZ2dlciB7CiAgICBkaXNwbGF5OiBibG9jazsKICB9CgogIC5kcm9wZG93bl9fcGFuZWwgewogICAgZm9udC1mYW1pbHk6IHZhcigtLXNsLWZvbnQtc2Fucyk7CiAgICBmb250LXNpemU6IHZhcigtLXNsLWZvbnQtc2l6ZS1tZWRpdW0pOwogICAgZm9udC13ZWlnaHQ6IHZhcigtLXNsLWZvbnQtd2VpZ2h0LW5vcm1hbCk7CiAgICBib3gtc2hhZG93OiB2YXIoLS1zbC1zaGFkb3ctbGFyZ2UpOwogICAgYm9yZGVyLXJhZGl1czogdmFyKC0tc2wtYm9yZGVyLXJhZGl1cy1tZWRpdW0pOwogICAgcG9pbnRlci1ldmVudHM6IG5vbmU7CiAgfQoKICAuZHJvcGRvd24tLW9wZW4gLmRyb3Bkb3duX19wYW5lbCB7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIHBvaW50ZXItZXZlbnRzOiBhbGw7CiAgfQoKICAvKiBXaGVuIHVzZXJzIHNsb3QgYSBtZW51LCBtYWtlIHN1cmUgaXQgY29uZm9ybXMgdG8gdGhlIHBvcHVwJ3MgYXV0by1zaXplICovCiAgOjpzbG90dGVkKHNsLW1lbnUpIHsKICAgIG1heC13aWR0aDogdmFyKC0tYXV0by1zaXplLWF2YWlsYWJsZS13aWR0aCkgIWltcG9ydGFudDsKICAgIG1heC1oZWlnaHQ6IHZhcigtLWF1dG8tc2l6ZS1hdmFpbGFibGUtaGVpZ2h0KSAhaW1wb3J0YW50OwogIH0KYDsKCiAgLy8gc3JjL2ludGVybmFsL3RhYmJhYmxlLnRzCiAgZnVuY3Rpb24gaXNUYWtpbmdVcFNwYWNlKGVsZW0pIHsKICAgIHJldHVybiBCb29sZWFuKGVsZW0ub2Zmc2V0UGFyZW50IHx8IGVsZW0ub2Zmc2V0V2lkdGggfHwgZWxlbS5vZmZzZXRIZWlnaHQgfHwgZWxlbS5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCk7CiAgfQogIGZ1bmN0aW9uIGlzVGFiYmFibGUoZWwpIHsKICAgIGNvbnN0IHRhZyA9IGVsLnRhZ05hbWUudG9Mb3dlckNhc2UoKTsKICAgIGlmIChlbC5nZXRBdHRyaWJ1dGUoInRhYmluZGV4IikgPT09ICItMSIpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgaWYgKGVsLmhhc0F0dHJpYnV0ZSgiZGlzYWJsZWQiKSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBpZiAodGFnID09PSAiaW5wdXQiICYmIGVsLmdldEF0dHJpYnV0ZSgidHlwZSIpID09PSAicmFkaW8iICYmICFlbC5oYXNBdHRyaWJ1dGUoImNoZWNrZWQiKSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBpZiAoIWlzVGFraW5nVXBTcGFjZShlbCkpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgaWYgKHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsKS52aXNpYmlsaXR5ID09PSAiaGlkZGVuIikgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBpZiAoKHRhZyA9PT0gImF1ZGlvIiB8fCB0YWcgPT09ICJ2aWRlbyIpICYmIGVsLmhhc0F0dHJpYnV0ZSgiY29udHJvbHMiKSkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIGlmIChlbC5oYXNBdHRyaWJ1dGUoInRhYmluZGV4IikpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICBpZiAoZWwuaGFzQXR0cmlidXRlKCJjb250ZW50ZWRpdGFibGUiKSAmJiBlbC5nZXRBdHRyaWJ1dGUoImNvbnRlbnRlZGl0YWJsZSIpICE9PSAiZmFsc2UiKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgcmV0dXJuIFsiYnV0dG9uIiwgImlucHV0IiwgInNlbGVjdCIsICJ0ZXh0YXJlYSIsICJhIiwgImF1ZGlvIiwgInZpZGVvIiwgInN1bW1hcnkiXS5pbmNsdWRlcyh0YWcpOwogIH0KICBmdW5jdGlvbiBnZXRUYWJiYWJsZUJvdW5kYXJ5KHJvb3QpIHsKICAgIHZhciBfYSwgX2I7CiAgICBjb25zdCB0YWJiYWJsZUVsZW1lbnRzID0gZ2V0VGFiYmFibGVFbGVtZW50cyhyb290KTsKICAgIGNvbnN0IHN0YXJ0ID0gKF9hID0gdGFiYmFibGVFbGVtZW50c1swXSkgIT0gbnVsbCA/IF9hIDogbnVsbDsKICAgIGNvbnN0IGVuZCA9IChfYiA9IHRhYmJhYmxlRWxlbWVudHNbdGFiYmFibGVFbGVtZW50cy5sZW5ndGggLSAxXSkgIT0gbnVsbCA/IF9iIDogbnVsbDsKICAgIHJldHVybiB7IHN0YXJ0LCBlbmQgfTsKICB9CiAgZnVuY3Rpb24gZ2V0VGFiYmFibGVFbGVtZW50cyhyb290KSB7CiAgICBjb25zdCB0YWJiYWJsZUVsZW1lbnRzID0gW107CiAgICBmdW5jdGlvbiB3YWxrKGVsKSB7CiAgICAgIGlmIChlbCBpbnN0YW5jZW9mIEVsZW1lbnQpIHsKICAgICAgICBpZiAoZWwuaGFzQXR0cmlidXRlKCJpbmVydCIpKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmICghdGFiYmFibGVFbGVtZW50cy5pbmNsdWRlcyhlbCkgJiYgaXNUYWJiYWJsZShlbCkpIHsKICAgICAgICAgIHRhYmJhYmxlRWxlbWVudHMucHVzaChlbCk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IHNsb3RDaGlsZHJlbk91dHNpZGVSb290RWxlbWVudCA9IChzbG90RWxlbWVudCkgPT4gewogICAgICAgICAgdmFyIF9hOwogICAgICAgICAgcmV0dXJuICgoX2EgPSBzbG90RWxlbWVudC5nZXRSb290Tm9kZSh7IGNvbXBvc2VkOiB0cnVlIH0pKSA9PSBudWxsID8gdm9pZCAwIDogX2EuaG9zdCkgIT09IHJvb3Q7CiAgICAgICAgfTsKICAgICAgICBpZiAoZWwgaW5zdGFuY2VvZiBIVE1MU2xvdEVsZW1lbnQgJiYgc2xvdENoaWxkcmVuT3V0c2lkZVJvb3RFbGVtZW50KGVsKSkgewogICAgICAgICAgZWwuYXNzaWduZWRFbGVtZW50cyh7IGZsYXR0ZW46IHRydWUgfSkuZm9yRWFjaCgoYXNzaWduZWRFbCkgPT4gewogICAgICAgICAgICB3YWxrKGFzc2lnbmVkRWwpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIGlmIChlbC5zaGFkb3dSb290ICE9PSBudWxsICYmIGVsLnNoYWRvd1Jvb3QubW9kZSA9PT0gIm9wZW4iKSB7CiAgICAgICAgICB3YWxrKGVsLnNoYWRvd1Jvb3QpOwogICAgICAgIH0KICAgICAgfQogICAgICBbLi4uZWwuY2hpbGRyZW5dLmZvckVhY2goKGUpID0+IHdhbGsoZSkpOwogICAgfQogICAgd2Fsayhyb290KTsKICAgIHJldHVybiB0YWJiYWJsZUVsZW1lbnRzLnNvcnQoKGEsIGIpID0+IHsKICAgICAgY29uc3QgYVRhYmluZGV4ID0gTnVtYmVyKGEuZ2V0QXR0cmlidXRlKCJ0YWJpbmRleCIpKSB8fCAwOwogICAgICBjb25zdCBiVGFiaW5kZXggPSBOdW1iZXIoYi5nZXRBdHRyaWJ1dGUoInRhYmluZGV4IikpIHx8IDA7CiAgICAgIHJldHVybiBiVGFiaW5kZXggLSBhVGFiaW5kZXg7CiAgICB9KTsKICB9CgogIC8vIHNyYy91dGlsaXRpZXMvYW5pbWF0aW9uLXJlZ2lzdHJ5LnRzCiAgdmFyIGRlZmF1bHRBbmltYXRpb25SZWdpc3RyeSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgdmFyIGN1c3RvbUFuaW1hdGlvblJlZ2lzdHJ5ID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7CiAgZnVuY3Rpb24gZW5zdXJlQW5pbWF0aW9uKGFuaW1hdGlvbikgewogICAgcmV0dXJuIGFuaW1hdGlvbiAhPSBudWxsID8gYW5pbWF0aW9uIDogeyBrZXlmcmFtZXM6IFtdLCBvcHRpb25zOiB7IGR1cmF0aW9uOiAwIH0gfTsKICB9CiAgZnVuY3Rpb24gZ2V0TG9naWNhbEFuaW1hdGlvbihhbmltYXRpb24sIGRpcikgewogICAgaWYgKGRpci50b0xvd2VyQ2FzZSgpID09PSAicnRsIikgewogICAgICByZXR1cm4gewogICAgICAgIGtleWZyYW1lczogYW5pbWF0aW9uLnJ0bEtleWZyYW1lcyB8fCBhbmltYXRpb24ua2V5ZnJhbWVzLAogICAgICAgIG9wdGlvbnM6IGFuaW1hdGlvbi5vcHRpb25zCiAgICAgIH07CiAgICB9CiAgICByZXR1cm4gYW5pbWF0aW9uOwogIH0KICBmdW5jdGlvbiBzZXREZWZhdWx0QW5pbWF0aW9uKGFuaW1hdGlvbk5hbWUsIGFuaW1hdGlvbikgewogICAgZGVmYXVsdEFuaW1hdGlvblJlZ2lzdHJ5LnNldChhbmltYXRpb25OYW1lLCBlbnN1cmVBbmltYXRpb24oYW5pbWF0aW9uKSk7CiAgfQogIGZ1bmN0aW9uIGdldEFuaW1hdGlvbihlbCwgYW5pbWF0aW9uTmFtZSwgb3B0aW9ucykgewogICAgY29uc3QgY3VzdG9tQW5pbWF0aW9uID0gY3VzdG9tQW5pbWF0aW9uUmVnaXN0cnkuZ2V0KGVsKTsKICAgIGlmIChjdXN0b21BbmltYXRpb24gPT0gbnVsbCA/IHZvaWQgMCA6IGN1c3RvbUFuaW1hdGlvblthbmltYXRpb25OYW1lXSkgewogICAgICByZXR1cm4gZ2V0TG9naWNhbEFuaW1hdGlvbihjdXN0b21BbmltYXRpb25bYW5pbWF0aW9uTmFtZV0sIG9wdGlvbnMuZGlyKTsKICAgIH0KICAgIGNvbnN0IGRlZmF1bHRBbmltYXRpb24gPSBkZWZhdWx0QW5pbWF0aW9uUmVnaXN0cnkuZ2V0KGFuaW1hdGlvbk5hbWUpOwogICAgaWYgKGRlZmF1bHRBbmltYXRpb24pIHsKICAgICAgcmV0dXJuIGdldExvZ2ljYWxBbmltYXRpb24oZGVmYXVsdEFuaW1hdGlvbiwgb3B0aW9ucy5kaXIpOwogICAgfQogICAgcmV0dXJuIHsKICAgICAga2V5ZnJhbWVzOiBbXSwKICAgICAgb3B0aW9uczogeyBkdXJhdGlvbjogMCB9CiAgICB9OwogIH0KCiAgLy8gc3JjL2ludGVybmFsL2V2ZW50LnRzCiAgZnVuY3Rpb24gd2FpdEZvckV2ZW50KGVsLCBldmVudE5hbWUpIHsKICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gewogICAgICBmdW5jdGlvbiBkb25lKGV2ZW50KSB7CiAgICAgICAgaWYgKGV2ZW50LnRhcmdldCA9PT0gZWwpIHsKICAgICAgICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBkb25lKTsKICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGRvbmUpOwogICAgfSk7CiAgfQoKICAvLyBzcmMvaW50ZXJuYWwvYW5pbWF0ZS50cwogIGZ1bmN0aW9uIGFuaW1hdGVUbyhlbCwga2V5ZnJhbWVzLCBvcHRpb25zKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsKICAgICAgaWYgKChvcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBvcHRpb25zLmR1cmF0aW9uKSA9PT0gSW5maW5pdHkpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlByb21pc2UtYmFzZWQgYW5pbWF0aW9ucyBtdXN0IGJlIGZpbml0ZS4iKTsKICAgICAgfQogICAgICBjb25zdCBhbmltYXRpb24gPSBlbC5hbmltYXRlKGtleWZyYW1lcywgX19zcHJlYWRQcm9wcyhfX3NwcmVhZFZhbHVlcyh7fSwgb3B0aW9ucyksIHsKICAgICAgICBkdXJhdGlvbjogcHJlZmVyc1JlZHVjZWRNb3Rpb24oKSA/IDAgOiBvcHRpb25zLmR1cmF0aW9uCiAgICAgIH0pKTsKICAgICAgYW5pbWF0aW9uLmFkZEV2ZW50TGlzdGVuZXIoImNhbmNlbCIsIHJlc29sdmUsIHsgb25jZTogdHJ1ZSB9KTsKICAgICAgYW5pbWF0aW9uLmFkZEV2ZW50TGlzdGVuZXIoImZpbmlzaCIsIHJlc29sdmUsIHsgb25jZTogdHJ1ZSB9KTsKICAgIH0pOwogIH0KICBmdW5jdGlvbiBwcmVmZXJzUmVkdWNlZE1vdGlvbigpIHsKICAgIGNvbnN0IHF1ZXJ5ID0gd2luZG93Lm1hdGNoTWVkaWEoIihwcmVmZXJzLXJlZHVjZWQtbW90aW9uOiByZWR1Y2UpIik7CiAgICByZXR1cm4gcXVlcnkubWF0Y2hlczsKICB9CiAgZnVuY3Rpb24gc3RvcEFuaW1hdGlvbnMoZWwpIHsKICAgIHJldHVybiBQcm9taXNlLmFsbCgKICAgICAgZWwuZ2V0QW5pbWF0aW9ucygpLm1hcCgoYW5pbWF0aW9uKSA9PiB7CiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICAgICAgICBjb25zdCBoYW5kbGVBbmltYXRpb25FdmVudCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShyZXNvbHZlKTsKICAgICAgICAgIGFuaW1hdGlvbi5hZGRFdmVudExpc3RlbmVyKCJjYW5jZWwiLCAoKSA9PiBoYW5kbGVBbmltYXRpb25FdmVudCwgeyBvbmNlOiB0cnVlIH0pOwogICAgICAgICAgYW5pbWF0aW9uLmFkZEV2ZW50TGlzdGVuZXIoImZpbmlzaCIsICgpID0+IGhhbmRsZUFuaW1hdGlvbkV2ZW50LCB7IG9uY2U6IHRydWUgfSk7CiAgICAgICAgICBhbmltYXRpb24uY2FuY2VsKCk7CiAgICAgICAgfSk7CiAgICAgIH0pCiAgICApOwogIH0KCiAgY29uc3QgY29ubmVjdGVkRWxlbWVudHMgPSBuZXcgU2V0KCk7CiAgY29uc3QgZG9jdW1lbnRFbGVtZW50T2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcih1cGRhdGUpOwogIGNvbnN0IHRyYW5zbGF0aW9ucyA9IG5ldyBNYXAoKTsKICBsZXQgZG9jdW1lbnREaXJlY3Rpb24gPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuZGlyIHx8ICdsdHInOwogIGxldCBkb2N1bWVudExhbmd1YWdlID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmxhbmcgfHwgbmF2aWdhdG9yLmxhbmd1YWdlOwogIGxldCBmYWxsYmFjazsKICBkb2N1bWVudEVsZW1lbnRPYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwgewogICAgICBhdHRyaWJ1dGVzOiB0cnVlLAogICAgICBhdHRyaWJ1dGVGaWx0ZXI6IFsnZGlyJywgJ2xhbmcnXQogIH0pOwogIGZ1bmN0aW9uIHJlZ2lzdGVyVHJhbnNsYXRpb24oLi4udHJhbnNsYXRpb24pIHsKICAgICAgdHJhbnNsYXRpb24ubWFwKHQgPT4gewogICAgICAgICAgY29uc3QgY29kZSA9IHQuJGNvZGUudG9Mb3dlckNhc2UoKTsKICAgICAgICAgIGlmICh0cmFuc2xhdGlvbnMuaGFzKGNvZGUpKSB7CiAgICAgICAgICAgICAgdHJhbnNsYXRpb25zLnNldChjb2RlLCBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIHRyYW5zbGF0aW9ucy5nZXQoY29kZSkpLCB0KSk7CiAgICAgICAgICB9CiAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICB0cmFuc2xhdGlvbnMuc2V0KGNvZGUsIHQpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKCFmYWxsYmFjaykgewogICAgICAgICAgICAgIGZhbGxiYWNrID0gdDsKICAgICAgICAgIH0KICAgICAgfSk7CiAgICAgIHVwZGF0ZSgpOwogIH0KICBmdW5jdGlvbiB1cGRhdGUoKSB7CiAgICAgIGRvY3VtZW50RGlyZWN0aW9uID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmRpciB8fCAnbHRyJzsKICAgICAgZG9jdW1lbnRMYW5ndWFnZSA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5sYW5nIHx8IG5hdmlnYXRvci5sYW5ndWFnZTsKICAgICAgWy4uLmNvbm5lY3RlZEVsZW1lbnRzLmtleXMoKV0ubWFwKChlbCkgPT4gewogICAgICAgICAgaWYgKHR5cGVvZiBlbC5yZXF1ZXN0VXBkYXRlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgZWwucmVxdWVzdFVwZGF0ZSgpOwogICAgICAgICAgfQogICAgICB9KTsKICB9CiAgbGV0IExvY2FsaXplQ29udHJvbGxlciQxID0gY2xhc3MgTG9jYWxpemVDb250cm9sbGVyIHsKICAgICAgY29uc3RydWN0b3IoaG9zdCkgewogICAgICAgICAgdGhpcy5ob3N0ID0gaG9zdDsKICAgICAgICAgIHRoaXMuaG9zdC5hZGRDb250cm9sbGVyKHRoaXMpOwogICAgICB9CiAgICAgIGhvc3RDb25uZWN0ZWQoKSB7CiAgICAgICAgICBjb25uZWN0ZWRFbGVtZW50cy5hZGQodGhpcy5ob3N0KTsKICAgICAgfQogICAgICBob3N0RGlzY29ubmVjdGVkKCkgewogICAgICAgICAgY29ubmVjdGVkRWxlbWVudHMuZGVsZXRlKHRoaXMuaG9zdCk7CiAgICAgIH0KICAgICAgZGlyKCkgewogICAgICAgICAgcmV0dXJuIGAke3RoaXMuaG9zdC5kaXIgfHwgZG9jdW1lbnREaXJlY3Rpb259YC50b0xvd2VyQ2FzZSgpOwogICAgICB9CiAgICAgIGxhbmcoKSB7CiAgICAgICAgICByZXR1cm4gYCR7dGhpcy5ob3N0LmxhbmcgfHwgZG9jdW1lbnRMYW5ndWFnZX1gLnRvTG93ZXJDYXNlKCk7CiAgICAgIH0KICAgICAgZ2V0VHJhbnNsYXRpb25EYXRhKGxhbmcpIHsKICAgICAgICAgIHZhciBfYSwgX2I7CiAgICAgICAgICBjb25zdCBsb2NhbGUgPSBuZXcgSW50bC5Mb2NhbGUobGFuZy5yZXBsYWNlKC9fL2csICctJykpOwogICAgICAgICAgY29uc3QgbGFuZ3VhZ2UgPSBsb2NhbGUgPT09IG51bGwgfHwgbG9jYWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBsb2NhbGUubGFuZ3VhZ2UudG9Mb3dlckNhc2UoKTsKICAgICAgICAgIGNvbnN0IHJlZ2lvbiA9IChfYiA9IChfYSA9IGxvY2FsZSA9PT0gbnVsbCB8fCBsb2NhbGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGxvY2FsZS5yZWdpb24pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS50b0xvd2VyQ2FzZSgpKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiAnJzsKICAgICAgICAgIGNvbnN0IHByaW1hcnkgPSB0cmFuc2xhdGlvbnMuZ2V0KGAke2xhbmd1YWdlfS0ke3JlZ2lvbn1gKTsKICAgICAgICAgIGNvbnN0IHNlY29uZGFyeSA9IHRyYW5zbGF0aW9ucy5nZXQobGFuZ3VhZ2UpOwogICAgICAgICAgcmV0dXJuIHsgbG9jYWxlLCBsYW5ndWFnZSwgcmVnaW9uLCBwcmltYXJ5LCBzZWNvbmRhcnkgfTsKICAgICAgfQogICAgICBleGlzdHMoa2V5LCBvcHRpb25zKSB7CiAgICAgICAgICB2YXIgX2E7CiAgICAgICAgICBjb25zdCB7IHByaW1hcnksIHNlY29uZGFyeSB9ID0gdGhpcy5nZXRUcmFuc2xhdGlvbkRhdGEoKF9hID0gb3B0aW9ucy5sYW5nKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiB0aGlzLmxhbmcoKSk7CiAgICAgICAgICBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGluY2x1ZGVGYWxsYmFjazogZmFsc2UgfSwgb3B0aW9ucyk7CiAgICAgICAgICBpZiAoKHByaW1hcnkgJiYgcHJpbWFyeVtrZXldKSB8fAogICAgICAgICAgICAgIChzZWNvbmRhcnkgJiYgc2Vjb25kYXJ5W2tleV0pIHx8CiAgICAgICAgICAgICAgKG9wdGlvbnMuaW5jbHVkZUZhbGxiYWNrICYmIGZhbGxiYWNrICYmIGZhbGxiYWNrW2tleV0pKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgdGVybShrZXksIC4uLmFyZ3MpIHsKICAgICAgICAgIGNvbnN0IHsgcHJpbWFyeSwgc2Vjb25kYXJ5IH0gPSB0aGlzLmdldFRyYW5zbGF0aW9uRGF0YSh0aGlzLmxhbmcoKSk7CiAgICAgICAgICBsZXQgdGVybTsKICAgICAgICAgIGlmIChwcmltYXJ5ICYmIHByaW1hcnlba2V5XSkgewogICAgICAgICAgICAgIHRlcm0gPSBwcmltYXJ5W2tleV07CiAgICAgICAgICB9CiAgICAgICAgICBlbHNlIGlmIChzZWNvbmRhcnkgJiYgc2Vjb25kYXJ5W2tleV0pIHsKICAgICAgICAgICAgICB0ZXJtID0gc2Vjb25kYXJ5W2tleV07CiAgICAgICAgICB9CiAgICAgICAgICBlbHNlIGlmIChmYWxsYmFjayAmJiBmYWxsYmFja1trZXldKSB7CiAgICAgICAgICAgICAgdGVybSA9IGZhbGxiYWNrW2tleV07CiAgICAgICAgICB9CiAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBObyB0cmFuc2xhdGlvbiBmb3VuZCBmb3I6ICR7U3RyaW5nKGtleSl9YCk7CiAgICAgICAgICAgICAgcmV0dXJuIFN0cmluZyhrZXkpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHR5cGVvZiB0ZXJtID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRlcm0oLi4uYXJncyk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gdGVybTsKICAgICAgfQogICAgICBkYXRlKGRhdGVUb0Zvcm1hdCwgb3B0aW9ucykgewogICAgICAgICAgZGF0ZVRvRm9ybWF0ID0gbmV3IERhdGUoZGF0ZVRvRm9ybWF0KTsKICAgICAgICAgIHJldHVybiBuZXcgSW50bC5EYXRlVGltZUZvcm1hdCh0aGlzLmxhbmcoKSwgb3B0aW9ucykuZm9ybWF0KGRhdGVUb0Zvcm1hdCk7CiAgICAgIH0KICAgICAgbnVtYmVyKG51bWJlclRvRm9ybWF0LCBvcHRpb25zKSB7CiAgICAgICAgICBudW1iZXJUb0Zvcm1hdCA9IE51bWJlcihudW1iZXJUb0Zvcm1hdCk7CiAgICAgICAgICByZXR1cm4gaXNOYU4obnVtYmVyVG9Gb3JtYXQpID8gJycgOiBuZXcgSW50bC5OdW1iZXJGb3JtYXQodGhpcy5sYW5nKCksIG9wdGlvbnMpLmZvcm1hdChudW1iZXJUb0Zvcm1hdCk7CiAgICAgIH0KICAgICAgcmVsYXRpdmVUaW1lKHZhbHVlLCB1bml0LCBvcHRpb25zKSB7CiAgICAgICAgICByZXR1cm4gbmV3IEludGwuUmVsYXRpdmVUaW1lRm9ybWF0KHRoaXMubGFuZygpLCBvcHRpb25zKS5mb3JtYXQodmFsdWUsIHVuaXQpOwogICAgICB9CiAgfTsKCiAgLy8gc3JjL3RyYW5zbGF0aW9ucy9lbi50cwogIHZhciB0cmFuc2xhdGlvbiA9IHsKICAgICRjb2RlOiAiZW4iLAogICAgJG5hbWU6ICJFbmdsaXNoIiwKICAgICRkaXI6ICJsdHIiLAogICAgY2Fyb3VzZWw6ICJDYXJvdXNlbCIsCiAgICBjbGVhckVudHJ5OiAiQ2xlYXIgZW50cnkiLAogICAgY2xvc2U6ICJDbG9zZSIsCiAgICBjb3BpZWQ6ICJDb3BpZWQiLAogICAgY29weTogIkNvcHkiLAogICAgY3VycmVudFZhbHVlOiAiQ3VycmVudCB2YWx1ZSIsCiAgICBlcnJvcjogIkVycm9yIiwKICAgIGdvVG9TbGlkZTogKHNsaWRlLCBjb3VudCkgPT4gYEdvIHRvIHNsaWRlICR7c2xpZGV9IG9mICR7Y291bnR9YCwKICAgIGhpZGVQYXNzd29yZDogIkhpZGUgcGFzc3dvcmQiLAogICAgbG9hZGluZzogIkxvYWRpbmciLAogICAgbmV4dFNsaWRlOiAiTmV4dCBzbGlkZSIsCiAgICBudW1PcHRpb25zU2VsZWN0ZWQ6IChudW0pID0+IHsKICAgICAgaWYgKG51bSA9PT0gMCkKICAgICAgICByZXR1cm4gIk5vIG9wdGlvbnMgc2VsZWN0ZWQiOwogICAgICBpZiAobnVtID09PSAxKQogICAgICAgIHJldHVybiAiMSBvcHRpb24gc2VsZWN0ZWQiOwogICAgICByZXR1cm4gYCR7bnVtfSBvcHRpb25zIHNlbGVjdGVkYDsKICAgIH0sCiAgICBwcmV2aW91c1NsaWRlOiAiUHJldmlvdXMgc2xpZGUiLAogICAgcHJvZ3Jlc3M6ICJQcm9ncmVzcyIsCiAgICByZW1vdmU6ICJSZW1vdmUiLAogICAgcmVzaXplOiAiUmVzaXplIiwKICAgIHNjcm9sbFRvRW5kOiAiU2Nyb2xsIHRvIGVuZCIsCiAgICBzY3JvbGxUb1N0YXJ0OiAiU2Nyb2xsIHRvIHN0YXJ0IiwKICAgIHNlbGVjdEFDb2xvckZyb21UaGVTY3JlZW46ICJTZWxlY3QgYSBjb2xvciBmcm9tIHRoZSBzY3JlZW4iLAogICAgc2hvd1Bhc3N3b3JkOiAiU2hvdyBwYXNzd29yZCIsCiAgICBzbGlkZU51bTogKHNsaWRlKSA9PiBgU2xpZGUgJHtzbGlkZX1gLAogICAgdG9nZ2xlQ29sb3JGb3JtYXQ6ICJUb2dnbGUgY29sb3IgZm9ybWF0IgogIH07CiAgcmVnaXN0ZXJUcmFuc2xhdGlvbih0cmFuc2xhdGlvbik7CiAgdmFyIGVuX2RlZmF1bHQgPSB0cmFuc2xhdGlvbjsKCiAgdmFyIExvY2FsaXplQ29udHJvbGxlciA9IGNsYXNzIGV4dGVuZHMgTG9jYWxpemVDb250cm9sbGVyJDEgewogIH07CiAgcmVnaXN0ZXJUcmFuc2xhdGlvbihlbl9kZWZhdWx0KTsKCiAgLy8gc3JjL2ludGVybmFsL3dhdGNoLnRzCiAgZnVuY3Rpb24gd2F0Y2gocHJvcGVydHlOYW1lLCBvcHRpb25zKSB7CiAgICBjb25zdCByZXNvbHZlZE9wdGlvbnMgPSBfX3NwcmVhZFZhbHVlcyh7CiAgICAgIHdhaXRVbnRpbEZpcnN0VXBkYXRlOiBmYWxzZQogICAgfSwgb3B0aW9ucyk7CiAgICByZXR1cm4gKHByb3RvLCBkZWNvcmF0ZWRGbk5hbWUpID0+IHsKICAgICAgY29uc3QgeyB1cGRhdGUgfSA9IHByb3RvOwogICAgICBjb25zdCB3YXRjaGVkUHJvcGVydGllcyA9IEFycmF5LmlzQXJyYXkocHJvcGVydHlOYW1lKSA/IHByb3BlcnR5TmFtZSA6IFtwcm9wZXJ0eU5hbWVdOwogICAgICBwcm90by51cGRhdGUgPSBmdW5jdGlvbihjaGFuZ2VkUHJvcHMpIHsKICAgICAgICB3YXRjaGVkUHJvcGVydGllcy5mb3JFYWNoKChwcm9wZXJ0eSkgPT4gewogICAgICAgICAgY29uc3Qga2V5ID0gcHJvcGVydHk7CiAgICAgICAgICBpZiAoY2hhbmdlZFByb3BzLmhhcyhrZXkpKSB7CiAgICAgICAgICAgIGNvbnN0IG9sZFZhbHVlID0gY2hhbmdlZFByb3BzLmdldChrZXkpOwogICAgICAgICAgICBjb25zdCBuZXdWYWx1ZSA9IHRoaXNba2V5XTsKICAgICAgICAgICAgaWYgKG9sZFZhbHVlICE9PSBuZXdWYWx1ZSkgewogICAgICAgICAgICAgIGlmICghcmVzb2x2ZWRPcHRpb25zLndhaXRVbnRpbEZpcnN0VXBkYXRlIHx8IHRoaXMuaGFzVXBkYXRlZCkgewogICAgICAgICAgICAgICAgdGhpc1tkZWNvcmF0ZWRGbk5hbWVdKG9sZFZhbHVlLCBuZXdWYWx1ZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgdXBkYXRlLmNhbGwodGhpcywgY2hhbmdlZFByb3BzKTsKICAgICAgfTsKICAgIH07CiAgfQoKICB2YXIgU2xEcm9wZG93biA9IGNsYXNzIGV4dGVuZHMgU2hvZWxhY2VFbGVtZW50IHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlciguLi5hcmd1bWVudHMpOwogICAgICB0aGlzLmxvY2FsaXplID0gbmV3IExvY2FsaXplQ29udHJvbGxlcih0aGlzKTsKICAgICAgdGhpcy5vcGVuID0gZmFsc2U7CiAgICAgIHRoaXMucGxhY2VtZW50ID0gImJvdHRvbS1zdGFydCI7CiAgICAgIHRoaXMuZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgdGhpcy5zdGF5T3Blbk9uU2VsZWN0ID0gZmFsc2U7CiAgICAgIHRoaXMuZGlzdGFuY2UgPSAwOwogICAgICB0aGlzLnNraWRkaW5nID0gMDsKICAgICAgdGhpcy5ob2lzdCA9IGZhbHNlOwogICAgICB0aGlzLmhhbmRsZUtleURvd24gPSAoZXZlbnQpID0+IHsKICAgICAgICBpZiAodGhpcy5vcGVuICYmIGV2ZW50LmtleSA9PT0gIkVzY2FwZSIpIHsKICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgdGhpcy5oaWRlKCk7CiAgICAgICAgICB0aGlzLmZvY3VzT25UcmlnZ2VyKCk7CiAgICAgICAgfQogICAgICB9OwogICAgICB0aGlzLmhhbmRsZURvY3VtZW50S2V5RG93biA9IChldmVudCkgPT4gewogICAgICAgIHZhciBfYTsKICAgICAgICBpZiAoZXZlbnQua2V5ID09PSAiRXNjYXBlIiAmJiB0aGlzLm9wZW4pIHsKICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgdGhpcy5mb2N1c09uVHJpZ2dlcigpOwogICAgICAgICAgdGhpcy5oaWRlKCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmIChldmVudC5rZXkgPT09ICJUYWIiKSB7CiAgICAgICAgICBpZiAodGhpcy5vcGVuICYmICgoX2EgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2EudGFnTmFtZS50b0xvd2VyQ2FzZSgpKSA9PT0gInNsLW1lbnUtaXRlbSIpIHsKICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgdGhpcy5oaWRlKCk7CiAgICAgICAgICAgIHRoaXMuZm9jdXNPblRyaWdnZXIoKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgIHZhciBfYTIsIF9iLCBfYzsKICAgICAgICAgICAgY29uc3QgYWN0aXZlRWxlbWVudCA9ICgoX2EyID0gdGhpcy5jb250YWluaW5nRWxlbWVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMi5nZXRSb290Tm9kZSgpKSBpbnN0YW5jZW9mIFNoYWRvd1Jvb3QgPyAoX2MgPSAoX2IgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2Iuc2hhZG93Um9vdCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9jLmFjdGl2ZUVsZW1lbnQgOiBkb2N1bWVudC5hY3RpdmVFbGVtZW50OwogICAgICAgICAgICBpZiAoIXRoaXMuY29udGFpbmluZ0VsZW1lbnQgfHwgKGFjdGl2ZUVsZW1lbnQgPT0gbnVsbCA/IHZvaWQgMCA6IGFjdGl2ZUVsZW1lbnQuY2xvc2VzdCh0aGlzLmNvbnRhaW5pbmdFbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKSkpICE9PSB0aGlzLmNvbnRhaW5pbmdFbGVtZW50KSB7CiAgICAgICAgICAgICAgdGhpcy5oaWRlKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgdGhpcy5oYW5kbGVEb2N1bWVudE1vdXNlRG93biA9IChldmVudCkgPT4gewogICAgICAgIGNvbnN0IHBhdGggPSBldmVudC5jb21wb3NlZFBhdGgoKTsKICAgICAgICBpZiAodGhpcy5jb250YWluaW5nRWxlbWVudCAmJiAhcGF0aC5pbmNsdWRlcyh0aGlzLmNvbnRhaW5pbmdFbGVtZW50KSkgewogICAgICAgICAgdGhpcy5oaWRlKCk7CiAgICAgICAgfQogICAgICB9OwogICAgICB0aGlzLmhhbmRsZVBhbmVsU2VsZWN0ID0gKGV2ZW50KSA9PiB7CiAgICAgICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0OwogICAgICAgIGlmICghdGhpcy5zdGF5T3Blbk9uU2VsZWN0ICYmIHRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICJzbC1tZW51IikgewogICAgICAgICAgdGhpcy5oaWRlKCk7CiAgICAgICAgICB0aGlzLmZvY3VzT25UcmlnZ2VyKCk7CiAgICAgICAgfQogICAgICB9OwogICAgfQogICAgY29ubmVjdGVkQ2FsbGJhY2soKSB7CiAgICAgIHN1cGVyLmNvbm5lY3RlZENhbGxiYWNrKCk7CiAgICAgIGlmICghdGhpcy5jb250YWluaW5nRWxlbWVudCkgewogICAgICAgIHRoaXMuY29udGFpbmluZ0VsZW1lbnQgPSB0aGlzOwogICAgICB9CiAgICB9CiAgICBmaXJzdFVwZGF0ZWQoKSB7CiAgICAgIHRoaXMucGFuZWwuaGlkZGVuID0gIXRoaXMub3BlbjsKICAgICAgaWYgKHRoaXMub3BlbikgewogICAgICAgIHRoaXMuYWRkT3Blbkxpc3RlbmVycygpOwogICAgICAgIHRoaXMucG9wdXAuYWN0aXZlID0gdHJ1ZTsKICAgICAgfQogICAgfQogICAgZGlzY29ubmVjdGVkQ2FsbGJhY2soKSB7CiAgICAgIHN1cGVyLmRpc2Nvbm5lY3RlZENhbGxiYWNrKCk7CiAgICAgIHRoaXMucmVtb3ZlT3Blbkxpc3RlbmVycygpOwogICAgICB0aGlzLmhpZGUoKTsKICAgIH0KICAgIGZvY3VzT25UcmlnZ2VyKCkgewogICAgICBjb25zdCB0cmlnZ2VyID0gdGhpcy50cmlnZ2VyLmFzc2lnbmVkRWxlbWVudHMoeyBmbGF0dGVuOiB0cnVlIH0pWzBdOwogICAgICBpZiAodHlwZW9mICh0cmlnZ2VyID09IG51bGwgPyB2b2lkIDAgOiB0cmlnZ2VyLmZvY3VzKSA9PT0gImZ1bmN0aW9uIikgewogICAgICAgIHRyaWdnZXIuZm9jdXMoKTsKICAgICAgfQogICAgfQogICAgZ2V0TWVudSgpIHsKICAgICAgcmV0dXJuIHRoaXMucGFuZWwuYXNzaWduZWRFbGVtZW50cyh7IGZsYXR0ZW46IHRydWUgfSkuZmluZCgoZWwpID0+IGVsLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gInNsLW1lbnUiKTsKICAgIH0KICAgIGhhbmRsZVRyaWdnZXJDbGljaygpIHsKICAgICAgaWYgKHRoaXMub3BlbikgewogICAgICAgIHRoaXMuaGlkZSgpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2hvdygpOwogICAgICAgIHRoaXMuZm9jdXNPblRyaWdnZXIoKTsKICAgICAgfQogICAgfQogICAgYXN5bmMgaGFuZGxlVHJpZ2dlcktleURvd24oZXZlbnQpIHsKICAgICAgaWYgKFsiICIsICJFbnRlciJdLmluY2x1ZGVzKGV2ZW50LmtleSkpIHsKICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIHRoaXMuaGFuZGxlVHJpZ2dlckNsaWNrKCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnN0IG1lbnUgPSB0aGlzLmdldE1lbnUoKTsKICAgICAgaWYgKG1lbnUpIHsKICAgICAgICBjb25zdCBtZW51SXRlbXMgPSBtZW51LmdldEFsbEl0ZW1zKCk7CiAgICAgICAgY29uc3QgZmlyc3RNZW51SXRlbSA9IG1lbnVJdGVtc1swXTsKICAgICAgICBjb25zdCBsYXN0TWVudUl0ZW0gPSBtZW51SXRlbXNbbWVudUl0ZW1zLmxlbmd0aCAtIDFdOwogICAgICAgIGlmIChbIkFycm93RG93biIsICJBcnJvd1VwIiwgIkhvbWUiLCAiRW5kIl0uaW5jbHVkZXMoZXZlbnQua2V5KSkgewogICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgIGlmICghdGhpcy5vcGVuKSB7CiAgICAgICAgICAgIHRoaXMuc2hvdygpOwogICAgICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZUNvbXBsZXRlOwogICAgICAgICAgfQogICAgICAgICAgaWYgKG1lbnVJdGVtcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHRoaXMudXBkYXRlQ29tcGxldGUudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gIkFycm93RG93biIgfHwgZXZlbnQua2V5ID09PSAiSG9tZSIpIHsKICAgICAgICAgICAgICAgIG1lbnUuc2V0Q3VycmVudEl0ZW0oZmlyc3RNZW51SXRlbSk7CiAgICAgICAgICAgICAgICBmaXJzdE1lbnVJdGVtLmZvY3VzKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChldmVudC5rZXkgPT09ICJBcnJvd1VwIiB8fCBldmVudC5rZXkgPT09ICJFbmQiKSB7CiAgICAgICAgICAgICAgICBtZW51LnNldEN1cnJlbnRJdGVtKGxhc3RNZW51SXRlbSk7CiAgICAgICAgICAgICAgICBsYXN0TWVudUl0ZW0uZm9jdXMoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogICAgaGFuZGxlVHJpZ2dlcktleVVwKGV2ZW50KSB7CiAgICAgIGlmIChldmVudC5rZXkgPT09ICIgIikgewogICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0KICAgIH0KICAgIGhhbmRsZVRyaWdnZXJTbG90Q2hhbmdlKCkgewogICAgICB0aGlzLnVwZGF0ZUFjY2Vzc2libGVUcmlnZ2VyKCk7CiAgICB9CiAgICAvLwogICAgLy8gU2xvdHRlZCB0cmlnZ2VycyBjYW4gYmUgYXJiaXRyYXJ5IGNvbnRlbnQsIGJ1dCB3ZSBuZWVkIHRvIGxpbmsgdGhlbSB0byB0aGUgZHJvcGRvd24gcGFuZWwgd2l0aCBgYXJpYS1oYXNwb3B1cGAgYW5kCiAgICAvLyBgYXJpYS1leHBhbmRlZGAuIFRoZXNlIG11c3QgYmUgYXBwbGllZCB0byB0aGUgImFjY2Vzc2libGUgdHJpZ2dlciIgKHRoZSB0YWJiYWJsZSBwb3J0aW9uIG9mIHRoZSB0cmlnZ2VyIGVsZW1lbnQKICAgIC8vIHRoYXQgZ2V0cyBzbG90dGVkIGluKSBzbyBzY3JlZW4gcmVhZGVycyB3aWxsIHVuZGVyc3RhbmQgdGhlbS4gVGhlIGFjY2Vzc2libGUgdHJpZ2dlciBjb3VsZCBiZSB0aGUgc2xvdHRlZCBlbGVtZW50LAogICAgLy8gYSBjaGlsZCBvZiB0aGUgc2xvdHRlZCBlbGVtZW50LCBvciBhbiBlbGVtZW50IGluIHRoZSBzbG90dGVkIGVsZW1lbnQncyBzaGFkb3cgcm9vdC4KICAgIC8vCiAgICAvLyBGb3IgZXhhbXBsZSwgdGhlIGFjY2Vzc2libGUgdHJpZ2dlciBvZiBhbiA8c2wtYnV0dG9uPiBpcyBhIDxidXR0b24+IGxvY2F0ZWQgaW5zaWRlIGl0cyBzaGFkb3cgcm9vdC4KICAgIC8vCiAgICAvLyBUbyBkZXRlcm1pbmUgdGhpcywgd2UgYXNzdW1lIHRoZSBmaXJzdCB0YWJiYWJsZSBlbGVtZW50IGluIHRoZSB0cmlnZ2VyIHNsb3QgaXMgdGhlICJhY2Nlc3NpYmxlIHRyaWdnZXIuIgogICAgLy8KICAgIHVwZGF0ZUFjY2Vzc2libGVUcmlnZ2VyKCkgewogICAgICBjb25zdCBhc3NpZ25lZEVsZW1lbnRzID0gdGhpcy50cmlnZ2VyLmFzc2lnbmVkRWxlbWVudHMoeyBmbGF0dGVuOiB0cnVlIH0pOwogICAgICBjb25zdCBhY2Nlc3NpYmxlVHJpZ2dlciA9IGFzc2lnbmVkRWxlbWVudHMuZmluZCgoZWwpID0+IGdldFRhYmJhYmxlQm91bmRhcnkoZWwpLnN0YXJ0KTsKICAgICAgbGV0IHRhcmdldDsKICAgICAgaWYgKGFjY2Vzc2libGVUcmlnZ2VyKSB7CiAgICAgICAgc3dpdGNoIChhY2Nlc3NpYmxlVHJpZ2dlci50YWdOYW1lLnRvTG93ZXJDYXNlKCkpIHsKICAgICAgICAgIGNhc2UgInNsLWJ1dHRvbiI6CiAgICAgICAgICBjYXNlICJzbC1pY29uLWJ1dHRvbiI6CiAgICAgICAgICAgIHRhcmdldCA9IGFjY2Vzc2libGVUcmlnZ2VyLmJ1dHRvbjsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICB0YXJnZXQgPSBhY2Nlc3NpYmxlVHJpZ2dlcjsKICAgICAgICB9CiAgICAgICAgdGFyZ2V0LnNldEF0dHJpYnV0ZSgiYXJpYS1oYXNwb3B1cCIsICJ0cnVlIik7CiAgICAgICAgdGFyZ2V0LnNldEF0dHJpYnV0ZSgiYXJpYS1leHBhbmRlZCIsIHRoaXMub3BlbiA/ICJ0cnVlIiA6ICJmYWxzZSIpOwogICAgICB9CiAgICB9CiAgICAvKiogU2hvd3MgdGhlIGRyb3Bkb3duIHBhbmVsLiAqLwogICAgYXN5bmMgc2hvdygpIHsKICAgICAgaWYgKHRoaXMub3BlbikgewogICAgICAgIHJldHVybiB2b2lkIDA7CiAgICAgIH0KICAgICAgdGhpcy5vcGVuID0gdHJ1ZTsKICAgICAgcmV0dXJuIHdhaXRGb3JFdmVudCh0aGlzLCAic2wtYWZ0ZXItc2hvdyIpOwogICAgfQogICAgLyoqIEhpZGVzIHRoZSBkcm9wZG93biBwYW5lbCAqLwogICAgYXN5bmMgaGlkZSgpIHsKICAgICAgaWYgKCF0aGlzLm9wZW4pIHsKICAgICAgICByZXR1cm4gdm9pZCAwOwogICAgICB9CiAgICAgIHRoaXMub3BlbiA9IGZhbHNlOwogICAgICByZXR1cm4gd2FpdEZvckV2ZW50KHRoaXMsICJzbC1hZnRlci1oaWRlIik7CiAgICB9CiAgICAvKioKICAgICAqIEluc3RydWN0cyB0aGUgZHJvcGRvd24gbWVudSB0byByZXBvc2l0aW9uLiBVc2VmdWwgd2hlbiB0aGUgcG9zaXRpb24gb3Igc2l6ZSBvZiB0aGUgdHJpZ2dlciBjaGFuZ2VzIHdoZW4gdGhlIG1lbnUKICAgICAqIGlzIGFjdGl2YXRlZC4KICAgICAqLwogICAgcmVwb3NpdGlvbigpIHsKICAgICAgdGhpcy5wb3B1cC5yZXBvc2l0aW9uKCk7CiAgICB9CiAgICBhZGRPcGVuTGlzdGVuZXJzKCkgewogICAgICB0aGlzLnBhbmVsLmFkZEV2ZW50TGlzdGVuZXIoInNsLXNlbGVjdCIsIHRoaXMuaGFuZGxlUGFuZWxTZWxlY3QpOwogICAgICB0aGlzLnBhbmVsLmFkZEV2ZW50TGlzdGVuZXIoImtleWRvd24iLCB0aGlzLmhhbmRsZUtleURvd24pOwogICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJrZXlkb3duIiwgdGhpcy5oYW5kbGVEb2N1bWVudEtleURvd24pOwogICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJtb3VzZWRvd24iLCB0aGlzLmhhbmRsZURvY3VtZW50TW91c2VEb3duKTsKICAgIH0KICAgIHJlbW92ZU9wZW5MaXN0ZW5lcnMoKSB7CiAgICAgIGlmICh0aGlzLnBhbmVsKSB7CiAgICAgICAgdGhpcy5wYW5lbC5yZW1vdmVFdmVudExpc3RlbmVyKCJzbC1zZWxlY3QiLCB0aGlzLmhhbmRsZVBhbmVsU2VsZWN0KTsKICAgICAgICB0aGlzLnBhbmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoImtleWRvd24iLCB0aGlzLmhhbmRsZUtleURvd24pOwogICAgICB9CiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoImtleWRvd24iLCB0aGlzLmhhbmRsZURvY3VtZW50S2V5RG93bik7CiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1vdXNlZG93biIsIHRoaXMuaGFuZGxlRG9jdW1lbnRNb3VzZURvd24pOwogICAgfQogICAgYXN5bmMgaGFuZGxlT3BlbkNoYW5nZSgpIHsKICAgICAgaWYgKHRoaXMuZGlzYWJsZWQpIHsKICAgICAgICB0aGlzLm9wZW4gPSBmYWxzZTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy51cGRhdGVBY2Nlc3NpYmxlVHJpZ2dlcigpOwogICAgICBpZiAodGhpcy5vcGVuKSB7CiAgICAgICAgdGhpcy5lbWl0KCJzbC1zaG93Iik7CiAgICAgICAgdGhpcy5hZGRPcGVuTGlzdGVuZXJzKCk7CiAgICAgICAgYXdhaXQgc3RvcEFuaW1hdGlvbnModGhpcyk7CiAgICAgICAgdGhpcy5wYW5lbC5oaWRkZW4gPSBmYWxzZTsKICAgICAgICB0aGlzLnBvcHVwLmFjdGl2ZSA9IHRydWU7CiAgICAgICAgY29uc3QgeyBrZXlmcmFtZXMsIG9wdGlvbnMgfSA9IGdldEFuaW1hdGlvbih0aGlzLCAiZHJvcGRvd24uc2hvdyIsIHsgZGlyOiB0aGlzLmxvY2FsaXplLmRpcigpIH0pOwogICAgICAgIGF3YWl0IGFuaW1hdGVUbyh0aGlzLnBvcHVwLnBvcHVwLCBrZXlmcmFtZXMsIG9wdGlvbnMpOwogICAgICAgIHRoaXMuZW1pdCgic2wtYWZ0ZXItc2hvdyIpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZW1pdCgic2wtaGlkZSIpOwogICAgICAgIHRoaXMucmVtb3ZlT3Blbkxpc3RlbmVycygpOwogICAgICAgIGF3YWl0IHN0b3BBbmltYXRpb25zKHRoaXMpOwogICAgICAgIGNvbnN0IHsga2V5ZnJhbWVzLCBvcHRpb25zIH0gPSBnZXRBbmltYXRpb24odGhpcywgImRyb3Bkb3duLmhpZGUiLCB7IGRpcjogdGhpcy5sb2NhbGl6ZS5kaXIoKSB9KTsKICAgICAgICBhd2FpdCBhbmltYXRlVG8odGhpcy5wb3B1cC5wb3B1cCwga2V5ZnJhbWVzLCBvcHRpb25zKTsKICAgICAgICB0aGlzLnBhbmVsLmhpZGRlbiA9IHRydWU7CiAgICAgICAgdGhpcy5wb3B1cC5hY3RpdmUgPSBmYWxzZTsKICAgICAgICB0aGlzLmVtaXQoInNsLWFmdGVyLWhpZGUiKTsKICAgICAgfQogICAgfQogICAgcmVuZGVyKCkgewogICAgICByZXR1cm4geGAKICAgICAgPHNsLXBvcHVwCiAgICAgICAgcGFydD0iYmFzZSIKICAgICAgICBpZD0iZHJvcGRvd24iCiAgICAgICAgcGxhY2VtZW50PSR7dGhpcy5wbGFjZW1lbnR9CiAgICAgICAgZGlzdGFuY2U9JHt0aGlzLmRpc3RhbmNlfQogICAgICAgIHNraWRkaW5nPSR7dGhpcy5za2lkZGluZ30KICAgICAgICBzdHJhdGVneT0ke3RoaXMuaG9pc3QgPyAiZml4ZWQiIDogImFic29sdXRlIn0KICAgICAgICBmbGlwCiAgICAgICAgc2hpZnQKICAgICAgICBhdXRvLXNpemU9InZlcnRpY2FsIgogICAgICAgIGF1dG8tc2l6ZS1wYWRkaW5nPSIxMCIKICAgICAgICBjbGFzcz0ke2UkMih7CiAgICAgIGRyb3Bkb3duOiB0cnVlLAogICAgICAiZHJvcGRvd24tLW9wZW4iOiB0aGlzLm9wZW4KICAgIH0pfQogICAgICA+CiAgICAgICAgPHNsb3QKICAgICAgICAgIG5hbWU9InRyaWdnZXIiCiAgICAgICAgICBzbG90PSJhbmNob3IiCiAgICAgICAgICBwYXJ0PSJ0cmlnZ2VyIgogICAgICAgICAgY2xhc3M9ImRyb3Bkb3duX190cmlnZ2VyIgogICAgICAgICAgQGNsaWNrPSR7dGhpcy5oYW5kbGVUcmlnZ2VyQ2xpY2t9CiAgICAgICAgICBAa2V5ZG93bj0ke3RoaXMuaGFuZGxlVHJpZ2dlcktleURvd259CiAgICAgICAgICBAa2V5dXA9JHt0aGlzLmhhbmRsZVRyaWdnZXJLZXlVcH0KICAgICAgICAgIEBzbG90Y2hhbmdlPSR7dGhpcy5oYW5kbGVUcmlnZ2VyU2xvdENoYW5nZX0KICAgICAgICA+PC9zbG90PgoKICAgICAgICA8ZGl2IGFyaWEtaGlkZGVuPSR7dGhpcy5vcGVuID8gImZhbHNlIiA6ICJ0cnVlIn0gYXJpYS1sYWJlbGxlZGJ5PSJkcm9wZG93biI+CiAgICAgICAgICA8c2xvdCBwYXJ0PSJwYW5lbCIgY2xhc3M9ImRyb3Bkb3duX19wYW5lbCI+PC9zbG90PgogICAgICAgIDwvZGl2PgogICAgICA8L3NsLXBvcHVwPgogICAgYDsKICAgIH0KICB9OwogIFNsRHJvcGRvd24uc3R5bGVzID0gZHJvcGRvd25fc3R5bGVzX2RlZmF1bHQ7CiAgU2xEcm9wZG93bi5kZXBlbmRlbmNpZXMgPSB7ICJzbC1wb3B1cCI6IFNsUG9wdXAgfTsKICBfX2RlY29yYXRlQ2xhc3MoWwogICAgZSQ0KCIuZHJvcGRvd24iKQogIF0sIFNsRHJvcGRvd24ucHJvdG90eXBlLCAicG9wdXAiLCAyKTsKICBfX2RlY29yYXRlQ2xhc3MoWwogICAgZSQ0KCIuZHJvcGRvd25fX3RyaWdnZXIiKQogIF0sIFNsRHJvcGRvd24ucHJvdG90eXBlLCAidHJpZ2dlciIsIDIpOwogIF9fZGVjb3JhdGVDbGFzcyhbCiAgICBlJDQoIi5kcm9wZG93bl9fcGFuZWwiKQogIF0sIFNsRHJvcGRvd24ucHJvdG90eXBlLCAicGFuZWwiLCAyKTsKICBfX2RlY29yYXRlQ2xhc3MoWwogICAgbiQyKHsgdHlwZTogQm9vbGVhbiwgcmVmbGVjdDogdHJ1ZSB9KQogIF0sIFNsRHJvcGRvd24ucHJvdG90eXBlLCAib3BlbiIsIDIpOwogIF9fZGVjb3JhdGVDbGFzcyhbCiAgICBuJDIoeyByZWZsZWN0OiB0cnVlIH0pCiAgXSwgU2xEcm9wZG93bi5wcm90b3R5cGUsICJwbGFjZW1lbnQiLCAyKTsKICBfX2RlY29yYXRlQ2xhc3MoWwogICAgbiQyKHsgdHlwZTogQm9vbGVhbiwgcmVmbGVjdDogdHJ1ZSB9KQogIF0sIFNsRHJvcGRvd24ucHJvdG90eXBlLCAiZGlzYWJsZWQiLCAyKTsKICBfX2RlY29yYXRlQ2xhc3MoWwogICAgbiQyKHsgYXR0cmlidXRlOiAic3RheS1vcGVuLW9uLXNlbGVjdCIsIHR5cGU6IEJvb2xlYW4sIHJlZmxlY3Q6IHRydWUgfSkKICBdLCBTbERyb3Bkb3duLnByb3RvdHlwZSwgInN0YXlPcGVuT25TZWxlY3QiLCAyKTsKICBfX2RlY29yYXRlQ2xhc3MoWwogICAgbiQyKHsgYXR0cmlidXRlOiBmYWxzZSB9KQogIF0sIFNsRHJvcGRvd24ucHJvdG90eXBlLCAiY29udGFpbmluZ0VsZW1lbnQiLCAyKTsKICBfX2RlY29yYXRlQ2xhc3MoWwogICAgbiQyKHsgdHlwZTogTnVtYmVyIH0pCiAgXSwgU2xEcm9wZG93bi5wcm90b3R5cGUsICJkaXN0YW5jZSIsIDIpOwogIF9fZGVjb3JhdGVDbGFzcyhbCiAgICBuJDIoeyB0eXBlOiBOdW1iZXIgfSkKICBdLCBTbERyb3Bkb3duLnByb3RvdHlwZSwgInNraWRkaW5nIiwgMik7CiAgX19kZWNvcmF0ZUNsYXNzKFsKICAgIG4kMih7IHR5cGU6IEJvb2xlYW4gfSkKICBdLCBTbERyb3Bkb3duLnByb3RvdHlwZSwgImhvaXN0IiwgMik7CiAgX19kZWNvcmF0ZUNsYXNzKFsKICAgIHdhdGNoKCJvcGVuIiwgeyB3YWl0VW50aWxGaXJzdFVwZGF0ZTogdHJ1ZSB9KQogIF0sIFNsRHJvcGRvd24ucHJvdG90eXBlLCAiaGFuZGxlT3BlbkNoYW5nZSIsIDEpOwogIHNldERlZmF1bHRBbmltYXRpb24oImRyb3Bkb3duLnNob3ciLCB7CiAgICBrZXlmcmFtZXM6IFsKICAgICAgeyBvcGFjaXR5OiAwLCBzY2FsZTogMC45IH0sCiAgICAgIHsgb3BhY2l0eTogMSwgc2NhbGU6IDEgfQogICAgXSwKICAgIG9wdGlvbnM6IHsgZHVyYXRpb246IDEwMCwgZWFzaW5nOiAiZWFzZSIgfQogIH0pOwogIHNldERlZmF1bHRBbmltYXRpb24oImRyb3Bkb3duLmhpZGUiLCB7CiAgICBrZXlmcmFtZXM6IFsKICAgICAgeyBvcGFjaXR5OiAxLCBzY2FsZTogMSB9LAogICAgICB7IG9wYWNpdHk6IDAsIHNjYWxlOiAwLjkgfQogICAgXSwKICAgIG9wdGlvbnM6IHsgZHVyYXRpb246IDEwMCwgZWFzaW5nOiAiZWFzZSIgfQogIH0pOwoKICBTbERyb3Bkb3duLmRlZmluZSgic2wtZHJvcGRvd24iKTsKCiAgdmFyIG1lbnVfc3R5bGVzX2RlZmF1bHQgPSBpJDNgCiAgJHtjb21wb25lbnRfc3R5bGVzX2RlZmF1bHR9CgogIDpob3N0IHsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgYmFja2dyb3VuZDogdmFyKC0tc2wtcGFuZWwtYmFja2dyb3VuZC1jb2xvcik7CiAgICBib3JkZXI6IHNvbGlkIHZhcigtLXNsLXBhbmVsLWJvcmRlci13aWR0aCkgdmFyKC0tc2wtcGFuZWwtYm9yZGVyLWNvbG9yKTsKICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXNsLWJvcmRlci1yYWRpdXMtbWVkaXVtKTsKICAgIHBhZGRpbmc6IHZhcigtLXNsLXNwYWNpbmcteC1zbWFsbCkgMDsKICAgIG92ZXJmbG93OiBhdXRvOwogICAgb3ZlcnNjcm9sbC1iZWhhdmlvcjogbm9uZTsKICB9CgogIDo6c2xvdHRlZChzbC1kaXZpZGVyKSB7CiAgICAtLXNwYWNpbmc6IHZhcigtLXNsLXNwYWNpbmcteC1zbWFsbCk7CiAgfQpgOwoKICB2YXIgU2xNZW51ID0gY2xhc3MgZXh0ZW5kcyBTaG9lbGFjZUVsZW1lbnQgewogICAgY29ubmVjdGVkQ2FsbGJhY2soKSB7CiAgICAgIHN1cGVyLmNvbm5lY3RlZENhbGxiYWNrKCk7CiAgICAgIHRoaXMuc2V0QXR0cmlidXRlKCJyb2xlIiwgIm1lbnUiKTsKICAgIH0KICAgIGhhbmRsZUNsaWNrKGV2ZW50KSB7CiAgICAgIGNvbnN0IG1lbnVJdGVtVHlwZXMgPSBbIm1lbnVpdGVtIiwgIm1lbnVpdGVtY2hlY2tib3giXTsKICAgICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQuY29tcG9zZWRQYXRoKCkuZmluZCgoZWwpID0+IHsKICAgICAgICB2YXIgX2E7CiAgICAgICAgcmV0dXJuIG1lbnVJdGVtVHlwZXMuaW5jbHVkZXMoKChfYSA9IGVsID09IG51bGwgPyB2b2lkIDAgOiBlbC5nZXRBdHRyaWJ1dGUpID09IG51bGwgPyB2b2lkIDAgOiBfYS5jYWxsKGVsLCAicm9sZSIpKSB8fCAiIik7CiAgICAgIH0pOwogICAgICBpZiAoIXRhcmdldCkKICAgICAgICByZXR1cm47CiAgICAgIGNvbnN0IGl0ZW0gPSB0YXJnZXQ7CiAgICAgIGlmIChpdGVtLnR5cGUgPT09ICJjaGVja2JveCIpIHsKICAgICAgICBpdGVtLmNoZWNrZWQgPSAhaXRlbS5jaGVja2VkOwogICAgICB9CiAgICAgIHRoaXMuZW1pdCgic2wtc2VsZWN0IiwgeyBkZXRhaWw6IHsgaXRlbSB9IH0pOwogICAgfQogICAgaGFuZGxlS2V5RG93bihldmVudCkgewogICAgICBpZiAoZXZlbnQua2V5ID09PSAiRW50ZXIiIHx8IGV2ZW50LmtleSA9PT0gIiAiKSB7CiAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuZ2V0Q3VycmVudEl0ZW0oKTsKICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgIGl0ZW0gPT0gbnVsbCA/IHZvaWQgMCA6IGl0ZW0uY2xpY2soKTsKICAgICAgfSBlbHNlIGlmIChbIkFycm93RG93biIsICJBcnJvd1VwIiwgIkhvbWUiLCAiRW5kIl0uaW5jbHVkZXMoZXZlbnQua2V5KSkgewogICAgICAgIGNvbnN0IGl0ZW1zID0gdGhpcy5nZXRBbGxJdGVtcygpOwogICAgICAgIGNvbnN0IGFjdGl2ZUl0ZW0gPSB0aGlzLmdldEN1cnJlbnRJdGVtKCk7CiAgICAgICAgbGV0IGluZGV4ID0gYWN0aXZlSXRlbSA/IGl0ZW1zLmluZGV4T2YoYWN0aXZlSXRlbSkgOiAwOwogICAgICAgIGlmIChpdGVtcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICBpZiAoZXZlbnQua2V5ID09PSAiQXJyb3dEb3duIikgewogICAgICAgICAgICBpbmRleCsrOwogICAgICAgICAgfSBlbHNlIGlmIChldmVudC5rZXkgPT09ICJBcnJvd1VwIikgewogICAgICAgICAgICBpbmRleC0tOwogICAgICAgICAgfSBlbHNlIGlmIChldmVudC5rZXkgPT09ICJIb21lIikgewogICAgICAgICAgICBpbmRleCA9IDA7CiAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gIkVuZCIpIHsKICAgICAgICAgICAgaW5kZXggPSBpdGVtcy5sZW5ndGggLSAxOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGluZGV4IDwgMCkgewogICAgICAgICAgICBpbmRleCA9IGl0ZW1zLmxlbmd0aCAtIDE7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoaW5kZXggPiBpdGVtcy5sZW5ndGggLSAxKSB7CiAgICAgICAgICAgIGluZGV4ID0gMDsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuc2V0Q3VycmVudEl0ZW0oaXRlbXNbaW5kZXhdKTsKICAgICAgICAgIGl0ZW1zW2luZGV4XS5mb2N1cygpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgaGFuZGxlTW91c2VEb3duKGV2ZW50KSB7CiAgICAgIGNvbnN0IHRhcmdldCA9IGV2ZW50LnRhcmdldDsKICAgICAgaWYgKHRoaXMuaXNNZW51SXRlbSh0YXJnZXQpKSB7CiAgICAgICAgdGhpcy5zZXRDdXJyZW50SXRlbSh0YXJnZXQpOwogICAgICB9CiAgICB9CiAgICBoYW5kbGVTbG90Q2hhbmdlKCkgewogICAgICBjb25zdCBpdGVtcyA9IHRoaXMuZ2V0QWxsSXRlbXMoKTsKICAgICAgaWYgKGl0ZW1zLmxlbmd0aCA+IDApIHsKICAgICAgICB0aGlzLnNldEN1cnJlbnRJdGVtKGl0ZW1zWzBdKTsKICAgICAgfQogICAgfQogICAgaXNNZW51SXRlbShpdGVtKSB7CiAgICAgIHZhciBfYTsKICAgICAgcmV0dXJuIGl0ZW0udGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAic2wtbWVudS1pdGVtIiB8fCBbIm1lbnVpdGVtIiwgIm1lbnVpdGVtY2hlY2tib3giLCAibWVudWl0ZW1yYWRpbyJdLmluY2x1ZGVzKChfYSA9IGl0ZW0uZ2V0QXR0cmlidXRlKCJyb2xlIikpICE9IG51bGwgPyBfYSA6ICIiKTsKICAgIH0KICAgIC8qKiBAaW50ZXJuYWwgR2V0cyBhbGwgc2xvdHRlZCBtZW51IGl0ZW1zLCBpZ25vcmluZyBkaXZpZGVycywgaGVhZGVycywgYW5kIG90aGVyIGVsZW1lbnRzLiAqLwogICAgZ2V0QWxsSXRlbXMoKSB7CiAgICAgIHJldHVybiBbLi4udGhpcy5kZWZhdWx0U2xvdC5hc3NpZ25lZEVsZW1lbnRzKHsgZmxhdHRlbjogdHJ1ZSB9KV0uZmlsdGVyKChlbCkgPT4gewogICAgICAgIGlmIChlbC5pbmVydCB8fCAhdGhpcy5pc01lbnVJdGVtKGVsKSkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSk7CiAgICB9CiAgICAvKioKICAgICAqIEBpbnRlcm5hbCBHZXRzIHRoZSBjdXJyZW50IG1lbnUgaXRlbSwgd2hpY2ggaXMgdGhlIG1lbnUgaXRlbSB0aGF0IGhhcyBgdGFiaW5kZXg9IjAiYCB3aXRoaW4gdGhlIHJvdmluZyB0YWIgaW5kZXguCiAgICAgKiBUaGUgbWVudSBpdGVtIG1heSBvciBtYXkgbm90IGhhdmUgZm9jdXMsIGJ1dCBmb3Iga2V5Ym9hcmQgaW50ZXJhY3Rpb24gcHVycG9zZXMgaXQncyBjb25zaWRlcmVkIHRoZSAiYWN0aXZlIiBpdGVtLgogICAgICovCiAgICBnZXRDdXJyZW50SXRlbSgpIHsKICAgICAgcmV0dXJuIHRoaXMuZ2V0QWxsSXRlbXMoKS5maW5kKChpKSA9PiBpLmdldEF0dHJpYnV0ZSgidGFiaW5kZXgiKSA9PT0gIjAiKTsKICAgIH0KICAgIC8qKgogICAgICogQGludGVybmFsIFNldHMgdGhlIGN1cnJlbnQgbWVudSBpdGVtIHRvIHRoZSBzcGVjaWZpZWQgZWxlbWVudC4gVGhpcyBzZXRzIGB0YWJpbmRleD0iMCJgIG9uIHRoZSB0YXJnZXQgZWxlbWVudCBhbmQKICAgICAqIGB0YWJpbmRleD0iLTEiYCB0byBhbGwgb3RoZXIgaXRlbXMuIFRoaXMgbWV0aG9kIG11c3QgYmUgY2FsbGVkIHByaW9yIHRvIHNldHRpbmcgZm9jdXMgb24gYSBtZW51IGl0ZW0uCiAgICAgKi8KICAgIHNldEN1cnJlbnRJdGVtKGl0ZW0pIHsKICAgICAgY29uc3QgaXRlbXMgPSB0aGlzLmdldEFsbEl0ZW1zKCk7CiAgICAgIGl0ZW1zLmZvckVhY2goKGkpID0+IHsKICAgICAgICBpLnNldEF0dHJpYnV0ZSgidGFiaW5kZXgiLCBpID09PSBpdGVtID8gIjAiIDogIi0xIik7CiAgICAgIH0pOwogICAgfQogICAgcmVuZGVyKCkgewogICAgICByZXR1cm4geGAKICAgICAgPHNsb3QKICAgICAgICBAc2xvdGNoYW5nZT0ke3RoaXMuaGFuZGxlU2xvdENoYW5nZX0KICAgICAgICBAY2xpY2s9JHt0aGlzLmhhbmRsZUNsaWNrfQogICAgICAgIEBrZXlkb3duPSR7dGhpcy5oYW5kbGVLZXlEb3dufQogICAgICAgIEBtb3VzZWRvd249JHt0aGlzLmhhbmRsZU1vdXNlRG93bn0KICAgICAgPjwvc2xvdD4KICAgIGA7CiAgICB9CiAgfTsKICBTbE1lbnUuc3R5bGVzID0gbWVudV9zdHlsZXNfZGVmYXVsdDsKICBfX2RlY29yYXRlQ2xhc3MoWwogICAgZSQ0KCJzbG90IikKICBdLCBTbE1lbnUucHJvdG90eXBlLCAiZGVmYXVsdFNsb3QiLCAyKTsKCiAgU2xNZW51LmRlZmluZSgic2wtbWVudSIpOwoKICB2YXIgbWVudV9pdGVtX3N0eWxlc19kZWZhdWx0ID0gaSQzYAogICR7Y29tcG9uZW50X3N0eWxlc19kZWZhdWx0fQoKICA6aG9zdCB7CiAgICAtLXN1Ym1lbnUtb2Zmc2V0OiAtMnB4OwoKICAgIC8qIFByaXZhdGUgKi8KICAgIC0tc2FmZS10cmlhbmdsZS1jdXJzb3IteDogMDsKICAgIC0tc2FmZS10cmlhbmdsZS1jdXJzb3IteTogMDsKICAgIC0tc2FmZS10cmlhbmdsZS1zdWJtZW51LXN0YXJ0LXg6IDA7CiAgICAtLXNhZmUtdHJpYW5nbGUtc3VibWVudS1zdGFydC15OiAwOwogICAgLS1zYWZlLXRyaWFuZ2xlLXN1Ym1lbnUtZW5kLXg6IDA7CiAgICAtLXNhZmUtdHJpYW5nbGUtc3VibWVudS1lbmQteTogMDsKCiAgICBkaXNwbGF5OiBibG9jazsKICB9CgogIDpob3N0KFtpbmVydF0pIHsKICAgIGRpc3BsYXk6IG5vbmU7CiAgfQoKICAubWVudS1pdGVtIHsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogc3RyZXRjaDsKICAgIGZvbnQtZmFtaWx5OiB2YXIoLS1zbC1mb250LXNhbnMpOwogICAgZm9udC1zaXplOiB2YXIoLS1zbC1mb250LXNpemUtbWVkaXVtKTsKICAgIGZvbnQtd2VpZ2h0OiB2YXIoLS1zbC1mb250LXdlaWdodC1ub3JtYWwpOwogICAgbGluZS1oZWlnaHQ6IHZhcigtLXNsLWxpbmUtaGVpZ2h0LW5vcm1hbCk7CiAgICBsZXR0ZXItc3BhY2luZzogdmFyKC0tc2wtbGV0dGVyLXNwYWNpbmctbm9ybWFsKTsKICAgIGNvbG9yOiB2YXIoLS1zbC1jb2xvci1uZXV0cmFsLTcwMCk7CiAgICBwYWRkaW5nOiB2YXIoLS1zbC1zcGFjaW5nLTJ4LXNtYWxsKSB2YXIoLS1zbC1zcGFjaW5nLTJ4LXNtYWxsKTsKICAgIHRyYW5zaXRpb246IHZhcigtLXNsLXRyYW5zaXRpb24tZmFzdCkgZmlsbDsKICAgIHVzZXItc2VsZWN0OiBub25lOwogICAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTsKICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgfQoKICAubWVudS1pdGVtLm1lbnUtaXRlbS0tZGlzYWJsZWQgewogICAgb3V0bGluZTogbm9uZTsKICAgIG9wYWNpdHk6IDAuNTsKICAgIGN1cnNvcjogbm90LWFsbG93ZWQ7CiAgfQoKICAubWVudS1pdGVtIC5tZW51LWl0ZW1fX2xhYmVsIHsKICAgIGZsZXg6IDEgMSBhdXRvOwogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7CiAgICBvdmVyZmxvdzogaGlkZGVuOwogIH0KCiAgLm1lbnUtaXRlbSAubWVudS1pdGVtX19wcmVmaXggewogICAgZmxleDogMCAwIGF1dG87CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICB9CgogIC5tZW51LWl0ZW0gLm1lbnUtaXRlbV9fcHJlZml4OjpzbG90dGVkKCopIHsKICAgIG1hcmdpbi1pbmxpbmUtZW5kOiB2YXIoLS1zbC1zcGFjaW5nLXgtc21hbGwpOwogIH0KCiAgLm1lbnUtaXRlbSAubWVudS1pdGVtX19zdWZmaXggewogICAgZmxleDogMCAwIGF1dG87CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICB9CgogIC5tZW51LWl0ZW0gLm1lbnUtaXRlbV9fc3VmZml4OjpzbG90dGVkKCopIHsKICAgIG1hcmdpbi1pbmxpbmUtc3RhcnQ6IHZhcigtLXNsLXNwYWNpbmcteC1zbWFsbCk7CiAgfQoKICAvKiBTYWZlIHRyaWFuZ2xlICovCiAgLm1lbnUtaXRlbS0tc3VibWVudS1leHBhbmRlZDo6YWZ0ZXIgewogICAgY29udGVudDogJyc7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICB6LWluZGV4OiBjYWxjKHZhcigtLXNsLXotaW5kZXgtZHJvcGRvd24pIC0gMSk7CiAgICB0b3A6IDA7CiAgICByaWdodDogMDsKICAgIGJvdHRvbTogMDsKICAgIGxlZnQ6IDA7CiAgICBjbGlwLXBhdGg6IHBvbHlnb24oCiAgICAgIHZhcigtLXNhZmUtdHJpYW5nbGUtY3Vyc29yLXgpIHZhcigtLXNhZmUtdHJpYW5nbGUtY3Vyc29yLXkpLAogICAgICB2YXIoLS1zYWZlLXRyaWFuZ2xlLXN1Ym1lbnUtc3RhcnQteCkgdmFyKC0tc2FmZS10cmlhbmdsZS1zdWJtZW51LXN0YXJ0LXkpLAogICAgICB2YXIoLS1zYWZlLXRyaWFuZ2xlLXN1Ym1lbnUtZW5kLXgpIHZhcigtLXNhZmUtdHJpYW5nbGUtc3VibWVudS1lbmQteSkKICAgICk7CiAgfQoKICA6aG9zdCg6Zm9jdXMtdmlzaWJsZSkgewogICAgb3V0bGluZTogbm9uZTsKICB9CgogIDpob3N0KDpob3Zlcjpub3QoW2FyaWEtZGlzYWJsZWQ9J3RydWUnXSwgOmZvY3VzLXZpc2libGUpKSAubWVudS1pdGVtLAogIC5tZW51LWl0ZW0tLXN1Ym1lbnUtZXhwYW5kZWQgewogICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tc2wtY29sb3ItbmV1dHJhbC0xMDApOwogICAgY29sb3I6IHZhcigtLXNsLWNvbG9yLW5ldXRyYWwtMTAwMCk7CiAgfQoKICA6aG9zdCg6Zm9jdXMtdmlzaWJsZSkgLm1lbnUtaXRlbSB7CiAgICBvdXRsaW5lOiBub25lOwogICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tc2wtY29sb3ItcHJpbWFyeS02MDApOwogICAgY29sb3I6IHZhcigtLXNsLWNvbG9yLW5ldXRyYWwtMCk7CiAgICBvcGFjaXR5OiAxOwogIH0KCiAgLm1lbnUtaXRlbSAubWVudS1pdGVtX19jaGVjaywKICAubWVudS1pdGVtIC5tZW51LWl0ZW1fX2NoZXZyb24gewogICAgZmxleDogMCAwIGF1dG87CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgd2lkdGg6IDEuNWVtOwogICAgdmlzaWJpbGl0eTogaGlkZGVuOwogIH0KCiAgLm1lbnUtaXRlbS0tY2hlY2tlZCAubWVudS1pdGVtX19jaGVjaywKICAubWVudS1pdGVtLS1oYXMtc3VibWVudSAubWVudS1pdGVtX19jaGV2cm9uIHsKICAgIHZpc2liaWxpdHk6IHZpc2libGU7CiAgfQoKICAvKiBBZGQgZWxldmF0aW9uIGFuZCB6LWluZGV4IHRvIHN1Ym1lbnVzICovCiAgc2wtcG9wdXA6OnBhcnQocG9wdXApIHsKICAgIGJveC1zaGFkb3c6IHZhcigtLXNsLXNoYWRvdy1sYXJnZSk7CiAgICB6LWluZGV4OiB2YXIoLS1zbC16LWluZGV4LWRyb3Bkb3duKTsKICAgIG1hcmdpbi1sZWZ0OiB2YXIoLS1zdWJtZW51LW9mZnNldCk7CiAgfQoKICAubWVudS1pdGVtLS1ydGwgc2wtcG9wdXA6OnBhcnQocG9wdXApIHsKICAgIG1hcmdpbi1sZWZ0OiBjYWxjKC0xICogdmFyKC0tc3VibWVudS1vZmZzZXQpKTsKICB9CgogIEBtZWRpYSAoZm9yY2VkLWNvbG9yczogYWN0aXZlKSB7CiAgICA6aG9zdCg6aG92ZXI6bm90KFthcmlhLWRpc2FibGVkPSd0cnVlJ10pKSAubWVudS1pdGVtLAogICAgOmhvc3QoOmZvY3VzLXZpc2libGUpIC5tZW51LWl0ZW0gewogICAgICBvdXRsaW5lOiBkYXNoZWQgMXB4IFNlbGVjdGVkSXRlbTsKICAgICAgb3V0bGluZS1vZmZzZXQ6IC0xcHg7CiAgICB9CiAgfQpgOwoKICAvKioKICAgKiBAbGljZW5zZQogICAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTEMKICAgKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogQlNELTMtQ2xhdXNlCiAgICovY29uc3QgZSQxPShvLHQpPT52b2lkIDA9PT10P3ZvaWQgMCE9PW8/Ll8kbGl0VHlwZSQ6bz8uXyRsaXRUeXBlJD09PXQsZiQxPW89PnZvaWQgMD09PW8uc3RyaW5nczsKCiAgLyoqCiAgICogQGxpY2Vuc2UKICAgKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDCiAgICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEJTRC0zLUNsYXVzZQogICAqL2NvbnN0IHM9KGksdCk9Pntjb25zdCBlPWkuXyRBTjtpZih2b2lkIDA9PT1lKXJldHVybiAhMTtmb3IoY29uc3QgaSBvZiBlKWkuXyRBTz8uKHQsITEpLHMoaSx0KTtyZXR1cm4gITB9LG8kMT1pPT57bGV0IHQsZTtkb3tpZih2b2lkIDA9PT0odD1pLl8kQU0pKWJyZWFrO2U9dC5fJEFOLGUuZGVsZXRlKGkpLGk9dDt9d2hpbGUoMD09PWU/LnNpemUpfSxyPWk9Pntmb3IobGV0IHQ7dD1pLl8kQU07aT10KXtsZXQgZT10Ll8kQU47aWYodm9pZCAwPT09ZSl0Ll8kQU49ZT1uZXcgU2V0O2Vsc2UgaWYoZS5oYXMoaSkpYnJlYWs7ZS5hZGQoaSksYyh0KTt9fTtmdW5jdGlvbiBoJDEoaSl7dm9pZCAwIT09dGhpcy5fJEFOPyhvJDEodGhpcyksdGhpcy5fJEFNPWkscih0aGlzKSk6dGhpcy5fJEFNPWk7fWZ1bmN0aW9uIG4kMShpLHQ9ITEsZT0wKXtjb25zdCByPXRoaXMuXyRBSCxoPXRoaXMuXyRBTjtpZih2b2lkIDAhPT1oJiYwIT09aC5zaXplKWlmKHQpaWYoQXJyYXkuaXNBcnJheShyKSlmb3IobGV0IGk9ZTtpPHIubGVuZ3RoO2krKylzKHJbaV0sITEpLG8kMShyW2ldKTtlbHNlIG51bGwhPXImJihzKHIsITEpLG8kMShyKSk7ZWxzZSBzKHRoaXMsaSk7fWNvbnN0IGM9aT0+e2kudHlwZT09dC5DSElMRCYmKGkuXyRBUD8/PW4kMSxpLl8kQVE/Pz1oJDEpO307Y2xhc3MgZiBleHRlbmRzIGl7Y29uc3RydWN0b3IoKXtzdXBlciguLi5hcmd1bWVudHMpLHRoaXMuXyRBTj12b2lkIDA7fV8kQVQoaSx0LGUpe3N1cGVyLl8kQVQoaSx0LGUpLHIodGhpcyksdGhpcy5pc0Nvbm5lY3RlZD1pLl8kQVU7fV8kQU8oaSx0PSEwKXtpIT09dGhpcy5pc0Nvbm5lY3RlZCYmKHRoaXMuaXNDb25uZWN0ZWQ9aSxpP3RoaXMucmVjb25uZWN0ZWQ/LigpOnRoaXMuZGlzY29ubmVjdGVkPy4oKSksdCYmKHModGhpcyxpKSxvJDEodGhpcykpO31zZXRWYWx1ZSh0KXtpZihmJDEodGhpcy5fJEN0KSl0aGlzLl8kQ3QuXyRBSSh0LHRoaXMpO2Vsc2Uge2NvbnN0IGk9Wy4uLnRoaXMuXyRDdC5fJEFIXTtpW3RoaXMuXyRDaV09dCx0aGlzLl8kQ3QuXyRBSShpLHRoaXMsMCk7fX1kaXNjb25uZWN0ZWQoKXt9cmVjb25uZWN0ZWQoKXt9fQoKICAvKioKICAgKiBAbGljZW5zZQogICAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTEMKICAgKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogQlNELTMtQ2xhdXNlCiAgICovY29uc3QgZT0oKT0+bmV3IGg7Y2xhc3MgaHt9Y29uc3Qgbz1uZXcgV2Vha01hcCxuPWUkMyhjbGFzcyBleHRlbmRzIGZ7cmVuZGVyKGkpe3JldHVybiBUfXVwZGF0ZShpLFtzXSl7Y29uc3QgZT1zIT09dGhpcy5HO3JldHVybiBlJiZ2b2lkIDAhPT10aGlzLkcmJnRoaXMub3Qodm9pZCAwKSwoZXx8dGhpcy5ydCE9PXRoaXMubHQpJiYodGhpcy5HPXMsdGhpcy5jdD1pLm9wdGlvbnM/Lmhvc3QsdGhpcy5vdCh0aGlzLmx0PWkuZWxlbWVudCkpLFR9b3QodCl7aWYoImZ1bmN0aW9uIj09dHlwZW9mIHRoaXMuRyl7Y29uc3QgaT10aGlzLmN0Pz9nbG9iYWxUaGlzO2xldCBzPW8uZ2V0KGkpO3ZvaWQgMD09PXMmJihzPW5ldyBXZWFrTWFwLG8uc2V0KGkscykpLHZvaWQgMCE9PXMuZ2V0KHRoaXMuRykmJnRoaXMuRy5jYWxsKHRoaXMuY3Qsdm9pZCAwKSxzLnNldCh0aGlzLkcsdCksdm9pZCAwIT09dCYmdGhpcy5HLmNhbGwodGhpcy5jdCx0KTt9ZWxzZSB0aGlzLkcudmFsdWU9dDt9Z2V0IHJ0KCl7cmV0dXJuICJmdW5jdGlvbiI9PXR5cGVvZiB0aGlzLkc/by5nZXQodGhpcy5jdD8/Z2xvYmFsVGhpcyk/LmdldCh0aGlzLkcpOnRoaXMuRz8udmFsdWV9ZGlzY29ubmVjdGVkKCl7dGhpcy5ydD09PXRoaXMubHQmJnRoaXMub3Qodm9pZCAwKTt9cmVjb25uZWN0ZWQoKXt0aGlzLm90KHRoaXMubHQpO319KTsKCiAgLy8gc3JjL2NvbXBvbmVudHMvbWVudS1pdGVtL3N1Ym1lbnUtY29udHJvbGxlci50cwogIHZhciBTdWJtZW51Q29udHJvbGxlciA9IGNsYXNzIHsKICAgIGNvbnN0cnVjdG9yKGhvc3QsIGhhc1Nsb3RDb250cm9sbGVyLCBsb2NhbGl6ZSkgewogICAgICB0aGlzLnBvcHVwUmVmID0gZSgpOwogICAgICB0aGlzLmVuYWJsZVN1Ym1lbnVUaW1lciA9IC0xOwogICAgICB0aGlzLmlzQ29ubmVjdGVkID0gZmFsc2U7CiAgICAgIHRoaXMuaXNQb3B1cENvbm5lY3RlZCA9IGZhbHNlOwogICAgICB0aGlzLnNraWRkaW5nID0gMDsKICAgICAgdGhpcy5zdWJtZW51T3BlbkRlbGF5ID0gMTAwOwogICAgICAvLyBTZXQgdGhlIHNhZmUgdHJpYW5nbGUgY3Vyc29yIHBvc2l0aW9uCiAgICAgIHRoaXMuaGFuZGxlTW91c2VNb3ZlID0gKGV2ZW50KSA9PiB7CiAgICAgICAgdGhpcy5ob3N0LnN0eWxlLnNldFByb3BlcnR5KCItLXNhZmUtdHJpYW5nbGUtY3Vyc29yLXgiLCBgJHtldmVudC5jbGllbnRYfXB4YCk7CiAgICAgICAgdGhpcy5ob3N0LnN0eWxlLnNldFByb3BlcnR5KCItLXNhZmUtdHJpYW5nbGUtY3Vyc29yLXkiLCBgJHtldmVudC5jbGllbnRZfXB4YCk7CiAgICAgIH07CiAgICAgIHRoaXMuaGFuZGxlTW91c2VPdmVyID0gKCkgPT4gewogICAgICAgIGlmICh0aGlzLmhhc1Nsb3RDb250cm9sbGVyLnRlc3QoInN1Ym1lbnUiKSkgewogICAgICAgICAgdGhpcy5lbmFibGVTdWJtZW51KCk7CiAgICAgICAgfQogICAgICB9OwogICAgICAvLyBGb2N1cyBvbiB0aGUgZmlyc3QgbWVudS1pdGVtIG9mIGEgc3VibWVudS4KICAgICAgdGhpcy5oYW5kbGVLZXlEb3duID0gKGV2ZW50KSA9PiB7CiAgICAgICAgc3dpdGNoIChldmVudC5rZXkpIHsKICAgICAgICAgIGNhc2UgIkVzY2FwZSI6CiAgICAgICAgICBjYXNlICJUYWIiOgogICAgICAgICAgICB0aGlzLmRpc2FibGVTdWJtZW51KCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiQXJyb3dMZWZ0IjoKICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldCAhPT0gdGhpcy5ob3N0KSB7CiAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgICB0aGlzLmhvc3QuZm9jdXMoKTsKICAgICAgICAgICAgICB0aGlzLmRpc2FibGVTdWJtZW51KCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJBcnJvd1JpZ2h0IjoKICAgICAgICAgIGNhc2UgIkVudGVyIjoKICAgICAgICAgIGNhc2UgIiAiOgogICAgICAgICAgICB0aGlzLmhhbmRsZVN1Ym1lbnVFbnRyeShldmVudCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfTsKICAgICAgdGhpcy5oYW5kbGVDbGljayA9IChldmVudCkgPT4gewogICAgICAgIHZhciBfYTsKICAgICAgICBpZiAoZXZlbnQudGFyZ2V0ID09PSB0aGlzLmhvc3QpIHsKICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldCBpbnN0YW5jZW9mIEVsZW1lbnQgJiYgKGV2ZW50LnRhcmdldC50YWdOYW1lID09PSAic2wtbWVudS1pdGVtIiB8fCAoKF9hID0gZXZlbnQudGFyZ2V0LnJvbGUpID09IG51bGwgPyB2b2lkIDAgOiBfYS5zdGFydHNXaXRoKCJtZW51aXRlbSIpKSkpIHsKICAgICAgICAgIHRoaXMuZGlzYWJsZVN1Ym1lbnUoKTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIC8vIENsb3NlIHRoaXMgc3VibWVudSBvbiBmb2N1cyBvdXRzaWRlIG9mIHRoZSBwYXJlbnQgb3IgYW55IGRlc2NlbmRhbnRzLgogICAgICB0aGlzLmhhbmRsZUZvY3VzT3V0ID0gKGV2ZW50KSA9PiB7CiAgICAgICAgaWYgKGV2ZW50LnJlbGF0ZWRUYXJnZXQgJiYgZXZlbnQucmVsYXRlZFRhcmdldCBpbnN0YW5jZW9mIEVsZW1lbnQgJiYgdGhpcy5ob3N0LmNvbnRhaW5zKGV2ZW50LnJlbGF0ZWRUYXJnZXQpKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHRoaXMuZGlzYWJsZVN1Ym1lbnUoKTsKICAgICAgfTsKICAgICAgLy8gUHJldmVudCB0aGUgcGFyZW50IG1lbnUtaXRlbSBmcm9tIGdldHRpbmcgZm9jdXMgb24gbW91c2UgbW92ZW1lbnQgb24gdGhlIHN1Ym1lbnUKICAgICAgdGhpcy5oYW5kbGVQb3B1cE1vdXNlb3ZlciA9IChldmVudCkgPT4gewogICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICB9OwogICAgICAvLyBTZXQgdGhlIHNhZmUgdHJpYW5nbGUgdmFsdWVzIGZvciB0aGUgc3VibWVudSB3aGVuIHRoZSBwb3NpdGlvbiBjaGFuZ2VzCiAgICAgIHRoaXMuaGFuZGxlUG9wdXBSZXBvc2l0aW9uID0gKCkgPT4gewogICAgICAgIGNvbnN0IHN1Ym1lbnVTbG90ID0gdGhpcy5ob3N0LnJlbmRlclJvb3QucXVlcnlTZWxlY3Rvcigic2xvdFtuYW1lPSdzdWJtZW51J10iKTsKICAgICAgICBjb25zdCBtZW51ID0gc3VibWVudVNsb3QgPT0gbnVsbCA/IHZvaWQgMCA6IHN1Ym1lbnVTbG90LmFzc2lnbmVkRWxlbWVudHMoeyBmbGF0dGVuOiB0cnVlIH0pLmZpbHRlcigoZWwpID0+IGVsLmxvY2FsTmFtZSA9PT0gInNsLW1lbnUiKVswXTsKICAgICAgICBjb25zdCBpc1J0bCA9IHRoaXMubG9jYWxpemUuZGlyKCkgPT09ICJydGwiOwogICAgICAgIGlmICghbWVudSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBjb25zdCB7IGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCB9ID0gbWVudS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICB0aGlzLmhvc3Quc3R5bGUuc2V0UHJvcGVydHkoIi0tc2FmZS10cmlhbmdsZS1zdWJtZW51LXN0YXJ0LXgiLCBgJHtpc1J0bCA/IGxlZnQgKyB3aWR0aCA6IGxlZnR9cHhgKTsKICAgICAgICB0aGlzLmhvc3Quc3R5bGUuc2V0UHJvcGVydHkoIi0tc2FmZS10cmlhbmdsZS1zdWJtZW51LXN0YXJ0LXkiLCBgJHt0b3B9cHhgKTsKICAgICAgICB0aGlzLmhvc3Quc3R5bGUuc2V0UHJvcGVydHkoIi0tc2FmZS10cmlhbmdsZS1zdWJtZW51LWVuZC14IiwgYCR7aXNSdGwgPyBsZWZ0ICsgd2lkdGggOiBsZWZ0fXB4YCk7CiAgICAgICAgdGhpcy5ob3N0LnN0eWxlLnNldFByb3BlcnR5KCItLXNhZmUtdHJpYW5nbGUtc3VibWVudS1lbmQteSIsIGAke3RvcCArIGhlaWdodH1weGApOwogICAgICB9OwogICAgICAodGhpcy5ob3N0ID0gaG9zdCkuYWRkQ29udHJvbGxlcih0aGlzKTsKICAgICAgdGhpcy5oYXNTbG90Q29udHJvbGxlciA9IGhhc1Nsb3RDb250cm9sbGVyOwogICAgICB0aGlzLmxvY2FsaXplID0gbG9jYWxpemU7CiAgICB9CiAgICBob3N0Q29ubmVjdGVkKCkgewogICAgICBpZiAodGhpcy5oYXNTbG90Q29udHJvbGxlci50ZXN0KCJzdWJtZW51IikgJiYgIXRoaXMuaG9zdC5kaXNhYmxlZCkgewogICAgICAgIHRoaXMuYWRkTGlzdGVuZXJzKCk7CiAgICAgIH0KICAgIH0KICAgIGhvc3REaXNjb25uZWN0ZWQoKSB7CiAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXJzKCk7CiAgICB9CiAgICBob3N0VXBkYXRlZCgpIHsKICAgICAgaWYgKHRoaXMuaGFzU2xvdENvbnRyb2xsZXIudGVzdCgic3VibWVudSIpICYmICF0aGlzLmhvc3QuZGlzYWJsZWQpIHsKICAgICAgICB0aGlzLmFkZExpc3RlbmVycygpOwogICAgICAgIHRoaXMudXBkYXRlU2tpZGRpbmcoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnJlbW92ZUxpc3RlbmVycygpOwogICAgICB9CiAgICB9CiAgICBhZGRMaXN0ZW5lcnMoKSB7CiAgICAgIGlmICghdGhpcy5pc0Nvbm5lY3RlZCkgewogICAgICAgIHRoaXMuaG9zdC5hZGRFdmVudExpc3RlbmVyKCJtb3VzZW1vdmUiLCB0aGlzLmhhbmRsZU1vdXNlTW92ZSk7CiAgICAgICAgdGhpcy5ob3N0LmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlb3ZlciIsIHRoaXMuaGFuZGxlTW91c2VPdmVyKTsKICAgICAgICB0aGlzLmhvc3QuYWRkRXZlbnRMaXN0ZW5lcigia2V5ZG93biIsIHRoaXMuaGFuZGxlS2V5RG93bik7CiAgICAgICAgdGhpcy5ob3N0LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgdGhpcy5oYW5kbGVDbGljayk7CiAgICAgICAgdGhpcy5ob3N0LmFkZEV2ZW50TGlzdGVuZXIoImZvY3Vzb3V0IiwgdGhpcy5oYW5kbGVGb2N1c091dCk7CiAgICAgICAgdGhpcy5pc0Nvbm5lY3RlZCA9IHRydWU7CiAgICAgIH0KICAgICAgaWYgKCF0aGlzLmlzUG9wdXBDb25uZWN0ZWQpIHsKICAgICAgICBpZiAodGhpcy5wb3B1cFJlZi52YWx1ZSkgewogICAgICAgICAgdGhpcy5wb3B1cFJlZi52YWx1ZS5hZGRFdmVudExpc3RlbmVyKCJtb3VzZW92ZXIiLCB0aGlzLmhhbmRsZVBvcHVwTW91c2VvdmVyKTsKICAgICAgICAgIHRoaXMucG9wdXBSZWYudmFsdWUuYWRkRXZlbnRMaXN0ZW5lcigic2wtcmVwb3NpdGlvbiIsIHRoaXMuaGFuZGxlUG9wdXBSZXBvc2l0aW9uKTsKICAgICAgICAgIHRoaXMuaXNQb3B1cENvbm5lY3RlZCA9IHRydWU7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICByZW1vdmVMaXN0ZW5lcnMoKSB7CiAgICAgIGlmICh0aGlzLmlzQ29ubmVjdGVkKSB7CiAgICAgICAgdGhpcy5ob3N0LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1vdXNlbW92ZSIsIHRoaXMuaGFuZGxlTW91c2VNb3ZlKTsKICAgICAgICB0aGlzLmhvc3QucmVtb3ZlRXZlbnRMaXN0ZW5lcigibW91c2VvdmVyIiwgdGhpcy5oYW5kbGVNb3VzZU92ZXIpOwogICAgICAgIHRoaXMuaG9zdC5yZW1vdmVFdmVudExpc3RlbmVyKCJrZXlkb3duIiwgdGhpcy5oYW5kbGVLZXlEb3duKTsKICAgICAgICB0aGlzLmhvc3QucmVtb3ZlRXZlbnRMaXN0ZW5lcigiY2xpY2siLCB0aGlzLmhhbmRsZUNsaWNrKTsKICAgICAgICB0aGlzLmhvc3QucmVtb3ZlRXZlbnRMaXN0ZW5lcigiZm9jdXNvdXQiLCB0aGlzLmhhbmRsZUZvY3VzT3V0KTsKICAgICAgICB0aGlzLmlzQ29ubmVjdGVkID0gZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuaXNQb3B1cENvbm5lY3RlZCkgewogICAgICAgIGlmICh0aGlzLnBvcHVwUmVmLnZhbHVlKSB7CiAgICAgICAgICB0aGlzLnBvcHVwUmVmLnZhbHVlLnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1vdXNlb3ZlciIsIHRoaXMuaGFuZGxlUG9wdXBNb3VzZW92ZXIpOwogICAgICAgICAgdGhpcy5wb3B1cFJlZi52YWx1ZS5yZW1vdmVFdmVudExpc3RlbmVyKCJzbC1yZXBvc2l0aW9uIiwgdGhpcy5oYW5kbGVQb3B1cFJlcG9zaXRpb24pOwogICAgICAgICAgdGhpcy5pc1BvcHVwQ29ubmVjdGVkID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBoYW5kbGVTdWJtZW51RW50cnkoZXZlbnQpIHsKICAgICAgY29uc3Qgc3VibWVudVNsb3QgPSB0aGlzLmhvc3QucmVuZGVyUm9vdC5xdWVyeVNlbGVjdG9yKCJzbG90W25hbWU9J3N1Ym1lbnUnXSIpOwogICAgICBpZiAoIXN1Ym1lbnVTbG90KSB7CiAgICAgICAgY29uc29sZS5lcnJvcigiQ2Fubm90IGFjdGl2YXRlIGEgc3VibWVudSBpZiBubyBjb3JyZXNwb25kaW5nIG1lbnVpdGVtIGNhbiBiZSBmb3VuZC4iLCB0aGlzKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbGV0IG1lbnVJdGVtcyA9IG51bGw7CiAgICAgIGZvciAoY29uc3QgZWx0IG9mIHN1Ym1lbnVTbG90LmFzc2lnbmVkRWxlbWVudHMoKSkgewogICAgICAgIG1lbnVJdGVtcyA9IGVsdC5xdWVyeVNlbGVjdG9yQWxsKCJzbC1tZW51LWl0ZW0sIFtyb2xlXj0nbWVudWl0ZW0nXSIpOwogICAgICAgIGlmIChtZW51SXRlbXMubGVuZ3RoICE9PSAwKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKCFtZW51SXRlbXMgfHwgbWVudUl0ZW1zLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBtZW51SXRlbXNbMF0uc2V0QXR0cmlidXRlKCJ0YWJpbmRleCIsICIwIik7CiAgICAgIGZvciAobGV0IGkgPSAxOyBpICE9PSBtZW51SXRlbXMubGVuZ3RoOyArK2kpIHsKICAgICAgICBtZW51SXRlbXNbaV0uc2V0QXR0cmlidXRlKCJ0YWJpbmRleCIsICItMSIpOwogICAgICB9CiAgICAgIGlmICh0aGlzLnBvcHVwUmVmLnZhbHVlKSB7CiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICBpZiAodGhpcy5wb3B1cFJlZi52YWx1ZS5hY3RpdmUpIHsKICAgICAgICAgIGlmIChtZW51SXRlbXNbMF0gaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkgewogICAgICAgICAgICBtZW51SXRlbXNbMF0uZm9jdXMoKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5lbmFibGVTdWJtZW51KGZhbHNlKTsKICAgICAgICAgIHRoaXMuaG9zdC51cGRhdGVDb21wbGV0ZS50aGVuKCgpID0+IHsKICAgICAgICAgICAgaWYgKG1lbnVJdGVtc1swXSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7CiAgICAgICAgICAgICAgbWVudUl0ZW1zWzBdLmZvY3VzKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5ob3N0LnJlcXVlc3RVcGRhdGUoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHNldFN1Ym1lbnVTdGF0ZShzdGF0ZSkgewogICAgICBpZiAodGhpcy5wb3B1cFJlZi52YWx1ZSkgewogICAgICAgIGlmICh0aGlzLnBvcHVwUmVmLnZhbHVlLmFjdGl2ZSAhPT0gc3RhdGUpIHsKICAgICAgICAgIHRoaXMucG9wdXBSZWYudmFsdWUuYWN0aXZlID0gc3RhdGU7CiAgICAgICAgICB0aGlzLmhvc3QucmVxdWVzdFVwZGF0ZSgpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLy8gU2hvd3MgdGhlIHN1Ym1lbnUuIFN1cHBvcnRzIGRpc2FibGluZyB0aGUgb3BlbmluZyBkZWxheSwgZS5nLiBmb3Iga2V5Ym9hcmQgZXZlbnRzIHRoYXQgd2FudCB0byBzZXQgdGhlIGZvY3VzIHRvIHRoZQogICAgLy8gbmV3bHkgb3BlbmVkIG1lbnUuCiAgICBlbmFibGVTdWJtZW51KGRlbGF5ID0gdHJ1ZSkgewogICAgICBpZiAoZGVsYXkpIHsKICAgICAgICB0aGlzLmVuYWJsZVN1Ym1lbnVUaW1lciA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIHRoaXMuc2V0U3VibWVudVN0YXRlKHRydWUpOwogICAgICAgIH0sIHRoaXMuc3VibWVudU9wZW5EZWxheSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5zZXRTdWJtZW51U3RhdGUodHJ1ZSk7CiAgICAgIH0KICAgIH0KICAgIGRpc2FibGVTdWJtZW51KCkgewogICAgICBjbGVhclRpbWVvdXQodGhpcy5lbmFibGVTdWJtZW51VGltZXIpOwogICAgICB0aGlzLnNldFN1Ym1lbnVTdGF0ZShmYWxzZSk7CiAgICB9CiAgICAvLyBDYWxjdWxhdGUgdGhlIHNwYWNlIHRoZSB0b3Agb2YgYSBtZW51IHRha2VzLXVwLCBmb3IgYWxpZ25pbmcgdGhlIHBvcHVwIG1lbnUtaXRlbSB3aXRoIHRoZSBhY3RpdmF0aW5nIGVsZW1lbnQuCiAgICB1cGRhdGVTa2lkZGluZygpIHsKICAgICAgdmFyIF9hOwogICAgICBpZiAoISgoX2EgPSB0aGlzLmhvc3QucGFyZW50RWxlbWVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmNvbXB1dGVkU3R5bGVNYXApKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnN0IHN0eWxlTWFwID0gdGhpcy5ob3N0LnBhcmVudEVsZW1lbnQuY29tcHV0ZWRTdHlsZU1hcCgpOwogICAgICBjb25zdCBhdHRycyA9IFsicGFkZGluZy10b3AiLCAiYm9yZGVyLXRvcC13aWR0aCIsICJtYXJnaW4tdG9wIl07CiAgICAgIGNvbnN0IHNraWRkaW5nID0gYXR0cnMucmVkdWNlKChhY2N1bXVsYXRvciwgYXR0cikgPT4gewogICAgICAgIHZhciBfYTI7CiAgICAgICAgY29uc3Qgc3R5bGVWYWx1ZSA9IChfYTIgPSBzdHlsZU1hcC5nZXQoYXR0cikpICE9IG51bGwgPyBfYTIgOiBuZXcgQ1NTVW5pdFZhbHVlKDAsICJweCIpOwogICAgICAgIGNvbnN0IHVuaXRWYWx1ZSA9IHN0eWxlVmFsdWUgaW5zdGFuY2VvZiBDU1NVbml0VmFsdWUgPyBzdHlsZVZhbHVlIDogbmV3IENTU1VuaXRWYWx1ZSgwLCAicHgiKTsKICAgICAgICBjb25zdCBweFZhbHVlID0gdW5pdFZhbHVlLnRvKCJweCIpOwogICAgICAgIHJldHVybiBhY2N1bXVsYXRvciAtIHB4VmFsdWUudmFsdWU7CiAgICAgIH0sIDApOwogICAgICB0aGlzLnNraWRkaW5nID0gc2tpZGRpbmc7CiAgICB9CiAgICBpc0V4cGFuZGVkKCkgewogICAgICByZXR1cm4gdGhpcy5wb3B1cFJlZi52YWx1ZSA/IHRoaXMucG9wdXBSZWYudmFsdWUuYWN0aXZlIDogZmFsc2U7CiAgICB9CiAgICByZW5kZXJTdWJtZW51KCkgewogICAgICBjb25zdCBpc0x0ciA9IHRoaXMubG9jYWxpemUuZGlyKCkgPT09ICJsdHIiOwogICAgICBpZiAoIXRoaXMuaXNDb25uZWN0ZWQpIHsKICAgICAgICByZXR1cm4geGAgPHNsb3QgbmFtZT0ic3VibWVudSIgaGlkZGVuPjwvc2xvdD4gYDsKICAgICAgfQogICAgICByZXR1cm4geGAKICAgICAgPHNsLXBvcHVwCiAgICAgICAgJHtuKHRoaXMucG9wdXBSZWYpfQogICAgICAgIHBsYWNlbWVudD0ke2lzTHRyID8gInJpZ2h0LXN0YXJ0IiA6ICJsZWZ0LXN0YXJ0In0KICAgICAgICBhbmNob3I9ImFuY2hvciIKICAgICAgICBmbGlwCiAgICAgICAgZmxpcC1mYWxsYmFjay1zdHJhdGVneT0iYmVzdC1maXQiCiAgICAgICAgc2tpZGRpbmc9IiR7dGhpcy5za2lkZGluZ30iCiAgICAgICAgc3RyYXRlZ3k9ImZpeGVkIgogICAgICA+CiAgICAgICAgPHNsb3QgbmFtZT0ic3VibWVudSI+PC9zbG90PgogICAgICA8L3NsLXBvcHVwPgogICAgYDsKICAgIH0KICB9OwoKICAvLyBzcmMvaW50ZXJuYWwvc2xvdC50cwogIHZhciBIYXNTbG90Q29udHJvbGxlciA9IGNsYXNzIHsKICAgIGNvbnN0cnVjdG9yKGhvc3QsIC4uLnNsb3ROYW1lcykgewogICAgICB0aGlzLnNsb3ROYW1lcyA9IFtdOwogICAgICB0aGlzLmhhbmRsZVNsb3RDaGFuZ2UgPSAoZXZlbnQpID0+IHsKICAgICAgICBjb25zdCBzbG90ID0gZXZlbnQudGFyZ2V0OwogICAgICAgIGlmICh0aGlzLnNsb3ROYW1lcy5pbmNsdWRlcygiW2RlZmF1bHRdIikgJiYgIXNsb3QubmFtZSB8fCBzbG90Lm5hbWUgJiYgdGhpcy5zbG90TmFtZXMuaW5jbHVkZXMoc2xvdC5uYW1lKSkgewogICAgICAgICAgdGhpcy5ob3N0LnJlcXVlc3RVcGRhdGUoKTsKICAgICAgICB9CiAgICAgIH07CiAgICAgICh0aGlzLmhvc3QgPSBob3N0KS5hZGRDb250cm9sbGVyKHRoaXMpOwogICAgICB0aGlzLnNsb3ROYW1lcyA9IHNsb3ROYW1lczsKICAgIH0KICAgIGhhc0RlZmF1bHRTbG90KCkgewogICAgICByZXR1cm4gWy4uLnRoaXMuaG9zdC5jaGlsZE5vZGVzXS5zb21lKChub2RlKSA9PiB7CiAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IG5vZGUuVEVYVF9OT0RFICYmIG5vZGUudGV4dENvbnRlbnQudHJpbSgpICE9PSAiIikgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGlmIChub2RlLm5vZGVUeXBlID09PSBub2RlLkVMRU1FTlRfTk9ERSkgewogICAgICAgICAgY29uc3QgZWwgPSBub2RlOwogICAgICAgICAgY29uc3QgdGFnTmFtZSA9IGVsLnRhZ05hbWUudG9Mb3dlckNhc2UoKTsKICAgICAgICAgIGlmICh0YWdOYW1lID09PSAic2wtdmlzdWFsbHktaGlkZGVuIikgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoIWVsLmhhc0F0dHJpYnV0ZSgic2xvdCIpKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0pOwogICAgfQogICAgaGFzTmFtZWRTbG90KG5hbWUpIHsKICAgICAgcmV0dXJuIHRoaXMuaG9zdC5xdWVyeVNlbGVjdG9yKGA6c2NvcGUgPiBbc2xvdD0iJHtuYW1lfSJdYCkgIT09IG51bGw7CiAgICB9CiAgICB0ZXN0KHNsb3ROYW1lKSB7CiAgICAgIHJldHVybiBzbG90TmFtZSA9PT0gIltkZWZhdWx0XSIgPyB0aGlzLmhhc0RlZmF1bHRTbG90KCkgOiB0aGlzLmhhc05hbWVkU2xvdChzbG90TmFtZSk7CiAgICB9CiAgICBob3N0Q29ubmVjdGVkKCkgewogICAgICB0aGlzLmhvc3Quc2hhZG93Um9vdC5hZGRFdmVudExpc3RlbmVyKCJzbG90Y2hhbmdlIiwgdGhpcy5oYW5kbGVTbG90Q2hhbmdlKTsKICAgIH0KICAgIGhvc3REaXNjb25uZWN0ZWQoKSB7CiAgICAgIHRoaXMuaG9zdC5zaGFkb3dSb290LnJlbW92ZUV2ZW50TGlzdGVuZXIoInNsb3RjaGFuZ2UiLCB0aGlzLmhhbmRsZVNsb3RDaGFuZ2UpOwogICAgfQogIH07CiAgZnVuY3Rpb24gZ2V0VGV4dENvbnRlbnQoc2xvdCkgewogICAgaWYgKCFzbG90KSB7CiAgICAgIHJldHVybiAiIjsKICAgIH0KICAgIGNvbnN0IG5vZGVzID0gc2xvdC5hc3NpZ25lZE5vZGVzKHsgZmxhdHRlbjogdHJ1ZSB9KTsKICAgIGxldCB0ZXh0ID0gIiI7CiAgICBbLi4ubm9kZXNdLmZvckVhY2goKG5vZGUpID0+IHsKICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFKSB7CiAgICAgICAgdGV4dCArPSBub2RlLnRleHRDb250ZW50OwogICAgICB9CiAgICB9KTsKICAgIHJldHVybiB0ZXh0OwogIH0KCiAgdmFyIGljb25fc3R5bGVzX2RlZmF1bHQgPSBpJDNgCiAgJHtjb21wb25lbnRfc3R5bGVzX2RlZmF1bHR9CgogIDpob3N0IHsKICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgIHdpZHRoOiAxZW07CiAgICBoZWlnaHQ6IDFlbTsKICAgIGJveC1zaXppbmc6IGNvbnRlbnQtYm94ICFpbXBvcnRhbnQ7CiAgfQoKICBzdmcgewogICAgZGlzcGxheTogYmxvY2s7CiAgICBoZWlnaHQ6IDEwMCU7CiAgICB3aWR0aDogMTAwJTsKICB9CmA7CgogIC8vIHNyYy91dGlsaXRpZXMvYmFzZS1wYXRoLnRzCiAgdmFyIGJhc2VQYXRoID0gIiI7CiAgZnVuY3Rpb24gc2V0QmFzZVBhdGgocGF0aCkgewogICAgYmFzZVBhdGggPSBwYXRoOwogIH0KICBmdW5jdGlvbiBnZXRCYXNlUGF0aChzdWJwYXRoID0gIiIpIHsKICAgIGlmICghYmFzZVBhdGgpIHsKICAgICAgY29uc3Qgc2NyaXB0cyA9IFsuLi5kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgic2NyaXB0IildOwogICAgICBjb25zdCBjb25maWdTY3JpcHQgPSBzY3JpcHRzLmZpbmQoKHNjcmlwdCkgPT4gc2NyaXB0Lmhhc0F0dHJpYnV0ZSgiZGF0YS1zaG9lbGFjZSIpKTsKICAgICAgaWYgKGNvbmZpZ1NjcmlwdCkgewogICAgICAgIHNldEJhc2VQYXRoKGNvbmZpZ1NjcmlwdC5nZXRBdHRyaWJ1dGUoImRhdGEtc2hvZWxhY2UiKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgZmFsbGJhY2tTY3JpcHQgPSBzY3JpcHRzLmZpbmQoKHMpID0+IHsKICAgICAgICAgIHJldHVybiAvc2hvZWxhY2UoXC5taW4pP1wuanMoJHxcPykvLnRlc3Qocy5zcmMpIHx8IC9zaG9lbGFjZS1hdXRvbG9hZGVyKFwubWluKT9cLmpzKCR8XD8pLy50ZXN0KHMuc3JjKTsKICAgICAgICB9KTsKICAgICAgICBsZXQgcGF0aCA9ICIiOwogICAgICAgIGlmIChmYWxsYmFja1NjcmlwdCkgewogICAgICAgICAgcGF0aCA9IGZhbGxiYWNrU2NyaXB0LmdldEF0dHJpYnV0ZSgic3JjIik7CiAgICAgICAgfQogICAgICAgIHNldEJhc2VQYXRoKHBhdGguc3BsaXQoIi8iKS5zbGljZSgwLCAtMSkuam9pbigiLyIpKTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIGJhc2VQYXRoLnJlcGxhY2UoL1wvJC8sICIiKSArIChzdWJwYXRoID8gYC8ke3N1YnBhdGgucmVwbGFjZSgvXlwvLywgIiIpfWAgOiBgYCk7CiAgfQoKICAvLyBzcmMvY29tcG9uZW50cy9pY29uL2xpYnJhcnkuZGVmYXVsdC50cwogIHZhciBsaWJyYXJ5ID0gewogICAgbmFtZTogImRlZmF1bHQiLAogICAgcmVzb2x2ZXI6IChuYW1lKSA9PiBnZXRCYXNlUGF0aChgYXNzZXRzL2ljb25zLyR7bmFtZX0uc3ZnYCkKICB9OwogIHZhciBsaWJyYXJ5X2RlZmF1bHRfZGVmYXVsdCA9IGxpYnJhcnk7CgogIC8vIHNyYy9jb21wb25lbnRzL2ljb24vbGlicmFyeS5zeXN0ZW0udHMKICB2YXIgaWNvbnMgPSB7CiAgICBjYXJldDogYAogICAgPHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0iY3VycmVudENvbG9yIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+CiAgICAgIDxwb2x5bGluZSBwb2ludHM9IjYgOSAxMiAxNSAxOCA5Ij48L3BvbHlsaW5lPgogICAgPC9zdmc+CiAgYCwKICAgIGNoZWNrOiBgCiAgICA8c3ZnIHBhcnQ9ImNoZWNrZWQtaWNvbiIgY2xhc3M9ImNoZWNrYm94X19pY29uIiB2aWV3Qm94PSIwIDAgMTYgMTYiPgogICAgICA8ZyBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2UtbGluZWNhcD0icm91bmQiPgogICAgICAgIDxnIHN0cm9rZT0iY3VycmVudENvbG9yIj4KICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMuNDI4NTcxLCAzLjQyODU3MSkiPgogICAgICAgICAgICA8cGF0aCBkPSJNMCw1LjcxNDI4NTcxIEwzLjQyODU3MTQzLDkuMTQyODU3MTQiPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTkuMTQyODU3MTQsMCBMMy40Mjg1NzE0Myw5LjE0Mjg1NzE0Ij48L3BhdGg+CiAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgICA8L2c+CiAgICA8L3N2Zz4KICBgLAogICAgImNoZXZyb24tZG93biI6IGAKICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9ImN1cnJlbnRDb2xvciIgY2xhc3M9ImJpIGJpLWNoZXZyb24tZG93biIgdmlld0JveD0iMCAwIDE2IDE2Ij4KICAgICAgPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMS42NDYgNC42NDZhLjUuNSAwIDAgMSAuNzA4IDBMOCAxMC4yOTNsNS42NDYtNS42NDdhLjUuNSAwIDAgMSAuNzA4LjcwOGwtNiA2YS41LjUgMCAwIDEtLjcwOCAwbC02LTZhLjUuNSAwIDAgMSAwLS43MDh6Ii8+CiAgICA8L3N2Zz4KICBgLAogICAgImNoZXZyb24tbGVmdCI6IGAKICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9ImN1cnJlbnRDb2xvciIgY2xhc3M9ImJpIGJpLWNoZXZyb24tbGVmdCIgdmlld0JveD0iMCAwIDE2IDE2Ij4KICAgICAgPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTEuMzU0IDEuNjQ2YS41LjUgMCAwIDEgMCAuNzA4TDUuNzA3IDhsNS42NDcgNS42NDZhLjUuNSAwIDAgMS0uNzA4LjcwOGwtNi02YS41LjUgMCAwIDEgMC0uNzA4bDYtNmEuNS41IDAgMCAxIC43MDggMHoiLz4KICAgIDwvc3ZnPgogIGAsCiAgICAiY2hldnJvbi1yaWdodCI6IGAKICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9ImN1cnJlbnRDb2xvciIgY2xhc3M9ImJpIGJpLWNoZXZyb24tcmlnaHQiIHZpZXdCb3g9IjAgMCAxNiAxNiI+CiAgICAgIDxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTQuNjQ2IDEuNjQ2YS41LjUgMCAwIDEgLjcwOCAwbDYgNmEuNS41IDAgMCAxIDAgLjcwOGwtNiA2YS41LjUgMCAwIDEtLjcwOC0uNzA4TDEwLjI5MyA4IDQuNjQ2IDIuMzU0YS41LjUgMCAwIDEgMC0uNzA4eiIvPgogICAgPC9zdmc+CiAgYCwKICAgIGNvcHk6IGAKICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9ImN1cnJlbnRDb2xvciIgY2xhc3M9ImJpIGJpLWNvcHkiIHZpZXdCb3g9IjAgMCAxNiAxNiI+CiAgICAgIDxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTQgMmEyIDIgMCAwIDEgMi0yaDhhMiAyIDAgMCAxIDIgMnY4YTIgMiAwIDAgMS0yIDJINmEyIDIgMCAwIDEtMi0yVjJabTItMWExIDEgMCAwIDAtMSAxdjhhMSAxIDAgMCAwIDEgMWg4YTEgMSAwIDAgMCAxLTFWMmExIDEgMCAwIDAtMS0xSDZaTTIgNWExIDEgMCAwIDAtMSAxdjhhMSAxIDAgMCAwIDEgMWg4YTEgMSAwIDAgMCAxLTF2LTFoMXYxYTIgMiAwIDAgMS0yIDJIMmEyIDIgMCAwIDEtMi0yVjZhMiAyIDAgMCAxIDItMmgxdjFIMloiLz4KICAgIDwvc3ZnPgogIGAsCiAgICBleWU6IGAKICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9ImN1cnJlbnRDb2xvciIgY2xhc3M9ImJpIGJpLWV5ZSIgdmlld0JveD0iMCAwIDE2IDE2Ij4KICAgICAgPHBhdGggZD0iTTE2IDhzLTMtNS41LTgtNS41UzAgOCAwIDhzMyA1LjUgOCA1LjVTMTYgOCAxNiA4ek0xLjE3MyA4YTEzLjEzMyAxMy4xMzMgMCAwIDEgMS42Ni0yLjA0M0M0LjEyIDQuNjY4IDUuODggMy41IDggMy41YzIuMTIgMCAzLjg3OSAxLjE2OCA1LjE2OCAyLjQ1N0ExMy4xMzMgMTMuMTMzIDAgMCAxIDE0LjgyOCA4Yy0uMDU4LjA4Ny0uMTIyLjE4My0uMTk1LjI4OC0uMzM1LjQ4LS44MyAxLjEyLTEuNDY1IDEuNzU1QzExLjg3OSAxMS4zMzIgMTAuMTE5IDEyLjUgOCAxMi41Yy0yLjEyIDAtMy44NzktMS4xNjgtNS4xNjgtMi40NTdBMTMuMTM0IDEzLjEzNCAwIDAgMSAxLjE3MiA4eiIvPgogICAgICA8cGF0aCBkPSJNOCA1LjVhMi41IDIuNSAwIDEgMCAwIDUgMi41IDIuNSAwIDAgMCAwLTV6TTQuNSA4YTMuNSAzLjUgMCAxIDEgNyAwIDMuNSAzLjUgMCAwIDEtNyAweiIvPgogICAgPC9zdmc+CiAgYCwKICAgICJleWUtc2xhc2giOiBgCiAgICA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiBmaWxsPSJjdXJyZW50Q29sb3IiIGNsYXNzPSJiaSBiaS1leWUtc2xhc2giIHZpZXdCb3g9IjAgMCAxNiAxNiI+CiAgICAgIDxwYXRoIGQ9Ik0xMy4zNTkgMTEuMjM4QzE1LjA2IDkuNzIgMTYgOCAxNiA4cy0zLTUuNS04LTUuNWE3LjAyOCA3LjAyOCAwIDAgMC0yLjc5LjU4OGwuNzcuNzcxQTUuOTQ0IDUuOTQ0IDAgMCAxIDggMy41YzIuMTIgMCAzLjg3OSAxLjE2OCA1LjE2OCAyLjQ1N0ExMy4xMzQgMTMuMTM0IDAgMCAxIDE0LjgyOCA4Yy0uMDU4LjA4Ny0uMTIyLjE4My0uMTk1LjI4OC0uMzM1LjQ4LS44MyAxLjEyLTEuNDY1IDEuNzU1LS4xNjUuMTY1LS4zMzcuMzI4LS41MTcuNDg2bC43MDguNzA5eiIvPgogICAgICA8cGF0aCBkPSJNMTEuMjk3IDkuMTc2YTMuNSAzLjUgMCAwIDAtNC40NzQtNC40NzRsLjgyMy44MjNhMi41IDIuNSAwIDAgMSAyLjgyOSAyLjgyOWwuODIyLjgyMnptLTIuOTQzIDEuMjk5LjgyMi44MjJhMy41IDMuNSAwIDAgMS00LjQ3NC00LjQ3NGwuODIzLjgyM2EyLjUgMi41IDAgMCAwIDIuODI5IDIuODI5eiIvPgogICAgICA8cGF0aCBkPSJNMy4zNSA1LjQ3Yy0uMTguMTYtLjM1My4zMjItLjUxOC40ODdBMTMuMTM0IDEzLjEzNCAwIDAgMCAxLjE3MiA4bC4xOTUuMjg4Yy4zMzUuNDguODMgMS4xMiAxLjQ2NSAxLjc1NUM0LjEyMSAxMS4zMzIgNS44ODEgMTIuNSA4IDEyLjVjLjcxNiAwIDEuMzktLjEzMyAyLjAyLS4zNmwuNzcuNzcyQTcuMDI5IDcuMDI5IDAgMCAxIDggMTMuNUMzIDEzLjUgMCA4IDAgOHMuOTM5LTEuNzIxIDIuNjQxLTMuMjM4bC43MDguNzA5em0xMC4yOTYgOC44ODQtMTItMTIgLjcwOC0uNzA4IDEyIDEyLS43MDguNzA4eiIvPgogICAgPC9zdmc+CiAgYCwKICAgIGV5ZWRyb3BwZXI6IGAKICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9ImN1cnJlbnRDb2xvciIgY2xhc3M9ImJpIGJpLWV5ZWRyb3BwZXIiIHZpZXdCb3g9IjAgMCAxNiAxNiI+CiAgICAgIDxwYXRoIGQ9Ik0xMy4zNTQuNjQ2YTEuMjA3IDEuMjA3IDAgMCAwLTEuNzA4IDBMOC41IDMuNzkzbC0uNjQ2LS42NDdhLjUuNSAwIDEgMC0uNzA4LjcwOEw4LjI5MyA1bC03LjE0NyA3LjE0NkEuNS41IDAgMCAwIDEgMTIuNXYxLjc5M2wtLjg1NC44NTNhLjUuNSAwIDEgMCAuNzA4LjcwN0wxLjcwNyAxNUgzLjVhLjUuNSAwIDAgMCAuMzU0LS4xNDZMMTEgNy43MDdsMS4xNDYgMS4xNDdhLjUuNSAwIDAgMCAuNzA4LS43MDhsLS42NDctLjY0NiAzLjE0Ny0zLjE0NmExLjIwNyAxLjIwNyAwIDAgMCAwLTEuNzA4bC0yLTJ6TTIgMTIuNzA3bDctN0wxMC4yOTMgN2wtNyA3SDJ2LTEuMjkzeiI+PC9wYXRoPgogICAgPC9zdmc+CiAgYCwKICAgICJncmlwLXZlcnRpY2FsIjogYAogICAgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbD0iY3VycmVudENvbG9yIiBjbGFzcz0iYmkgYmktZ3JpcC12ZXJ0aWNhbCIgdmlld0JveD0iMCAwIDE2IDE2Ij4KICAgICAgPHBhdGggZD0iTTcgMmExIDEgMCAxIDEtMiAwIDEgMSAwIDAgMSAyIDB6bTMgMGExIDEgMCAxIDEtMiAwIDEgMSAwIDAgMSAyIDB6TTcgNWExIDEgMCAxIDEtMiAwIDEgMSAwIDAgMSAyIDB6bTMgMGExIDEgMCAxIDEtMiAwIDEgMSAwIDAgMSAyIDB6TTcgOGExIDEgMCAxIDEtMiAwIDEgMSAwIDAgMSAyIDB6bTMgMGExIDEgMCAxIDEtMiAwIDEgMSAwIDAgMSAyIDB6bS0zIDNhMSAxIDAgMSAxLTIgMCAxIDEgMCAwIDEgMiAwem0zIDBhMSAxIDAgMSAxLTIgMCAxIDEgMCAwIDEgMiAwem0tMyAzYTEgMSAwIDEgMS0yIDAgMSAxIDAgMCAxIDIgMHptMyAwYTEgMSAwIDEgMS0yIDAgMSAxIDAgMCAxIDIgMHoiPjwvcGF0aD4KICAgIDwvc3ZnPgogIGAsCiAgICBpbmRldGVybWluYXRlOiBgCiAgICA8c3ZnIHBhcnQ9ImluZGV0ZXJtaW5hdGUtaWNvbiIgY2xhc3M9ImNoZWNrYm94X19pY29uIiB2aWV3Qm94PSIwIDAgMTYgMTYiPgogICAgICA8ZyBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2UtbGluZWNhcD0icm91bmQiPgogICAgICAgIDxnIHN0cm9rZT0iY3VycmVudENvbG9yIiBzdHJva2Utd2lkdGg9IjIiPgogICAgICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMi4yODU3MTQsIDYuODU3MTQzKSI+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMC4yODU3MTQzLDEuMTQyODU3MTQgTDEuMTQyODU3MTQsMS4xNDI4NTcxNCI+PC9wYXRoPgogICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgICAgPC9nPgogICAgPC9zdmc+CiAgYCwKICAgICJwZXJzb24tZmlsbCI6IGAKICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9ImN1cnJlbnRDb2xvciIgY2xhc3M9ImJpIGJpLXBlcnNvbi1maWxsIiB2aWV3Qm94PSIwIDAgMTYgMTYiPgogICAgICA8cGF0aCBkPSJNMyAxNHMtMSAwLTEtMSAxLTQgNi00IDYgMyA2IDQtMSAxLTEgMUgzem01LTZhMyAzIDAgMSAwIDAtNiAzIDMgMCAwIDAgMCA2eiIvPgogICAgPC9zdmc+CiAgYCwKICAgICJwbGF5LWZpbGwiOiBgCiAgICA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiBmaWxsPSJjdXJyZW50Q29sb3IiIGNsYXNzPSJiaSBiaS1wbGF5LWZpbGwiIHZpZXdCb3g9IjAgMCAxNiAxNiI+CiAgICAgIDxwYXRoIGQ9Im0xMS41OTYgOC42OTctNi4zNjMgMy42OTJjLS41NC4zMTMtMS4yMzMtLjA2Ni0xLjIzMy0uNjk3VjQuMzA4YzAtLjYzLjY5Mi0xLjAxIDEuMjMzLS42OTZsNi4zNjMgMy42OTJhLjgwMi44MDIgMCAwIDEgMCAxLjM5M3oiPjwvcGF0aD4KICAgIDwvc3ZnPgogIGAsCiAgICAicGF1c2UtZmlsbCI6IGAKICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9ImN1cnJlbnRDb2xvciIgY2xhc3M9ImJpIGJpLXBhdXNlLWZpbGwiIHZpZXdCb3g9IjAgMCAxNiAxNiI+CiAgICAgIDxwYXRoIGQ9Ik01LjUgMy41QTEuNSAxLjUgMCAwIDEgNyA1djZhMS41IDEuNSAwIDAgMS0zIDBWNWExLjUgMS41IDAgMCAxIDEuNS0xLjV6bTUgMEExLjUgMS41IDAgMCAxIDEyIDV2NmExLjUgMS41IDAgMCAxLTMgMFY1YTEuNSAxLjUgMCAwIDEgMS41LTEuNXoiPjwvcGF0aD4KICAgIDwvc3ZnPgogIGAsCiAgICByYWRpbzogYAogICAgPHN2ZyBwYXJ0PSJjaGVja2VkLWljb24iIGNsYXNzPSJyYWRpb19faWNvbiIgdmlld0JveD0iMCAwIDE2IDE2Ij4KICAgICAgPGcgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgZmlsbD0iY3VycmVudENvbG9yIj4KICAgICAgICAgIDxjaXJjbGUgY3g9IjgiIGN5PSI4IiByPSIzLjQyODU3MTQzIj48L2NpcmNsZT4KICAgICAgICA8L2c+CiAgICAgIDwvZz4KICAgIDwvc3ZnPgogIGAsCiAgICAic3Rhci1maWxsIjogYAogICAgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbD0iY3VycmVudENvbG9yIiBjbGFzcz0iYmkgYmktc3Rhci1maWxsIiB2aWV3Qm94PSIwIDAgMTYgMTYiPgogICAgICA8cGF0aCBkPSJNMy42MTIgMTUuNDQzYy0uMzg2LjE5OC0uODI0LS4xNDktLjc0Ni0uNTkybC44My00LjczTC4xNzMgNi43NjVjLS4zMjktLjMxNC0uMTU4LS44ODguMjgzLS45NWw0Ljg5OC0uNjk2TDcuNTM4Ljc5MmMuMTk3LS4zOS43My0uMzkuOTI3IDBsMi4xODQgNC4zMjcgNC44OTguNjk2Yy40NDEuMDYyLjYxMi42MzYuMjgyLjk1bC0zLjUyMiAzLjM1Ni44MyA0LjczYy4wNzguNDQzLS4zNi43OS0uNzQ2LjU5Mkw4IDEzLjE4N2wtNC4zODkgMi4yNTZ6Ii8+CiAgICA8L3N2Zz4KICBgLAogICAgIngtbGciOiBgCiAgICA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiBmaWxsPSJjdXJyZW50Q29sb3IiIGNsYXNzPSJiaSBiaS14LWxnIiB2aWV3Qm94PSIwIDAgMTYgMTYiPgogICAgICA8cGF0aCBkPSJNMi4xNDYgMi44NTRhLjUuNSAwIDEgMSAuNzA4LS43MDhMOCA3LjI5M2w1LjE0Ni01LjE0N2EuNS41IDAgMCAxIC43MDguNzA4TDguNzA3IDhsNS4xNDcgNS4xNDZhLjUuNSAwIDAgMS0uNzA4LjcwOEw4IDguNzA3bC01LjE0NiA1LjE0N2EuNS41IDAgMCAxLS43MDgtLjcwOEw3LjI5MyA4IDIuMTQ2IDIuODU0WiIvPgogICAgPC9zdmc+CiAgYCwKICAgICJ4LWNpcmNsZS1maWxsIjogYAogICAgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbD0iY3VycmVudENvbG9yIiBjbGFzcz0iYmkgYmkteC1jaXJjbGUtZmlsbCIgdmlld0JveD0iMCAwIDE2IDE2Ij4KICAgICAgPHBhdGggZD0iTTE2IDhBOCA4IDAgMSAxIDAgOGE4IDggMCAwIDEgMTYgMHpNNS4zNTQgNC42NDZhLjUuNSAwIDEgMC0uNzA4LjcwOEw3LjI5MyA4bC0yLjY0NyAyLjY0NmEuNS41IDAgMCAwIC43MDguNzA4TDggOC43MDdsMi42NDYgMi42NDdhLjUuNSAwIDAgMCAuNzA4LS43MDhMOC43MDcgOGwyLjY0Ny0yLjY0NmEuNS41IDAgMCAwLS43MDgtLjcwOEw4IDcuMjkzIDUuMzU0IDQuNjQ2eiI+PC9wYXRoPgogICAgPC9zdmc+CiAgYAogIH07CiAgdmFyIHN5c3RlbUxpYnJhcnkgPSB7CiAgICBuYW1lOiAic3lzdGVtIiwKICAgIHJlc29sdmVyOiAobmFtZSkgPT4gewogICAgICBpZiAobmFtZSBpbiBpY29ucykgewogICAgICAgIHJldHVybiBgZGF0YTppbWFnZS9zdmcreG1sLCR7ZW5jb2RlVVJJQ29tcG9uZW50KGljb25zW25hbWVdKX1gOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0KICB9OwogIHZhciBsaWJyYXJ5X3N5c3RlbV9kZWZhdWx0ID0gc3lzdGVtTGlicmFyeTsKCiAgLy8gc3JjL2NvbXBvbmVudHMvaWNvbi9saWJyYXJ5LnRzCiAgdmFyIHJlZ2lzdHJ5ID0gW2xpYnJhcnlfZGVmYXVsdF9kZWZhdWx0LCBsaWJyYXJ5X3N5c3RlbV9kZWZhdWx0XTsKICB2YXIgd2F0Y2hlZEljb25zID0gW107CiAgZnVuY3Rpb24gd2F0Y2hJY29uKGljb24pIHsKICAgIHdhdGNoZWRJY29ucy5wdXNoKGljb24pOwogIH0KICBmdW5jdGlvbiB1bndhdGNoSWNvbihpY29uKSB7CiAgICB3YXRjaGVkSWNvbnMgPSB3YXRjaGVkSWNvbnMuZmlsdGVyKChlbCkgPT4gZWwgIT09IGljb24pOwogIH0KICBmdW5jdGlvbiBnZXRJY29uTGlicmFyeShuYW1lKSB7CiAgICByZXR1cm4gcmVnaXN0cnkuZmluZCgobGliKSA9PiBsaWIubmFtZSA9PT0gbmFtZSk7CiAgfQoKICB2YXIgQ0FDSEVBQkxFX0VSUk9SID0gU3ltYm9sKCk7CiAgdmFyIFJFVFJZQUJMRV9FUlJPUiA9IFN5bWJvbCgpOwogIHZhciBwYXJzZXI7CiAgdmFyIGljb25DYWNoZSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgdmFyIFNsSWNvbiA9IGNsYXNzIGV4dGVuZHMgU2hvZWxhY2VFbGVtZW50IHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlciguLi5hcmd1bWVudHMpOwogICAgICB0aGlzLmluaXRpYWxSZW5kZXIgPSBmYWxzZTsKICAgICAgdGhpcy5zdmcgPSBudWxsOwogICAgICB0aGlzLmxhYmVsID0gIiI7CiAgICAgIHRoaXMubGlicmFyeSA9ICJkZWZhdWx0IjsKICAgIH0KICAgIC8qKiBHaXZlbiBhIFVSTCwgdGhpcyBmdW5jdGlvbiByZXR1cm5zIHRoZSByZXN1bHRpbmcgU1ZHIGVsZW1lbnQgb3IgYW4gYXBwcm9wcmlhdGUgZXJyb3Igc3ltYm9sLiAqLwogICAgYXN5bmMgcmVzb2x2ZUljb24odXJsLCBsaWJyYXJ5KSB7CiAgICAgIHZhciBfYTsKICAgICAgbGV0IGZpbGVEYXRhOwogICAgICBpZiAobGlicmFyeSA9PSBudWxsID8gdm9pZCAwIDogbGlicmFyeS5zcHJpdGVTaGVldCkgewogICAgICAgIHJldHVybiB4YDxzdmcgcGFydD0ic3ZnIj4KICAgICAgICA8dXNlIHBhcnQ9InVzZSIgaHJlZj0iJHt1cmx9Ij48L3VzZT4KICAgICAgPC9zdmc+YDsKICAgICAgfQogICAgICB0cnkgewogICAgICAgIGZpbGVEYXRhID0gYXdhaXQgZmV0Y2godXJsLCB7IG1vZGU6ICJjb3JzIiB9KTsKICAgICAgICBpZiAoIWZpbGVEYXRhLm9rKQogICAgICAgICAgcmV0dXJuIGZpbGVEYXRhLnN0YXR1cyA9PT0gNDEwID8gQ0FDSEVBQkxFX0VSUk9SIDogUkVUUllBQkxFX0VSUk9SOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgcmV0dXJuIFJFVFJZQUJMRV9FUlJPUjsKICAgICAgfQogICAgICB0cnkgewogICAgICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgIGRpdi5pbm5lckhUTUwgPSBhd2FpdCBmaWxlRGF0YS50ZXh0KCk7CiAgICAgICAgY29uc3Qgc3ZnID0gZGl2LmZpcnN0RWxlbWVudENoaWxkOwogICAgICAgIGlmICgoKF9hID0gc3ZnID09IG51bGwgPyB2b2lkIDAgOiBzdmcudGFnTmFtZSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLnRvTG93ZXJDYXNlKCkpICE9PSAic3ZnIikKICAgICAgICAgIHJldHVybiBDQUNIRUFCTEVfRVJST1I7CiAgICAgICAgaWYgKCFwYXJzZXIpCiAgICAgICAgICBwYXJzZXIgPSBuZXcgRE9NUGFyc2VyKCk7CiAgICAgICAgY29uc3QgZG9jID0gcGFyc2VyLnBhcnNlRnJvbVN0cmluZyhzdmcub3V0ZXJIVE1MLCAidGV4dC9odG1sIik7CiAgICAgICAgY29uc3Qgc3ZnRWwgPSBkb2MuYm9keS5xdWVyeVNlbGVjdG9yKCJzdmciKTsKICAgICAgICBpZiAoIXN2Z0VsKQogICAgICAgICAgcmV0dXJuIENBQ0hFQUJMRV9FUlJPUjsKICAgICAgICBzdmdFbC5wYXJ0LmFkZCgic3ZnIik7CiAgICAgICAgcmV0dXJuIGRvY3VtZW50LmFkb3B0Tm9kZShzdmdFbCk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICByZXR1cm4gQ0FDSEVBQkxFX0VSUk9SOwogICAgICB9CiAgICB9CiAgICBjb25uZWN0ZWRDYWxsYmFjaygpIHsKICAgICAgc3VwZXIuY29ubmVjdGVkQ2FsbGJhY2soKTsKICAgICAgd2F0Y2hJY29uKHRoaXMpOwogICAgfQogICAgZmlyc3RVcGRhdGVkKCkgewogICAgICB0aGlzLmluaXRpYWxSZW5kZXIgPSB0cnVlOwogICAgICB0aGlzLnNldEljb24oKTsKICAgIH0KICAgIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkgewogICAgICBzdXBlci5kaXNjb25uZWN0ZWRDYWxsYmFjaygpOwogICAgICB1bndhdGNoSWNvbih0aGlzKTsKICAgIH0KICAgIGdldEljb25Tb3VyY2UoKSB7CiAgICAgIGNvbnN0IGxpYnJhcnkgPSBnZXRJY29uTGlicmFyeSh0aGlzLmxpYnJhcnkpOwogICAgICBpZiAodGhpcy5uYW1lICYmIGxpYnJhcnkpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgdXJsOiBsaWJyYXJ5LnJlc29sdmVyKHRoaXMubmFtZSksCiAgICAgICAgICBmcm9tTGlicmFyeTogdHJ1ZQogICAgICAgIH07CiAgICAgIH0KICAgICAgcmV0dXJuIHsKICAgICAgICB1cmw6IHRoaXMuc3JjLAogICAgICAgIGZyb21MaWJyYXJ5OiBmYWxzZQogICAgICB9OwogICAgfQogICAgaGFuZGxlTGFiZWxDaGFuZ2UoKSB7CiAgICAgIGNvbnN0IGhhc0xhYmVsID0gdHlwZW9mIHRoaXMubGFiZWwgPT09ICJzdHJpbmciICYmIHRoaXMubGFiZWwubGVuZ3RoID4gMDsKICAgICAgaWYgKGhhc0xhYmVsKSB7CiAgICAgICAgdGhpcy5zZXRBdHRyaWJ1dGUoInJvbGUiLCAiaW1nIik7CiAgICAgICAgdGhpcy5zZXRBdHRyaWJ1dGUoImFyaWEtbGFiZWwiLCB0aGlzLmxhYmVsKTsKICAgICAgICB0aGlzLnJlbW92ZUF0dHJpYnV0ZSgiYXJpYS1oaWRkZW4iKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnJlbW92ZUF0dHJpYnV0ZSgicm9sZSIpOwogICAgICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlKCJhcmlhLWxhYmVsIik7CiAgICAgICAgdGhpcy5zZXRBdHRyaWJ1dGUoImFyaWEtaGlkZGVuIiwgInRydWUiKTsKICAgICAgfQogICAgfQogICAgYXN5bmMgc2V0SWNvbigpIHsKICAgICAgdmFyIF9hOwogICAgICBjb25zdCB7IHVybCwgZnJvbUxpYnJhcnkgfSA9IHRoaXMuZ2V0SWNvblNvdXJjZSgpOwogICAgICBjb25zdCBsaWJyYXJ5ID0gZnJvbUxpYnJhcnkgPyBnZXRJY29uTGlicmFyeSh0aGlzLmxpYnJhcnkpIDogdm9pZCAwOwogICAgICBpZiAoIXVybCkgewogICAgICAgIHRoaXMuc3ZnID0gbnVsbDsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbGV0IGljb25SZXNvbHZlciA9IGljb25DYWNoZS5nZXQodXJsKTsKICAgICAgaWYgKCFpY29uUmVzb2x2ZXIpIHsKICAgICAgICBpY29uUmVzb2x2ZXIgPSB0aGlzLnJlc29sdmVJY29uKHVybCwgbGlicmFyeSk7CiAgICAgICAgaWNvbkNhY2hlLnNldCh1cmwsIGljb25SZXNvbHZlcik7CiAgICAgIH0KICAgICAgaWYgKCF0aGlzLmluaXRpYWxSZW5kZXIpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgY29uc3Qgc3ZnID0gYXdhaXQgaWNvblJlc29sdmVyOwogICAgICBpZiAoc3ZnID09PSBSRVRSWUFCTEVfRVJST1IpIHsKICAgICAgICBpY29uQ2FjaGUuZGVsZXRlKHVybCk7CiAgICAgIH0KICAgICAgaWYgKHVybCAhPT0gdGhpcy5nZXRJY29uU291cmNlKCkudXJsKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmIChlJDEoc3ZnKSkgewogICAgICAgIHRoaXMuc3ZnID0gc3ZnOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBzd2l0Y2ggKHN2ZykgewogICAgICAgIGNhc2UgUkVUUllBQkxFX0VSUk9SOgogICAgICAgIGNhc2UgQ0FDSEVBQkxFX0VSUk9SOgogICAgICAgICAgdGhpcy5zdmcgPSBudWxsOwogICAgICAgICAgdGhpcy5lbWl0KCJzbC1lcnJvciIpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHRoaXMuc3ZnID0gc3ZnLmNsb25lTm9kZSh0cnVlKTsKICAgICAgICAgIChfYSA9IGxpYnJhcnkgPT0gbnVsbCA/IHZvaWQgMCA6IGxpYnJhcnkubXV0YXRvcikgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmNhbGwobGlicmFyeSwgdGhpcy5zdmcpOwogICAgICAgICAgdGhpcy5lbWl0KCJzbC1sb2FkIik7CiAgICAgIH0KICAgIH0KICAgIHJlbmRlcigpIHsKICAgICAgcmV0dXJuIHRoaXMuc3ZnOwogICAgfQogIH07CiAgU2xJY29uLnN0eWxlcyA9IGljb25fc3R5bGVzX2RlZmF1bHQ7CiAgX19kZWNvcmF0ZUNsYXNzKFsKICAgIHIkMSgpCiAgXSwgU2xJY29uLnByb3RvdHlwZSwgInN2ZyIsIDIpOwogIF9fZGVjb3JhdGVDbGFzcyhbCiAgICBuJDIoeyByZWZsZWN0OiB0cnVlIH0pCiAgXSwgU2xJY29uLnByb3RvdHlwZSwgIm5hbWUiLCAyKTsKICBfX2RlY29yYXRlQ2xhc3MoWwogICAgbiQyKCkKICBdLCBTbEljb24ucHJvdG90eXBlLCAic3JjIiwgMik7CiAgX19kZWNvcmF0ZUNsYXNzKFsKICAgIG4kMigpCiAgXSwgU2xJY29uLnByb3RvdHlwZSwgImxhYmVsIiwgMik7CiAgX19kZWNvcmF0ZUNsYXNzKFsKICAgIG4kMih7IHJlZmxlY3Q6IHRydWUgfSkKICBdLCBTbEljb24ucHJvdG90eXBlLCAibGlicmFyeSIsIDIpOwogIF9fZGVjb3JhdGVDbGFzcyhbCiAgICB3YXRjaCgibGFiZWwiKQogIF0sIFNsSWNvbi5wcm90b3R5cGUsICJoYW5kbGVMYWJlbENoYW5nZSIsIDEpOwogIF9fZGVjb3JhdGVDbGFzcyhbCiAgICB3YXRjaChbIm5hbWUiLCAic3JjIiwgImxpYnJhcnkiXSkKICBdLCBTbEljb24ucHJvdG90eXBlLCAic2V0SWNvbiIsIDEpOwoKICB2YXIgU2xNZW51SXRlbSA9IGNsYXNzIGV4dGVuZHMgU2hvZWxhY2VFbGVtZW50IHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlciguLi5hcmd1bWVudHMpOwogICAgICB0aGlzLnR5cGUgPSAibm9ybWFsIjsKICAgICAgdGhpcy5jaGVja2VkID0gZmFsc2U7CiAgICAgIHRoaXMudmFsdWUgPSAiIjsKICAgICAgdGhpcy5kaXNhYmxlZCA9IGZhbHNlOwogICAgICB0aGlzLmxvY2FsaXplID0gbmV3IExvY2FsaXplQ29udHJvbGxlcih0aGlzKTsKICAgICAgdGhpcy5oYXNTbG90Q29udHJvbGxlciA9IG5ldyBIYXNTbG90Q29udHJvbGxlcih0aGlzLCAic3VibWVudSIpOwogICAgICB0aGlzLnN1Ym1lbnVDb250cm9sbGVyID0gbmV3IFN1Ym1lbnVDb250cm9sbGVyKHRoaXMsIHRoaXMuaGFzU2xvdENvbnRyb2xsZXIsIHRoaXMubG9jYWxpemUpOwogICAgICB0aGlzLmhhbmRsZUhvc3RDbGljayA9IChldmVudCkgPT4gewogICAgICAgIGlmICh0aGlzLmRpc2FibGVkKSB7CiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7CiAgICAgICAgfQogICAgICB9OwogICAgICB0aGlzLmhhbmRsZU1vdXNlT3ZlciA9IChldmVudCkgPT4gewogICAgICAgIHRoaXMuZm9jdXMoKTsKICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgfTsKICAgIH0KICAgIGNvbm5lY3RlZENhbGxiYWNrKCkgewogICAgICBzdXBlci5jb25uZWN0ZWRDYWxsYmFjaygpOwogICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgdGhpcy5oYW5kbGVIb3N0Q2xpY2spOwogICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlb3ZlciIsIHRoaXMuaGFuZGxlTW91c2VPdmVyKTsKICAgIH0KICAgIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkgewogICAgICBzdXBlci5kaXNjb25uZWN0ZWRDYWxsYmFjaygpOwogICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoImNsaWNrIiwgdGhpcy5oYW5kbGVIb3N0Q2xpY2spOwogICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1vdXNlb3ZlciIsIHRoaXMuaGFuZGxlTW91c2VPdmVyKTsKICAgIH0KICAgIGhhbmRsZURlZmF1bHRTbG90Q2hhbmdlKCkgewogICAgICBjb25zdCB0ZXh0TGFiZWwgPSB0aGlzLmdldFRleHRMYWJlbCgpOwogICAgICBpZiAodHlwZW9mIHRoaXMuY2FjaGVkVGV4dExhYmVsID09PSAidW5kZWZpbmVkIikgewogICAgICAgIHRoaXMuY2FjaGVkVGV4dExhYmVsID0gdGV4dExhYmVsOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAodGV4dExhYmVsICE9PSB0aGlzLmNhY2hlZFRleHRMYWJlbCkgewogICAgICAgIHRoaXMuY2FjaGVkVGV4dExhYmVsID0gdGV4dExhYmVsOwogICAgICAgIHRoaXMuZW1pdCgic2xvdGNoYW5nZSIsIHsgYnViYmxlczogdHJ1ZSwgY29tcG9zZWQ6IGZhbHNlLCBjYW5jZWxhYmxlOiBmYWxzZSB9KTsKICAgICAgfQogICAgfQogICAgaGFuZGxlQ2hlY2tlZENoYW5nZSgpIHsKICAgICAgaWYgKHRoaXMuY2hlY2tlZCAmJiB0aGlzLnR5cGUgIT09ICJjaGVja2JveCIpIHsKICAgICAgICB0aGlzLmNoZWNrZWQgPSBmYWxzZTsKICAgICAgICBjb25zb2xlLmVycm9yKCdUaGUgY2hlY2tlZCBhdHRyaWJ1dGUgY2FuIG9ubHkgYmUgdXNlZCBvbiBtZW51IGl0ZW1zIHdpdGggdHlwZT0iY2hlY2tib3giJywgdGhpcyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmICh0aGlzLnR5cGUgPT09ICJjaGVja2JveCIpIHsKICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZSgiYXJpYS1jaGVja2VkIiwgdGhpcy5jaGVja2VkID8gInRydWUiIDogImZhbHNlIik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5yZW1vdmVBdHRyaWJ1dGUoImFyaWEtY2hlY2tlZCIpOwogICAgICB9CiAgICB9CiAgICBoYW5kbGVEaXNhYmxlZENoYW5nZSgpIHsKICAgICAgdGhpcy5zZXRBdHRyaWJ1dGUoImFyaWEtZGlzYWJsZWQiLCB0aGlzLmRpc2FibGVkID8gInRydWUiIDogImZhbHNlIik7CiAgICB9CiAgICBoYW5kbGVUeXBlQ2hhbmdlKCkgewogICAgICBpZiAodGhpcy50eXBlID09PSAiY2hlY2tib3giKSB7CiAgICAgICAgdGhpcy5zZXRBdHRyaWJ1dGUoInJvbGUiLCAibWVudWl0ZW1jaGVja2JveCIpOwogICAgICAgIHRoaXMuc2V0QXR0cmlidXRlKCJhcmlhLWNoZWNrZWQiLCB0aGlzLmNoZWNrZWQgPyAidHJ1ZSIgOiAiZmFsc2UiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZSgicm9sZSIsICJtZW51aXRlbSIpOwogICAgICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlKCJhcmlhLWNoZWNrZWQiKTsKICAgICAgfQogICAgfQogICAgLyoqIFJldHVybnMgYSB0ZXh0IGxhYmVsIGJhc2VkIG9uIHRoZSBjb250ZW50cyBvZiB0aGUgbWVudSBpdGVtJ3MgZGVmYXVsdCBzbG90LiAqLwogICAgZ2V0VGV4dExhYmVsKCkgewogICAgICByZXR1cm4gZ2V0VGV4dENvbnRlbnQodGhpcy5kZWZhdWx0U2xvdCk7CiAgICB9CiAgICBpc1N1Ym1lbnUoKSB7CiAgICAgIHJldHVybiB0aGlzLmhhc1Nsb3RDb250cm9sbGVyLnRlc3QoInN1Ym1lbnUiKTsKICAgIH0KICAgIHJlbmRlcigpIHsKICAgICAgY29uc3QgaXNSdGwgPSB0aGlzLmxvY2FsaXplLmRpcigpID09PSAicnRsIjsKICAgICAgY29uc3QgaXNTdWJtZW51RXhwYW5kZWQgPSB0aGlzLnN1Ym1lbnVDb250cm9sbGVyLmlzRXhwYW5kZWQoKTsKICAgICAgcmV0dXJuIHhgCiAgICAgIDxkaXYKICAgICAgICBpZD0iYW5jaG9yIgogICAgICAgIHBhcnQ9ImJhc2UiCiAgICAgICAgY2xhc3M9JHtlJDIoewogICAgICAibWVudS1pdGVtIjogdHJ1ZSwKICAgICAgIm1lbnUtaXRlbS0tcnRsIjogaXNSdGwsCiAgICAgICJtZW51LWl0ZW0tLWNoZWNrZWQiOiB0aGlzLmNoZWNrZWQsCiAgICAgICJtZW51LWl0ZW0tLWRpc2FibGVkIjogdGhpcy5kaXNhYmxlZCwKICAgICAgIm1lbnUtaXRlbS0taGFzLXN1Ym1lbnUiOiB0aGlzLmlzU3VibWVudSgpLAogICAgICAibWVudS1pdGVtLS1zdWJtZW51LWV4cGFuZGVkIjogaXNTdWJtZW51RXhwYW5kZWQKICAgIH0pfQogICAgICAgID9hcmlhLWhhc3BvcHVwPSIke3RoaXMuaXNTdWJtZW51KCl9IgogICAgICAgID9hcmlhLWV4cGFuZGVkPSIke2lzU3VibWVudUV4cGFuZGVkID8gdHJ1ZSA6IGZhbHNlfSIKICAgICAgPgogICAgICAgIDxzcGFuIHBhcnQ9ImNoZWNrZWQtaWNvbiIgY2xhc3M9Im1lbnUtaXRlbV9fY2hlY2siPgogICAgICAgICAgPHNsLWljb24gbmFtZT0iY2hlY2siIGxpYnJhcnk9InN5c3RlbSIgYXJpYS1oaWRkZW49InRydWUiPjwvc2wtaWNvbj4KICAgICAgICA8L3NwYW4+CgogICAgICAgIDxzbG90IG5hbWU9InByZWZpeCIgcGFydD0icHJlZml4IiBjbGFzcz0ibWVudS1pdGVtX19wcmVmaXgiPjwvc2xvdD4KCiAgICAgICAgPHNsb3QgcGFydD0ibGFiZWwiIGNsYXNzPSJtZW51LWl0ZW1fX2xhYmVsIiBAc2xvdGNoYW5nZT0ke3RoaXMuaGFuZGxlRGVmYXVsdFNsb3RDaGFuZ2V9Pjwvc2xvdD4KCiAgICAgICAgPHNsb3QgbmFtZT0ic3VmZml4IiBwYXJ0PSJzdWZmaXgiIGNsYXNzPSJtZW51LWl0ZW1fX3N1ZmZpeCI+PC9zbG90PgoKICAgICAgICA8c3BhbiBwYXJ0PSJzdWJtZW51LWljb24iIGNsYXNzPSJtZW51LWl0ZW1fX2NoZXZyb24iPgogICAgICAgICAgPHNsLWljb24gbmFtZT0ke2lzUnRsID8gImNoZXZyb24tbGVmdCIgOiAiY2hldnJvbi1yaWdodCJ9IGxpYnJhcnk9InN5c3RlbSIgYXJpYS1oaWRkZW49InRydWUiPjwvc2wtaWNvbj4KICAgICAgICA8L3NwYW4+CgogICAgICAgICR7dGhpcy5zdWJtZW51Q29udHJvbGxlci5yZW5kZXJTdWJtZW51KCl9CiAgICAgIDwvZGl2PgogICAgYDsKICAgIH0KICB9OwogIFNsTWVudUl0ZW0uc3R5bGVzID0gbWVudV9pdGVtX3N0eWxlc19kZWZhdWx0OwogIFNsTWVudUl0ZW0uZGVwZW5kZW5jaWVzID0gewogICAgInNsLWljb24iOiBTbEljb24sCiAgICAic2wtcG9wdXAiOiBTbFBvcHVwCiAgfTsKICBfX2RlY29yYXRlQ2xhc3MoWwogICAgZSQ0KCJzbG90Om5vdChbbmFtZV0pIikKICBdLCBTbE1lbnVJdGVtLnByb3RvdHlwZSwgImRlZmF1bHRTbG90IiwgMik7CiAgX19kZWNvcmF0ZUNsYXNzKFsKICAgIGUkNCgiLm1lbnUtaXRlbSIpCiAgXSwgU2xNZW51SXRlbS5wcm90b3R5cGUsICJtZW51SXRlbSIsIDIpOwogIF9fZGVjb3JhdGVDbGFzcyhbCiAgICBuJDIoKQogIF0sIFNsTWVudUl0ZW0ucHJvdG90eXBlLCAidHlwZSIsIDIpOwogIF9fZGVjb3JhdGVDbGFzcyhbCiAgICBuJDIoeyB0eXBlOiBCb29sZWFuLCByZWZsZWN0OiB0cnVlIH0pCiAgXSwgU2xNZW51SXRlbS5wcm90b3R5cGUsICJjaGVja2VkIiwgMik7CiAgX19kZWNvcmF0ZUNsYXNzKFsKICAgIG4kMigpCiAgXSwgU2xNZW51SXRlbS5wcm90b3R5cGUsICJ2YWx1ZSIsIDIpOwogIF9fZGVjb3JhdGVDbGFzcyhbCiAgICBuJDIoeyB0eXBlOiBCb29sZWFuLCByZWZsZWN0OiB0cnVlIH0pCiAgXSwgU2xNZW51SXRlbS5wcm90b3R5cGUsICJkaXNhYmxlZCIsIDIpOwogIF9fZGVjb3JhdGVDbGFzcyhbCiAgICB3YXRjaCgiY2hlY2tlZCIpCiAgXSwgU2xNZW51SXRlbS5wcm90b3R5cGUsICJoYW5kbGVDaGVja2VkQ2hhbmdlIiwgMSk7CiAgX19kZWNvcmF0ZUNsYXNzKFsKICAgIHdhdGNoKCJkaXNhYmxlZCIpCiAgXSwgU2xNZW51SXRlbS5wcm90b3R5cGUsICJoYW5kbGVEaXNhYmxlZENoYW5nZSIsIDEpOwogIF9fZGVjb3JhdGVDbGFzcyhbCiAgICB3YXRjaCgidHlwZSIpCiAgXSwgU2xNZW51SXRlbS5wcm90b3R5cGUsICJoYW5kbGVUeXBlQ2hhbmdlIiwgMSk7CgogIFNsTWVudUl0ZW0uZGVmaW5lKCJzbC1tZW51LWl0ZW0iKTsKCiAgdmFyIG1lbnVfbGFiZWxfc3R5bGVzX2RlZmF1bHQgPSBpJDNgCiAgJHtjb21wb25lbnRfc3R5bGVzX2RlZmF1bHR9CgogIDpob3N0IHsKICAgIGRpc3BsYXk6IGJsb2NrOwogIH0KCiAgLm1lbnUtbGFiZWwgewogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgZm9udC1mYW1pbHk6IHZhcigtLXNsLWZvbnQtc2Fucyk7CiAgICBmb250LXNpemU6IHZhcigtLXNsLWZvbnQtc2l6ZS1zbWFsbCk7CiAgICBmb250LXdlaWdodDogdmFyKC0tc2wtZm9udC13ZWlnaHQtc2VtaWJvbGQpOwogICAgbGluZS1oZWlnaHQ6IHZhcigtLXNsLWxpbmUtaGVpZ2h0LW5vcm1hbCk7CiAgICBsZXR0ZXItc3BhY2luZzogdmFyKC0tc2wtbGV0dGVyLXNwYWNpbmctbm9ybWFsKTsKICAgIGNvbG9yOiB2YXIoLS1zbC1jb2xvci1uZXV0cmFsLTUwMCk7CiAgICBwYWRkaW5nOiB2YXIoLS1zbC1zcGFjaW5nLTJ4LXNtYWxsKSB2YXIoLS1zbC1zcGFjaW5nLXgtbGFyZ2UpOwogICAgdXNlci1zZWxlY3Q6IG5vbmU7CiAgICAtd2Via2l0LXVzZXItc2VsZWN0OiBub25lOwogIH0KYDsKCiAgdmFyIFNsTWVudUxhYmVsID0gY2xhc3MgZXh0ZW5kcyBTaG9lbGFjZUVsZW1lbnQgewogICAgcmVuZGVyKCkgewogICAgICByZXR1cm4geGAgPHNsb3QgcGFydD0iYmFzZSIgY2xhc3M9Im1lbnUtbGFiZWwiPjwvc2xvdD4gYDsKICAgIH0KICB9OwogIFNsTWVudUxhYmVsLnN0eWxlcyA9IG1lbnVfbGFiZWxfc3R5bGVzX2RlZmF1bHQ7CgogIFNsTWVudUxhYmVsLmRlZmluZSgic2wtbWVudS1sYWJlbCIpOwoKICBTbEljb24uZGVmaW5lKCJzbC1pY29uIik7CgogIHZhciBkaXZpZGVyX3N0eWxlc19kZWZhdWx0ID0gaSQzYAogICR7Y29tcG9uZW50X3N0eWxlc19kZWZhdWx0fQoKICA6aG9zdCB7CiAgICAtLWNvbG9yOiB2YXIoLS1zbC1wYW5lbC1ib3JkZXItY29sb3IpOwogICAgLS13aWR0aDogdmFyKC0tc2wtcGFuZWwtYm9yZGVyLXdpZHRoKTsKICAgIC0tc3BhY2luZzogdmFyKC0tc2wtc3BhY2luZy1tZWRpdW0pOwogIH0KCiAgOmhvc3QoOm5vdChbdmVydGljYWxdKSkgewogICAgZGlzcGxheTogYmxvY2s7CiAgICBib3JkZXItdG9wOiBzb2xpZCB2YXIoLS13aWR0aCkgdmFyKC0tY29sb3IpOwogICAgbWFyZ2luOiB2YXIoLS1zcGFjaW5nKSAwOwogIH0KCiAgOmhvc3QoW3ZlcnRpY2FsXSkgewogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgaGVpZ2h0OiAxMDAlOwogICAgYm9yZGVyLWxlZnQ6IHNvbGlkIHZhcigtLXdpZHRoKSB2YXIoLS1jb2xvcik7CiAgICBtYXJnaW46IDAgdmFyKC0tc3BhY2luZyk7CiAgfQpgOwoKICB2YXIgU2xEaXZpZGVyID0gY2xhc3MgZXh0ZW5kcyBTaG9lbGFjZUVsZW1lbnQgewogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHN1cGVyKC4uLmFyZ3VtZW50cyk7CiAgICAgIHRoaXMudmVydGljYWwgPSBmYWxzZTsKICAgIH0KICAgIGNvbm5lY3RlZENhbGxiYWNrKCkgewogICAgICBzdXBlci5jb25uZWN0ZWRDYWxsYmFjaygpOwogICAgICB0aGlzLnNldEF0dHJpYnV0ZSgicm9sZSIsICJzZXBhcmF0b3IiKTsKICAgIH0KICAgIGhhbmRsZVZlcnRpY2FsQ2hhbmdlKCkgewogICAgICB0aGlzLnNldEF0dHJpYnV0ZSgiYXJpYS1vcmllbnRhdGlvbiIsIHRoaXMudmVydGljYWwgPyAidmVydGljYWwiIDogImhvcml6b250YWwiKTsKICAgIH0KICB9OwogIFNsRGl2aWRlci5zdHlsZXMgPSBkaXZpZGVyX3N0eWxlc19kZWZhdWx0OwogIF9fZGVjb3JhdGVDbGFzcyhbCiAgICBuJDIoeyB0eXBlOiBCb29sZWFuLCByZWZsZWN0OiB0cnVlIH0pCiAgXSwgU2xEaXZpZGVyLnByb3RvdHlwZSwgInZlcnRpY2FsIiwgMik7CiAgX19kZWNvcmF0ZUNsYXNzKFsKICAgIHdhdGNoKCJ2ZXJ0aWNhbCIpCiAgXSwgU2xEaXZpZGVyLnByb3RvdHlwZSwgImhhbmRsZVZlcnRpY2FsQ2hhbmdlIiwgMSk7CgogIFNsRGl2aWRlci5kZWZpbmUoInNsLWRpdmlkZXIiKTsKCiAgdmFyIGltZyQzID0gImRhdGE6aW1hZ2Uvc3ZnK3htbCwlM2NzdmcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB3aWR0aD0nMTYnIGhlaWdodD0nMTYnIGZpbGw9J2N1cnJlbnRDb2xvcicgY2xhc3M9J2JpIGJpLWZhc3QtZm9yd2FyZC1idG4nIHZpZXdCb3g9JzAgMCAxNiAxNiclM2UgJTNjcGF0aCBkPSdNOC43OSA1LjA5M0EuNS41IDAgMCAwIDggNS41djEuODg2TDQuNzkgNS4wOTNBLjUuNSAwIDAgMCA0IDUuNXY1YS41LjUgMCAwIDAgLjc5LjQwN0w4IDguNjE0VjEwLjVhLjUuNSAwIDAgMCAuNzkuNDA3bDMuNS0yLjVhLjUuNSAwIDAgMCAwLS44MTRsLTMuNS0yLjVaJy8lM2UgJTNjcGF0aCBkPSdNMCA0YTIgMiAwIDAgMSAyLTJoMTJhMiAyIDAgMCAxIDIgMnY4YTIgMiAwIDAgMS0yIDJIMmEyIDIgMCAwIDEtMi0yVjRabTE1IDBhMSAxIDAgMCAwLTEtMUgyYTEgMSAwIDAgMC0xIDF2OGExIDEgMCAwIDAgMSAxaDEyYTEgMSAwIDAgMCAxLTFWNFonLyUzZSUzYy9zdmclM2UiOwoKICB2YXIgaW1nJDIgPSAiZGF0YTppbWFnZS9zdmcreG1sLCUzY3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxNicgaGVpZ2h0PScxNicgZmlsbD0nY3VycmVudENvbG9yJyBjbGFzcz0nYmkgYmktaW1hZ2UnIHZpZXdCb3g9JzAgMCAxNiAxNiclM2UgJTNjcGF0aCBkPSdNNi4wMDIgNS41YTEuNSAxLjUgMCAxIDEtMyAwIDEuNSAxLjUgMCAwIDEgMyAweicvJTNlICUzY3BhdGggZD0nTTIuMDAyIDFhMiAyIDAgMCAwLTIgMnYxMGEyIDIgMCAwIDAgMiAyaDEyYTIgMiAwIDAgMCAyLTJWM2EyIDIgMCAwIDAtMi0yaC0xMnptMTIgMWExIDEgMCAwIDEgMSAxdjYuNWwtMy43NzctMS45NDdhLjUuNSAwIDAgMC0uNTc3LjA5M2wtMy43MSAzLjcxLTIuNjYtMS43NzJhLjUuNSAwIDAgMC0uNjMuMDYyTDEuMDAyIDEyVjNhMSAxIDAgMCAxIDEtMWgxMnonLyUzZSUzYy9zdmclM2UiOwoKICB2YXIgaW1nJDEgPSAiZGF0YTppbWFnZS9zdmcreG1sLCUzY3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxNicgaGVpZ2h0PScxNicgZmlsbD0nY3VycmVudENvbG9yJyBjbGFzcz0nYmkgYmktbGlzdCcgdmlld0JveD0nMCAwIDE2IDE2JyUzZSAlM2NwYXRoIGZpbGwtcnVsZT0nZXZlbm9kZCcgZD0nTTIuNSAxMmEuNS41IDAgMCAxIC41LS41aDEwYS41LjUgMCAwIDEgMCAxSDNhLjUuNSAwIDAgMS0uNS0uNXptMC00YS41LjUgMCAwIDEgLjUtLjVoMTBhLjUuNSAwIDAgMSAwIDFIM2EuNS41IDAgMCAxLS41LS41em0wLTRhLjUuNSAwIDAgMSAuNS0uNWgxMGEuNS41IDAgMCAxIDAgMUgzYS41LjUgMCAwIDEtLjUtLjV6Jy8lM2UlM2Mvc3ZnJTNlIjsKCiAgdmFyIGltZyA9ICJkYXRhOmltYWdlL3N2Zyt4bWwsJTNjc3ZnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zycgd2lkdGg9JzE2JyBoZWlnaHQ9JzE2JyBmaWxsPSdjdXJyZW50Q29sb3InIGNsYXNzPSdiaSBiaS1kb3dubG9hZCcgdmlld0JveD0nMCAwIDE2IDE2JyUzZSAlM2NwYXRoIGQ9J00uNSA5LjlhLjUuNSAwIDAgMSAuNS41djIuNWExIDEgMCAwIDAgMSAxaDEyYTEgMSAwIDAgMCAxLTF2LTIuNWEuNS41IDAgMCAxIDEgMHYyLjVhMiAyIDAgMCAxLTIgMkgyYTIgMiAwIDAgMS0yLTJ2LTIuNWEuNS41IDAgMCAxIC41LS41eicvJTNlICUzY3BhdGggZD0nTTcuNjQ2IDExLjg1NGEuNS41IDAgMCAwIC43MDggMGwzLTNhLjUuNSAwIDAgMC0uNzA4LS43MDhMOC41IDEwLjI5M1YxLjVhLjUuNSAwIDAgMC0xIDB2OC43OTNMNS4zNTQgOC4xNDZhLjUuNSAwIDEgMC0uNzA4LjcwOGwzIDN6Jy8lM2UlM2Mvc3ZnJTNlIjsKCiAgY29uc3QgZmFxID0gWwogICAgewogICAgICB0aXRsZTogJ+WAjemAn+WIt+ivvuS4uuWVpeWtpuS5oOi/m+W6puayoeWPmOWMlicsCiAgICAgIGFjdGlvbjogJ29wZW5Eb2NzTGluaycsCiAgICAgIGxhbmc6IFsnemgnXSwKICAgICAgYXJnczogJy9ob21lL3EmYSMlRTUlODAlOEQlRTklODAlOUYlRTUlODglQjclRTglQUYlQkUlRTQlQjglQkElRTUlOTUlQTUlRTUlQUQlQTYlRTQlQjklQTAlRTglQkYlOUIlRTUlQkElQTYlRTYlQjIlQTElRTUlOEYlOTglRTUlOEMlOTYnCiAgICB9LAogICAgewogICAgICB0aXRsZTogJ+eZvuW6pue9keebmOinhumikeaXoOazleWAjemAn+aSreaUvicsCiAgICAgIGFjdGlvbjogJ29wZW5Eb2NzTGluaycsCiAgICAgIGxhbmc6IFsnemgnXSwKICAgICAgYXJnczogJy9ob21lL3EmYSMlRTclOTklQkUlRTUlQkElQTYlRTclQkQlOTElRTclOUIlOTglRTglQTclODYlRTklQTIlOTElRTYlOTclQTAlRTYlQjMlOTUlRTUlODAlOEQlRTklODAlOUYlRTYlOTIlQUQlRTYlOTQlQkUnCiAgICB9LAogICAgewogICAgICB0aXRsZTogJ+WAjemAn+aSreaUvuWNoemhv+OAgeaXoOi/m+W6puOAgemfs+eUu+S4jeWQjOatpScsCiAgICAgIGFjdGlvbjogJ29wZW5Eb2NzTGluaycsCiAgICAgIGxhbmc6IFsnemgnXSwKICAgICAgYXJnczogJy9ob21lL3EmYSMlRTUlODAlOEQlRTklODAlOUYlRTYlOTIlQUQlRTYlOTQlQkUlRTUlOEQlQTElRTklQTElQkYlRTMlODAlODElRTYlOTclQTAlRTglQkYlOUIlRTUlQkElQTYlRTMlODAlODElRTklOUYlQjMlRTclOTQlQkIlRTQlQjglOEQlRTUlOTAlOEMlRTYlQUQlQTUnCiAgICB9LAogICAgewogICAgICB0aXRsZTogJ1BsYXliYWNrIGlzIHN0dXR0ZXJpbmcsIGhhcyBubyBwcm9ncmVzcywgb3IgaXMgb3V0IG9mIHN5bmMnLAogICAgICBhY3Rpb246ICdvcGVuRG9jc0xpbmsnLAogICAgICBsYW5nOiBbJ2VuJywgJ3J1J10sCiAgICAgIGFyZ3M6ICcvaG9tZS9xJmEjcGxheWJhY2staXMtc3R1dHRlcmluZy1oYXMtbm8tcHJvZ3Jlc3Mtb3ItaXMtb3V0LW9mLXN5bmMnCiAgICB9LAogICAgewogICAgICB0aXRsZTogJ+WmguS9leaUr+aMgeacrOWcsOinhumikeaWh+S7tueahOWAjemAn+aSreaUvicsCiAgICAgIGFjdGlvbjogJ29wZW5Eb2NzTGluaycsCiAgICAgIGxhbmc6IFsnemgnXSwKICAgICAgYXJnczogJy9ob21lL3EmYSMlRTUlQTYlODIlRTQlQkQlOTUlRTYlOTQlQUYlRTYlOEMlODElRTYlOUMlQUMlRTUlOUMlQjAlRTglQTclODYlRTklQTIlOTElRTYlOTYlODclRTQlQkIlQjYlRTclOUElODQlRTUlODAlOEQlRTklODAlOUYlRTYlOTIlQUQlRTYlOTQlQkUnCiAgICB9LAogICAgewogICAgICB0aXRsZTogJ0hvdyBjYW4gSSBzdXBwb3J0IHNwZWVkIHBsYXliYWNrIGZvciBsb2NhbCB2aWRlbyBmaWxlcz8nLAogICAgICBhY3Rpb246ICdvcGVuRG9jc0xpbmsnLAogICAgICBsYW5nOiBbJ2VuJywgJ3J1J10sCiAgICAgIGFyZ3M6ICcvaG9tZS9xJmEjaG93LWNhbi1pLXN1cHBvcnQtc3BlZWQtcGxheWJhY2stZm9yLWxvY2FsLXZpZGVvLWZpbGVzJwogICAgfSwKICAgIHsKICAgICAgdGl0bGU6ICflvIDlkK/mj5Lku7blkI7nvZHnq5noh6rouqvnmoTosIPpgJ/lpLHmlYjkuoYnLAogICAgICBhY3Rpb246ICdvcGVuRG9jc0xpbmsnLAogICAgICBsYW5nOiBbJ3poJ10sCiAgICAgIGFyZ3M6ICcvaG9tZS9xJmEjJUU1JUJDJTgwJUU1JTkwJUFGJUU2JThGJTkyJUU0JUJCJUI2JUU1JTkwJThFJUU3JUJEJTkxJUU3JUFCJTk5JUU4JTg3JUFBJUU4JUJBJUFCJUU3JTlBJTg0JUU4JUIwJTgzJUU5JTgwJTlGJUU1JUE0JUIxJUU2JTk1JTg4JUU0JUJBJTg2JwogICAgfSwKICAgIHsKICAgICAgdGl0bGU6ICdUaGUgc2l0ZVwncyBvd24gc3BlZWQgY29udHJvbCBmYWlscyBhZnRlciBlbmFibGluZyB0aGUgcGx1Z2luJywKICAgICAgYWN0aW9uOiAnb3BlbkRvY3NMaW5rJywKICAgICAgbGFuZzogWydlbicsICdydSddLAogICAgICBhcmdzOiAnL2hvbWUvcSZhI3RoZS1zaXRlLXMtb3duLXNwZWVkLWNvbnRyb2wtZmFpbHMtYWZ0ZXItZW5hYmxpbmctdGhlLXBsdWdpbicKICAgIH0sCiAgICB7CiAgICAgIHRpdGxlOiAn5Li65LuA5LmI6KeG6aKR6Lef6Z+z6aKR5piv5YiG5byA5LiL6L2955qEJywKICAgICAgYWN0aW9uOiAnb3BlbkRvY3NMaW5rJywKICAgICAgbGFuZzogWyd6aCddLAogICAgICBhcmdzOiAnL2hvbWUvcSZhIyVFNCVCOCVCQSVFNCVCQiU4MCVFNCVCOSU4OCVFOCVBNyU4NiVFOSVBMiU5MSVFOCVCNyU5RiVFOSU5RiVCMyVFOSVBMiU5MSVFNiU5OCVBRiVFNSU4OCU4NiVFNSVCQyU4MCVFNCVCOCU4QiVFOCVCRCVCRCVFNyU5QSU4NCcKICAgIH0sCiAgICB7CiAgICAgIHRpdGxlOiAnV2h5IGFyZSB2aWRlbyBhbmQgYXVkaW8gZG93bmxvYWRlZCBzZXBhcmF0ZWx5PycsCiAgICAgIGFjdGlvbjogJ29wZW5Eb2NzTGluaycsCiAgICAgIGxhbmc6IFsnZW4nLCAncnUnXSwKICAgICAgYXJnczogJy9ob21lL3EmYSN3aHktYXJlLXZpZGVvLWFuZC1hdWRpby1kb3dubG9hZGVkLXNlcGFyYXRlbHknCiAgICB9LAogICAgewogICAgICB0aXRsZTogJ+WmguS9leWQiOW5tuS4i+i9veWIsOeahOmfs+inhumikeaWh+S7ticsCiAgICAgIGFjdGlvbjogJ29wZW5Eb2NzTGluaycsCiAgICAgIGxhbmc6IFsnemgnXSwKICAgICAgYXJnczogJy9ob21lL3EmYSMlRTUlQTYlODIlRTQlQkQlOTUlRTUlOTAlODglRTUlQjklQjYlRTQlQjglOEIlRTglQkQlQkQlRTUlODglQjAlRTclOUElODQlRTklOUYlQjMlRTglQTclODYlRTklQTIlOTElRTYlOTYlODclRTQlQkIlQjYnCiAgICB9LAogICAgewogICAgICB0aXRsZTogJ0hvdyB0byBtZXJnZSBkb3dubG9hZGVkIGF1ZGlvIGFuZCB2aWRlbyBmaWxlcycsCiAgICAgIGFjdGlvbjogJ29wZW5Eb2NzTGluaycsCiAgICAgIGxhbmc6IFsnZW4nLCAncnUnXSwKICAgICAgYXJnczogJy9ob21lL3EmYSNob3ctdG8tbWVyZ2UtZG93bmxvYWRlZC1hdWRpby1hbmQtdmlkZW8tZmlsZXMnCiAgICB9LAogICAgewogICAgICB0aXRsZTogJ+S4uuS7gOS5iOinhumikeaIquWbvuS4jeWQjOe9keermeihqOeOsOS4jeS4gOiHtCcsCiAgICAgIGFjdGlvbjogJ29wZW5Eb2NzTGluaycsCiAgICAgIGxhbmc6IFsnemgnXSwKICAgICAgYXJnczogJy9ob21lL3EmYSMlRTQlQjglQkElRTQlQkIlODAlRTQlQjklODglRTglQTclODYlRTklQTIlOTElRTYlODglQUElRTUlOUIlQkUlRTQlQjglOEQlRTUlOTAlOEMlRTclQkQlOTElRTclQUIlOTklRTglQTElQTglRTclOEUlQjAlRTQlQjglOEQlRTQlQjglODAlRTglODclQjQnCiAgICB9LAogICAgewogICAgICB0aXRsZTogJ1doeSBpcyB2aWRlbyBzY3JlZW5zaG90IGZ1bmN0aW9uYWxpdHkgaW5jb25zaXN0ZW50IGFjcm9zcyB3ZWJzaXRlcz8nLAogICAgICBhY3Rpb246ICdvcGVuRG9jc0xpbmsnLAogICAgICBsYW5nOiBbJ2VuJywgJ3J1J10sCiAgICAgIGFyZ3M6ICcvaG9tZS9xJmEjd2h5LWlzLXZpZGVvLXNjcmVlbnNob3QtZnVuY3Rpb25hbGl0eS1pbmNvbnNpc3RlbnQtYWNyb3NzLXdlYnNpdGVzJwogICAgfSwKICAgIHsKICAgICAgdGl0bGU6ICflpoLkvZXnpoHnlKjmiJboh6rlrprkuYnlv6vmjbfplK4nLAogICAgICBhY3Rpb246ICdvcGVuRG9jc0xpbmsnLAogICAgICBsYW5nOiBbJ3poJ10sCiAgICAgIGFyZ3M6ICcvaG9tZS9xJmEjJUU1JUE2JTgyJUU0JUJEJTk1JUU3JUE2JTgxJUU3JTk0JUE4JUU2JTg4JTk2JUU4JTg3JUFBJUU1JUFFJTlBJUU0JUI5JTg5JUU1JUJGJUFCJUU2JThEJUI3JUU5JTk0JUFFJwogICAgfSwKICAgIHsKICAgICAgdGl0bGU6ICdIb3cgdG8gRGlzYWJsZSBvciBDdXN0b21pemUgU2hvcnRjdXQgS2V5cycsCiAgICAgIGFjdGlvbjogJ29wZW5Eb2NzTGluaycsCiAgICAgIGxhbmc6IFsnZW4nLCAncnUnXSwKICAgICAgYXJnczogJy9ob21lL3EmYSNob3ctdG8tZGlzYWJsZS1vci1jdXN0b21pemUtc2hvcnRjdXQta2V5cycKICAgIH0KICBdOwoKICBjb25zdCB7IGkxOG4sIGRlYnVnOiBkZWJ1ZyQxLCBnbG9iYWxGdW5jdGlvbmFsLCBjb25maWdNYW5hZ2VyOiBjb25maWdNYW5hZ2VyJDEgfSA9IHdpbmRvdy5oNXBsYXllclVJUHJvdmlkZXI7CiAgY29uc3QgaXNHbG9iYWxTdG9yYWdlVXNhYmxlID0gY29uZmlnTWFuYWdlciQxLmlzR2xvYmFsU3RvcmFnZVVzYWJsZSgpOwoKICBjb25zdCBtZW51Q29uZmlnID0gWwogICAgewogICAgICB0aXRsZTogaTE4bi50KCdkb3dubG9hZCcpLAogICAgICBkZXNjOiBpMThuLnQoJ2Rvd25sb2FkJyksCiAgICAgIGljb246IGltZywKICAgICAgYWN0aW9uOiAnbWVkaWFEb3dubG9hZCcsCiAgICAgIGFyZ3M6IG51bGwKICAgIH0sCiAgICB7CiAgICAgIHRpdGxlOiBpMThuLnQoJ2NhcHR1cmUnKSwKICAgICAgZGVzYzogaTE4bi50KCdjYXB0dXJlJyksCiAgICAgIGljb246IGltZyQyLAogICAgICBhY3Rpb246ICdjYXB0dXJlJywKICAgICAgYXJnczogbnVsbAogICAgfSwKICAgIHsKICAgICAgdGl0bGU6IGkxOG4udCgnc3BlZWQnKSwKICAgICAgZGVzYzogaTE4bi50KCdzcGVlZCcpLAogICAgICBpY29uOiBpbWckMywKICAgICAgZHJvcGRvd25NZW51OiBbCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICcwLjV4JywKICAgICAgICAgIGRlc2M6ICcwLjV4JywKICAgICAgICAgIGFjdGlvbjogJ3NldFBsYXliYWNrUmF0ZScsCiAgICAgICAgICBhcmdzOiAwLjUKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiAnMC43NXgnLAogICAgICAgICAgZGVzYzogJzAuNzV4JywKICAgICAgICAgIGFjdGlvbjogJ3NldFBsYXliYWNrUmF0ZScsCiAgICAgICAgICBhcmdzOiAwLjc1CiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogJzEuMHgnLAogICAgICAgICAgZGVzYzogJzEuMHgnLAogICAgICAgICAgYWN0aW9uOiAnc2V0UGxheWJhY2tSYXRlJywKICAgICAgICAgIGFyZ3M6IDEKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiAnMS4yNXgnLAogICAgICAgICAgZGVzYzogJzEuMjV4JywKICAgICAgICAgIGFjdGlvbjogJ3NldFBsYXliYWNrUmF0ZScsCiAgICAgICAgICBhcmdzOiAxLjI1CiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogJzEuNXgnLAogICAgICAgICAgZGVzYzogJzEuNXgnLAogICAgICAgICAgYWN0aW9uOiAnc2V0UGxheWJhY2tSYXRlJywKICAgICAgICAgIGFyZ3M6IDEuNQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICcyLjB4JywKICAgICAgICAgIGRlc2M6ICcyLjB4JywKICAgICAgICAgIGFjdGlvbjogJ3NldFBsYXliYWNrUmF0ZScsCiAgICAgICAgICBhcmdzOiAyCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogJzMuMHgnLAogICAgICAgICAgZGVzYzogJzMuMHgnLAogICAgICAgICAgYWN0aW9uOiAnc2V0UGxheWJhY2tSYXRlJywKICAgICAgICAgIGFyZ3M6IDMKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiAnNC4weCcsCiAgICAgICAgICBkZXNjOiAnNC4weCcsCiAgICAgICAgICBhY3Rpb246ICdzZXRQbGF5YmFja1JhdGUnLAogICAgICAgICAgYXJnczogNAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICc4LjB4JywKICAgICAgICAgIGRlc2M6ICc4LjB4JywKICAgICAgICAgIGFjdGlvbjogJ3NldFBsYXliYWNrUmF0ZScsCiAgICAgICAgICBhcmdzOiA4CiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogJzE2LjB4JywKICAgICAgICAgIGRlc2M6ICcxNi4weCcsCiAgICAgICAgICBhY3Rpb246ICdzZXRQbGF5YmFja1JhdGUnLAogICAgICAgICAgYXJnczogMTYKICAgICAgICB9CiAgICAgIF0KICAgIH0sCiAgICB7CiAgICAgIHRpdGxlOiBpMThuLnQoJ21lbnUnKSwKICAgICAgZGVzYzogaTE4bi50KCdtZW51JyksCiAgICAgIGljb246IGltZyQxLAogICAgICBkcm9wZG93bk1lbnU6IFsKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogaTE4bi50KCdncmFwaGljYWxJbnRlcmZhY2UnKSwKICAgICAgICAgIGRlc2M6IGkxOG4udCgnZ3JhcGhpY2FsSW50ZXJmYWNlJyksCiAgICAgICAgICBzdWJNZW51OiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0aXRsZTogaTE4bi50KCdkaXNhYmxlQ3VycmVudEluc3RhbmNlR1VJJyksCiAgICAgICAgICAgICAgZGVzYzogaTE4bi50KCdkaXNhYmxlQ3VycmVudEluc3RhbmNlR1VJJyksCiAgICAgICAgICAgICAgYWN0aW9uOiAnZGlzYWJsZUN1cnJlbnRJbnN0YW5jZUdVSScsCiAgICAgICAgICAgICAgYXJnczogbnVsbAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdGl0bGU6IGkxOG4udCgnZGlzYWJsZUdVSVRlbXBvcmFyaWx5JyksCiAgICAgICAgICAgICAgZGVzYzogaTE4bi50KCdkaXNhYmxlR1VJVGVtcG9yYXJpbHknKSwKICAgICAgICAgICAgICBhY3Rpb246ICdkaXNhYmxlR1VJVGVtcG9yYXJpbHknLAogICAgICAgICAgICAgIGFyZ3M6IG51bGwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIC4uLmdsb2JhbEZ1bmN0aW9uYWwudG9nZ2xlR1VJU3RhdHVzVW5kZXJDdXJyZW50U2l0ZSwKICAgICAgICAgICAgICBhY3Rpb246ICd0b2dnbGVHVUlTdGF0dXNVbmRlckN1cnJlbnRTaXRlJywKICAgICAgICAgICAgICBhcmdzOiBudWxsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAuLi5nbG9iYWxGdW5jdGlvbmFsLnRvZ2dsZUdVSVN0YXR1cywKICAgICAgICAgICAgICBhY3Rpb246ICd0b2dnbGVHVUlTdGF0dXMnLAogICAgICAgICAgICAgIGFyZ3M6IG51bGwsCiAgICAgICAgICAgICAgZGlzYWJsZWQ6ICFpc0dsb2JhbFN0b3JhZ2VVc2FibGUKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIC4uLmdsb2JhbEZ1bmN0aW9uYWwuYWx3YXlzU2hvd0dyYXBoaWNhbEludGVyZmFjZSwKICAgICAgICAgICAgICBhY3Rpb246ICdhbHdheXNTaG93R3JhcGhpY2FsSW50ZXJmYWNlJywKICAgICAgICAgICAgICBhcmdzOiBudWxsLAogICAgICAgICAgICAgIGRpc2FibGVkOiAhZGVidWckMS5pc0RlYnVnTW9kZSgpIHx8ICFpc0dsb2JhbFN0b3JhZ2VVc2FibGUKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6IGkxOG4udCgndmlkZW9GaWx0ZXInKSwKICAgICAgICAgIGRlc2M6IGkxOG4udCgndmlkZW9GaWx0ZXInKSwKICAgICAgICAgIHN1Yk1lbnU6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHRpdGxlOiBpMThuLnQoJ3Jlc2V0RmlsdGVyQW5kVHJhbnNmb3JtJyksCiAgICAgICAgICAgICAgZGVzYzogaTE4bi50KCdyZXNldEZpbHRlckFuZFRyYW5zZm9ybScpLAogICAgICAgICAgICAgIGFjdGlvbjogJ3Jlc2V0RmlsdGVyQW5kVHJhbnNmb3JtJywKICAgICAgICAgICAgICBhcmdzOiBudWxsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0aXRsZTogaTE4bi50KCdicmlnaHRuZXNzVXAnKSwKICAgICAgICAgICAgICBkZXNjOiBpMThuLnQoJ2JyaWdodG5lc3NVcCcpLAogICAgICAgICAgICAgIGFjdGlvbjogJ3NldEJyaWdodG5lc3NVcCcsCiAgICAgICAgICAgICAgYXJnczogMC4xCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0aXRsZTogaTE4bi50KCdicmlnaHRuZXNzRG93bicpLAogICAgICAgICAgICAgIGRlc2M6IGkxOG4udCgnYnJpZ2h0bmVzc0Rvd24nKSwKICAgICAgICAgICAgICBhY3Rpb246ICdzZXRCcmlnaHRuZXNzRG93bicsCiAgICAgICAgICAgICAgYXJnczogLTAuMQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdGl0bGU6IGkxOG4udCgnY29udHJhc3RVcCcpLAogICAgICAgICAgICAgIGRlc2M6IGkxOG4udCgnY29udHJhc3RVcCcpLAogICAgICAgICAgICAgIGFjdGlvbjogJ3NldENvbnRyYXN0VXAnLAogICAgICAgICAgICAgIGFyZ3M6IDAuMQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdGl0bGU6IGkxOG4udCgnY29udHJhc3REb3duJyksCiAgICAgICAgICAgICAgZGVzYzogaTE4bi50KCdjb250cmFzdERvd24nKSwKICAgICAgICAgICAgICBhY3Rpb246ICdzZXRDb250cmFzdERvd24nLAogICAgICAgICAgICAgIGFyZ3M6IC0wLjEKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIHRpdGxlOiBpMThuLnQoJ3NhdHVyYXRpb25VcCcpLAogICAgICAgICAgICAgIGRlc2M6IGkxOG4udCgnc2F0dXJhdGlvblVwJyksCiAgICAgICAgICAgICAgYWN0aW9uOiAnc2V0U2F0dXJhdGlvblVwJywKICAgICAgICAgICAgICBhcmdzOiAwLjEKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIHRpdGxlOiBpMThuLnQoJ3NhdHVyYXRpb25Eb3duJyksCiAgICAgICAgICAgICAgZGVzYzogaTE4bi50KCdzYXR1cmF0aW9uRG93bicpLAogICAgICAgICAgICAgIGFjdGlvbjogJ3NldFNhdHVyYXRpb25Eb3duJywKICAgICAgICAgICAgICBhcmdzOiAtMC4xCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0aXRsZTogaTE4bi50KCdodWVVcCcpLAogICAgICAgICAgICAgIGRlc2M6IGkxOG4udCgnaHVlVXAnKSwKICAgICAgICAgICAgICBhY3Rpb246ICdzZXRIdWVVcCcsCiAgICAgICAgICAgICAgYXJnczogMQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdGl0bGU6IGkxOG4udCgnaHVlRG93bicpLAogICAgICAgICAgICAgIGRlc2M6IGkxOG4udCgnaHVlRG93bicpLAogICAgICAgICAgICAgIGFjdGlvbjogJ3NldEh1ZURvd24nLAogICAgICAgICAgICAgIGFyZ3M6IC0xCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0aXRsZTogaTE4bi50KCdibHVyVXAnKSwKICAgICAgICAgICAgICBkZXNjOiBpMThuLnQoJ2JsdXJVcCcpLAogICAgICAgICAgICAgIGFjdGlvbjogJ3NldEJsdXJVcCcsCiAgICAgICAgICAgICAgYXJnczogMQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdGl0bGU6IGkxOG4udCgnYmx1ckRvd24nKSwKICAgICAgICAgICAgICBkZXNjOiBpMThuLnQoJ2JsdXJEb3duJyksCiAgICAgICAgICAgICAgYWN0aW9uOiAnc2V0Qmx1ckRvd24nLAogICAgICAgICAgICAgIGFyZ3M6IC0xCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiBpMThuLnQoJ3JvdGF0ZUFuZE1pcnJvcicpLAogICAgICAgICAgZGVzYzogaTE4bi50KCdyb3RhdGVBbmRNaXJyb3InKSwKICAgICAgICAgIGFjdGlvbjogJ3JvdGF0ZUFuZE1pcnJvcicsCiAgICAgICAgICBzdWJNZW51OiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0aXRsZTogaTE4bi50KCdyb3RhdGU5MCcpLAogICAgICAgICAgICAgIGRlc2M6IGkxOG4udCgncm90YXRlOTAnKSwKICAgICAgICAgICAgICBhY3Rpb246ICdzZXRSb3RhdGUnLAogICAgICAgICAgICAgIGFyZ3M6IG51bGwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIHRpdGxlOiBpMThuLnQoJ2hvcml6b250YWxNaXJyb3InKSwKICAgICAgICAgICAgICBkZXNjOiBpMThuLnQoJ2hvcml6b250YWxNaXJyb3InKSwKICAgICAgICAgICAgICBhY3Rpb246ICdzZXRNaXJyb3InLAogICAgICAgICAgICAgIGFyZ3M6IG51bGwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIHRpdGxlOiBpMThuLnQoJ3ZlcnRpY2FsTWlycm9yJyksCiAgICAgICAgICAgICAgZGVzYzogaTE4bi50KCd2ZXJ0aWNhbE1pcnJvcicpLAogICAgICAgICAgICAgIGFjdGlvbjogJ3NldE1pcnJvcicsCiAgICAgICAgICAgICAgYXJnczogdHJ1ZQogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogaTE4bi50KCd2aWRlb1RyYW5zZm9ybScpLAogICAgICAgICAgZGVzYzogaTE4bi50KCd2aWRlb1RyYW5zZm9ybScpLAogICAgICAgICAgYWN0aW9uOiAndHJhbnNsYXRlJywKICAgICAgICAgIHN1Yk1lbnU6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHRpdGxlOiBpMThuLnQoJ3RyYW5zbGF0ZVJpZ2h0JyksCiAgICAgICAgICAgICAgZGVzYzogaTE4bi50KCd0cmFuc2xhdGVSaWdodCcpLAogICAgICAgICAgICAgIGFjdGlvbjogJ3NldFRyYW5zbGF0ZVJpZ2h0JywKICAgICAgICAgICAgICBhcmdzOiBudWxsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0aXRsZTogaTE4bi50KCd0cmFuc2xhdGVMZWZ0JyksCiAgICAgICAgICAgICAgZGVzYzogaTE4bi50KCd0cmFuc2xhdGVMZWZ0JyksCiAgICAgICAgICAgICAgYWN0aW9uOiAnc2V0VHJhbnNsYXRlTGVmdCcsCiAgICAgICAgICAgICAgYXJnczogbnVsbAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdGl0bGU6IGkxOG4udCgndHJhbnNsYXRlVXAnKSwKICAgICAgICAgICAgICBkZXNjOiBpMThuLnQoJ3RyYW5zbGF0ZVVwJyksCiAgICAgICAgICAgICAgYWN0aW9uOiAnc2V0VHJhbnNsYXRlVXAnLAogICAgICAgICAgICAgIGFyZ3M6IG51bGwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIHRpdGxlOiBpMThuLnQoJ3RyYW5zbGF0ZURvd24nKSwKICAgICAgICAgICAgICBkZXNjOiBpMThuLnQoJ3RyYW5zbGF0ZURvd24nKSwKICAgICAgICAgICAgICBhY3Rpb246ICdzZXRUcmFuc2xhdGVEb3duJywKICAgICAgICAgICAgICBhcmdzOiBudWxsCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiBpMThuLnQoJ21vcmVBY3Rpb25zJyksCiAgICAgICAgICBkZXNjOiBpMThuLnQoJ21vcmVBY3Rpb25zJyksCiAgICAgICAgICBzdWJNZW51OiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0aXRsZTogJ0NsZWFuIHJlbW90ZSBoZWxwZXIgaW5mbycsCiAgICAgICAgICAgICAgZGVzYzogJ0NsZWFuIHJlbW90ZSBoZWxwZXIgaW5mbycsCiAgICAgICAgICAgICAgYWN0aW9uOiAnY2xlYW5SZW1vdGVIZWxwZXJJbmZvJywKICAgICAgICAgICAgICBkaXNhYmxlZDogIWRlYnVnJDEuaXNEZWJ1Z01vZGUoKQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdGl0bGU6ICdQcmludCBQbGF5ZXIgaW5mbycsCiAgICAgICAgICAgICAgZGVzYzogJ1ByaW50IFBsYXllciBpbmZvJywKICAgICAgICAgICAgICBhY3Rpb246ICdwcmludFBsYXllckluZm8nLAogICAgICAgICAgICAgIGRpc2FibGVkOiAhZGVidWckMS5pc0RlYnVnTW9kZSgpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAuLi5nbG9iYWxGdW5jdGlvbmFsLm9wZW5DdXN0b21Db25maWd1cmF0aW9uRWRpdG9yLAogICAgICAgICAgICAgIGFjdGlvbjogJ29wZW5DdXN0b21Db25maWd1cmF0aW9uRWRpdG9yJywKICAgICAgICAgICAgICBhcmdzOiBudWxsLAogICAgICAgICAgICAgIGRpc2FibGVkOiB0cnVlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0aXRsZTogaTE4bi50KCdjb21pbmdTb29uJyksCiAgICAgICAgICAgICAgZGVzYzogaTE4bi50KCdjb21pbmdTb29uJykKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgZGl2aWRlcjogdHJ1ZQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6IGkxOG4udCgna2V5Ym9hcmRDb250cm9sJyksCiAgICAgICAgICBkZXNjOiBpMThuLnQoJ2tleWJvYXJkQ29udHJvbCcpLAogICAgICAgICAgc3ViTWVudTogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgLi4uZ2xvYmFsRnVuY3Rpb25hbC5vcGVuSG90a2V5c1BhZ2UsCiAgICAgICAgICAgICAgYWN0aW9uOiAnb3BlbkhvdGtleXNQYWdlJywKICAgICAgICAgICAgICBhcmdzOiAnJwogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdGl0bGU6IGkxOG4udCgndG9nZ2xlSG90a2V5c1RlbXBvcmFyaWx5JyksCiAgICAgICAgICAgICAgZGVzYzogaTE4bi50KCd0b2dnbGVIb3RrZXlzVGVtcG9yYXJpbHknKSwKICAgICAgICAgICAgICBhY3Rpb246ICd0b2dnbGVIb3RrZXlzJwogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgLi4uZ2xvYmFsRnVuY3Rpb25hbC50b2dnbGVIb3RrZXlzU3RhdHVzVW5kZXJDdXJyZW50U2l0ZSwKICAgICAgICAgICAgICBhY3Rpb246ICd0b2dnbGVIb3RrZXlzU3RhdHVzVW5kZXJDdXJyZW50U2l0ZScKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIC4uLmdsb2JhbEZ1bmN0aW9uYWwudG9nZ2xlSG90a2V5c1N0YXR1cywKICAgICAgICAgICAgICBhY3Rpb246ICd0b2dnbGVIb3RrZXlzU3RhdHVzJywKICAgICAgICAgICAgICBkaXNhYmxlZDogIWlzR2xvYmFsU3RvcmFnZVVzYWJsZQogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogaTE4bi50KCdtb3VzZUNvbnRyb2wnKSwKICAgICAgICAgIGRlc2M6IGkxOG4udCgnbW91c2VDb250cm9sJyksCiAgICAgICAgICBzdWJNZW51OiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAuLi5nbG9iYWxGdW5jdGlvbmFsLnNldE1vdXNlTG9uZ1ByZXNzVGltZSwKICAgICAgICAgICAgICBhY3Rpb246ICdzZXRNb3VzZUxvbmdQcmVzc1RpbWUnCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAuLi5nbG9iYWxGdW5jdGlvbmFsLnRvZ2dsZU1vdXNlQ29udHJvbFVuZGVyQ3VycmVudFNpdGUsCiAgICAgICAgICAgICAgYWN0aW9uOiAndG9nZ2xlTW91c2VDb250cm9sVW5kZXJDdXJyZW50U2l0ZScKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIC4uLmdsb2JhbEZ1bmN0aW9uYWwudG9nZ2xlTW91c2VDb250cm9sLAogICAgICAgICAgICAgIGFjdGlvbjogJ3RvZ2dsZU1vdXNlQ29udHJvbCcsCiAgICAgICAgICAgICAgZGlzYWJsZWQ6ICFpc0dsb2JhbFN0b3JhZ2VVc2FibGUKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIHRpdGxlOiBpMThuLnQoJ2NvbWluZ1Nvb24nKSwKICAgICAgICAgICAgICBkZXNjOiBpMThuLnQoJ2NvbWluZ1Nvb24nKQogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogaTE4bi50KCdtZWRpYURvd25sb2FkLmRvd25sb2FkT3B0aW9ucycpLAogICAgICAgICAgZGVzYzogaTE4bi50KCdtZWRpYURvd25sb2FkLmRvd25sb2FkT3B0aW9ucycpLAogICAgICAgICAgc3ViTWVudTogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgLi4uZ2xvYmFsRnVuY3Rpb25hbC50b2dnbGVEb3dubG9hZENvbnRyb2xVbmRlckN1cnJlbnRTaXRlLAogICAgICAgICAgICAgIGFjdGlvbjogJ3RvZ2dsZURvd25sb2FkQ29udHJvbFVuZGVyQ3VycmVudFNpdGUnCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAuLi5nbG9iYWxGdW5jdGlvbmFsLnRvZ2dsZURvd25sb2FkQ29udHJvbCwKICAgICAgICAgICAgICBhY3Rpb246ICd0b2dnbGVEb3dubG9hZENvbnRyb2wnLAogICAgICAgICAgICAgIGRpc2FibGVkOiAhaXNHbG9iYWxTdG9yYWdlVXNhYmxlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0aXRsZTogYCR7aTE4bi50KCd0b2dnbGVTdGF0ZXMnKX0gJHtpMThuLnQoJ2F1dG9Hb3RvQnVmZmVyZWRUaW1lJyl9YCwKICAgICAgICAgICAgICBkZXNjOiBgJHtpMThuLnQoJ3RvZ2dsZVN0YXRlcycpfSAke2kxOG4udCgnYXV0b0dvdG9CdWZmZXJlZFRpbWUnKX1gLAogICAgICAgICAgICAgIGFjdGlvbjogJ3RvZ2dsZUF1dG9Hb3RvQnVmZmVyZWRUaW1lJwogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdGl0bGU6IGkxOG4udCgnZmZtcGVnU2NyaXB0JyksCiAgICAgICAgICAgICAgZGVzYzogaTE4bi50KCdmZm1wZWdTY3JpcHQnKSwKICAgICAgICAgICAgICB1cmw6ICdodHRwczovL2dpdGh1Yi5jb20veHh4aWx5L2ZmbXBlZy1zY3JpcHQnCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiBpMThuLnQoJ2ZhcScpLAogICAgICAgICAgZGVzYzogaTE4bi50KCdmYXEnKSwKICAgICAgICAgIHN1Yk1lbnU6IGZhcQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6IGkxOG4udCgnc2V0dGluZycpLAogICAgICAgICAgZGVzYzogaTE4bi50KCdzZXR0aW5nJyksCiAgICAgICAgICBzdWJNZW51OiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAuLi5nbG9iYWxGdW5jdGlvbmFsLm9wZW5DdXN0b21Db25maWd1cmF0aW9uRWRpdG9yLAogICAgICAgICAgICAgIGFjdGlvbjogJ29wZW5DdXN0b21Db25maWd1cmF0aW9uRWRpdG9yJywKICAgICAgICAgICAgICBhcmdzOiAnJwogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgLi4uZ2xvYmFsRnVuY3Rpb25hbC5yZXN0b3JlR2xvYmFsQ29uZmlndXJhdGlvbiwKICAgICAgICAgICAgICBhY3Rpb246ICdyZXN0b3JlR2xvYmFsQ29uZmlndXJhdGlvbicsCiAgICAgICAgICAgICAgYXJnczogJycsCiAgICAgICAgICAgICAgZGlzYWJsZWQ6ICFpc0dsb2JhbFN0b3JhZ2VVc2FibGUKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIC4uLmdsb2JhbEZ1bmN0aW9uYWwudG9nZ2xlU2NyaXB0RW5hYmxlU3RhdGUsCiAgICAgICAgICAgICAgYWN0aW9uOiAndG9nZ2xlU2NyaXB0RW5hYmxlU3RhdGUnLAogICAgICAgICAgICAgIGFyZ3M6IG51bGwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIC4uLmdsb2JhbEZ1bmN0aW9uYWwudG9nZ2xlU2V0Q3VycmVudFRpbWVGdW5jdGlvbmFsLAogICAgICAgICAgICAgIGFjdGlvbjogJ3RvZ2dsZVNldEN1cnJlbnRUaW1lRnVuY3Rpb25hbCcsCiAgICAgICAgICAgICAgYXJnczogJycKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIC4uLmdsb2JhbEZ1bmN0aW9uYWwudG9nZ2xlU2V0Vm9sdW1lRnVuY3Rpb25hbCwKICAgICAgICAgICAgICBhY3Rpb246ICd0b2dnbGVTZXRWb2x1bWVGdW5jdGlvbmFsJywKICAgICAgICAgICAgICBhcmdzOiAnJwogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgLi4uZ2xvYmFsRnVuY3Rpb25hbC50b2dnbGVHVUlTdGF0dXMsCiAgICAgICAgICAgICAgYWN0aW9uOiAndG9nZ2xlR1VJU3RhdHVzJywKICAgICAgICAgICAgICBhcmdzOiBudWxsLAogICAgICAgICAgICAgIGRpc2FibGVkOiAhaXNHbG9iYWxTdG9yYWdlVXNhYmxlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAuLi5nbG9iYWxGdW5jdGlvbmFsLnRvZ2dsZVNldFBsYXliYWNrUmF0ZUZ1bmN0aW9uYWwsCiAgICAgICAgICAgICAgYWN0aW9uOiAndG9nZ2xlU2V0UGxheWJhY2tSYXRlRnVuY3Rpb25hbCcsCiAgICAgICAgICAgICAgYXJnczogJycsCiAgICAgICAgICAgICAgZGlzYWJsZWQ6ICFpc0dsb2JhbFN0b3JhZ2VVc2FibGUKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIC4uLmdsb2JhbEZ1bmN0aW9uYWwudG9nZ2xlQWNvdXN0aWNHYWluRnVuY3Rpb25hbCwKICAgICAgICAgICAgICBhY3Rpb246ICd0b2dnbGVBY291c3RpY0dhaW5GdW5jdGlvbmFsJywKICAgICAgICAgICAgICBhcmdzOiAnJywKICAgICAgICAgICAgICBkaXNhYmxlZDogIWlzR2xvYmFsU3RvcmFnZVVzYWJsZQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgLi4uZ2xvYmFsRnVuY3Rpb25hbC50b2dnbGVDcm9zc09yaWdpbkNvbnRyb2xGdW5jdGlvbmFsLAogICAgICAgICAgICAgIGFjdGlvbjogJ3RvZ2dsZUNyb3NzT3JpZ2luQ29udHJvbEZ1bmN0aW9uYWwnLAogICAgICAgICAgICAgIGFyZ3M6ICcnLAogICAgICAgICAgICAgIGRpc2FibGVkOiAhaXNHbG9iYWxTdG9yYWdlVXNhYmxlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAuLi5nbG9iYWxGdW5jdGlvbmFsLnRvZ2dsZUV4cGVyaW1lbnRGZWF0dXJlcywKICAgICAgICAgICAgICBhY3Rpb246ICd0b2dnbGVFeHBlcmltZW50RmVhdHVyZXMnLAogICAgICAgICAgICAgIGFyZ3M6ICcnLAogICAgICAgICAgICAgIGRpc2FibGVkOiAhaXNHbG9iYWxTdG9yYWdlVXNhYmxlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAuLi5nbG9iYWxGdW5jdGlvbmFsLnRvZ2dsZUV4dGVybmFsQ3VzdG9tQ29uZmlndXJhdGlvbiwKICAgICAgICAgICAgICBhY3Rpb246ICd0b2dnbGVFeHRlcm5hbEN1c3RvbUNvbmZpZ3VyYXRpb24nLAogICAgICAgICAgICAgIGFyZ3M6ICcnLAogICAgICAgICAgICAgIGRpc2FibGVkOiAhaXNHbG9iYWxTdG9yYWdlVXNhYmxlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAuLi5nbG9iYWxGdW5jdGlvbmFsLnRvZ2dsZURlYnVnTW9kZSwKICAgICAgICAgICAgICBhY3Rpb246ICd0b2dnbGVEZWJ1Z01vZGUnLAogICAgICAgICAgICAgIGFyZ3M6ICcnLAogICAgICAgICAgICAgIGRpc2FibGVkOiAhaXNHbG9iYWxTdG9yYWdlVXNhYmxlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0aXRsZTogYCR7aTE4bi50KCdsYW5ndWFnZVNldHRpbmdzJyl944CMJHtpMThuLnQoJ2dsb2JhbFNldHRpbmcnKX3jgI1gLAogICAgICAgICAgICAgIGRlc2M6IGAke2kxOG4udCgnbGFuZ3VhZ2VTZXR0aW5ncycpfeOAjCR7aTE4bi50KCdnbG9iYWxTZXR0aW5nJyl944CNYCwKICAgICAgICAgICAgICBkaXNhYmxlZDogIWlzR2xvYmFsU3RvcmFnZVVzYWJsZSwKICAgICAgICAgICAgICBzdWJNZW51OiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiBpMThuLnQoJ2F1dG9DaG9vc2UnKSwKICAgICAgICAgICAgICAgICAgZGVzYzogaTE4bi50KCdhdXRvQ2hvb3NlJyksCiAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ3NldExhbmd1YWdlJywKICAgICAgICAgICAgICAgICAgYXJnczogJ2F1dG8nCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICB0aXRsZTogJ+eugOS9k+S4reaWhycsCiAgICAgICAgICAgICAgICAgIGRlc2M6ICfnroDkvZPkuK3mlocnLAogICAgICAgICAgICAgICAgICBhY3Rpb246ICdzZXRMYW5ndWFnZScsCiAgICAgICAgICAgICAgICAgIGFyZ3M6ICd6aC1DTicKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiAn57mB6auU5Lit5paHJywKICAgICAgICAgICAgICAgICAgZGVzYzogJ+e5gemrlOS4reaWhycsCiAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ3NldExhbmd1YWdlJywKICAgICAgICAgICAgICAgICAgYXJnczogJ3poLVRXJwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgdGl0bGU6ICdFbmdsaXNoJywKICAgICAgICAgICAgICAgICAgZGVzYzogJ0VuZ2xpc2gnLAogICAgICAgICAgICAgICAgICBhY3Rpb246ICdzZXRMYW5ndWFnZScsCiAgICAgICAgICAgICAgICAgIGFyZ3M6ICdlbi1VUycKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiAn0YDRg9GB0YHQutC40LknLAogICAgICAgICAgICAgICAgICBkZXNjOiAn0YDRg9GB0YHQutC40LknLAogICAgICAgICAgICAgICAgICBhY3Rpb246ICdzZXRMYW5ndWFnZScsCiAgICAgICAgICAgICAgICAgIGFyZ3M6ICdydScKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBdCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiBpMThuLnQoJ2Fib3V0JyksCiAgICAgICAgICBkZXNjOiBpMThuLnQoJ2Fib3V0JyksCiAgICAgICAgICBzdWJNZW51OiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAuLi5nbG9iYWxGdW5jdGlvbmFsLm9wZW5XZWJzaXRlLAogICAgICAgICAgICAgIGFjdGlvbjogJ29wZW5XZWJzaXRlJywKICAgICAgICAgICAgICBhcmdzOiAnJwogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgLi4uZ2xvYmFsRnVuY3Rpb25hbC5vcGVuUHJvamVjdEdpdGh1YiwKICAgICAgICAgICAgICBhY3Rpb246ICdvcGVuUHJvamVjdEdpdGh1YicsCiAgICAgICAgICAgICAgYXJnczogJycKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIC4uLmdsb2JhbEZ1bmN0aW9uYWwub3Blbklzc3Vlc1BhZ2UsCiAgICAgICAgICAgICAgYWN0aW9uOiAnb3Blbklzc3Vlc1BhZ2UnLAogICAgICAgICAgICAgIGFyZ3M6ICcnCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAuLi5nbG9iYWxGdW5jdGlvbmFsLm9wZW5BZGRHcm91cENoYXRQYWdlLAogICAgICAgICAgICAgIGFjdGlvbjogJ29wZW5BZGRHcm91cENoYXRQYWdlJywKICAgICAgICAgICAgICBhcmdzOiAnJwogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgLi4uZ2xvYmFsRnVuY3Rpb25hbC5vcGVuQ2hhbmdlTG9nUGFnZSwKICAgICAgICAgICAgICBhY3Rpb246ICdvcGVuQ2hhbmdlTG9nUGFnZScsCiAgICAgICAgICAgICAgYXJnczogJycKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIC4uLmdsb2JhbEZ1bmN0aW9uYWwub3BlbkNoZWNrVmVyc2lvblBhZ2UsCiAgICAgICAgICAgICAgYWN0aW9uOiAnb3BlbkNoZWNrVmVyc2lvblBhZ2UnLAogICAgICAgICAgICAgIGFyZ3M6ICcnCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAuLi5nbG9iYWxGdW5jdGlvbmFsLm9wZW5Eb25hdGVQYWdlLAogICAgICAgICAgICAgIGFjdGlvbjogJ29wZW5Eb25hdGVQYWdlJywKICAgICAgICAgICAgICBhcmdzOiAnJwogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgLi4uZ2xvYmFsRnVuY3Rpb25hbC5vcGVuQWJvdXREb25hdGVQYWdlLAogICAgICAgICAgICAgIGFjdGlvbjogJ29wZW5BYm91dERvbmF0ZVBhZ2UnLAogICAgICAgICAgICAgIGFyZ3M6ICcnCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAuLi5nbG9iYWxGdW5jdGlvbmFsLm9wZW5BdXRob3JIb21lUGFnZSwKICAgICAgICAgICAgICBhY3Rpb246ICdvcGVuQXV0aG9ySG9tZVBhZ2UnLAogICAgICAgICAgICAgIGFyZ3M6ICcnCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiBpMThuLnQoJ21vcmUnKSwKICAgICAgICAgIGRlc2M6IGkxOG4udCgnbW9yZScpLAogICAgICAgICAgZGlzYWJsZWQ6IHRydWUsCiAgICAgICAgICBzdWJNZW51OiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0aXRsZTogaTE4bi50KCdmZm1wZWdTY3JpcHQnKSwKICAgICAgICAgICAgICBkZXNjOiBpMThuLnQoJ2ZmbXBlZ1NjcmlwdCcpLAogICAgICAgICAgICAgIHVybDogJ2h0dHBzOi8vZ2l0aHViLmNvbS94eHhpbHkvZmZtcGVnLXNjcmlwdCcKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0KICAgICAgXQogICAgfQogIF07CgogIC8qIG1lbnVDb25maWfpooTlpITnkIblh73mlbDvvIzmoLnmja7mjIflrprnmoTlj4LogINkb23lhYPntKDvvIzpgJrov4fliKTmlq3lhYPntKDnmoTlrr3luqbmnaXlhrPlrprmmK/lkKblj6rmmL7npLroj5zljZXnmoTlm77moIfvvIzku6XoioLnnIHlsZXnpLrkvY3nva4gKi8KICBmdW5jdGlvbiBtZW51Q29uZmlnUHJlcHJvY2VzcyAobWVudUNvbmZpZywgcmVmRG9tKSB7CiAgICBjb25zdCByZWZXaWR0aCA9IHJlZkRvbS5vZmZzZXRXaWR0aDsKICAgIGNvbnN0IGljb25Pbmx5ID0gcmVmV2lkdGggPCA1MDA7CgogICAgcmV0dXJuIG1lbnVDb25maWcubWFwKGl0ZW0gPT4gewogICAgICBpZiAoaXRlbS5kcm9wZG93bk1lbnUpIHsKICAgICAgICBpdGVtLmRyb3Bkb3duTWVudSA9IG1lbnVDb25maWdQcmVwcm9jZXNzKGl0ZW0uZHJvcGRvd25NZW51LCByZWZEb20pOwogICAgICB9CgogICAgICByZXR1cm4gewogICAgICAgIC4uLml0ZW0sCiAgICAgICAgaWNvbk9ubHkKICAgICAgfQogICAgfSkKICB9CgogIC8qIOWGmeS4quWHveaVsO+8jOaUr+aMgeWwhm1lbnVDb25maWcuZHJvcGRvd25NZW5155qE5pWw5o2u5p6E5bu65oiQc2wtbWVudee7hOS7tueahHRlbXBsYXRlICovCiAgZnVuY3Rpb24gY29udmVydERyb3Bkb3duTWVudVRvVGVtcGxhdGUgKGRyb3Bkb3duTWVudSwgaXNSb290TWVudSA9IHRydWUpIHsKICAgIGNvbnN0IG1lbnVJdGVtcyA9IGRyb3Bkb3duTWVudS5tYXAoaXRlbSA9PiB7CiAgICAgIGlmIChpdGVtLmRpc2FibGVkKSByZXR1cm4gJycKCiAgICAgIGNvbnN0IGxhbmcgPSBpdGVtLmxhbmcgfHwgaXRlbS5sYW5ndWFnZSB8fCBpdGVtLmxhbmd1YWdlczsKICAgICAgaWYgKGxhbmcgJiYgIWkxOG4uaXNNYXRjaEN1ckxhbmcobGFuZykpIHJldHVybiAnJwoKICAgICAgY29uc3QgdGl0bGUgPSAoaXRlbS50aXRsZSBpbnN0YW5jZW9mIEZ1bmN0aW9uID8gaXRlbS50aXRsZSgpIDogaXRlbS50aXRsZSkgfHwgJyc7CiAgICAgIGNvbnN0IGRlc2MgPSAoaXRlbS5kZXNjIGluc3RhbmNlb2YgRnVuY3Rpb24gPyBpdGVtLmRlc2MoKSA6IGl0ZW0uZGVzYykgfHwgJyc7CiAgICAgIGNvbnN0IGlkID0gaXRlbS5pZCB8fCBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMik7CgogICAgICBpZiAoaXRlbS5zdWJNZW51KSB7CiAgICAgICAgcmV0dXJuIGAKICAgICAgICA8c2wtbWVudS1pdGVtIGNsYXNzPSJoNXAtbWVudS1hY3Rpb24iIHZhbHVlPSIke2lkfSIgdGl0bGU9IiR7ZGVzYyB8fCB0aXRsZX0iIGRhdGEtYWN0aW9uPSIke2l0ZW0uYWN0aW9uIHx8ICcnfSIgZGF0YS1hcmdzPScke0pTT04uc3RyaW5naWZ5KGl0ZW0uYXJncyB8fCBudWxsKX0nPgogICAgICAgICAgJHt0aXRsZX0KICAgICAgICAgIDxzbC1tZW51IHNsb3Q9InN1Ym1lbnUiPgogICAgICAgICAgICAke2NvbnZlcnREcm9wZG93bk1lbnVUb1RlbXBsYXRlKGl0ZW0uc3ViTWVudSwgZmFsc2UpfQogICAgICAgICAgPC9zbC1tZW51PgogICAgICAgIDwvc2wtbWVudS1pdGVtPgogICAgICBgCiAgICAgIH0gZWxzZSBpZiAoaXRlbS5kaXZpZGVyKSB7CiAgICAgICAgcmV0dXJuICc8c2wtZGl2aWRlcj48L3NsLWRpdmlkZXI+JwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBgPHNsLW1lbnUtaXRlbSBjbGFzcz0iaDVwLW1lbnUtYWN0aW9uIiB2YWx1ZT0iJHtpZH0iIHRpdGxlPSIke2Rlc2MgfHwgdGl0bGV9IiBkYXRhLWFjdGlvbj0iJHtpdGVtLmFjdGlvbiB8fCAnJ30iIGRhdGEtYXJncz0nJHtKU09OLnN0cmluZ2lmeShpdGVtLmFyZ3MgfHwgbnVsbCl9JyBkYXRhLXVybD0iJHtpdGVtLnVybCB8fCAnJ30iPgogICAgICAgICR7dGl0bGV9CiAgICAgIDwvc2wtbWVudS1pdGVtPgogICAgICBgCiAgICAgIH0KICAgIH0pLmpvaW4oJycpOwoKICAgIHJldHVybiBpc1Jvb3RNZW51ID8gYDxzbC1tZW51PiR7bWVudUl0ZW1zfTwvc2wtbWVudT5gIDogbWVudUl0ZW1zCiAgfQoKICAvKiDlhpnkuIDkuKrlh73mlbDlj6/ku6XlsIZtZW51Q29uZmln6L2s5o2i5oiQdGVtcGxhdGXov5vooYzovpPlh7ogKi8KICBmdW5jdGlvbiBjb252ZXJ0TWVudUNvbmZpZ1RvVGVtcGxhdGUgKG1lbnVDb25maWcpIHsKICAgIHJldHVybiBgCiAgPGRpdiBjbGFzcz0iaDVwLWFjdGlvbi1tb2QiPgogICAgICAke21lbnVDb25maWcubWFwKGl0ZW0gPT4gewogICAgICAgIGlmIChpdGVtLmRpc2FibGVkKSByZXR1cm4gJycKCiAgICAgICAgY29uc3QgbGFuZyA9IGl0ZW0ubGFuZyB8fCBpdGVtLmxhbmd1YWdlIHx8IGl0ZW0ubGFuZ3VhZ2VzOwogICAgICAgIGlmIChsYW5nICYmICFpMThuLmlzTWF0Y2hDdXJMYW5nKGxhbmcpKSByZXR1cm4gJycKCiAgICAgICAgY29uc3QgdGl0bGUgPSAoaXRlbS50aXRsZSBpbnN0YW5jZW9mIEZ1bmN0aW9uID8gaXRlbS50aXRsZSgpIDogaXRlbS50aXRsZSkgfHwgJyc7CiAgICAgICAgY29uc3QgZGVzYyA9IChpdGVtLmRlc2MgaW5zdGFuY2VvZiBGdW5jdGlvbiA/IGl0ZW0uZGVzYygpIDogaXRlbS5kZXNjKSB8fCAnJzsKICAgICAgICBjb25zdCBpY29uSHRtbCA9IGl0ZW0uaWNvbiA/IGA8c2wtaWNvbiBzcmM9IiR7aXRlbS5pY29ufSI+PC9zbC1pY29uPmAgOiAnJzsKICAgICAgICBjb25zdCBtZW51RGVzYyA9IGl0ZW0uaWNvbk9ubHkgJiYgaWNvbkh0bWwgPyAnJyA6IGA8c3BhbiBjbGFzcz0iaDVwLWRlc2MiPiR7dGl0bGV9PC9zcGFuPmA7CgogICAgICAgIGlmIChpdGVtLmRyb3Bkb3duTWVudSkgewogICAgICAgICAgcmV0dXJuIGAKICAgICAgICAgICAgPHNsLWRyb3Bkb3duIGRpc3RhbmNlPSI2Ij4KICAgICAgICAgICAgICA8c3BhbiBzbG90PSJ0cmlnZ2VyIiBjbGFzcz0iaDVwLWFjdGlvbi1idG4iIHRpdGxlPSIke2Rlc2MgfHwgdGl0bGV9IiBkYXRhLXRpdGxlPSIke3RpdGxlfSIgZGF0YS1hY3Rpb249IiR7aXRlbS5hY3Rpb24gfHwgJyd9Ij4KICAgICAgICAgICAgICAgICR7aWNvbkh0bWx9CiAgICAgICAgICAgICAgICAke21lbnVEZXNjfQogICAgICAgICAgICAgIDwvc3Bhbj4KICAgICAgICAgICAgICAke2NvbnZlcnREcm9wZG93bk1lbnVUb1RlbXBsYXRlKGl0ZW0uZHJvcGRvd25NZW51KX0KICAgICAgICAgICAgPC9zbC1kcm9wZG93bj4KICAgICAgICAgIGAKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIGAKICAgICAgICAgICAgPHNwYW4gY2xhc3M9Img1cC1hY3Rpb24tYnRuIGg1cC1tZW51LWFjdGlvbiIgdGl0bGU9IiR7ZGVzYyB8fCB0aXRsZX0iIGRhdGEtdGl0bGU9IiR7dGl0bGV9IiBkYXRhLWFjdGlvbj0iJHtpdGVtLmFjdGlvbiB8fCAnJ30iIGRhdGEtYXJncz0nJHtKU09OLnN0cmluZ2lmeShpdGVtLmFyZ3MgfHwgbnVsbCl9Jz4KICAgICAgICAgICAgICAke2ljb25IdG1sfQogICAgICAgICAgICAgICR7bWVudURlc2N9CiAgICAgICAgICAgIDwvc3Bhbj4KICAgICAgICAgIGAKICAgICAgICB9CiAgICAgIH0pLmpvaW4oJycpCiAgICB9IAogIDwvZGl2PgogIGAKICB9CgogIGZ1bmN0aW9uIGNyZWF0ZU1lbnVUZW1wbGF0ZSAoY29uZmlnID0gbWVudUNvbmZpZyB8fCBbXSkgewogICAgcmV0dXJuIGNvbnZlcnRNZW51Q29uZmlnVG9UZW1wbGF0ZShjb25maWcpCiAgfQoKICBmdW5jdGlvbiBjcmVhdGVMb2dvTW9kVGVtcGxhdGUgKCkgewogICAgY29uc3QgaG9tZXBhZ2UgPSBnbG9iYWxGdW5jdGlvbmFsLmdldEhvbWVQYWdlTGluay5mbigpOwogICAgcmV0dXJuIGA8YSBjbGFzcz0iaDVwLWxvZ28tbW9kIiBocmVmPSIke2hvbWVwYWdlfSIgdGFyZ2V0PSJfYmxhbmsiPmg1cGxheWVyPC9hPmAKICB9CgogIGNvbnN0IGRlZmF1bHRSZWNvbW1lbmRMaXN0ID0gW107CgogIGZ1bmN0aW9uIGNyZWF0ZVJlY29tbWVuZE1vZFRlbXBsYXRlIChyZWZEb20pIHsKICAgIGNvbnN0IHNob3dNb2QgPSBpc0dsb2JhbFN0b3JhZ2VVc2FibGUgJiYgY29uZmlnTWFuYWdlciQxLmdldEdsb2JhbFN0b3JhZ2UoJ3VpLm1vZC5yZWNvbW1lbmQuZW5hYmxlJyk7CiAgICBpZiAoIXNob3dNb2QpIHsgcmV0dXJuICcnIH0KCiAgICBjb25zdCByZWZXaWR0aCA9IHJlZkRvbS5vZmZzZXRXaWR0aDsKICAgIGlmIChyZWZXaWR0aCA8IDUwMCkgeyByZXR1cm4gJycgfQoKICAgIGxldCByZWNvbW1lbmRMaXN0ID0gY29uZmlnTWFuYWdlciQxLmdldEdsb2JhbFN0b3JhZ2UoJ3JlY29tbWVuZExpc3QnKSB8fCBkZWZhdWx0UmVjb21tZW5kTGlzdDsKICAgIHJlY29tbWVuZExpc3QgPSByZWNvbW1lbmRMaXN0LmZpbHRlcihpdGVtID0+ICFpdGVtLmRpc2FibGVkKTsKCiAgICBjb25zdCBjdXJMYW5nID0gaTE4bi5sYW5ndWFnZSgpIHx8ICcnOwogICAgLyog5YW85a655ZCE56eN5Y+v6IO955qE6K+t6KiA6YWN572u5YaZ5rOVICovCiAgICBjb25zdCBjdXJMYW5nMiA9IGN1ckxhbmcucmVwbGFjZSgnLScsICcnKTsKICAgIGNvbnN0IGN1ckxhbmczID0gY3VyTGFuZy5yZXBsYWNlKCctJywgJ18nKTsKICAgIGNvbnN0IGN1ckxhbmc0ID0gY3VyTGFuZy5zcGxpdCgnLScpWzBdOwoKICAgIC8qIOagueaNruW9k+WJjeeahGxhbmd1YWdl5ZKMcmVjb21tZW5kTGlzdOeahGxhbmd1YWdlc+mFjee9rui/h+a7pOWHuuespuWQiOW9k+WJjeivreiogOeahHJlY29tbWVuZExpc3QgKi8KICAgIHJlY29tbWVuZExpc3QgPSByZWNvbW1lbmRMaXN0LmZpbHRlcihpdGVtID0+IHsKICAgICAgY29uc3QgbGFuZyA9IGl0ZW0ubGFuZyB8fCBpdGVtLmxhbmd1YWdlIHx8IGl0ZW0ubGFuZ3VhZ2VzOwogICAgICBpZiAobGFuZykgewogICAgICAgIHJldHVybiBpMThuLmlzTWF0Y2hDdXJMYW5nKGxhbmcpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRydWUKICAgICAgfQogICAgfSk7CgogICAgaWYgKCFyZWNvbW1lbmRMaXN0Lmxlbmd0aCkgeyByZXR1cm4gJycgfQoKICAgIC8qIOS7jnJlY29tbWVuZExpc3Tph4zpmo/mnLrlj5Y15p2h5pWw5o2u77yM5aSa5L2Z55qE5LiN5LqI5Lul5bGV56S6ICovCiAgICBpZiAocmVjb21tZW5kTGlzdC5sZW5ndGggPiA1KSB7IHJlY29tbWVuZExpc3QgPSByZWNvbW1lbmRMaXN0LnNvcnQoKCkgPT4gTWF0aC5yYW5kb20oKSAtIDAuNSkuc2xpY2UoMCwgNSk7IH0KCiAgICAvKiDmoLnmja5yZWNvbW1lbmRMaXN06YeM55qEcHJpb3JpdHnlrZfmrrXov5vooYzmjpLluo/vvIxwcmlvcml0eeWAvOi2iuWkp+i2iumdoOWJjSAqLwogICAgcmVjb21tZW5kTGlzdCA9IHJlY29tbWVuZExpc3Quc29ydCgoYSwgYikgPT4gKGIucHJpb3JpdHkgfHwgMCkgLSAoYS5wcmlvcml0eSB8fCAwKSk7CgogICAgY29uc3QgcmVjb21tZW5kSHRtbCA9IHJlY29tbWVuZExpc3QubWFwKGl0ZW0gPT4gewogICAgICBsZXQgdGl0bGUgPSBpdGVtLnRpdGxlIHx8ICcnOwogICAgICBsZXQgZGVzYyA9IGl0ZW0uZGVzYyB8fCAnJzsKICAgICAgbGV0IHVybCA9IGl0ZW0udXJsIHx8ICcnOwoKICAgICAgaWYgKGl0ZW0uaTE4bikgewogICAgICAgIGNvbnN0IGkxOG5JbmZvID0gaXRlbS5pMThuW2Ake2N1ckxhbmd9YF0gfHwgaXRlbS5pMThuW2Ake2N1ckxhbmcyfWBdIHx8IGl0ZW0uaTE4bltgJHtjdXJMYW5nM31gXSB8fCBpdGVtLmkxOG5bYCR7Y3VyTGFuZzR9YF07CiAgICAgICAgaWYgKGkxOG5JbmZvKSB7CiAgICAgICAgICB0aXRsZSA9IGkxOG5JbmZvLnRpdGxlIHx8IHRpdGxlOwogICAgICAgICAgZGVzYyA9IGkxOG5JbmZvLmRlc2MgfHwgZGVzYzsKICAgICAgICAgIHVybCA9IGkxOG5JbmZvLnVybCB8fCB1cmw7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gYDxhIGNsYXNzPSJoNXAtcmVjb21tZW5kLWl0ZW0iIGhyZWY9IiR7dXJsfSIgdGl0bGU9IiR7ZGVzY30iIHRhcmdldD0iX2JsYW5rIj4ke3RpdGxlfTwvYT5gCiAgICB9KS5qb2luKCcnKTsKCiAgICByZXR1cm4gYDxkaXYgY2xhc3M9Img1cC1yZWNvbW1lbmQtbW9kIiA+JHtyZWNvbW1lbmRIdG1sfTwvZGl2PmAKICB9CgogIC8qKgogICAqIOazqOWGjFJlY29tbWVuZOWIh+aNoumAu+i+ke+8jOavjzRz5qOA5rWL5LiA5qyh5b2T5YmN5ZOq5LiqaDVwLXJlY29tbWVuZC1pdGVt5LiK5pyJaDVwLXJlY29tbWVuZC1pdGVtX19hY3RpdmXvvIznhLblkI7lsIZoNXAtcmVjb21tZW5kLWl0ZW1fX2FjdGl2ZeWIh+aNouWIsOS4i+S4gOS4quWFg+e0oO+8jOWmguatpOW+gOWkjQogICAqIOW9k+m8oOagh+enu+WKqOWIsHJlY29tbWVuZFdyYXDnmoTml7blgJnlgZzmraLliIfmjaLvvIznp7vlvIDlkI7nu6fnu63liIfmjaIKICAgKi8KICBmdW5jdGlvbiByZWdpc3RlclJlY29tbWVuZE1vZFRvZ2dsZSAocmVjb21tZW5kV3JhcCwgcmVSZW5kZXIpIHsKICAgIGlmICghcmVSZW5kZXIgJiYgKCFyZWNvbW1lbmRXcmFwIHx8IHJlY29tbWVuZFdyYXAuX19oNXBSZWNvbW1lbmRNb2RSZWdpc3RlcmVkX18pKSB7IHJldHVybiB9CgogICAgbGV0IHJlY29tbWVuZEluZGV4ID0gMDsKICAgIHJlY29tbWVuZFdyYXAuX19zdG9wVG9nZ2xlX18gPSBmYWxzZTsKCiAgICBjb25zdCB0b2dnbGVSZWNvbW1lbmQgPSAoKSA9PiB7CiAgICAgIGlmIChyZWNvbW1lbmRXcmFwLl9fc3RvcFRvZ2dsZV9fKSB7IHJldHVybiB9CiAgICAgIGNvbnN0IHJlY29tbWVuZEl0ZW1zID0gcmVjb21tZW5kV3JhcC5xdWVyeVNlbGVjdG9yQWxsKCcuaDVwLXJlY29tbWVuZC1pdGVtJyk7CiAgICAgIHJlY29tbWVuZEl0ZW1zLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7CiAgICAgICAgaWYgKGluZGV4ID09PSByZWNvbW1lbmRJbmRleCkgewogICAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKCdoNXAtcmVjb21tZW5kLWl0ZW1fX2FjdGl2ZScpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2g1cC1yZWNvbW1lbmQtaXRlbV9fYWN0aXZlJyk7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIHJlY29tbWVuZEluZGV4ID0gKHJlY29tbWVuZEluZGV4ICsgMSkgJSByZWNvbW1lbmRJdGVtcy5sZW5ndGg7CiAgICB9OwoKICAgIHRvZ2dsZVJlY29tbWVuZCgpOwoKICAgIGNsZWFySW50ZXJ2YWwocmVjb21tZW5kV3JhcC5fX2g1cFJlY29tbWVuZE1vZEludGVydmFsX18pOwogICAgcmVjb21tZW5kV3JhcC5fX2g1cFJlY29tbWVuZE1vZEludGVydmFsX18gPSBzZXRJbnRlcnZhbCh0b2dnbGVSZWNvbW1lbmQsIDMwMDApOwogICAgaWYgKCFyZVJlbmRlcikgewogICAgICByZWNvbW1lbmRXcmFwLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7IHJlY29tbWVuZFdyYXAuX19zdG9wVG9nZ2xlX18gPSB0cnVlOyB9KTsKICAgICAgcmVjb21tZW5kV3JhcC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4geyByZWNvbW1lbmRXcmFwLl9fc3RvcFRvZ2dsZV9fID0gZmFsc2U7IH0pOwogICAgfQoKICAgIHJlY29tbWVuZFdyYXAuX19oNXBSZWNvbW1lbmRNb2RSZWdpc3RlcmVkX18gPSB0cnVlOwogIH0KCiAgLyoqCiAgICog6YCa6L+H5LqL5Lu25aeU5omY55qE5pa55byP5aSE55CG6I+c5Y2V54K55Ye75LqL5Lu277yM5YeP5bCR5LqL5Lu257uR5a6a77yM5o+Q5Y2H5oCn6IO9CiAgICogQHBhcmFtIHsgRXZlbnQgfSBldmVudCAt5b+F6YCJIOS6i+S7tuWvueixoQogICAqLwogIGZ1bmN0aW9uIG1lbnVBY3Rpb25IYW5kbGVyIChvYmopIHsKICAgIGNvbnN0IHsgZXZlbnQsIGg1UGxheWVyLCBoNXBsYXllclVJLCB2aWRlb0VsZW1lbnQsIHBvcHVwLCBhY3Rpb25DYWxsYmFjayB9ID0gb2JqOwogICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0OwoKICAgIC8qIOagueaNrnRhcmdldOafpeaJvuaYr+WQpuWMheWQq2RhdGEtYWN0aW9u5bGe5oCn77yM5rOo5oSP6L+Z6YeM5Y+v6IO96ZyA6KaB5L2/55SoY2xvc2VzdOadpeWQkeS4iuafpeaJviAqLwogICAgY29uc3QgYWN0aW9uRE9NID0gdGFyZ2V0LmNsb3Nlc3QoJy5oNXAtbWVudS1hY3Rpb24nKTsKICAgIGlmICghYWN0aW9uRE9NKSB7CiAgICAgIGRlYnVnJDEubG9nKCdbbWVudUFjdGlvbkhhbmRsZXJdJywgJ+acquaJvuWIsGFjdGlvbkRPTScsIGV2ZW50LnRhcmdldCk7CiAgICAgIHJldHVybgogICAgfQoKICAgIGNvbnN0IGFjdGlvbiA9IGFjdGlvbkRPTS5nZXRBdHRyaWJ1dGUoJ2RhdGEtYWN0aW9uJyk7CiAgICBjb25zdCBhcmdzID0gSlNPTi5wYXJzZShhY3Rpb25ET00uZ2V0QXR0cmlidXRlKCdkYXRhLWFyZ3MnKSB8fCBudWxsKTsKICAgIGNvbnN0IHVybCA9IGFjdGlvbkRPTS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdXJsJyk7CgogICAgaWYgKHVybCkgewogICAgICBnbG9iYWxGdW5jdGlvbmFsLm9wZW5JblRhYih1cmwpOwogICAgICByZXR1cm4KICAgIH0KCiAgICBoNVBsYXllci5zZXRQbGF5ZXJJbnN0YW5jZSh2aWRlb0VsZW1lbnQpOwoKICAgIGlmIChhY3Rpb24gPT09ICdkaXNhYmxlR1VJVGVtcG9yYXJpbHknKSB7CiAgICAgIGg1cGxheWVyVUkuZGlzYWJsZUdVSVRlbXBvcmFyaWx5KCk7CiAgICAgIGRlYnVnJDEubG9nKCdbbWVudUFjdGlvbkhhbmRsZXJdW2Rpc2FibGVHVUlUZW1wb3JhcmlseV0nKTsKICAgICAgcmV0dXJuCiAgICB9CgogICAgaWYgKGFjdGlvbiAmJiAoaDVQbGF5ZXJbYWN0aW9uXSBpbnN0YW5jZW9mIEZ1bmN0aW9uIHx8IGdsb2JhbEZ1bmN0aW9uYWxbYWN0aW9uXSkpIHsKICAgICAgLy8gZGVidWcubG9nKCdbbWVudUFjdGlvbkhhbmRsZXJdJywgYWN0aW9uRE9NLCBhY3Rpb24sIGFyZ3MpCgogICAgICB0cnkgewogICAgICAgIGlmIChhY3Rpb24gPT09ICdzZXRQbGF5YmFja1JhdGUnKSB7CiAgICAgICAgICAvKiDkvb/nlKhVSeaTjeS9nOmcgOW8uuihjOi3s+i/h+mUgeajgOa1i+mAu+i+kSAqLwogICAgICAgICAgaDVQbGF5ZXIuc2V0UGxheWJhY2tSYXRlKGFyZ3MsIGZhbHNlLCBmYWxzZSwgdHJ1ZSk7CiAgICAgICAgfSBlbHNlIGlmIChnbG9iYWxGdW5jdGlvbmFsW2FjdGlvbl0gJiYgZ2xvYmFsRnVuY3Rpb25hbFthY3Rpb25dLmZuIGluc3RhbmNlb2YgRnVuY3Rpb24pIHsKICAgICAgICAgIGdsb2JhbEZ1bmN0aW9uYWxbYWN0aW9uXS5mbihhcmdzKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaDVQbGF5ZXJbYWN0aW9uXShhcmdzKTsKICAgICAgICAgIHBvcHVwICYmIHBvcHVwLnJlcG9zaXRpb24oKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICBkZWJ1ZyQxLmVycm9yKCdbbWVudUFjdGlvbkhhbmRsZXJdW2Vycm9yXScsIGUpOwogICAgICB9CgogICAgICBpZiAoYWN0aW9uQ2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikgewogICAgICAgIGFjdGlvbkNhbGxiYWNrKGFjdGlvbiwgYXJncyk7CiAgICAgIH0KICAgIH0KICB9CgogIC8vIGh0dHBzOi8vc2hvZWxhY2Uuc3R5bGUvZ2V0dGluZy1zdGFydGVkL2luc3RhbGxhdGlvbiNidW5kbGluZwoKICBpZiAoIXdpbmRvdy5oNXBsYXllclVJUHJvdmlkZXIpIHsKICAgIHRocm93IG5ldyBFcnJvcignaDVwbGF5ZXJVSVByb3ZpZGVyIGlzIG5vdCBkZWZpbmVkLCBwbGVhc2UgY2hlY2sgaWYgeW91IGhhdmUgaW1wb3J0ZWQgaDVwbGF5ZXJVSVByb3ZpZGVyLmpzJykKICB9CgogIGNvbnN0IHsgZGVidWcsIHBhcnNlSFRNTCwgb2JzZXJ2ZVZpc2liaWxpdHksIGlzT3V0T2ZEb2N1bWVudCwgY29uZmlnTWFuYWdlciwgZGV2aWNlIH0gPSB3aW5kb3cuaDVwbGF5ZXJVSVByb3ZpZGVyOwoKICBjb25zdCBwb3B1cFdyYXBPYmpzID0ge307CgogIGZ1bmN0aW9uIHJlbW92ZVBvcHVwV3JhcEJ5SWQgKHBvcHVwV3JhcElkKSB7CiAgICBjb25zdCBwb3B1cFdyYXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtwb3B1cFdyYXBJZH1gKTsKICAgIGlmIChwb3B1cFdyYXApIHsKICAgICAgcG9wdXBXcmFwLnJlbW92ZSgpOwogICAgfQoKICAgIGRlbGV0ZSBwb3B1cFdyYXBPYmpzW3BvcHVwV3JhcElkXTsKICB9CgogIGZ1bmN0aW9uIHJlbW92ZVBvcHVwV3JhcEJ5RWxlbWVudCAoZWxlbWVudCkgewogICAgaWYgKCFlbGVtZW50KSB7IHJldHVybiBmYWxzZSB9CiAgICBjb25zdCBwb3B1cFdyYXBJZCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLXBvcHVwLXdyYXAtaWQnKTsKICAgIGlmIChwb3B1cFdyYXBJZCkgeyByZW1vdmVQb3B1cFdyYXBCeUlkKHBvcHVwV3JhcElkKTsgfQogIH0KCiAgLyog6YGN5Y6GcG9wdXBXcmFwT2Jqc++8jOWmguaenHBvcHVwV3JhcE9ianPkuK3nmoRlbGVtZW505YWD57Sg55qEb2Zmc2V0UGFyZW505Li6bnVsbO+8jOWImeenu+mZpOaOiSAqLwogIGZ1bmN0aW9uIGNsZWFuUG9wdXBXcmFwICgpIHsKICAgIGNvbnN0IHBvcHVwV3JhcElkcyA9IE9iamVjdC5rZXlzKHBvcHVwV3JhcE9ianMpOwogICAgcG9wdXBXcmFwSWRzLmZvckVhY2gocG9wdXBXcmFwSWQgPT4gewogICAgICBjb25zdCBlbGVtZW50ID0gcG9wdXBXcmFwT2Jqc1twb3B1cFdyYXBJZF07CiAgICAgIGlmIChpc091dE9mRG9jdW1lbnQoZWxlbWVudCkpIHsKICAgICAgICByZW1vdmVQb3B1cFdyYXBCeUlkKHBvcHVwV3JhcElkKTsKICAgICAgfQogICAgfSk7CiAgfQoKICBmdW5jdGlvbiBnZXRBbGxQb3B1cFdyYXBFbGVtZW50ICgpIHsKICAgIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaDVwbGF5ZXItcG9wdXAtd3JhcCcpCiAgfQoKICBmdW5jdGlvbiBmaW5kUG9wdXBXcmFwV2l0aEVsZW1lbnQgKHZpZGVvRWxlbWVudCkgewogICAgY29uc3QgcmVzdWx0ID0gW107CiAgICBjb25zdCBwb3B1cFdyYXBJZHMgPSBPYmplY3Qua2V5cyhwb3B1cFdyYXBPYmpzKTsKICAgIHBvcHVwV3JhcElkcy5mb3JFYWNoKHBvcHVwV3JhcElkID0+IHsKICAgICAgY29uc3QgZWxlbWVudCA9IHBvcHVwV3JhcE9ianNbcG9wdXBXcmFwSWRdOwogICAgICBpZiAoZWxlbWVudCA9PT0gdmlkZW9FbGVtZW50KSB7CiAgICAgICAgcmVzdWx0LnB1c2gocG9wdXBXcmFwSWQpOwogICAgICB9CiAgICB9KTsKCiAgICByZXR1cm4gcmVzdWx0Lm1hcChpZCA9PiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpZH1gKSkKICB9CgogIGNvbnN0IGg1cGxheWVyVUkgPSB7CiAgICBhc3luYyBpbml0ICgpIHsKICAgICAgZGVidWcubG9nKCdoNXBsYXllclVJIGluaXQnKTsKCiAgICAgIC8qIOaPkuWFpee7hOS7tuebuOWFs+eahOagt+W8jyAqLwogICAgICBkb2N1bWVudC5hZG9wdGVkU3R5bGVTaGVldHMgPSBbLi4uZG9jdW1lbnQuYWRvcHRlZFN0eWxlU2hlZXRzLCBzaGVldF07CiAgICB9LAoKICAgIGRpc2FibGVHVUlUZW1wb3JhcmlseSAoKSB7CiAgICAgIHRoaXMuX19kaXNhYmxlR1VJVGVtcG9yYXJpbHlfXyA9IHRydWU7CiAgICAgIGNvbnN0IHBvcHVwV3JhcElkcyA9IE9iamVjdC5rZXlzKHBvcHVwV3JhcE9ianMpOwogICAgICBwb3B1cFdyYXBJZHMuZm9yRWFjaChwb3B1cFdyYXBJZCA9PiB7CiAgICAgICAgcmVtb3ZlUG9wdXBXcmFwQnlJZChwb3B1cFdyYXBJZCk7CiAgICAgIH0pOwogICAgfSwKCiAgICBnZXRBbGxQb3B1cFdyYXBFbGVtZW50LAogICAgZmluZFBvcHVwV3JhcFdpdGhFbGVtZW50LAogICAgY2xlYW5Qb3B1cFdyYXAsCiAgICByZW1vdmVQb3B1cFdyYXBCeUlkLAogICAgcmVtb3ZlUG9wdXBXcmFwQnlFbGVtZW50LAoKICAgIHBvcHVwIChlbGVtZW50LCBoNVBsYXllcikgewogICAgICBpZiAodGhpcy5fX2Rpc2FibGVHVUlUZW1wb3JhcmlseV9fIHx8IGVsZW1lbnQuX19kaXNhYmxlR1VJVGVtcG9yYXJpbHlfXykgeyByZXR1cm4gZmFsc2UgfQoKICAgICAgLyog5aaC5p6cZWxlbWVudOWFg+e0oOeahOWuvemrmOavlOWkp+S6jjIuNe+8jOivtOaYjuWPr+iDveS4uuinhumikeiDjOaZr++8jOWImeS5n+S4jeaYvuekunBvcHVwICovCiAgICAgIGlmIChlbGVtZW50LnZpZGVvV2lkdGggLyBlbGVtZW50LnZpZGVvSGVpZ2h0ID4gMi41KSB7IHJldHVybiBmYWxzZSB9CgogICAgICAvKiDpmLLmraJwb3B1cOa4suafk+i/h+S6jumikee5gSAqLwogICAgICBpZiAodGhpcy5sYXN0UmVuZGVyZWRQb3B1cFRpbWUgJiYgRGF0ZS5ub3coKSAtIHRoaXMubGFzdFJlbmRlcmVkUG9wdXBUaW1lIDwgMTAwKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5sYXN0UmVuZGVyZWRQb3B1cFRpbWUgPSBEYXRlLm5vdygpOwogICAgICB9CgogICAgICAvKiDpmLLmraJwb3B1cOatu+W+queOr+a4suafkyAqLwogICAgICBpZiAoZWxlbWVudC5fX3BvcHVwUmVuZGVyZWRDb3VudF9fICYmIGVsZW1lbnQuX19wb3B1cFJlbmRlcmVkQ291bnRfXyA+IDE1KSB7CiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0gZWxzZSB7CiAgICAgICAgZWxlbWVudC5fX3BvcHVwUmVuZGVyZWRDb3VudF9fID0gZWxlbWVudC5fX3BvcHVwUmVuZGVyZWRDb3VudF9fID8gZWxlbWVudC5fX3BvcHVwUmVuZGVyZWRDb3VudF9fICsgMSA6IDE7CiAgICAgIH0KCiAgICAgIGlmICghZWxlbWVudCB8fCAhZWxlbWVudC50YWdOYW1lIHx8IGVsZW1lbnQudGFnTmFtZS50b0xvd2VyQ2FzZSgpICE9PSAndmlkZW8nIHx8IGlzT3V0T2ZEb2N1bWVudChlbGVtZW50KSkgewogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CgogICAgICBsZXQgcG9wdXBXcmFwSWQgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1wb3B1cC13cmFwLWlkJyk7CiAgICAgIGlmICghcG9wdXBXcmFwSWQpIHsKICAgICAgICBwb3B1cFdyYXBJZCA9ICdoNXBsYXllci1wb3B1cC13cmFwLScgKyBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMik7CiAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtcG9wdXAtd3JhcC1pZCcsIHBvcHVwV3JhcElkKTsKICAgICAgfQoKICAgICAgbGV0IHBvcHVwV3JhcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke3BvcHVwV3JhcElkfWApOwoKICAgICAgaWYgKCFwb3B1cFdyYXBPYmpzW3BvcHVwV3JhcElkXSkgewogICAgICAgIHBvcHVwV3JhcE9ianNbcG9wdXBXcmFwSWRdID0gZWxlbWVudDsKICAgICAgfQoKICAgICAgaWYgKHBvcHVwV3JhcCkgewogICAgICAgIGNvbnN0IHBvcHVwID0gcG9wdXBXcmFwLnF1ZXJ5U2VsZWN0b3IoJ3NsLXBvcHVwJyk7CiAgICAgICAgcG9wdXAgJiYgcG9wdXAucmVwb3NpdGlvbigpOwogICAgICAgIHJldHVybgogICAgICB9CgogICAgICBjb25zdCBtZW51VGVtcGxhdGUgPSBjcmVhdGVNZW51VGVtcGxhdGUobWVudUNvbmZpZ1ByZXByb2Nlc3MobWVudUNvbmZpZywgZWxlbWVudCkpOwogICAgICBwb3B1cFdyYXAgPSBwYXJzZUhUTUwoYAogICAgICA8ZGl2IGlkPSIke3BvcHVwV3JhcElkfSIgY2xhc3M9Img1cGxheWVyLXBvcHVwLXdyYXAiPgogICAgICAgIDxzbC1wb3B1cCBwbGFjZW1lbnQ9InRvcCIgc3luYz0id2lkdGgiPgogICAgICAgIDxkaXYgY2xhc3M9Img1cGxheWVyLXBvcHVwLWNvbnRlbnQiPgogICAgICAgICAgPGRpdiBjbGFzcz0iaDVwLWxvZ28td3JhcCI+CiAgICAgICAgICAgICR7Y3JlYXRlTG9nb01vZFRlbXBsYXRlKCl9CiAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDxkaXYgY2xhc3M9Img1cC1yZWNvbW1lbmQtd3JhcCI+CiAgICAgICAgICAgIDxkaXYgc3R5bGU9Im92ZXJmbG93OmhpZGRlbiI+JHtjcmVhdGVSZWNvbW1lbmRNb2RUZW1wbGF0ZShlbGVtZW50KX08L2Rpdj4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0iaDVwLW1lbnUtd3JhcCI+CiAgICAgICAgICAgICR7bWVudVRlbXBsYXRlfQogICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPC9zbC1wb3B1cD4KICAgICAgPC9kaXY+CiAgICBgLCBkb2N1bWVudC5ib2R5KVswXTsKCiAgICAgIHNldFRpbWVvdXQoKCkgPT4geyByZWdpc3RlclJlY29tbWVuZE1vZFRvZ2dsZShwb3B1cFdyYXAucXVlcnlTZWxlY3RvcignLmg1cC1yZWNvbW1lbmQtd3JhcCcpKTsgfSwgMTAwKTsKCiAgICAgIGNvbnN0IHBvcHVwID0gcG9wdXBXcmFwLnF1ZXJ5U2VsZWN0b3IoJ3NsLXBvcHVwJyk7CgogICAgICAvKioKICAgICAgICog5Yik5patcG9wdXDliJ3lp4vljJbmmK/lkKblvILluLjvvIzmsrnnrqHkuIrkvb/nlKjkuoZjdXN0b20tZWxlbWVudHMtZXM1LWFkYXB0ZXIuanPvvIzkvJrlr7zoh7Rwb3B1cOW8guW4uO+8jOaVheacieatpOWIpOaWrQogICAgICAgKiDkvovlpoLvvJpodHRwczovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PWpzYi01SF9oeTBNCiAgICAgICAqIOS+i+Wmgu+8mmh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9LTJ4YjdyR0NpMmsKICAgICAgICovCiAgICAgIGZ1bmN0aW9uIGNoZWNrUG9wdXBVcGRhdGVDb21wbGV0ZSAoKSB7CiAgICAgICAgaWYgKCFwb3B1cCB8fCAhcG9wdXAudXBkYXRlQ29tcGxldGUgfHwgIXBvcHVwLnVwZGF0ZUNvbXBsZXRlLnRoZW4pIHsKICAgICAgICAgIC8vIGRlYnVnLmVycm9yKCdbaDVwbGF5ZXJVSV1bcG9wdXBdW3VwZGF0ZUNvbXBsZXRlXSwg57uE5Lu25Yid5aeL5YyW5byC5bi4JywgcG9wdXAsIGVsZW1lbnQpCiAgICAgICAgICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1wb3B1cC13cmFwLWlkJyk7CiAgICAgICAgICBwb3B1cFdyYXAucmVtb3ZlKCk7CiAgICAgICAgICBkZWxldGUgcG9wdXBXcmFwT2Jqc1twb3B1cFdyYXBJZF07CiAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICB9CgogICAgICAgIHJldHVybiB0cnVlCiAgICAgIH0KCiAgICAgIC8qIOehruS/nXBvcHVw5bey57uP6KKr5riy5p+TICovCiAgICAgIGN1c3RvbUVsZW1lbnRzLndoZW5EZWZpbmVkKCdzbC1wb3B1cCcpLnRoZW4oKCkgPT4gewogICAgICAgIGlmICghY2hlY2tQb3B1cFVwZGF0ZUNvbXBsZXRlKCkpIHsKICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgIH0KCiAgICAgICAgcG9wdXAudXBkYXRlQ29tcGxldGUudGhlbigoKSA9PiB7CiAgICAgICAgICBwb3B1cC5hbmNob3IgPSBlbGVtZW50OwogICAgICAgICAgcG9wdXAuZGlzdGFuY2UgPSAtNDg7CiAgICAgICAgICBwb3B1cC5hY3RpdmUgPSB0cnVlOwogICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7IHBvcHVwLnJlcG9zaXRpb24oKTsgfSwgNjAwKTsKICAgICAgICB9KTsKICAgICAgfSk7CgogICAgICAvKiDph43mlrDmuLLmn5NoNXAtYWN0aW9uLW1vZOWvueW6lOeahOiPnOWNle+8jOS7peS+v+abtOaWsOiPnOWNleeKtuaAgSAqLwogICAgICBmdW5jdGlvbiByZVJlbmRlck1lbnVNb2QgKCkgewogICAgICAgIGNvbnN0IG1lbnVXcmFwID0gcG9wdXBXcmFwLnF1ZXJ5U2VsZWN0b3IoJy5oNXBsYXllci1wb3B1cC1jb250ZW50IC5oNXAtbWVudS13cmFwJyk7CiAgICAgICAgY29uc3QgYWN0aW9uTW9kID0gcG9wdXBXcmFwLnF1ZXJ5U2VsZWN0b3IoJy5oNXAtYWN0aW9uLW1vZCcpOwogICAgICAgIGlmIChtZW51V3JhcCAmJiBhY3Rpb25Nb2QpIHsKICAgICAgICAgIG1lbnVXcmFwLnJlbW92ZUNoaWxkKGFjdGlvbk1vZCk7CgogICAgICAgICAgY29uc3QgbmV3TWVudVRlbXBsYXRlID0gY3JlYXRlTWVudVRlbXBsYXRlKG1lbnVDb25maWdQcmVwcm9jZXNzKG1lbnVDb25maWcsIGVsZW1lbnQpKTsKICAgICAgICAgIHBhcnNlSFRNTChuZXdNZW51VGVtcGxhdGUsIG1lbnVXcmFwKTsKCiAgICAgICAgICAvKiDlm77moIfliqDovb3lpLHotKXml7bvvIznp7vpmaTlm77moIflhYPntKAgKi8KICAgICAgICAgIGNvbnN0IHNsSWNvbnMgPSBwb3B1cFdyYXAucXVlcnlTZWxlY3RvckFsbCgnc2wtaWNvbicpOwogICAgICAgICAgc2xJY29ucyAmJiBzbEljb25zLmZvckVhY2goc2xJY29uID0+IHsKICAgICAgICAgICAgc2xJY29uLmFkZEV2ZW50TGlzdGVuZXIoJ3NsLWVycm9yJywgKGV2ZW50KSA9PiB7CiAgICAgICAgICAgICAgY29uc3QgcGFyZW50ID0gZXZlbnQudGFyZ2V0LnBhcmVudEVsZW1lbnQ7CiAgICAgICAgICAgICAgZXZlbnQudGFyZ2V0LnJlbW92ZSgpOwoKICAgICAgICAgICAgICAvKiDmlLnkuLrlj6rmmL7npLrmloflrZfmoIfpopggKi8KICAgICAgICAgICAgICBpZiAocGFyZW50LmdldEF0dHJpYnV0ZSgnZGF0YS10aXRsZScpKSB7CiAgICAgICAgICAgICAgICBwYXJlbnQuaW5uZXJUZXh0ID0gcGFyZW50LmdldEF0dHJpYnV0ZSgnZGF0YS10aXRsZScpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgeyBvbmNlOiB0cnVlIH0pOwogICAgICAgICAgfSk7CgogICAgICAgICAgLy8gZGVidWcubG9nKCdbaDVwbGF5ZXJVSV1bcG9wdXBdW3JlUmVuZGVyTWVudU1vZF0nKQogICAgICAgIH0KICAgICAgfQoKICAgICAgLyog5rK5566h6aaW5qyh5riy5p+T5Lya6I6r5ZCN5YW25aaZ55qE5Ye66ZSZ77yM5omA5Lul5q2k5aSE5bu26L+f5LiA5q615pe26Ze06YeN5paw5riy5p+T5LiA5qyh6I+c5Y2VICovCiAgICAgIHNldFRpbWVvdXQoKCkgPT4geyByZVJlbmRlck1lbnVNb2QoKTsgfSwgNDAwKTsKCiAgICAgIC8qIOmHjeaWsOa4suafk2g1cC1yZWNvbW1lbmQtbW9k5a+55bqU55qE5o6o6I2Q5qih5Z2X77yM5aaC5p6c5L2N572u5LiN5aSf5YiZ5a+56ZqQ6JeP6K+l5qih5Z2XICovCiAgICAgIGZ1bmN0aW9uIHJlUmVuZGVyUmVjb21tZW5kTW9kICgpIHsKICAgICAgICBjb25zdCByZWNvbW1lbmRXcmFwID0gcG9wdXBXcmFwLnF1ZXJ5U2VsZWN0b3IoJy5oNXBsYXllci1wb3B1cC1jb250ZW50IC5oNXAtcmVjb21tZW5kLXdyYXAnKTsKICAgICAgICBjb25zdCByZWNvbW1lbmRNb2QgPSBwb3B1cFdyYXAucXVlcnlTZWxlY3RvcignLmg1cGxheWVyLXBvcHVwLWNvbnRlbnQgLmg1cC1yZWNvbW1lbmQtd3JhcD5kaXYnKTsKICAgICAgICBpZiAocmVjb21tZW5kV3JhcCAmJiByZWNvbW1lbmRNb2QpIHsKICAgICAgICAgIHJlY29tbWVuZFdyYXAucmVtb3ZlQ2hpbGQocmVjb21tZW5kTW9kKTsKCiAgICAgICAgICBjb25zdCBuZXdSZWNvbW1lbmRNb2RUZW1wbGF0ZSA9IGA8ZGl2IHN0eWxlPSJvdmVyZmxvdzpoaWRkZW4iPiR7Y3JlYXRlUmVjb21tZW5kTW9kVGVtcGxhdGUoZWxlbWVudCl9PC9kaXY+YDsKICAgICAgICAgIHBhcnNlSFRNTChuZXdSZWNvbW1lbmRNb2RUZW1wbGF0ZSwgcmVjb21tZW5kV3JhcCk7CgogICAgICAgICAgcmVnaXN0ZXJSZWNvbW1lbmRNb2RUb2dnbGUocmVjb21tZW5kV3JhcCwgdHJ1ZSk7CiAgICAgICAgICAvLyBkZWJ1Zy5sb2coJ1toNXBsYXllclVJXVtwb3B1cF1bcmVSZW5kZXJSZWNvbW1lbmRNb2RdJykKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IGFjdGl2ZUNsYXNzID0gJ2g1cGxheWVyLXBvcHVwLWFjdGl2ZSc7CiAgICAgIGNvbnN0IGZ1bGxBY3RpdmVDbGFzcyA9ICdoNXBsYXllci1wb3B1cC1mdWxsLWFjdGl2ZSc7CiAgICAgIGNvbnN0IGFsd2F5c1Nob3dVSUJhciA9IGNvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgndWkuYWx3YXlzU2hvdycpOwoKICAgICAgLyoqCiAgICAgICAqIOm8oOagh+enu+WKqOWIsHBvcHVwV3JhcOS4iuaXtuWinuWKoGZ1bGxBY3RpdmVDbGFzc+eahOagt+W8j+exu++8jOenu+WHuuS4gOauteaXtumXtOWQjuWGjeenu+mZpGZ1bGxBY3RpdmVDbGFzc+eahOagt+W8j+exuwogICAgICAgKiDnlKjkuo7pmLLmraLpvKDmoIfnp7vliqjliLBwb3B1cFdyYXDkuIrml7Zwb3B1cFdyYXDooqvlv6vpgJ/pmpDol4/vvIzku6Xmj5DnpLrmk43kvZzkvZPpqowKICAgICAgICovCiAgICAgIGxldCBtb3VzZWxlYXZlVGltZXIgPSBudWxsOwogICAgICBwb3B1cFdyYXAuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHsKICAgICAgICAvKiDlhYPntKDmr5TkvovlvILluLjvvIzkuI3mmL7npLpwb3B1cCAqLwogICAgICAgIGlmIChlbGVtZW50LnZpZGVvV2lkdGggLyBlbGVtZW50LnZpZGVvSGVpZ2h0ID4gMi41KSB7CiAgICAgICAgICBlbGVtZW50Ll9fZGlzYWJsZUdVSVRlbXBvcmFyaWx5X18gPSB0cnVlOwogICAgICAgICAgcmVtb3ZlUG9wdXBXcmFwQnlFbGVtZW50KGVsZW1lbnQpOwogICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgfQoKICAgICAgICBjbGVhclRpbWVvdXQobW91c2VsZWF2ZVRpbWVyKTsKICAgICAgICBpZiAoaXNPdXRPZkRvY3VtZW50KGVsZW1lbnQpKSB7CiAgICAgICAgICBwb3B1cFdyYXAuY2xhc3NMaXN0LnJlbW92ZShmdWxsQWN0aXZlQ2xhc3MpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBwb3B1cFdyYXAuY2xhc3NMaXN0LmFkZChmdWxsQWN0aXZlQ2xhc3MpOwogICAgICAgIH0KICAgICAgICBwb3B1cC5yZXBvc2l0aW9uKCk7CiAgICAgIH0pOwogICAgICBwb3B1cFdyYXAuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHsKICAgICAgICBjbGVhclRpbWVvdXQobW91c2VsZWF2ZVRpbWVyKTsKCiAgICAgICAgaWYgKGlzT3V0T2ZEb2N1bWVudChlbGVtZW50KSkgewogICAgICAgICAgcG9wdXBXcmFwLmNsYXNzTGlzdC5yZW1vdmUoZnVsbEFjdGl2ZUNsYXNzKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbW91c2VsZWF2ZVRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICFhbHdheXNTaG93VUlCYXIgJiYgIWVsZW1lbnQucGF1c2VkICYmIHBvcHVwV3JhcC5jbGFzc0xpc3QucmVtb3ZlKGFjdGl2ZUNsYXNzKTsKICAgICAgICAgICAgIWFsd2F5c1Nob3dVSUJhciAmJiAhZWxlbWVudC5wYXVzZWQgJiYgcG9wdXBXcmFwLmNsYXNzTGlzdC5yZW1vdmUoZnVsbEFjdGl2ZUNsYXNzKTsKCiAgICAgICAgICAgIC8qIOWFs+mXrXBvcHVwV3JhcOS4reeahOaJgOaciXNsLWRyb3Bkb3duICovCiAgICAgICAgICAgIGNvbnN0IGRyb3Bkb3ducyA9IHBvcHVwV3JhcC5xdWVyeVNlbGVjdG9yQWxsKCdzbC1kcm9wZG93bicpOwogICAgICAgICAgICBkcm9wZG93bnMuZm9yRWFjaChkcm9wZG93biA9PiB7CiAgICAgICAgICAgICAgZHJvcGRvd24uX29wZW5fID0gZmFsc2U7CiAgICAgICAgICAgICAgZHJvcGRvd24ub3BlbiA9IGZhbHNlOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIHJlUmVuZGVyTWVudU1vZCgpOwogICAgICAgICAgfSwgNTAwKTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgLy8gbGV0IGxhc3RPcGVuRHJvcGRvd25UaW1lID0gRGF0ZS5ub3coKQogICAgICBhc3luYyBmdW5jdGlvbiBvcGVuRHJvcGRvd24gKGV2ZW50KSB7CiAgICAgICAgLy8gaWYgKERhdGUubm93KCkgLSBsYXN0T3BlbkRyb3Bkb3duVGltZSA8IDEwMCkgeyByZXR1cm4gZmFsc2UgfQogICAgICAgIC8vIGxhc3RPcGVuRHJvcGRvd25UaW1lID0gRGF0ZS5ub3coKQoKICAgICAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQ7CgogICAgICAgIGNvbnN0IGFjdGlvbkJ0bkNsYXNzID0gJ2g1cC1hY3Rpb24tYnRuJzsKICAgICAgICBpZiAoISh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKGFjdGlvbkJ0bkNsYXNzKSB8fCB0YXJnZXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoYWN0aW9uQnRuQ2xhc3MpKSkgewogICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgfQoKICAgICAgICBjb25zdCBkcm9wZG93bnMgPSBwb3B1cFdyYXAucXVlcnlTZWxlY3RvckFsbCgnc2wtZHJvcGRvd24nKTsKICAgICAgICBjb25zdCBjdXJEcm9wZG93biA9IHRhcmdldC5wYXJlbnRFbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ3NsLWRyb3Bkb3duJyA/IHRhcmdldC5wYXJlbnRFbGVtZW50IDogdGFyZ2V0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudDsKICAgICAgICBjb25zdCBpc0Ryb3Bkb3duRG9tID0gY3VyRHJvcGRvd24gJiYgY3VyRHJvcGRvd24udGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnc2wtZHJvcGRvd24nOwoKICAgICAgICBpZiAoIWlzRHJvcGRvd25Eb20pIHsKICAgICAgICAgIGRyb3Bkb3ducy5mb3JFYWNoKGRyb3Bkb3duID0+IHsKICAgICAgICAgICAgZHJvcGRvd24ub3BlbiA9IGZhbHNlOwogICAgICAgICAgICBkcm9wZG93bi5fb3Blbl8gPSBmYWxzZTsKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgfQoKICAgICAgICBkcm9wZG93bnMuZm9yRWFjaChhc3luYyAoZHJvcGRvd24pID0+IHsKICAgICAgICAgIGlmIChkcm9wZG93biAhPT0gY3VyRHJvcGRvd24pIHsKICAgICAgICAgICAgZHJvcGRvd24uX29wZW5fID0gZmFsc2U7CiAgICAgICAgICAgIGF3YWl0IGRyb3Bkb3duLmhpZGUoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgaWYgKGV2ZW50LnR5cGUgPT09ICdtb3VzZW1vdmUnKSB7CiAgICAgICAgICBjdXJEcm9wZG93bi5fb3Blbl8gPSB0cnVlOwogICAgICAgICAgYXdhaXQgY3VyRHJvcGRvd24uc2hvdygpOwogICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgfQoKICAgICAgICBpZiAoIWN1ckRyb3Bkb3duLl9vcGVuXykgewogICAgICAgICAgYXdhaXQgY3VyRHJvcGRvd24uc2hvdygpOwogICAgICAgICAgY3VyRHJvcGRvd24uX29wZW5fID0gdHJ1ZTsKCiAgICAgICAgICBjdXJEcm9wZG93bi5hZGRFdmVudExpc3RlbmVyKCdzbC1hZnRlci1oaWRlJywgKCkgPT4gewogICAgICAgICAgICBjdXJEcm9wZG93bi5fb3Blbl8gPSBmYWxzZTsKICAgICAgICAgIH0sIHsgb25jZTogdHJ1ZSB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYXdhaXQgY3VyRHJvcGRvd24uaGlkZSgpOwogICAgICAgICAgY3VyRHJvcGRvd24uX29wZW5fID0gZmFsc2U7CgogICAgICAgICAgY3VyRHJvcGRvd24uYWRkRXZlbnRMaXN0ZW5lcignc2wtYWZ0ZXItc2hvdycsICgpID0+IHsKICAgICAgICAgICAgY3VyRHJvcGRvd24uX29wZW5fID0gdHJ1ZTsKICAgICAgICAgIH0sIHsgb25jZTogdHJ1ZSB9KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8qIOenu+WKqOerr+S4i+WmguaenOazqOWGjOS6hm1vdXNlbW92ZeS8muWvvOiHtGNsaWNr5rKh5rOV6Kem5Y+R77yM5oiW6ICF5a+86Ie05LqL5Lu255u45LqS5bmy5omw77yM5rKh5rOV5ZSk6LW3c2wtZHJvcGRvd24gKi8KICAgICAgaWYgKCFkZXZpY2UuaXNNb2JpbGUoKSkgewogICAgICAgIC8qIOm8oOagh+WcqHBvcHVwV3JhcOS4iuenu+WKqOaXtu+8jOWmguaenOajgOa1i+WIsGlzT3V0T2ZEb2N1bWVudChlbGVtZW50KeS5n+enu+mZpGZ1bGxBY3RpdmVDbGFzc+eahOagt+W8j+exu++8jOazqOaEj+mcgOWKoOS4imRlYm91bmNlICovCiAgICAgICAgbGV0IGxhc3RDaGVja0lzT3V0T2ZEb2N1bWVudFRpbWUgPSBEYXRlLm5vdygpOwogICAgICAgIHBvcHVwV3JhcC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCAoZXZlbnQpID0+IHsKICAgICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7CiAgICAgICAgICBpZiAobm93IC0gbGFzdENoZWNrSXNPdXRPZkRvY3VtZW50VGltZSA+IDEwMCkgewogICAgICAgICAgICBsYXN0Q2hlY2tJc091dE9mRG9jdW1lbnRUaW1lID0gbm93OwogICAgICAgICAgICBpZiAoaXNPdXRPZkRvY3VtZW50KGVsZW1lbnQpKSB7CiAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KG1vdXNlbGVhdmVUaW1lcik7CiAgICAgICAgICAgICAgcG9wdXBXcmFwLmNsYXNzTGlzdC5yZW1vdmUoZnVsbEFjdGl2ZUNsYXNzKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBwb3B1cC5yZXBvc2l0aW9uKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBvcGVuRHJvcGRvd24oZXZlbnQpOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBwb3B1cFdyYXAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHsKICAgICAgICBvcGVuRHJvcGRvd24oZXZlbnQpOwogICAgICAgIG1lbnVBY3Rpb25IYW5kbGVyKHsKICAgICAgICAgIGV2ZW50LAogICAgICAgICAgdmlkZW9FbGVtZW50OiBlbGVtZW50LAogICAgICAgICAgaDVQbGF5ZXIsCiAgICAgICAgICBoNXBsYXllclVJOiB0aGlzLAogICAgICAgICAgcG9wdXAsCiAgICAgICAgICBhY3Rpb25DYWxsYmFjazogKGFjdGlvbiwgYXJncykgPT4gewogICAgICAgICAgICByZVJlbmRlck1lbnVNb2QoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CgogICAgICBvYnNlcnZlVmlzaWJpbGl0eSgoZW50cnksIG9ic2VydmVyKSA9PiB7CiAgICAgICAgbGV0IGFjdGl2ZVN0YXR1cyA9IGZhbHNlOwogICAgICAgIGlmIChlbnRyeSkgewogICAgICAgICAgaWYgKCFpc091dE9mRG9jdW1lbnQoZWxlbWVudCkpIHsKICAgICAgICAgICAgYWN0aXZlU3RhdHVzID0gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50LnBhdXNlZCAmJiAhaXNPdXRPZkRvY3VtZW50KGVsZW1lbnQpKSB7CiAgICAgICAgICAgIGlmIChlbGVtZW50LmN1cnJlbnRUaW1lICYmIGVsZW1lbnQuY3VycmVudFRpbWUgPiAxLjUpIHsKICAgICAgICAgICAgICBwb3B1cFdyYXAuY2xhc3NMaXN0LmFkZChhY3RpdmVDbGFzcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChhbHdheXNTaG93VUlCYXIpIHsKICAgICAgICAgICAgICBwb3B1cFdyYXAuY2xhc3NMaXN0LmFkZChhY3RpdmVDbGFzcyk7CiAgICAgICAgICAgICAgcG9wdXBXcmFwLmNsYXNzTGlzdC5hZGQoZnVsbEFjdGl2ZUNsYXNzKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBwb3B1cFdyYXAuY2xhc3NMaXN0LnJlbW92ZShhY3RpdmVDbGFzcyk7CiAgICAgICAgICAgICAgcG9wdXBXcmFwLmNsYXNzTGlzdC5yZW1vdmUoZnVsbEFjdGl2ZUNsYXNzKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhY3RpdmVTdGF0dXMgPSBmYWxzZTsKICAgICAgICAgIHBvcHVwV3JhcC5jbGFzc0xpc3QucmVtb3ZlKGFjdGl2ZUNsYXNzKTsKICAgICAgICAgIHBvcHVwV3JhcC5jbGFzc0xpc3QucmVtb3ZlKGZ1bGxBY3RpdmVDbGFzcyk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIWNoZWNrUG9wdXBVcGRhdGVDb21wbGV0ZSgpKSB7IHJldHVybiBmYWxzZSB9CgogICAgICAgIHBvcHVwLnVwZGF0ZUNvbXBsZXRlLnRoZW4oKCkgPT4gewogICAgICAgICAgcG9wdXAuYWN0aXZlID0gYWN0aXZlU3RhdHVzOwogICAgICAgICAgcG9wdXAucmVwb3NpdGlvbigpOwogICAgICAgIH0pOwogICAgICB9LCBlbGVtZW50KTsKCiAgICAgIHBvcHVwLm9sZFJlY3QgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICBwb3B1cC5hZGRFdmVudExpc3RlbmVyKCdzbC1yZXBvc2l0aW9uJywgKCkgPT4gewogICAgICAgIGlmIChpc091dE9mRG9jdW1lbnQoZWxlbWVudCkpIHsKICAgICAgICAgIHBvcHVwLmFjdGl2ZSA9IGZhbHNlOwogICAgICAgICAgcG9wdXBXcmFwLmNsYXNzTGlzdC5yZW1vdmUoYWN0aXZlQ2xhc3MpOwogICAgICAgICAgcG9wdXBXcmFwLmNsYXNzTGlzdC5yZW1vdmUoZnVsbEFjdGl2ZUNsYXNzKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3QgbmV3UmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgICBpZiAobmV3UmVjdC53aWR0aCAhPT0gcG9wdXAub2xkUmVjdC53aWR0aCkgewogICAgICAgICAgICBwb3B1cC5vbGRSZWN0ID0gbmV3UmVjdDsKICAgICAgICAgICAgcmVSZW5kZXJNZW51TW9kKCk7CiAgICAgICAgICAgIHJlUmVuZGVyUmVjb21tZW5kTW9kKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIC8qIGVsZW1lbnTliIfmjaLmkq3mlL7nirbmgIHml7bvvIzlpoLmnpzmmK/mkq3mlL7nirbmgIHvvIzliJnpmpDol49wb3B1cO+8jOWQpuWImeaYvuekunBvcHVwICovCiAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigncGxheScsICgpID0+IHsKICAgICAgICBpZiAoYWx3YXlzU2hvd1VJQmFyKSB7CiAgICAgICAgICBwb3B1cFdyYXAuY2xhc3NMaXN0LmFkZChhY3RpdmVDbGFzcyk7CiAgICAgICAgICBwb3B1cFdyYXAuY2xhc3NMaXN0LmFkZChmdWxsQWN0aXZlQ2xhc3MpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBwb3B1cFdyYXAuY2xhc3NMaXN0LnJlbW92ZShhY3RpdmVDbGFzcyk7CiAgICAgICAgICBwb3B1cFdyYXAuY2xhc3NMaXN0LnJlbW92ZShmdWxsQWN0aXZlQ2xhc3MpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGlzT3V0T2ZEb2N1bWVudChlbGVtZW50KSkgewogICAgICAgICAgcG9wdXAuYWN0aXZlID0gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHBvcHVwLmFjdGl2ZSA9IHRydWU7CiAgICAgICAgfQogICAgICAgIHBvcHVwLnJlcG9zaXRpb24oKTsKICAgICAgICBjbGVhblBvcHVwV3JhcCgpOwoKICAgICAgICByZVJlbmRlck1lbnVNb2QoKTsKICAgICAgfSk7CgogICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3BhdXNlJywgKCkgPT4gewogICAgICAgIHJlUmVuZGVyTWVudU1vZCgpOwoKICAgICAgICBpZiAoYWx3YXlzU2hvd1VJQmFyKSB7CiAgICAgICAgICBwb3B1cFdyYXAuY2xhc3NMaXN0LmFkZChhY3RpdmVDbGFzcyk7CiAgICAgICAgICBwb3B1cFdyYXAuY2xhc3NMaXN0LmFkZChmdWxsQWN0aXZlQ2xhc3MpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAoZWxlbWVudC5jdXJyZW50VGltZSAmJiBlbGVtZW50LmN1cnJlbnRUaW1lID4gMS41KSB7CiAgICAgICAgICAgIHBvcHVwV3JhcC5jbGFzc0xpc3QuYWRkKGFjdGl2ZUNsYXNzKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChpc091dE9mRG9jdW1lbnQoZWxlbWVudCkpIHsKICAgICAgICAgIHBvcHVwLmFjdGl2ZSA9IGZhbHNlOwogICAgICAgICAgcG9wdXBXcmFwLmNsYXNzTGlzdC5yZW1vdmUoYWN0aXZlQ2xhc3MpOwogICAgICAgICAgcG9wdXBXcmFwLmNsYXNzTGlzdC5yZW1vdmUoZnVsbEFjdGl2ZUNsYXNzKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcG9wdXAuYWN0aXZlID0gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIHBvcHVwLnJlcG9zaXRpb24oKTsKICAgICAgICBjbGVhblBvcHVwV3JhcCgpOwogICAgICB9KTsKCiAgICAgIC8qIGVsZW1lbnTnmoTmkq3mlL7ov5vluqblj5HnlJ/lj5jljJbml7bvvIzmiafooYzkuIDmrKFwb3B1cC5yZXBvc2l0aW9uKCkgKi8KICAgICAgbGV0IGxhc3RUaW1ldXBkYXRlVGltZSA9IERhdGUubm93KCk7CiAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndGltZXVwZGF0ZScsICgpID0+IHsKICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpOwogICAgICAgIGlmICghaXNPdXRPZkRvY3VtZW50KGVsZW1lbnQpICYmIG5vdyAtIGxhc3RUaW1ldXBkYXRlVGltZSA+IDQwMCkgewogICAgICAgICAgbGFzdFRpbWV1cGRhdGVUaW1lID0gbm93OwogICAgICAgICAgcG9wdXAucmVwb3NpdGlvbigpOwogICAgICAgIH0KICAgICAgfSk7CgogICAgICAvKiDlsJ3or5XmuIXpmaRwb3B1cFdyYXBPYmpz5Lit55qE5peg5pWI5YWD57SgICovCiAgICAgIGNsZWFuUG9wdXBXcmFwKCk7CgogICAgICAvLyBkZWJ1Zy5sb2coJ1toNXBsYXllclVJXVtwb3B1cF0nLCBwb3B1cCwgcG9wdXBXcmFwLCBlbGVtZW50KQogICAgfQogIH07CgogIHJldHVybiBoNXBsYXllclVJOwoKfSkoKTtyZXR1cm4gaDVwbGF5ZXJVSX07CgovKiDlrprkuYnmlK/mjIHlk6rkupvlqpLkvZPmoIfnrb4gKi8KLy8gY29uc3Qgc3VwcG9ydE1lZGlhVGFncyA9IFsndmlkZW8nLCAnYndwLXZpZGVvJywgJ2F1ZGlvJ10KY29uc3Qgc3VwcG9ydE1lZGlhVGFncyA9IFsndmlkZW8nLCAnYndwLXZpZGVvJ107CgpsZXQgVENDID0gbnVsbDsKY29uc3QgaDVQbGF5ZXIgPSB7CiAgdmVyc2lvbiwKICBtZWRpYUNvcmUsCiAgbWVkaWFQbHVzQXBpOiBudWxsLAogIG1lZGlhU291cmNlLAogIGNvbmZpZ01hbmFnZXIsCiAgLyog5o+Q56S65paH5pys55qE5a2X5Y+3ICovCiAgZm9udFNpemU6IDEyLAogIGVuYWJsZTogdHJ1ZSwKICBnbG9iYWxNb2RlOiB0cnVlLAogIHBsYXllckluc3RhbmNlOiBudWxsLAogIHNjYWxlOiAxLAogIHRyYW5zbGF0ZTogewogICAgeDogMCwKICAgIHk6IDAKICB9LAogIHJvdGF0ZTogMCwKCiAgLyog5rC05bmz6ZWc5YOP57+76L2sLCAwIOaIliAxODAgKi8KICByb3RhdGVZOiAwLAogIC8qIOWeguebtOmVnOWDj+e/u+i9rCwgMCDmiJYgMTgwICovCiAgcm90YXRlWDogMCwKCiAgZGVmYXVsdFRyYW5zZm9ybTogewogICAgc2NhbGU6IDEsCiAgICB0cmFuc2xhdGU6IHsKICAgICAgeDogMCwKICAgICAgeTogMAogICAgfSwKICAgIHJvdGF0ZTogMCwKICAgIHJvdGF0ZVk6IDAsCiAgICByb3RhdGVYOiAwCiAgfSwKCiAgLyog5a2Y5YKo5pen55qEVHJhbnNmb3Jt5YC8ICovCiAgaGlzdG9yeVRyYW5zZm9ybToge30sCgogIHBsYXliYWNrUmF0ZTogY29uZmlnTWFuYWdlci5nZXQoJ21lZGlhLnBsYXliYWNrUmF0ZScpLAogIHZvbHVtZTogY29uZmlnTWFuYWdlci5nZXQoJ21lZGlhLnZvbHVtZScpLAogIGxhc3RQbGF5YmFja1JhdGU6IGNvbmZpZ01hbmFnZXIuZ2V0KCdtZWRpYS5sYXN0UGxheWJhY2tSYXRlJyksCiAgLyog5b+r6L+b5b+r6YCA5q2l6ZW/ICovCiAgc2tpcFN0ZXA6IDUsCgogIC8qIOebkeWQrOm8oOagh+a0u+WKqOeahOinguWvn+WvueixoSAqLwogIG1vdXNlT2JzZXJ2ZXI6IG5ldyBNb3VzZU9ic2VydmVyKCksCgogIGRpc2FibGVIb3RrZXlzVGVtcG9yYXJpbHkgKCkgewogICAgdGhpcy5fX2Rpc2FibGVIb3RrZXlzVGVtcG9yYXJpbHlfXyA9IHRydWU7CiAgfSwKICBlbmFibGVIb3RrZXlzICgpIHsKICAgIHRoaXMuX19kaXNhYmxlSG90a2V5c1RlbXBvcmFyaWx5X18gPSBmYWxzZTsKICB9LAogIHRvZ2dsZUhvdGtleXMgKCkgewogICAgY29uc3QgY29uZmlybSA9IHdpbmRvdy5jb25maXJtKHRoaXMuX19kaXNhYmxlSG90a2V5c1RlbXBvcmFyaWx5X18gPyBpMThuLnQoJ2VuYWJsZUhvdGtleXMnKSA6IGkxOG4udCgnZGlzYWJsZUhvdGtleXMnKSk7CiAgICBpZiAoY29uZmlybSkgewogICAgICB0aGlzLl9fZGlzYWJsZUhvdGtleXNUZW1wb3JhcmlseV9fID0gIXRoaXMuX19kaXNhYmxlSG90a2V5c1RlbXBvcmFyaWx5X187CiAgICB9CiAgfSwKCiAgZGVidWdnZXJOb3cgKCkgewogICAgaWYgKGRlYnVnLmlzRGVidWdNb2RlKCkpIHsKICAgICAgY29uc3Qgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7CiAgICAgIHNjcmlwdC5pbm5lclRleHQgPSAnZGVidWdnZXInOwogICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHNjcmlwdCk7CiAgICB9CiAgfSwKCiAgLyog5YWz6Zet5b2T5YmN6KeG6aKR5a6e5L6L55qEVUnnlYzpnaLvvIzku6Xkvr/mtojpmaRVSeeVjOmdouWvueWFtuS7luWFg+e0oOmBruaMoeetieebuOWFs+W9seWTjSAqLwogIGRpc2FibGVDdXJyZW50SW5zdGFuY2VHVUkgKCkgewogICAgY29uc3QgdCA9IHRoaXM7CiAgICBjb25zdCBwbGF5ZXIgPSB0LnBsYXllcigpOwogICAgaWYgKHBsYXllciAmJiB0LlVJICYmIHQuVUkucmVtb3ZlUG9wdXBXcmFwQnlFbGVtZW50KSB7CiAgICAgIHBsYXllci5fX2Rpc2FibGVHVUlUZW1wb3JhcmlseV9fID0gdHJ1ZTsKICAgICAgdC5VSS5yZW1vdmVQb3B1cFdyYXBCeUVsZW1lbnQocGxheWVyKTsKICAgIH0KICB9LAoKICAvKiDojrflj5blvZPliY3mkq3mlL7lmajnmoTlrp7kvosgKi8KICBwbGF5ZXI6IGZ1bmN0aW9uICgpIHsKICAgIGNvbnN0IHQgPSB0aGlzOwogICAgbGV0IHBsYXllckluc3RhbmNlID0gdC5wbGF5ZXJJbnN0YW5jZTsKCiAgICBpZiAoIXBsYXllckluc3RhbmNlKSB7CiAgICAgIGNvbnN0IG1lZGlhTGlzdCA9IHQuZ2V0UGxheWVyTGlzdCgpOwogICAgICBpZiAobWVkaWFMaXN0Lmxlbmd0aCkgewogICAgICAgIHBsYXllckluc3RhbmNlID0gbWVkaWFMaXN0W21lZGlhTGlzdC5sZW5ndGggLSAxXTsKICAgICAgICB0LnBsYXllckluc3RhbmNlID0gcGxheWVySW5zdGFuY2U7CiAgICAgICAgdC5pbml0UGxheWVySW5zdGFuY2UobWVkaWFMaXN0Lmxlbmd0aCA9PT0gMSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAocGxheWVySW5zdGFuY2UgJiYgIXQubWVkaWFQbHVzQXBpKSB7CiAgICAgIHQubWVkaWFQbHVzQXBpID0gbWVkaWFDb3JlLm1lZGlhUGx1cyhwbGF5ZXJJbnN0YW5jZSk7CiAgICB9CgogICAgcmV0dXJuIHBsYXllckluc3RhbmNlCiAgfSwKCiAgaXNBdWRpb0luc3RhbmNlICgpIHsKICAgIHJldHVybiBpc0F1ZGlvRWxlbWVudCh0aGlzLnBsYXllcigpKQogIH0sCgogIC8qIOavj+S4que9kemhteWPr+iDveWtmOWcqOeahOWkmuS4qnZpZGVv5pKt5pS+5ZmoICovCiAgZ2V0UGxheWVyTGlzdDogZnVuY3Rpb24gKCkgewogICAgY29uc3QgbGlzdCA9IG1lZGlhQ29yZS5tZWRpYUVsZW1lbnRMaXN0IHx8IFtdOwoKICAgIGZ1bmN0aW9uIGZpbmRQbGF5ZXIgKGNvbnRleHQpIHsKICAgICAgc3VwcG9ydE1lZGlhVGFncy5mb3JFYWNoKHRhZ05hbWUgPT4gewogICAgICAgIGNvbnRleHQucXVlcnlTZWxlY3RvckFsbCh0YWdOYW1lKS5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHsKICAgICAgICAgIGlmIChwbGF5ZXIudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnYndwLXZpZGVvJykgewogICAgICAgICAgICAvKiDlsIZC56uZ55qEQldQLVZJREVP5qCH6K+G5Li6SFRNTFZpZGVvRWxlbWVudCAqLwogICAgICAgICAgICBwbGF5ZXIuSFRNTFZpZGVvRWxlbWVudCA9IHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGlzTWVkaWFFbGVtZW50KHBsYXllcikgJiYgIWxpc3QuaW5jbHVkZXMocGxheWVyKSkgewogICAgICAgICAgICBsaXN0LnB1c2gocGxheWVyKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgZmluZFBsYXllcihkb2N1bWVudCk7CgogICAgLy8g6KKr5bCB6KOF5ZyoIHNoYWRvdyBkb20g6YeM6Z2i55qEdmlkZW8KICAgIGlmICh3aW5kb3cuX3NoYWRvd0RvbUxpc3RfKSB7CiAgICAgIHdpbmRvdy5fc2hhZG93RG9tTGlzdF8uZm9yRWFjaChmdW5jdGlvbiAoc2hhZG93Um9vdCkgewogICAgICAgIGZpbmRQbGF5ZXIoc2hhZG93Um9vdCk7CiAgICAgIH0pOwogICAgfQoKICAgIHJldHVybiBsaXN0CiAgfSwKCiAgZ2V0UGxheWVyV3JhcERvbTogZnVuY3Rpb24gKCkgewogICAgY29uc3QgdCA9IHRoaXM7CiAgICBjb25zdCBwbGF5ZXIgPSB0LnBsYXllcigpOwogICAgaWYgKCFwbGF5ZXIpIHJldHVybgoKICAgIGxldCB3cmFwRG9tID0gbnVsbDsKICAgIGNvbnN0IHBsYXllckJveCA9IHBsYXllci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIGVhY2hQYXJlbnROb2RlKHBsYXllciwgZnVuY3Rpb24gKHBhcmVudCkgewogICAgICBpZiAocGFyZW50ID09PSBkb2N1bWVudCB8fCAhcGFyZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCkgcmV0dXJuCiAgICAgIGNvbnN0IHBhcmVudEJveCA9IHBhcmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgaWYgKHBhcmVudEJveC53aWR0aCAmJiBwYXJlbnRCb3guaGVpZ2h0KSB7CiAgICAgICAgaWYgKHBhcmVudEJveC53aWR0aCA9PT0gcGxheWVyQm94LndpZHRoICYmIHBhcmVudEJveC5oZWlnaHQgPT09IHBsYXllckJveC5oZWlnaHQpIHsKICAgICAgICAgIHdyYXBEb20gPSBwYXJlbnQ7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICAgIHJldHVybiB3cmFwRG9tCiAgfSwKCiAgLyog5oyC6L295Yiw6aG16Z2i5LiK55qEd2luZG935a+56LGh77yM55So5LqO6LCD6K+VICovCiAgYXN5bmMgbW91bnRUb0dsb2JhbCAoKSB7CiAgICB0cnkgewogICAgICBjb25zdCBwYWdlV2luZG93ID0gYXdhaXQgZ2V0UGFnZVdpbmRvdygpOwogICAgICBpZiAocGFnZVdpbmRvdykgewogICAgICAgIHBhZ2VXaW5kb3cuX2g1UGxheWVyID0gaDVQbGF5ZXIgfHwgJ251bGwnOwogICAgICAgIGlmICh3aW5kb3cudG9wICE9PSB3aW5kb3cpIHsKICAgICAgICAgIHBhZ2VXaW5kb3cuX2g1UGxheWVySW5GcmFtZSA9IGg1UGxheWVyIHx8ICdudWxsJzsKICAgICAgICB9CiAgICAgICAgcGFnZVdpbmRvdy5fd2luZG93ID0gd2luZG93IHx8ICcnOwogICAgICAgIGRlYnVnLmxvZygnaDVQbGF5ZXLlr7nosaHlt7LmiJDlip/mjILovb3liLDlhajlsYAnKTsKICAgICAgfQogICAgfSBjYXRjaCAoZSkgewogICAgICBkZWJ1Zy5lcnJvcihlKTsKICAgIH0KICB9LAoKICAvKioKICAgKiDliJ3lp4vljJbmkq3mlL7lmajlrp7kvosKICAgKiBAcGFyYW0gaXNTaW5nbGUg5piv5ZCm5Li65Y2V5a6e5L6LdmlkZW/moIfnrb4KICAgKi8KICBpbml0UGxheWVySW5zdGFuY2UgKGlzU2luZ2xlKSB7CiAgICBjb25zdCB0ID0gdGhpczsKICAgIGlmICghdC5wbGF5ZXJJbnN0YW5jZSkgcmV0dXJuCgogICAgY29uc3QgcGxheWVyID0gdC5wbGF5ZXJJbnN0YW5jZTsKCiAgICB0Lm1lZGlhUGx1c0FwaSA9IG1lZGlhQ29yZS5tZWRpYVBsdXMocGxheWVyKTsKCiAgICB0LmluaXRQbGF5YmFja1JhdGUoKTsKICAgIHQuaXNGb3VjcygpOwogICAgdC5wcm94eVBsYXllckluc3RhbmNlKHBsYXllcik7CgogICAgdC51bkxvY2tQbGF5YmFja1JhdGUoKTsKICAgIHQuc2V0UGxheWJhY2tSYXRlKCk7CiAgICB0LmxvY2tQbGF5YmFja1JhdGUoMTAwMCk7CgogICAgLyog5aKe5Yqg6YCa55So5YWo5bGP77yM572R6aG15YWo5bGPYXBpICovCiAgICBwbGF5ZXIuX2Z1bGxTY3JlZW5fID0gbmV3IEZ1bGxTY3JlZW4ocGxheWVyKTsKICAgIHBsYXllci5fZnVsbFBhZ2VTY3JlZW5fID0gbmV3IEZ1bGxTY3JlZW4ocGxheWVyLCB0cnVlKTsKCiAgICAvKiDms6jlhozng63plK7ov5DooYzlmaggKi8KICAgIHQucmVnaXN0ZXJIb3RrZXlzUnVubmVyKCk7CgogICAgaWYgKCFwbGF5ZXIuX2hhc0NhbnBsYXlFdmVudF8pIHsKICAgICAgcGxheWVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NhbnBsYXknLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICB0LmluaXRBdXRvUGxheShwbGF5ZXIpOwogICAgICB9KTsKICAgICAgcGxheWVyLl9oYXNDYW5wbGF5RXZlbnRfID0gdHJ1ZTsKICAgIH0KCiAgICAvKiDmkq3mlL7nmoTml7blgJnov5vooYznm7jlhbPlkIzmraXmk43kvZwgKi8KICAgIGlmICghcGxheWVyLl9oYXNQbGF5ZXJJbml0RXZlbnRfKSB7CiAgICAgIGxldCBzZXRQbGF5YmFja1JhdGVPblBsYXlpbmdDb3VudCA9IDA7CiAgICAgIHBsYXllci5hZGRFdmVudExpc3RlbmVyKCdwbGF5aW5nJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgdC51bkxvY2tQbGF5YmFja1JhdGUoKTsKICAgICAgICB0LnNldFBsYXliYWNrUmF0ZShudWxsLCB0cnVlKTsKICAgICAgICB0LmxvY2tQbGF5YmFja1JhdGUoMTAwMCk7CgogICAgICAgIC8qIOWQjOatpeaSreaUvumfs+mHjyAqLwogICAgICAgIGlmIChjb25maWdNYW5hZ2VyLmdldCgnZW5oYW5jZS5ibG9ja1NldFZvbHVtZScpID09PSB0cnVlICYmIGV2ZW50LnRhcmdldC5tdXRlZCA9PT0gZmFsc2UpIHsKICAgICAgICAgIHQuc2V0Vm9sdW1lKGNvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgnbWVkaWEudm9sdW1lJyksIHRydWUpOwogICAgICAgIH0KCiAgICAgICAgLyog56aB5q2i6buY6K6k55qE6L+b5bqm5o6n5Yi2ICovCiAgICAgICAgaWYgKGNvbmZpZ01hbmFnZXIuZ2V0KCdlbmhhbmNlLmJsb2NrU2V0Q3VycmVudFRpbWUnKSA9PT0gdHJ1ZSkgewogICAgICAgICAgdC5sb2NrQ3VycmVudFRpbWUoKTsKICAgICAgICB9CgogICAgICAgIC8qIOaBouWkjeaSreaUvui/m+W6piAqLwogICAgICAgIHQuc2V0UGxheVByb2dyZXNzKHBsYXllcik7CgogICAgICAgIGlmIChzZXRQbGF5YmFja1JhdGVPblBsYXlpbmdDb3VudCA9PT0gMCkgewogICAgICAgICAgLyog5ZCM5q2l5LmL5YmN6K6+5a6a55qE5pKt5pS+6YCf5bqm77yM6Z+z6YeP562JICovCiAgICAgICAgICB0LnVuTG9ja1BsYXliYWNrUmF0ZSgpOwogICAgICAgICAgdC5zZXRQbGF5YmFja1JhdGUoKTsKICAgICAgICAgIHQubG9ja1BsYXliYWNrUmF0ZSgxMDAwKTsKCiAgICAgICAgICAvKiDlkK/liqjmkq3mlL7ov5vluqborrDlvZUgKi8KICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICB0LnBsYXlQcm9ncmVzc1JlY29yZGVyKHBsYXllcik7CiAgICAgICAgICB9LCAyMDAwKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdC51bkxvY2tQbGF5YmFja1JhdGUoKTsKICAgICAgICAgIHQuc2V0UGxheWJhY2tSYXRlKG51bGwsIHRydWUpOwogICAgICAgICAgdC5sb2NrUGxheWJhY2tSYXRlKDEwMDApOwogICAgICAgIH0KICAgICAgICBzZXRQbGF5YmFja1JhdGVPblBsYXlpbmdDb3VudCArPSAxOwogICAgICB9KTsKCiAgICAgIHBsYXllci5faGFzUGxheWVySW5pdEV2ZW50XyA9IHRydWU7CiAgICB9CgogICAgLyog6L+b6KGM6Ieq5a6a5LmJ5Yid5aeL5YyW5pON5L2cICovCiAgICBjb25zdCB0YXNrQ29uZiA9IFRDQy5nZXRUYXNrQ29uZmlnKCk7CiAgICBpZiAodGFza0NvbmYuaW5pdCkgewogICAgICBUQ0MuZG9UYXNrKCdpbml0JywgcGxheWVyKTsKICAgIH0KCiAgICBjb25zdCBuZWVkSW5pdEV2ZW50ID0gIXBsYXllci5fX3JlZ2lzdGVyZWRJbml0RXZlbnRfXzsKCiAgICAvKiDms6jlhozpvKDmoIflk43lupTkuovku7YgKi8KICAgIG5lZWRJbml0RXZlbnQgJiYgdC5tb3VzZU9ic2VydmVyLm9uKHBsYXllciwgJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50LCBvZmZzZXQsIHRhcmdldCkgewogICAgICAvLyBkZWJ1Zy5sb2coJ+aNleaNieWIsOm8oOagh+eCueWHu+S6i+S7tu+8micsIGV2ZW50LCBvZmZzZXQsIHRhcmdldCkKICAgIH0pOwoKICAgIC8qIOeUu+S4reeUu+S6i+S7tuebkeWQrCAqLwogICAgbmVlZEluaXRFdmVudCAmJiBwbGF5ZXIuYWRkRXZlbnRMaXN0ZW5lcignZW50ZXJwaWN0dXJlaW5waWN0dXJlJywgKCkgPT4gewogICAgICBtb25rZXlNc2cuc2VuZCgnZ2xvYmFsUGljdHVyZUluUGljdHVyZUluZm8nLCB7CiAgICAgICAgdXNlUGljdHVyZUluUGljdHVyZTogdHJ1ZQogICAgICB9KTsKICAgICAgZGVidWcubG9nKCdlbnRlcnBpY3R1cmVpbnBpY3R1cmUnLCBwbGF5ZXIpOwogICAgfSk7CiAgICBuZWVkSW5pdEV2ZW50ICYmIHBsYXllci5hZGRFdmVudExpc3RlbmVyKCdsZWF2ZXBpY3R1cmVpbnBpY3R1cmUnLCAoKSA9PiB7CiAgICAgIHQubGVhdmVwaWN0dXJlaW5waWN0dXJlVGltZSA9IERhdGUubm93KCk7CgogICAgICBtb25rZXlNc2cuc2VuZCgnZ2xvYmFsUGljdHVyZUluUGljdHVyZUluZm8nLCB7CiAgICAgICAgdXNlUGljdHVyZUluUGljdHVyZTogZmFsc2UKICAgICAgfSk7CiAgICAgIGRlYnVnLmxvZygnbGVhdmVwaWN0dXJlaW5waWN0dXJlJywgcGxheWVyKTsKICAgIH0pOwoKICAgIC8vIGlmIChkZWJ1Zy5pc0RlYnVnTW9kZSgpKSB7fQoKICAgIC8qIOiusOW9lXBsYXllcuS9v+eUqOi/h+eahHNyYyAqLwogICAgZnVuY3Rpb24gc3JjUmVjb3JkIChwbGF5ZXIpIHsKICAgICAgY29uc3Qgc3JjID0gcGxheWVyLmN1cnJlbnRTcmMgfHwgcGxheWVyLnNyYzsKICAgICAgaWYgKCFzcmMpIHsgcmV0dXJuIH0KCiAgICAgIHBsYXllci5zcmNMaXN0ID0gcGxheWVyLnNyY0xpc3QgfHwgW3NyY107CiAgICAgIGlmICghcGxheWVyLnNyY0xpc3QuaW5jbHVkZXMoc3JjKSkgewogICAgICAgIHBsYXllci5zcmNMaXN0LnB1c2goc3JjKTsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHVwZGF0YUJ1ZmZlcmVkVGltZSAocGxheWVyKSB7CiAgICAgIC8qIOmaj+aXtuiusOW9lee8k+WtmOaVsOaNruWIsOS6huWTquS4quaXtumXtOiKgueCuSAqLwogICAgICBpZiAocGxheWVyLmJ1ZmZlcmVkLmxlbmd0aCA+IDApIHsKICAgICAgICBjb25zdCBidWZmZXJlZFRpbWUgPSBwbGF5ZXIuYnVmZmVyZWQuZW5kKHBsYXllci5idWZmZXJlZC5sZW5ndGggLSAxKTsKICAgICAgICBwbGF5ZXIuYnVmZmVyZWRUaW1lID0gYnVmZmVyZWRUaW1lOwogICAgICB9CgogICAgICBpZiAodC5hdXRvR290b0J1ZmZlcmVkVGltZSAmJiBwbGF5ZXIuYnVmZmVyZWRUaW1lICYmIHQucGxheWVyKCkgPT09IHBsYXllciAmJiBwbGF5ZXIuYnVmZmVyZWRUaW1lIDwgcGxheWVyLmR1cmF0aW9uIC0gMSAmJiBwbGF5ZXIuY3VycmVudFRpbWUgPCBwbGF5ZXIuYnVmZmVyZWRUaW1lIC0gMSkgewogICAgICAgIHQuc2V0Q3VycmVudFRpbWUocGxheWVyLmJ1ZmZlcmVkVGltZSk7CiAgICAgIH0KICAgIH0KCiAgICBuZWVkSW5pdEV2ZW50ICYmIHBsYXllci5hZGRFdmVudExpc3RlbmVyKCdsb2FkZWRkYXRhJywgZnVuY3Rpb24gKCkgewogICAgICBkZWJ1Zy5sb2coYFtwbGF5ZXJdW2xvYWRlZGRhdGFdICR7cGxheWVyLnNyY30gdmlkZW8gZHVyYXRpb246ICR7cGxheWVyLmR1cmF0aW9ufSB2aWRlbyBkb206YCwgcGxheWVyKTsKICAgICAgc3JjUmVjb3JkKHBsYXllcik7CiAgICB9KTsKICAgIG5lZWRJbml0RXZlbnQgJiYgcGxheWVyLmFkZEV2ZW50TGlzdGVuZXIoJ2R1cmF0aW9uY2hhbmdlJywgZnVuY3Rpb24gKCkgewogICAgICBkZWJ1Zy5sb2coYFtwbGF5ZXJdW2R1cmF0aW9uY2hhbmdlXSAke3BsYXllci5kdXJhdGlvbn1gKTsKICAgICAgc3JjUmVjb3JkKHBsYXllcik7CiAgICB9KTsKCiAgICBuZWVkSW5pdEV2ZW50ICYmIHBsYXllci5hZGRFdmVudExpc3RlbmVyKCdsb2Fkc3RhcnQnLCBmdW5jdGlvbiAoKSB7CiAgICAgIGRlYnVnLmxvZygnW3BsYXllcl1bbG9hZHN0YXJ0XScsIHBsYXllci5jdXJyZW50U3JjLCBwbGF5ZXIuc3JjKTsKICAgICAgc3JjUmVjb3JkKHBsYXllcik7CiAgICB9KTsKCiAgICAvKiDms6jlhoxVSeeVjOmdoiAqLwogICAgdC5VSSAmJiB0LlVJLnBvcHVwICYmIHQuVUkucG9wdXAocGxheWVyLCB0KTsKCiAgICAvKiDlnKjmkq3mlL7miJbmmoLlgZzml7bvvIzkuZ/lsJ3or5Xms6jlhoxVSeeVjOmdou+8jOi/meagt+WNs+S9v3BvcHVw6KKr5oSP5aSW5Yig6Zmk77yM5Lmf6L+Y5piv6IO95q2j5bi45YaN5qyh5Yib5bu65Zue5p2lICovCiAgICBuZWVkSW5pdEV2ZW50ICYmIHBsYXllci5hZGRFdmVudExpc3RlbmVyKCdwbGF5JywgZnVuY3Rpb24gKCkgewogICAgICB0LlVJICYmIHQuVUkucG9wdXAgJiYgdC5VSS5wb3B1cChwbGF5ZXIsIHQpOwogICAgfSk7CiAgICBuZWVkSW5pdEV2ZW50ICYmIHBsYXllci5hZGRFdmVudExpc3RlbmVyKCdwYXVzZScsIGZ1bmN0aW9uICgpIHsKICAgICAgdC5VSSAmJiB0LlVJLnBvcHVwICYmIHQuVUkucG9wdXAocGxheWVyLCB0KTsKICAgIH0pOwogICAgbGV0IGxhc3RSZWdpc3RlclVJUG9wdXBUaW1lID0gRGF0ZS5ub3coKTsKICAgIGxldCB0cnlSZWdpc3RlclVJUG9wdXBDb3VudCA9IDA7CiAgICBuZWVkSW5pdEV2ZW50ICYmIHBsYXllci5hZGRFdmVudExpc3RlbmVyKCd0aW1ldXBkYXRlJywgZnVuY3Rpb24gKCkgewogICAgICAvLyB1cGRhdGFCdWZmZXJlZFRpbWUocGxheWVyKQoKICAgICAgaWYgKERhdGUubm93KCkgLSBsYXN0UmVnaXN0ZXJVSVBvcHVwVGltZSA+IDgwMCAmJiB0cnlSZWdpc3RlclVJUG9wdXBDb3VudCA8IDYwKSB7CiAgICAgICAgbGFzdFJlZ2lzdGVyVUlQb3B1cFRpbWUgPSBEYXRlLm5vdygpOwogICAgICAgIHRyeVJlZ2lzdGVyVUlQb3B1cENvdW50ICs9IDE7CiAgICAgICAgdC5VSSAmJiB0LlVJLnBvcHVwICYmIHQuVUkucG9wdXAocGxheWVyLCB0KTsKICAgICAgfQoKICAgICAgc3JjUmVjb3JkKHBsYXllcik7CiAgICAgIG1lZGlhU291cmNlLmNvbm5lY3RNZWRpYVNvdXJjZVdpdGhNZWRpYUVsZW1lbnQocGxheWVyKTsKICAgIH0pOwoKICAgIGxldCBsYXN0Q2xlYW5NZWRpYVNvdXJjZURhdGFUaW1lID0gRGF0ZS5ub3coKTsKICAgIG5lZWRJbml0RXZlbnQgJiYgcGxheWVyLmFkZEV2ZW50TGlzdGVuZXIoJ3Byb2dyZXNzJywgKCkgPT4gewogICAgICB1cGRhdGFCdWZmZXJlZFRpbWUocGxheWVyKTsKICAgICAgbWVkaWFTb3VyY2UuY29ubmVjdE1lZGlhU291cmNlV2l0aE1lZGlhRWxlbWVudChwbGF5ZXIpOwoKICAgICAgaWYgKERhdGUubm93KCkgLSBsYXN0Q2xlYW5NZWRpYVNvdXJjZURhdGFUaW1lID4gMTAwMCAqIDEwKSB7CiAgICAgICAgbGFzdENsZWFuTWVkaWFTb3VyY2VEYXRhVGltZSA9IERhdGUubm93KCk7CiAgICAgICAgbWVkaWFTb3VyY2UuY2xlYW5NZWRpYVNvdXJjZURhdGEoKTsKICAgICAgfQogICAgfSk7CgogICAgbmVlZEluaXRFdmVudCAmJiBwbGF5ZXIuYWRkRXZlbnRMaXN0ZW5lcignZHVyYXRpb25jaGFuZ2UnLCBmdW5jdGlvbiAoKSB7CiAgICAgIGxhc3RSZWdpc3RlclVJUG9wdXBUaW1lID0gRGF0ZS5ub3coKTsKICAgICAgdHJ5UmVnaXN0ZXJVSVBvcHVwQ291bnQgPSAwOwogICAgICB0LlVJICYmIHQuVUkucG9wdXAgJiYgdC5VSS5wb3B1cChwbGF5ZXIsIHQpOwogICAgfSk7CgogICAgcGxheWVyLl9fcmVnaXN0ZXJlZEluaXRFdmVudF9fID0gdHJ1ZTsKICB9LAoKICByZWdpc3RlckhvdGtleXNSdW5uZXIgKCkgewogICAgaWYgKCF0aGlzLmhvdGtleXNSdW5uZXIpIHsKICAgICAgdGhpcy5ob3RrZXlzUnVubmVyID0gbmV3IEhvdGtleXNSdW5uZXIoY29uZmlnTWFuYWdlci5nZXQoJ2hvdGtleXMnKSk7CgogICAgICBpZiAoaXNJbklmcmFtZSgpICYmICFpc0luQ3Jvc3NPcmlnaW5GcmFtZSgpKSB7CiAgICAgICAgLyog6K6p6aG25bGC6aG16Z2i5Lmf5Y+v5Lul55uR5ZCs57uE5ZCI6ZSu55qE6Kem5Y+RICovCiAgICAgICAgdGhpcy5ob3RrZXlzUnVubmVyLnNldENvbWJpbmF0aW9uS2V5c01vbml0b3Iod2luZG93LnRvcCk7CiAgICAgIH0KICAgIH0KICB9LAoKICAvKiDliJrlhbPpl63nlLvkuK3nlLvkuI3kuYXvvIzmraTmrrXml7bpl7TlhoXlhYHorrjot6hUQULmjqfliLYgKi8KICBpc0xlYXZlcGljdHVyZWlucGljdHVyZUF3aGlsZSAoKSB7CiAgICBjb25zdCB0ID0gdGhpczsKICAgIHJldHVybiB0LmxlYXZlcGljdHVyZWlucGljdHVyZVRpbWUgJiYgKERhdGUubm93KCkgLSB0LmxlYXZlcGljdHVyZWlucGljdHVyZVRpbWUgPCAxMDAwICogMTApCiAgfSwKCiAgLyoqCiAgICog5a+55pKt5pS+5Zmo5a6e5L6L55qE5pa55rOV5oiW5bGe5oCn6L+b6KGM5Luj55CGCiAgICogQHBhcmFtIHBsYXllcgogICAqLwogIHByb3h5UGxheWVySW5zdGFuY2UgKHBsYXllcikgewogICAgaWYgKCFwbGF5ZXIpIHJldHVybgoKICAgIC8qIOimgeS7o+eQhueahOaWueazleaIluWxnuaAp+WIl+ihqCAqLwogICAgY29uc3QgcHJveHlMaXN0ID0gWwogICAgICAncGxheScsCiAgICAgICdwYXVzZScKICAgIF07CgogICAgcHJveHlMaXN0LmZvckVhY2goa2V5ID0+IHsKICAgICAgY29uc3Qgb3JpZ2luS2V5ID0gJ29yaWdpbl8nICsga2V5OwogICAgICBpZiAoUmVmbGVjdC5oYXMocGxheWVyLCBrZXkpICYmICFSZWZsZWN0LmhhcyhwbGF5ZXIsIG9yaWdpbktleSkpIHsKICAgICAgICBwbGF5ZXJbb3JpZ2luS2V5XSA9IHBsYXllcltrZXldOwogICAgICAgIGNvbnN0IHByb3h5ID0gbmV3IFByb3h5KHBsYXllcltrZXldLCB7CiAgICAgICAgICBhcHBseSAodGFyZ2V0LCBjdHgsIGFyZ3MpIHsKICAgICAgICAgICAgLy8gZGVidWcubG9nKGtleSArICfooqvosIPnlKgnKQoKICAgICAgICAgICAgLyog5aSE55CG5oyC6LW36YC76L6RICovCiAgICAgICAgICAgIGNvbnN0IGhhbmdVcEluZm8gPSBwbGF5ZXIuX2hhbmdVcEluZm9fIHx8IHt9OwogICAgICAgICAgICBjb25zdCBoYW5nVXBEZXRhaWwgPSBoYW5nVXBJbmZvW2tleV0gfHwgaGFuZ1VwSW5mb1snaGFuZ1VwXycgKyBrZXldOwogICAgICAgICAgICBjb25zdCBuZWVkSGFuZ1VwID0gaGFuZ1VwRGV0YWlsICYmIGhhbmdVcERldGFpbC50aW1lb3V0ID49IERhdGUubm93KCk7CiAgICAgICAgICAgIGlmIChuZWVkSGFuZ1VwKSB7CiAgICAgICAgICAgICAgZGVidWcubG9nKGtleSArICflt7LooqvmjILotbfvvIzmnKzmrKHosIPnlKjlsIbooqvlv73nlaUnKTsKICAgICAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHRhcmdldC5hcHBseShjdHggfHwgcGxheWVyLCBhcmdzKQogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBwbGF5ZXJba2V5XSA9IHByb3h5OwogICAgICB9CiAgICB9KTsKCiAgICBpZiAoIXBsYXllci5faGFuZ1VwXykgewogICAgICBwbGF5ZXIuX2hhbmdVcEluZm9fID0ge307CiAgICAgIC8qKgogICAgICAgKiDmjILotbdwbGF5ZXLmn5DkuKrlh73mlbDnmoTosIPnlKgKICAgICAgICogQHBhcmFtIG5hbWUge1N0cmluZ30gLeW/hemAiSBwbGF5ZXLmlrnms5XmiJblsZ7mgKflkI3vvIzlkI3lrZflhpnlr7nlpJbvvIzov5jpobvopoHor6Xmlrnms5XmiJblsZ7mgKfooqvku6PnkIbkuobmiY3og73ov5vooYzmjILotbfvvIzlkKbliJnov5nlsIbmmK/kuKrml6DmlYjnmoTosIPnlKgKICAgICAgICogQHBhcmFtIHRpbWVvdXQge051bWJlcn0gLeWPr+mAiSDmjILotbflpJrplb/ml7bpl7TvvIzpu5jorqQyMDBtcwogICAgICAgKiBAcHJpdmF0ZQogICAgICAgKi8KICAgICAgcGxheWVyLl9oYW5nVXBfID0gZnVuY3Rpb24gKG5hbWUsIHRpbWVvdXQpIHsKICAgICAgICB0aW1lb3V0ID0gTnVtYmVyKHRpbWVvdXQpIHx8IDIwMDsKICAgICAgICAvLyBkZWJ1Zy5sb2coJ19oYW5nVXBfJywgbmFtZSwgdGltZW91dCkKICAgICAgICBwbGF5ZXIuX2hhbmdVcEluZm9fW25hbWVdID0gewogICAgICAgICAgdGltZW91dDogRGF0ZS5ub3coKSArIHRpbWVvdXQKICAgICAgICB9OwogICAgICB9OwoKICAgICAgLyog5Y+W5raI5oyC6LW3ICovCiAgICAgIHBsYXllci5fdW5IYW5nVXBfID0gZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgICBpZiAocGxheWVyLl9oYW5nVXBJbmZvXyAmJiBwbGF5ZXIuX2hhbmdVcEluZm9fW25hbWVdKSB7CiAgICAgICAgICBwbGF5ZXIuX2hhbmdVcEluZm9fW25hbWVdLnRpbWVvdXQgPSBEYXRlLm5vdygpIC0gMTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSwKCiAgLyoqCiAgICog5Yid5aeL5YyW6Ieq5Yqo5pKt5pS+6YC76L6RCiAgICog5b+F6aG75piv6YWN572u5LqG6Ieq5Yqo5pKt5pS+5oyJ6ZKu6YCJ5oup5Zmo5b6X55qE5omN5Lya6L+b6KGM6Ieq5Yqo5pKt5pS+CiAgICovCiAgaW5pdEF1dG9QbGF5OiBmdW5jdGlvbiAocCkgewogICAgY29uc3QgdCA9IHRoaXM7CiAgICBjb25zdCBwbGF5ZXIgPSBwIHx8IHQucGxheWVyKCk7CiAgICBjb25zdCB0YXNrQ29uZiA9IFRDQy5nZXRUYXNrQ29uZmlnKCk7CgogICAgLyog5rOo5YaM5byA5ZCv56aB5q2i6Ieq5Yqo5pKt5pS+55qE5o6n5Yi26I+c5Y2VICovCiAgICBpZiAodGFza0NvbmYuYXV0b1BsYXkpIHsKICAgICAgaWYgKGNvbmZpZ01hbmFnZXIuZ2V0TG9jYWxTdG9yYWdlKCdtZWRpYS5hdXRvUGxheScpID09PSBudWxsKSB7CiAgICAgICAgY29uZmlnTWFuYWdlci5zZXRMb2NhbFN0b3JhZ2UoJ21lZGlhLmF1dG9QbGF5JywgdHJ1ZSk7CiAgICAgIH0KCiAgICAgIGFkZE1lbnUoewogICAgICAgIHRpdGxlOiAoKSA9PiBjb25maWdNYW5hZ2VyLmdldExvY2FsU3RvcmFnZSgnbWVkaWEuYXV0b1BsYXknKSA/IGkxOG4udCgnZGlzYWJsZUluaXRBdXRvUGxheScpIDogaTE4bi50KCdlbmFibGVJbml0QXV0b1BsYXknKSwKICAgICAgICBmbjogKCkgPT4gewogICAgICAgICAgY29uc3QgY29uZmlybSA9IHdpbmRvdy5jb25maXJtKGNvbmZpZ01hbmFnZXIuZ2V0TG9jYWxTdG9yYWdlKCdtZWRpYS5hdXRvUGxheScpID8gaTE4bi50KCdkaXNhYmxlSW5pdEF1dG9QbGF5JykgOiBpMThuLnQoJ2VuYWJsZUluaXRBdXRvUGxheScpKTsKICAgICAgICAgIGlmIChjb25maXJtKSB7CiAgICAgICAgICAgIGNvbnN0IGF1dG9QbGF5ID0gY29uZmlnTWFuYWdlci5nZXRMb2NhbFN0b3JhZ2UoJ21lZGlhLmF1dG9QbGF5Jyk7CiAgICAgICAgICAgIGlmIChhdXRvUGxheSA9PT0gbnVsbCkgewogICAgICAgICAgICAgIGFsZXJ0KGkxOG4udCgnY29uZmlnRmFpbCcpKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb25maWdNYW5hZ2VyLnNldExvY2FsU3RvcmFnZSgnbWVkaWEuYXV0b1BsYXknLCAhYXV0b1BsYXkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgICAvLyDlnKjova7or6Lph43or5XnmoTml7blgJnvvIzlpoLmnpzlrp7kvovlj5jkuobvvIzmiJblpITkuo7pmpDol4/pobXpnaLkuK3liJnkuI3ov5vooYzoh6rliqjmkq3mlL7mk43kvZwKICAgIGlmICghY29uZmlnTWFuYWdlci5nZXQoJ21lZGlhLmF1dG9QbGF5JykgfHwgKCFwICYmIHQuaGFzSW5pdEF1dG9QbGF5KSB8fCAhcGxheWVyIHx8IChwICYmIHAgIT09IHQucGxheWVyKCkpIHx8IGRvY3VtZW50LmhpZGRlbikgewogICAgICByZXR1cm4gZmFsc2UKICAgIH0KCiAgICAvKioKICAgICAqIOWFg+e0oOS4jeWcqOWPr+inhuiMg+WbtO+8jOS4jeWFgeiuuOi/m+ihjOWIneWni+WMluiHquWKqOaSreaUvumAu+i+kQogICAgICog55Sx5LqOaWZyYW1l5LiL5YWD57Sg55qE5Y+v6KeG6IyD5Zu05Yik5pat5LiN5YeG56Gu77yM5omA5LulaWZyYW1l5LiL5Lmf56aB5q2i5Yid5aeL5YyW6Ieq5Yqo5pKt5pS+6YC76L6RCiAgICAgKiBUT0RPIOW+heS8mOWMlgogICAgICovCiAgICBpZiAoIWlzSW5WaWV3UG9ydChwbGF5ZXIpIHx8IGlzSW5JZnJhbWUoKSkgewogICAgICByZXR1cm4gZmFsc2UKICAgIH0KCiAgICBpZiAoIXRhc2tDb25mLmF1dG9QbGF5KSB7CiAgICAgIHJldHVybiBmYWxzZQogICAgfQoKICAgIHQuaGFzSW5pdEF1dG9QbGF5ID0gdHJ1ZTsKCiAgICBpZiAocGxheWVyICYmIHRhc2tDb25mLmF1dG9QbGF5ICYmIHBsYXllci5wYXVzZWQpIHsKICAgICAgVENDLmRvVGFzaygnYXV0b1BsYXknKTsKICAgICAgaWYgKHBsYXllci5wYXVzZWQpIHsKICAgICAgICAvLyDova7or6Lph43or5UKICAgICAgICBpZiAoIXBsYXllci5faW5pdEF1dG9QbGF5Q291bnRfKSB7CiAgICAgICAgICBwbGF5ZXIuX2luaXRBdXRvUGxheUNvdW50XyA9IDE7CiAgICAgICAgfQogICAgICAgIHBsYXllci5faW5pdEF1dG9QbGF5Q291bnRfICs9IDE7CiAgICAgICAgaWYgKHBsYXllci5faW5pdEF1dG9QbGF5Q291bnRfID49IDEwKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICB9CiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICB0LmluaXRBdXRvUGxheShwbGF5ZXIpOwogICAgICAgIH0sIDIwMCk7CiAgICAgIH0KICAgIH0KICB9LAoKICBwcmludFBsYXllckluZm8gKHApIHsKICAgIGNvbnN0IHQgPSB0aGlzOwogICAgY29uc3QgcGxheWVyID0gcCB8fCB0LnBsYXllcigpOwoKICAgIGNvbnN0IGluZm8gPSB7CiAgICAgIGN1clBsYXllcjogcGxheWVyLAogICAgICBzcmNMaXN0OiBwbGF5ZXIuc3JjTGlzdCwKICAgICAgaDVwbGF5ZXI6IHQsCiAgICAgIGg1cGxheWVyVUk6IHQuVUksCiAgICAgIG1lZGlhU291cmNlLAogICAgICB3aW5kb3cKICAgIH07CgogICAgaWYgKHQuVUkgJiYgdC5VSS5maW5kUG9wdXBXcmFwV2l0aEVsZW1lbnQpIHsKICAgICAgaW5mby5jdXJsUG9wdXBXcmFwID0gdC5VSS5maW5kUG9wdXBXcmFwV2l0aEVsZW1lbnQocGxheWVyKTsKICAgICAgaW5mby5hbGxQb3B1cFdyYXAgPSB0LlVJLmdldEFsbFBvcHVwV3JhcEVsZW1lbnQoKTsKICAgIH0KCiAgICBkZWJ1Zy5pbmZvKCdbcGxheWVySW5mb10nLCBpbmZvKTsKICB9LAoKICAvKiDorr7nva7op4bpopHlhajlsY8gKi8KICBzZXRGdWxsU2NyZWVuICgpIHsKICAgIGNvbnN0IHBsYXllciA9IHRoaXMucGxheWVyKCk7CiAgICBjb25zdCBpc0RvID0gVENDLmRvVGFzaygnZnVsbFNjcmVlbicpOwogICAgaWYgKCFpc0RvICYmIHBsYXllciAmJiBwbGF5ZXIuX2Z1bGxTY3JlZW5fKSB7CiAgICAgIHBsYXllci5fZnVsbFNjcmVlbl8udG9nZ2xlKCk7CiAgICB9CiAgfSwKCiAgLyog6K6+572u6aG16Z2i5YWo5bGPICovCiAgc2V0V2ViRnVsbFNjcmVlbjogZnVuY3Rpb24gKCkgewogICAgY29uc3QgdCA9IHRoaXM7CiAgICBjb25zdCBwbGF5ZXIgPSB0LnBsYXllcigpOwogICAgY29uc3QgaXNEbyA9IFRDQy5kb1Rhc2soJ3dlYkZ1bGxTY3JlZW4nKTsKICAgIGlmICghaXNEbyAmJiBwbGF5ZXIgJiYgcGxheWVyLl9mdWxsUGFnZVNjcmVlbl8pIHsKICAgICAgcGxheWVyLl9mdWxsUGFnZVNjcmVlbl8udG9nZ2xlKCk7CiAgICB9CiAgfSwKCiAgaW5pdFBsYXliYWNrUmF0ZSAoKSB7CiAgICBjb25zdCB0ID0gdGhpczsKICAgIHQucGxheWJhY2tSYXRlID0gdC5nZXRQbGF5YmFja1JhdGUoKTsKICB9LAoKICBwbGF5YmFja1JhdGVJbmZvOiB7CiAgICBsb2NrVGltZW91dDogRGF0ZS5ub3coKSAtIDEsCiAgICB0aW1lOiBEYXRlLm5vdygpLAogICAgLyog5pyq5Yid5aeL5YyW5pKt5pS+5a6e5YiX5YmN77yM5LiN55+l6YGT5YCN6YCf5piv5aSa5bCR77yM5omA5Lul6K6+572u5Li6LTEgKi8KICAgIHZhbHVlOiAtMQogIH0sCgogIGdldFBsYXliYWNrUmF0ZSAoKSB7CiAgICBsZXQgcGxheWJhY2tSYXRlID0gY29uZmlnTWFuYWdlci5nZXQoJ21lZGlhLnBsYXliYWNrUmF0ZScpIHx8IHRoaXMucGxheWJhY2tSYXRlOwogICAgaWYgKGlzSW5JZnJhbWUoKSkgewogICAgICBjb25zdCBnbG9iYWxQbGF5YmFja1JhdGUgPSBjb25maWdNYW5hZ2VyLmdldEdsb2JhbFN0b3JhZ2UoJ21lZGlhLnBsYXliYWNrUmF0ZScpOwogICAgICBpZiAoZ2xvYmFsUGxheWJhY2tSYXRlKSB7CiAgICAgICAgcGxheWJhY2tSYXRlID0gZ2xvYmFsUGxheWJhY2tSYXRlOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gTnVtYmVyKE51bWJlcihwbGF5YmFja1JhdGUpLnRvRml4ZWQoMSkpCiAgfSwKCiAgLyog6ZSB5a6acGxheWJhY2tSYXRl77yM56aB5q2i6LCD6YCfICovCiAgbG9ja1BsYXliYWNrUmF0ZTogZnVuY3Rpb24gKHRpbWVvdXQgPSAyMDApIHsKICAgIGlmICh0aGlzLm1lZGlhUGx1c0FwaSkgewogICAgICBpZiAoY29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UuYmxvY2tTZXRQbGF5YmFja1JhdGUnKSA9PT0gdHJ1ZSkgewogICAgICAgIC8vIOWmguaenOmFjee9ruS6huimgemUgeatu+WklumDqOWvuXBsYXliYWNrUmF0ZeeahOaTjeS9nO+8jOWImeebtOaOpee7meS4gOS4qui2heWkp+eahOWAvAogICAgICAgIHRpbWVvdXQgPSAxMDAwICogNjAgKiA2MCAqIDI0ICogMzY1OwogICAgICB9CgogICAgICB0aGlzLm1lZGlhUGx1c0FwaS5sb2NrUGxheWJhY2tSYXRlKHRpbWVvdXQpOwogICAgICByZXR1cm4gdHJ1ZQogICAgfQoKICAgIHRoaXMucGxheWJhY2tSYXRlSW5mby5sb2NrVGltZW91dCA9IERhdGUubm93KCkgKyB0aW1lb3V0OwogIH0sCgogIHVuTG9ja1BsYXliYWNrUmF0ZTogZnVuY3Rpb24gKCkgewogICAgaWYgKHRoaXMubWVkaWFQbHVzQXBpKSB7CiAgICAgIHRoaXMubWVkaWFQbHVzQXBpLnVuTG9ja1BsYXliYWNrUmF0ZSgpOwogICAgICByZXR1cm4gdHJ1ZQogICAgfQoKICAgIHRoaXMucGxheWJhY2tSYXRlSW5mby5sb2NrVGltZW91dCA9IERhdGUubm93KCkgLSAxOwogIH0sCgogIGlzTG9ja1BsYXliYWNrUmF0ZTogZnVuY3Rpb24gKCkgewogICAgaWYgKHRoaXMubWVkaWFQbHVzQXBpKSB7CiAgICAgIHJldHVybiB0aGlzLm1lZGlhUGx1c0FwaS5pc0xvY2tQbGF5YmFja1JhdGUoKQogICAgfQoKICAgIHJldHVybiBEYXRlLm5vdygpIC0gdGhpcy5wbGF5YmFja1JhdGVJbmZvLmxvY2tUaW1lb3V0IDwgMAogIH0sCgogIC8qIOino+WGs+mrmOS9juWAjemAn+mikee5geWIh+aNouWQju+8jOmfs+eUu+S4jeWQjOatpeeahOmXrumimCAqLwogIGZpeFBsYXliYWNrUmF0ZTogZnVuY3Rpb24gKG9sZFBsYXliYWNrUmF0ZSkgewogICAgY29uc3QgdCA9IHRoaXM7CiAgICBjb25zdCBjdXJQbGF5YmFja1JhdGUgPSB0LmdldFBsYXliYWNrUmF0ZSgpOwoKICAgIGlmIChNYXRoLmFicyhjdXJQbGF5YmFja1JhdGUgLSBvbGRQbGF5YmFja1JhdGUpID4gMSkgewogICAgICB0LnNldEN1cnJlbnRUaW1lVXAoMC4xLCB0cnVlKTsKICAgIH0KICB9LAoKICAvKiDorr7nva7mkq3mlL7pgJ/luqYgKi8KICBzZXRQbGF5YmFja1JhdGU6IGZ1bmN0aW9uIChudW0sIG5vdGlwcywgZHVwbGljYXRlLCBza2lwTG9jaykgewogICAgY29uc3QgdCA9IHRoaXM7CiAgICBjb25zdCBwbGF5ZXIgPSB0LnBsYXllcigpOwoKICAgIGlmICghc2tpcExvY2sgJiYgdC5pc0xvY2tQbGF5YmFja1JhdGUoKSkgewogICAgICBkZWJ1Zy5pbmZvKCfosIPpgJ/og73lipvlt7LooqvplIHlrponKTsKICAgICAgcmV0dXJuIGZhbHNlCiAgICB9CgogICAgaWYgKFRDQy5kb1Rhc2soJ3BsYXliYWNrUmF0ZScpKSB7CiAgICAgIC8vIGRlYnVnLmxvZygnW1RDQ11bcGxheWJhY2tSYXRlXScsICdzdWMnKQogICAgICByZXR1cm4KICAgIH0KCiAgICBpZiAoIXBsYXllcikgcmV0dXJuCgogICAgY29uc3Qgb2xkUGxheWJhY2tSYXRlID0gdC5nZXRQbGF5YmFja1JhdGUoKTsKCiAgICBsZXQgY3VyUGxheWJhY2tSYXRlOwogICAgaWYgKG51bSkgewogICAgICBudW0gPSBOdW1iZXIobnVtKTsKICAgICAgaWYgKE51bWJlci5pc05hTihudW0pKSB7CiAgICAgICAgZGVidWcuZXJyb3IoJ2g1cGxheWVyOiDmkq3mlL7pgJ/luqbovazmjaLlh7rplJknKTsKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfQoKICAgICAgaWYgKG51bSA8PSAwKSB7CiAgICAgICAgbnVtID0gMC4xOwogICAgICB9IGVsc2UgaWYgKG51bSA+IDE2KSB7CiAgICAgICAgbnVtID0gMTY7CiAgICAgIH0KCiAgICAgIG51bSA9IE51bWJlcihudW0udG9GaXhlZCgxKSk7CiAgICAgIGN1clBsYXliYWNrUmF0ZSA9IG51bTsKICAgIH0gZWxzZSB7CiAgICAgIGN1clBsYXliYWNrUmF0ZSA9IHQuZ2V0UGxheWJhY2tSYXRlKCk7CiAgICB9CgogICAgLyog6K6w5b2V5pKt5pS+6YCf5bqm55qE5L+h5oGvICovCiAgICB0LnBsYXliYWNrUmF0ZSA9IGN1clBsYXliYWNrUmF0ZTsKICAgIGlmIChpc0luSWZyYW1lKCkpIHsKICAgICAgY29uZmlnTWFuYWdlci5zZXRHbG9iYWxTdG9yYWdlKCdtZWRpYS5wbGF5YmFja1JhdGUnLCBjdXJQbGF5YmFja1JhdGUpOwogICAgfSBlbHNlIHsKICAgICAgY29uZmlnTWFuYWdlci5zZXQoJ21lZGlhLnBsYXliYWNrUmF0ZScsIGN1clBsYXliYWNrUmF0ZSk7CiAgICB9CgogICAgaWYgKHQubWVkaWFQbHVzQXBpKSB7CiAgICAgIHQubWVkaWFQbHVzQXBpLnNldFBsYXliYWNrUmF0ZShjdXJQbGF5YmFja1JhdGUpOwoKICAgICAgaWYgKCEoIW51bSAmJiBjdXJQbGF5YmFja1JhdGUgPT09IDEpICYmICFub3RpcHMpIHsKICAgICAgICB0LnRpcHMoaTE4bi50KCd0aXBzTXNnLnBsYXlzcGVlZCcpICsgcGxheWVyLnBsYXliYWNrUmF0ZSk7CiAgICAgIH0KCiAgICAgIC8qIOWwhuaSreaUvuWAjemAn+WQjOatpeWIsOWFqOmDqOWqkuS9k+WFg+e0oCAqLwogICAgICBjb25zdCBtZWRpYUxpc3QgPSB0LmdldFBsYXllckxpc3QoKTsKICAgICAgbWVkaWFMaXN0LmZvckVhY2gobWVkaWEgPT4gewogICAgICAgIGlmIChtZWRpYSAhPT0gcGxheWVyKSB7CiAgICAgICAgICBjb25zdCBtZWRpYVBsdXNBcGkgPSBtZWRpYUNvcmUubWVkaWFQbHVzKG1lZGlhKTsKICAgICAgICAgIG1lZGlhUGx1c0FwaSAmJiBtZWRpYVBsdXNBcGkuc2V0UGxheWJhY2tSYXRlKGN1clBsYXliYWNrUmF0ZSk7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIHQuZml4UGxheWJhY2tSYXRlKG9sZFBsYXliYWNrUmF0ZSk7CiAgICAgIHJldHVybiB0cnVlCiAgICB9CgogICAgZGVsZXRlIHBsYXllci5wbGF5YmFja1JhdGU7CiAgICBwbGF5ZXIucGxheWJhY2tSYXRlID0gY3VyUGxheWJhY2tSYXRlOwoKICAgIHQucGxheWJhY2tSYXRlSW5mby50aW1lID0gRGF0ZS5ub3coKTsKICAgIHQucGxheWJhY2tSYXRlSW5mby52YWx1ZSA9IGN1clBsYXliYWNrUmF0ZTsKICAgIHBsYXllci5fc2V0UGxheWJhY2tSYXRlXyA9IHsKICAgICAgdGltZTogRGF0ZS5ub3coKSwKICAgICAgdmFsdWU6IGN1clBsYXliYWNrUmF0ZQogICAgfTsKCiAgICB0cnkgewogICAgICBjb25zdCBwbGF5YmFja1JhdGVEZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihIVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSwgJ3BsYXliYWNrUmF0ZScpOwogICAgICBvcmlnaW5hbE1ldGhvZHMuT2JqZWN0LmRlZmluZVByb3BlcnR5LmNhbGwoT2JqZWN0LCBwbGF5ZXIsICdwbGF5YmFja1JhdGUnLCB7CiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIGdldDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLyoqCiAgICAgICAgICAgKiDlnKjmsrnnrqHvvIzlpoLmnpzov5Tlm57nmoTmmK9wbGF5YmFja1JhdGVEZXNjcmlwdG9yLmdldC5hcHBseShwbGF5ZXIsIGFyZ3VtZW50cynvvIzosIPpgJ/kvJrlh7rnjrDms6LliqjlkozlvILluLgKICAgICAgICAgICAqIOaaguaXtuS4jeefpeaYr+S7gOS5iOWOn+WboO+8jOaJgOS7pei/mOaYr+WFiOi/lOWbnmN1clBsYXliYWNrUmF0ZQogICAgICAgICAgICovCiAgICAgICAgICByZXR1cm4gY3VyUGxheWJhY2tSYXRlIHx8IHBsYXliYWNrUmF0ZURlc2NyaXB0b3IuZ2V0LmFwcGx5KHBsYXllciwgYXJndW1lbnRzKQogICAgICAgIH0sCiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgICBpZiAodHlwZW9mIHZhbCAhPT0gJ251bWJlcicpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgICB9CgogICAgICAgICAgLyog5pyJ5Lqb572R56uZ5piv6YCa6L+H5a6a5pe25Zmo5LiN5pat5Yi3cGxheWJhY2tSYXRl55qE77yM5omA5Lul6YCa6L+H6K6h5pe25Zmo5YeP5bCR5LiN5b+F6KaB55qE5L+h5oGv6L6T5Ye6ICovCiAgICAgICAgICAhTnVtYmVyLmlzSW50ZWdlcihwbGF5ZXIuX2Jsb2NrU2V0UGxheWJhY2tSYXRlVGlwc18pICYmIChwbGF5ZXIuX2Jsb2NrU2V0UGxheWJhY2tSYXRlVGlwc18gPSAwKTsKCiAgICAgICAgICBpZiAoVENDLmRvVGFzaygnYmxvY2tTZXRQbGF5YmFja1JhdGUnKSkgewogICAgICAgICAgICBwbGF5ZXIuX2Jsb2NrU2V0UGxheWJhY2tSYXRlVGlwc18rKzsKICAgICAgICAgICAgcGxheWVyLl9ibG9ja1NldFBsYXliYWNrUmF0ZVRpcHNfIDwgMyAmJiBkZWJ1Zy5pbmZvKCfosIPpgJ/og73lipvlt7Looqvoh6rlrprkuYnnmoTosIPpgJ/ku7vliqHov5vooYzlpITnkIYnKTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGNvbmZpZ01hbmFnZXIuZ2V0KCdlbmhhbmNlLmJsb2NrU2V0UGxheWJhY2tSYXRlJykgPT09IHRydWUpIHsKICAgICAgICAgICAgcGxheWVyLl9ibG9ja1NldFBsYXliYWNrUmF0ZVRpcHNfKys7CiAgICAgICAgICAgIHBsYXllci5fYmxvY2tTZXRQbGF5YmFja1JhdGVUaXBzXyA8IDMgJiYgZGVidWcuaW5mbygn6LCD6YCf6IO95Yqb5bey6KKrYmxvY2tTZXRQbGF5YmFja1JhdGXplIHlrponKTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0LnNldFBsYXliYWNrUmF0ZSh2YWwpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIGRlYnVnLmVycm9yKCfop6PplIFwbGF5YmFja1JhdGXlpLHotKUnLCBlKTsKICAgIH0KCiAgICAvKiDmnKzouqvlpITkuo4x5YCN5pKt5pS+6YCf5bqm55qE5pe25YCZ5LiN5YaN5o+Q56S6ICovCiAgICBpZiAoIW51bSAmJiBjdXJQbGF5YmFja1JhdGUgPT09IDEpIHsKICAgICAgcmV0dXJuIHRydWUKICAgIH0gZWxzZSB7CiAgICAgICFub3RpcHMgJiYgdC50aXBzKGkxOG4udCgndGlwc01zZy5wbGF5c3BlZWQnKSArIHBsYXllci5wbGF5YmFja1JhdGUpOwogICAgfQoKICAgIC8qKgogICAgICog6YeN5aSN6Kem5Y+R5pyA5ZCO5LiA5qyh5YCN6YCf55qE6K6+5a6aCiAgICAgKiDop6PlhrNZb3VUdWJl5b+r6YCf6LCD6YCf5pe25bm25LiN55Sf5pWI77yM6KaB5YGc6aG/5LiL5p2l5YaN6LCD6IqC5LiA5LiL5omN6IO955Sf5pWI55qE6Zeu6aKYCiAgICAgKi8KICAgIGlmICghZHVwbGljYXRlICYmIGNvbmZpZ01hbmFnZXIuZ2V0KCdlbmhhbmNlLmJsb2NrU2V0UGxheWJhY2tSYXRlJykgPT09IHRydWUpIHsKICAgICAgY2xlYXJUaW1lb3V0KHQuX3NldFBsYXliYWNrUmF0ZUR1cGxpY2F0ZV8pOwogICAgICBjbGVhclRpbWVvdXQodC5fc2V0UGxheWJhY2tSYXRlRHVwbGljYXRlMl8pOwogICAgICBjb25zdCBkdXBsaWNhdGVQbGF5YmFja1JhdGUgPSAoKSA9PiB7CiAgICAgICAgdC51bkxvY2tQbGF5YmFja1JhdGUoKTsKICAgICAgICB0LnNldFBsYXliYWNrUmF0ZShjdXJQbGF5YmFja1JhdGUsIHRydWUsIHRydWUpOwogICAgICAgIHQubG9ja1BsYXliYWNrUmF0ZSgxMDAwKTsKICAgICAgfTsKICAgICAgdC5fc2V0UGxheWJhY2tSYXRlRHVwbGljYXRlXyA9IHNldFRpbWVvdXQoZHVwbGljYXRlUGxheWJhY2tSYXRlLCA2MDApOwogICAgICAvKiA2MDBtc+aXtumHjeaWsOinpuWPkeaXoOaViOeahOivne+8jOWGjeadpeS4qjEyMDBtc+WQjuinpuWPke+8jOWmguaenOaYrzEyMDBtc+aJjeeUn+aViO+8jOWImeiwg+mAn+eUn+aViOeahOW7tui/n+W3sue7j+mdnuW4uOaYjuaYvuS6hiAqLwogICAgICB0Ll9zZXRQbGF5YmFja1JhdGVEdXBsaWNhdGUyXyA9IHNldFRpbWVvdXQoZHVwbGljYXRlUGxheWJhY2tSYXRlLCAxMjAwKTsKICAgIH0KCiAgICB0LmZpeFBsYXliYWNrUmF0ZShvbGRQbGF5YmFja1JhdGUpOwogIH0sCgogIC8qKgogICAqIOWKoOW8uueJiOeahOWAjemAn+iwg+iKgu+8jOW9k+efreaXtumXtOWGheiuvue9ruWQjOS4gOS4quWAvOaXtu+8jOS8muiupOS4uumcgOabtOW/q+eahOi3s+mAn+iDveWKmwogICAqIOWImeS8muWvueiwg+mAn+eahOaVsOWAvOi/m+ihjOWPoOWKoOaUvuWkp++8jOS7juiAjOi+vuWIsOW/q+mAn+i3s+i3g+WcsOi/m+ihjOWAjemAn+iwg+iKgueahOebrueahAogICAqIOWPr+eUqOS6juinhumikeW5v+WRiueahOmrmOmAn+W/q+i/m++8jOeJh+WktOeJh+WwvueahOmAn+eci+etieWcuuaZrwogICAqIEBwYXJhbSB7Kn0gbnVtCiAgICovCiAgc2V0UGxheWJhY2tSYXRlUGx1czogZnVuY3Rpb24gKG51bSkgewogICAgbnVtID0gTnVtYmVyKG51bSk7CiAgICBpZiAoIW51bSB8fCBOdW1iZXIuaXNOYU4obnVtKSkgewogICAgICByZXR1cm4gZmFsc2UKICAgIH0KCiAgICBjb25zdCB0ID0gdGhpczsKICAgIHQucGxheWJhY2tSYXRlUGx1c0luZm8gPSB0LnBsYXliYWNrUmF0ZVBsdXNJbmZvIHx8IHt9OwogICAgdC5wbGF5YmFja1JhdGVQbHVzSW5mb1tudW1dID0gdC5wbGF5YmFja1JhdGVQbHVzSW5mb1tudW1dIHx8IHsKICAgICAgdGltZTogRGF0ZS5ub3coKSAtIDEwMDAsCiAgICAgIHZhbHVlOiBudW0KICAgIH07CgogICAgaWYgKERhdGUubm93KCkgLSB0LnBsYXliYWNrUmF0ZVBsdXNJbmZvW251bV0udGltZSA8IDMwMCkgewogICAgICB0LnBsYXliYWNrUmF0ZVBsdXNJbmZvW251bV0udmFsdWUgPSB0LnBsYXliYWNrUmF0ZVBsdXNJbmZvW251bV0udmFsdWUgKyBudW07CiAgICB9IGVsc2UgewogICAgICB0LnBsYXliYWNrUmF0ZVBsdXNJbmZvW251bV0udmFsdWUgPSBudW07CiAgICB9CgogICAgdC5wbGF5YmFja1JhdGVQbHVzSW5mb1tudW1dLnRpbWUgPSBEYXRlLm5vdygpOwoKICAgIHQudW5Mb2NrUGxheWJhY2tSYXRlKCk7CiAgICB0LnNldFBsYXliYWNrUmF0ZSh0LnBsYXliYWNrUmF0ZVBsdXNJbmZvW251bV0udmFsdWUpOwogICAgdC5sb2NrUGxheWJhY2tSYXRlKDEwMDApOwogIH0sCgogIC8qIOaBouWkjeaSreaUvumAn+W6pu+8jOi/mOWOn+WIsDHlgI3pgJ/luqbjgIHmiJbmgaLlpI3liLDkuIrmrKHnmoTlgI3pgJ8gKi8KICByZXNldFBsYXliYWNrUmF0ZTogZnVuY3Rpb24gKHBsYXllcikgewogICAgY29uc3QgdCA9IHRoaXM7CiAgICBwbGF5ZXIgPSBwbGF5ZXIgfHwgdC5wbGF5ZXIoKTsKCiAgICB0LnVuTG9ja1BsYXliYWNrUmF0ZSgpOwoKICAgIGNvbnN0IG9sZFBsYXliYWNrUmF0ZSA9IE51bWJlcihwbGF5ZXIucGxheWJhY2tSYXRlKTsKICAgIGNvbnN0IHBsYXliYWNrUmF0ZSA9IG9sZFBsYXliYWNrUmF0ZSA9PT0gMSA/IHQubGFzdFBsYXliYWNrUmF0ZSA6IDE7CiAgICBpZiAob2xkUGxheWJhY2tSYXRlICE9PSAxKSB7CiAgICAgIHQubGFzdFBsYXliYWNrUmF0ZSA9IG9sZFBsYXliYWNrUmF0ZTsKICAgICAgY29uZmlnTWFuYWdlci5zZXRMb2NhbFN0b3JhZ2UoJ21lZGlhLmxhc3RQbGF5YmFja1JhdGUnLCBvbGRQbGF5YmFja1JhdGUpOwogICAgfQoKICAgIHQuc2V0UGxheWJhY2tSYXRlKHBsYXliYWNrUmF0ZSk7CgogICAgLyog6Ziy5q2i5aSW6YOo6LCD6YCf6YC76L6R55qE5bmy5omw77yM5omA5Lul6ZSB5a6a5LiA5q615pe26Ze0ICovCiAgICB0LmxvY2tQbGF5YmFja1JhdGUoMTAwMCk7CiAgfSwKCiAgLyog5o+Q5Y2H5pKt5pS+6YCf546HICovCiAgc2V0UGxheWJhY2tSYXRlVXAgKG51bSkgewogICAgbnVtID0gbnVtVXAobnVtKSB8fCAwLjE7CiAgICBpZiAodGhpcy5wbGF5ZXIoKSkgewogICAgICB0aGlzLnVuTG9ja1BsYXliYWNrUmF0ZSgpOwogICAgICB0aGlzLnNldFBsYXliYWNrUmF0ZSh0aGlzLnBsYXllcigpLnBsYXliYWNrUmF0ZSArIG51bSk7CgogICAgICAvKiDpmLLmraLlpJbpg6josIPpgJ/pgLvovpHnmoTlubLmibDvvIzmiYDku6XplIHlrprkuIDmrrXml7bpl7QgKi8KICAgICAgdGhpcy5sb2NrUGxheWJhY2tSYXRlKDEwMDApOwogICAgfQogIH0sCgogIC8qIOmZjeS9juaSreaUvumAn+eOhyAqLwogIHNldFBsYXliYWNrUmF0ZURvd24gKG51bSkgewogICAgbnVtID0gbnVtRG93bihudW0pIHx8IC0wLjE7CiAgICBpZiAodGhpcy5wbGF5ZXIoKSkgewogICAgICB0aGlzLnVuTG9ja1BsYXliYWNrUmF0ZSgpOwogICAgICB0aGlzLnNldFBsYXliYWNrUmF0ZSh0aGlzLnBsYXllcigpLnBsYXliYWNrUmF0ZSArIG51bSk7CgogICAgICAvKiDpmLLmraLlpJbpg6josIPpgJ/pgLvovpHnmoTlubLmibDvvIzmiYDku6XplIHlrprkuIDmrrXml7bpl7QgKi8KICAgICAgdGhpcy5sb2NrUGxheWJhY2tSYXRlKDEwMDApOwogICAgfQogIH0sCgogIC8qKgogICAqIOmUgeWumuaSreaUvui/m+W6pueahOaOp+WItumAu+i+kQogICAqIOi3n+mUgeWumumfs+mHj+WSjOWAjemAn+S4jeS4gOagt++8jOaSreaUvui/m+W6puaYr+i3n+inhumikeWunuS+i+acieWvhuWIh+ebuOWFs+eahO+8jOaJgOS7peWFtumUgeWumuS/oeaBr+W/hemhu+S+nemZhOS6juaSreaUvuWunuS+iwogICAqLwogIGxvY2tDdXJyZW50VGltZTogZnVuY3Rpb24gKHRpbWVvdXQgPSAyMDApIHsKICAgIGlmICh0aGlzLm1lZGlhUGx1c0FwaSkgewogICAgICBpZiAoY29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UuYmxvY2tTZXRDdXJyZW50VGltZScpID09PSB0cnVlKSB7CiAgICAgICAgLy8g5aaC5p6c6YWN572u5LqG6KaB6ZSB5q275aSW6YOo5a+5Y3VycmVudFRpbWXnmoTmk43kvZzvvIzliJnnm7TmjqXnu5nkuIDkuKrotoXlpKfnmoTlgLwKICAgICAgICB0aW1lb3V0ID0gMTAwMCAqIDYwICogNjAgKiAyNCAqIDM2NTsKICAgICAgfQoKICAgICAgdGhpcy5tZWRpYVBsdXNBcGkubG9ja0N1cnJlbnRUaW1lKHRpbWVvdXQpOwogICAgICByZXR1cm4gdHJ1ZQogICAgfQoKICAgIGNvbnN0IHBsYXllciA9IHRoaXMucGxheWVyKCk7CiAgICBpZiAocGxheWVyKSB7CiAgICAgIHBsYXllci5jdXJyZW50VGltZUluZm8gPSBwbGF5ZXIuY3VycmVudFRpbWVJbmZvIHx8IHt9OwogICAgICBwbGF5ZXIuY3VycmVudFRpbWVJbmZvLmxvY2tUaW1lb3V0ID0gRGF0ZS5ub3coKSArIHRpbWVvdXQ7CiAgICB9CiAgfSwKCiAgdW5Mb2NrQ3VycmVudFRpbWU6IGZ1bmN0aW9uICgpIHsKICAgIGlmICh0aGlzLm1lZGlhUGx1c0FwaSkgewogICAgICB0aGlzLm1lZGlhUGx1c0FwaS51bkxvY2tDdXJyZW50VGltZSgpOwogICAgICByZXR1cm4gdHJ1ZQogICAgfQoKICAgIGNvbnN0IHBsYXllciA9IHRoaXMucGxheWVyKCk7CiAgICBpZiAocGxheWVyKSB7CiAgICAgIHBsYXllci5jdXJyZW50VGltZUluZm8gPSBwbGF5ZXIuY3VycmVudFRpbWVJbmZvIHx8IHt9OwogICAgICBwbGF5ZXIuY3VycmVudFRpbWVJbmZvLmxvY2tUaW1lb3V0ID0gRGF0ZS5ub3coKSAtIDE7CiAgICB9CiAgfSwKCiAgaXNMb2NrQ3VycmVudFRpbWU6IGZ1bmN0aW9uICgpIHsKICAgIGlmICh0aGlzLm1lZGlhUGx1c0FwaSkgewogICAgICByZXR1cm4gdGhpcy5tZWRpYVBsdXNBcGkuaXNMb2NrQ3VycmVudFRpbWUoKQogICAgfQoKICAgIGNvbnN0IHBsYXllciA9IHRoaXMucGxheWVyKCk7CiAgICBpZiAocGxheWVyICYmIHBsYXllci5jdXJyZW50VGltZUluZm8gJiYgcGxheWVyLmN1cnJlbnRUaW1lSW5mby5sb2NrVGltZW91dCkgewogICAgICByZXR1cm4gRGF0ZS5ub3coKSAtIHBsYXllci5jdXJyZW50VGltZUluZm8ubG9ja1RpbWVvdXQgPCAwCiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZmFsc2UKICAgIH0KICB9LAoKICAvKiDorr7nva7mkq3mlL7ov5vluqYgKi8KICBzZXRDdXJyZW50VGltZTogZnVuY3Rpb24gKG51bSkgewogICAgaWYgKCFudW0gJiYgbnVtICE9PSAwKSByZXR1cm4KICAgIG51bSA9IE51bWJlcihudW0pOwogICAgY29uc3QgX251bSA9IE1hdGguYWJzKE51bWJlcihudW0udG9GaXhlZCgxKSkpOwoKICAgIGNvbnN0IHQgPSB0aGlzOwogICAgY29uc3QgcGxheWVyID0gdC5wbGF5ZXIoKTsKCiAgICBpZiAodC5pc0xvY2tDdXJyZW50VGltZSgpKSB7CiAgICAgIHJldHVybiBmYWxzZQogICAgfQoKICAgIGlmIChUQ0MuZG9UYXNrKCdjdXJyZW50VGltZScpKSB7CiAgICAgIC8vIGRlYnVnLmxvZygnW1RDQ11bY3VycmVudFRpbWVdJywgJ3N1YycpCiAgICAgIHJldHVybgogICAgfQoKICAgIGlmICh0aGlzLm1lZGlhUGx1c0FwaSkgewogICAgICB0aGlzLm1lZGlhUGx1c0FwaS5zZXRDdXJyZW50VGltZShfbnVtKTsKICAgICAgcmV0dXJuIHRydWUKICAgIH0KCiAgICBkZWxldGUgcGxheWVyLmN1cnJlbnRUaW1lOwogICAgcGxheWVyLmN1cnJlbnRUaW1lID0gX251bTsKICAgIHBsYXllci5jdXJyZW50VGltZUluZm8gPSBwbGF5ZXIuY3VycmVudFRpbWVJbmZvIHx8IHt9OwogICAgcGxheWVyLmN1cnJlbnRUaW1lSW5mby50aW1lID0gRGF0ZS5ub3coKTsKICAgIHBsYXllci5jdXJyZW50VGltZUluZm8udmFsdWUgPSBfbnVtOwoKICAgIHRyeSB7CiAgICAgIGNvbnN0IGN1cnJlbnRUaW1lRGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoSFRNTE1lZGlhRWxlbWVudC5wcm90b3R5cGUsICdjdXJyZW50VGltZScpOwogICAgICBvcmlnaW5hbE1ldGhvZHMuT2JqZWN0LmRlZmluZVByb3BlcnR5LmNhbGwoT2JqZWN0LCBwbGF5ZXIsICdjdXJyZW50VGltZScsIHsKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBjdXJyZW50VGltZURlc2NyaXB0b3IuZ2V0LmFwcGx5KHBsYXllciwgYXJndW1lbnRzKQogICAgICAgIH0sCiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgICBpZiAodHlwZW9mIHZhbCAhPT0gJ251bWJlcicgfHwgVENDLmRvVGFzaygnYmxvY2tTZXRDdXJyZW50VGltZScpIHx8IGNvbmZpZ01hbmFnZXIuZ2V0KCdlbmhhbmNlLmJsb2NrU2V0Q3VycmVudFRpbWUnKSA9PT0gdHJ1ZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodC5pc0xvY2tDdXJyZW50VGltZSgpKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgICAgfQoKICAgICAgICAgIHBsYXllci5jdXJyZW50VGltZUluZm8udGltZSA9IERhdGUubm93KCk7CiAgICAgICAgICBwbGF5ZXIuY3VycmVudFRpbWVJbmZvLnZhbHVlID0gdmFsOwoKICAgICAgICAgIHJldHVybiBjdXJyZW50VGltZURlc2NyaXB0b3Iuc2V0LmFwcGx5KHBsYXllciwgYXJndW1lbnRzKQogICAgICAgIH0KICAgICAgfSk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIGRlYnVnLmVycm9yKCfop6PplIFjdXJyZW50VGltZeWksei0pScsIGUpOwogICAgfQogIH0sCgogIHNldEN1cnJlbnRUaW1lVXAgKG51bSwgaGlkZVRpcHMpIHsKICAgIG51bSA9IE51bWJlcihudW1VcChudW0pIHx8IHRoaXMuc2tpcFN0ZXApOwoKICAgIGlmIChUQ0MuZG9UYXNrKCdhZGRDdXJyZW50VGltZScpKSA7IGVsc2UgewogICAgICBpZiAodGhpcy5wbGF5ZXIoKSkgewogICAgICAgIHRoaXMudW5Mb2NrQ3VycmVudFRpbWUoKTsKICAgICAgICB0aGlzLnNldEN1cnJlbnRUaW1lKHRoaXMucGxheWVyKCkuY3VycmVudFRpbWUgKyBudW0pOwoKICAgICAgICAvKiDpmLLmraLlpJbpg6jov5vluqbmjqfliLbpgLvovpHnmoTlubLmibDvvIzmiYDku6XplIHlrprkuIDmrrXml7bpl7QgKi8KICAgICAgICB0aGlzLmxvY2tDdXJyZW50VGltZSg1MDApOwoKICAgICAgICBpZiAoIWhpZGVUaXBzKSB7CiAgICAgICAgICB0aGlzLnRpcHMoaTE4bi50KCd0aXBzTXNnLmZvcndhcmQnKSArIG51bSArIGkxOG4udCgndGlwc01zZy5zZWNvbmRzJykpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sCgogIHNldEN1cnJlbnRUaW1lRG93biAobnVtKSB7CiAgICBudW0gPSBOdW1iZXIobnVtRG93bihudW0pIHx8IC10aGlzLnNraXBTdGVwKTsKCiAgICBpZiAoVENDLmRvVGFzaygnc3VidHJhY3RDdXJyZW50VGltZScpKSA7IGVsc2UgewogICAgICBpZiAodGhpcy5wbGF5ZXIoKSkgewogICAgICAgIGxldCBjdXJyZW50VGltZSA9IHRoaXMucGxheWVyKCkuY3VycmVudFRpbWUgKyBudW07CiAgICAgICAgaWYgKGN1cnJlbnRUaW1lIDwgMSkgewogICAgICAgICAgY3VycmVudFRpbWUgPSAwOwogICAgICAgIH0KCiAgICAgICAgdGhpcy51bkxvY2tDdXJyZW50VGltZSgpOwogICAgICAgIHRoaXMuc2V0Q3VycmVudFRpbWUoY3VycmVudFRpbWUpOwoKICAgICAgICAvKiDpmLLmraLlpJbpg6jov5vluqbmjqfliLbpgLvovpHnmoTlubLmibDvvIzmiYDku6XplIHlrprkuIDmrrXml7bpl7QgKi8KICAgICAgICB0aGlzLmxvY2tDdXJyZW50VGltZSg1MDApOwoKICAgICAgICB0aGlzLnRpcHMoaTE4bi50KCd0aXBzTXNnLmJhY2t3YXJkJykgKyBNYXRoLmFicyhudW0pICsgaTE4bi50KCd0aXBzTXNnLnNlY29uZHMnKSk7CiAgICAgIH0KICAgIH0KICB9LAoKICB2b2x1bWVJbmZvOiB7CiAgICBsb2NrVGltZW91dDogRGF0ZS5ub3coKSAtIDEsCiAgICB0aW1lOiBEYXRlLm5vdygpLAogICAgLyog5pyq5Yid5aeL5YyW5pKt5pS+5a6e5YiX5YmN77yM5LiN55+l6YGT6Z+z6YeP5piv5aSa5bCR77yM5omA5Lul6K6+572u5Li6LTEgKi8KICAgIHZhbHVlOiAtMQogIH0sCgogIGdldFZvbHVtZTogZnVuY3Rpb24gKCkgewogICAgbGV0IHZvbHVtZSA9IGNvbmZpZ01hbmFnZXIuZ2V0KCdtZWRpYS52b2x1bWUnKTsKICAgIGlmIChpc0luSWZyYW1lKCkgfHwgY29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UuYmxvY2tTZXRWb2x1bWUnKSA9PT0gdHJ1ZSkgewogICAgICBjb25zdCBnbG9iYWxWb2x1bWUgPSBjb25maWdNYW5hZ2VyLmdldEdsb2JhbFN0b3JhZ2UoJ21lZGlhLnZvbHVtZScpOwogICAgICBpZiAoZ2xvYmFsVm9sdW1lICE9PSBudWxsKSB7CiAgICAgICAgdm9sdW1lID0gZ2xvYmFsVm9sdW1lOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gTnVtYmVyKE51bWJlcih2b2x1bWUpLnRvRml4ZWQoMikpCiAgfSwKCiAgLyog6ZSB5a6a6Z+z6YeP77yM56aB5q2i6LCD6Z+zICovCiAgbG9ja1ZvbHVtZTogZnVuY3Rpb24gKHRpbWVvdXQgPSAyMDApIHsKICAgIGlmICh0aGlzLm1lZGlhUGx1c0FwaSkgewogICAgICBpZiAoY29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UuYmxvY2tTZXRWb2x1bWUnKSA9PT0gdHJ1ZSkgewogICAgICAgIC8vIOWmguaenOmFjee9ruS6huimgemUgeatu+WklumDqOWvuXZvbHVlbeeahOaTjeS9nO+8jOWImeebtOaOpee7meS4gOS4qui2heWkp+eahOWAvAogICAgICAgIHRpbWVvdXQgPSAxMDAwICogNjAgKiA2MCAqIDI0ICogMzY1OwogICAgICB9CgogICAgICB0aGlzLm1lZGlhUGx1c0FwaS5sb2NrVm9sdW1lKHRpbWVvdXQpOwogICAgICByZXR1cm4gdHJ1ZQogICAgfQoKICAgIHRoaXMudm9sdW1lSW5mby5sb2NrVGltZW91dCA9IERhdGUubm93KCkgKyB0aW1lb3V0OwogIH0sCgogIHVuTG9ja1ZvbHVtZTogZnVuY3Rpb24gKCkgewogICAgaWYgKHRoaXMubWVkaWFQbHVzQXBpKSB7CiAgICAgIHRoaXMubWVkaWFQbHVzQXBpLnVuTG9ja1ZvbHVtZSgpOwogICAgICByZXR1cm4gdHJ1ZQogICAgfQoKICAgIHRoaXMudm9sdW1lSW5mby5sb2NrVGltZW91dCA9IERhdGUubm93KCkgLSAxOwogIH0sCgogIGlzTG9ja1ZvbHVtZTogZnVuY3Rpb24gKCkgewogICAgaWYgKHRoaXMubWVkaWFQbHVzQXBpKSB7CiAgICAgIHJldHVybiB0aGlzLm1lZGlhUGx1c0FwaS5pc0xvY2tWb2x1bWUoKQogICAgfQoKICAgIHJldHVybiBEYXRlLm5vdygpIC0gdGhpcy52b2x1bWVJbmZvLmxvY2tUaW1lb3V0IDwgMAogIH0sCgogIC8qIOiuvue9ruWjsOmfs+Wkp+WwjyAqLwogIHNldFZvbHVtZTogZnVuY3Rpb24gKG51bSwgbm90aXBzLCBvdXRlckNhbGwpIHsKICAgIGNvbnN0IHQgPSB0aGlzOwogICAgY29uc3QgcGxheWVyID0gdC5wbGF5ZXIoKTsKCiAgICBpZiAodC5pc0xvY2tWb2x1bWUoKSkgewogICAgICByZXR1cm4gZmFsc2UKICAgIH0KCiAgICBpZiAoIW51bSAmJiBudW0gIT09IDApIHsKICAgICAgbnVtID0gdC5nZXRWb2x1bWUoKTsKICAgIH0KCiAgICBudW0gPSBOdW1iZXIobnVtKS50b0ZpeGVkKDIpOwogICAgaWYgKG51bSA8IDApIHsKICAgICAgbnVtID0gMDsKICAgIH0KCiAgICBpZiAobnVtID4gMSAmJiBjb25maWdNYW5hZ2VyLmdldCgnZW5oYW5jZS5hbGxvd0Fjb3VzdGljR2FpbicpKSB7CiAgICAgIG51bSA9IE1hdGguY2VpbChudW0pOwoKICAgICAgdHJ5IHsKICAgICAgICBwbGF5ZXIuX2FtcF8gPSBwbGF5ZXIuX2FtcF8gfHwgbmV3IE1lZGlhRWxlbWVudEFtcGxpZmllcihwbGF5ZXIpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgbnVtID0gMTsKICAgICAgICBkZWJ1Zy5lcnJvcign5aqS5L2T5aOw6Z+z5ZON5bqm5aKe55uK6YC76L6R5byC5bi4JywgZSk7CiAgICAgIH0KCiAgICAgIC8qIOmZkOWumuWinuebiueahOacgOWkp+WAvCAqLwogICAgICBpZiAobnVtID4gNikgewogICAgICAgIG51bSA9IDY7CiAgICAgIH0KCiAgICAgIGlmICghcGxheWVyLl9hbXBfIHx8ICFwbGF5ZXIuX2FtcF8uc2V0TG91ZG5lc3MpIHsKICAgICAgICBudW0gPSAxOwogICAgICB9CiAgICB9IGVsc2UgaWYgKG51bSA+IDEpIHsKICAgICAgbnVtID0gMTsKICAgIH0KCiAgICAvKiDorrDlvZXmkq3mlL7pn7Pph4/kv6Hmga8gKi8KICAgIHQudm9sdW1lID0gbnVtOwoKICAgIC8qIOS9v+eUqOmfs+mHj+WinuebiumAu+i+ke+8jOWinuebiumfs+mHj+S4jei/m+ihjOacrOWcsOWtmOWCqOiusOW9lSAqLwogICAgaWYgKG51bSA+IDEgJiYgcGxheWVyLl9hbXBfICYmIHBsYXllci5fYW1wXy5zZXRMb3VkbmVzcykgewogICAgICBwbGF5ZXIuX2FtcF8uc2V0TG91ZG5lc3MobnVtKTsKCiAgICAgIGlmICghb3V0ZXJDYWxsKSB7IHBsYXllci5tdXRlZCA9IGZhbHNlOyB9CgogICAgICAhbm90aXBzICYmIHQudGlwcyhpMThuLnQoJ3RpcHNNc2cudm9sdW1lJykgKyBwYXJzZUludChudW0gKiAxMDApICsgJyUnKTsKICAgICAgcmV0dXJuIHRydWUKICAgIH0KCiAgICBpZiAoaXNJbklmcmFtZSgpIHx8IGNvbmZpZ01hbmFnZXIuZ2V0KCdlbmhhbmNlLmJsb2NrU2V0Vm9sdW1lJykgPT09IHRydWUpIHsKICAgICAgY29uZmlnTWFuYWdlci5zZXRHbG9iYWxTdG9yYWdlKCdtZWRpYS52b2x1bWUnLCBudW0pOwogICAgfSBlbHNlIHsKICAgICAgY29uZmlnTWFuYWdlci5zZXRMb2NhbFN0b3JhZ2UoJ21lZGlhLnZvbHVtZScsIG51bSk7CiAgICB9CgogICAgaWYgKHQubWVkaWFQbHVzQXBpKSB7CiAgICAgIHQubWVkaWFQbHVzQXBpLnNldFZvbHVtZShudW0pOwoKICAgICAgLyog5bCG5pKt5pS+6Z+z6YeP5ZCM5q2l5Yiw5YWo6YOo5aqS5L2T5YWD57SgICovCiAgICAgIGNvbnN0IG1lZGlhTGlzdCA9IHQuZ2V0UGxheWVyTGlzdCgpOwogICAgICBtZWRpYUxpc3QuZm9yRWFjaChtZWRpYSA9PiB7CiAgICAgICAgaWYgKG1lZGlhICE9PSBwbGF5ZXIpIHsKICAgICAgICAgIGNvbnN0IG1lZGlhUGx1c0FwaSA9IG1lZGlhQ29yZS5tZWRpYVBsdXMobWVkaWEpOwogICAgICAgICAgbWVkaWFQbHVzQXBpICYmIG1lZGlhUGx1c0FwaS5zZXRWb2x1bWUobnVtKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgZGVsZXRlIHBsYXllci52b2x1bWU7CiAgICAgIHBsYXllci52b2x1bWUgPSBudW07CiAgICAgIHQudm9sdW1lSW5mby50aW1lID0gRGF0ZS5ub3coKTsKICAgICAgdC52b2x1bWVJbmZvLnZhbHVlID0gbnVtOwoKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCB2b2x1bWVEZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihIVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSwgJ3ZvbHVtZScpOwogICAgICAgIG9yaWdpbmFsTWV0aG9kcy5PYmplY3QuZGVmaW5lUHJvcGVydHkuY2FsbChPYmplY3QsIHBsYXllciwgJ3ZvbHVtZScsIHsKICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gdm9sdW1lRGVzY3JpcHRvci5nZXQuYXBwbHkocGxheWVyLCBhcmd1bWVudHMpCiAgICAgICAgICB9LAogICAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsICE9PSAnbnVtYmVyJyB8fCB2YWwgPCAwKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChUQ0MuZG9UYXNrKCdibG9ja1NldFZvbHVtZScpIHx8IGNvbmZpZ01hbmFnZXIuZ2V0KCdlbmhhbmNlLmJsb2NrU2V0Vm9sdW1lJykgPT09IHRydWUpIHsKICAgICAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0LnNldFZvbHVtZSh2YWwsIGZhbHNlLCB0cnVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgZGVidWcuZXJyb3IoJ+ino+mUgXZvbHVtZeWksei0pScsIGUpOwogICAgICB9CiAgICB9CgogICAgLyog6LCD6IqC6Z+z6YeP55qE5pe25YCZ6aG65L6/5oqK6Z2Z6Z+z5qih5byP5YWz6ZetICovCiAgICBpZiAoIW91dGVyQ2FsbCkgeyBwbGF5ZXIubXV0ZWQgPSBmYWxzZTsgfQoKICAgICFub3RpcHMgJiYgdC50aXBzKGkxOG4udCgndGlwc01zZy52b2x1bWUnKSArIHBhcnNlSW50KHBsYXllci52b2x1bWUgKiAxMDApICsgJyUnKTsKICB9LAoKICBzZXRWb2x1bWVVcCAobnVtKSB7CiAgICBudW0gPSBudW1VcChudW0pIHx8IDAuMjsKICAgIGNvbnN0IHBsYXllciA9IHRoaXMucGxheWVyKCk7CiAgICBpZiAocGxheWVyKSB7CiAgICAgIHRoaXMudW5Mb2NrVm9sdW1lKCk7CgogICAgICBpZiAodGhpcy52b2x1bWUgPiAxICYmIHBsYXllci5fYW1wXykgewogICAgICAgIHRoaXMuc2V0Vm9sdW1lKHRoaXMudm9sdW1lICsgbnVtKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNldFZvbHVtZShwbGF5ZXIudm9sdW1lICsgbnVtKTsKICAgICAgfQoKICAgICAgLyog6Ziy5q2i5aSW6YOo6LCD6Z+z6YC76L6R55qE5bmy5omw77yM5omA5Lul6ZSB5a6a5LiA5q615pe26Ze0ICovCiAgICAgIHRoaXMubG9ja1ZvbHVtZSg1MDApOwogICAgfQogIH0sCgogIHNldFZvbHVtZURvd24gKG51bSkgewogICAgbnVtID0gbnVtRG93bihudW0pIHx8IC0wLjI7CiAgICBjb25zdCBwbGF5ZXIgPSB0aGlzLnBsYXllcigpOwogICAgaWYgKHBsYXllcikgewogICAgICB0aGlzLnVuTG9ja1ZvbHVtZSgpOwoKICAgICAgaWYgKHRoaXMudm9sdW1lID4gMSAmJiBwbGF5ZXIuX2FtcF8pIHsKICAgICAgICB0aGlzLnNldFZvbHVtZShNYXRoLmZsb29yKHRoaXMudm9sdW1lICsgbnVtKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5zZXRWb2x1bWUocGxheWVyLnZvbHVtZSArIG51bSk7CiAgICAgIH0KCiAgICAgIC8qIOmYsuatouWklumDqOiwg+mfs+mAu+i+keeahOW5suaJsO+8jOaJgOS7pemUgeWumuS4gOauteaXtumXtCAqLwogICAgICB0aGlzLmxvY2tWb2x1bWUoNTAwKTsKICAgIH0KICB9LAoKICAvKiDph4fpm4ZUcmFuc2Zvcm3lgLznmoTljoblj7Llj5jmm7TorrDlvZXvvIzku6Xkvr/lkI7nu63ov5vooYzov5jljp8gKi8KICBjb2xsZWN0VHJhbnNmb3JtSGlzdG9yeUluZm8gKCkgewogICAgY29uc3QgdCA9IHRoaXM7CiAgICBPYmplY3Qua2V5cyh0LmRlZmF1bHRUcmFuc2Zvcm0pLmZvckVhY2goa2V5ID0+IHsKICAgICAgaWYgKGtleSA9PT0gJ3RyYW5zbGF0ZScpIHsKICAgICAgICBjb25zdCB0cmFuc2xhdGUgPSB0LmRlZmF1bHRUcmFuc2Zvcm0udHJhbnNsYXRlOwogICAgICAgIHQuaGlzdG9yeVRyYW5zZm9ybS50cmFuc2xhdGUgPSB0Lmhpc3RvcnlUcmFuc2Zvcm0udHJhbnNsYXRlIHx8IHt9OwogICAgICAgIE9iamVjdC5rZXlzKHRyYW5zbGF0ZSkuZm9yRWFjaChzdWJLZXkgPT4gewogICAgICAgICAgaWYgKE51bWJlcih0LnRyYW5zbGF0ZVtzdWJLZXldKSAhPT0gdC5kZWZhdWx0VHJhbnNmb3JtLnRyYW5zbGF0ZVtzdWJLZXldKSB7CiAgICAgICAgICAgIHQuaGlzdG9yeVRyYW5zZm9ybS50cmFuc2xhdGVbc3ViS2V5XSA9IHQudHJhbnNsYXRlW3N1YktleV07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKE51bWJlcih0W2tleV0pICE9PSB0LmRlZmF1bHRUcmFuc2Zvcm1ba2V5XSkgewogICAgICAgICAgdC5oaXN0b3J5VHJhbnNmb3JtW2tleV0gPSB0W2tleV07CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICB9LAoKICAvKiDliKTmlq1oNVBsYXllcuS4i+eahFRyYW5zZm9ybeWAvOaYr+WQpui3n+m7mOiupOeahFRyYW5zZm9ybeWAvOS4gOiHtCAqLwogIGlzU2FtZUFzRGVmYXVsdFRyYW5zZm9ybSAoKSB7CiAgICBsZXQgcmVzdWx0ID0gdHJ1ZTsKICAgIGNvbnN0IHQgPSB0aGlzOwogICAgT2JqZWN0LmtleXModC5kZWZhdWx0VHJhbnNmb3JtKS5mb3JFYWNoKGtleSA9PiB7CiAgICAgIGlmIChpc09iaiQxKHQuZGVmYXVsdFRyYW5zZm9ybVtrZXldKSkgewogICAgICAgIE9iamVjdC5rZXlzKHQuZGVmYXVsdFRyYW5zZm9ybVtrZXldKS5mb3JFYWNoKHN1YktleSA9PiB7CiAgICAgICAgICBpZiAoTnVtYmVyKHRba2V5XVtzdWJLZXldKSAhPT0gdC5kZWZhdWx0VHJhbnNmb3JtW2tleV1bc3ViS2V5XSkgewogICAgICAgICAgICByZXN1bHQgPSBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoTnVtYmVyKHRba2V5XSkgIT09IHQuZGVmYXVsdFRyYW5zZm9ybVtrZXldKSB7CiAgICAgICAgICByZXN1bHQgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogICAgcmV0dXJuIHJlc3VsdAogIH0sCgogIC8qIOiuvue9ruinhumikeeUu+mdoueahOe8qeaUvuS4juS9jeenuyAqLwogIHNldFRyYW5zZm9ybSAobm90VGlwcykgewogICAgY29uc3QgdCA9IHRoaXM7CiAgICBjb25zdCBwbGF5ZXIgPSB0LnBsYXllcigpOwogICAgY29uc3Qgc2NhbGUgPSB0LnNjYWxlID0gTnVtYmVyKHQuc2NhbGUpLnRvRml4ZWQoMik7CiAgICBjb25zdCB0cmFuc2xhdGUgPSB0LnRyYW5zbGF0ZTsKCiAgICBjb25zdCBtaXJyb3IgPSB0LnJvdGF0ZVggPT09IDE4MCA/IGByb3RhdGVYKCR7dC5yb3RhdGVYfWRlZylgIDogKHQucm90YXRlWSA9PT0gMTgwID8gYHJvdGF0ZVkoJHt0LnJvdGF0ZVl9ZGVnKWAgOiAnJyk7CiAgICBwbGF5ZXIuc3R5bGUudHJhbnNmb3JtID0gYHNjYWxlKCR7c2NhbGV9KSB0cmFuc2xhdGUoJHt0cmFuc2xhdGUueH1weCwgJHt0cmFuc2xhdGUueX1weCkgcm90YXRlKCR7dC5yb3RhdGV9ZGVnKSAke21pcnJvcn1gOwoKICAgIGxldCB0aXBzTXNnID0gaTE4bi50KCd0aXBzTXNnLnZpZGVvem9vbScpICsgYCR7KHNjYWxlICogMTAwKS50b0ZpeGVkKDApfSVgOwogICAgaWYgKHRyYW5zbGF0ZS54KSB7CiAgICAgIHRpcHNNc2cgKz0gYCAke2kxOG4udCgndGlwc01zZy5ob3Jpem9udGFsJyl9JHt0LnRyYW5zbGF0ZS54fXB4YDsKICAgIH0KICAgIGlmICh0cmFuc2xhdGUueSkgewogICAgICB0aXBzTXNnICs9IGAgJHtpMThuLnQoJ3RpcHNNc2cudmVydGljYWwnKX0ke3QudHJhbnNsYXRlLnl9cHhgOwogICAgfQoKICAgIGlmIChub3RUaXBzID09PSB0cnVlKSA7IGVsc2UgewogICAgICB0LmNvbGxlY3RUcmFuc2Zvcm1IaXN0b3J5SW5mbygpOwogICAgICB0LnRpcHModGlwc01zZyk7CiAgICB9CgogICAgLyog5aeL57uI5L+d5oyBdHJhbnNmb3Jt5qC35byP55qE5q2j5bi4ICovCiAgICBpZiAoIXQuX3RyYW5zZm9ybVN0YXRlR3VhcmRfKSB7CiAgICAgIHQuX3RyYW5zZm9ybVN0YXRlR3VhcmRfID0gc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgIHQuc2V0VHJhbnNmb3JtKHRydWUpOwogICAgICB9LCAzMDApOwogICAgfQogIH0sCgogIC8qIOinhumikeeUu+mdouaXi+i9rCA5MCDluqYgKi8KICBzZXRSb3RhdGUgKCkgewogICAgY29uc3QgdCA9IHRoaXM7CiAgICB0LnJvdGF0ZSArPSA5MDsKICAgIGlmICh0LnJvdGF0ZSAlIDM2MCA9PT0gMCkgdC5yb3RhdGUgPSAwOwogICAgdC5zZXRUcmFuc2Zvcm0odHJ1ZSk7CiAgICB0LnRpcHMoaTE4bi50KCd0aXBzTXNnLmltZ3JvdGF0ZScpICsgdC5yb3RhdGUgKyAnwrAnKTsKICB9LAoKICAvKiDorr7nva7plZzlg4/nv7vovawgKi8KICBzZXRNaXJyb3IgKHZlcnRpY2FsID0gZmFsc2UpIHsKICAgIGNvbnN0IHQgPSB0aGlzOwogICAgbGV0IHRpcHNNc2cgPSAnJzsKICAgIGlmICh2ZXJ0aWNhbCkgewogICAgICB0LnJvdGF0ZVggPSB0LnJvdGF0ZVggPT09IDAgPyAxODAgOiAwOwogICAgICB0aXBzTXNnICs9IGAgJHtpMThuLnQoJ3RpcHNNc2cudmVydGljYWxNaXJyb3InKX0gJHt0LnJvdGF0ZVh9ZGVnYDsKICAgIH0gZWxzZSB7CiAgICAgIHQucm90YXRlWSA9IHQucm90YXRlWSA9PT0gMCA/IDE4MCA6IDA7CiAgICAgIHRpcHNNc2cgKz0gYCAke2kxOG4udCgndGlwc01zZy5ob3Jpem9udGFsTWlycm9yJyl9ICR7dC5yb3RhdGVZfWRlZ2A7CiAgICB9CgogICAgdC5zZXRUcmFuc2Zvcm0odHJ1ZSk7CiAgICB0LnRpcHModGlwc01zZyk7CiAgfSwKCiAgLyog57yp5pS+6KeG6aKR55S76Z2iICovCiAgc2V0U2NhbGUgKG51bSkgewogICAgaWYgKE51bWJlci5pc05hTih0aGlzLnNjYWxlKSB8fCBOdW1iZXIuaXNOYU4obnVtKSkgewogICAgICB0aGlzLnNjYWxlID0gMTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuc2NhbGUgPSBudW07CiAgICB9CgogICAgdGhpcy5zZXRUcmFuc2Zvcm0oKTsKICB9LAoKICAvKiDop4bpopHmlL7lpKcgKzAuMSAqLwogIHNldFNjYWxlVXAgKG51bSkgewogICAgbnVtID0gbnVtVXAobnVtKSB8fCAwLjA1OwogICAgdGhpcy5zZXRTY2FsZShOdW1iZXIodGhpcy5zY2FsZSkgKyBudW0pOwogIH0sCgogIC8qIOinhumikee8qeWwjyAtMC4xICovCiAgc2V0U2NhbGVEb3duIChudW0pIHsKICAgIG51bSA9IG51bURvd24obnVtKSB8fCAtMC4wNTsKICAgIHRoaXMuc2V0U2NhbGUoTnVtYmVyKHRoaXMuc2NhbGUpICsgbnVtKTsKICB9LAoKICAvKiDorr7nva7op4bpopHnlLvpnaLnmoTkvY3np7vlsZ7mgKcgKi8KICBzZXRUcmFuc2xhdGUgKHgsIHkpIHsKICAgIGlmICh0eXBlb2YgeCA9PT0gJ251bWJlcicpIHsKICAgICAgdGhpcy50cmFuc2xhdGUueCA9IHg7CiAgICB9CgogICAgaWYgKHR5cGVvZiB5ID09PSAnbnVtYmVyJykgewogICAgICB0aGlzLnRyYW5zbGF0ZS55ID0geTsKICAgIH0KCiAgICB0aGlzLnNldFRyYW5zZm9ybSgpOwogIH0sCgogIC8qIOinhumikeeUu+mdouWQkeWPs+W5s+enuyAqLwogIHNldFRyYW5zbGF0ZVJpZ2h0IChudW0pIHsKICAgIG51bSA9IG51bVVwKG51bSkgfHwgMTA7CiAgICB0aGlzLnNldFRyYW5zbGF0ZSh0aGlzLnRyYW5zbGF0ZS54ICsgbnVtKTsKICB9LAoKICAvKiDop4bpopHnlLvpnaLlkJHlt6blubPnp7sgKi8KICBzZXRUcmFuc2xhdGVMZWZ0IChudW0pIHsKICAgIG51bSA9IG51bURvd24obnVtKSB8fCAtMTA7CiAgICB0aGlzLnNldFRyYW5zbGF0ZSh0aGlzLnRyYW5zbGF0ZS54ICsgbnVtKTsKICB9LAoKICAvKiDop4bpopHnlLvpnaLlkJHkuIrlubPnp7sgKi8KICBzZXRUcmFuc2xhdGVVcCAobnVtKSB7CiAgICBudW0gPSBudW1VcChudW0pIHx8IDEwOwogICAgdGhpcy5zZXRUcmFuc2xhdGUobnVsbCwgdGhpcy50cmFuc2xhdGUueSAtIG51bSk7CiAgfSwKCiAgLyog6KeG6aKR55S76Z2i5ZCR5LiL5bmz56e7ICovCiAgc2V0VHJhbnNsYXRlRG93biAobnVtKSB7CiAgICBudW0gPSBudW1Eb3duKG51bSkgfHwgLTEwOwogICAgdGhpcy5zZXRUcmFuc2xhdGUobnVsbCwgdGhpcy50cmFuc2xhdGUueSAtIG51bSk7CiAgfSwKCiAgcmVzZXRUcmFuc2Zvcm0gKG5vdFRpcHMpIHsKICAgIGNvbnN0IHQgPSB0aGlzOwoKICAgIGlmICh0LmlzU2FtZUFzRGVmYXVsdFRyYW5zZm9ybSgpICYmIE9iamVjdC5rZXlzKHQuaGlzdG9yeVRyYW5zZm9ybSkubGVuZ3RoKSB7CiAgICAgIC8qIOi/mOWOn+aIkOWOhuWPsuiusOW9leS4reeahFRyYW5zZm9ybeWAvCAqLwogICAgICBPYmplY3Qua2V5cyh0Lmhpc3RvcnlUcmFuc2Zvcm0pLmZvckVhY2goa2V5ID0+IHsKICAgICAgICBpZiAoaXNPYmokMSh0Lmhpc3RvcnlUcmFuc2Zvcm1ba2V5XSkpIHsKICAgICAgICAgIE9iamVjdC5rZXlzKHQuaGlzdG9yeVRyYW5zZm9ybVtrZXldKS5mb3JFYWNoKHN1YktleSA9PiB7CiAgICAgICAgICAgIHRba2V5XVtzdWJLZXldID0gdC5oaXN0b3J5VHJhbnNmb3JtW2tleV1bc3ViS2V5XTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0W2tleV0gPSB0Lmhpc3RvcnlUcmFuc2Zvcm1ba2V5XTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgLyog6L+Y5Y6f5oiQ6buY6K6k55qEVHJhbnNmb3Jt5YC8ICovCiAgICAgIGNvbnN0IGRlZmF1bHRUcmFuc2Zvcm0gPSBjbG9uZSh0LmRlZmF1bHRUcmFuc2Zvcm0pOwogICAgICBPYmplY3Qua2V5cyhkZWZhdWx0VHJhbnNmb3JtKS5mb3JFYWNoKGtleSA9PiB7CiAgICAgICAgdFtrZXldID0gZGVmYXVsdFRyYW5zZm9ybVtrZXldOwogICAgICB9KTsKICAgIH0KCiAgICB0LnNldFRyYW5zZm9ybShub3RUaXBzKTsKICB9LAoKICAvKioKICAgKiDlrprmoLzluKfnlLvpnaIKICAgKiBAcGFyYW0gcGVyRnBzIHtOdW1iZXJ9IC3lj6/pgIkg6buY6K6kIDHvvIzljbPlrprmoLzliLDkuIvkuIDluKfvvIzlpoLmnpzmmK8tMeWImeS4uuWumuagvOWIsOS4iuS4gOW4pwogICAqLwogIGZyZWV6ZUZyYW1lIChwZXJGcHMpIHsKICAgIHBlckZwcyA9IHBlckZwcyB8fCAxOwogICAgY29uc3QgdCA9IHRoaXM7CiAgICBjb25zdCBwbGF5ZXIgPSB0LnBsYXllcigpOwoKICAgIC8qIOi3s+W4pyAqLwogICAgcGxheWVyLmN1cnJlbnRUaW1lICs9IE51bWJlcihwZXJGcHMgLyB0LmZwcyk7CgogICAgLyog5a6a5qC855S76Z2iICovCiAgICBpZiAoIXBsYXllci5wYXVzZWQpIHBsYXllci5wYXVzZSgpOwoKICAgIC8qIOacieS6m+aSreaUvuWZqOWPkeeOsOeUu+mdouaJgOWcqOS9jee9ruWPmOS6huS8muiHquWKqOi/m+ihjOaSreaUvu+8jOaJgOS7peatpOaXtumcgOimgeWvueaSreaUvuaTjeS9nOi/m+ihjOaMgui1tyAqLwogICAgcGxheWVyLl9oYW5nVXBfICYmIHBsYXllci5faGFuZ1VwXygncGxheScsIDQwMCk7CgogICAgaWYgKHBlckZwcyA9PT0gMSkgewogICAgICB0LnRpcHMoaTE4bi50KCd0aXBzTXNnLm5leHRmcmFtZScpKTsKICAgIH0gZWxzZSBpZiAocGVyRnBzID09PSAtMSkgewogICAgICB0LnRpcHMoaTE4bi50KCd0aXBzTXNnLnByZXZpb3VzZnJhbWUnKSk7CiAgICB9IGVsc2UgewogICAgICB0LnRpcHMoaTE4bi50KCd0aXBzTXNnLnN0b3BmcmFtZScpICsgcGVyRnBzKTsKICAgIH0KICB9LAoKICBhdXRvR290b0J1ZmZlcmVkVGltZTogZmFsc2UsCiAgdG9nZ2xlQXV0b0dvdG9CdWZmZXJlZFRpbWUgKCkgewogICAgY29uc3QgdCA9IHRoaXM7CiAgICB0LmF1dG9Hb3RvQnVmZmVyZWRUaW1lID0gIXQuYXV0b0dvdG9CdWZmZXJlZFRpbWU7CiAgICB0LnRpcHModC5hdXRvR290b0J1ZmZlcmVkVGltZSA/IGkxOG4udCgnYXV0b0dvdG9CdWZmZXJlZFRpbWUnKSA6IGkxOG4udCgnZGlzYWJsZUF1dG9Hb3RvQnVmZmVyZWRUaW1lJykpOwogIH0sCgogIC8qKgogICAqIOWIh+aNoueUu+S4reeUu+WKn+iDvQogICAqLwogIHRvZ2dsZVBpY3R1cmVJblBpY3R1cmUgKCkgewogICAgY29uc3QgcGxheWVyID0gdGhpcy5wbGF5ZXIoKTsKICAgIGlmICh3aW5kb3cuX2lzUGljdHVyZUluUGljdHVyZV8gJiYgZG9jdW1lbnQucGljdHVyZUluUGljdHVyZUVsZW1lbnQpIHsKICAgICAgZG9jdW1lbnQuZXhpdFBpY3R1cmVJblBpY3R1cmUoKS50aGVuKCgpID0+IHsKICAgICAgICB3aW5kb3cuX2lzUGljdHVyZUluUGljdHVyZV8gPSBudWxsOwogICAgICB9KS5jYXRjaCgoZSkgPT4gewogICAgICAgIHdpbmRvdy5faXNQaWN0dXJlSW5QaWN0dXJlXyA9IG51bGw7CiAgICAgICAgZGVidWcuZXJyb3IoJ1t0b2dnbGVQaWN0dXJlSW5QaWN0dXJlXScsIGUpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIHBsYXllci5yZXF1ZXN0UGljdHVyZUluUGljdHVyZSAmJiBwbGF5ZXIucmVxdWVzdFBpY3R1cmVJblBpY3R1cmUoKS50aGVuKCgpID0+IHsKICAgICAgICB3aW5kb3cuX2lzUGljdHVyZUluUGljdHVyZV8gPSB0cnVlOwogICAgICB9KS5jYXRjaCgoZSkgPT4gewogICAgICAgIHdpbmRvdy5faXNQaWN0dXJlSW5QaWN0dXJlXyA9IG51bGw7CiAgICAgICAgZGVidWcuZXJyb3IoJ1t0b2dnbGVQaWN0dXJlSW5QaWN0dXJlXScsIGUpOwogICAgICB9KTsKICAgIH0KICB9LAoKICAvKiDmkq3mlL7kuIvkuIDkuKrop4bpopHvvIzpu5jorqTmmK/msqHmnInov5nkuKrlip/og73nmoTvvIzlj6rmnInlnKhUQ0Pph4zphY3nva7kuoZuZXh05a2X5q615omN5Lya5pyJ6K+l5Yqf6IO9ICovCiAgc2V0TmV4dFZpZGVvICgpIHsKICAgIGNvbnN0IGlzRG8gPSBUQ0MuZG9UYXNrKCduZXh0Jyk7CiAgICBpZiAoIWlzRG8pIHsKICAgICAgZGVidWcubG9nKCflvZPliY3nvZHpobXkuI3mlK/mjIHkuIDplK7mkq3mlL7kuIvkuKrop4bpopHlip/og71+Jyk7CiAgICB9CiAgfSwKCiAgLyog5YiH5o2i5pKt5pS+54q25oCBICovCiAgc3dpdGNoUGxheVN0YXR1cyAoKSB7CiAgICBjb25zdCB0ID0gdGhpczsKICAgIGNvbnN0IHBsYXllciA9IHQucGxheWVyKCk7CgogICAgaWYgKFRDQy5kb1Rhc2soJ3N3aXRjaFBsYXlTdGF0dXMnKSkgewogICAgICAvLyBkZWJ1Zy5sb2coJ1tUQ0NdW3N3aXRjaFBsYXlTdGF0dXNdJywgJ3N1YycpCiAgICAgIHJldHVybgogICAgfQoKICAgIGlmIChwbGF5ZXIucGF1c2VkKSB7CiAgICAgIGlmIChUQ0MuZG9UYXNrKCdwbGF5JykpIDsgZWxzZSB7CiAgICAgICAgaWYgKHQubWVkaWFQbHVzQXBpKSB7CiAgICAgICAgICB0Lm1lZGlhUGx1c0FwaS5sb2NrUGF1c2UoNDAwKTsKICAgICAgICAgIHQubWVkaWFQbHVzQXBpLmFwcGx5UGxheSgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvKiDmjILotbflhbblroPpgLvovpHnmoTmmoLlgZzmk43kvZzvvIznoa7kv53mkq3mlL7nirbmgIHnlJ/mlYggKi8KICAgICAgICAgIGlmIChwbGF5ZXIuX2hhbmdVcF8gaW5zdGFuY2VvZiBGdW5jdGlvbikgewogICAgICAgICAgICBwbGF5ZXIuX2hhbmdVcF8oJ3BhdXNlJywgNDAwKTsKICAgICAgICAgICAgcGxheWVyLl91bkhhbmdVcF8oJ3BsYXknKTsKICAgICAgICAgIH0KCiAgICAgICAgICBwbGF5ZXIucGxheSgpOwogICAgICAgIH0KCiAgICAgICAgdC50aXBzKGkxOG4udCgndGlwc01zZy5wbGF5JykpOwogICAgICB9CgogICAgICBUQ0MuZG9UYXNrKCdhZnRlclBsYXknKTsKICAgIH0gZWxzZSB7CiAgICAgIGlmIChUQ0MuZG9UYXNrKCdwYXVzZScpKSA7IGVsc2UgewogICAgICAgIGlmICh0Lm1lZGlhUGx1c0FwaSkgewogICAgICAgICAgdC5tZWRpYVBsdXNBcGkubG9ja1BsYXkoNDAwKTsKICAgICAgICAgIHQubWVkaWFQbHVzQXBpLmFwcGx5UGF1c2UoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLyog5oyC6LW35YW25a6D6YC76L6R55qE5pKt5pS+5pON5L2c77yM56Gu5L+d5pqC5YGc54q25oCB55Sf5pWIICovCiAgICAgICAgICBpZiAocGxheWVyLl9oYW5nVXBfIGluc3RhbmNlb2YgRnVuY3Rpb24pIHsKICAgICAgICAgICAgcGxheWVyLl9oYW5nVXBfKCdwbGF5JywgNDAwKTsKICAgICAgICAgICAgcGxheWVyLl91bkhhbmdVcF8oJ3BhdXNlJyk7CiAgICAgICAgICB9CgogICAgICAgICAgcGxheWVyLnBhdXNlKCk7CiAgICAgICAgfQoKICAgICAgICB0LnRpcHMoaTE4bi50KCd0aXBzTXNnLnBhdXNlJykpOwogICAgICB9CgogICAgICBUQ0MuZG9UYXNrKCdhZnRlclBhdXNlJyk7CiAgICB9CiAgfSwKCiAgaXNBbGxvd1Jlc3RvcmVQbGF5UHJvZ3Jlc3M6IGZ1bmN0aW9uICgpIHsKICAgIGNvbnN0IGFsbG93UmVzdG9yZVZhbCA9IGNvbmZpZ01hbmFnZXIuZ2V0KGBtZWRpYS5hbGxvd1Jlc3RvcmVQbGF5UHJvZ3Jlc3MuJHt3aW5kb3cubG9jYXRpb24uaG9zdH1gKTsKICAgIHJldHVybiBhbGxvd1Jlc3RvcmVWYWwgPT09IG51bGwgfHwgYWxsb3dSZXN0b3JlVmFsCiAgfSwKICAvKiDliIfmjaLoh6rliqjmgaLlpI3mkq3mlL7ov5vluqbnmoTnirbmgIEgKi8KICBzd2l0Y2hSZXN0b3JlUGxheVByb2dyZXNzU3RhdHVzOiBmdW5jdGlvbiAoKSB7CiAgICBjb25zdCB0ID0gaDVQbGF5ZXI7CiAgICBsZXQgaXNBbGxvd1Jlc3RvcmVQbGF5UHJvZ3Jlc3MgPSB0LmlzQWxsb3dSZXN0b3JlUGxheVByb2dyZXNzKCk7CgogICAgaWYgKGlzSW5Dcm9zc09yaWdpbkZyYW1lKCkpIHsKICAgICAgaXNBbGxvd1Jlc3RvcmVQbGF5UHJvZ3Jlc3MgPSBmYWxzZTsKICAgIH0gZWxzZSB7CiAgICAgIC8qIOi/m+ihjOWAvOWPjei9rCAqLwogICAgICBpc0FsbG93UmVzdG9yZVBsYXlQcm9ncmVzcyA9ICFpc0FsbG93UmVzdG9yZVBsYXlQcm9ncmVzczsKICAgIH0KCiAgICBjb25maWdNYW5hZ2VyLnNldChgbWVkaWEuYWxsb3dSZXN0b3JlUGxheVByb2dyZXNzLiR7d2luZG93LmxvY2F0aW9uLmhvc3R9YCwgaXNBbGxvd1Jlc3RvcmVQbGF5UHJvZ3Jlc3MpOwoKICAgIC8qIOaTjeS9nOaPkOekuiAqLwogICAgaWYgKGlzQWxsb3dSZXN0b3JlUGxheVByb2dyZXNzKSB7CiAgICAgIHQudGlwcyhpMThuLnQoJ3RpcHNNc2cuYXJwbCcpKTsKICAgICAgdC5zZXRQbGF5UHJvZ3Jlc3ModC5wbGF5ZXIoKSk7CiAgICB9IGVsc2UgewogICAgICB0LnRpcHMoaTE4bi50KCd0aXBzTXNnLmRycGwnKSk7CiAgICB9CiAgfSwKICB0aXBzQ2xhc3NOYW1lOiAnaHRtbF9wbGF5ZXJfZW5oYW5jZV90aXBzJywKCiAgZ2V0VGlwc0NvbnRhaW5lcjogZnVuY3Rpb24gKHZpZGVvRWwpIHsKICAgIGNvbnN0IHQgPSBoNVBsYXllcjsKICAgIGNvbnN0IHBsYXllciA9IHZpZGVvRWwgfHwgdC5wbGF5ZXIoKTsKICAgIC8vIOS9v+eUqGdldENvbnRhaW5lcuiOt+WPluWIsOeahOeItuiKgueCueW8iuerr+WkquWkmu+8jOaaguaXtuW8g+eUqAogICAgLy8gY29uc3QgX3Rpc3BDb250YWluZXJfID0gcGxheWVyLl90aXNwQ29udGFpbmVyXyAgfHwgIGdldENvbnRhaW5lcihwbGF5ZXIpOwoKICAgIGxldCB0aXNwQ29udGFpbmVyID0gcGxheWVyLnBhcmVudE5vZGUgfHwgcGxheWVyOwoKICAgIC8qIOWmguaenOeItuiKgueCueS4uuaXoOmVv+WuveeahOWFg+e0oO+8jOWImeWGjeW+gOS4iuafpeaJvuS4gOe6pyAqLwogICAgY29uc3QgY29udGFpbmVyQm94ID0gdGlzcENvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIGlmICgoIWNvbnRhaW5lckJveC53aWR0aCB8fCAhY29udGFpbmVyQm94LmhlaWdodCkgJiYgdGlzcENvbnRhaW5lci5wYXJlbnROb2RlKSB7CiAgICAgIHRpc3BDb250YWluZXIgPSB0aXNwQ29udGFpbmVyLnBhcmVudE5vZGU7CiAgICB9CgogICAgcmV0dXJuIHRpc3BDb250YWluZXIKICB9LAogIHRpcHM6IGZ1bmN0aW9uIChzdHIpIHsKICAgIGNvbnN0IHQgPSBoNVBsYXllcjsKICAgIGNvbnN0IHBsYXllciA9IHQucGxheWVyKCk7CiAgICBpZiAoIXBsYXllcikgewogICAgICBkZWJ1Zy5sb2coJ2g1UGxheWVyIFRpcHM6Jywgc3RyKTsKICAgICAgcmV0dXJuIHRydWUKICAgIH0KCiAgICBjb25zdCBpc0F1ZGlvID0gdC5pc0F1ZGlvSW5zdGFuY2UoKTsKICAgIGNvbnN0IHBhcmVudE5vZGUgPSBpc0F1ZGlvID8gZG9jdW1lbnQuYm9keSA6IHQuZ2V0VGlwc0NvbnRhaW5lcigpOwoKICAgIGlmIChwYXJlbnROb2RlID09PSBwbGF5ZXIpIHsKICAgICAgZGVidWcuaW5mbygn6I635Y+WdGlwc+eahOWMheijueWuueWZqOW8guW4uO+8micsIHBsYXllciwgc3RyKTsKICAgICAgcmV0dXJuIGZhbHNlCiAgICB9CgogICAgbGV0IGJhY2t1cFN0eWxlID0gJyc7CiAgICBpZiAoIWlzQXVkaW8pIHsKICAgICAgLy8g5L+u5aSN6YOo5YiG5o+Q56S65oyJ6ZKu5L2N572u5byC5bi46Zeu6aKYCiAgICAgIGNvbnN0IGRlZlN0eWxlID0gcGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoJ3N0eWxlJykgfHwgJyc7CgogICAgICBiYWNrdXBTdHlsZSA9IHBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCdzdHlsZS1iYWNrdXAnKSB8fCAnJzsKICAgICAgaWYgKCFiYWNrdXBTdHlsZSkgewogICAgICAgIGxldCBiYWNrdXBTdHkgPSBkZWZTdHlsZSB8fCAnc3R5bGUtYmFja3VwOiBub25lJzsKICAgICAgICBjb25zdCBiYWNrdXBTdHlPYmogPSBpbmxpbmVTdHlsZVRvT2JqKGJhY2t1cFN0eSk7CgogICAgICAgIC8qKgogICAgICAgICAqIOS/ruWkjeWboOS4uue8k+WtmOaXtuacuuiOt+WPluWIsOmUmeivr+agt+W8j+eahOmXrumimAogICAgICAgICAqIOS+i+WmguWcqO+8mmh0dHBzOi8vd3d3Lnh1ZXRhbmd4LmNvbS8KICAgICAgICAgKi8KICAgICAgICBpZiAoYmFja3VwU3R5T2JqLm9wYWNpdHkgPT09ICcwJykgewogICAgICAgICAgYmFja3VwU3R5T2JqLm9wYWNpdHkgPSAnMSc7CiAgICAgICAgfQogICAgICAgIGlmIChiYWNrdXBTdHlPYmoudmlzaWJpbGl0eSA9PT0gJ2hpZGRlbicpIHsKICAgICAgICAgIGJhY2t1cFN0eU9iai52aXNpYmlsaXR5ID0gJ3Zpc2libGUnOwogICAgICAgIH0KCiAgICAgICAgYmFja3VwU3R5ID0gb2JqVG9JbmxpbmVTdHlsZShiYWNrdXBTdHlPYmopOwoKICAgICAgICBwYXJlbnROb2RlLnNldEF0dHJpYnV0ZSgnc3R5bGUtYmFja3VwJywgYmFja3VwU3R5KTsKICAgICAgICBiYWNrdXBTdHlsZSA9IGRlZlN0eWxlOwogICAgICB9IGVsc2UgewogICAgICAgIC8qIOWmguaenGRlZlN0eWxl6KKr5aSW6YOo5L+u5pS55LqG77yM5YiZ6ZyA6KaB5pu05paw5aSH5Lu95qC35byPICovCiAgICAgICAgaWYgKGRlZlN0eWxlICYmICFkZWZTdHlsZS5pbmNsdWRlcygnc3R5bGUtYmFja3VwJykpIHsKICAgICAgICAgIGJhY2t1cFN0eWxlID0gZGVmU3R5bGU7CiAgICAgICAgfQogICAgICB9CgogICAgICBjb25zdCBuZXdTdHlsZUFyciA9IGJhY2t1cFN0eWxlLnNwbGl0KCc7Jyk7CgogICAgICBjb25zdCBvbGRQb3NpdGlvbiA9IHBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCdkZWYtcG9zaXRpb24nKSB8fCB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShwYXJlbnROb2RlKS5wb3NpdGlvbjsKICAgICAgaWYgKHBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCdkZWYtcG9zaXRpb24nKSA9PT0gbnVsbCkgewogICAgICAgIHBhcmVudE5vZGUuc2V0QXR0cmlidXRlKCdkZWYtcG9zaXRpb24nLCBvbGRQb3NpdGlvbiB8fCAnJyk7CiAgICAgIH0KICAgICAgaWYgKFsnc3RhdGljJywgJ2luaGVyaXQnLCAnaW5pdGlhbCcsICd1bnNldCcsICcnXS5pbmNsdWRlcyhvbGRQb3NpdGlvbikpIHsKICAgICAgICBuZXdTdHlsZUFyci5wdXNoKCdwb3NpdGlvbjogcmVsYXRpdmUnKTsKICAgICAgfQoKICAgICAgY29uc3QgcGxheWVyQm94ID0gcGxheWVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICBjb25zdCBwYXJlbnROb2RlQm94ID0gcGFyZW50Tm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgLyog5LiN5a2Y5Zyo6auY5a695pe277yM57uZ5YyF6KO56IqC54K55LiA5Liq5pyA5bCP6auY5a6977yM5omN6IO95L+d6K+B5o+Q56S66IO95q2j5bi45pi+56S6ICovCiAgICAgIGlmICghcGFyZW50Tm9kZUJveC53aWR0aCB8fCAhcGFyZW50Tm9kZUJveC5oZWlnaHQpIHsKICAgICAgICBuZXdTdHlsZUFyci5wdXNoKCdtaW4td2lkdGg6JyArIHBsYXllckJveC53aWR0aCArICdweCcpOwogICAgICAgIG5ld1N0eWxlQXJyLnB1c2goJ21pbi1oZWlnaHQ6JyArIHBsYXllckJveC5oZWlnaHQgKyAncHgnKTsKICAgICAgfQoKICAgICAgcGFyZW50Tm9kZS5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgbmV3U3R5bGVBcnIuam9pbignOycpKTsKCiAgICAgIGNvbnN0IG5ld1BsYXllckJveCA9IHBsYXllci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgaWYgKE1hdGguYWJzKG5ld1BsYXllckJveC5oZWlnaHQgLSBwbGF5ZXJCb3guaGVpZ2h0KSA+IDUwKSB7CiAgICAgICAgcGFyZW50Tm9kZS5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgYmFja3VwU3R5bGUpOwogICAgICAgIC8vIGRlYnVnLmluZm8oJ+W6lOeUqOaWsOagt+W8j+WQjue7meaSreaUvuWZqOmrmOWuvemAoOaIkOS6huS4pemHjeeahOWBj+W3ru+8jOagt+W8j+W3suiiq+i/mOWOn++8micsIHBsYXllciwgcGxheWVyQm94LCBuZXdQbGF5ZXJCb3gpCiAgICAgIH0KICAgIH0KCiAgICBjb25zdCB0aXBzU2VsZWN0b3IgPSAnLicgKyB0LnRpcHNDbGFzc05hbWU7CgogICAgLyog5b2T5Ye6546w5aSa5LiqdGlwc+WFg+e0oOaXtu+8jOWwhui/meS6m3RpcHPlhYPntKDlhajpg6jnp7vpmaQgKi8KICAgIGNvbnN0IHRpcHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aXBzU2VsZWN0b3IpOwogICAgaWYgKHRpcHNMaXN0Lmxlbmd0aCA+IDEpIHsKICAgICAgdGlwc0xpc3QuZm9yRWFjaCh0aXBzSXRlbSA9PiB7CiAgICAgICAgdGlwc0l0ZW0ucmVtb3ZlKCk7CiAgICAgIH0pOwogICAgfQoKICAgIGxldCB0aXBzRG9tID0gcGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKHRpcHNTZWxlY3Rvcik7CgogICAgLyog5o+Q56S6ZG9t5pyq5Yid5aeL5YyW55qE77yM5YiZ6L+b6KGM5Yid5aeL5YyWICovCiAgICBpZiAoIXRpcHNEb20pIHsKICAgICAgdC5pbml0VGlwcygpOwogICAgICB0aXBzRG9tID0gcGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKHRpcHNTZWxlY3Rvcik7CiAgICAgIGlmICghdGlwc0RvbSkgewogICAgICAgIGRlYnVnLmxvZygnaW5pdCBoNXBsYXllciB0aXBzIGRvbSBlcnJvci4uLicpOwogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CiAgICB9CgogICAgY29uc3Qgc3R5bGUgPSB0aXBzRG9tLnN0eWxlOwogICAgdGlwc0RvbS5pbm5lclRleHQgPSBzdHI7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCAzOyBpKyspIHsKICAgICAgaWYgKHRoaXMub25fb2ZmW2ldKSBjbGVhclRpbWVvdXQodGhpcy5vbl9vZmZbaV0pOwogICAgfQoKICAgIGZ1bmN0aW9uIHNob3dUaXBzICgpIHsKICAgICAgc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgIHQub25fb2ZmWzBdID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgc3R5bGUub3BhY2l0eSA9IDE7CiAgICAgIH0sIDUwKTsKICAgICAgdC5vbl9vZmZbMV0gPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAvLyDpmpDol4/mj5DnpLrmoYblkozov5jljp/moLflvI8KICAgICAgICBzdHlsZS5vcGFjaXR5ID0gMDsKICAgICAgICBzdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIGlmIChiYWNrdXBTdHlsZSkgewogICAgICAgICAgcGFyZW50Tm9kZS5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgYmFja3VwU3R5bGUpOwogICAgICAgIH0KICAgICAgfSwgMjAwMCk7CiAgICB9CgogICAgaWYgKHN0eWxlLmRpc3BsYXkgPT09ICdibG9jaycpIHsKICAgICAgc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgY2xlYXJUaW1lb3V0KHRoaXMub25fb2ZmWzNdKTsKICAgICAgdC5vbl9vZmZbMl0gPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBzaG93VGlwcygpOwogICAgICB9LCAxMDApOwogICAgfSBlbHNlIHsKICAgICAgc2hvd1RpcHMoKTsKICAgIH0KICB9LAoKICAvKiDorr7nva7mj5DnpLpET03nmoTmoLflvI8gKi8KICBpbml0VGlwczogZnVuY3Rpb24gKCkgewogICAgY29uc3QgdCA9IGg1UGxheWVyOwogICAgY29uc3QgaXNBdWRpbyA9IHQuaXNBdWRpb0luc3RhbmNlKCk7CiAgICBjb25zdCBwYXJlbnROb2RlID0gaXNBdWRpbyA/IGRvY3VtZW50LmJvZHkgOiB0LmdldFRpcHNDb250YWluZXIoKTsKICAgIGlmIChwYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy4nICsgdC50aXBzQ2xhc3NOYW1lKSkgcmV0dXJuCgogICAgLy8gdG9wOiA1MCU7CiAgICAvLyBsZWZ0OiA1MCU7CiAgICAvLyB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLC01MCUpOwogICAgbGV0IHRpcHNTdHlsZSA9IGAKICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICB6LWluZGV4OiA5OTk5OTk7CiAgICAgIGZvbnQtc2l6ZTogJHt0LmZvbnRTaXplIHx8IDE2fXB4OwogICAgICBwYWRkaW5nOiA1cHggMTBweDsKICAgICAgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwwLjQpOwogICAgICBjb2xvcjp3aGl0ZTsKICAgICAgdG9wOiAwOwogICAgICBsZWZ0OiAwOwogICAgICB0cmFuc2l0aW9uOiBhbGwgNTAwbXMgZWFzZTsKICAgICAgb3BhY2l0eTogMDsKICAgICAgYm9yZGVyLWJvdHRvbS1yaWdodC1yYWRpdXM6IDVweDsKICAgICAgZGlzcGxheTogbm9uZTsKICAgICAgLXdlYmtpdC1mb250LXNtb290aGluZzogc3VicGl4ZWwtYW50aWFsaWFzZWQ7CiAgICAgIGZvbnQtZmFtaWx5OiAnbWljcm9zb2Z0IHlhaGVpJywgVmVyZGFuYSwgR2VuZXZhLCBzYW5zLXNlcmlmOwogICAgICAtd2Via2l0LXVzZXItc2VsZWN0OiBub25lOwogICAgYDsKCiAgICBpZiAoaXNBdWRpbykgewogICAgICB0aXBzU3R5bGUgPSBgCiAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgIHotaW5kZXg6IDk5OTk5OTsKICAgICAgICBmb250LXNpemU6ICR7dC5mb250U2l6ZSB8fCAxNn1weDsKICAgICAgICBwYWRkaW5nOiA1cHggMTBweDsKICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLDAuNCk7CiAgICAgICAgY29sb3I6d2hpdGU7CiAgICAgICAgYm90dG9tOiAwOwogICAgICAgIHJpZ2h0OiAwOwogICAgICAgIHRyYW5zaXRpb246IGFsbCA1MDBtcyBlYXNlOwogICAgICAgIG9wYWNpdHk6IDA7CiAgICAgICAgYm9yZGVyLXRvcC1sZWZ0LXJhZGl1czogNXB4OwogICAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICAgICAgLXdlYmtpdC1mb250LXNtb290aGluZzogc3VicGl4ZWwtYW50aWFsaWFzZWQ7CiAgICAgICAgZm9udC1mYW1pbHk6ICdtaWNyb3NvZnQgeWFoZWknLCBWZXJkYW5hLCBHZW5ldmEsIHNhbnMtc2VyaWY7CiAgICAgICAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTsKICAgICAgYDsKICAgIH0KCiAgICBjb25zdCB0aXBzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICB0aXBzLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCB0aXBzU3R5bGUpOwogICAgdGlwcy5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgdC50aXBzQ2xhc3NOYW1lKTsKICAgIHBhcmVudE5vZGUuYXBwZW5kQ2hpbGQodGlwcyk7CiAgfSwKICBvbl9vZmY6IG5ldyBBcnJheSgzKSwKICBmcHM6IDMwLAogIC8qIOa7pOmVnOaViOaenCAqLwogIGZpbHRlcjogewogICAga2V5OiBbMSwgMSwgMSwgMCwgMF0sCiAgICBzZXR1cDogZnVuY3Rpb24gKCkgewogICAgICBsZXQgdmlldyA9ICdicmlnaHRuZXNzKHswfSkgY29udHJhc3QoezF9KSBzYXR1cmF0ZSh7Mn0pIGh1ZS1yb3RhdGUoezN9ZGVnKSBibHVyKHs0fXB4KSc7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNTsgaSsrKSB7CiAgICAgICAgdmlldyA9IHZpZXcucmVwbGFjZSgneycgKyBpICsgJ30nLCBTdHJpbmcodGhpcy5rZXlbaV0pKTsKICAgICAgICB0aGlzLmtleVtpXSA9IE51bWJlcih0aGlzLmtleVtpXSk7CiAgICAgIH0KICAgICAgaDVQbGF5ZXIucGxheWVyKCkuc3R5bGUuZmlsdGVyID0gdmlldzsKICAgIH0sCiAgICByZXNldDogZnVuY3Rpb24gKCkgewogICAgICB0aGlzLmtleVswXSA9IDE7CiAgICAgIHRoaXMua2V5WzFdID0gMTsKICAgICAgdGhpcy5rZXlbMl0gPSAxOwogICAgICB0aGlzLmtleVszXSA9IDA7CiAgICAgIHRoaXMua2V5WzRdID0gMDsKICAgICAgdGhpcy5zZXR1cCgpOwogICAgfQogIH0sCgogIHNldEZpbHRlciAoaXRlbSwgbnVtLCBpc0Rvd24pIHsKICAgIGlmICghWzAsIDEsIDIsIDMsIDRdLmluY2x1ZGVzKGl0ZW0pIHx8IHR5cGVvZiBudW0gIT09ICdudW1iZXInKSB7CiAgICAgIGRlYnVnLmVycm9yKCdbc2V0RmlsdGVyXScsICflj4LmlbDmnInor68nLCBpdGVtLCBudW0pOwogICAgICByZXR1cm4gZmFsc2UKICAgIH0KCiAgICAvKiDlpoLmnpzmoIfor4bkuLpkb3du77yM5YiZ6Ieq5Yqo5Y+W6LSf5pWw5YC8ICovCiAgICBpZiAoaXNEb3duID09PSB0cnVlKSB7CiAgICAgIGlmIChudW0gJiYgbnVtID4gMCkgeyBudW0gPSAtbnVtOyB9CiAgICB9CgogICAgY29uc3QgbmFtZU1hcCA9IHsKICAgICAgMDogJ2JyaWdodG5lc3MnLAogICAgICAxOiAnY29udHJhc3QnLAogICAgICAyOiAnc2F0dXJhdGlvbicsCiAgICAgIDM6ICdodWUnLAogICAgICA0OiAnYmx1cicKICAgIH07CgogICAgY29uc3QgdCA9IHRoaXM7CiAgICB0LmZpbHRlci5rZXlbaXRlbV0gKz0gbnVtIHx8IDAuMTsKICAgIHQuZmlsdGVyLmtleVtpdGVtXSA9IHQuZmlsdGVyLmtleVtpdGVtXS50b0ZpeGVkKDIpOwoKICAgIGlmICh0LmZpbHRlci5rZXlbaXRlbV0gPCAwICYmIG5hbWVNYXBbaXRlbV0gIT09ICdodWUnKSB7CiAgICAgIHQuZmlsdGVyLmtleVtpdGVtXSA9IDA7CiAgICB9CgogICAgdC5maWx0ZXIuc2V0dXAoKTsKICAgIHQudGlwcyhpMThuLnQoYHRpcHNNc2cuJHtuYW1lTWFwW2l0ZW1dfWApICsgcGFyc2VJbnQodC5maWx0ZXIua2V5W2l0ZW1dICogMTAwKSArICclJyk7CiAgfSwKCiAgLyog6K6+572u6KeG6aKR55qE5Lqu5bqmICovCiAgc2V0QnJpZ2h0bmVzcyAobnVtKSB7CiAgICB0aGlzLnNldEZpbHRlcigwLCBudW0pOwogIH0sCgogIC8qIOaPkOWNh+inhumikeeahOS6ruW6piAqLwogIHNldEJyaWdodG5lc3NVcCAobnVtKSB7CiAgICB0aGlzLnNldEZpbHRlcigwLCBudW0gfHwgMC4xKTsKICB9LAoKICAvKiDpmY3kvY7op4bpopHnmoTkuq7luqYgKi8KICBzZXRCcmlnaHRuZXNzRG93biAobnVtKSB7CiAgICB0aGlzLnNldEZpbHRlcigwLCBudW0gfHwgLTAuMSwgdHJ1ZSk7CiAgfSwKCiAgLyog6K6+572u6KeG6aKR55qE5a+55q+U5bqmICovCiAgc2V0Q29udHJhc3QgKG51bSkgewogICAgdGhpcy5zZXRGaWx0ZXIoMSwgbnVtKTsKICB9LAoKICAvKiDmj5DljYfop4bpopHnmoTlr7nmr5TluqYgKi8KICBzZXRDb250cmFzdFVwIChudW0pIHsKICAgIHRoaXMuc2V0RmlsdGVyKDEsIG51bSB8fCAwLjEpOwogIH0sCgogIC8qIOmZjeS9juinhumikeeahOWvueavlOW6piAqLwogIHNldENvbnRyYXN0RG93biAobnVtKSB7CiAgICB0aGlzLnNldEZpbHRlcigxLCBudW0gfHwgLTAuMSwgdHJ1ZSk7CiAgfSwKCiAgLyog6K6+572u6aWx5ZKM5bqmICovCiAgc2V0U2F0dXJhdGlvbiAobnVtKSB7CiAgICB0aGlzLnNldEZpbHRlcigyLCBudW0pOwogIH0sCgogIC8qIOaPkOWNh+mlseWSjOW6piAqLwogIHNldFNhdHVyYXRpb25VcCAobnVtKSB7CiAgICB0aGlzLnNldEZpbHRlcigyLCBudW0gfHwgMC4xKTsKICB9LAoKICAvKiDpmY3kvY7ppbHlkozluqYgKi8KICBzZXRTYXR1cmF0aW9uRG93biAobnVtKSB7CiAgICB0aGlzLnNldEZpbHRlcigyLCBudW0gfHwgLTAuMSwgdHJ1ZSk7CiAgfSwKCiAgLyog6K6+572u6Imy55u4ICovCiAgc2V0SHVlIChudW0pIHsKICAgIHRoaXMuc2V0RmlsdGVyKDMsIG51bSk7CiAgfSwKCiAgLyog5aKe5Yqg6Imy55u4ICovCiAgc2V0SHVlVXAgKG51bSkgewogICAgdGhpcy5zZXRGaWx0ZXIoMywgbnVtIHx8IDEpOwogIH0sCgogIC8qIOmZjeS9juiJsuebuCAqLwogIHNldEh1ZURvd24gKG51bSkgewogICAgdGhpcy5zZXRGaWx0ZXIoMywgbnVtIHx8IC0xLCB0cnVlKTsKICB9LAoKICAvKiDorr7nva7mqKHns4rluqYgKi8KICBzZXRCbHVyIChudW0pIHsKICAgIHRoaXMuc2V0RmlsdGVyKDQsIG51bSk7CiAgfSwKCiAgLyog5aKe5Yqg5qih57OK5bqmICovCiAgc2V0Qmx1clVwIChudW0pIHsKICAgIHRoaXMuc2V0RmlsdGVyKDQsIG51bSB8fCAxKTsKICB9LAoKICAvKiDpmY3kvY7mqKHns4rluqYgKi8KICBzZXRCbHVyRG93biAobnVtKSB7CiAgICB0aGlzLnNldEZpbHRlcig0LCBudW0gfHwgLTEsIHRydWUpOwogIH0sCgogIHJlc2V0RmlsdGVyQW5kVHJhbnNmb3JtICgpIHsKICAgIGNvbnN0IHQgPSB0aGlzOwoKICAgIHQucmVzZXRUcmFuc2Zvcm0odHJ1ZSk7CiAgICB0LmZpbHRlci5yZXNldCgpOwogICAgdC50aXBzKGkxOG4udCgndGlwc01zZy5pbWdhdHRycmVzZXQnKSk7CiAgfSwKCiAgbWVkaWFEb3dubG9hZCAoKSB7CiAgICBpZiAoY29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UuYWxsb3dFeHBlcmltZW50RmVhdHVyZXMnKSkgewogICAgICBkZWJ1Zy53YXJuKCdbZXhwZXJpbWVudEZlYXR1cmVzXVttZWRpYURvd25sb2FkXScpOwogICAgICBtZWRpYURvd25sb2FkKHRoaXMucGxheWVyKCkpOwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgcmVzdWx0ID0gd2luZG93LmNvbmZpcm0oaTE4bi50KCd1c2VNZWRpYURvd25sb2FkVGlwcycpKTsKICAgICAgaWYgKHJlc3VsdCkgewogICAgICAgIGNvbmZpZ01hbmFnZXIuc2V0R2xvYmFsU3RvcmFnZSgnZW5oYW5jZS5hbGxvd0V4cGVyaW1lbnRGZWF0dXJlcycsICFjb25maWdNYW5hZ2VyLmdldCgnZW5oYW5jZS5hbGxvd0V4cGVyaW1lbnRGZWF0dXJlcycpKTsKICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgICAgIH0KICAgIH0KICB9LAoKICBjYXB0dXJlICgpIHsKICAgIGNvbnN0IHBsYXllciA9IHRoaXMucGxheWVyKCk7CiAgICB2aWRlb0NhcHR1cmVyLmNhcHR1cmUocGxheWVyLCB0cnVlKTsKCiAgICAvKiDmmoLlgZznlLvpnaIgKi8KICAgIGlmICghcGxheWVyLnBhdXNlZCAmJiAhZG9jdW1lbnQucGljdHVyZUluUGljdHVyZUVsZW1lbnQgJiYgZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlICE9PSAndmlzaWJsZScpIHsKICAgICAgdGhpcy5mcmVlemVGcmFtZSgpOwogICAgfQogIH0sCgogIF9pc0ZvdWNzOiBmYWxzZSwKCiAgLyog5pKt5pS+5Zmo55qE6IGa54Sm5LqL5Lu2ICovCiAgaXNGb3VjczogZnVuY3Rpb24gKCkgewogICAgY29uc3QgdCA9IGg1UGxheWVyOwogICAgY29uc3QgcGxheWVyID0gdC5wbGF5ZXIoKTsKICAgIGlmICghcGxheWVyKSByZXR1cm4KCiAgICBwbGF5ZXIub25tb3VzZWVudGVyID0gZnVuY3Rpb24gKGUpIHsKICAgICAgaDVQbGF5ZXIuX2lzRm91Y3MgPSB0cnVlOwogICAgfTsKICAgIHBsYXllci5vbm1vdXNlbGVhdmUgPSBmdW5jdGlvbiAoZSkgewogICAgICBoNVBsYXllci5faXNGb3VjcyA9IGZhbHNlOwogICAgfTsKICB9LAogIC8qIOaSreaUvuWZqOS6i+S7tuWTjeW6lOWZqCAqLwogIHBhbHllclRyaWdnZXI6IGZ1bmN0aW9uIChwbGF5ZXIsIGV2ZW50KSB7CiAgICBpZiAoIXBsYXllciB8fCAhZXZlbnQpIHJldHVybgogICAgY29uc3QgdCA9IGg1UGxheWVyOwogICAgY29uc3Qga2V5Q29kZSA9IGV2ZW50LmtleUNvZGU7CiAgICBjb25zdCBrZXkgPSBldmVudC5rZXkudG9Mb3dlckNhc2UoKTsKCiAgICBpZiAoZXZlbnQuc2hpZnRLZXkgJiYgIWV2ZW50LmN0cmxLZXkgJiYgIWV2ZW50LmFsdEtleSAmJiAhZXZlbnQubWV0YUtleSkgewogICAgICAvLyDnvZHpobXlhajlsY8KICAgICAgaWYgKGtleSA9PT0gJ2VudGVyJykgewogICAgICAgIHQuc2V0V2ViRnVsbFNjcmVlbigpOwogICAgICB9CgogICAgICAvLyDov5vlhaXmiJbpgIDlh7rnlLvkuK3nlLvmqKHlvI8KICAgICAgaWYgKGtleSA9PT0gJ3AnKSB7CiAgICAgICAgdC50b2dnbGVQaWN0dXJlSW5QaWN0dXJlKCk7CiAgICAgIH0KCiAgICAgIC8vIOaIquWbvuW5tuS4i+i9veS/neWtmAogICAgICBpZiAoa2V5ID09PSAncycpIHsKICAgICAgICB0LmNhcHR1cmUoKTsKICAgICAgfQoKICAgICAgaWYgKGtleSA9PT0gJ3InKSB7CiAgICAgICAgdC5zd2l0Y2hSZXN0b3JlUGxheVByb2dyZXNzU3RhdHVzKCk7CiAgICAgIH0KCiAgICAgIGlmIChrZXkgPT09ICdtJykgewogICAgICAgIC8qIOWeguebtOmVnOWDj+e/u+i9rCAqLwogICAgICAgIHQuc2V0TWlycm9yKHRydWUpOwogICAgICB9CgogICAgICBpZiAoa2V5ID09PSAnZCcpIHsKICAgICAgICB0Lm1lZGlhRG93bmxvYWQoKTsKICAgICAgfQoKICAgICAgLy8g6KeG6aKR55S76Z2i57yp5pS+55u45YWz5LqL5Lu2CiAgICAgIGNvbnN0IGFsbG93S2V5cyA9IFsneCcsICdjJywgJ3onLCAnYXJyb3dyaWdodCcsICdhcnJvd2xlZnQnLCAnYXJyb3d1cCcsICdhcnJvd2Rvd24nXTsKICAgICAgaWYgKCFhbGxvd0tleXMuaW5jbHVkZXMoa2V5KSkgcmV0dXJuCgogICAgICB0LnNjYWxlID0gTnVtYmVyKHQuc2NhbGUpOwogICAgICBzd2l0Y2ggKGtleSkgewogICAgICAgIC8vIHNoaWZ0K1jvvJrop4bpopHnvKnlsI8gLTAuMQogICAgICAgIGNhc2UgJ3gnOgogICAgICAgICAgdC5zZXRTY2FsZURvd24oKTsKICAgICAgICAgIGJyZWFrCiAgICAgICAgLy8gc2hpZnQrQ++8muinhumikeaUvuWkpyArMC4xCiAgICAgICAgY2FzZSAnYyc6CiAgICAgICAgICB0LnNldFNjYWxlVXAoKTsKICAgICAgICAgIGJyZWFrCiAgICAgICAgLy8gc2hpZnQrWu+8muinhumikeaBouWkjeato+W4uOWkp+WwjwogICAgICAgIGNhc2UgJ3onOgogICAgICAgICAgdC5yZXNldFRyYW5zZm9ybSgpOwogICAgICAgICAgYnJlYWsKICAgICAgICBjYXNlICdhcnJvd3JpZ2h0JzoKICAgICAgICAgIHQuc2V0VHJhbnNsYXRlUmlnaHQoKTsKICAgICAgICAgIGJyZWFrCiAgICAgICAgY2FzZSAnYXJyb3dsZWZ0JzoKICAgICAgICAgIHQuc2V0VHJhbnNsYXRlTGVmdCgpOwogICAgICAgICAgYnJlYWsKICAgICAgICBjYXNlICdhcnJvd3VwJzoKICAgICAgICAgIHQuc2V0VHJhbnNsYXRlVXAoKTsKICAgICAgICAgIGJyZWFrCiAgICAgICAgY2FzZSAnYXJyb3dkb3duJzoKICAgICAgICAgIHQuc2V0VHJhbnNsYXRlRG93bigpOwogICAgICAgICAgYnJlYWsKICAgICAgfQoKICAgICAgLy8g6Zi75q2i5LqL5Lu25YaS5rOhCiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICByZXR1cm4gdHJ1ZQogICAgfQoKICAgIC8vIGN0cmwr5pa55ZCR6ZSu5Y+z4oaS77ya5b+r6L+bMzDnp5IKICAgIGlmIChldmVudC5jdHJsS2V5ICYmIGtleUNvZGUgPT09IDM5KSB7CiAgICAgIHQuc2V0Q3VycmVudFRpbWVVcCh0LnNraXBTdGVwICogNik7CiAgICB9CiAgICAvLyBjdHJsK+aWueWQkemUruW3puKGkO+8muWQjumAgDMw56eSCiAgICBpZiAoZXZlbnQuY3RybEtleSAmJiBrZXlDb2RlID09PSAzNykgewogICAgICB0LnNldEN1cnJlbnRUaW1lRG93bigtdC5za2lwU3RlcCAqIDYpOwogICAgfQoKICAgIC8vIGN0cmwr5pa55ZCR6ZSu5LiK4oaR77ya6Z+z6YeP5Y2H6auYIDIwJQogICAgaWYgKGV2ZW50LmN0cmxLZXkgJiYga2V5Q29kZSA9PT0gMzgpIHsKICAgICAgdC5zZXRWb2x1bWVVcCgwLjIpOwogICAgfQogICAgLy8g5pa55ZCR6ZSu5LiL4oaT77ya6Z+z6YeP6ZmN5L2OIDIwJQogICAgaWYgKGV2ZW50LmN0cmxLZXkgJiYga2V5Q29kZSA9PT0gNDApIHsKICAgICAgdC5zZXRWb2x1bWVEb3duKC0wLjIpOwogICAgfQoKICAgIC8vIOmYsuatouWFtuWug+aXoOWFs+e7hOWQiOmUruWGsueqgQogICAgaWYgKGV2ZW50LmFsdEtleSB8fCBldmVudC5jdHJsS2V5IHx8IGV2ZW50LnNoaWZ0S2V5IHx8IGV2ZW50Lm1ldGFLZXkpIHJldHVybgoKICAgIC8vIOaWueWQkemUruWPs+KGku+8muW/q+i/mzXnp5IKICAgIGlmIChrZXlDb2RlID09PSAzOSkgewogICAgICB0LnNldEN1cnJlbnRUaW1lVXAoKTsKICAgIH0KICAgIC8vIOaWueWQkemUruW3puKGkO+8muWQjumAgDXnp5IKICAgIGlmIChrZXlDb2RlID09PSAzNykgewogICAgICB0LnNldEN1cnJlbnRUaW1lRG93bigpOwogICAgfQoKICAgIC8vIOaWueWQkemUruS4iuKGke+8mumfs+mHj+WNh+mrmCAxMCUKICAgIGlmIChrZXlDb2RlID09PSAzOCkgewogICAgICB0LnNldFZvbHVtZVVwKDAuMDUpOwogICAgfQogICAgLy8g5pa55ZCR6ZSu5LiL4oaT77ya6Z+z6YeP6ZmN5L2OIDEwJQogICAgaWYgKGtleUNvZGUgPT09IDQwKSB7CiAgICAgIHQuc2V0Vm9sdW1lRG93bigtMC4wNSk7CiAgICB9CgogICAgLy8g56m65qC86ZSu77ya5pqC5YGcL+aSreaUvgogICAgaWYgKGtleUNvZGUgPT09IDMyKSB7CiAgICAgIHQuc3dpdGNoUGxheVN0YXR1cygpOwogICAgfQoKICAgIC8vIOaMiemUrljvvJrlh4/pgJ/mkq3mlL4gLTAuMQogICAgaWYgKGtleUNvZGUgPT09IDg4KSB7CiAgICAgIHQuc2V0UGxheWJhY2tSYXRlRG93bigpOwogICAgfQogICAgLy8g5oyJ6ZSuQ++8muWKoOmAn+aSreaUviArMC4xCiAgICBpZiAoa2V5Q29kZSA9PT0gNjcpIHsKICAgICAgdC5zZXRQbGF5YmFja1JhdGVVcCgpOwogICAgfQogICAgLy8g5oyJ6ZSuWu+8muato+W4uOmAn+W6puaSreaUvgogICAgaWYgKGtleUNvZGUgPT09IDkwKSB7CiAgICAgIHQucmVzZXRQbGF5YmFja1JhdGUoKTsKICAgIH0KCiAgICAvLyDmjIkxLTTorr7nva7mkq3mlL7pgJ/luqYgNDktNTI7OTctMTAwCiAgICBpZiAoKGtleUNvZGUgPj0gNDkgJiYga2V5Q29kZSA8PSA1MikgfHwgKGtleUNvZGUgPj0gOTcgJiYga2V5Q29kZSA8PSAxMDApKSB7CiAgICAgIHQuc2V0UGxheWJhY2tSYXRlUGx1cyhldmVudC5rZXkpOwogICAgfQoKICAgIC8vIOaMiemUrkbvvJrkuIvkuIDluKcKICAgIGlmIChrZXlDb2RlID09PSA3MCkgewogICAgICB0LmZyZWV6ZUZyYW1lKDEpOwogICAgfQogICAgLy8g5oyJ6ZSuRO+8muS4iuS4gOW4pwogICAgaWYgKGtleUNvZGUgPT09IDY4KSB7CiAgICAgIHQuZnJlZXplRnJhbWUoLTEpOwogICAgfQoKICAgIC8vIOaMiemUrkXvvJrkuq7luqblop7liqAlCiAgICBpZiAoa2V5Q29kZSA9PT0gNjkpIHsKICAgICAgdC5zZXRCcmlnaHRuZXNzVXAoKTsKICAgIH0KICAgIC8vIOaMiemUrlfvvJrkuq7luqblh4/lsJElCiAgICBpZiAoa2V5Q29kZSA9PT0gODcpIHsKICAgICAgdC5zZXRCcmlnaHRuZXNzRG93bigpOwogICAgfQoKICAgIC8vIOaMiemUrlTvvJrlr7nmr5Tluqblop7liqAlCiAgICBpZiAoa2V5Q29kZSA9PT0gODQpIHsKICAgICAgdC5zZXRDb250cmFzdFVwKCk7CiAgICB9CiAgICAvLyDmjInplK5S77ya5a+55q+U5bqm5YeP5bCRJQogICAgaWYgKGtleUNvZGUgPT09IDgyKSB7CiAgICAgIHQuc2V0Q29udHJhc3REb3duKCk7CiAgICB9CgogICAgLy8g5oyJ6ZSuVe+8mumlseWSjOW6puWinuWKoCUKICAgIGlmIChrZXlDb2RlID09PSA4NSkgewogICAgICB0LnNldFNhdHVyYXRpb25VcCgpOwogICAgfQogICAgLy8g5oyJ6ZSuWe+8mumlseWSjOW6puWHj+WwkSUKICAgIGlmIChrZXlDb2RlID09PSA4OSkgewogICAgICB0LnNldFNhdHVyYXRpb25Eb3duKCk7CiAgICB9CgogICAgLy8g5oyJ6ZSuT++8muiJsuebuOWinuWKoCAxIOW6pgogICAgaWYgKGtleUNvZGUgPT09IDc5KSB7CiAgICAgIHQuc2V0SHVlVXAoKTsKICAgIH0KICAgIC8vIOaMiemUrknvvJroibLnm7jlh4/lsJEgMSDluqYKICAgIGlmIChrZXlDb2RlID09PSA3MykgewogICAgICB0LnNldEh1ZURvd24oKTsKICAgIH0KCiAgICAvLyDmjInplK5L77ya5qih57OK5aKe5YqgIDEgcHgKICAgIGlmIChrZXlDb2RlID09PSA3NSkgewogICAgICB0LnNldEJsdXJVcCgpOwogICAgfQogICAgLy8g5oyJ6ZSuSu+8muaooeeziuWHj+WwkSAxIHB4CiAgICBpZiAoa2V5Q29kZSA9PT0gNzQpIHsKICAgICAgdC5zZXRCbHVyRG93bigpOwogICAgfQoKICAgIC8vIOaMiemUrlHvvJrlm77lg4/lpI3kvY0KICAgIGlmIChrZXlDb2RlID09PSA4MSkgewogICAgICB0LnJlc2V0RmlsdGVyQW5kVHJhbnNmb3JtKCk7CiAgICB9CgogICAgLy8g5oyJ6ZSuU++8mueUu+mdouaXi+i9rCA5MCDluqYKICAgIGlmIChrZXlDb2RlID09PSA4MykgewogICAgICB0LnNldFJvdGF0ZSgpOwogICAgfQoKICAgIC8qIOawtOW5s+mVnOWDj+e/u+i9rCAqLwogICAgaWYgKGtleUNvZGUgPT09IDc3KSB7CiAgICAgIHQuc2V0TWlycm9yKCk7CiAgICB9CgogICAgLy8g5oyJ6ZSu5Zue6L2m77yM6L+b5YWl5YWo5bGPCiAgICBpZiAoa2V5Q29kZSA9PT0gMTMpIHsKICAgICAgdC5zZXRGdWxsU2NyZWVuKCk7CiAgICB9CgogICAgaWYgKGtleSA9PT0gJ24nKSB7CiAgICAgIHQuc2V0TmV4dFZpZGVvKCk7CiAgICB9CgogICAgLy8g6Zi75q2i5LqL5Lu25YaS5rOhCiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICByZXR1cm4gdHJ1ZQogIH0sCgogIC8qIOi/kOihjOiHquWumuS5ieeahOW/q+aNt+mUruaTjeS9nO+8jOWmguaenOi/kOihjOS6huS8mui/lOWbnnRydWUgKi8KICBydW5DdXN0b21TaG9ydGN1dHM6IGZ1bmN0aW9uIChwbGF5ZXIsIGV2ZW50KSB7CiAgICBpZiAoIXBsYXllciB8fCAhZXZlbnQpIHJldHVybgogICAgY29uc3Qga2V5ID0gZXZlbnQua2V5LnRvTG93ZXJDYXNlKCk7CiAgICBjb25zdCB0YXNrQ29uZiA9IFRDQy5nZXRUYXNrQ29uZmlnKCk7CiAgICBjb25zdCBjb25mSXNDb3JyZWN0ID0gaXNPYmokMSh0YXNrQ29uZi5zaG9ydGN1dHMpICYmCiAgICAgIEFycmF5LmlzQXJyYXkodGFza0NvbmYuc2hvcnRjdXRzLnJlZ2lzdGVyKSAmJgogICAgICB0YXNrQ29uZi5zaG9ydGN1dHMuY2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbjsKCiAgICAvKiDliKTmlq3lvZPliY3op6blj5HnmoTlv6vmjbfplK7mmK/lkKblt7Looqvms6jlhowgKi8KICAgIGZ1bmN0aW9uIGlzUmVnaXN0ZXIgKCkgewogICAgICBjb25zdCBsaXN0ID0gdGFza0NvbmYuc2hvcnRjdXRzLnJlZ2lzdGVyOwoKICAgICAgLyog5b2T5YmN6Kem5Y+R55qE57uE5ZCI6ZSuICovCiAgICAgIGNvbnN0IGNvbWJpbmVLZXkgPSBbXTsKICAgICAgaWYgKGV2ZW50LmN0cmxLZXkpIHsKICAgICAgICBjb21iaW5lS2V5LnB1c2goJ2N0cmwnKTsKICAgICAgfQogICAgICBpZiAoZXZlbnQuc2hpZnRLZXkpIHsKICAgICAgICBjb21iaW5lS2V5LnB1c2goJ3NoaWZ0Jyk7CiAgICAgIH0KICAgICAgaWYgKGV2ZW50LmFsdEtleSkgewogICAgICAgIGNvbWJpbmVLZXkucHVzaCgnYWx0Jyk7CiAgICAgIH0KICAgICAgaWYgKGV2ZW50Lm1ldGFLZXkpIHsKICAgICAgICBjb21iaW5lS2V5LnB1c2goJ2NvbW1hbmQnKTsKICAgICAgfQoKICAgICAgY29tYmluZUtleS5wdXNoKGtleSk7CgogICAgICAvKiDpgJrov4flvqrnjq/liKTmlq3lvZPliY3op6blj5HnmoTnu4TlkIjplK7lkozlt7Lms6jlhoznmoTnu4TlkIjplK7mmK/lkKblrozlhajkuIDoh7QgKi8KICAgICAgbGV0IGhhc1JlZyA9IGZhbHNlOwogICAgICBsaXN0LmZvckVhY2goKHNob3J0Y3V0KSA9PiB7CiAgICAgICAgY29uc3QgcmVnS2V5ID0gc2hvcnRjdXQuc3BsaXQoJysnKTsKICAgICAgICBpZiAoY29tYmluZUtleS5sZW5ndGggPT09IHJlZ0tleS5sZW5ndGgpIHsKICAgICAgICAgIGxldCBhbGxNYXRjaCA9IHRydWU7CiAgICAgICAgICByZWdLZXkuZm9yRWFjaCgoa2V5KSA9PiB7CiAgICAgICAgICAgIGlmICghY29tYmluZUtleS5pbmNsdWRlcyhrZXkpKSB7CiAgICAgICAgICAgICAgYWxsTWF0Y2ggPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoYWxsTWF0Y2gpIHsKICAgICAgICAgICAgaGFzUmVnID0gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIGhhc1JlZwogICAgfQoKICAgIGlmIChjb25mSXNDb3JyZWN0ICYmIGlzUmVnaXN0ZXIoKSkgewogICAgICAvLyDmiafooYzoh6rlrprkuYnlv6vmjbfplK7mk43kvZwKICAgICAgY29uc3QgaXNEbyA9IFRDQy5kb1Rhc2soJ3Nob3J0Y3V0cycsIHsKICAgICAgICBldmVudCwKICAgICAgICBwbGF5ZXIsCiAgICAgICAgaDVQbGF5ZXIKICAgICAgfSk7CgogICAgICBpZiAoaXNEbykgewogICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBpc0RvCiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZmFsc2UKICAgIH0KICB9LAoKICAvKiDmjInplK7lk43lupTmlrnms5UgKi8KICBrZXlkb3duRXZlbnQ6IGZ1bmN0aW9uIChldmVudCkgewogICAgY29uc3QgdCA9IGg1UGxheWVyOwogICAgY29uc3Qga2V5Q29kZSA9IGV2ZW50LmtleUNvZGU7CiAgICAvLyBjb25zdCBrZXkgPSBldmVudC5rZXkudG9Mb3dlckNhc2UoKQogICAgY29uc3QgcGxheWVyID0gdC5wbGF5ZXIoKTsKCiAgICAvKiDlpITkuo7lj6/nvJbovpHlhYPntKDkuK3kuI3miafooYzku7vkvZXlv6vmjbfplK4gKi8KICAgIGNvbnN0IHRhcmdldCA9IGV2ZW50LmNvbXBvc2VkUGF0aCA/IGV2ZW50LmNvbXBvc2VkUGF0aCgpWzBdIHx8IGV2ZW50LnRhcmdldCA6IGV2ZW50LnRhcmdldDsKICAgIGlmICh0Ll9fZGlzYWJsZUhvdGtleXNUZW1wb3JhcmlseV9fIHx8IGlzRWRpdGFibGVUYXJnZXQodGFyZ2V0KSkgcmV0dXJuCgogICAgLyog5bm/5pKt5oyJ6ZSu5raI5oGv77yM6L+b6KGM6Leo5Z+f5o6n5Yi2ICovCiAgICBtb25rZXlNc2cuc2VuZCgnZ2xvYmFsS2V5ZG93bkV2ZW50JywgZXZlbnQsIDApOwoKICAgIGlmICghcGxheWVyKSB7CiAgICAgIGlmICh0Lmhhc0Nyb3NzT3JpZ2luVmlkZW9EZXRlY3RlZCkgewogICAgICAgIGlmICghY29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UuYWxsb3dDcm9zc09yaWdpbkNvbnRyb2wnKSkgewogICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiDliKnnlKjng63plK7ov5DooYzlmajnmoTljLnphY3og73lipvmnaXlhrPlrpropoHkuI3opoHnpoHmraLkuovku7blhpLms6HlkozpmLvmraLpu5jorqTkuovku7YKICAgICAgICAgKiDop6PlhrPlpITkuo7ot6hUQULjgIHot6jln5/mjqfliLbml7bpgKDmiJDlhbblroPpu5jorqTlv6vmjbfplK7lk43lupTlvILluLjnmoTpl67popgKICAgICAgICAgKi8KICAgICAgICBpZiAodC5ob3RrZXlzUnVubmVyICYmIHQuaG90a2V5c1J1bm5lci5ydW4pIHsKICAgICAgICAgIHQuaG90a2V5c1J1bm5lci5ydW4oewogICAgICAgICAgICBldmVudCwKICAgICAgICAgICAgc3RvcFByb3BhZ2F0aW9uOiB0cnVlLAogICAgICAgICAgICBwcmV2ZW50RGVmYXVsdDogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHQucmVnaXN0ZXJIb3RrZXlzUnVubmVyKCk7CiAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgfQoKICAgICAgICAvLyBkZWJ1Zy5sb2coJ+W9k+WJjemhtemdouajgOWHuuS6hui3qOWfn+WPl+mZkOeahOinhumike+8jOS7jemcgOmYu+atoum7mOiupOS6i+S7tuWSjOS6i+S7tuWGkuazoScpCiAgICAgIH0KCiAgICAgIC8vIGRlYnVnLmxvZygn5peg5Y+v55So55qE5aqS5L2T5YWD57Sg77yM5LiN5omn6KGM55u45YWz5pON5L2cJykKICAgICAgcmV0dXJuIGZhbHNlCiAgICB9CgogICAgLyog5YiH5o2i5o+S5Lu255qE5Y+v55So54q25oCBICovCiAgICBpZiAoZXZlbnQuY3RybEtleSAmJiBrZXlDb2RlID09PSAzMikgewogICAgICB0LmVuYWJsZSA9ICF0LmVuYWJsZTsKICAgICAgaWYgKHQuZW5hYmxlKSB7CiAgICAgICAgdC50aXBzKGkxOG4udCgndGlwc01zZy5vbnBsdWdpbicpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0LnRpcHMoaTE4bi50KCd0aXBzTXNnLm9mZnBsdWdpbicpKTsKICAgICAgfQogICAgfQoKICAgIGlmICghdC5lbmFibGUpIHsKICAgICAgZGVidWcubG9nKCdoNVBsYXllciDlt7LnpoHnlKh+Jyk7CiAgICAgIHJldHVybiBmYWxzZQogICAgfQoKICAgIC8vIOaMiWN0cmwrXCDplK7ov5vlhaXogZrnhKbmiJblj5bmtojogZrnhKbnirbmgIHvvIznlKjkuo7op4bpopHmoIfnrb7ooqvpga7mjKHnmoTlnLrmma8KICAgIGlmIChldmVudC5jdHJsS2V5ICYmIGtleUNvZGUgPT09IDIyMCkgewogICAgICB0Lmdsb2JhbE1vZGUgPSAhdC5nbG9iYWxNb2RlOwogICAgICBpZiAodC5nbG9iYWxNb2RlKSB7CiAgICAgICAgdC50aXBzKGkxOG4udCgndGlwc01zZy5nbG9iYWxtb2RlJykgKyAnIE9OJyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdC50aXBzKGkxOG4udCgndGlwc01zZy5nbG9iYWxtb2RlJykgKyAnIE9GRicpOwogICAgICB9CiAgICB9CgogICAgLyog6Z2e5YWo5bGA5qih5byP5LiL77yM5LiN6IGa54Sm5YiZ5LiN5omn6KGM5b+r5o236ZSu55qE5pON5L2cICovCiAgICBpZiAoIXQuZ2xvYmFsTW9kZSAmJiAhdC5faXNGb3VjcykgcmV0dXJuCgogICAgLyog5Yik5pat5piv5ZCm5omn6KGM5LqG6Ieq5a6a5LmJ5b+r5o236ZSu5pON5L2c77yM5aaC5p6c5piv5YiZ5LiN5YaN5ZON5bqU5ZCO6Z2i6buY6K6k5a6a5LmJ5pON5L2cICovCiAgICBpZiAodC5ydW5DdXN0b21TaG9ydGN1dHMocGxheWVyLCBldmVudCkgPT09IHRydWUpIHJldHVybgoKICAgIC8qIOeDremUrui/kOihjOWZqOWMuemFjeWIsOebuOWFs+aJp+ihjOS7u+WKoeS+v+S4jeWcqOaJp+ihjOWQjue7reeahHBhbHllclRyaWdnZXIgKi8KICAgIGlmICh0LmhvdGtleXNSdW5uZXIgJiYgdC5ob3RrZXlzUnVubmVyLnJ1bikgewogICAgICBjb25zdCBtYXRjaFJlc3VsdCA9IHQuaG90a2V5c1J1bm5lci5ydW4oewogICAgICAgIGV2ZW50LAogICAgICAgIHRhcmdldDogdCwKICAgICAgICBzdG9wUHJvcGFnYXRpb246IHRydWUsCiAgICAgICAgcHJldmVudERlZmF1bHQ6IHRydWUsCiAgICAgICAgY29uZGl0aW9uSGFuZGxlciAoY29uZGl0aW9uKSB7CiAgICAgICAgICAvLyBUT0RPIOWujOWWhOadoeS7tumZkOWumuWbnuiwg+mAu+i+kQogICAgICAgICAgaWYgKGNvbmRpdGlvbikgewogICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CgogICAgICBpZiAobWF0Y2hSZXN1bHQpIHsKICAgICAgICBkZWJ1Zy5pbmZvKCdbaG90a2V5c1J1bm5lcl1bbWF0Y2hSZXN1bHRdJywgbWF0Y2hSZXN1bHQpOwogICAgICAgIHJldHVybiB0cnVlCiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIC8qIOacqueUqOWIsOeahOaMiemUruS4jei/m+ihjOS7u+S9leS6i+S7tuebkeWQrCAqLwogICAgICBpZiAoIWlzUmVnaXN0ZXJLZXkoZXZlbnQpKSB7IHJldHVybiBmYWxzZSB9CgogICAgICAvKiDlk43lupTmkq3mlL7lmajnm7jlhbPmk43kvZwgKi8KICAgICAgdC5wYWx5ZXJUcmlnZ2VyKHBsYXllciwgZXZlbnQpOwogICAgfQogIH0sCgogIC8qKgogICAqIOiOt+WPluaSreaUvui/m+W6pgogICAqIEBwYXJhbSBwbGF5ZXIgLeWPr+mAiSDlr7nlupTnmoRoNSDmkq3mlL7lmajlr7nosaHvvIwg5aaC5p6c5LiN5Lyg77yM5YiZ6I635Y+W5Yiw55qE5piv5pW05Liq5pKt5pS+6L+b5bqm6KGo77yM5Lyg5YiZ6I635Y+W5b2T5YmN5pKt5pS+5Zmo55qE5pKt5pS+6L+b5bqmCiAgICovCiAgZ2V0UGxheVByb2dyZXNzOiBmdW5jdGlvbiAocGxheWVyKSB7CiAgICBjb25zdCBwcm9ncmVzc01hcCA9IGNvbmZpZ01hbmFnZXIuZ2V0KCdtZWRpYS5wcm9ncmVzcycpIHx8IHt9OwoKICAgIGlmICghcGxheWVyKSB7CiAgICAgIHJldHVybiBwcm9ncmVzc01hcAogICAgfSBlbHNlIHsKICAgICAgY29uc3Qga2V5TmFtZSA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmICsgcGxheWVyLmR1cmF0aW9uOwogICAgICBpZiAocHJvZ3Jlc3NNYXBba2V5TmFtZV0pIHsKICAgICAgICAvKiDlr7nkuo7nm7Tmkq3nmoTop4bpopHmtYHvvIzkvJrlh7rnjrDorrDlvZXnmoRkdXJhdGlvbuWSjOW9k+WJjeinhumikWR1cmF0aW9u5LiN5LiA6Ie055qE5oOF5Ya177yM6L+Z5pe25YCZ6YCa6L+H6L+U5ZueY3VycmVudFRpbWXmnaXlv73nlaXmgaLlpI3mkq3mlL7ov5vluqYgKi8KICAgICAgICBpZiAoTnVtYmVyLmlzTmFOKE51bWJlcihwbGF5ZXIuZHVyYXRpb24pKSB8fCBOdW1iZXIocHJvZ3Jlc3NNYXBba2V5TmFtZV0uZHVyYXRpb24pICE9PSBOdW1iZXIocGxheWVyLmR1cmF0aW9uKSkgewogICAgICAgICAgcmV0dXJuIHBsYXllci5jdXJyZW50VGltZQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gcHJvZ3Jlc3NNYXBba2V5TmFtZV0ucHJvZ3Jlc3MKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHBsYXllci5jdXJyZW50VGltZQogICAgICB9CiAgICB9CiAgfSwKICAvKiDmkq3mlL7ov5vluqborrDlvZXlmaggKi8KICBwbGF5UHJvZ3Jlc3NSZWNvcmRlcjogZnVuY3Rpb24gKHBsYXllcikgewogICAgY29uc3QgdCA9IGg1UGxheWVyOwogICAgY2xlYXJUaW1lb3V0KHBsYXllci5fcGxheVByb2dyZXNzVGltZXJfKTsKICAgIGZ1bmN0aW9uIHJlY29yZGVyIChwbGF5ZXIpIHsKICAgICAgcGxheWVyLl9wbGF5UHJvZ3Jlc3NUaW1lcl8gPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAvKiDml7bplb/lsI/kuo7kuKTliIbpkp/nmoTop4bpopHkuI3orrDlvZXmkq3mlL7ov5vluqYgKi8KICAgICAgICBjb25zdCBpc1RvU2hvcnQgPSAhcGxheWVyLmR1cmF0aW9uIHx8IE51bWJlci5pc05hTihOdW1iZXIocGxheWVyLmR1cmF0aW9uKSkgfHwgcGxheWVyLmR1cmF0aW9uIDwgMTIwOwogICAgICAgIGNvbnN0IGlzTGVhdmUgPSBkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgIT09ICd2aXNpYmxlJyAmJiBwbGF5ZXIucGF1c2VkOwoKICAgICAgICBpZiAoIXQuaXNBbGxvd1Jlc3RvcmVQbGF5UHJvZ3Jlc3MoKSB8fCBpc1RvU2hvcnQgfHwgaXNMZWF2ZSkgewogICAgICAgICAgcmVjb3JkZXIocGxheWVyKTsKICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgfQoKICAgICAgICBjb25zdCBwcm9ncmVzc01hcCA9IHQuZ2V0UGxheVByb2dyZXNzKCkgfHwge307CiAgICAgICAgY29uc3QgbGlzdCA9IE9iamVjdC5rZXlzKHByb2dyZXNzTWFwKTsKICAgICAgICBjb25zdCBrZXlOYW1lID0gd2luZG93LmxvY2F0aW9uLmhyZWYgKyBwbGF5ZXIuZHVyYXRpb247CgogICAgICAgIC8qKgogICAgICAgICAqIOWvuemmluasoeiusOW9leWIsHByb2dyZXNzTWFw55qE5YC86L+b6KGM5qCH6K6wCiAgICAgICAgICog55So5LqO6Ziy5q2i5omL5Yqo5YiH5o2i5pKt5pS+6L+b5bqm5pe277yM5omn6KGM5Yiw6ZSZ6K+v55qE5oGi5aSN6YC76L6RCiAgICAgICAgICovCiAgICAgICAgaWYgKCFwcm9ncmVzc01hcFtrZXlOYW1lXSkgewogICAgICAgICAgdC5fZmlyc3RQcm9ncmVzc1JlY29yZF8gPSBrZXlOYW1lOwogICAgICAgICAgdC5faGFzUmVzdG9yZVBsYXlQcm9ncmVzc18gPSBrZXlOYW1lOwogICAgICAgIH0KCiAgICAgICAgLyog5Y+q5L+d5a2Y5pyA6L+RMTDkuKrop4bpopHnmoTmkq3mlL7ov5vluqYgKi8KICAgICAgICBpZiAobGlzdC5sZW5ndGggPiAxMCkgewogICAgICAgICAgLyog5qC55o2u5pu05paw55qE5pe26Ze05oiz77yM5Y+W5Ye65pyA5pep5re75Yqg5pKt5pS+6L+b5bqm55qE6K6w5b2V6aG5ICovCiAgICAgICAgICBsZXQgdGltZUxpc3QgPSBbXTsKICAgICAgICAgIGxpc3QuZm9yRWFjaChmdW5jdGlvbiAoa2V5TmFtZSkgewogICAgICAgICAgICBwcm9ncmVzc01hcFtrZXlOYW1lXSAmJiBwcm9ncmVzc01hcFtrZXlOYW1lXS50ICYmIHRpbWVMaXN0LnB1c2gocHJvZ3Jlc3NNYXBba2V5TmFtZV0udCk7CiAgICAgICAgICB9KTsKICAgICAgICAgIHRpbWVMaXN0ID0gcXVpY2tTb3J0KHRpbWVMaXN0KTsKICAgICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IHRpbWVMaXN0WzBdOwoKICAgICAgICAgIC8qIOWIoOmZpOacgOaXqea3u+WKoOeahOiusOW9lemhuSAqLwogICAgICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChrZXlOYW1lKSB7CiAgICAgICAgICAgIGlmIChwcm9ncmVzc01hcFtrZXlOYW1lXS50ID09PSB0aW1lc3RhbXApIHsKICAgICAgICAgICAgICBkZWxldGUgcHJvZ3Jlc3NNYXBba2V5TmFtZV07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgLyog6K6w5b2V5b2T5YmN5pKt5pS+6L+b5bqmICovCiAgICAgICAgcHJvZ3Jlc3NNYXBba2V5TmFtZV0gPSB7CiAgICAgICAgICBwcm9ncmVzczogcGxheWVyLmN1cnJlbnRUaW1lLAogICAgICAgICAgZHVyYXRpb246IHBsYXllci5kdXJhdGlvbiwKICAgICAgICAgIHQ6IG5ldyBEYXRlKCkuZ2V0VGltZSgpCiAgICAgICAgfTsKCiAgICAgICAgLyog5a2Y5YKo5pKt5pS+6L+b5bqm6KGoICovCiAgICAgICAgY29uZmlnTWFuYWdlci5zZXRMb2NhbFN0b3JhZ2UoJ21lZGlhLnByb2dyZXNzJywgcHJvZ3Jlc3NNYXApOwoKICAgICAgICAvKiDlvqrnjq/kvqblkKwgKi8KICAgICAgICByZWNvcmRlcihwbGF5ZXIpOwogICAgICB9LCAxMDAwICogMik7CiAgICB9CiAgICByZWNvcmRlcihwbGF5ZXIpOwogIH0sCgogIC8qIOiuvue9ruaSreaUvui/m+W6piAqLwogIHNldFBsYXlQcm9ncmVzczogZnVuY3Rpb24gKHBsYXllcikgewogICAgY29uc3QgdCA9IGg1UGxheWVyOwogICAgaWYgKCFwbGF5ZXIgfHwgIXBsYXllci5kdXJhdGlvbiB8fCBOdW1iZXIuaXNOYU4ocGxheWVyLmR1cmF0aW9uKSkgcmV0dXJuCgogICAgY29uc3QgY3VyVGltZSA9IE51bWJlcih0LmdldFBsYXlQcm9ncmVzcyhwbGF5ZXIpKTsKCiAgICAvKiDopoHmgaLlpI3ov5vluqbnmoTml7bpl7Tov4flsI/miJblpKfkuo5wbGF5ZXIuZHVyYXRpb27pg73kuI3nrKblkIjop4TojIPvvIzkuI3ov5vooYzov5vluqbmgaLlpI3mk43kvZwgKi8KICAgIGlmICghY3VyVGltZSB8fCBOdW1iZXIuaXNOYU4oY3VyVGltZSkgfHwgY3VyVGltZSA8IDEwIHx8IGN1clRpbWUgPj0gcGxheWVyLmR1cmF0aW9uKSByZXR1cm4KCiAgICAvKiDlv73nlaXmgaLlpI3ov5vluqbml7bpl7TkuI7lvZPliY3mkq3mlL7ov5vluqbml7bpl7Tnm7jlt67kuI3lpKfnmoTmg4XlhrUgKi8KICAgIGlmIChNYXRoLmFicyhjdXJUaW1lIC0gcGxheWVyLmN1cnJlbnRUaW1lKSA8IDIpIHsKICAgICAgcmV0dXJuIGZhbHNlCiAgICB9CgogICAgY29uc3QgcHJvZ3Jlc3NLZXkgPSB3aW5kb3cubG9jYXRpb24uaHJlZiArIHBsYXllci5kdXJhdGlvbjsKICAgIHQuX2hhc1Jlc3RvcmVQbGF5UHJvZ3Jlc3NfID0gdC5faGFzUmVzdG9yZVBsYXlQcm9ncmVzc18gfHwgJyc7CgogICAgaWYgKHQuX2hhc1Jlc3RvcmVQbGF5UHJvZ3Jlc3NfID09PSBwcm9ncmVzc0tleSB8fCB0Ll9maXJzdFByb2dyZXNzUmVjb3JkXyA9PT0gcHJvZ3Jlc3NLZXkpIHsKICAgICAgaWYgKHQuX2hhc1Jlc3RvcmVQbGF5UHJvZ3Jlc3NfID09PSBwcm9ncmVzc0tleSkgewogICAgICAgIHQuX2ZpcnN0UHJvZ3Jlc3NSZWNvcmRfID0gJyc7CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlCiAgICB9CgogICAgaWYgKHQuaXNBbGxvd1Jlc3RvcmVQbGF5UHJvZ3Jlc3MoKSkgewogICAgICAvLyDmr5RjdXJUaW1l5bCRMS41c+WPr+S7peiuqeeUqOaIt+efpemBk+aYr+WJjemdoueahOeUu+mdou+8jOS7juiAjOacieS4quihlOaOpeS4iuS6hueahOaEn+iniQogICAgICBwbGF5ZXIuY3VycmVudFRpbWUgPSBjdXJUaW1lIC0gMS41OwogICAgICB0Ll9oYXNSZXN0b3JlUGxheVByb2dyZXNzXyA9IHByb2dyZXNzS2V5OwogICAgICB0LnRpcHMoaTE4bi50KCd0aXBzTXNnLnBsYXliYWNrcmVzdG9yZWQnKSk7CiAgICB9IGVsc2UgewogICAgICB0LnRpcHMoaTE4bi50KCd0aXBzTXNnLnBsYXliYWNrcmVzdG9yZW9mZicpKTsKICAgIH0KICB9LAoKICBzZXRQbGF5ZXJJbnN0YW5jZSAoZWwpIHsKICAgIGlmICghZWwgJiYgIWVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCkgewogICAgICByZXR1cm4gZmFsc2UKICAgIH0KCiAgICBjb25zdCB0ID0gaDVQbGF5ZXI7CgogICAgaWYgKHQucGxheWVyKCkgPT09IGVsKSB7CiAgICAgIHJldHVybiBmYWxzZQogICAgfQoKICAgIGlmICghdC5wbGF5ZXJJbnN0YW5jZSAmJiBpc01lZGlhRWxlbWVudChlbCkpIHsKICAgICAgdC5wbGF5ZXJJbnN0YW5jZSA9IGVsOwogICAgICB0LmluaXRQbGF5ZXJJbnN0YW5jZShmYWxzZSk7CiAgICAgIHJldHVybiB0cnVlCiAgICB9CgogICAgaWYgKGlzVmlkZW9FbGVtZW50KGVsKSkgewogICAgICBjb25zdCBlbFBhcmVudE5vZGUgPSB0LmdldFRpcHNDb250YWluZXIoZWwpOwogICAgICBjb25zdCBlbEluZm8gPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgY29uc3QgcGFyZW50RWxJbmZvID0gZWxQYXJlbnROb2RlICYmIGVsUGFyZW50Tm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgaWYgKGVsSW5mbyAmJiBlbEluZm8ud2lkdGggPiAyMDAgJiYgcGFyZW50RWxJbmZvICYmIHBhcmVudEVsSW5mby53aWR0aCA+IDIwMCkgewogICAgICAgIHQucGxheWVySW5zdGFuY2UgPSBlbDsKICAgICAgICB0LmluaXRQbGF5ZXJJbnN0YW5jZShmYWxzZSk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoaXNBdWRpb0VsZW1lbnQoZWwpKSB7CiAgICAgIGlmIChpc0F1ZGlvRWxlbWVudCh0LnBsYXllckluc3RhbmNlKSB8fCAoaXNWaWRlb0VsZW1lbnQodC5wbGF5ZXJJbnN0YW5jZSkgJiYgIXQucGxheWVySW5zdGFuY2UuaXNDb25uZWN0ZWQpKSB7CiAgICAgICAgdC5wbGF5ZXJJbnN0YW5jZSA9IGVsOwogICAgICAgIHQuaW5pdFBsYXllckluc3RhbmNlKGZhbHNlKTsKICAgICAgfQogICAgfQogIH0sCgogIC8qKgogICAqIOinhumikeWFg+e0oOaYr+WQpuWHuueOsOWcqOinhuWPo+mHjOeahOinguWvn+Wvueixoe+8jOeUqOS6juS8mOWMluWkmuinhumikeWunuS+i+eahOWunuS+i+WIh+aNogogICAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL3poLUNOL2RvY3MvV2ViL0FQSS9JbnRlcnNlY3Rpb25fT2JzZXJ2ZXJfQVBJCiAgICovCiAgaW50ZXJzZWN0aW9uT2JzZXJ2ZXI6IG5ldyBJbnRlcnNlY3Rpb25PYnNlcnZlcihmdW5jdGlvbiAoZW50cmllcywgb2JzZXJ2ZXIpIHsKICAgIGNvbnN0IHQgPSBoNVBsYXllcjsKICAgIC8vIGRlYnVnLmxvZygnW2ludGVyc2VjdGlvbk9ic2VydmVyXScsIGVudHJpZXMpCgogICAgbGV0IHRtcEludGVyc2VjdGlvblJhdGlvID0gMDsKICAgIGVudHJpZXMuZm9yRWFjaChlbnRyaWUgPT4gewogICAgICBlbnRyaWUudGFyZ2V0Ll9pbnRlcnNlY3Rpb25JbmZvXyA9IGVudHJpZTsKCiAgICAgIGlmIChlbnRyaWUuaW50ZXJzZWN0aW9uUmF0aW8gPiB0bXBJbnRlcnNlY3Rpb25SYXRpbyAmJiBlbnRyaWUuaW50ZXJzZWN0aW9uUmF0aW8gPiAwLjQpIHsKICAgICAgICB0bXBJbnRlcnNlY3Rpb25SYXRpbyA9IGVudHJpZS5pbnRlcnNlY3Rpb25SYXRpbzsKCiAgICAgICAgY29uc3Qgb2xkUGxheWVyID0gdC5wbGF5ZXIoKTsKICAgICAgICBpZiAob2xkUGxheWVyICYmIG9sZFBsYXllci5faW50ZXJzZWN0aW9uSW5mb18gJiYgdG1wSW50ZXJzZWN0aW9uUmF0aW8gPCBvbGRQbGF5ZXIuX2ludGVyc2VjdGlvbkluZm9fLmludGVyc2VjdGlvblJhdGlvKSB7CiAgICAgICAgICAvKiDmlrDlrp7kvovnmoTop4blm77ojIPlm7Tmr5Tml6fnmoTlsI/vvIzliJnkuI3liIfmjaLlrp7kvosgKi8KICAgICAgICAgIHJldHVybgogICAgICAgIH0KCiAgICAgICAgLyog5YiH5o2i6KeG6aKR5a6e5L6LICovCiAgICAgICAgY29uc3QgdG9nZ2xlUmVzdWx0ID0gdC5zZXRQbGF5ZXJJbnN0YW5jZShlbnRyaWUudGFyZ2V0KTsKICAgICAgICB0b2dnbGVSZXN1bHQgJiYgZGVidWcubG9nKCdbaW50ZXJzZWN0aW9uT2JzZXJ2ZXJdIOWIh+aNouinhumikeWunuS+iycsIGVudHJpZSk7CiAgICAgIH0KICAgIH0pOwogIH0sIHsKICAgIHRocmVzaG9sZDogWzAsIDAuMSwgMC4yLCAwLjMsIDAuNCwgMC41LCAwLjYsIDAuNywgMC44LCAwLjksIDFdCiAgfSksCgogIC8qKgogICAqIOajgOa1i2g15pKt5pS+5Zmo5piv5ZCm5a2Y5ZyoCiAgICogQHBhcmFtIGNhbGxiYWNrCiAgICovCiAgZGV0ZWNINVBsYXllcjogZnVuY3Rpb24gKCkgewogICAgY29uc3QgdCA9IHRoaXM7CiAgICBjb25zdCBwbGF5ZXJMaXN0ID0gdC5nZXRQbGF5ZXJMaXN0KCk7CgogICAgaWYgKHBsYXllckxpc3QubGVuZ3RoKSB7CiAgICAgIC8vIGRlYnVnLmxvZygn5qOA5rWL5YiwSFRNTDXop4bpopHvvIEnLCBsb2NhdGlvbi5ocmVmLCBoNVBsYXllciwgcGxheWVyTGlzdCkKCiAgICAgIC8qIOWNlXZpZGVv5a6e5L6L5qCH562+55qE5oOF5Ya1ICovCiAgICAgIGlmIChwbGF5ZXJMaXN0Lmxlbmd0aCA9PT0gMSkgewogICAgICAgIHQucGxheWVySW5zdGFuY2UgPSBwbGF5ZXJMaXN0WzBdOwogICAgICAgIHQuaW5pdFBsYXllckluc3RhbmNlKHRydWUpOwogICAgICB9CgogICAgICAvKiDlpJp2aWRlb+WunuS+i+agh+etvueahOaDheWGtSAqLwogICAgICBwbGF5ZXJMaXN0LmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikgewogICAgICAgIC8qIOm8oOagh+enu+WIsOWFtuS4iumdoueahOaXtuWAmemHjeaWsOaMh+WumuWunuS+iyAqLwogICAgICAgIGlmICghcGxheWVyLl9oYXNNb3VzZVJlZGlyZWN0RXZlbnRfKSB7CiAgICAgICAgICBwbGF5ZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICB0LnNldFBsYXllckluc3RhbmNlKGV2ZW50LnRhcmdldCk7CiAgICAgICAgICB9KTsKICAgICAgICAgIHBsYXllci5faGFzTW91c2VSZWRpcmVjdEV2ZW50XyA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICAvKiDmkq3mlL7lmajlvIDlp4vmkq3mlL7nmoTml7blgJnph43mlrDmjIflkJHlrp7kvosgKi8KICAgICAgICBpZiAoIXBsYXllci5faGFzUGxheWluZ1JlZGlyZWN0RXZlbnRfKSB7CiAgICAgICAgICBwbGF5ZXIuYWRkRXZlbnRMaXN0ZW5lcigncGxheWluZycsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICBjb25zdCBtZWRpYSA9IGV2ZW50LnRhcmdldDsKCiAgICAgICAgICAgIC8qIOWvueS6jui2heefreeahOmfs+inhumikeWPr+iDveaYr+afkOS6m+aTjeS9nOWPjemmiOeahOeJueaViO+8jOWPr+W/veeVpeWvueWFtui/m+ihjOaSreaUvuWunuS+i+WIh+aNoiAqLwogICAgICAgICAgICBpZiAobWVkaWEuZHVyYXRpb24gJiYgbWVkaWEuZHVyYXRpb24gPCA4KSB7CiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHQuc2V0UGxheWVySW5zdGFuY2UobWVkaWEpOwogICAgICAgICAgfSk7CiAgICAgICAgICBwbGF5ZXIuX2hhc1BsYXlpbmdSZWRpcmVjdEV2ZW50XyA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICAvKiDlvZPooqvop4Llr5/liLDlh7rnjrDlnKjmtY/op4jlmajop4blj6Pph4zml7bvvIzliIfmjaLop4bpopHlrp7kvosgKi8KICAgICAgICBpZiAoIXBsYXllci5faGFzSW50ZXJzZWN0aW9uT2JzZXJ2ZXJfKSB7CiAgICAgICAgICB0LmludGVyc2VjdGlvbk9ic2VydmVyLm9ic2VydmUocGxheWVyKTsKICAgICAgICAgIHBsYXllci5faGFzSW50ZXJzZWN0aW9uT2JzZXJ2ZXJfID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgaWYgKGlzSW5Dcm9zc09yaWdpbkZyYW1lKCkpIHsKICAgICAgICAvKiDlub/mkq3mo4DmtYvliLBINVBsYXllcueahOa2iOaBryAqLwogICAgICAgIG1vbmtleU1zZy5zZW5kKCd2aWRlb0RldGVjdGVkJywgewogICAgICAgICAgc3JjOiB0LnBsYXllckluc3RhbmNlLnNyYwogICAgICAgIH0pOwogICAgICB9CgogICAgICByZWdpc3Rlckg1cGxheWVyTWVudXMoaDVQbGF5ZXIpOwogICAgfQogIH0sCgogIC8qIOWTjeW6lOadpeiHquaMiemUrua2iOaBr+eahOW5v+aSrSAqLwogIGJpbmRGYWtlRXZlbnQgKCkgewogICAgY29uc3QgdCA9IHRoaXM7CiAgICBpZiAodC5faGFzQmluZEZha2VFdmVudF8pIHJldHVybgoKICAgIC8qIOinpuWPkeadpeiHqua2iOaBr+W5v+aSreeahOaooeaLn+S6i+S7tu+8jOWunueOsOi3qOWfn+OAgei3qFRhYuaOp+WItuinhumikeaSreaUviAqLwogICAgbGV0IHRyaWdnZXJGYWtlRXZlbnQgPSBmdW5jdGlvbiAobmFtZSwgb2xkVmFsLCBuZXdWYWwsIHJlbW90ZSkgewogICAgICBjb25zdCBwbGF5ZXIgPSB0LnBsYXllcigpOwogICAgICBpZiAocGxheWVyICYmICF0Ll9fZGlzYWJsZUhvdGtleXNUZW1wb3JhcmlseV9fKSB7CiAgICAgICAgY29uc3QgZmFrZUV2ZW50ID0gbmV3VmFsLmRhdGE7CiAgICAgICAgZmFrZUV2ZW50LnN0b3BQcm9wYWdhdGlvbiA9ICgpID0+IHsgfTsKICAgICAgICBmYWtlRXZlbnQucHJldmVudERlZmF1bHQgPSAoKSA9PiB7IH07CiAgICAgICAgdC5wYWx5ZXJUcmlnZ2VyKHBsYXllciwgZmFrZUV2ZW50KTsKCiAgICAgICAgZGVidWcubG9nKCflt7Llk43lupTot6hUYWIv6Leo5Z+f5oyJ6ZSu5o6n5Yi25L+h5oGv77yaJywgbmV3VmFsKTsKICAgICAgfQogICAgfTsKCiAgICAvKioKICAgICAqIOaTjeS9nOiKgua1geaOp+WItu+8jOWHj+WwkeaMiemUrua2iOaBr+mikeeOh++8jAogICAgICog5rOo5oSP77yM5byA5ZCv6IqC5rWB5o6n5Yi25ZCO5a+86Ie05aSN5ZCI5oyJ6ZSu77yI5aaC77yac2hpZnQrc++8ieayoeazleeUn+aViAogICAgICovCiAgICBpZiAoIWNyb3NzVGFiQ3RsLmhhc09wZW5QaWN0dXJlSW5QaWN0dXJlKCkgJiYgIXQuaGFzQ3Jvc3NPcmlnaW5WaWRlb0RldGVjdGVkKSB7CiAgICAgIHRyaWdnZXJGYWtlRXZlbnQgPSB0aHJvdHRsZSh0cmlnZ2VyRmFrZUV2ZW50LCA4MCk7CiAgICB9CgogICAgLyog5rOo5YaM5ZON5bqU5p2l6Ieq5oyJ6ZSu5raI5oGv55qE5bm/5pKt55qE5LqL5Lu2ICovCiAgICBtb25rZXlNc2cub24oJ2dsb2JhbEtleWRvd25FdmVudCcsIGFzeW5jIChuYW1lLCBvbGRWYWwsIG5ld1ZhbCwgcmVtb3RlKSA9PiB7CiAgICAgIGlmIChyZW1vdGUpIHsKICAgICAgICBpZiAoaXNJbkNyb3NzT3JpZ2luRnJhbWUoKSkgewogICAgICAgICAgLyoqCiAgICAgICAgICAgKiDlkIzlpITot6jln5/lj5fpmZDpobXpnaLvvIzkuJTpg73lpITkuo7lj6/op4HnirbmgIHvvIzlpKfmpoLnjoflpITkuo7lkIzkuIDkuKpUYWLmoIfnrb7ph4zvvIzkvYbkuI3mmK8xMDAlCiAgICAgICAgICAgKiB0YWJJZOS4gOiHtOWImTEwMCXkuLrlkIzkuIDmoIfnrb7kuIsKICAgICAgICAgICAqLwogICAgICAgICAgaWYgKGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PT0gJ3Zpc2libGUnICYmIG5ld1ZhbC5vcmlnaW5UYWIpIHsKICAgICAgICAgICAgdHJpZ2dlckZha2VFdmVudChuYW1lLCBvbGRWYWwsIG5ld1ZhbCwgcmVtb3RlKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGNyb3NzVGFiQ3RsLmhhc09wZW5QaWN0dXJlSW5QaWN0dXJlKCkpIHsKICAgICAgICAgIC8qIOi3qFRhYuaOp+WItueUu+S4reeUu+mHjOmdoueahOinhumikeaSreaUviAqLwogICAgICAgICAgaWYgKCFuZXdWYWwub3JpZ2luVGFiICYmIChkb2N1bWVudC5waWN0dXJlSW5QaWN0dXJlRWxlbWVudCB8fCB0LmlzTGVhdmVwaWN0dXJlaW5waWN0dXJlQXdoaWxlKCkpKSB7CiAgICAgICAgICAgIHRyaWdnZXJGYWtlRXZlbnQobmFtZSwgb2xkVmFsLCBuZXdWYWwsIHJlbW90ZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKCiAgICB0Ll9oYXNCaW5kRmFrZUV2ZW50XyA9IHRydWU7CiAgfSwKCiAgLyog57uR5a6a55u45YWz5LqL5Lu2ICovCiAgYmluZEV2ZW50OiBmdW5jdGlvbiAoKSB7CiAgICBjb25zdCB0ID0gdGhpczsKICAgIGlmICh0Ll9oYXNCaW5kRXZlbnRfKSByZXR1cm4KCiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdC5rZXlkb3duRXZlbnQpOwogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHQua2V5ZG93bkV2ZW50LCB0cnVlKTsKCiAgICAvKiDlhbzlrrlpZnJhbWXmk43kvZwgKi8KICAgIGlmIChpc0luSWZyYW1lKCkgJiYgIWlzSW5Dcm9zc09yaWdpbkZyYW1lKCkpIHsKICAgICAgd2luZG93LnRvcC5kb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdC5rZXlkb3duRXZlbnQpOwogICAgICB3aW5kb3cudG9wLmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0LmtleWRvd25FdmVudCwgdHJ1ZSk7CiAgICB9CgogICAgdC5faGFzQmluZEV2ZW50XyA9IHRydWU7CiAgfSwKCiAgc2V0Q3VzdG9tQ29uZmlndXJhdGlvbiAoY29uZmlnLCB0YWcgPSAnRGVmYXVsdCcpIHsKICAgIGlmICghY29uZmlnKSByZXR1cm4gZmFsc2UKCiAgICBjb25zdCBjb25maWd1cmF0aW9uID0gY29uZmlnTWFuYWdlci5tZXJnZURlZkNvbmYoY29uZmlnLmN1c3RvbUNvbmZpZ3VyYXRpb24pOwogICAgY29uc3QgdGFza0NvbmYgPSBtZXJnZVRhc2tDb25mKGNvbmZpZy5jdXN0b21UYXNrQ29udHJvbENlbnRlcik7CiAgICBpZiAoVENDICYmIFRDQy5zZXRUYXNrQ29uZikgewogICAgICBUQ0Muc2V0VGFza0NvbmYodGFza0NvbmYpOwogICAgfQoKICAgIGg1UGxheWVyLmhhc1NldEN1c3RvbUNvbmZpZ3VyYXRpb24gPSB0YWc7CiAgICBkZWJ1Zy5pbmZvKGBbQ3VzdG9tQ29uZmlndXJhdGlvbl1bJHt0YWd9XWAsIGNvbmZpZ3VyYXRpb24sIHRhc2tDb25mKTsKICB9LAoKICBtZXJnZUV4dGVybmFsQ29uZmlndXJhdGlvbiAoY29uZmlnLCB0YWcgPSAnRGVmYXVsdCcpIHsKICAgIGlmICghY29uZmlnIHx8ICFjb25maWdNYW5hZ2VyLmdldEdsb2JhbFN0b3JhZ2UoJ2VuaGFuY2UuYWxsb3dFeHRlcm5hbEN1c3RvbUNvbmZpZ3VyYXRpb24nKSkgcmV0dXJuIGZhbHNlCiAgICBoNVBsYXllci5zZXRDdXN0b21Db25maWd1cmF0aW9uKGNvbmZpZywgJ0V4dGVybmFsJyk7CiAgICBoNVBsYXllci5oYXNFeHRlcm5hbEN1c3RvbUNvbmZpZ3VyYXRpb24gPSB0YWc7CiAgfSwKCiAgaW5pdDogZnVuY3Rpb24gKGdsb2JhbCkgewogICAgY29uc3QgdCA9IHRoaXM7CgogICAgaWYgKHdpbmRvdy51bnNhZmVXaW5kb3cgJiYgd2luZG93LnVuc2FmZVdpbmRvdy5fX2g1UGxheWVyQ3VzdG9tQ29uZmlndXJhdGlvbl9fKSB7CiAgICAgICF0Lmhhc0V4dGVybmFsQ3VzdG9tQ29uZmlndXJhdGlvbiAmJiB0Lm1lcmdlRXh0ZXJuYWxDb25maWd1cmF0aW9uKHdpbmRvdy51bnNhZmVXaW5kb3cuX19oNVBsYXllckN1c3RvbUNvbmZpZ3VyYXRpb25fXyk7CiAgICB9CgogICAgaWYgKFRDQyAmJiBUQ0MuZG9UYXNrKCdkaXNhYmxlJykgPT09IHRydWUpIHsKICAgICAgZGVidWcuaW5mbyhgW1RDQ11bZGlzYWJsZV1bJHtsb2NhdGlvbi5ob3N0fV0g5bey56aB5q2i5Zyo6K+l572R56uZ6L+Q6KGM6KeG6aKR5qOA5rWL6YC76L6R77yM5oKo5Y+v5p+l55yL5Lu75Yqh6YWN572u5Lit5b+D55qE55u45YWz6YWN572u5LqG6Kej6K+m5oOFYCk7CiAgICAgIHJldHVybiB0cnVlCiAgICB9CgogICAgaWYgKCFnbG9iYWwpIHsKICAgICAgLyog5qOA5rWL5piv5ZCm5a2Y5ZyoSDXmkq3mlL7lmaggKi8KICAgICAgdC5kZXRlY0g1UGxheWVyKCk7CiAgICAgIHJldHVybiB0cnVlCiAgICB9CgogICAgaWYgKGNvbmZpZ01hbmFnZXIuZ2V0KCdkZWJ1ZycpID09PSB0cnVlKSB7CiAgICAgIHdpbmRvdy5fZGVidWdNb2RlXyA9IHRydWU7CiAgICAgIHQubW91bnRUb0dsb2JhbCgpOwogICAgfQoKICAgIHNldEZha2VVQSgpOwoKICAgIC8qIOWIneWni+WMluS7u+WKoemFjee9ruS4reW/gyAqLwogICAgVENDID0gaDVQbGF5ZXJUY2NJbml0KHQpOwoKICAgIC8qIOe7keWumumUruebmOS6i+S7tiAqLwogICAgaWYgKGNvbmZpZ01hbmFnZXIuZ2V0KCdlbmFibGVIb3RrZXlzJykgIT09IGZhbHNlKSB7CiAgICAgIHQuYmluZEV2ZW50KCk7CiAgICAgIHQuYmluZEZha2VFdmVudCgpOwogICAgfSBlbHNlIHsKICAgICAgZGVidWcud2Fybign5b+r5o236ZSu6IO95Yqb5bey6KKr56aB55SoJyk7CiAgICB9CgogICAgLyog5ZON5bqU5p2l6Ieq6Leo5Z+f5Y+X6ZmQ55qE6KeG6aKR5qOA5Ye65LqL5Lu2ICovCiAgICBtb25rZXlNc2cub24oJ3ZpZGVvRGV0ZWN0ZWQnLCBhc3luYyAobmFtZSwgb2xkVmFsLCBuZXdWYWwsIHJlbW90ZSkgPT4gewogICAgICBpZiAobmV3VmFsLm9yaWdpblRhYikgewogICAgICAgIHQuaGFzQ3Jvc3NPcmlnaW5WaWRlb0RldGVjdGVkID0gdHJ1ZTsKICAgICAgfQoKICAgICAgZGVidWcubG9nKCdbaGFzQ3Jvc3NPcmlnaW5WaWRlb0RldGVjdGVkXScsIHQsIG5hbWUsIG9sZFZhbCwgbmV3VmFsLCByZW1vdGUpOwogICAgfSk7CgogICAgLyog5b2T6aG16Z2i5aSE5LqO5Y+v6KeG5YyW54q25oCB5pe277yM5Yid5aeL5YyW6Ieq5a6a5LmJ5pKt5pS+6YC76L6RICovCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd2aXNpYmlsaXR5Y2hhbmdlJywgZnVuY3Rpb24gKCkgewogICAgICBoNVBsYXllci5pbml0QXV0b1BsYXkoKTsKICAgIH0pOwoKICAgIGlmICh3aW5kb3cudW5zYWZlV2luZG93ICYmIGNvbmZpZ01hbmFnZXIuZ2V0R2xvYmFsU3RvcmFnZSgnZW5oYW5jZS5hbGxvd0V4dGVybmFsQ3VzdG9tQ29uZmlndXJhdGlvbicpKSB7CiAgICAgIHdpbmRvdy51bnNhZmVXaW5kb3cuX19zZXRINVBsYXllckN1c3RvbUNvbmZpZ3VyYXRpb25fXyA9IHQubWVyZ2VFeHRlcm5hbENvbmZpZ3VyYXRpb247CiAgICB9CiAgfQp9OwoKYXN5bmMgZnVuY3Rpb24gaDVQbGF5ZXJJbml0ICgpIHsKICB0cnkgewogICAgaWYgKGlzQ2xvdWRmbGFyZUNoYWxsZW5nZVBhZ2UoKSkgewogICAgICBjb25zb2xlLndhcm4oJ+W9k+WJjeWkhOS6jmNsb3VkZmxhcmXnmoTkurrmnLrpqozor4HpobXpnaLvvIzmmoLlgZxoNXBsYXllcueahOi/kOihjCcsIGxvY2F0aW9uLmhyZWYpOwogICAgICByZXR1cm4gZmFsc2UKICAgIH0KICB9IGNhdGNoIChlKSB7CiAgICBkZWJ1Zy5lcnJvcihlKTsKICB9CgogIGNvbnN0IGlzRW5hYmxlZCA9IGNvbmZpZ01hbmFnZXIuZ2V0KCdlbmFibGUnKTsKICBjb25zdCBibGFja1VybExpc3QgPSBjb25maWdNYW5hZ2VyLmdldCgnYmxhY2tsaXN0LnVybHMnKSB8fCBbXTsKICBjb25zdCBibGFja0RvbWFpbkxpc3QgPSBjb25maWdNYW5hZ2VyLmdldCgnYmxhY2tsaXN0LmRvbWFpbnMnKSB8fCBbXTsKICBjb25zdCBpc0luQmxhY2tMaXN0ID0gYmxhY2tVcmxMaXN0LmluY2x1ZGVzKGxvY2F0aW9uLmhyZWYpIHx8IGJsYWNrRG9tYWluTGlzdC5pbmNsdWRlcyhsb2NhdGlvbi5ob3N0KTsKCiAgaWYgKGlzSW5CbGFja0xpc3QpIHsKICAgIGNvbnNvbGUud2FybihgW2g1cGxheWVyXVtjb25maWddW2JsYWNrbGlzdF1bJHtsb2NhdGlvbi5ocmVmfV0gXG7lvZPliY3pobXpnaLlt7LooqvliqDlhaXpu5HlkI3ljZXvvIzkuI3miafooYxoNXBsYXllcuWinuW8uuiEmuacrOeahOebuOWFs+mAu+i+ke+8jOWmguaciemcgOimgeW8gOWQr++8jOivt+WcqOmFjee9rumHjOeahGJsYWNrbGlzdOenu+mZpOWvueW6lOeahOWcsOWdgGApOwogIH0KCiAgdHJ5IHsKICAgIGlmIChpc0VuYWJsZWQgJiYgIWlzSW5CbGFja0xpc3QpIHsKICAgICAgbWVkaWFDb3JlLmluaXQoZnVuY3Rpb24gKG1lZGlhRWxlbWVudCkgewogICAgICAgIGg1UGxheWVyLmluaXQoKTsKICAgICAgfSk7CgogICAgICBpZiAoY29uZmlnTWFuYWdlci5nZXQoJ2VuaGFuY2UuYWxsb3dFeHBlcmltZW50RmVhdHVyZXMnKSAmJiBjb25maWdNYW5hZ2VyLmdldCgnZG93bmxvYWQuZW5hYmxlJykpIHsKICAgICAgICBtZWRpYVNvdXJjZS5pbml0KCk7CiAgICAgICAgZGVidWcud2FybihgW2V4cGVyaW1lbnRGZWF0dXJlc11bd2FybmluZ10gJHtpMThuLnQoJ2V4cGVyaW1lbnRGZWF0dXJlc1dhcm5pbmcnKX1gKTsKICAgICAgICBkZWJ1Zy53YXJuKCdbZXhwZXJpbWVudEZlYXR1cmVzXVttZWRpYVNvdXJjZV1bYWN0aXZhdGVkXScpOwogICAgICB9CgogICAgICAvKiDnpoHmraLlr7lwbGF5YmFja1JhdGXnrYnlsZ7mgKfov5vooYzplIHlrpogKi8KICAgICAgaGFja0RlZmluZVByb3BlcnR5KCk7CgogICAgICAvKiDnpoHmraLlr7lzaGFkb3dkb23kvb/nlKhjbG9zZeaooeW8jyAqLwogICAgICBoYWNrQXR0YWNoU2hhZG93KCk7CgogICAgICAvKiDlr7nmiYDmnInkuovku7bov5vooYzmjqXnrqEgKi8KICAgICAgcHJveHlIVE1MTWVkaWFFbGVtZW50RXZlbnQoKTsKICAgICAgLy8gaGFja0V2ZW50TGlzdGVuZXIoKQogICAgfQogIH0gY2F0Y2ggKGUpIHsKICAgIGNvbnNvbGUuZXJyb3IoJ2g1cGxheWVyIGhhY2sgZXJyb3InLCBlKTsKICB9CgogIC8qIOazqOaEj++8muayueeMtOeahOiPnOWNleazqOWGjOS4jeiDveagueaNrmlzRW5hYmxlZOemgeeUqOaOie+8jOWQpuWImeayoeazlemAmui/h+ayueeMtOeahOiPnOWNlei/m+ihjOWQr+eUqCAqLwogIG1lbnVSZWdpc3RlcigpOwoKICBpZiAoIWlzRW5hYmxlZCB8fCBpc0luQmxhY2tMaXN0KSB7CiAgICBkZWJ1Zy53YXJuKGBbY29uZmlnXVtkaXNhYmxlXVske2xvY2F0aW9uLmhvc3R9XSDlvZPliY3nvZHnq5nlt7LnpoHnlKjohJrmnKzvvIzlpoLopoHlkK/nlKjohJrmnKzvvIzor7flnKjoj5zljZXph4zlvIDlkK9gKTsKICAgIHJldHVybiBmYWxzZQogIH0KCiAgdHJ5IHsKICAgIC8qIOWIneWni+WMluWFqOWxgOaJgOmcgOeahOebuOWFs+aWueazlSAqLwogICAgaDVQbGF5ZXIuaW5pdCh0cnVlKTsKCiAgICAvKiDmo4DmtYvliLDmnInop4bpopHmoIfnrb7lsLHov5vooYzliJ3lp4vljJYgKi8KICAgIHN1cHBvcnRNZWRpYVRhZ3MuZm9yRWFjaCh0YWdOYW1lID0+IHsKICAgICAgcmVhZHkodGFnTmFtZSwgZnVuY3Rpb24gKCkgewogICAgICAgIGg1UGxheWVyLmluaXQoKTsKICAgICAgfSk7CiAgICB9KTsKCiAgICAvKiDmo4DmtYtzaGFkb3cgZG9tIOS4i+mdoueahHZpZGVvICovCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdhZGRTaGFkb3dSb290JywgZnVuY3Rpb24gKGUpIHsKICAgICAgY29uc3Qgc2hhZG93Um9vdCA9IGUuZGV0YWlsLnNoYWRvd1Jvb3Q7CiAgICAgIHN1cHBvcnRNZWRpYVRhZ3MuZm9yRWFjaCh0YWdOYW1lID0+IHsKICAgICAgICByZWFkeSh0YWdOYW1lLCBmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgICAgaDVQbGF5ZXIuaW5pdCgpOwogICAgICAgIH0sIHNoYWRvd1Jvb3QpOwogICAgICB9KTsKICAgIH0pOwoKICAgIC8qIOWIneWni+WMlui3qFRhYuaOp+WItumAu+i+kSAqLwogICAgY3Jvc3NUYWJDdGwuaW5pdCgpOwoKICAgIGlmIChpc0luSWZyYW1lKCkpIHsKICAgICAgZGVidWcubG9nKCdoNVBsYXllciBpbml0IHN1YywgaW4gaWZyYW1lOicpOwogICAgfSBlbHNlIHsKICAgICAgZGVidWcubG9nKCdoNVBsYXllciBpbml0IHN1YycpOwogICAgfQoKICAgIGlmIChpc0luQ3Jvc3NPcmlnaW5GcmFtZSgpKSB7CiAgICAgIGRlYnVnLmxvZygn5b2T5YmN5aSE5LqO6Leo5Z+f5Y+X6ZmQ55qEaWZyYW1l5Lit77yMaDVQbGF5ZXLpg6jliIblip/og73lj6/og73ml6Dms5XmraPluLjlvIDlkK8nLCB3aW5kb3cubG9jYXRpb24uaHJlZik7CiAgICB9CgogICAgLyog5rOo5YaM6byg5qCH5o6n5Yi25LqL5Lu2ICovCiAgICBpZiAoY29uZmlnTWFuYWdlci5nZXQoJ21vdXNlLmVuYWJsZScpKSB7CiAgICAgIHJlZ2lzdGVyTW91c2VFdmVudChoNVBsYXllcik7CiAgICB9CiAgfSBjYXRjaCAoZSkgewogICAgZGVidWcuZXJyb3IoJ2g1UGxheWVyIGluaXQgZmFpbCcsIGUpOwogIH0KCiAgLyog5rOo5oSP77ya5Y+q5pyJ5piO56Gu5Li6ZmFzbGXmiY3pmpDol49HVUkgKi8KICBpZiAoY29uZmlnTWFuYWdlci5nZXQoJ3VpLmVuYWJsZScpICE9PSBmYWxzZSkgewogICAgaWYgKHdpbmRvdy5jdXN0b21FbGVtZW50cyAmJiBkb2N1bWVudC5hZG9wdGVkU3R5bGVTaGVldHMpIHsKICAgICAgaDVQbGF5ZXIuVUkgPSBoNXBsYXllclVJKHdpbmRvd1NhbmRib3gpOwogICAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsKICAgICAgICBoNVBsYXllci5VSS5pbml0KCk7CiAgICAgIH0sIDQwMCk7CiAgICB9IGVsc2UgewogICAgICAvKiB3ZWJraXTlhoXmoLjlu7rorq43M+S7peS4iueahOa1j+iniOWZqOaJjeWFgeiuuOS9v+eUqFVJ57uE5Lu277yM5ZCm5YiZ5YW85a655oiW5oCn6IO96YO95piv5b6I5aSn55qE6Zeu6aKYICovCiAgICAgIGRlYnVnLndhcm4oJ+W9k+WJjea1j+iniOWZqOS4jeaUr+aMgWN1c3RvbUVsZW1lbnRz5oiWYWRvcHRlZFN0eWxlU2hlZXRz77yM5peg5rOV5L2/55SoVUnnu4Tku7bvvIzlu7rorq7kvb/nlKhDaHJvbWUgODMr77yMRWRnZSA4MysnKTsKICAgIH0KICB9IGVsc2UgewogICAgZGVidWcud2FybignVUnnu4Tku7blt7LooqvnpoHnlKgnLCBjb25maWdNYW5hZ2VyLmdldCgndWkuZW5hYmxlJykpOwogIH0KCiAgLyoqCiAgICog6Lef5a6Y572R6L+c56iL5Yqp5omL6L+b6KGM5LqS5Yqo77yM5pyJ5Lil6YeN5a6J5YWo5oiW5L+h5oGv5rSB55mW55qE5Lq65omL5Yqo5rOo6YeK5LiL6Z2i5Luj56CB5Y2z5Y+vCiAgICog5LiL6Z2i5Luj56CB5LiN5Lya5b2x5ZON5Li76KaB5Yqf6IO955qE5q2j5bi45L2/55SoCiAgICog5LiN5rOo6YeK5Luj56CB77yM56aB55SoVUnnlYzpnaLkuZ/mnInlkIznrYnmlYjmnpwKICAgKi8KICB0cnkgewogICAgY29uZmlnTWFuYWdlci5nZXQoJ3VpLmVuYWJsZScpICE9PSBmYWxzZSAmJiByZW1vdGVIZWxwZXIuaW5pdCgpOwogIH0gY2F0Y2ggKGUpIHsKICAgIGRlYnVnLmVycm9yKCdbcmVtb3RlSGVscGVyLmluaXRdJywgZSk7CiAgfQoKICAvLyBjb25zb2xlLmNsZWFyID0gKCkgPT4ge30KfQoKZnVuY3Rpb24gaW5pdCAocmV0cnlDb3VudCA9IDApIHsKICBpZiAoIXdpbmRvdy5kb2N1bWVudCB8fCAhd2luZG93LmRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkgewogICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgIGlmIChyZXRyeUNvdW50IDwgMjAwKSB7CiAgICAgICAgaW5pdChyZXRyeUNvdW50ICsgMSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5lcnJvcignW2g1cGxheWVyIG1lc3NhZ2U6XScsICdub3QgZG9jdW1lbnRFbGVtZW50IGRldGVjdGVkIScsIHdpbmRvdyk7CiAgICAgIH0KICAgIH0sIDEwKTsKCiAgICByZXR1cm4gZmFsc2UKICB9IGVsc2UgaWYgKHJldHJ5Q291bnQgPiAwKSB7CiAgICBjb25zb2xlLndhcm4oJ1toNXBsYXllciBtZXNzYWdlOl0nLCAnZG9jdW1lbnRFbGVtZW50IGRldGVjdGVkIScsIHJldHJ5Q291bnQsIHdpbmRvdyk7CiAgfQoKICBoNVBsYXllckluaXQoKTsKfQoKLyoqCiAqIOafkOS6m+aegeerr+aDheWGteS4i++8jOebtOaOpeiuv+mXrndpbmRvd+WvueixoemDveS8muWvvOiHtOaKpemUme+8jOaJgOS7peaVtOS4qmluaXTpg710cnnotbfmnaUKICog5L6L5aaC77yad3d3Lmljb3Vyc2UxNjMub3JnIOWwseacieS4gOWumueahOacuueOh+W8guW4uAogKi8KbGV0IGluaXRUcnlDb3VudCA9IDA7CnRyeSB7CiAgaW5pdCgwKTsKfSBjYXRjaCAoZSkgewogIHNldFRpbWVvdXQoKCkgPT4gewogICAgaWYgKGluaXRUcnlDb3VudCA8IDIwMCkgewogICAgICBpbml0VHJ5Q291bnQrKzsKICAgICAgaW5pdCgwKTsKICAgICAgY29uc29sZS5lcnJvcignW2g1cGxheWVyIG1lc3NhZ2U6XScsICdpbml0IGVycm9yJywgaW5pdFRyeUNvdW50LCBlKTsKICAgIH0KICB9LCAxMCk7Cn0K"}]}